self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.Addins.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[120,4,5,10,18,26,35,43,57,716,735],{1004:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(27),o=n(283);function i(e){return!!(e&Object(r.a)().ViewStateConfiguration.ListViewBitFlags)}var a=Object(o.action)("setBit")((function(e,t){i(t)!==e&&(e?Object(r.a)().ViewStateConfiguration.ListViewBitFlags|=t:Object(r.a)().ViewStateConfiguration.ListViewBitFlags&=~t)}))},1005:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(1044),o=n(4),i={tabs:[{id:"primaryTab",type:r.a.Primary,state:2,blink:!1,sxsId:"primaryTab"}],tabBarWidth:0,isOverflowMenuShown:!1},a=Object(o.createStore)("tab",i),s=(a(),a().tabs[0])},1008:function(e,t,n){"use strict";var r,o;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),function(e){e[e.None=0]="None",e[e.Cache=1]="Cache",e[e.FindPeople=2]="FindPeople",e[e.SearchDirectory=3]="SearchDirectory",e[e.MixedCacheLive=4]="MixedCacheLive"}(r||(r={})),function(e){e[e.None=0]="None",e[e.Auto=1]="Auto",e[e.Manual=2]="Manual"}(o||(o={}))},1011:function(e,t,n){"use strict";function r(e){return t=e||"",(n=i.exec(t))&&n.length>1&&o[n[1].toLowerCase()];var t,n}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var o={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},i=/^\s*([^;\s]*)(?:;|\s|$)/;function a(e){var t="";return Object.entries(o).forEach((function(n){n[1]===e&&(t=n[0])})),t}},1013:function(e,t,n){"use strict";var r,o=function(e,t){if(this.AddinCommands=t,!this.AddinCommands)throw new Error("AddinCommands cannot be null while constructing an addin");this.DisplayName=e.DisplayName,this.IconUrl=e.IconUrl,this.HighResolutionIconUrl=e.HighResolutionIconUrl,this.Id=e.Id},i=n(0),a=n(7769),s=n(314),c=function(){function e(t,n,r,o){var s,c;if(this.control=t,this.tabInfo=n,this.groupInfo=r,this.extension=o,a.b(t)){var u=t;this.subCommands=[];try{for(var l=Object(i.__values)(u.MenuItems),d=l.next();!d.done;d=l.next()){var f=d.value;this.subCommands.push(new e(f,n,r,o))}}catch(e){s={error:e}}finally{try{d&&!d.done&&(c=l.return)&&c.call(l)}finally{if(s)throw s.error}}}}return Object.defineProperty(e.prototype,"isActionable",{get:function(){return!!this.control.Action},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMenu",{get:function(){return!!this.control.MenuItems},enumerable:!1,configurable:!0}),e.prototype.get_EntryPoint=function(){return a.c(this.control)?this.control.Action.SourceLocation:a.a(this.control)?this.extension.ExtensionPointCollection.FunctionFile:(Object(s.a)(this.control),"")},e.prototype.get_Id=function(){return this.extension.Id+this.control.Id},e.prototype.get_Label=function(){return this.control.Label},e.prototype.get_ExtensionDisplayName=function(){return this.extension.DisplayName},e.prototype.get_Size16Icon=function(){return this.control&&this.control.Icon?this.control.Icon.Size16Url:null},e.prototype.getControl=function(){return this.control},e}(),u=function(){function e(e,t){this.detectedEntity=e,this.extension=t}return e.prototype.get_EntryPoint=function(){return this.detectedEntity.SourceLocation},e.prototype.get_Id=function(){return this.extension.Id},e.prototype.get_Label=function(){return this.detectedEntity.Label},e.prototype.get_ExtensionDisplayName=function(){return this.extension.DisplayName},e.prototype.get_ActivationRule=function(){return this.detectedEntity.Rule},e.prototype.get_Size16Icon=function(){return this.extension.IconUrl},e.prototype.getControl=function(){return null},e}();!function(e){e[e.TimedOut=-1]="TimedOut",e[e.Success=0]="Success",e[e.FunctionNotFound=11101]="FunctionNotFound",e[e.NavigatedBeforeCompleted=13001]="NavigatedBeforeCompleted",e[e.PreinstalledConsented=13002]="PreinstalledConsented",e[e.Unknown=13003]="Unknown"}(r||(r={}));var l=r,d=n(4),f=n(1090),p=Object(d.mutatorAction)("setAutoRunAddinCommandWaitingQueue",(function(e,t){var n=Object(f.a)().autoRunAddinCommandWaitingQueue;n.has(t)||n.set(t,new Array),n.get(t).push(e)})),m=Object(d.mutatorAction)("destroyAutoRunAddinCommandFromWaitingQueue",(function(e,t){var n=Object(f.a)().autoRunAddinCommandWaitingQueue;if(n.has(e)){for(var r=n.get(e),o=0;o<r.length;o++)if(r[o].addinCommand===t){r.splice(o,1);break}0===r.length&&n.delete(e)}})),g=n(283),h=n(24),v="DeferrablePromise timed out",y=function(){function e(e){var t=this;this.internalPromise=new Promise((function(n,r){t.internalResolve=n,t.internalReject=r,t.timeout=setTimeout((function(){r(new Error(v)),t.isRejected=!0}),e)}))}return e.prototype.then=function(e,t){return this.internalPromise.then(e,t)},e.prototype.catch=function(e){return this.internalPromise.catch(e)},e.prototype.resolve=function(e){this.isFullfilled&&this.isRejected||(this.internalResolve(e),this.isFullfilled=!0,clearTimeout(this.timeout))},e.prototype.reject=function(e){this.isFullfilled&&this.isRejected||(this.internalReject(e),this.isRejected=!0,clearTimeout(this.timeout))},e}(),b=33e4,_={};var S=Object(g.action)("setUilessExtendedAddinCommand")((function(e,t,n){var r=function(e){var t=new y(b);return _[e]=t,t.catch((function(e){return e.message===v?{status:l.TimedOut}:{status:l.Unknown}}))}(e),o=Object(f.a)().runningUILessExtendedAddinCommands;return o.has(n)||o.set(n,new h.ObservableMap),o.get(n).set(e,t),r})),C=n(1097),O=function(){function e(e,t,n,r){this.event=e,this.control=t,this.extension=n,this.mode=r}return e.prototype.getLaunchEventType=function(){return this.event},e.prototype.getControl=function(){return this.control},e.prototype.get_EntryPoint=function(){switch(this.mode){case C.a.LaunchEvent:return this.extension.ExtensionPointCollection.LaunchEvent.SourceLocation;default:return null}},e.prototype.get_Label=function(){return this.control.Label},e.prototype.get_ExtensionDisplayName=function(){return this.extension.DisplayName},e.prototype.get_Id=function(){return this.extension.Id},e.prototype.get_Size16Icon=function(){return this.extension.IconUrl},e}(),A=function(e,t){var n=Object(f.a)().blockedAddinCommands;return!!n.has(e)&&n.get(e).has(t)};function I(e){return Object(f.a)().HostItems.has(e)}var x=Object(d.mutatorAction)("setBlockedAddinCommand",(function(e,t){var n=Object(f.a)().blockedAddinCommands;n.has(t)||n.set(t,new Set),n.get(t).add(e)})),E=n(254),T=n(2),P=function(e,t){e.forEach((function(e){var n=e.addinCommand;!A(t,n)&&F(n,t)&&(e.addinCommandTelemetry.setQueuePushTime(),p(e,t))}))},w=function(e){R(e).forEach((function(t){var n=t.addinCommand,r=n.get_Id();!A(e,n)&&j(r,e)&&(t.addinCommandTelemetry.setQueuePopTime(),M(t,e),m(e,n))}))},M=function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var n,r,o;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:n=e.addinCommand,r=0,i.label=1;case 1:return r<3?(o=e.controlId,[4,S(o,e,t)]):[3,4];case 2:if(i.sent().status===l.Success||!I(t))return[2];2==r&&Object(E.o)("AddinExecutionBlocked",{id:n.extension.Id,controlId:o,owa_1:Object(T.e)(),owa_2:Object(oe.c)(t)}),i.label=3;case 3:return r++,[3,1];case 4:return x(n,t),m(t,n),w(t),[2]}}))}))},R=function(e){var t=Object(f.a)().autoRunAddinCommandWaitingQueue.get(e);return t||[]},j=function(e,t){return!k(e,t)&&(!D(t)&&!N())},k=function(e,t){var n=Object(f.a)().runningUILessExtendedAddinCommands,r=!1;return!!n.has(t)&&(n.get(t).forEach((function(t){var n=t.addinCommand;L(n)&&n.get_Id()===e&&(r=!0)})),r)},N=function(){var e=Object(f.a)().runningUILessExtendedAddinCommands,t=0;return e.forEach((function(e){e.forEach((function(e){var n=e.addinCommand;L(n)&&(t+=1)}))})),t>=20},D=function(e){var t=Object(f.a)().runningUILessExtendedAddinCommands,n=0;return t.has(e)&&t.get(e).forEach((function(e){var t=e.addinCommand;L(t)&&(n+=1)})),n>=5},F=function(e,t){for(var n=R(t),r=0;r<n.length;r++){var o=n[r].addinCommand,i=e.getLaunchEventType()===o.getLaunchEventType(),a=e.get_Id()===o.get_Id();if(i&&a)return!1}return!0},L=function(e){return e instanceof O},U=n(2130),B=function(){function e(){}return e.prototype.CreateAddinCommand=function(e,t,n,r){return new c(e,t,n,r)},e.prototype.CreateContextualAddinCommand=function(e,t){return new u(e,t)},e.prototype.CreateEventAddinCommand=function(e,t){switch(e.Type){case 1:return new c({Id:"ItemSend",Action:e},null,null,t)}return null},e.prototype.CreateAutoRunAddinCommand=function(e,t,n){var r;switch(e.Type){case 1:r="OnNewMessageCompose";break;case 2:r="OnNewAppointmentOrganizer";break;default:return null}var o={Id:r,Action:e};return new O(e.Type,o,t,n)},e}();function H(e,t){switch(t){case C.a.MeetingRequest:return e.MessageReadCommandSurface;case C.a.AppointmentAttendee:return e.AppointmentAttendeeCommandSurface;case C.a.AppointmentOrganizer:return e.AppointmentOrganizerCommandSurface;case C.a.DetectedEntity:return e.DetectedEntity;case C.a.MessageCompose:return e.MessageComposeCommandSurface;case C.a.MessageRead:return e.MessageReadCommandSurface;case C.a.LaunchEvent:return e.LaunchEvent;case C.a.TrapOnSendEvent:default:return null}}var W=function(){function e(e){var t=this;this.addinCommandFactory=e,this.GetAutoRunAddinCommands=function(e,n,r){if(!e)return null;var o={};return e.LaunchEvents.forEach((function(e){o[e.Type.toString()]=t.addinCommandFactory.CreateAutoRunAddinCommand(e,n,r)})),new h.ObservableMap(o)}}return e.prototype.CreateAddinIfEntryPointSupported=function(e,t){var n;return(n=t==C.a.TrapOnSendEvent?this.GetEventsAddinCommands(e.ExtensionPointCollection.Events,e):t==C.a.DetectedEntity?this.GetContextualAddinCommand(H(e.ExtensionPointCollection,t),e):t==C.a.LaunchEvent?this.GetAutoRunAddinCommands(H(e.ExtensionPointCollection,t),e,t):this.GetAddinCommands(H(e.ExtensionPointCollection,t),e))?new o(e,n):null},e.prototype.GetAddinCommands=function(e,t){var n=this;if(!e)return null;var r={};return e.Tabs.forEach((function(e){e.Groups.forEach((function(o){o.Controls.forEach((function(i){r[i.Id]=n.addinCommandFactory.CreateAddinCommand(i,e,o,t)}))}))})),new h.ObservableMap(r)},e.prototype.GetContextualAddinCommand=function(e,t){if(!e)return null;var n={};return n[t.Id]=this.addinCommandFactory.CreateContextualAddinCommand(e,t),new h.ObservableMap(n)},e.prototype.GetEventsAddinCommands=function(e,t){var n=this;if(!e)return null;var r={};return e.forEach((function(e){r[e.Type]=n.addinCommandFactory.CreateEventAddinCommand(e,t)})),new h.ObservableMap(r)},e}(),V=Object(d.mutatorAction)("closeAllAutoRunCommandsforHostItemIndex",(function(e){Object(f.a)().autoRunAddinCommandWaitingQueue.delete(e)}));var z=n(1608);function G(){return{regExMatches:{},matchedKnownEntityTypes:[],filteredEntityMatches:{}}}var q=Object(g.action)("destroyExtensibilityHostItem")((function(e){z.a.HostItems.delete(e)}));function K(e){return!!e&&!!e.SupportsSharedFolders}function X(e){return e.filter((function(e){return K(function(e){var t=Object(i.__spread)(e.AddinCommands.values());if(0==t.length)return null;return t[0].extension.ExtensionPointCollection}(e))}))}function J(e){return e.filter((function(e){return K(e.extension.ExtensionPointCollection)}))}function Q(e){return K(e.extension.ExtensionPointCollection)}function Z(e){var t=Object(f.a)();return t.runningContextualAddinCommand&&t.runningContextualAddinCommand.controlId===e?t.runningContextualAddinCommand:null}var Y=n(2977),$=n(1587);function ee(e){var t=Object(Y.c)(e);if(t)return t.addinCommand;var n=Z(e);return n?n.addinCommand:Object($.a)(e)}var te=function(e){var t=Object(f.a)().EnabledAddinCommands;return t?t.getAutoRunAddinsByLaunchEventType(e).map((function(t){return t.AddinCommands.get(e.toString())})):[]};function ne(e){var t=Object(f.a)().activeDialog;return t&&e===t.controlId?5:Object(Y.c)(e)?2:Z(e)?1:Object($.a)(e)?3:4}function re(e){var t=Object(f.a)(),n=function(e,t){return Object(i.__spread)(t.taskPanes.values()).filter((function(t){return t.hostItemIndex===e})).map((function(e){return e.controlId}))}(e,t),r=function(e,t){var n=t.runningUILessExtendedAddinCommands;if(n.has(e))return Object(i.__spread)(n.get(e).keys());return[]}(e,t),o=function(e,t){var n=t.runningContextualAddinCommand;if(n&&n.hostItemIndex===e)return[t.runningContextualAddinCommand.controlId];return[]}(e,t);return Object(i.__spread)(n,r,o)}var oe=n(1469);function ie(){return z.a.Context}function ae(e){var t=ee(e);return t&&t.extension.Id}function se(e){return z.a.HostItems.get(e)}function ce(e){var t=Object(Y.c)(e);if(t)return t.hostItemIndex;var n=Z(e);return n?n.hostItemIndex:Object($.c)(e)}function ue(e){return ee(e).extension.WebApplicationResource}var le=n(2129);function de(e){Object(le.a)()?e():Object(h.when)(le.a,e)}function fe(){return z.a.ExtensibilityStateIsDirty}var pe=n(428);function me(){return Object(pe.a)()}var ge=Object(g.action)("terminateContextualCallout")((function(){var e=Object(f.a)();e.runningContextualAddinCommand=null,e.contextualCalloutState.contextualAnchor=null,e.contextualCalloutState.activeContextualAddinCommands=[],e.contextualCalloutState.selectedTerms=[]})),he=Object(g.action)("initializeContextualCallout")((function(e,t,n){var r=Object(f.a)();r.runningContextualAddinCommand&&ge();var o=se(t),a=new h.ObservableMap,s=r.contextualCalloutState;s.selectedTerms=[],e.forEach((function(e){var t=o.contextualTerms.get(e).slice();t&&t.length>0&&(s.selectedTerms.push(e),t.forEach((function(e){a.set(e.get_Id(),e)})))})),s.contextualAnchor=n,s.activeContextualAddinCommands=Object(i.__spread)(a.values()),s.hostItemIndex=t})),ve=Object(g.action)("initializeExtensibilityHostItem")((function(e){z.a.HostItems.has(e)||z.a.HostItems.set(e,{contextualTerms:null,contextualEvaluationResults:null})})),ye=n(5614);function be(){return!!z.a.activeDialog}var _e=Object(d.mutatorAction)("setActiveDialog",(function(e){Object(f.a)().activeDialog=e})),Se=Object(g.action)("setEnabledAddinCommands")((function(e){z.a.EnabledAddinCommands=e})),Ce=n(76),Oe=n(103),Ae=Object(g.action)("setExtensibilityContext")((function(e){var t;if(null==e?void 0:e.Extensions){for(var n=Object(Oe.i)(),r=null===(t=null==n?void 0:n.UserOptions)||void 0===t?void 0:t.WebSuggestedRepliesEnabledForUser,o=-1,i=0;i<e.Extensions.length;i++){var a=e.Extensions[i];"599e5de2-d41c-442a-bdb4-92eafa18a0dc"===a.Id&&null==a.ExtensionPointCollection.DetectedEntity&&(a.ExtensionPointCollection.DetectedEntity=a.ExtensionPointCollection.CustomPane,a.ExtensionPointCollection.DetectedEntity.Label=a.DisplayName),r&&"bc13b9d0-5ba2-446a-956b-c583bdc94d5e"===a.Id&&Object(Ce.h)("mc-smartReplyWithCustomMeeting")&&(o=i)}o>=0&&e.Extensions.splice(o,1)}z.a.Context=e})),Ie=Object(g.action)("setExtensibilityStateIsDirty")((function(e){z.a.ExtensibilityStateIsDirty=e})),xe=Object(g.action)("setContextualAddinCommand")((function(e,t,n){Object(f.a)().runningContextualAddinCommand=function(e,t,n){return{controlId:e,addinCommand:t,hostItemIndex:n}}(e,n,t)})),Ee=Object(d.mutatorAction)("setTaskPaneAddinCommand",(function(e,t,n,r,o,i){var a=Object(f.a)().taskPanes,s=function(e,t,n,r,o,i){return{controlId:e,addinCommand:t,hostItemIndex:n,mode:r,errorType:o||0,initializationContext:i}}(e,n,t,o,null,i);a.set(r,s)})),Te=n(1772),Pe=Object(d.mutatorAction)("destroyBlockedAddinCommandsList",(function(e){Object(f.a)().blockedAddinCommands.delete(e)})),we=Object(d.mutatorAction)("terminateTaskPaneAddin",(function(e){Object(f.a)().taskPanes.delete(e)})),Me=Object(d.mutatorAction)("terminatePersistantTaskPaneAddinWithAppId",(function(e){var t=Object(f.a)().taskPanes.get("Persistent");t&&t.addinCommand.extension.Id===e&&Object(f.a)().taskPanes.delete("Persistent")})),Re=Object(g.action)("terminateUiLessExtendedAddinCommand")((function(e,t,n,r){!function(e,t){_[e]&&(_[e].resolve(t),delete _[e])}(e,{status:n,allowEvent:null==r?void 0:r.allowEvent});var o=Object(f.a)().runningUILessExtendedAddinCommands;o.has(t)&&(o.get(t).delete(e),0===o.get(t).size&&o.delete(t))})),je=Object(d.mutatorAction)("toggleTaskPaneType",(function(e){var t=Object(Y.b)(e);if(t){var n=Object(f.a)().taskPanes;n.delete(e),n.set(Object(Y.a)(e),t)}})),ke=Object(g.action)("updateConsentState")((function(e,t,n){ee(t).extension.ConsentState=Number(n)})),Ne=Object(g.select)({hostItem:function(e,t,n){return z.a.HostItems.get(e)}})(Object(g.action)("updateContextualEvaluation")((function(e,t,n,r){var o=r.hostItem;o&&(o.contextualTerms=t,o.contextualEvaluationResults=n)}))),De=Object(g.action)("updateEntityExtractionResult")((function(e,t){e.EntityExtractionResult=t})),Fe=Object(g.action)("updateExtensionSettings")((function(e,t,n){ee(t).extension.Settings=n})),Le=n(5615),Ue=Object(d.mutatorAction)("updatePersistentTaskPaneHostItem",(function(e){Object(Y.b)("Persistent").hostItemIndex=e})),Be=Object(g.action)("setCompliance")((function(e){var t=JSON.parse(e);t&&t.hasOwnProperty("IsMinor")&&(z.a.compliance.isMinor=t.IsMinor)}));n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"J",(function(){return L})),n.d(t,"e",(function(){return P})),n.d(t,"P",(function(){return w})),n.d(t,"y",(function(){return U.b})),n.d(t,"b",(function(){return B})),n.d(t,"c",(function(){return W})),n.d(t,"g",(function(){return V})),n.d(t,"k",(function(){return z.a})),n.d(t,"h",(function(){return G})),n.d(t,"j",(function(){return q})),n.d(t,"m",(function(){return X})),n.d(t,"f",(function(){return Q})),n.d(t,"l",(function(){return J})),n.d(t,"n",(function(){return ee})),n.d(t,"p",(function(){return te})),n.d(t,"r",(function(){return ne})),n.d(t,"o",(function(){return re})),n.d(t,"A",(function(){return Y.b})),n.d(t,"B",(function(){return Y.c})),n.d(t,"C",(function(){return Y.d})),n.d(t,"z",(function(){return oe.c})),n.d(t,"q",(function(){return oe.a})),n.d(t,"s",(function(){return ie})),n.d(t,"t",(function(){return f.a})),n.d(t,"u",(function(){return ae})),n.d(t,"v",(function(){return se})),n.d(t,"w",(function(){return ce})),n.d(t,"E",(function(){return ue})),n.d(t,"K",(function(){return le.a})),n.d(t,"kb",(function(){return de})),n.d(t,"L",(function(){return fe})),n.d(t,"x",(function(){return me})),n.d(t,"F",(function(){return he})),n.d(t,"G",(function(){return ve})),n.d(t,"I",(function(){return $.d})),n.d(t,"O",(function(){return $.e})),n.d(t,"D",(function(){return $.b})),n.d(t,"N",(function(){return ye.a})),n.d(t,"H",(function(){return be})),n.d(t,"M",(function(){return I})),n.d(t,"Q",(function(){return _e})),n.d(t,"T",(function(){return Se})),n.d(t,"U",(function(){return Ae})),n.d(t,"V",(function(){return Ie})),n.d(t,"S",(function(){return xe})),n.d(t,"W",(function(){return Ee})),n.d(t,"X",(function(){return S})),n.d(t,"Y",(function(){return Te.a})),n.d(t,"i",(function(){return Pe})),n.d(t,"Z",(function(){return ge})),n.d(t,"bb",(function(){return we})),n.d(t,"ab",(function(){return Me})),n.d(t,"cb",(function(){return Re})),n.d(t,"db",(function(){return je})),n.d(t,"eb",(function(){return ke})),n.d(t,"fb",(function(){return Ne})),n.d(t,"gb",(function(){return De})),n.d(t,"hb",(function(){return Fe})),n.d(t,"ib",(function(){return Le.a})),n.d(t,"jb",(function(){return Ue})),n.d(t,"R",(function(){return Be}))},1016:function(e,t,n){"use strict";function r(){return{isDragOver:!1,draggableItemType:null}}n.d(t,"a",(function(){return r}))},1017:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(295),o=n(988),i=n(76);function a(){var e;return(e={})[o.a.SmartSuggestions]={smartSuggestionsEnabled:!0,browserLocationEnabled:!1},e[o.a.DiverseEmojis]={diverseEmojisSelectedSkinTone:""},e[o.a.SurfaceActions]={readSurfaceActions:["Reply","ReplyAll","Forward"].concat(Object(r.a)()?[]:["LikeUnlike"]),readSurfaceAddins:[],composeSurfaceActions:["AddAttachment","AddInlineImage","AddEmoji","ToggleDictation","ProofingOptions","QuickUse","ToggleRibbon","FluidHeroButton"],composeSurfaceAddins:[]},e[o.a.SkypeNotifications]={skypeMessageNotification:1,skypeCallingNotification:1},e[o.a.Confetti]={confettiEnabled:!0},e[o.a.ComposeAssistance]={composeAssistanceEnabled:!0},e[o.a.GdprAdsPrefs]={feature:o.a.GdprAdsPrefs,consentString:null,allowStorageAndAccess:!1,allowPersonalization:!1,allowAdSelectionDeliveryReporting:!1,allowContentSelectionDeliveryReporting:!1,allowMeasurement:!1},e[o.a.CalendarSurfaceAddins]={calendarSurfaceAddins:[]},e[o.a.ExternalImages]={externalImagesSelectedOption:0},e[o.a.EventCapture]={autoCollectionEnabled:!1},e[o.a.Translation]={translationMode:0,targetLanguage:"",excludedLanguages:[]},e[o.a.CalendarSurfaceOptions]={agendaPaneIsClosed:!1,roamingTimeZoneTeachingMomentDisplayed:!1,bannedRoamingTimeZone:null,lastKnownRoamingTimeZone:null,roamingTimeZoneNotificationsIsDisabled:!1,allDayWellHeight:0,numDaysInDayRange:1,workLifeView:3},e[o.a.AmpDeveloper]={enabled:Object(i.h)("rp-ampDefault"),allowedSender:[]},e[o.a.CalendarHelp]={calendarHelpEnabled:!1},e[o.a.LinkedInViewProfile]={dismissed:!1},e[o.a.Bohemia]={bohemiaEnabled:Object(i.h)("cmp-prague")},e[o.a.GdprAdsV2]={feature:o.a.GdprAdsV2,consentString:null,allowStorageAndAccess:!0,allowPersonalization:!0,allowAdSelectionDeliveryReporting:!0,allowContentSelectionDeliveryReporting:!0,allowMeasurement:!0,disselectedVendorId:[],selectedVendorId:[]},e[o.a.GdprAdsV3]={feature:o.a.GdprAdsV3,encodedTCString:null,allStoreAndAccessDevice:!1,allowDevelopAndImproveProduct:!1,allowPersonalisedAds:!1,allowPersonalisedAdsSelectBasicAd:!1,allowPersonalisedAdsApplyMarketResearch:!1,allowPersonalisedAdsMeasureContentPerformance:!1,allowPersonalisedAdsSelectPersonalisedAds:!1,allowPersonalisedAdsMeasureAdPerf:!1,allowPersonalisedAdsSelectPersonalisedContent:!1,allowPersonalisedAdsCreatePersonalisedContentProfile:!1,allowPersonalisedAdsCreatePersonalisedAdsProfile:!1,allowPreciseGeoDataAndIdentifyDevice:!1,allowPreciseGeoDataAndIdentifyDeviceScanDevice:!1,allowPreciseGeoDataAndIdentifyDeviceGeoData:!1,disselectedVendorId:[],selectedVendorId:[]},e[o.a.Proofing]={feature:o.a.Proofing,spellCheckEnabled:!0,grammarEnabled:!0,writingRefinementsEnabled:!0,proofingLocale:void 0,overriddenOptions:void 0},e[o.a.ActiveProxyAddress]={feature:o.a.ActiveProxyAddress,activeProxyAddresses:[]},e[o.a.OutlookSpaces]={feature:o.a.OutlookSpaces,backgroundColor:"",gestureScheme:"pointer",toolboxCollapsed:!0},e[o.a.SxS]={feature:o.a.SxS,hideReadingPane:!1},e}},1025:function(e,t,n){"use strict";var r;!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded",e[e.ErrorLoading=3]="ErrorLoading"}(r||(r={})),t.a=r},1030:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"IndexedPageView:#Exchange"},e)}},1035:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(987);function o(e,t){var n=Object(r.a)(t),o=n&&n.get(e);return null==o?void 0:o.rootFolder}},1042:function(e,t,n){"use strict";var r=n(1251),o=n(1406),i=n(1063);t.a=function(e){return Object(i.a)(e)?Object(r.a)(e):Object(o.a)(e)}},1044:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Primary=0]="Primary",e[e.OverflowMenu=1]="OverflowMenu",e[e.SecondaryReadingPane=2]="SecondaryReadingPane",e[e.Compose=3]="Compose",e[e.FloatingChat=4]="FloatingChat"}(r||(r={}))},1046:function(e,t,n){"use strict";var r={};function o(e,t){s(e)&&i(e),r[e]=t}function i(e){delete r[e]}function a(e){return r[e]}function s(e){return!!r[e]}n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}))},1049:function(e,t,n){"use strict";n(1);var r=n(1772),o=n(1871),i=n(4),a=Object(i.mutatorAction)("appendOnSendAction",(function(e,t){var n=e.appendOnSend;if(n){for(var r=!1,o=0;o<n.length;o++)if(n[o].id===t.id){e.appendOnSend[o]=t,r=!0;break}r||e.appendOnSend.push(t)}})),s=n(958),c=n(1469),u=n(1818),l=n(1730),d=n(1850),f=n(1587),p=n(1876),m=n(1548),g=n(1111),h=n(1666),v=n(1689),y=n(1731),b=n(1732),_=n(1733);n.d(t,"O",(function(){return r.a})),n.d(t,"P",(function(){return o.a})),n.d(t,"k",(function(){return a})),n.d(t,"E",(function(){return s.q})),n.d(t,"M",(function(){return s.y})),n.d(t,"s",(function(){return s.d})),n.d(t,"H",(function(){return s.t})),n.d(t,"K",(function(){return s.w})),n.d(t,"L",(function(){return s.x})),n.d(t,"J",(function(){return s.v})),n.d(t,"I",(function(){return s.u})),n.d(t,"t",(function(){return s.e})),n.d(t,"u",(function(){return s.f})),n.d(t,"v",(function(){return s.g})),n.d(t,"z",(function(){return s.l})),n.d(t,"N",(function(){return s.z})),n.d(t,"x",(function(){return s.j})),n.d(t,"F",(function(){return s.r})),n.d(t,"G",(function(){return s.s})),n.d(t,"i",(function(){return s.a})),n.d(t,"y",(function(){return s.k})),n.d(t,"D",(function(){return s.p})),n.d(t,"w",(function(){return s.i})),n.d(t,"q",(function(){return s.b})),n.d(t,"A",(function(){return s.m})),n.d(t,"r",(function(){return s.c})),n.d(t,"C",(function(){return s.o})),n.d(t,"B",(function(){return s.n})),n.d(t,"m",(function(){return c.a})),n.d(t,"o",(function(){return c.b})),n.d(t,"h",(function(){return u.a})),n.d(t,"g",(function(){return l.a})),n.d(t,"l",(function(){return d.a})),n.d(t,"p",(function(){return f.d})),n.d(t,"e",(function(){return p.a})),n.d(t,"n",(function(){return m.e})),n.d(t,"b",(function(){return g.b})),n.d(t,"a",(function(){return h.a})),n.d(t,"j",(function(){return v.a})),n.d(t,"c",(function(){return y.a})),n.d(t,"d",(function(){return b.a})),n.d(t,"f",(function(){return _.a}))},1051:function(e,t,n){"use strict";var r;!function(e){e[e.Unsupported=0]="Unsupported",e[e.Image=1]="Image",e[e.MailItem=2]="MailItem",e[e.CalendarEvent=3]="CalendarEvent",e[e.Wac=4]="Wac",e[e.SuiteExtensions=5]="SuiteExtensions",e[e.Audio=6]="Audio",e[e.Text=7]="Text",e[e.NativeView=8]="NativeView",e[e.GoogleDoc=9]="GoogleDoc",e[e.PdfJs=10]="PdfJs",e[e.ItemAttachment=11]="ItemAttachment",e[e.Video=12]="Video"}(r||(r={})),t.a=r},1052:function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},1054:function(e,t,n){"use strict";t.a=function(e,t){return e===t||e!=e&&t!=t}},1060:function(e,t,n){"use strict";var r=/\(([^)]*)\)/gi,o=/\([^)]*\)|[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/gi,i=/\s+/gi;function a(e){var t="";if(!e)return t;var n=(e=(e=(e=(e=e.replace(r,"")).replace(o,"")).replace(i," ")).trim()).split(" ");return n.length>=2?(t+=n[0].charAt(0).toUpperCase(),t+=n[n.length-1].charAt(0).toUpperCase()):0!=n.length&&(t+=n[0].charAt(0).toUpperCase()),t}var s=n(967),c=Object.keys(s.a).length/2;function u(e){if(!e)return null;for(var t=0,n=e.length-1;n>=0;n--){var r=e.charCodeAt(n),o=n%8;t^=(r<<o)+(r>>8-o)}return t%c}function l(e){return{personaId:e,displayName:e,postalAddress:{Type:"Business",LocationSource:"None"},displayAddress:"",initials:a(e),textBoyColor:u(e),selectionSource:"ExplicitTyping",personaType:"Unknown",personaControlId:e}}var d=n(1096),f=n(147);function p(e){var t;if(e){var n=function(e){return e?null!=e.HomeAddressesArray&&e.HomeAddressesArray.length>0?e.HomeAddressesArray[0].Value:null!=e.BusinessAddressesArray&&e.BusinessAddressesArray.length>0?e.BusinessAddressesArray[0].Value:null!=e.OtherAddressesArray&&e.OtherAddressesArray.length>0?e.OtherAddressesArray[0].Value:null:null}(e),r=Object(d.c)(e.DisplayName,n);return"Room"==e.PersonaTypeString&&(n.LocationUri=e.EmailAddress.EmailAddress),{personaId:null===(t=e.PersonaId)||void 0===t?void 0:t.Id,feedbackId:e.FeedbackId,displayName:r,postalAddress:n,emailAddress:e.EmailAddress,displayAddress:Object(d.a)(n),initials:a(r),textBoyColor:u(r),selectionSource:"LocationWell",personaType:Object(f.b)(e.PersonaTypeString)?"Unknown":e.PersonaTypeString,personaControlId:null==e.PersonaId?e.FeedbackId:e.PersonaId.Id,availability:e.Availability,numberOfAvailableTimeSlots:e.NumberOfAvailableTimeSlots,totalNumberOfTimeSlots:e.TotalNumberOfTimeSlots,isPartialAvailability:e.IsPartialAvailability,capacity:e.Capacity,entityType:e.EntityType,audioDeviceName:e.AudioDeviceName,displayDeviceName:e.DisplayDeviceName,videoDeviceName:e.VideoDeviceName,isWheelChairAccessible:e.IsWheelChairAccessible}}return null}var m=n(1075);function g(e){if((null==e?void 0:e.DisplayName)&&e.PostalAddress){var t=Object(d.c)(e.DisplayName,e.PostalAddress),n=Object(m.a)(e.PostalAddress)&&!Object(f.b)(e.PostalAddress.LocationUri)?{EmailAddress:e.PostalAddress.LocationUri}:null;return{personaId:e.Id,displayName:e.DisplayName,postalAddress:e.PostalAddress,emailAddress:n,displayAddress:Object(d.a)(e.PostalAddress),initials:a(t),textBoyColor:u(t),personaType:Object(m.a)(e.PostalAddress)?"Room":"Unknown",personaControlId:e.DisplayName}}return null}var h=n(0),v=n(42),y=n(1),b=n(9),_=n(27),S=n(287),C=n(279),O=290,A=135;function I(e,t,n,r,o,i){o=o||O,i=i||A;var a=Object(_.a)();if((!Object(f.b)(n)||e&&t)&&a.PolicySettings.PlacesEnabled){var s=Object(b.c)("/OWS/beta/Location/locationmap?Latitude={0}&Longitude={1}&Address={2}&Culture={3}&Width={4}&Height={5}",e&&e.toString(),t&&t.toString(),encodeURIComponent(n),a.SessionSettings.UserCulture,o,i);Object(S.b)(s,void 0,!0).then((function(e){Object(C.a)(e.status)?e.json().then((function(e){r("data:image/png;base64,"+e.ib)})):r("")}))}else r("")}var x=n(1404),E=n(79),T=n(316),P=Object(v.a)((function(e){var t,n,r=y.useRef(),o=Object(h.__read)(y.useState(null),2),i=o[0],a=o[1];y.useEffect((function(){var t,n=!0;return(null===(t=e.locationPersona.postalAddress)||void 0===t?void 0:t.Latitude)&&e.locationPersona.postalAddress.Longitude&&!Object(f.b)(e.locationPersona.displayName)&&!i&&"pending"!=r.current&&"failed"!=r.current&&(r.current="pending",I(e.locationPersona.postalAddress.Latitude,e.locationPersona.postalAddress.Longitude,null,(function(e){n&&(a(e),e?r.current="success":(r.current="failed",E.g.warn("getLocationPhoto.downloadLocationPhoto failed")))}),64,64)),function(){return n=!1}}),[null===(t=e.locationPersona.postalAddress)||void 0===t?void 0:t.Latitude,null===(n=e.locationPersona.postalAddress)||void 0===n?void 0:n.Longitude,e.locationPersona.displayName]);var c=e.locationPersona,u=e.className,l=e.size,d=e.showPersonaDetails;if(c){var p={};return Object(f.b)(i)?T(p,{imageInitials:c.initials,initialsColor:c.textBoyColor}):T(p,{imageUrl:i,imageShouldFadeIn:!1}),y.createElement(x.a,Object(h.__assign)({className:u,presence:s.b.none,hidePersonaDetails:!d,size:l,text:c.displayName,secondaryText:c.displayAddress},p))}return null})),w="https://www.bing.com/maps?v=2&rtp=~pos.{0}_{1}_{2}_{3}&FORM=CalLoc",M="https://www.bing.com/maps?v=2&rtp=~adr.{0}_{1}&FORM=CalLoc";function R(e,t,n,r){return e&&t?Object(b.c)(w,e.toString(),t.toString(),n,r):n?Object(b.c)(M,n,r):null}var j=n(1125),k=n(108);function N(e,t){return{Id:t,DisplayName:e,PostalAddress:{LocationSource:"Resource",LocationUri:t,Type:"Business"}}}var D=n(994);function F(e){return{EmailAddress:e.PostalAddress.LocationUri,Name:e.DisplayName}}function L(e){return{Id:e,DisplayName:e,PostalAddress:{Type:"Business",LocationSource:"None"}}}function U(e,t,n,r){return e?{PostalAddress:{LocationUri:n,LocationSource:r,Type:t,Street:e.streetAddress,City:e.addressLocality,State:e.addressRegion,Country:e.addressCountry,PostalCode:e.postalCode,PostOfficeBox:e.postOfficeBoxNumber,Longitude:e.longitude,Latitude:e.latitude}}:null}function B(e){return!Object(j.a)(e.PostalAddress)&&/^((http[s]?:\/\/)|(www\.)?){1}[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,6}\b([-a-zA-Z0-9@:*%_\+.~#?&//=]*)/i.test(e.DisplayName)}function H(e){return function(){var t=/^http*/i.test(e)?e:"//"+e;window.open(t,"_blank")}}function W(e){var t=[];return e&&"string"!=typeof e&&t.push({Id:e.personaId,DisplayName:e.displayName,PostalAddress:e.postalAddress}),t}n(1265);n.d(t,"r",(function(){return z})),n.d(t,"k",(function(){return l})),n.d(t,"j",(function(){return p})),n.d(t,"i",(function(){return g})),n.d(t,"a",(function(){return P})),n.d(t,"l",(function(){return R})),n.d(t,"m",(function(){return I})),n.d(t,"o",(function(){return j.a})),n.d(t,"p",(function(){return m.a})),n.d(t,"e",(function(){return N})),n.d(t,"b",(function(){return D.a})),n.d(t,"c",(function(){return D.b})),n.d(t,"d",(function(){return D.c})),n.d(t,"n",(function(){return F})),n.d(t,"f",(function(){return L})),n.d(t,"g",(function(){return U})),n.d(t,"s",(function(){return H})),n.d(t,"q",(function(){return B})),n.d(t,"h",(function(){return W}));var V=new k.c((function(){return n.e(1181).then(n.bind(null,15363))})),z=new k.b(V,(function(e){return e.createTxpPostalAddressFromLocationPersona}))},1063:function(e,t,n){"use strict";var r=n(1138),o=n(1119);t.a=function(e){return null!=e&&Object(o.a)(e.length)&&!Object(r.a)(e)}},1064:function(e,t,n){"use strict";var r=n(1278),o=n(1168);t.a=function(e,t,n,i){var a=!n;n||(n={});for(var s=-1,c=t.length;++s<c;){var u=t[s],l=i?i(n[u],e[u],u,n,e):void 0;void 0===l&&(l=e[u]),a?Object(o.a)(n,u,l):Object(r.a)(n,u,l)}return n}},1066:function(e,t,n){"use strict";var r,o,i;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i})),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp",e[e.Peek=5]="Peek",e[e.CalendarCard=6]="CalendarCard"}(r||(r={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity",e[e.InsightMessage=7]="InsightMessage",e[e.External=8]="External"}(o||(o={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(i||(i={}))},1074:function(e,t,n){"use strict";var r;!function(e){e[e.ChangePermissions=0]="ChangePermissions",e[e.CopyLink=1]="CopyLink",e[e.Download=2]="Download",e[e.OpenInNewTab=3]="OpenInNewTab",e[e.Preview=4]="Preview",e[e.SaveToCloud=5]="SaveToCloud",e[e.ViewInProvider=6]="ViewInProvider",e[e.ConvertClassicToCloudy=7]="ConvertClassicToCloudy",e[e.ConvertCloudyToClassic=8]="ConvertCloudyToClassic",e[e.ImportCalendarEventAttachment=9]="ImportCalendarEventAttachment",e[e.MoveAttachmentToInline=10]="MoveAttachmentToInline",e[e.RefreshLink=11]="RefreshLink",e[e.IgnoreExpiration=12]="IgnoreExpiration"}(r||(r={})),t.a=r},1075:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1125);function o(e){return Object(r.a)(e)&&"Resource"===e.LocationSource}},1077:function(e,t,n){"use strict";var r=n(980),o=n(966);function i(e){return e.map((function(e){return{fileType:r.a.Uri,name:e.name,type:Object(o.b)(e.url)||"",size:0,uri:e.url}}))}var a=n(79);function s(e,t,n){if(e.length!=t.length)return a.d("The sizes of subjects and latestItemIds are different"),null;for(var o=[],i=0;i<e.length;i++){var s={fileType:r.a.MailItem,name:e[i],size:(null==n?void 0:n[i])||0,itemId:t[i]};o.push(s)}return o}function c(e,t,n){var o=[],i={fileType:r.a.MailItem,name:e,size:n||0,mimeContent:t};return o.push(i),o}function u(e){if(!e)return null;for(var t=[],n=0;n<e.length;n++){var o=e[n],i={fileType:r.a.Local,name:o.name,size:o.size,type:o.type,fileObject:o};t.push(i)}return t}function l(e){if(!e)return null;for(var t=[],n=0;n<e.length;n++){var r=e[n],o={fileType:r.fileType,name:r.name,size:r.size,type:r.type,dataUri:r.dataUri};t.push(o)}return t}function d(e){var t,n;return null===e?null:{fileType:r.a.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:(null===(t=e.Thumbnail)||void 0===t?void 0:t.Url)||"",previewUrl:(null===(n=e.Preview)||void 0===n?void 0:n.Url)||"",type:e.MimeType}}function f(e){return null===e?null:{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:r.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}var p={BOX:"Box",DROPBOX:"Dropbox",FACEBOOK:"Facebook",GDRIVE:"GDrive",MAILBOX:"Mailbox",ONE_DRIVE_CONSUMER:"OneDriveConsumer",ONE_DRIVE_PRO:"OneDrivePro",RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:"WopiBox",WOPI_EGNYTE:"WopiEgnyte"};function m(e){switch(e?e.toLowerCase():null){case p.ONE_DRIVE_PRO.toLowerCase():return 0;case p.GDRIVE.toLowerCase():return 5;case p.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case p.DROPBOX.toLowerCase():return 2;case p.BOX.toLowerCase():return 3;case p.WOPI_BOX.toLowerCase():return 7;case p.WOPI_EGNYTE.toLowerCase():return 8;case p.MAILBOX.toLowerCase():return 4;case p.FACEBOOK.toLowerCase():return 6;default:return null}}n.d(t,"i",(function(){return i})),n.d(t,"h",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return r.a}))},1078:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.ok=0]="ok",e[e.cancel=1]="cancel",e[e.dismiss=2]="dismiss",e[e.continue=3]="continue"}(r||(r={}))},1079:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(0),o=n(1),i=n(253),a=n(106),s=n(898),c=n(507),u=n(100),l=n(1124),d=n(967),f=Object(i.a)(),p=function(e){function t(t){var n=e.call(this,t)||this;return n._onRenderPersonaCoin=function(e){return o.createElement(l.a,Object(r.__assign)({},e))},n}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this._onRenderText(this._getText()),t=this._onRenderText(this.props.secondaryText),n=this._onRenderText(this.props.tertiaryText),i=this._onRenderText(this.props.optionalText),s=this.props,c=s.hidePersonaDetails,u=s.onRenderOptionalText,l=void 0===u?i:u,p=s.onRenderPrimaryText,m=void 0===p?e:p,g=s.onRenderSecondaryText,h=void 0===g?t:g,v=s.onRenderTertiaryText,y=void 0===v?n:v,b=s.onRenderPersonaCoin,_=void 0===b?this._onRenderPersonaCoin:b,S=this.props.size,C=this.props,O=C.allowPhoneInitials,A=C.className,I=C.coinProps,x=C.showUnknownPersonaCoin,E=C.coinSize,T=C.styles,P=C.imageAlt,w=C.imageInitials,M=C.imageShouldFadeIn,R=C.imageShouldStartVisible,j=C.imageUrl,k=C.initialsColor,N=C.isOutOfOffice,D=C.onPhotoLoadingStateChange,F=C.onRenderCoin,L=C.onRenderInitials,U=C.presence,B=C.presenceTitle,H=C.presenceColors,W=C.showInitialsUntilImageLoads,V=C.showSecondaryText,z=C.theme,G=Object(r.__assign)({allowPhoneInitials:O,showUnknownPersonaCoin:x,coinSize:E,imageAlt:P,imageInitials:w,imageShouldFadeIn:M,imageShouldStartVisible:R,imageUrl:j,initialsColor:k,onPhotoLoadingStateChange:D,onRenderCoin:F,onRenderInitials:L,presence:U,presenceTitle:B,showInitialsUntilImageLoads:W,size:S,text:this._getText(),isOutOfOffice:N,presenceColors:H},I),q=f(T,{theme:z,className:A,showSecondaryText:V,presence:U,size:S}),K=Object(a.j)(this.props,a.h),X=o.createElement("div",{className:q.details},this._renderElement(q.primaryText,m,e),this._renderElement(q.secondaryText,h,t),this._renderElement(q.tertiaryText,y,n),this._renderElement(q.optionalText,l,i),this.props.children);return o.createElement("div",Object(r.__assign)({},K,{className:q.root,style:E?{height:E,minWidth:E}:void 0}),_(G,this._onRenderPersonaCoin),(!c||S===d.c.size8||S===d.c.size10||S===d.c.tiny)&&X)},t.prototype._renderElement=function(e,t,n){return o.createElement("div",{dir:"auto",className:e},t&&t(this.props,n))},t.prototype._getText=function(){return this.props.text||this.props.primaryText||""},t.prototype._onRenderText=function(e){return e?function(){return o.createElement(s.a,{content:e,overflowMode:c.a.Parent,directionalHint:u.DirectionalHint.topLeftEdge},e)}:void 0},t.defaultProps={size:d.c.size48,presence:d.b.none,imageAlt:""},t}(o.Component)},1081:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a}));var r=n(976),o=n(283);function i(e){return"msgfolderroot"===e.distinguishedFolderId}var a=Object(o.select)({folderTable:function(){return r.b.folderTable}})((function(e,t,n){var r=!!e&&e.ParentFolderId;if(!r)return!1;for(var o=n.folderTable.get(r.Id);o;){if(o.distinguishedFolderId==t)return!0;if(!o.ParentFolderId)return!1;o=n.folderTable.get(o.ParentFolderId.Id)}return!1}));t.a=Object(o.select)({folderTable:function(){return r.b.folderTable}})((function(e,t,n){return function(e,t){return!!e&&e.distinguishedFolderId==t}(e,t)||a(e,t,n)}))},1082:function(e,t,n){"use strict";var r=n(108),o=n(947);function i(){return a(Object(o.C)())}function a(e){return e&&2==e.tableQuery.type?e.tableQuery.folderId:null}function s(){var e=Object(o.C)();return e&&2==e.tableQuery.type}function c(e){return!!e&&(2==e.type||u(e))}function u(e){return!(!e||1!=e.type)&&"Group"==e.searchScope.kind}function l(e){return 2==e.type?e.folderId:u(e)?e.searchScope.groupId:null}function d(){var e=Object(o.C)();return e&&c(e.tableQuery)}n.d(t,"g",(function(){return p})),n.d(t,"h",(function(){return m})),n.d(t,"m",(function(){return g})),n.d(t,"l",(function(){return h})),n.d(t,"j",(function(){return v})),n.d(t,"i",(function(){return y})),n.d(t,"k",(function(){return b})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"f",(function(){return d}));var f=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(446)]).then(n.bind(null,15205))})),p=new r.b(f,(function(e){return e.getGroupDisplayName})),m=new r.b(f,(function(e){return e.getGroupDisplayNameFromTableView})),g=new r.b(f,(function(e){return e.isPrivateUnjoinedGroup})),h=new r.b(f,(function(e){return e.isJoinedGroup})),v=new r.b(f,(function(e){return e.getRetentionPolicyTagsForGroup})),y=new r.b(f,(function(e){return e.getRetentionPolicyTagListForGroupTableQuery})),b=new r.b(f,(function(e){return e.isGroupOwner}))},1085:function(e,t,n){"use strict";var r=n(108),o=n(1005),i=n(1540),a=n(0),s=n(1044);function c(e){var t,n,r=Object(o.a)();try{for(var i=Object(a.__values)(r.tabs),c=i.next();!c.done;c=i.next()){var u=c.value;if(u.type!==s.a.Primary&&u.data==e)return u}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return null}var u=n(1935);function l(e){var t,n,r=function(e){var t=Object(u.a)(e);return t?t.tabId:null}(e);if(r){var i=Object(o.a)();try{for(var s=Object(a.__values)(i.tabs),c=s.next();!c.done;c=s.next()){var l=c.value;if(l.id===r)return l.sxsId}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}}return null}function d(e){var t,n,r,i,c=Object(o.a)();try{for(var u=Object(a.__values)(c.tabs),l=u.next();!l.done;l=u.next()){var d=l.value;if(d.type!==s.a.Primary&&(null===(i=null===(r=d.data)||void 0===r?void 0:r.id)||void 0===i?void 0:i.Id)==e)return!0}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}return!1}var f=n(1555);n.d(t,"f",(function(){return m})),n.d(t,"g",(function(){return g})),n.d(t,"h",(function(){return h})),n.d(t,"j",(function(){return v})),n.d(t,"i",(function(){return y})),n.d(t,"d",(function(){return o.a})),n.d(t,"k",(function(){return o.b})),n.d(t,"c",(function(){return i.a})),n.d(t,"b",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"m",(function(){return d})),n.d(t,"a",(function(){return s.a})),n.d(t,"l",(function(){return f.b}));var p=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(563)]).then(n.bind(null,15204))})),m=new r.a(p,(function(e){return e.activateTab})),g=new r.a(p,(function(e){return e.addTab})),h=new r.a(p,(function(e){return e.closeTab})),v=new r.a(p,(function(e){return e.setTabIsShown})),y=new r.b(p,(function(e){return e.getTabById}))},1088:function(e,t,n){"use strict";n.d(t,"b",(function(){return u}));var r=n(0),o=n(24),i=n(76),a=n(1367),s=n(4),c={conversationReadingPaneViewState:null,loadedItemReadingPaneViewStates:new o.ObservableMap({}),loadedConversationReadingPaneViewStates:new o.ObservableMap({}),itemReadingPaneViewState:null,itemPreviewPaneViewState:null,itemPrintPaneViewState:null,deeplinkId:null,shouldShowMobileUpsellEmptyState:!1,primaryReadingPaneTabId:null,sxsId:null},u=Object(s.createStore)("readingpane",c),l=u();a.a.registerReference((function(){var e,t;return Object(i.h)("rp-persistedReadingPaneTabs")?Object(r.__spread)(l.loadedConversationReadingPaneViewStates.keys()):null===(t=null===(e=l.conversationReadingPaneViewState)||void 0===e?void 0:e.conversationId)||void 0===t?void 0:t.Id})),t.a=l},1090:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1608);function o(){return r.a}},1091:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n(972),o=n(1011),i=n(60),a=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],s=[".tiff",".tif"];function c(e,t,n){return void 0===n&&(n=!0),u(Object(r.a)(e)||Object(o.a)(t),n)}function u(e,t){return void 0===t&&(t=!0),!!e&&(a.indexOf(e.toLowerCase())>=0||t&&s.indexOf(e.toLowerCase())>=0&&(Object(i.e)()||Object(i.d)()||Object(i.h)()||Object(i.g)()&&!Object(i.l)()))}},1096:function(e,t,n){"use strict";var r=n(27),o=n(147),i="en-us",a={"am-et":"a_c_pc_pr_ctry","ar-dz":"a_pc_c_pr_ctry","ar-bh":"a_pc_c_pr_ctry","ar-eg":"a_ctry_c_pr_pc","ar-iq":"a_pc_c_pr_ctry","ar-jo":"a_c_pc_pr_ctry","ar-kw":"a_pc_c_pr_ctry","ar-lb":"a_c_pc_pr_ctry","ar-ly":"a_pc_c_pr_ctry","ar-ma":"a_pc_c_pr_ctry","ar-om":"a_c_pr_ctry_pc","ar-qa":"a_pc_c_pr_ctry","ar-sa":"a_c_pc_pr_ctry","ar-sy":"a_pc_c_pr_ctry","ar-tn":"a_pc_c_pr_ctry","ar-ae":"a_pc_c_pr_ctry","ar-ye":"a_pc_c_pr_ctry","eu-es":"a_pc_c_pr_ctry","bn-in":"a_c_pc_pr_ctry","bg-bg":"a_pc_c_pr_ctry","ca-es":"a_pc_c_pr_ctry","zh-cn":"pc_ctry_pr_c_a","zh-sg":"a_c_pc_pr_ctry","zh-hk":"ctry_pc_pr_c_a","zh-mo":"ctry_pr_c_pc_a","zh-tw":"pc_ctry_pr_c_a","hr-hr":"a_pc_c_pr_ctry","cs-cz":"a_pc_c_pr_ctry","da-dk":"a_pc_c_pr_ctry","nl-be":"a_pc_c_pr_ctry","nl-nl":"a_pc_c_pr_ctry","en-au":"a_c_pc_pr_ctry","en-bz":"a_pc_c_pr_ctry","en-ca":"a_c_pc_pr_ctry","en-ie":"a_c_pc_pr_ctry","en-jm":"a_pc_c_pr_ctry","en-nz":"a_c_pc_pr_ctry","en-ph":"a_pc_pr_c_ctry","en-za":"a_c_pc_pr_ctry","en-tt":"a_pc_c_pr_ctry","en-gb":"a_c_pc_pr_ctry","en-us":"a_c_pr_pc_ctry","en-zw":"a_pc_c_pr_ctry","et-ee":"a_pc_c_pr_ctry","fil-ph":"a_pc_pr_c_ctry","fi-fi":"a_pc_c_pr_ctry","fr-be":"a_pc_c_pr_ctry","fr-ca":"a_c_pc_pr_ctry","fr-fr":"a_pc_c_pr_ctry","fr-lu":"a_pc_c_pr_ctry","fr-mc":"a_pc_c_pr_ctry","fr-ch":"a_pc_c_pr_ctry","gl-es":"a_pc_c_pr_ctry","de-at":"a_pc_c_pr_ctry","de-de":"a_pc_c_pr_ctry","de-li":"a_pc_c_pr_ctry","de-lu":"a_pc_c_pr_ctry","de-ch":"a_pc_c_pr_ctry","el-gr":"a_pc_c_pr_ctry","gu-in":"a_c_pc_pr_ctry","he-il":"a_pc_c_pr_ctry","hi-in":"a_c_pc_pr_ctry","hu-hu":"c_a_pc_pr_ctry","is-is":"a_pc_c_pr_ctry","id-id":"a_c_pc_pr_ctry","it-it":"a_pc_c_pr_ctry","it-ch":"a_pc_c_pr_ctry","ja-jp":"pc_pr_c_a_ctry","kn-in":"a_c_pc_pr_ctry","kk-kz":"ctry_pr_c_pc_a","sw-ke":"a_c_pc_pr_ctry","ko-kr":"pc_pr_c_a_ctry","lv-lv":"a_c_pc_pr_ctry","lt-lt":"a_c_pc_pr_ctry","ms-bn":"a_c_pc_pr_ctry","ms-my":"a_pc_c_pr_ctry","ml-in":"a_c_pc_pr_ctry","mr-in":"a_c_pc_pr_ctry","nb-no":"a_pc_c_pr_ctry","or-in":"a_c_pc_pr_ctry","fa-ir":"a_c_pc_pr_ctry","pl-pl":"a_pc_c_pr_ctry","pt-br":"a_pc_c_pr_ctry","pt-pt":"a_pc_c_pr_ctry","ro-ro":"a_pc_c_pr_ctry","ru-ru":"ctry_pc_pr_c_a","sr-cyrl-cs":"a_pc_c_pr_ctry","sk-sk":"a_pc_c_pr_ctry","sl-si":"a_pc_c_pr_ctry","es-ar":"a_pc_c_pr_ctry","es-bo":"a_pc_c_pr_ctry","es-cl":"a_pc_c_pr_ctry","es-co":"a_pc_c_pr_ctry","es-cr":"a_pc_c_pr_ctry","es-do":"a_pc_c_pr_ctry","es-ec":"a_pc_c_pr_ctry","es-sv":"a_c_pc_pr_ctry","es-gt":"a_pc_c_pr_ctry","es-hn":"a_pc_c_pr_ctry","es-mx":"a_pc_c_pr_ctry","es-ni":"a_c_pc_pr_ctry","es-pa":"a_pc_c_pr_ctry","es-py":"a_pc_c_pr_ctry","es-pe":"a_pc_c_pr_ctry","es-pr":"a_c_pc_pr_ctry","es-es":"a_pc_c_pr_ctry","es-us":"a_c_pc_pr_ctry","es-uy":"a_pc_c_pr_ctry","es-ve":"a_pc_c_pr_ctry","sv-fi":"a_pc_c_pr_ctry","sv-se":"a_pc_c_pr_ctry","ta-in":"a_c_pc_pr_ctry","te-in":"a_c_pc_pr_ctry","th-th":"a_c_pc_pr_ctry","tr-tr":"a_pc_pr_c_ctry","uk-ua":"ctry_pc_pr_c_a","ur-pk":"a_c_pc_pr_ctry","cy-gb":"a_c_pc_pr_ctry"};var s=", ";function c(e,t,n,r,i,a){var s=[];Object(o.b)(e)||(s[s.length]=e);var c="";return Object(o.b)(t)||(c=t),Object(o.b)(n)||(c=Object(o.b)(c)?n:c+a+n),Object(o.b)(r)||(c=Object(o.b)(c)?r:c+a+r),Object(o.b)(c)||(s[s.length]=c),Object(o.b)(i)||(s[s.length]=i),s}function u(e,t,n,u,l){var d=function(){var e=Object(r.a)(),t="";(null==e?void 0:e.SessionSettings)&&!Object(o.b)(e.SessionSettings.UserCulture)&&(t=e.SessionSettings.UserCulture.toLowerCase());var n=a[t];return null==n&&(n=a[i]),n}(),f=[],p=s;switch(d){case"a_c_pc_pr_ctry":f=c(e,t,n,u,l,p);break;case"a_c_pr_ctry_pc":f=c(e,t,u,l,n,p);break;case"a_c_pr_pc_ctry":f=c(e,t,u,n,l,p);break;case"a_ctry_c_pr_pc":f=c(e,l,t,u,n,p);break;case"a_pc_c_pr_ctry":f=c(e,n,t,u,l,p);break;case"a_pc_pr_c_ctry":f=c(e,n,u,t,l,p);break;case"c_a_pc_pr_ctry":f=c(t,e,n,u,l,p);break;case"ctry_pc_pr_c_a":f=c(l,n,u,t,e,p);break;case"ctry_pr_c_pc_a":f=c(l,u,t,n,e,p);break;case"pc_ctry_pr_c_a":f=c(n,l,u,t,e,p);break;case"pc_pr_c_a_ctry":f=c(n,u,t,e,l,p)}return f.join(p)}function l(e){return e?u(e.Street,e.City,e.PostalCode,e.State,e.Country):""}function d(e,t){return Object(o.b)(e)?l(t):e}var f=n(9);function p(e,t,n){var r=l(t);return Object(o.b)(e)?r:""==r||n?e:Object(f.c)("{0} ({1})",e,r)}n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return p}))},1097:function(e,t,n){"use strict";var r;!function(e){e[e.Unknown=0]="Unknown",e[e.AppointmentOrganizer=1]="AppointmentOrganizer",e[e.AppointmentAttendee=2]="AppointmentAttendee",e[e.MessageCompose=3]="MessageCompose",e[e.MessageRead=4]="MessageRead",e[e.MeetingRequest=5]="MeetingRequest",e[e.DetectedEntity=7]="DetectedEntity",e[e.Events=8]="Events",e[e.LaunchEvent=9]="LaunchEvent",e[e.TrapOnSendEvent=6]="TrapOnSendEvent"}(r||(r={}));var o=r;n.d(t,"a",(function(){return o}))},1108:function(e,t,n){"use strict";var r=n(4),o=Object(r.createStore)("folderForestStore",{selectedNode:{id:null,treeType:"primaryFolderTree",type:0}}),i=o();function a(){return i.selectedNode}function s(){var e=a();switch(e.type){case 1:return e.searchFolderId;case 5:return e.data.searchFolderId;case 3:return null;default:return e.id}}n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return i}))},1109:function(e,t,n){"use strict";var r=n(108),o=n(103),i=n(76);function a(){return c()&&null!==Object(o.i)().UserOptions.InboxPlusTabs}function s(){return Object(i.h)("tri-inboxPlusDefaultTabs")||Object(i.h)("tri-inboxPlusDefaultTabsControl")||Object(i.h)("tri-inboxPlusEasyOnFocusedExclusion")||Object(i.h)("tri-inboxPlusEasyOnFocusedExclusionControl")||Object(i.h)("tri-inboxPlusEasyOnFocusedInclusion")||Object(i.h)("tri-inboxPlusEasyOnFocusedInclusionControl")}function c(){return Object(i.h)("tri-inboxPlusDefaultTabs")||Object(i.h)("tri-inboxPlusEasyOnFocusedExclusion")||Object(i.h)("tri-inboxPlusEasyOnFocusedInclusion")}function u(){return Object(i.h)("tri-inboxPlusEasyOnFocusedExclusion")||Object(i.h)("tri-inboxPlusEasyOnFocusedExclusionControl")}function l(){return Object(i.h)("tri-inboxPlusEasyOnFocusedInclusion")||Object(i.h)("tri-inboxPlusEasyOnFocusedInclusionControl")}n.d(t,"f",(function(){return f})),n.d(t,"e",(function(){return a})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return l}));var d=new r.c((function(){return n.e(341).then(n.bind(null,15234))})),f=new r.a(d,(function(e){return e.clearInboxTabsSessionData}))},11103:function(e){e.exports=JSON.parse('{"a":"eZa","b":"fZa"}')},11104:function(e){e.exports=JSON.parse('{"b":"nZa","a":"oZa"}')},11105:function(e){e.exports=JSON.parse('{"a":"QZa"}')},11106:function(e,t,n){var r=n(11107),o=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},11107:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,'.JK72WU_hby1QGNVFpgYCZ{width:16px;height:16px}html[dir] .JK72WU_hby1QGNVFpgYCZ{padding:7px}._2fs_J-QLn-cG_CHzGU4W71{width:30px;height:30px;cursor:pointer}html[dir] ._2fs_J-QLn-cG_CHzGU4W71{background-color:transparent;padding:0}html[dir=ltr] ._2fs_J-QLn-cG_CHzGU4W71{margin:0 5px 0 0}html[dir=rtl] ._2fs_J-QLn-cG_CHzGU4W71{margin:0 0 0 5px}html[dir] ._2fs_J-QLn-cG_CHzGU4W71:hover{background-color:"[theme:themeLighter, default:#DEECF9]"}._2fs_J-QLn-cG_CHzGU4W71 .ms-Button-menuIcon{display:none}',""]),t.locals={image:"JK72WU_hby1QGNVFpgYCZ",addinEntryButton:"_2fs_J-QLn-cG_CHzGU4W71"}},11108:function(e,t,n){var r=n(11109),o=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},11109:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,"._3G9OYOb_Q385LfO0M84-uO{display:-webkit-box;display:-ms-flexbox;display:flex;display:-webkit-flex;height:30px}",""]),t.locals={listViewContainer:"_3G9OYOb_Q385LfO0M84-uO"}},1111:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.OoeInvalidDataFormat=2006]="OoeInvalidDataFormat",e[e.OperationNotSupported=5e3]="OperationNotSupported",e[e.AttachmentSizeExceeded=9e3]="AttachmentSizeExceeded",e[e.NumberOfAttachmentsExceeded=9001]="NumberOfAttachmentsExceeded",e[e.InvalidAttachmentId=9003]="InvalidAttachmentId",e[e.InvalidAttachmentPath=9004]="InvalidAttachmentPath",e[e.CannotAddAttachmentBeforeUpgrade=9005]="CannotAddAttachmentBeforeUpgrade",e[e.AttachmentDeletedBeforeUploadCompletes=9006]="AttachmentDeletedBeforeUploadCompletes",e[e.AttachmentUploadGeneralFailure=9007]="AttachmentUploadGeneralFailure",e[e.AttachmentToDeleteDoesNotExist=9008]="AttachmentToDeleteDoesNotExist",e[e.AttachmentDeleteGeneralFailure=9009]="AttachmentDeleteGeneralFailure",e[e.InvalidEndTime=9010]="InvalidEndTime",e[e.HtmlSanitizationFailure=9011]="HtmlSanitizationFailure",e[e.NumberOfRecipientsExceeded=9012]="NumberOfRecipientsExceeded",e[e.CursorPositionChanged=9014]="CursorPositionChanged",e[e.ComposeFormNotReadyForAttachments=9015]="ComposeFormNotReadyForAttachments",e[e.InvalidSelection=9016]="InvalidSelection",e[e.GenericTokenError=9018]="GenericTokenError",e[e.GenericSettingsError=9019]="GenericSettingsError",e[e.GenericResponseError=9020]="GenericResponseError",e[e.SaveError=9021]="SaveError",e[e.DuplicateNotificationKey=9023]="DuplicateNotificationKey",e[e.NotificationKeyNotFound=9024]="NotificationKeyNotFound",e[e.NumberOfNotificationsExceeded=9025]="NumberOfNotificationsExceeded",e[e.PersistedNotificationArrayReadError=9026]="PersistedNotificationArrayReadError",e[e.PersistedNotificationArraySaveError=9027]="PersistedNotificationArraySaveError",e[e.CannotPersistPropertyInUnsavedDraftError=9028]="CannotPersistPropertyInUnsavedDraftError",e[e.CallSaveAsyncBeforeToken=9029]="CallSaveAsyncBeforeToken",e[e.InvalidParameterValueError=9031]="InvalidParameterValueError",e[e.ApiCallNotSupportedByExtensionPoint=9032]="ApiCallNotSupportedByExtensionPoint",e[e.SetRecurrenceOnInstance=9033]="SetRecurrenceOnInstance",e[e.InvalidRecurrence=9034]="InvalidRecurrence",e[e.InsufficientItemPermissions=9038]="InsufficientItemPermissions",e[e.InternalServerError=9042]="InternalServerError",e[e.AttachmentTypeNotSupported=9043]="AttachmentTypeNotSupported",e[e.InvalidCategoryError=9044]="InvalidCategoryError",e[e.DuplicateCategoryError=9045]="DuplicateCategoryError",e[e.ItemNotSavedError=9046]="ItemNotSavedError",e[e.MissingExtendedPermissionsForAPIError=9047]="MissingExtendedPermissionsForAPIError"}(r||(r={})),t.b=r},11110:function(e){e.exports=JSON.parse('{"a":"SZa"}')},11111:function(e,t,n){var r=n(11112),o=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},11112:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,'._2J8wqAjjNjIxeHLFDu3glL{display:block}html[dir] ._2J8wqAjjNjIxeHLFDu3glL{background:transparent;border:none}html[dir=ltr] ._2J8wqAjjNjIxeHLFDu3glL{margin-right:5px}html[dir=rtl] ._2J8wqAjjNjIxeHLFDu3glL{margin-left:5px}._1uehV4pvPVVhg2k0wrvGsp{height:16px;width:0;color:"[theme:neutralTertiary, default:#a6a6a6]"}html[dir] ._1uehV4pvPVVhg2k0wrvGsp{padding:0 0 0 0;margin:7px 0 7px 0}html[dir=ltr] ._1uehV4pvPVVhg2k0wrvGsp{border-right-width:1px;border-right-style:solid;float:left}html[dir=rtl] ._1uehV4pvPVVhg2k0wrvGsp{border-left-width:1px;border-left-style:solid;float:right}._1HoMSTiAkAiZZo5egEr4NP{display:inline-block;width:30px;height:30px;cursor:pointer}html[dir] ._1HoMSTiAkAiZZo5egEr4NP{background-color:transparent}html[dir] ._1HoMSTiAkAiZZo5egEr4NP:hover{background-color:"[theme:themeLighter, default:#DEECF9]"}._1HoMSTiAkAiZZo5egEr4NP .ms-Button-menuIcon{display:none}._9jvK8is_zfMMJvLowKTUa{font-size:10px;color:"[theme:neutralSecondary, default:#666666]"}',""]),t.locals={overflowContainer:"_2J8wqAjjNjIxeHLFDu3glL",overflowDivider:"_1uehV4pvPVVhg2k0wrvGsp",overflowChevronContainer:"_1HoMSTiAkAiZZo5egEr4NP",overflowChevron:"_9jvK8is_zfMMJvLowKTUa"}},11113:function(e,t,n){var r=n(11114),o=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},11114:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,".WN3-puERw1mSl_V-6VSoe{display:-webkit-box;display:-ms-flexbox;display:flex;display:-webkit-flex}html[dir=ltr] .WN3-puERw1mSl_V-6VSoe{float:right}html[dir=rtl] .WN3-puERw1mSl_V-6VSoe{float:left}",""]),t.locals={divContainer:"WN3-puERw1mSl_V-6VSoe"}},11115:function(e){e.exports=JSON.parse('{"a":"OZa","b":"PZa"}')},1112:function(e,t,n){"use strict";var r=n(1474),o=n(947);function i(){return Object(r.a)(Object(o.C)())}n.d(t,"b",(function(){return r.a})),n.d(t,"c",(function(){return r.c})),n.d(t,"a",(function(){return i}))},1113:function(e,t,n){"use strict";var r=9007199254740991,o=/^(?:0|[1-9]\d*)$/;t.a=function(e,t){var n=typeof e;return!!(t=null==t?r:t)&&("number"==n||"symbol"!=n&&o.test(e))&&e>-1&&e%1==0&&e<t}},1116:function(e,t,n){"use strict";var r=Object.prototype;t.a=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||r)}},1119:function(e,t,n){"use strict";var r=9007199254740991;t.a=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}},1124:function(e,t,n){"use strict";var r=n(378),o=n(1198),i=n(14),a=n(969),s={coin:"ms-Persona-coin",imageArea:"ms-Persona-imageArea",image:"ms-Persona-image",initials:"ms-Persona-initials",size8:"ms-Persona--size8",size10:"ms-Persona--size10",size16:"ms-Persona--size16",size24:"ms-Persona--size24",size28:"ms-Persona--size28",size32:"ms-Persona--size32",size40:"ms-Persona--size40",size48:"ms-Persona--size48",size56:"ms-Persona--size56",size72:"ms-Persona--size72",size100:"ms-Persona--size100",size120:"ms-Persona--size120"};n.d(t,"a",(function(){return c}));var c=Object(r.a)(o.a,(function(e){var t,n=e.className,r=e.theme,o=e.coinSize,c=r.palette,u=r.fonts,l=Object(a.d)(e.size),d=Object(i.getGlobalClassNames)(s,r),f=o||e.size&&a.e[e.size]||48;return{coin:[d.coin,u.medium,l.isSize8&&d.size8,l.isSize10&&d.size10,l.isSize16&&d.size16,l.isSize24&&d.size24,l.isSize28&&d.size28,l.isSize32&&d.size32,l.isSize40&&d.size40,l.isSize48&&d.size48,l.isSize56&&d.size56,l.isSize72&&d.size72,l.isSize100&&d.size100,l.isSize120&&d.size120,n],size10WithoutPresenceIcon:{fontSize:u.xSmall.fontSize,position:"absolute",top:"5px",right:"auto",left:0},imageArea:[d.imageArea,{position:"relative",textAlign:"center",flex:"0 0 auto",height:f,width:f},f<=10&&{overflow:"visible",background:"transparent",height:0,width:0}],image:[d.image,{marginRight:"10px",position:"absolute",top:0,left:0,width:"100%",height:"100%",border:0,borderRadius:"50%",perspective:"1px"},f<=10&&{overflow:"visible",background:"transparent",height:0,width:0},f>10&&{height:f,width:f}],initials:[d.initials,{borderRadius:"50%",color:e.showUnknownPersonaCoin?"rgb(168, 0, 0)":c.white,fontSize:u.large.fontSize,fontWeight:i.FontWeights.semibold,lineHeight:48===f?46:f,height:f,selectors:(t={},t[i.HighContrastSelector]={border:"1px solid WindowText",MsHighContrastAdjust:"none",color:"WindowText",boxSizing:"border-box",backgroundColor:"Window !important"},t.i={fontWeight:i.FontWeights.semibold},t)},e.showUnknownPersonaCoin&&{backgroundColor:"rgb(234, 234, 234)"},f<32&&{fontSize:u.xSmall.fontSize},f>=32&&f<40&&{fontSize:u.medium.fontSize},f>=40&&f<56&&{fontSize:u.mediumPlus.fontSize},f>=56&&f<72&&{fontSize:u.xLarge.fontSize},f>=72&&f<100&&{fontSize:u.xxLarge.fontSize},f>=100&&{fontSize:u.superLarge.fontSize}]}}),void 0,{scope:"PersonaCoin"})},1125:function(e,t,n){"use strict";function r(e){return!!e&&(!!e.LocationUri||!(!e.Latitude||!e.Longitude))}n.d(t,"a",(function(){return r}))},1126:function(e,t,n){"use strict";var r=n(24),o=n(4),i={attachments:new r.ObservableMap({})},a=Object(o.createStore)("attachment",i);t.a=a},1129:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),o=n(1464);function i(e){var t=Object(o.b)(e.EmailAddress,e.DisplayName);return Object(r.__assign)(Object(r.__assign)({},t),{isPendingResolution:!1,persona:e})}},1130:function(e,t,n){"use strict";var r=n(24),o=n(4),i={viewStates:new r.ObservableMap,primaryComposeId:null,newMessageCreationInProgress:!1},a=Object(o.createStore)("compose",i),s=a();n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return a}))},1131:function(e,t,n){"use strict";(function(e){var r=n(480),o=n(1432),i="object"==typeof exports&&exports&&!exports.nodeType&&exports,a=i&&"object"==typeof e&&e&&!e.nodeType&&e,s=a&&a.exports===i?r.a.Buffer:void 0,c=(s?s.isBuffer:void 0)||o.a;t.a=c}).call(this,n(1052)(e))},1132:function(e,t,n){"use strict";t.a=function(e){return function(t){return e(t)}}},1138:function(e,t,n){"use strict";var r=n(559),o=n(429),i="[object AsyncFunction]",a="[object Function]",s="[object GeneratorFunction]",c="[object Proxy]";t.a=function(e){if(!Object(o.a)(e))return!1;var t=Object(r.a)(e);return t==a||t==s||t==i||t==c}},1145:function(e,t,n){"use strict";t.a=function(e){return e}},1146:function(e,t,n){"use strict";(function(e){var r=n(568),o="object"==typeof exports&&exports&&!exports.nodeType&&exports,i=o&&"object"==typeof e&&e&&!e.nodeType&&e,a=i&&i.exports===o&&r.a.process,s=function(){try{var e=i&&i.require&&i.require("util").types;return e||a&&a.binding&&a.binding("util")}catch(e){}}();t.a=s}).call(this,n(1052)(e))},1148:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1245),o=n(971);function i(e,t){var n=Object(r.a)(e,t);return o.a.tableViewConversationRelations.get(n)}},1157:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s}));var r=n(967),o=[r.a.lightBlue,r.a.blue,r.a.darkBlue,r.a.teal,r.a.green,r.a.darkGreen,r.a.lightPink,r.a.pink,r.a.magenta,r.a.purple,r.a.orange,r.a.lightRed,r.a.darkRed,r.a.violet,r.a.gold,r.a.burgundy,r.a.warmGray,r.a.cyan,r.a.rust,r.a.coolGray],i=o.length;function a(e){return s(e)}function s(e){var t=e.primaryText,n=e.text,a=e.initialsColor;return"string"==typeof a?a:function(e){switch(e){case r.a.lightBlue:return"#4F6BED";case r.a.blue:return"#0078D4";case r.a.darkBlue:return"#004E8C";case r.a.teal:return"#038387";case r.a.lightGreen:case r.a.green:return"#498205";case r.a.darkGreen:return"#0B6A0B";case r.a.lightPink:return"#C239B3";case r.a.pink:return"#E3008C";case r.a.magenta:return"#881798";case r.a.purple:return"#5C2E91";case r.a.orange:return"#CA5010";case r.a.red:return"#EE1111";case r.a.lightRed:return"#D13438";case r.a.darkRed:return"#A4262C";case r.a.transparent:return"transparent";case r.a.violet:return"#8764B8";case r.a.gold:return"#986F0B";case r.a.burgundy:return"#750B1C";case r.a.warmGray:return"#7A7574";case r.a.cyan:return"#005B70";case r.a.rust:return"#8E562E";case r.a.coolGray:return"#69797E";case r.a.black:return"#1D1D1D";case r.a.gray:return"#393939"}}(a=void 0!==a?a:function(e){var t=r.a.blue;if(!e)return t;for(var n=0,a=e.length-1;a>=0;a--){var s=e.charCodeAt(a),c=a%8;n^=(s<<c)+(s>>8-c)}return t=o[n%i]}(n||t))}},1158:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1368),o=n(971);function i(){return o.a.tableViews.get(Object(r.a)())}},1159:function(e,t,n){"use strict";n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return f}));var r="A-Za-z------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------0-9------------------------------------",o=new RegExp("^(["+r+"!#$%&'*+/=?^_`{|}~-](?:["+r+".!#$%&'*+/=?^_`{|}~-]*["+r+"!#$%&'*+/=?^_`{|}~-])?)(?=@)"),i=new RegExp('^("['+r+'.!#$%&\'*+\\/=?^_`{|}~\\-(),:;<>@[\\\\\\]" ]*")(?=@)'),a=new RegExp("^["+r+"-]+(?:\\.["+r+"-]+)*$"),s=/[^\\]"/,c=/^[A-Za-z0-9_-]+:.*$/,u=function(e){var t=e.match(o);if(t)return-1!==t[0].indexOf("..")?null:t[0];var n=e.match(i);if(n){var r=s.exec(n[0]);return r&&r.index!==n[0].length-2?null:n[0]}return null};function l(e){if(!e)return!1;var t=u(e);return!!t&&!!e.substring(t.length+1).match(a)}function d(e){return c.test(e)}function f(e){return l(e)||d(e)}},1167:function(e,t,n){"use strict";var r=Function.prototype.toString;t.a=function(e){if(null!=e){try{return r.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},1168:function(e,t,n){"use strict";var r=n(1201);t.a=function(e,t,n){"__proto__"==t&&r.a?Object(r.a)(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},1177:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return u}));var r=n(7),o=Object(r.Rb)("UTC",4500,8,1),i=Object(r.ub)(o).slice(0,-1);function a(e){return c(e.lastDeliveryOrRenewTimeStamp)}function s(e){return c(e.ReceivedOrRenewTime)}function c(e){return e===u()||new Date(e).getTime()==Object(r.Ab)(o)}function u(){try{return new Date(Object(r.Ab)(o)).toLocaleString(),Object(r.mc)(o).toString()}catch(e){return null}}},1182:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"BodyContentType:#Exchange"},e)}},1183:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1035),o=n(953);function i(e){return Object(r.a)(o.i,e)}},1184:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1035),o=n(953);function i(e){return Object(r.a)(o.d,e)}},1185:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1035);function o(e){return Object(r.a)(e)}},1193:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1088),o=n(76),i=n(2021);function a(e){return Object(o.h)("rp-persistedReadingPaneTabs")?Object(r.b)().loadedConversationReadingPaneViewStates.get(e||(Object(r.b)().sxsId?Object(r.b)().sxsId:Object(i.a)())):Object(r.b)().conversationReadingPaneViewState}},1198:function(e,t,n){"use strict";var r=n(0),o=n(1),i=n(253),a=n(236),s=n(1407),c=n(106),u=n(14),l=n(378),d=n(305),f=n(967),p=n(969),m=Object(i.a)({cacheSize:100}),g=function(e){function t(t){var n=e.call(this,t)||this;return n._onRenderIcon=function(e,t){return o.createElement(d.a,{className:e,iconName:h(n.props.presence,n.props.isOutOfOffice),style:t})},n}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.coinSize,n=e.isOutOfOffice,r=e.styles,i=e.presence,a=e.theme,s=e.presenceTitle,c=e.presenceColors,u=Object(p.d)(this.props.size),l=!(u.isSize8||u.isSize10||u.isSize16||u.isSize24||u.isSize28||u.isSize32)&&(!t||t>32),d=t?t/3<40?t/3+"px":"40px":"",g=t?{fontSize:t?t/6<20?t/6+"px":"20px":"",lineHeight:d}:void 0,h=t?{width:d,height:d}:void 0,v=m(r,{theme:a,presence:i,size:this.props.size,isOutOfOffice:n,presenceColors:c});return i===f.b.none?null:o.createElement("div",{role:"presentation",className:v.presence,style:h,title:s},l&&this._onRenderIcon(v.presenceIcon,g))},t}(o.Component);function h(e,t){if(e){switch(f.b[e]){case"online":return"SkypeCheck";case"away":return t?"SkypeArrow":"SkypeClock";case"dnd":return"SkypeMinus";case"offline":return t?"SkypeArrow":""}return""}}var v={presence:"ms-Persona-presence",presenceIcon:"ms-Persona-presenceIcon"};function y(e){return{color:e,borderColor:e}}function b(e,t){return{selectors:{":before":{border:e+" solid "+t}}}}function _(e){return{height:e,width:e}}function S(e){return{backgroundColor:e}}var C=Object(l.a)(g,(function(e){var t,n,r,o,i,a,s=e.theme,c=e.presenceColors,l=s.semanticColors,d=s.fonts,f=Object(u.getGlobalClassNames)(v,s),m=Object(p.d)(e.size),g=Object(p.c)(e.presence),h=c&&c.available||"#6BB700",C=c&&c.away||"#FFAA44",O=c&&c.busy||"#C43148",A=c&&c.dnd||"#C50F1F",I=c&&c.offline||"#8A8886",x=c&&c.oof||"#B4009E",E=c&&c.background||l.bodyBackground,T=g.isOffline||e.isOutOfOffice&&(g.isAvailable||g.isBusy||g.isAway||g.isDoNotDisturb),P=m.isSize72||m.isSize100?"2px":"1px";return{presence:[f.presence,{position:"absolute",height:p.a.size12,width:p.a.size12,borderRadius:"50%",top:"auto",right:"-2px",bottom:"-2px",border:"2px solid "+E,textAlign:"center",boxSizing:"content-box",backgroundClip:"content-box",MsHighContrastAdjust:"none",selectors:(t={},t[u.HighContrastSelector]={borderColor:"Window",backgroundColor:"WindowText"},t)},(m.isSize8||m.isSize10)&&{right:"auto",top:"7px",left:0,border:0,selectors:(n={},n[u.HighContrastSelector]={top:"9px",border:"1px solid WindowText"},n)},(m.isSize8||m.isSize10||m.isSize24||m.isSize28||m.isSize32)&&_(p.a.size8),(m.isSize40||m.isSize48)&&_(p.a.size12),m.isSize16&&{height:p.a.size6,width:p.a.size6,borderWidth:"1.5px"},m.isSize56&&_(p.a.size16),m.isSize72&&_(p.a.size20),m.isSize100&&_(p.a.size28),m.isSize120&&_(p.a.size32),g.isAvailable&&{backgroundColor:h,selectors:(r={},r[u.HighContrastSelector]=S("Highlight"),r)},g.isAway&&S(C),g.isBlocked&&[{selectors:(o={":after":m.isSize40||m.isSize48||m.isSize72||m.isSize100?{content:'""',width:"100%",height:P,backgroundColor:O,transform:"translateY(-50%) rotate(-45deg)",position:"absolute",top:"50%",left:0}:void 0},o[u.HighContrastSelector]={selectors:{":after":{width:"calc(100% - 4px)",left:"2px",backgroundColor:"Window"}}},o)}],g.isBusy&&S(O),g.isDoNotDisturb&&S(A),g.isOffline&&S(I),(T||g.isBlocked)&&[{backgroundColor:E,selectors:(i={":before":{content:'""',width:"100%",height:"100%",position:"absolute",top:0,left:0,border:P+" solid "+O,borderRadius:"50%",boxSizing:"border-box"}},i[u.HighContrastSelector]={backgroundColor:"WindowText",selectors:{":before":{width:"calc(100% - 2px)",height:"calc(100% - 2px)",top:"1px",left:"1px",borderColor:"Window"}}},i)}],T&&g.isAvailable&&b(P,h),T&&g.isBusy&&b(P,O),T&&g.isAway&&b(P,x),T&&g.isDoNotDisturb&&b(P,A),T&&g.isOffline&&b(P,I),T&&g.isOffline&&e.isOutOfOffice&&b(P,x)],presenceIcon:[f.presenceIcon,{color:E,fontSize:"6px",lineHeight:p.a.size12,verticalAlign:"top",selectors:(a={},a[u.HighContrastSelector]={color:"Window"},a)},m.isSize56&&{fontSize:"8px",lineHeight:p.a.size16},m.isSize72&&{fontSize:d.small.fontSize,lineHeight:p.a.size20},m.isSize100&&{fontSize:d.medium.fontSize,lineHeight:p.a.size28},m.isSize120&&{fontSize:d.medium.fontSize,lineHeight:p.a.size32},g.isAway&&{position:"relative",left:T?void 0:"1px"},T&&g.isAvailable&&y(h),T&&g.isBusy&&y(O),T&&g.isAway&&y(x),T&&g.isDoNotDisturb&&y(A),T&&g.isOffline&&y(I),T&&g.isOffline&&e.isOutOfOffice&&y(x)]}}),void 0,{scope:"PersonaPresence"}),O=n(358),A=n(105),I=n(1157);n.d(t,"a",(function(){return E}));var x=Object(i.a)({cacheSize:100}),E=function(e){function t(t){var n=e.call(this,t)||this;return n._onRenderCoin=function(e){var t=n.props,r=t.coinSize,i=t.styles,a=t.imageUrl,s=t.imageAlt,c=t.imageShouldFadeIn,u=t.imageShouldStartVisible,l=t.theme,d=t.showUnknownPersonaCoin;if(!a)return null;var f=n.props.size,m=x(i,{theme:l,size:f,showUnknownPersonaCoin:d}),g=r||p.e[f];return o.createElement(O.a,{className:m.image,imageFit:A.b.cover,src:a,width:g,height:g,alt:s,shouldFadeIn:c,shouldStartVisible:u,onLoadingStateChange:n._onPhotoLoadingStateChange})},n._onRenderInitials=function(e){var t=e.imageInitials,r=e.allowPhoneInitials;if(e.showUnknownPersonaCoin)return o.createElement(d.a,{iconName:"Help"});var i=Object(a.a)(n.props.theme);return""!==(t=t||Object(s.a)(n._getText(),i,r))?o.createElement("span",null,t):o.createElement(d.a,{iconName:"Contact"})},n._onPhotoLoadingStateChange=function(e){n.setState({isImageLoaded:e===A.c.loaded,isImageError:e===A.c.error}),n.props.onPhotoLoadingStateChange&&n.props.onPhotoLoadingStateChange(e)},n.state={isImageLoaded:!1,isImageError:!1},n}return Object(r.__extends)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.imageUrl!==this.props.imageUrl&&this.setState({isImageLoaded:!1,isImageError:!1})},t.prototype.render=function(){var e=this.props,t=e.className,n=e.coinProps,i=e.showUnknownPersonaCoin,a=e.coinSize,s=e.styles,l=e.imageUrl,p=e.isOutOfOffice,m=e.onRenderCoin,g=void 0===m?this._onRenderCoin:m,h=e.onRenderPersonaCoin,v=void 0===h?g:h,y=e.onRenderInitials,b=void 0===y?this._onRenderInitials:y,_=e.presence,S=e.presenceTitle,O=e.presenceColors,A=e.showInitialsUntilImageLoads,E=e.theme,T=this.props.size,P=Object(c.j)(this.props,c.h),w=Object(c.j)(n||{},c.h),M=a?{width:a,height:a}:void 0,R=i,j={coinSize:a,isOutOfOffice:p,presence:_,presenceTitle:S,presenceColors:O,size:T,theme:E},k=x(s,{theme:E,className:n&&n.className?n.className:t,size:T,coinSize:a,showUnknownPersonaCoin:i}),N=Boolean(!this.state.isImageLoaded&&(A&&l||!l||this.state.isImageError||R));return o.createElement("div",Object(r.__assign)({role:"presentation"},P,{className:k.coin}),T!==f.c.size8&&T!==f.c.size10&&T!==f.c.tiny?o.createElement("div",Object(r.__assign)({role:"presentation"},w,{className:k.imageArea,style:M}),N&&o.createElement("div",{className:Object(u.mergeStyles)(k.initials,!i&&{backgroundColor:Object(I.a)(this.props)}),style:M,"aria-hidden":"true"},b(this.props,this._onRenderInitials)),!R&&v(this.props,this._onRenderCoin),o.createElement(C,Object(r.__assign)({},j))):this.props.presence?o.createElement(C,Object(r.__assign)({},j)):o.createElement(d.a,{iconName:"Contact",className:k.size10WithoutPresenceIcon}),this.props.children)},t.prototype._getText=function(){return this.props.text||this.props.primaryText||""},t.defaultProps={size:f.c.size48,presence:f.b.none,imageAlt:""},t}(o.Component)},1200:function(e,t,n){"use strict";n.d(t,"e",(function(){return"{id}"})),n.d(t,"f",(function(){return"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAEALAAAAAABAAEAAAIBTAA7"})),n.d(t,"a",(function(){return"data-custom"})),n.d(t,"c",(function(){return"originalsrc"})),n.d(t,"b",(function(){return"data-loadstatus"})),n.d(t,"d",(function(){return"pending"}))},1201:function(e,t,n){"use strict";var r=n(979),o=function(){try{var e=Object(r.a)(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();t.a=o},1209:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(4),o=Object(r.action)("SET_LOADING_STATE_FOR_FOLDER_TREE",(function(e,t,n){return{folderTreeId:e,loadingState:t,userIdentity:n}}))},1210:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(4),o=Object(r.action)("ON_FIND_FOLDER_RESPONSE",(function(e,t,n,r,o,i,a){return{rootFolder:e,distinguishedFolderId:t,treeType:n,principalSMTPAddress:r,displayName:o,folderTreeIdentifier:i,userIdentity:a}}))},1219:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return m}));var r=n(9),o=n(1357),i=n(79),a=n(985),s=n(953),c=n(27),u=n(295);function l(e){try{if(!e)return null;for(var t=atob(e),n=t.length,r=new Uint8Array(new ArrayBuffer(n)),a=0;a<n;a++)r[a]=t.charCodeAt(a);return Object(o.a)(r)}catch(t){return i.d("getMailboxGuidFromEwsId : conversion failed for id "+e+" with error "+t),null}}function d(e,t){if(!e||!t)return null;return r.c("{0}@{1}",e,t)}function f(e){if(Object(u.a)()||!e)return null;var t=Object(c.a)().SessionSettings,n=Object(a.a)(),r=n&&n.get(e);return r||e===s.d?e===s.d?d(t.ArchiveMailboxGuid,t.OrganizationDomain):r.treeType===s.c?d((null==r?void 0:r.ReplicaList)?r.ReplicaList[0]:t.ArchiveMailboxGuid,t.OrganizationDomain):r.treeType===s.j?d(l(e),t.OrganizationDomain):null:null}function p(e){if(Object(u.a)()||!e)return null;var t=Object(a.a)(),n=t&&t.get(e);return n&&n.treeType===s.c&&n.ReplicaList?n.ReplicaList[0]:null}function m(e){if(Object(u.a)()||!e)return null;var t=Object(c.a)().SessionSettings,n=l(e);return n===t.MailboxGuid?null:d(n,t.OrganizationDomain)}},1232:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4),o=n(1017),i=Object(r.action)("APPLY_DEFAULT_OPTIONS_ON_LOAD_FAIL",(function(e){return void 0===e&&(e=Object(o.a)()),{defaultOptions:e}}))},1235:function(e,t,n){"use strict";n.d(t,"n",(function(){return s})),n.d(t,"q",(function(){return c})),n.d(t,"r",(function(){return u})),n.d(t,"a",(function(){return l})),n.d(t,"p",(function(){return d})),n.d(t,"f",(function(){return f})),n.d(t,"u",(function(){return p})),n.d(t,"g",(function(){return m})),n.d(t,"d",(function(){return g})),n.d(t,"e",(function(){return h})),n.d(t,"j",(function(){return v})),n.d(t,"i",(function(){return y})),n.d(t,"l",(function(){return b})),n.d(t,"k",(function(){return _})),n.d(t,"c",(function(){return S})),n.d(t,"o",(function(){return C})),n.d(t,"s",(function(){return O})),n.d(t,"b",(function(){return A})),n.d(t,"m",(function(){return I})),n.d(t,"h",(function(){return x})),n.d(t,"t",(function(){return E}));var r=n(108),o=n(1387);n.d(t,"v",(function(){return o.a}));var i=n(1388);n.d(t,"w",(function(){return i.a}));n(1051),n(1074);var a=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(139)]).then(n.bind(null,2632))})),s=new r.a(a,(function(e){return e.initializeAttachments})),c=new r.a(a,(function(e){return e.reinitializeAttachments})),u=new r.a(a,(function(e){return e.setInlineAttachmentStatus})),l=new r.a(a,(function(e){return e.addAttachmentIntoWellBeforeUpload})),d=new r.b(a,(function(e){return e.refreshSharingTipsAttachmentWell})),f=new r.b(a,(function(e){return e.createAttachmentsViaQueueManager})),p=new r.b(a,(function(e){return e.createAttachmentsFromRecentAttachments})),m=new r.a(a,(function(e){return e.deleteAttachmentViaQueueManager})),g=new r.b(a,(function(e){return e.createAttachmentFullViewStateAndStoreBackingModel})),h=new r.b(a,(function(e){return e.createAttachmentFullViewState})),v=new r.b(a,(function(e){return e.getAttachmentWellInitialValue})),y=new r.b(a,(function(e){return e.getAttachmentWellForCompose})),b=new r.b(a,(function(e){return e.getConversationAttachmentWellInitialValue})),_=(new r.b(a,(function(e){return e.getMaxClassicAttachmentsSize})),new r.b(a,(function(e){return e.getAvailableLocalAttachmentSize}))),S=new r.b(a,(function(e){return e.createAttachmentFileFromExistingMailboxAttachment})),C=new r.a(a,(function(e){return e.mergeToConversationAttachmentWell})),O=new r.a(a,(function(e){return e.sortConversationAttachmentWell})),A=new r.a(a,(function(e){return e.convertImageViewAttachmentToInlineAttachment})),I=new r.b(a,(function(e){return e.getLastCloudyAttachmentsSharingIssueForBlockOnSend})),x=new r.b(a,(function(e){return e.getAllValidAttachments})),E=new r.b(a,(function(e){return e.uploadLocalFile}))},1236:function(e,t,n){"use strict";function r(e){var t;if("SMTP"===e.RoutingType||void 0===e.RoutingType)return e.EmailAddress;var n="MAPIPDL"===e.RoutingType&&(null===(t=e.ItemId)||void 0===t?void 0:t.Id)||e.EmailAddress;return e.RoutingType+":"+n}n.d(t,"a",(function(){return r}))},1238:function(e,t,n){"use strict";var r=n(559),o=n(1119),i=n(557),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1;var s=function(e){return Object(i.a)(e)&&Object(o.a)(e.length)&&!!a[Object(r.a)(e)]},c=n(1132),u=n(1146),l=u.a&&u.a.isTypedArray,d=l?Object(c.a)(l):s;t.a=d},1245:function(e,t,n){"use strict";function r(e,t){return t+e}n.d(t,"a",(function(){return r}))},1251:function(e,t,n){"use strict";var r=n(1384),o=n(1258),i=n(977),a=n(1131),s=n(1113),c=n(1238),u=Object.prototype.hasOwnProperty;t.a=function(e,t){var n=Object(i.a)(e),l=!n&&Object(o.a)(e),d=!n&&!l&&Object(a.a)(e),f=!n&&!l&&!d&&Object(c.a)(e),p=n||l||d||f,m=p?Object(r.a)(e.length,String):[],g=m.length;for(var h in e)!t&&!u.call(e,h)||p&&("length"==h||d&&("offset"==h||"parent"==h)||f&&("buffer"==h||"byteLength"==h||"byteOffset"==h)||Object(s.a)(h,g))||m.push(h);return m}},1252:function(e,t,n){"use strict";t.a=function(e,t){return function(n){return e(t(n))}}},1258:function(e,t,n){"use strict";var r=n(559),o=n(557),i="[object Arguments]";var a=function(e){return Object(o.a)(e)&&Object(r.a)(e)==i},s=Object.prototype,c=s.hasOwnProperty,u=s.propertyIsEnumerable,l=a(function(){return arguments}())?a:function(e){return Object(o.a)(e)&&c.call(e,"callee")&&!u.call(e,"callee")};t.a=l},1260:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(315);function o(e){return{headers:Object(r.f)(e,"GroupMailbox")}}},1262:function(e,t,n){"use strict";var r=n(4),o=Object(r.createStore)("recipientcache",{recipientCache:null,allKeys:{},usedFindPeopleFallback:!1})();t.a=o},1265:function(e,t,n){"use strict";function r(e){var t=[];return e&&e.forEach((function(e){t.push({Id:e.personaId,DisplayName:e.displayName,PostalAddress:e.postalAddress})})),t}n.d(t,"a",(function(){return r}))},1271:function(e,t,n){"use strict";n.d(t,"a",(function(){return ReactEditor})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return c}));var r=n(108),o=new r.c((function(){return Promise.all([n.e(12),n.e(15),n.e(19),n.e(34),n.e(326)]).then(n.bind(null,2805))})),ReactEditor=Object(r.d)(o,(function(e){return e.ReactEditor})),i=new r.b(o,(function(e){return e.setTableHeaderRow})),a=new r.b(o,(function(e){return e.operateContent})),s=new r.b(o,(function(e){return e.focusToEditor}));function c(e){s.import().then((function(t){return t(e)}))}},1275:function(e,t,n){"use strict";n.d(t,"j",(function(){return r})),n.d(t,"l",(function(){return o})),n.d(t,"z",(function(){return i})),n.d(t,"x",(function(){return a})),n.d(t,"a",(function(){return s})),n.d(t,"r",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return p})),n.d(t,"i",(function(){return m})),n.d(t,"e",(function(){return g})),n.d(t,"m",(function(){return h})),n.d(t,"d",(function(){return v})),n.d(t,"k",(function(){return y})),n.d(t,"w",(function(){return b})),n.d(t,"p",(function(){return _})),n.d(t,"y",(function(){return S})),n.d(t,"q",(function(){return C})),n.d(t,"u",(function(){return O})),n.d(t,"v",(function(){return A})),n.d(t,"n",(function(){return I})),n.d(t,"s",(function(){return x})),n.d(t,"t",(function(){return E})),n.d(t,"o",(function(){return T}));var r="multipart/signed",o="application/pkcs7-mime",i="application/x-pkcs7-mime",a=".p7m",s="CLSID:56023A83-B4FC-413B-9285-6BB1DAD977A2",c="CLASSID",u="4",l="0800",d=57,f=78,p=16,m=11,g="IPM.Note.SMIME.MultipartSigned",h="smime-",v="image",y="OwaToSmime",b="SmimeToOwa",_="en-US",S=["Culture","CodePage","AttachmentSizeLimit","UseKeyIdentifier","AllowUserChoiceOfSigningCertificate","IncludeCertificateChainWithoutRootCertificate","IncludeCertificateChainAndRootCertificate","EncryptTemporaryBuffers","SignedEmailCertificateInclusion","IncludeSmimeCapabilitiesInMessage","CopyRecipientHeaders","OnlyUseSmartCard","EncryptionAlgorithms","SigningAlgorithms","AlwaysEncrypt","AlwaysSign","TripleWrapSignedEncryptedMail","BccEncryptedEmailForking"],C="https://outlook-1.cdn.office.net/owasmime/20.20.514.1/owasmime.msi",O="OwaSmimeEdgeExtension.appxbundle",A="https://outlook-1.cdn.office.net/owasmime/20.20.514.1/OwaSmimeEdgeExtension.appxbundle",I="https://outlook-1.cdn.office.net/owasmime/20.20.514.1/SmimeOutlookWebChrome.msi",x="https://outlook-1.cdn.office.net/owasmime/20.20.514.1/SmimeOutlookWebChrome.msi",E="https://microsoftedge.microsoft.com/addons/detail/gamjhjfeblghkihfjdpmbpajhlpmobbp",T="chrome-extension://maafgiompdekodanheihhgilkjchcakm/Options.html"},1278:function(e,t,n){"use strict";var r=n(1168),o=n(1054),i=Object.prototype.hasOwnProperty;t.a=function(e,t,n){var a=e[t];i.call(e,t)&&Object(o.a)(a,n)&&(void 0!==n||t in e)||Object(r.a)(e,t,n)}},1282:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r=n(108),o=new r.c((function(){return n.e(504).then(n.bind(null,3290))})),i=new r.b(o,(function(e){return e.searchSuggestionsForSinglePersona})),a=new r.b(o,(function(e){return e.searchSuggestions}))},1286:function(e,t,n){"use strict";n.r(t);var r=n(1148),o=n(1400),i=n(1593),a=n(1177),s=n(254),c=n(1573),u=n(963),l=n(79);function d(e){return function(e,t){return p({isPinned:t,returnTime:e.returnTime,receivedOrRenewedTime:e.lastDeliveryOrRenewTimeStamp,receivedTime:e.lastDeliveryTimeStamp})}(e,Object(a.b)(e))}function f(e){return function(e,t){return p({isPinned:t,returnTime:e.ReturnTime,receivedOrRenewedTime:e.ReceivedOrRenewTime,receivedTime:e.DateTimeReceived})}(e,Object(a.c)(e))}function p(e){var t,n=e.returnTime,r=e.receivedOrRenewedTime,o=e.receivedTime,i=e.isPinned;return!!n||!i&&r&&(t=o,!(new Date(r).setMilliseconds(0)==new Date(t).setMilliseconds(0)))}function m(e,t){return W(e,t,1)}function g(e,t){return W(e,t,2)}function h(e,t){return W(e,t,3)}function v(e,t){return W(e,t,10)}function y(e,t){return W(e,t,13)}function b(e,t){return W(e,t,5)}function _(e,t){return W(e,t,25)}function S(e,t){return W(e,t,6)}function C(e,t){return W(e,t,4)}function O(e,t){return W(e,t,14)}function A(e,t){return W(e,t,16)}function I(e,t){return W(e,t,15)}function x(e,t){return W(e,t,24)}function E(e,t){return W(e,t,17)}function T(e,t){return W(e,t,18)}function P(e,t){return W(e,t,26)}function w(e,t){return W(e,t,23)}function M(e,t){return W(e,t,22)}function R(e,t){return W(e,t,21)}function j(e,t){return W(e,t,19)}function k(e,t){return W(e,t,8)}n.d(t,"getCanDelete",(function(){return m})),n.d(t,"getCategories",(function(){return g})),n.d(t,"getConversationId",(function(){return h})),n.d(t,"getIsPinned",(function(){return v})),n.d(t,"getItemIds",(function(){return y})),n.d(t,"getExecuteSearchSortOrder",(function(){return b})),n.d(t,"getUniqueSenders",(function(){return _})),n.d(t,"getFlagStatus",(function(){return S})),n.d(t,"getEffectiveMentioned",(function(){return C})),n.d(t,"getLastDeliveryOrRenewTimeStamp",(function(){return O})),n.d(t,"getLastModifiedTimeStamp",(function(){return A})),n.d(t,"getLastDeliveryTimeStamp",(function(){return I})),n.d(t,"getSubject",(function(){return x})),n.d(t,"getLastSenderMailbox",(function(){return E})),n.d(t,"getLastSenderSMTP",(function(){return T})),n.d(t,"getUnreadCount",(function(){return P})),n.d(t,"getSize",(function(){return w})),n.d(t,"getRowIdString",(function(){return M})),n.d(t,"getRowClientItemId",(function(){return R})),n.d(t,"getParentFolderId",(function(){return j})),n.d(t,"getInstrumentationContext",(function(){return k})),n.d(t,"getIsDraft",(function(){return N})),n.d(t,"getIsSubmitted",(function(){return D})),n.d(t,"getIsSnoozed",(function(){return F})),n.d(t,"getValidCouponIndexes",(function(){return L})),n.d(t,"getImportance",(function(){return U})),n.d(t,"getArchiveTag",(function(){return B})),n.d(t,"getPolicyTag",(function(){return H}));var N=function(e,t){return W(e,t,9)},D=function(e,t){return W(e,t,12)};function F(e,t){return W(e,t,11)}function L(e,t){return W(e,t,27)}function U(e,t){return W(e,t,7)}function B(e,t){return W(e,t,0)}function H(e,t){return W(e,t,20)}function W(e,t,n){switch(t.tableQuery.listViewType){case 0:return function(e,t,n){var o,i=Object(r.a)(e,t.id);if(!i)return V("ConversationNotInCache",n),null;var s=i.id,l=Object(c.a)(s),f=u.w.conversations.get(s),p=u.w.items.get(i.itemIds[0]);switch(n){case 22:return s;case 21:return null==l?void 0:l.clientId;case 3:return s;case 6:return i.flagStatus;case 10:return a.b(i);case 13:return i.itemIds;case 14:return i.lastDeliveryOrRenewTimeStamp;case 15:return i.lastDeliveryTimeStamp;case 16:return i.lastModifiedTimeStamp;case 26:return i.unreadCount;case 17:return null===(o=i.lastSender)||void 0===o?void 0:o.Mailbox;case 18:return i.lastSender&&i.lastSender.Mailbox.EmailAddress;case 5:return i.executeSearchSortOrder;case 19:return 1===t.tableQuery.type?i.parentFolderId:t.tableQuery.folderId;case 24:return l.subject;case 25:return i.uniqueSenders;case 23:return l.size;case 4:return i.effectiveMentioned;case 8:return i.instrumentationContext;case 2:return i.categories;case 1:return null==f?void 0:f.canDelete;case 27:return l.validCouponIndexes;case 7:return i.importance;case 0:return null==p?void 0:p.ArchiveTag;case 20:return null==p?void 0:p.PolicyTag;case 11:return d(i);case 12:case 9:default:return null}}(e,t,n);case 1:return function(e,t,n){var r,s=Object(o.a)(e,t.id);if(!s)return V("ItemNotInRelations",n),null;var c=s.clientId,l=u.w.items.get(c.Id);if(!l)return V("ItemNotInCache",n),null;var d=Object(i.a)(l)?l:null,p=null===(r=null==d?void 0:d.From)||void 0===r?void 0:r.Mailbox;switch(n){case 22:return c.Id;case 21:return c;case 3:return d.ConversationId.Id;case 6:return l.Flag?l.Flag.FlagStatus:null;case 10:return a.c(l);case 13:return[c.Id];case 14:return l.ReceivedOrRenewTime;case 15:return l.DateTimeReceived;case 16:return l.LastModifiedTime;case 26:return d&&!d.IsRead?1:0;case 17:return p;case 18:return null==p?void 0:p.EmailAddress;case 25:return p?[p.Name]:null;case 5:return s.executeSearchSortOrder;case 19:return l.ParentFolderId.Id;case 24:return l.Subject;case 23:return l.Size;case 4:return l.MentionedMe;case 9:return l.IsDraft;case 12:return l.IsSubmitted;case 8:return s.instrumentationContext;case 2:return l.Categories;case 1:return l.CanDelete;case 27:return l.validCouponIndexes;case 7:return l.Importance;case 0:return l.ArchiveTag;case 20:return l.PolicyTag;case 11:return f(l);default:return null}}(e,t,n);default:return null}}function V(e,t){var n=Object(s.q)(),r=e+" PropertyType:"+t;n&&(r+=" Scenario:"+n.eventName),l.g.warn(r),Object(s.o)(e,{Scenario:null==n?void 0:n.eventName,propertyType:t})}},1289:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"ExtendedPropertyType:#Exchange"},e)}},1290:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(960),o=n(103);function i(){var e=!0;if(Object(o.u)()){var t=Object(r.d)(r.a.ExternalImages);e=null===t.externalImagesSelectedOption||0===t.externalImagesSelectedOption}else{var n=Object(o.i)().PolicySettings;e=void 0===n.ExternalImageProxyEnabled||n.ExternalImageProxyEnabled}return e}},1291:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(630),o=n(629),i=n(553),a=n(246),s=n(79);function c(e,t,n,c,u,l){var d=Object(a.a)();c&&(d.RequestServerVersion=c);var f=e.map((function(e){return Object(i.a)({Id:e})}));return Object(r.a)({Header:d,Body:Object(o.a)({ItemShape:t,ItemIds:f,ShapeName:n,InternetMessageId:l})},u).then((function(e){var t,n;return null===(n=null===(t=null==e?void 0:e.Body)||void 0===t?void 0:t.ResponseMessages)||void 0===n?void 0:n.Items})).catch((function(e){return s.g.warn("GetItem:"+e.message),null}))}},1292:function(e,t,n){"use strict";n.d(t,"o",(function(){return s})),n.d(t,"h",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"j",(function(){return d})),n.d(t,"m",(function(){return f})),n.d(t,"r",(function(){return p})),n.d(t,"k",(function(){return m})),n.d(t,"q",(function(){return g})),n.d(t,"n",(function(){return h})),n.d(t,"l",(function(){return v})),n.d(t,"d",(function(){return y})),n.d(t,"i",(function(){return b})),n.d(t,"p",(function(){return _})),n.d(t,"c",(function(){return S})),n.d(t,"g",(function(){return C})),n.d(t,"e",(function(){return O})),n.d(t,"s",(function(){return A}));var r=n(108),o=(n(1655),n(1693));n.d(t,"a",(function(){return o.a}));var i=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(375)]).then(n.bind(null,3219))})),a={captureBundleTime:!0},s=new r.a(i,(function(e){return e.replyToMessage}),a),c=new r.a(i,(function(e){return e.forwardMessage}),a),u=new r.a(i,(function(e){return e.closeCompose})),l=new r.a(i,(function(e){return e.discardCompose})),d=new r.a(i,(function(e){return e.loadDraftToCompose})),f=new r.a(i,(function(e){return e.openCompose})),p=new r.a(i,(function(e){return e.trySaveAndCloseCompose})),m=new r.a(i,(function(e){return e.moveComposeToTab})),g=new r.a(i,(function(e){return e.tryCreateResendDraft})),h=new r.a(i,(function(e){return e.replyToApprovalMessage})),v=new r.a(i,(function(e){return e.onEditDraftButtonClicked})),y=new r.b(i,(function(e){return e.createReply})),b=new r.b(i,(function(e){return e.getToCcRecipientsForReply})),_=new r.b(i,(function(e){return e.replyToMessageAndCreateViewState})),S=new r.b(i,(function(e){return e.createAttachments})),C=new r.b(i,(function(e){return e.extractComposePopoutData})),O=new r.b(i,(function(e){return e.didInsertLinksHaveIssuesOnBlockDialogDismiss})),A=new r.b(i,(function(e){return e.insertSignature}))},1319:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1260),o=n(114),i={};function a(e){var t=e.toLocaleLowerCase();if(!i[t]){var n={type:o.a.GroupMailbox,userIdentity:Object(o.e)().userIdentity,mailboxSmtpAddress:e,routingKey:Object(o.c)()+e,requestOptions:Object(r.a)(e)};i[t]=n}return i[t]}},1323:function(e,t,n){"use strict";var r=function(e,t){if(e.ExtendedProperty)for(var n=0;n<e.ExtendedProperty.length;n++){var r=e.ExtendedProperty[n];if(r.ExtendedFieldURI.PropertyTag===t||r.ExtendedFieldURI.PropertyName===t)return r.Value}},o=function(e){return"false"!==r(e,"0x10f4")},i=function(e){return parseInt(r(e,"SourceWellKnownFolderType"),10)},a=n(950);var s=function(e,t){switch(e){case Object(a.a)("inbox"):return"Inbox";case Object(a.a)("sentitems"):return"Send";case Object(a.a)("drafts"):return"Edit";case Object(a.a)("deleteditems"):return"Delete";case Object(a.a)("archive"):return"Archive";case Object(a.a)("junkemail"):return"Blocked";case Object(a.a)("scheduled"):return"Clock";case Object(a.a)("notes"):return"QuickNote"}return t?"FabricFolder":null},c=n(0),u=n(1),l=u.lazy((function(){return Promise.all([n.e(6),n.e(788),n.e(863)]).then(n.bind(null,14857))})),d=function(e){return u.createElement(u.Suspense,{fallback:u.createElement("div",{className:e.className})},u.createElement(l,Object(c.__assign)({},e)))};n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return d}))},1326:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2114),o=n(1465);function i(e){var t=Object(r.a)(),n=Object(o.b)(e);return t.sharingLinks.get(n)}},1340:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1219),o=n(79),i="X-AnchorMailbox",a="X-AuxMailbox";function s(e,t,n,s){try{var c={headers:new Headers,userIdentity:n,mailboxType:s},u=null;if(e){u=Object(r.a)(e);var l=Object(r.c)(e);l&&c.headers.append(a,l)}else t&&(u=Object(r.b)(t));return u&&c.headers.append(i,u),c}catch(r){return o.d(" getDefaultRequestOptions failed for folderId "+e+" and itemId "+t+" with error "+r),{userIdentity:n,mailboxType:s}}}},1347:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),o=n(108),i=n(1907);function a(e,t,n,a,s){return function(){function c(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.onImportedCallbacks=[],this.args=e,this.pluginName=n}return c.prototype.initialize=function(e){this.editor=e,this.pendingEvents=[],this.pluginInstance?this.initializeAndCallback():a||this.internalImport()},c.prototype.dispose=function(){this.pluginInstance&&(this.pluginInstance.dispose(),s||(this.pluginInstance=null)),this.editor=null,this.importPluginPromise=null,this.onImportedCallbacks=[]},c.prototype.getName=function(){return this.isImported()?this.pluginInstance.getName():this.pluginName},c.prototype.setPluginUtils=function(e){this.pluginUtils=e,Object(i.a)(this.pluginInstance)&&this.pluginInstance.setPluginUtils(this.pluginUtils)},c.prototype.onPluginEvent=function(e){this.pluginInstance?this.pluginInstance.onPluginEvent&&this.pluginInstance.onPluginEvent(e):(null==a?void 0:a(e,this.editor))&&this.internalImport(e)},c.prototype.willHandleEventExclusively=function(e){return!(!this.pluginInstance||!this.pluginInstance.willHandleEventExclusively)&&this.pluginInstance.willHandleEventExclusively(e)},c.prototype.getPlugin=function(){return this.pluginInstance?Promise.resolve(this.pluginInstance):this.internalImport()},c.prototype.isImported=function(){return!!this.pluginInstance},c.prototype.addOnImportedCallback=function(e){this.isImported()&&this.editor?e(this.pluginInstance):this.onImportedCallbacks&&this.onImportedCallbacks.push(e)},c.prototype.initializeAndCallback=function(){var e=this;this.pluginInstance.initialize(this.editor),this.onImportedCallbacks.forEach((function(t){return t(e.pluginInstance)}))},c.prototype.internalImport=function(n){var i=this;return this.importPluginPromise||(this.importPluginPromise=new o.b(e,t).import().then((function(e){return i.pluginInstance=new(e.bind.apply(e,Object(r.__spread)([void 0],i.args))),i.setPluginUtils(i.pluginUtils),i.editor&&(i.initializeAndCallback(),i.pendingEvents.length>0&&i.pluginInstance.onPluginEvent&&i.pendingEvents.forEach((function(e){i.pluginInstance.onPluginEvent(e)})),i.pendingEvents=[]),i.pluginInstance})),this.importPluginPromise.catch((function(){i.pendingEvents=[]}))),n&&this.pendingEvents.push(n),this.importPluginPromise},c}()}},1348:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(950),o=n(976);function i(e){var t=Object(r.a)(e);return t||(t=e),Object(o.a)().folderTable.get(t).FolderId}},1349:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1025),o=n(987);function i(e,t){var n=Object(o.a)(t),i=n&&n.get(e);return(null==i?void 0:i.loadingState)||r.a.Uninitialized}},1350:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(987);function o(e,t){var n=Object(r.a)(t),o=n&&n.get(e);return null==o?void 0:o.currentLoadedIndex}},1357:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(79);function o(e){if(!e)return null;var t=e,n=0;if(1==t[0]){if(!(t=a(t)))return null}else n=1;var o=t[++n]+(t[n+1]>>8);return function(e,t,n){if(t+n>e.length)return r.d("ConvertByteArrayToString: offset + count must not exceed byte array length."),null;for(var o="",i=t;i<t+n;i++)o+=String.fromCharCode(e[i]);return o}(t,n+=2,o)}function i(e){if(!e)return!1;try{for(var t=atob(e),n=new Uint8Array(t.length),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);var o=0;return 1===n[0]?n=a(n):o=1,n&&1===n[o]}catch(e){return!1}}function a(e){var t=s(e,null);if(0==t)return r.d("rleDecompress : Invalid id"),null;var n=new Uint8Array(t);return s(e,n),n}function s(e,t){for(var n=0,o=1;o<e.length;++o)if(o==e.length-1||e[o]!=e[o+1])null!=t&&(t[n]=e[o]),n++;else{if(o==e.length-2)return r.d("decompressEx : Invalid id"),null;for(var i=e[o+2],a=0;a<i+2;a++)null!=t&&(t[n]=e[o]),n++;o+=2}return n}},1361:function(e){e.exports=JSON.parse('{"b":"Pca","d":"Qca","c":"Rca","a":"Sca"}')},1367:function(e,t,n){"use strict";var r=new(n(593).a)(50);t.a=r},1368:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(971);function o(){return r.a.selectedTableViewId}},13750:function(e){e.exports=JSON.parse('{"b":"Ikc","a":"Jkc"}')},1384:function(e,t,n){"use strict";t.a=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},1386:function(e,t,n){"use strict";var r;!function(e){e[e.Auto=0]="Auto",e[e.CommandBarArrows=1]="CommandBarArrows",e[e.KeyboardUpDown=2]="KeyboardUpDown",e[e.KeyboardEnter=3]="KeyboardEnter",e[e.KeyboardShiftEnter=4]="KeyboardShiftEnter",e[e.KeyboardCtrlSpace=5]="KeyboardCtrlSpace",e[e.MailListItemBody=6]="MailListItemBody",e[e.MailListItemBodyDoubleClick=7]="MailListItemBodyDoubleClick",e[e.MailListItemCheckbox=8]="MailListItemCheckbox",e[e.MailListItemContextMenu=9]="MailListItemContextMenu",e[e.MailListItemExpansion=10]="MailListItemExpansion",e[e.MailListItemRichPreview=11]="MailListItemRichPreview",e[e.MailListItemTwisty=12]="MailListItemTwisty",e[e.NewConversation=13]="NewConversation",e[e.Reset=14]="Reset",e[e.RowRemoval=15]="RowRemoval",e[e.ImmersiveReadingPaneDelete=16]="ImmersiveReadingPaneDelete",e[e.RouteHandler=17]="RouteHandler",e[e.ToggleCheckAll=18]="ToggleCheckAll",e[e.MessageAd=19]="MessageAd",e[e.SearchSuggestionClick=20]="SearchSuggestionClick",e[e.SingleLineClearSelection=21]="SingleLineClearSelection",e[e.KeyboardHome=22]="KeyboardHome",e[e.KeyboardEnd=23]="KeyboardEnd"}(r||(r={})),t.a=r},1387:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("ON_ATTACHMENT_CREATED",(function(e,t,n){return{parentItemId:e,attachmentId:t,attachment:n}}))},1388:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("ON_ATTACHMENT_DELETED",(function(e,t,n){return{parentItemId:e,attachmentId:t,attachment:n}}))},1400:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1245),o=n(971);function i(e,t){var n=Object(r.a)(e,t);return o.a.tableViewItemRelations.get(n)}},1401:function(e,t,n){"use strict";var r=n(0),o=n(1938),i=n(283),a=Object(i.action)("addInfoBarMessage")((function(e,t,n){if(e){-1==e.infoBarIds.indexOf(t)?e.infoBarIds.push(t):e.infoBarIds=Object(r.__spread)(e.infoBarIds);var i=e.infoBarHostKey;n&&(o.b[i]||(o.b[i]={}),o.b[i][t]=n)}}));t.a=a},1404:function(e,t,n){"use strict";var r=n(378),o=n(1079),i=n(14),a=n(969),s={root:"ms-Persona",size8:"ms-Persona--size8",size10:"ms-Persona--size10",size16:"ms-Persona--size16",size24:"ms-Persona--size24",size28:"ms-Persona--size28",size32:"ms-Persona--size32",size40:"ms-Persona--size40",size48:"ms-Persona--size48",size56:"ms-Persona--size56",size72:"ms-Persona--size72",size100:"ms-Persona--size100",size120:"ms-Persona--size120",available:"ms-Persona--online",away:"ms-Persona--away",blocked:"ms-Persona--blocked",busy:"ms-Persona--busy",doNotDisturb:"ms-Persona--donotdisturb",offline:"ms-Persona--offline",details:"ms-Persona-details",primaryText:"ms-Persona-primaryText",secondaryText:"ms-Persona-secondaryText",tertiaryText:"ms-Persona-tertiaryText",optionalText:"ms-Persona-optionalText",textContent:"ms-Persona-textContent"};n.d(t,"a",(function(){return c}));var c=Object(r.a)(o.a,(function(e){var t=e.className,n=e.showSecondaryText,r=e.theme,o=r.semanticColors,c=r.fonts,u=Object(i.getGlobalClassNames)(s,r),l=Object(a.d)(e.size),d=Object(a.c)(e.presence),f={color:o.bodySubtext,fontWeight:i.FontWeights.regular,fontSize:c.small.fontSize};return{root:[u.root,r.fonts.medium,i.normalize,{color:o.bodyText,position:"relative",height:a.b.size48,minWidth:a.b.size48,display:"flex",alignItems:"center",selectors:{".contextualHost":{display:"none"}}},l.isSize8&&[u.size8,{height:a.b.size8,minWidth:a.b.size8}],l.isSize10&&[u.size10,{height:a.b.size10,minWidth:a.b.size10}],l.isSize16&&[u.size16,{height:a.b.size16,minWidth:a.b.size16}],l.isSize24&&[u.size24,{height:a.b.size24,minWidth:a.b.size24}],l.isSize24&&n&&{height:"36px"},l.isSize28&&[u.size28,{height:a.b.size28,minWidth:a.b.size28}],l.isSize28&&n&&{height:"32px"},l.isSize32&&[u.size32,{height:a.b.size32,minWidth:a.b.size32}],l.isSize40&&[u.size40,{height:a.b.size40,minWidth:a.b.size40}],l.isSize48&&u.size48,l.isSize56&&[u.size56,{height:a.b.size56,minWidth:a.b.size56}],l.isSize72&&[u.size72,{height:a.b.size72,minWidth:a.b.size72}],l.isSize100&&[u.size100,{height:a.b.size100,minWidth:a.b.size100}],l.isSize120&&[u.size120,{height:a.b.size120,minWidth:a.b.size120}],d.isAvailable&&u.available,d.isAway&&u.away,d.isBlocked&&u.blocked,d.isBusy&&u.busy,d.isDoNotDisturb&&u.doNotDisturb,d.isOffline&&u.offline,t],details:[u.details,{padding:"0 24px 0 16px",minWidth:0,width:"100%",textAlign:"left",display:"flex",flexDirection:"column",justifyContent:"space-around"},(l.isSize8||l.isSize10)&&{paddingLeft:17},(l.isSize24||l.isSize28||l.isSize32)&&{padding:"0 8px"},(l.isSize40||l.isSize48)&&{padding:"0 12px"}],primaryText:[u.primaryText,i.noWrap,{color:o.bodyText,fontWeight:i.FontWeights.regular,fontSize:c.medium.fontSize,selectors:{":hover":{color:o.inputTextHovered}}},n&&{height:"16px",lineHeight:"16px",overflowX:"hidden"},(l.isSize8||l.isSize10)&&{fontSize:c.small.fontSize,lineHeight:a.b.size8},l.isSize16&&{lineHeight:a.b.size28},(l.isSize24||l.isSize28||l.isSize32||l.isSize40||l.isSize48)&&n&&{height:18},(l.isSize56||l.isSize72||l.isSize100||l.isSize120)&&{fontSize:c.xLarge.fontSize},(l.isSize56||l.isSize72||l.isSize100||l.isSize120)&&n&&{height:22}],secondaryText:[u.secondaryText,i.noWrap,f,(l.isSize8||l.isSize10||l.isSize16||l.isSize24||l.isSize28||l.isSize32)&&{display:"none"},n&&{display:"block",height:"16px",lineHeight:"16px",overflowX:"hidden"},l.isSize24&&n&&{height:18},(l.isSize56||l.isSize72||l.isSize100||l.isSize120)&&{fontSize:c.medium.fontSize},(l.isSize56||l.isSize72||l.isSize100||l.isSize120)&&n&&{height:18}],tertiaryText:[u.tertiaryText,i.noWrap,f,{display:"none",fontSize:c.medium.fontSize},(l.isSize72||l.isSize100||l.isSize120)&&{display:"block"}],optionalText:[u.optionalText,i.noWrap,f,{display:"none",fontSize:c.medium.fontSize},(l.isSize100||l.isSize120)&&{display:"block"}],textContent:[u.textContent,i.noWrap]}}),void 0,{scope:"Persona"})},1406:function(e,t,n){"use strict";var r=n(1116),o=n(1252),i=Object(o.a)(Object.keys,Object),a=Object.prototype.hasOwnProperty;t.a=function(e){if(!Object(r.a)(e))return i(e);var t=[];for(var n in Object(e))a.call(e,n)&&"constructor"!=n&&t.push(n);return t}},1407:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=/\([^)]*\)|[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/g,o=/^\d+[\d\s]*(:?ext|x|)\s*\d+$/i,i=/\s+/g,a=/[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uAC00-\uD7AF\uD7B0-\uD7FF\u3040-\u309F\u30A0-\u30FF\u3400-\u4DBF\u4E00-\u9FFF\uF900-\uFAFF]|[\uD840-\uD869][\uDC00-\uDED6]/;function s(e,t,n){return e?(e=function(e){return e=(e=(e=e.replace(r,"")).replace(i," ")).trim()}(e),a.test(e)||!n&&o.test(e)?"":function(e,t){var n="",r=e.split(" ");return 2===r.length?(n+=r[0].charAt(0).toUpperCase(),n+=r[1].charAt(0).toUpperCase()):3===r.length?(n+=r[0].charAt(0).toUpperCase(),n+=r[2].charAt(0).toUpperCase()):0!==r.length&&(n+=r[0].charAt(0).toUpperCase()),t&&n.length>1?n.charAt(1)+n.charAt(0):n}(e,t)):""}},1411:function(e,t,n){"use strict";e.exports=function(e,t){return"string"!=typeof e?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),/["'() \t\n]/.test(e)||t?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e)}},1416:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(108),o=new r.c((function(){return n.e(510).then(n.bind(null,2634))})),i=new r.a(o,(function(e){return e.subscribe})),a=new r.a(o,(function(e){return e.unsubscribe})),s=new r.a(o,(function(e){return e.trigger}));new r.a(o,(function(e){return e.removeResizeEventEmitter}))},1421:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r="Success";function o(e){return e&&e.ResponseClass==r}},1423:function(e,t,n){"use strict";var r=n(24),o=n(4),i={folderTable:new r.ObservableMap,rootFolder:null},a=Object(o.createStore)("publicFolderFavoriteStore",i)();t.a=a},1424:function(e,t,n){"use strict";n.d(t,"k",(function(){return r})),n.d(t,"j",(function(){return o})),n.d(t,"g",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"i",(function(){return d})),n.d(t,"b",(function(){return f})),n.d(t,"h",(function(){return p}));var r="SwitchGroup",o="NavigateFromMeToWe",i="GroupHeader_SendEmail_Button_Clicked",a="GroupHeader_Email_Button_Clicked",s="GroupHeader_Files_Button_Clicked",c="GroupHeader_Calendar_Button_Clicked",u="GroupHeader_Notebook_Button_Clicked",l="GroupHeader_Planner_Button_Clicked",d="GroupHeader_Site_Button_Clicked",f="GroupHeader_CustomLeaveGroup_Button_Clicked",p="GroupHeader_Settings_Button_Clicked"},1432:function(e,t,n){"use strict";t.a=function(){return!1}},1464:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(0),o=n(1784),i=n(1508),a={isContextMenuOpen:!1,isSelected:!1,isExpanding:!1,isEditing:!1,isFadedOut:!1,expansionStatus:o.a.None,members:[]};function s(e,t){return Object(r.__assign)(Object(r.__assign)({},a),{isValid:!0,displayText:Object(i.a)(e,t)})}},1465:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return s}));var r=n(76),o="_ODSPPSL";function i(e){return Object(r.h)("doc-link-savePermission")&&e&&-1!==e.indexOf(o)?e.substring(0,e.length-o.length):e}function a(e){return!!Object(r.h)("doc-link-savePermission")&&e.lastIndexOf(o)===e.length-o.length}function s(e,t){return!Object(r.h)("doc-link-savePermission")||2!==t&&1!==t?e:e+o}},1467:function(e,t,n){"use strict";var r=n(0),o=n(114),i=n(1236),a=n(1282),s=n(1508),c=n(4),u=Object(c.action)("resolvePendingPersonaOnRecipient",(function(e,t,n){return{recipient:e,nextPersona:t,searchedString:n}}));Object(c.mutator)(u,(function(e){var t=e.recipient,n=e.nextPersona,r=e.searchedString;Object(i.a)(t.persona.EmailAddress)===r&&(t.isPendingResolution=!1,n&&(t.persona=n,t.isValid=!0,t.displayText=Object(s.a)(n.EmailAddress)))}));var l=u,d=Object(c.action)("addRecipientsToRecipientWell",(function(e,t){return{newRecipients:e,recipientWell:t}}));t.a=d;Object(c.mutator)(d,(function(e){var t,n=e.recipientWell;(t=n.recipients).splice.apply(t,Object(r.__spread)([n.recipients.length,0],e.newRecipients)),n.isDirty=!0})),Object(c.orchestrator)(d,(function(e){var t=e.newRecipients,n=e.recipientWell;t.forEach((function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,s,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e.isPendingResolution?(t=Object(i.a)(e.persona.EmailAddress),(s=n.userIdentity)||(s=Object(o.e)().userIdentity),[4,a.b.import().then((function(e){return e(s,t)}))]):[2];case 1:return c=r.sent(),l(e,c,t),[2]}}))}))}))}))},1468:function(e,t,n){"use strict";var r=n(1145),o=n(1522),i=n(1520);t.a=function(e,t){return Object(i.a)(Object(o.a)(e,t,r.a),e+"")}},1469:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i}));var r=function(e){return"extCompose_"+e},o=function(e){return"extRead_"+e},i=function(e){return 0===e.indexOf("extCompose")?"Compose":0===e.indexOf("extRead")?"Read":""}},1474:function(e,t,n){"use strict";var r=n(4),o=n(114),i=n(948),a=n(953),s=n(24),c=Object(r.createStore)("mailboxInfoStore",new s.ObservableMap),u=n(27);function l(e){if(!e)return Object(o.e)();if(!c().has(e)){var t=function(e){var t,n,r=Object(i.o)(),s=r&&r.get(e);s&&s.treeType===a.j?(t=s.principalSMTPAddress,n=Object(o.c)()+s.principalSMTPAddress):(t=Object(u.a)().SessionSettings.UserEmailAddress,n=Object(o.b)());return{type:o.a.UserMailbox,userIdentity:t,mailboxSmtpAddress:t,routingKey:n,requestOptions:Object(i.i)(e)}}(e);d(e,t)}return c().get(e)}var d=Object(r.mutatorAction)("addMailboxInfoToStore",(function(e,t){c().set(e,t)})),f=n(1319),p=n(1082),m=n(2213);function g(e){return e?h(e.tableQuery):Object(o.e)()}function h(e){var t=Object(p.b)(e),n=null==e?void 0:e.folderId;return null!=t?Object(f.a)(t):v(n)}function v(e){return Object(i.G)(e)?Object(m.a)(e):l(e)}n.d(t,"a",(function(){return g})),n.d(t,"c",(function(){return h})),n.d(t,"b",(function(){return v}))},14999:function(e,t,n){"use strict";n.r(t);var r=n(13750),o=n(5406),i=n(9),a=n(989),s=n(1292),c=n(3646),u=function(e){return function(){Object(a.b)(Object(i.b)(r.b),Object(i.b)(r.a),!Object(c.b)(e),{okText:Object(i.b)(o.a),hideCancelButton:!1}).then((function(t){t==a.a.ok&&s.b.importAndExecute(e)}))}},l=function(e){return function(){return e.conversationId}},d=n(4769),f=function(e){return function(){var t;return(null===(t=e.fromViewState)||void 0===t?void 0:t.from)?e.fromViewState.from.email:Object(d.a)()}},p=n(1049),m=n(9111),g=n(6344),h=n(6348),v=n(4086),y=n(1467),b=n(0),_=n(283),S=Object(_.action)("clearRecipientWell")((function(e){return Object(b.__awaiter)(this,void 0,void 0,(function(){return Object(b.__generator)(this,(function(t){return e.recipients=[],e.isDirty=!0,[2]}))}))})),C=n(2145),O=function(e){return function(t){var n=E(e,t);return Object(v.a)(n)}},A=function(e){return function(t,n){x(e,t);var r=E(e,t);S(r);var o=n.map(C.a);Object(y.a)(o,r)}},I=function(e){return function(t,n){x(e,t);var r=E(e,t),o=n.map(C.a);Object(y.a)(o,r)}};function x(e,t){switch(e.showCompactRecipientWell&&Object(h.a)(e),t){case p.f.To:return;case p.f.Cc:return void Object(g.a)(e);case p.f.Bcc:return void Object(m.a)(e)}}var E=function(e,t){var n;switch(t){case p.f.To:n=e.toRecipientWell;break;case p.f.Cc:n=e.ccRecipientWell;break;case p.f.Bcc:n=e.bccRecipientWell}return n},T=n(2678),P=n(2996),w=function(e){return function(){return Object(P.a)(e),Object(T.b)(e,!1,!0).then((function(){return Promise.resolve(e.itemId.Id)})).catch((function(){return Promise.resolve(null)}))}},M=n(6763),R=n(6764),j=n(6765),k=n(2788),N=n(5657),D=function(e){return function(){return Object(P.a)(e),e.content}},F=function(e){return function(t,n){Object(k.a)(e,t),Object(j.a)(e,t)}},L=function(e){return function(){return e.bodyType}},U=function(e){return function(t){Object(M.a)(e,t)}},B=function(e){return function(t){Object(R.a)(e,t)}},H=function(e){return function(t){Object(p.k)(e.addin,t)}};var W=n(9113),V=n(9114),z=function(e){return function(){return e.subject}},G=function(e){return function(t){Object(W.a)(e,t)}};function q(e){return 1===e.lastFocusedControl}var K=function(e){return function(){return 2===e.addin.lastFocusedControl?function(e){return function(){return function(e){return 2===e.lastFocusedControl}(e.addin)?Object(N.a)(e):null}}(e)():1===e.addin.lastFocusedControl?function(e){return function(){if(!q(e.addin))return null;var t=e.addin.subject,n=t.selectionStart,r=t.selectionEnd,o=e.subject;return{data:o=o.slice(n,r),sourceProperty:"subject",startPosition:n,endPosition:r}}}(e)():null}},X=function(e){return function(t){2===e.addin.lastFocusedControl?B(e)(t):1===e.addin.lastFocusedControl&&function(e){return function(t){if(q(e.addin)){var n=e.subject,r=e.addin.subject,o=r.selectionStart,i=r.selectionEnd;n=n.slice(0,o)+t+n.slice(i),Object(W.a)(e,n);var a=o+t.length;Object(V.a)(e.addin.subject,a,a)}}}(e)(t)}},J=n(1636),Q=n(438),Z=n(947),Y=n(965),$=n(3512),ee=n(103),te=n(963),ne=n(948),re=n(953),oe=function(e){return function(){return ae(e)}},ie=function(e){return function(){var t=e;return void 0!==t.isInSharedFolder&&t.isInSharedFolder}};function ae(e){if(!e||!e.ParentFolderId)return!1;var t=e.ParentFolderId.Id;return Object(ne.C)(t,re.j)}function se(){return!0}function ce(){return Object(b.__awaiter)(this,void 0,void 0,(function(){var e;return Object(b.__generator)(this,(function(t){switch(t.label){case 0:return[4,Q.t.import()];case 1:return e=t.sent(),[2,e()]}}))}))}function ue(e){return Object(b.__awaiter)(this,void 0,void 0,(function(){return Object(b.__generator)(this,(function(t){switch(t.label){case 0:return[4,Q.q.import()];case 1:return[2,t.sent()(e,"Addin")]}}))}))}function le(e){return Object(b.__awaiter)(this,void 0,void 0,(function(){return Object(b.__generator)(this,(function(t){switch(t.label){case 0:return[4,Q.v.import()];case 1:return[2,t.sent()(e,"Addin")]}}))}))}var de=function(e){return function(){return function(e){return Object(b.__awaiter)(this,void 0,void 0,(function(){var t,n,r,o,i,a,s,c,u,l,d;return Object(b.__generator)(this,(function(f){switch(f.label){case 0:return t=Object(Y.b)().items.get(e.itemId),n=t.Categories,[4,Q.t.import()];case 1:if(r=f.sent(),o=r(),null==n)return[2,[]];i=[],a=function(e){var t=o.filter((function(t){return t.Name===e})),n={Name:e,Color:t.length>0?t[0].Color:$.a.None};i.push(n)};try{for(s=Object(b.__values)(n),c=s.next();!c.done;c=s.next())u=c.value,a(u)}catch(e){l={error:e}}finally{try{c&&!c.done&&(d=s.return)&&d.call(s)}finally{if(l)throw l.error}}return[2,i]}}))}))}(e)}},fe=function(e){return function(t){return new Promise((function(n,r){var o=Object(Y.b)().items.get(e.itemId),i=o.ParentFolderId.Id,a=Object(ee.m)(),s=Object(te.j)(i,a);if(!ae(o)||!s||"PublishingAuthor"!==s.PermissionLevel&&"Author"!==s.PermissionLevel&&"NoneditingAuthor"!==s.PermissionLevel&&"Reviewer"!==s.PermissionLevel&&"Contributor"!==s.PermissionLevel){var c=Object(Z.C)(),u=Object(b.__spread)(c.selectedRowKeys.keys());return J.a.importAndExecute(u,c,t,"Addin"),n()}r(new p.a(p.b.OperationNotSupported))}))}},pe=function(e){return function(t){return new Promise((function(n,r){var o=Object(Y.b)().items.get(e.itemId),i=o.ParentFolderId.Id,a=Object(ee.m)(),s=Object(te.j)(i,a);if(!ae(o)||!s||"PublishingAuthor"!==s.PermissionLevel&&"Author"!==s.PermissionLevel&&"NoneditingAuthor"!==s.PermissionLevel&&"Reviewer"!==s.PermissionLevel&&"Contributor"!==s.PermissionLevel){var c=Object(Z.C)(),u=Object(b.__spread)(c.selectedRowKeys.keys());return J.G.importAndExecute(u,c,t,"Addin"),n()}r(new p.a(p.b.OperationNotSupported))}))}};var me=n(114),ge=n(2427);function he(e){var t={Id:e,mailboxInfo:Object(me.e)()};Object(ge.a)(t,"Mail_Addins",null,2)}function ve(e){return Y.a.items.get(e)}var ye=n(1112),be=n(1727),_e=n(3261);function Se(e){return Object(b.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(b.__generator)(this,(function(r){switch(r.label){case 0:return(t=ve(e))&&t.NormalizedBody?[3,2]:(n={Id:e,mailboxInfo:Object(ye.b)(Object(Z.C)())},[4,be.e.importAndExecute(n,"LoadItemReadingPaneMailAddins")]);case 1:t=r.sent(),r.label=2;case 2:return t.IsDraft?[4,Ce(e)]:[3,4];case 3:return r.sent(),[3,5];case 4:Object(_e.a)(e),r.label=5;case 5:return[2]}}))}))}function Ce(e){return Object(b.__awaiter)(this,void 0,void 0,(function(){return Object(b.__generator)(this,(function(t){switch(t.label){case 0:return[4,s.j.importAndExecute(e,2)];case 1:return t.sent(),[2]}}))}))}var Oe=n(960),Ae=function(e){return!!~Object(Oe.d)(Oe.a.SurfaceActions).composeSurfaceAddins.indexOf(e)},Ie=function(e){return!!~Object(Oe.d)(Oe.a.SurfaceActions).readSurfaceAddins.indexOf(e)},xe=function(e){return function(){return e.itemId?e.itemId.Id:null}},Ee=function(e){return function(){return e.ItemId.Id}},Te=function(e){return function(){var t=e;return{owner:t.folderOwnerEmailAddress,delegatePermissions:we(t.folderPermission)}}},Pe=function(e){return function(){var t=e.ParentFolderId.Id,n=Object(ee.m)(),r=Object(te.j)(t,n);return{owner:Object(ne.o)().get(t).principalSMTPAddress,delegatePermissions:we(r)}}};function we(e){return e?{Read:"FullDetails"==e.ReadItems,Create:e.CanCreateItems,EditOwn:"All"==e.EditItems||"Owned"==e.EditItems,EditAll:"All"==e.EditItems,DeleteOwn:"All"==e.DeleteItems||"Owned"==e.DeleteItems,DeleteAll:"All"==e.DeleteItems}:{Read:!0,Create:!0,EditOwn:!0,EditAll:!0,DeleteOwn:!0,DeleteAll:!0}}var Me=n(1097),Re=n(1077),je=n(1235),ke=n(9017),Ne=n(9018),De=n(3700),Fe=n(966);var Le=n(2689);function Ue(e,t){var n=Ge(e.docViewAttachments,t);if(n||(n=Ge(e.imageViewAttachments,t)),n||(n=Ge(e.inlineAttachments,t)),!n)throw new p.a(p.b.GenericResponseError);return Le.b.importAndExecute(n,t)}var Be=function(e){return function(t,n,r){return Object(Ne.a)(e,t,n,r).catch(He)}};function He(e){throw e.messageId?function(e){switch(e){case"ErrorTooLargeForLocalAttachmentSingle":case"ErrorTooLargeForLocalAttachmentMultiple":return p.b.AttachmentSizeExceeded;default:return p.b.AttachmentUploadGeneralFailure}}(e.messageId):p.b.AttachmentUploadGeneralFailure}var We=function(e){return function(t,n,r){return Object(ke.a)(e,t,n,r).catch(He)}},Ve=function(e){return function(){return Le.a.importAndExecute(e.attachmentWell)}},ze=function(e){return function(t,n,r){return function(e,t,n,r){return new Promise((function(o,i){var a=!1;try{var s=void 0;if(Object(Fe.g)(n)){var c=Object(Fe.b)(n),u=Object(Fe.e)(c),l={name:n,size:0,dataUri:t,fileType:Re.a.Base64InlineImage,type:u||"image/png"};s=Object(Re.d)([l])}else{for(var d=atob(t),f=d.length,m=new Uint8Array(new ArrayBuffer(f)),g=0;g<f;g++)m[g]=d.charCodeAt(g);var h=new Blob([m]);h.name=n,s=Object(Re.f)([h])}Object(De.a)(s,e,{isInline:r,isHiddenInline:!0,shouldShare:!1},(function(e){a||(a=!0,o(e.Id))}),(function(e,t,n){Object(je.v)(e,t,n),o(t.Id)}),(function(){a||(a=!0,i({errorType:"UploadError"}))}))}catch(e){i({errorType:p.b.AttachmentUploadGeneralFailure})}}))}(e,t,n,r).catch(He)}};function Ge(e,t){var n=e.filter((function(e){return e.attachmentId.Id===t}));return n.length>0?n[0]:null}var qe=function(e){return function(t){return new Promise((function(n,r){je.g.import().then((function(o){try{var i=Ge(e.attachmentWell.docViewAttachments,t);if(i||(i=Ge(e.attachmentWell.imageViewAttachments,t)),i||(i=Ge(e.attachmentWell.inlineAttachments,t)),!i)return void r(new p.a(p.b.AttachmentToDeleteDoesNotExist));var a=Object(b.__assign)(Object(b.__assign)({},e.itemId),{mailboxInfo:Object(ye.a)()});o(e.attachmentWell,i,a,e,(function(e,t,r){Object(je.w)(e,t,r),n()}))}catch(e){r(new p.a(p.b.AttachmentDeleteGeneralFailure))}}))}))}},Ke=function(e){return function(t){return Ue(e.attachmentWell,t)}},Xe=n(6762),Je=n(1066),Qe=n(254);function Ze(e,t,n){return function(){var r,o=Object(p.n)(t);if(!o)return null;var a=function(e,t,n,r){return{text:Object(i.b)(Xe.a),action:function(){var o=!1;n.Actions&&(o=!0),Object(Qe.o)("DissmissButtonClicked",{IsClickableInfobar:o});var i=n.ExtensionId,a=n.Persistent;p.E.import().then((function(n){n(t),a&&p.M.import().then((function(t){t(e,i)}))})),r(t)}}}(e,t,o,n),s=(null===(r=o.Actions)||void 0===r?void 0:r.CustomButtonAction)&&o.Actions.NotificationActionData?function(e,t,n){return{text:t,action:function(){Object(Qe.o)("ClickableInfoBarClicked"),p.v.importAndExecute(e,n)}}}(e,o.Actions.NotificationActionData.actionText,o.Actions.CustomButtonAction):"";return{key:o.Key,source:Je.c.Extensibility,rank:$e(o.Type),messageParts:Ye(a,s,o),color:Je.a.Grey,icon:o.Actions?o.Actions.CustomButtonIcon:null}}}function Ye(e,t,n){var r;return(null===(r=n.Actions)||void 0===r?void 0:r.CustomButtonAction)?[n.Message,"|",t,"|",e]:[n.Message,"|",e]}function $e(e){switch(e){case 0:case 1:return Je.b.Info;case 2:return Je.b.Error;case 3:return Je.b.InsightMessage}return Je.b.Safety}var et=n(1401),tt=n(1579),nt=function(e){return function(t){Object(et.a)(e,t,Ze(Object(p.m)(e.composeId),t,rt(e)))}},rt=function(e){return function(t){Object(tt.a)(e,[t])}},ot=function(e){return function(){return e.infoBarIds}},it=n(4),at=Object(it.mutatorAction)("removeInternetHeaders",(function(e,t){t.forEach((function(t){e.internetHeaders.get(t)&&(e.keysOfInternetHeadersToBeRemoved.push(t),e.internetHeaders.delete(t))}))})),st=n(6343),ct=Object(it.mutatorAction)("setInternetHeaders",(function(e,t){e.internetHeaders=e.internetHeaders.merge(t)})),ut=n(1291),lt=n(1421),dt=n(420),ft=n(484),pt=n(296),mt="00020386-0000-0000-C000-000000000046",gt="0x007D";function ht(e,t){return Object(b.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(b.__generator)(this,(function(o){switch(o.label){case 0:return r=[],t.forEach((function(t){e.addin.internetHeaders.get(t)||e.addin.keysOfInternetHeadersToBeRemoved&&-1!=e.addin.keysOfInternetHeadersToBeRemoved.indexOf(t)||r.push(t)})),r.length>0?[4,vt(r,e.itemId.Id)]:[3,2];case 1:n=o.sent(),ct(e.addin,n),Object(st.a)(e),o.label=2;case 2:return[2]}}))}))}function vt(e,t){return Object(b.__awaiter)(this,void 0,void 0,(function(){var n,r,o,i,a;return Object(b.__generator)(this,(function(s){switch(s.label){case 0:n=Object(ft.a)({BaseShape:"IdOnly",AdditionalProperties:yt(e)}),r={},s.label=1;case 1:return s.trys.push([1,3,,4]),[4,Object(ut.a)([t],n,null)];case 2:return o=s.sent(),Object(lt.a)(o[0])&&(i=o[0],(a=i.Items[0]).ExtendedProperty&&(c=a.ExtendedProperty,r=c.reduce((function(e,t){return e[t.ExtendedFieldURI.PropertyName]=t.Value,e}),{}))),[3,4];case 3:throw s.sent();case 4:return[2,r]}var c}))}))}function yt(e){var t=[];return e.forEach((function(e){t.push(Object(dt.a)(mt,e,"String"))})),t}function bt(e){return Object(b.__awaiter)(this,void 0,void 0,(function(){var t,n,r,o;return Object(b.__generator)(this,(function(i){switch(i.label){case 0:t=Object(ft.a)({BaseShape:"IdOnly",AdditionalProperties:_t()}),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,Object(ut.a)([e],t,null)];case 2:return n=i.sent(),Object(lt.a)(n[0])?(r=n[0],(o=r.Items[0]).ExtendedProperty?[2,o.ExtendedProperty[0].Value]:[2,""]):[3,4];case 3:throw i.sent();case 4:return[2,void 0]}}))}))}function _t(){var e=[];return e.push(Object(pt.a)({PropertyTag:gt,PropertyType:"String"})),e}var St=function(e){return function(t){ct(e.addin,t),Object(st.a)(e)}},Ct=function(e){return function(t){return Object(b.__awaiter)(void 0,void 0,void 0,(function(){return Object(b.__generator)(this,(function(n){switch(n.label){case 0:return 4!==e.operation?[3,2]:[4,ht(e,t)];case 1:n.sent(),n.label=2;case 2:return at(e.addin,t),Object(st.a)(e),[2]}}))}))}},Ot=function(e){return function(t){return Object(b.__awaiter)(void 0,void 0,void 0,(function(){return Object(b.__generator)(this,(function(n){switch(n.label){case 0:return 4!==e.operation?[3,2]:[4,ht(e,t)];case 1:n.sent(),n.label=2;case 2:return[2,Object(b.__spread)(e.addin.internetHeaders.keys()).filter((function(e){return t.includes(e)})).reduce((function(t,n){return t[n]=e.addin.internetHeaders.get(n),t}),{})]}}))}))}},At=n(27),It=Object(_.action)("disableClientSignatureOnReply")((function(){var e=Object(At.a)().UserOptions;e.AutoAddSignatureOnReply&&(e.AutoAddSignatureOnReply=!e.AutoAddSignatureOnReply)})),xt=Object(_.action)("disableClientSignatureOnNew")((function(){var e=Object(At.a)().UserOptions;e.AutoAddSignature&&(e.AutoAddSignature=!e.AutoAddSignature)})),Et=n(956),Tt=function(e){return function(){var t="newMail";return"reply"===e.addin.draftComposeType&&(t="reply"),"forward"===e.addin.draftComposeType&&(t="forward"),"newMail"===e.addin.draftComposeType&&(t="newMail"),{coercionType:e.bodyType.toLowerCase(),composeType:t}}},Pt=function(e){return function(t){return Object(b.__awaiter)(void 0,void 0,void 0,(function(){return Object(b.__generator)(this,(function(n){switch(n.label){case 0:return[4,s.s.import()];case 1:return n.sent()(e,t,!0),[2]}}))}))}},wt=function(){return function(){var e=Object(At.a)().UserOptions;return e.AutoAddSignature||e.AutoAddSignatureOnReply}};function Mt(){return Object(b.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(b.__generator)(this,(function(n){switch(n.label){case 0:return e=Object(At.a)().UserOptions,t=!1,e.AutoAddSignature&&(xt(),t=!0),e.AutoAddSignatureOnReply&&(It(),t=!0),[4,Object(Et.h)({AutoAddSignature:e.AutoAddSignature,AutoAddSignatureOnReply:e.AutoAddSignatureOnReply})];case 1:return n.sent(),[2,t]}}))}))}function Rt(e){return{getRecipients:O(e),setRecipients:A(e),addRecipients:I(e),getSubject:z(e),setSubject:G(e),getItemId:xe(e),getConversationId:l(e),getBody:D(e),setBody:F(e),getBodyType:L(e),prependBody:U(e),getSelectedData:K(e),setSelectedData:X(e),setBodySelectedData:B(e),mode:Me.a.MessageCompose,saveItem:w(e),addNotificationMessage:nt(e),removeNotificationMessage:rt(e),getNotificationMessageIds:ot(e),close:u(e),displayMessageForm:Se,displayAppointmentForm:he,addItemAttachment:Be(e),addFileAttachment:We(e),addFileAttachmentFromBase64:ze(e),removeAttachment:qe(e),getAttachments:Ve(e),getAttachmentContent:Ke(e),isAddinPinned:Ae,isSharedItem:ie(e),getSharedProperties:Te(e),isRemoteItem:se,getFrom:f(e),getInternetHeaders:Ot(e),setInternetHeaders:St(e),removeInternetHeaders:Ct(e),appendOnSend:H(e),getCategoriesMailbox:ce,addCategoriesMailbox:ue,removeCategoriesMailbox:le,getComposeTypeAndCoercionType:Tt(e),setSignature:Pt(e),isClientSignatureEnabled:wt(),disableClientSignature:Mt}}function jt(e){var t=[];return e&&(t=e.map((function(e){return{Mailbox:e}}))),t}var kt=n(1060),Nt=n(665),Dt=function(e,t,n,r,o,i,a,s){var c,u=jt(e),l=jt(t),d=new Date(null==n?Date.now():n),f=null==r?void 0:new Date(r);if(o){var p=Object(kt.k)(o);c=Object(kt.h)(p)[0]}var m={RequiredAttendees:u||[],OptionalAttendees:l||[],Locations:c?[c]:[],Resources:(i?i.map((function(e){return{Mailbox:{EmailAddress:e}}})):null)||[],Subject:a,Body:{Value:s,BodyType:"HTML"},Start:d,End:f};Object(Nt.b)(m,"Mail_AddIns",!0,2)},Ft=n(5903),Lt=n(5399);function Ut(e,t,n,r){var o=ve(e),i=o?o.ConversationId.Id:null,a=Object(Lt.a)(r);s.o.importAndExecute({referenceItemId:{Id:e,mailboxInfo:Object(me.e)()},isReplyAll:t,useFullCompose:!0,actionSource:"AddIns",instrumentationContexts:[],conversationId:i,body:n,fullComposeTarget:2,attachmentFiles:a})}var Bt=n(1771),Ht=n(964),Wt=n(1795),Vt=n(246);function zt(e){return function(e){return Object(b.__awaiter)(this,void 0,void 0,(function(){return Object(b.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(Wt.a)({Header:Object(Vt.a)(),Body:Object(Bt.a)({EventIds:[e],ItemShape:Object(ft.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(Ht.a)({FieldURI:"calendar:Recurrence"}),Object(Ht.a)({FieldURI:"calendar:SeriesMasterItemId"})]})})},null)];case 1:return[2,t.sent().Body.ResponseMessages.Items]}}))}))}(e).then((function(e){if(Object(lt.a)(e[0])){var t=e[0].Items[0];return{SeriesMasterItemId:t.SeriesMasterItemId,Recurrence:t.Recurrence}}return null}))}function Gt(e){var t=this;return e&&e.IsRecurring?function(){return Object(b.__awaiter)(t,void 0,void 0,(function(){var t;return Object(b.__generator)(this,(function(n){switch(n.label){case 0:return[4,zt(e.AssociatedCalendarItemId)];case 1:return(null==(t=n.sent())?void 0:t.SeriesMasterItemId)?[2,t.SeriesMasterItemId.Id]:[2,null]}}))}))}:function(){return Promise.resolve(void 0)}}var qt=function(e){return function(){return Object(b.__awaiter)(void 0,void 0,void 0,(function(){return Object(b.__generator)(this,(function(t){switch(t.label){case 0:return[4,bt(e.ItemId.Id)];case 1:return[2,t.sent()]}}))}))}},Kt=n(1516),Xt=n(1193),Jt=n(3254),Qt=n(9625),Zt=function(e){return function(t){Qt.a(e)(t,Ze(Object(p.o)(e.itemId),t,Yt(e)))}},Yt=function(e){return function(t){Qt.c(e)(t)}},$t=function(e){return function(){return Qt.b(e)()}},en=function(e){return function(t){return Ue(e.attachmentWell,t)}},tn=function(e){return function(){return e}},nn=function(e,t,n){return function(){return!e.isConversationItemPart||Object(Jt.b)({conversationReadingPaneState:n.conversationReadingPaneViewState})==e}},rn=function(e,t){return function(){var n,r=e.isConversationItemPart?null===(n=t.ConversationId)||void 0===n?void 0:n.Id:null;return!!Object(Kt.a)(r)}},on=Object(_.select)({conversationReadingPaneViewState:function(e){var t;return Object(Xt.a)(null===(t=null==e?void 0:e.ConversationId)||void 0===t?void 0:t.Id)}})((function(e,t,n){return{getItem:tn(e),getItemId:Ee(e),addNotificationMessage:Zt(t),removeNotificationMessage:Yt(t),getNotificationMessageIds:$t(t),mode:Me.a.MessageRead,displayMessageForm:Se,displayNewMessageForm:Ft.a,displayNewAppointmentForm:Dt,displayReplyForm:Ut,displayAppointmentForm:he,isAddinPinned:Ie,isItemSelected:nn(t,0,n),isInlineComposeOpen:rn(t,e),isSharedItem:oe(e),isRemoteItem:se,getSharedProperties:Pe(e),getRecurrence:(r=e,function(){return Object(b.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return Object(b.__generator)(this,(function(n){switch(n.label){case 0:return r.AssociatedCalendarItemId?r.Recurrence?[2,r.Recurrence]:[3,1]:[2,null];case 1:return[4,zt(r.AssociatedCalendarItemId)];case 2:return(e=n.sent())?e.Recurrence?[2,e.Recurrence]:e.SeriesMasterItemId?[4,zt(e.SeriesMasterItemId)]:[3,4]:[2,null];case 3:return(t=n.sent())?[2,t.Recurrence]:[2,null];case 4:return[2,null]}}))}))}),getSeriesId:Gt(e),getAllInternetHeaders:qt(e),getAttachmentContent:en(t),getCategoriesMailbox:ce,addCategoriesMailbox:ue,removeCategoriesMailbox:le,getCategoriesItem:de(t),addCategoriesItemRead:fe(t),removeCategoriesItemRead:pe(t)};var r}));n.d(t,"createMailComposeAdapter",(function(){return Rt})),n.d(t,"createMailReadAdapter",(function(){return on}))},1508:function(e,t,n){"use strict";var r=n(1557),o=n(1236),i=n(295);var a=function(e,t){var n=t||e.Name;if(!n)return!0;var o,a,s=Object(r.a)(n),c=(o=n,a=e.EmailAddress,o==a||o&&a&&o.toLowerCase()==a.toLowerCase()),u=-1!==n.indexOf("@"),l=!Object(i.a)()&&("ExternalMailbox"===e.MailboxType||"LinkedIn"===e.MailboxType),d="OneOff"===e.MailboxType||"Unknown"===e.MailboxType;return e.EmailAddress&&!("SMTP"===e.RoutingType&&c)&&(s||u||l||d)};t.a=function(e,t){var n=t||e.Name,i=!n||Object(r.a)(n);return a(e,t)?i?Object(o.a)(e):n+" <"+Object(o.a)(e)+">":n}},1513:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(948),o=n(1108);function i(){var e=Object(o.c)(),t=null;return null==(t=1===e.type?e.searchFolderId:5===e.type?e.data.searchFolderId:e.id)?null:r.d.folderTable.get(t)}},1516:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),o=n(1085),i=n(1005),a=n(1130),s=n(314);function c(e,t,n){var c,f;void 0===t&&(t=0);var p=function(e){switch(e){case 0:return u;case 1:return l;case 2:return d;default:return Object(s.a)(e)}}(t),m=Object(a.b)();try{for(var g=Object(r.__values)(Object(i.a)().tabs),h=g.next();!h.done;h=g.next()){var v=h.value;if(v.type==o.a.Compose&&0==v.state){var y=m.viewStates.get(v.data);if((null==y?void 0:y.isInlineCompose)&&p(y,e)&&(0==y.asyncSendState||n&&6==y.asyncSendState))return y}}}catch(e){c={error:e}}finally{try{h&&!h.done&&(f=g.return)&&f.call(g)}finally{if(c)throw c.error}}return null}function u(e,t){return e.conversationId===t}function l(e,t){return e.referenceItemId.Id===t}function d(e,t){return!1}},1517:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var r=20,o=10},1520:function(e,t,n){"use strict";var r=function(e){return function(){return e}},o=n(1201),i=n(1145),a=o.a?function(e,t){return Object(o.a)(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:i.a,s=800,c=16,u=Date.now;var l=function(e){var t=0,n=0;return function(){var r=u(),o=c-(r-n);if(n=r,o>0){if(++t>=s)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(a);t.a=l},1522:function(e,t,n){"use strict";var r=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)},o=Math.max;t.a=function(e,t,n){return t=o(void 0===t?e.length-1:t,0),function(){for(var i=arguments,a=-1,s=o(i.length-t,0),c=Array(s);++a<s;)c[a]=i[t+a];a=-1;for(var u=Array(t+1);++a<t;)u[a]=i[a];return u[t]=n(c),r(e,this,u)}}},1529:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return d}));var r=n(0),o=n(1262),i=n(1558);function a(e,t,n,r){return u(d(e),t,n,r)}function s(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,i.c.import().then((function(r){return r(e,t,(function(e){return l(n,e,o)}))}))];case 1:return[2,r.sent()]}}))}))}function c(e,t,n,r){return u(e,t,n,r)}function u(e,t,n,r){for(var i=[],a=0;i.length<t&&o.a.recipientCache&&a<o.a.recipientCache.length;){var s=o.a.recipientCache[a];if(e(s))l(n,s.EmailAddress,r)||i.push(s);a++}return i}function l(e,t,n){var r=!1;return e&&function(e,t){for(var n=0;n<t.length;n++)if(e.EmailAddress==t[n].EmailAddress.EmailAddress)return!0;return!1}(t,e)&&(r=!0),n&&n.indexOf(t.MailboxType)>=0&&(r=!0),r}var d=function(e){return function(t){var n=t.EmailAddress;if(n.EmailAddress&&0==n.EmailAddress.toLowerCase().indexOf(e))return!0;if(n.Name){if(0==n.Name.toLowerCase().indexOf(e))return!0;for(var r=n.Name.toLowerCase().split(" "),o=0;o<r.length;o++)if(0==r[o].indexOf(e))return!0}return!1}}},1536:function(e,t,n){"use strict";var r=n(1468),o=n(1547);t.a=function(e){return Object(r.a)((function(t,n){var r=-1,i=n.length,a=i>1?n[i-1]:void 0,s=i>2?n[2]:void 0;for(a=e.length>3&&"function"==typeof a?(i--,a):void 0,s&&Object(o.a)(n[0],n[1],s)&&(a=i<3?void 0:a,i=1),t=Object(t);++r<i;){var c=n[r];c&&e(t,c,r,a)}return t}))}},1537:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(4),o=Object(r.action)("HIDE_FULL_OPTION",(function(e,t){return{showQuickOptions:e,subcategory:t}}))},1538:function(e,t,n){"use strict";var r=n(4),o=Object(r.createStore)("inlineimages",{inlineImages:{}})();t.a=o},1539:function(e,t,n){"use strict";var r=n(4),o=Object(r.createStore)("inboxPlusStore",{inboxPlusPivots:[],isPivotEnableDisableDialogShown:!1})();t.a=o},1540:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),o=n(1044),i=n(1005),a=n(79);function s(){var e,t,n=Object(i.a)();try{for(var s=Object(r.__values)(n.tabs),c=s.next();!c.done;c=s.next()){var u=c.value;if(2==u.state&&u.type!=o.a.FloatingChat)return u}}catch(t){e={error:t}}finally{try{c&&!c.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}return a.d("There is no active tab. Something went very wrong."),null}},1545:function(e,t,n){"use strict";var r=n(108),o=n(1654);function i(){return Object(o.a)().isFluidEnabled}n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return i}));var a=new r.c((function(){return Promise.all([n.e(4),n.e(282)]).then(n.bind(null,15150))})),s=new r.a(a,(function(e){return e.updateTenantConfigForFluid})),c=new r.a(a,(function(e){return e.setIsFluidEnabled}))},1547:function(e,t,n){"use strict";var r=n(1054),o=n(1063),i=n(1113),a=n(429);t.a=function(e,t,n){if(!Object(a.a)(n))return!1;var s=typeof t;return!!("number"==s?Object(o.a)(n)&&Object(i.a)(t,n.length):"string"==s&&t in n)&&Object(r.a)(n[t],e)}},1548:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"h",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return l})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return p}));var r=5,o={},i={};function a(e,t,n,r){h([e,"data",t])||function(e,t){o[e]=o[e]||{data:{},messageIds:[]},o[e].data[t]={}}(e,t),u(n)&&m(n),function(e,t,n,r){o[e].data[t][n]=r,o[e].messageIds.push(n),i[n]={hostItemIndex:e,extensionId:t}}(e,t,n,r)}function s(e){c(e)&&m(e)}function c(e){if(!u(e))return null;var t=i[e];return h([t.hostItemIndex,"data",t.extensionId,e])}function u(e){return!!i[e]}function l(e,t,n){var o=g(e,t)||[],i=Object.keys(o).length||0;return n?i>=1:i>=r}function d(e,t){var n=g(e,t);return n?Object.keys(n).reduce((function(e,t){var r=n[t];return r.Persistent&&(e[t]=r),e}),{}):{}}function f(e){return o[e]?o[e].messageIds:[]}function p(e){o[e]&&(o[e].messageIds.forEach((function(e){return delete i[e]})),delete o[e])}function m(e){var t=i[e],n=t.hostItemIndex;delete g(n,t.extensionId)[e],delete i[e];var r=o[n].messageIds,a=r.indexOf(e);~a&&r.splice(a,1)}function g(e,t){return h([e,"data",t])}function h(e){for(var t=o,n=0;n<e.length;n++){var r=e[n];if(!t[r])return null;t=t[r]}return t}},1551:function(e,t,n){"use strict";n.r(t),n.d(t,"DESCENDING_SORT_DIR",(function(){return o})),n.d(t,"ASCENDING_SORT_DIR",(function(){return i})),n.d(t,"DEFAULT_SORT_COLUMN",(function(){return a})),n.d(t,"getSortBySupportingPin",(function(){return s})),n.d(t,"getSupportedSortColumns",(function(){return c})),n.d(t,"getDefaultSortDirectionForSortColumn",(function(){return u})),n.d(t,"getDefaultSortBy",(function(){return l})),n.d(t,"isTableMultiValueSort",(function(){return d}));var r=n(950),o="Descending",i="Ascending",a=1;function s(){return{sortColumn:1,sortDirection:o}}function c(e){return Object(r.a)("sentitems")==e||Object(r.a)("drafts")==e?[1,7]:[1,3,7,5,8]}function u(e){switch(e){case 1:case 7:case 5:return o;case 3:case 8:return i;default:throw new Error("getDefaultSortDirectionForSortColumn: sortColumn not supported")}}function l(){return{sortColumn:a,sortDirection:u(a)}}function d(e){var t=0==e.type&&e.sortBy.sortColumn;return t&&0==e.listViewType&&3==t}},1552:function(e,t,n){"use strict";function r(e){if(!e)return null;switch(e.tableQuery.type){case 0:case 2:return e.tableQuery.focusedViewFilter;case 1:return-1;default:throw new Error("Table Query should be either of type search, mail folder or group")}}n.d(t,"a",(function(){return r}))},1555:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r=n(1044),o={};function i(e,t){o[r.a[e]]=t}function a(e){return o[r.a[e]]}},1557:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=["\t","\n","\v","\f","\r"," ","","","","","","","","","","","","","","","\u2028","\u2029","","","","","","","","","","\u2028","\u2029","","","","","","","","","","",""],o=null,i=function(e){return null===o&&(o=new Set,r.forEach((function(e){return o.add(e)}))),e.split("").every((function(e){return o.has(e)}))}},1558:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(108),o=new r.c((function(){return Promise.all([n.e(29),n.e(31),n.e(105)]).then(n.bind(null,2799))})),i=new r.b(o,(function(e){return e.searchCacheTrie})),a=new r.b(o,(function(e){return e.compareFeatureData})),s=new r.a(o,(function(e){return e.initializeSuggestionTrie}))},1569:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"ItemChange:#Exchange"},e)}},1573:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(971);function o(e){return r.a.conversationItems.get(e)}},1574:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s}));var r=n(297),o=n(431),i=n(76);function a(e,t){return e.serverFolderId?e.serverFolderId==e.tableQuery.folderId?t?null:s(e.tableQuery):c(e.serverFolderId):null}function s(e){return 2==e.type?(t=e.folderId,Object(r.a)({Id:Object(i.h)("grp-junkemailitems")?"junkemail":"inbox",Mailbox:{MailboxType:"GroupMailbox",EmailAddress:t}})):c(e.folderId);var t}function c(e){return Object(o.a)({Id:e})}},1575:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="IPM.Note.SMIME"},1579:function(e,t,n){"use strict";var r=n(0),o=n(1938),i=n(4);var a=Object(i.mutatorAction)("removeInfoBarMessages",(function(e,t){e&&(Array.isArray(t)?t:t?[t]:e.infoBarIds?Object(r.__spread)(e.infoBarIds):[]).forEach((function(t){return function(e,t){var n=e.infoBarIds&&e.infoBarIds.indexOf(t);n>=0&&e.infoBarIds.splice(n,1);var r=e.infoBarHostKey;o.b[r]&&(delete o.b[r][t],0===Object.keys(o.b[r]).length&&delete o.b[r])}(e,t)}))}));t.a=a},1587:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return u}));var r=n(0),o=n(1090);function i(e){return Object(o.a)().runningUILessExtendedAddinCommands.has(e)}function a(e){var t,n,o,i,a=l();try{for(var s=Object(r.__values)(a.values()),c=s.next();!c.done;c=s.next()){var u=c.value;try{for(var d=(o=void 0,Object(r.__values)(u.keys())),f=d.next();!f.done;f=d.next()){var p=f.value;if(p===e)return u.get(p).addinCommand}}catch(e){o={error:e}}finally{try{f&&!f.done&&(i=d.return)&&i.call(d)}finally{if(o)throw o.error}}}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return null}function s(e,t){return l().has(e)&&l().get(e).has(t)?l().get(e).get(t).addinCommandTelemetry:null}function c(e){var t,n,o,i,a=l();try{for(var s=Object(r.__values)(a.keys()),c=s.next();!c.done;c=s.next()){var u=c.value,d=a.get(u);try{for(var f=(o=void 0,Object(r.__values)(d.keys())),p=f.next();!p.done;p=f.next()){if(p.value===e)return u}}catch(e){o={error:e}}finally{try{p&&!p.done&&(i=f.return)&&i.call(f)}finally{if(o)throw o.error}}}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return null}function u(e){return null!==a(e)}function l(){return Object(o.a)().runningUILessExtendedAddinCommands}},1593:function(e,t,n){"use strict";function r(e){return!(null==e?void 0:e.ItemClass)||-1!==e.ItemClass.indexOf("IPM.Note")||-1!==e.ItemClass.indexOf("IPM.Schedule.Meeting")||-1!==e.ItemClass.indexOf("IPM.GroupMailbox.JoinRequest")||-1!==e.ItemClass.indexOf("IPM.Post")||-1!==e.ItemClass.indexOf("IPM.Sharing")}n.d(t,"a",(function(){return r}))},1594:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1259),o=n(953);function i(e){return e&&(Object(r.a)(e,o.f)||Object(r.a)(e,o.a))}},1595:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(947),o=n(76),i=n(1004);function a(e){return"Unread"!==Object(r.K)(e)||Object(o.h)("tri-autoMarkReadInUnreadSetting")&&Object(i.a)(64)}},1608:function(e,t,n){"use strict";var r=n(4);var o=n(24),i=Object(r.createStore)("extensibility",{EnabledAddinCommands:null,HostItems:new o.ObservableMap,IsPreinstalledTeachingUIAvailable:!1,Context:null,taskPanes:new o.ObservableMap,activeDialog:null,ExtensibilityStateIsDirty:!1,contextualCalloutState:{activeContextualAddinCommands:[],contextualAnchor:null,hostItemIndex:null,selectedTerms:[]},runningContextualAddinCommand:null,runningUILessExtendedAddinCommands:new o.ObservableMap,blockedAddinCommands:new o.ObservableMap,autoRunAddinCommandWaitingQueue:new o.ObservableMap,compliance:{isMinor:!1}})();t.a=i},1616:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"FolderResponseShape:#Exchange"},e)}},1635:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1148),o=n(1400);function i(e,t,n){switch(t.tableQuery.listViewType){case 0:Object(r.a)(e,t.id).instrumentationContext=n;break;case 1:Object(o.a)(e,t.id).instrumentationContext=n}}},1636:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"y",(function(){return s})),n.d(t,"k",(function(){return c})),n.d(t,"i",(function(){return u})),n.d(t,"j",(function(){return l})),n.d(t,"p",(function(){return d})),n.d(t,"Q",(function(){return f})),n.d(t,"L",(function(){return p})),n.d(t,"K",(function(){return m})),n.d(t,"J",(function(){return g})),n.d(t,"w",(function(){return h})),n.d(t,"x",(function(){return v})),n.d(t,"h",(function(){return y})),n.d(t,"d",(function(){return b})),n.d(t,"I",(function(){return _})),n.d(t,"P",(function(){return S})),n.d(t,"v",(function(){return C})),n.d(t,"u",(function(){return O})),n.d(t,"s",(function(){return A})),n.d(t,"r",(function(){return I})),n.d(t,"D",(function(){return x})),n.d(t,"E",(function(){return E})),n.d(t,"B",(function(){return T})),n.d(t,"C",(function(){return P})),n.d(t,"t",(function(){return w})),n.d(t,"q",(function(){return M})),n.d(t,"H",(function(){return R})),n.d(t,"S",(function(){return j})),n.d(t,"T",(function(){return k})),n.d(t,"f",(function(){return N})),n.d(t,"e",(function(){return D})),n.d(t,"a",(function(){return F})),n.d(t,"G",(function(){return L})),n.d(t,"g",(function(){return U})),n.d(t,"N",(function(){return B})),n.d(t,"m",(function(){return H})),n.d(t,"o",(function(){return W})),n.d(t,"n",(function(){return V})),n.d(t,"O",(function(){return z})),n.d(t,"A",(function(){return G})),n.d(t,"z",(function(){return q})),n.d(t,"l",(function(){return K})),n.d(t,"F",(function(){return X})),n.d(t,"M",(function(){return J})),n.d(t,"R",(function(){return Q}));var r=n(108),o=new r.c((function(){return Promise.all([n.e(730),n.e(20),n.e(26),n.e(38),n.e(593)]).then(n.bind(null,6487))})),i=new r.b(o,(function(e){return e.addMailboxToSafeSenders})),a=new r.a(o,(function(e){return e.alwaysMoveRowToFocusedOrOther})),s=new r.a(o,(function(e){return e.moveMailListRowsToFocusedOrOther})),c=new r.a(o,(function(e){return e.deleteMailListRows})),u=new r.a(o,(function(e){return e.deleteItems})),l=new r.b(o,(function(e){return e.deleteItemsBasedOnNodeIds})),d=new r.b(o,(function(e){return e.likeItem})),f=new r.a(o,(function(e){return e.toggleRowsFlagState})),p=new r.a(o,(function(e){return e.setMailListRowsFlagState})),m=new r.a(o,(function(e){return e.setItemsFlagStateFromItemIds})),g=new r.b(o,(function(e){return e.setItemsFlagStateBasedOnNodeIds})),h=(new r.a(o,(function(e){return e.moveItemsFromItemIds})),new r.b(o,(function(e){return e.moveItemsBasedOnNodeIds}))),v=new r.a(o,(function(e){return e.moveMailListRows})),y=new r.a(o,(function(e){return e.copyMailListRows})),b=new r.a(o,(function(e){return e.archiveMailListRowsFromTable})),_=new r.b(o,(function(e){return e.scheduleRows})),S=new r.a(o,(function(e){return e.toggleRowPinnedState})),C=new r.a(o,(function(e){return e.markRowsPinnedUnpinned})),O=new r.a(o,(function(e){return e.markRowsJunkNotJunkFromTable})),A=new r.b(o,(function(e){return e.markItemsJunkNotJunkBasedOnNodeIds})),I=new r.a(o,(function(e){return e.markItemJunkNotJunkFromReadingPane})),x=new r.a(o,(function(e){return e.onKeyboardMarkAsJunkNotJunk})),E=new r.a(o,(function(e){return e.onKeyboardToggleFlagState})),T=new r.a(o,(function(e){return e.onKeyboardArchive})),P=new r.a(o,(function(e){return e.onKeyboardDelete})),w=new r.a(o,(function(e){return e.markRowsAsPhishingFromTable})),M=new r.a(o,(function(e){return e.markItemAsPhishingFromReadingPane})),R=new r.a(o,(function(e){return e.restoreMailListRows})),j=new r.a(o,(function(e){return e.unsubscribeEmail})),k=new r.b(o,(function(e){return e.unsubscribeEmailV2})),N=new r.a(o,(function(e){return e.blockLastSendersFromTable})),D=new r.a(o,(function(e){return e.blockLastSenderFromReadingPane})),F=new r.a(o,(function(e){return e.addCategoriesFromTable})),L=new r.a(o,(function(e){return e.removeCategoriesFromTable})),U=new r.a(o,(function(e){return e.clearCategoriesFromTable})),B=new r.a(o,(function(e){return e.sweepConversations})),H=new r.a(o,(function(e){return e.emptyFolder})),W=new r.a(o,(function(e){return e.emptyTableView})),V=new r.a(o,(function(e){return e.emptySearchTableView})),z=new r.b(o,(function(e){return e.toggleIgnoreConversations})),G=new r.b(o,(function(e){return e.moveSharedFolderItems})),q=new r.b(o,(function(e){return e.moveSharedFolderConversations})),K=new r.b(o,(function(e){return e.dismissNudge})),X=new r.b(o,(function(e){return e.onRemoveMeeting})),J=new r.a(o,(function(e){return e.showNotificationOnMailboxQuotaWarning})),Q=new r.a(o,(function(e){return e.translateFromTable}))},1648:function(e,t,n){"use strict";var r=n(1260),o=n(1319),i=n(4),a=Object(i.action)("EDIT_GROUP_SUCCESS",(function(e,t){return{groupSmtp:e,photoUrl:t}})),s=Object(i.action)("ADD_GROUP_MEMBER_SUCCESS",(function(e){return{groupSmtp:e}})),c=Object(i.action)("POPUP_OPENED",(function(){return{isOpen:!0}})),u=Object(i.action)("POPUP_CLOSED",(function(){return{isOpen:!1}})),l=Object(i.action)("DELETE_GROUP_SUCCESS",(function(e){return{groupSmtp:e}})),d=n(1424);n.d(t,"n",(function(){return r.a})),n.d(t,"m",(function(){return o.a})),n.d(t,"l",(function(){return a})),n.d(t,"j",(function(){return s})),n.d(t,"p",(function(){return c})),n.d(t,"o",(function(){return u})),n.d(t,"k",(function(){return l})),n.d(t,"g",(function(){return d.g})),n.d(t,"c",(function(){return d.c})),n.d(t,"d",(function(){return d.d})),n.d(t,"a",(function(){return d.a})),n.d(t,"e",(function(){return d.e})),n.d(t,"f",(function(){return d.f})),n.d(t,"i",(function(){return d.i})),n.d(t,"b",(function(){return d.b})),n.d(t,"h",(function(){return d.h}))},1653:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(27);function o(){var e=Object(r.a)().PolicySettings;return e?{OutboundCharset:e.OutboundCharset,UseGB18030:e.UseGB18030,UseISO885915:e.UseISO885915}:{OutboundCharset:"AutoDetect"}}},1654:function(e,t,n){"use strict";var r=n(4),o=Object(r.createStore)("fluidTenantConfigStore",{isFluidEnabled:!1});t.a=o},1655:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1130),o=n(1085),i=n(1516),a=n(79);function s(e,t,n){var s,c=Object(r.b)();if(e){switch(e.type){case o.a.SecondaryReadingPane:e.data.listViewType==n&&(s=Object(i.a)(t,n));break;case o.a.Compose:s=c.viewStates.get(e.data);break;case o.a.Primary:s=t?Object(i.a)(t,n,!0):null;break;default:s=null}return s}return a.d("There is no active tab. Something went very wrong."),null}},1656:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(315);function o(e){var t=new Headers;return Object(r.g)(e,t),{headers:t}}},1664:function(e,t,n){"use strict";var r;!function(e){e.None="None",e.OwaProxy="OwaProxy",e.ConnectorsProxy="ConnectorsProxy",e.Compose="Compose",e.OwaAndConnectorsProxy="OwaAndConnectorsProxy",e.OwaConnectorsProxyAndCompose="OwaConnectorsProxyAndCompose"}(r||(r={})),t.a=r},1666:function(e,t,n){"use strict";var r=function(e){this.errorCode=e};t.a=r},1669:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.Pending=1]="Pending",e[e.Complete=2]="Complete"}(r||(r={}))},1670:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(2463),o=n(1827),i=n(1828),a=n(9),s=n(1539),c=n(948),u=n(950);function l(e){switch(e){case 0:return{displayText:1===s.a.inboxPlusPivots.filter((function(e){return e.isEnabled})).length?c.d.folderTable.get(Object(u.a)("inbox")).DisplayName:Object(a.b)(r.a),icon:"Inbox"};case 1:return{displayText:Object(a.b)(i.a),icon:"InboxCheck"};case 2:return{displayText:Object(a.b)(r.c),icon:"ShoppingCart"};case 3:return{displayText:Object(a.b)(r.d),icon:"Like"};case 4:return{displayText:Object(a.b)(r.b),icon:"News"};case 5:return{displayText:Object(a.b)(o.a),icon:"MailLowImportance"};default:return null}}},1672:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),o=n(963),i=n(1802),a=n(2135),s=n(4);function c(e){var t,n,s,c;if(o.w.conversations.has(e)){var d=o.w.conversations.get(e);try{for(var f=Object(r.__values)(d.conversationNodeIds),p=f.next();!p.done;p=f.next()){var m=p.value,g=o.w.conversationNodes.get(m);if(g)try{for(var h=(s=void 0,Object(r.__values)(g.itemIds)),v=h.next();!v.done;v=h.next()){var y=v.value;Object(i.a)(y,1)}}catch(e){s={error:e}}finally{try{v&&!v.done&&(c=h.return)&&c.call(h)}finally{if(s)throw s.error}}u(m)}}catch(e){t={error:e}}finally{try{p&&!p.done&&(n=f.return)&&n.call(f)}finally{if(t)throw t.error}}l(e)}Object(a.a)()}var u=Object(s.mutatorAction)("deleteConversationNode",(function(e){o.w.conversationNodes.delete(e)})),l=Object(s.mutatorAction)("deleteConversation",(function(e){o.w.conversations.delete(e)}))},1689:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return u}));var r,o=n(9),i="FileAttachment:#Exchange",a="ItemAttachment:#Exchange",s="ItemIdAttachment:#Exchange",c="ReferenceAttachment:#Exchange";!function(e){e[e.File=0]="File",e[e.Item=1]="Item",e[e.Cloud=2]="Cloud"}(r||(r={}));var u=function(e){return e.map((function(e){return{id:l(e),name:e.Name,contentType:e.ContentType,size:e.Size,attachmentType:d(e),isInline:e.IsInline||!1}}))};function l(e){return e.__type===c?e.AttachmentOriginalUrl:e.AttachmentId.Id}function d(e){switch(e.__type){case i:return r.File;case a:return r.Item;case c:return r.Cloud;case s:var t=e;return Object(o.f)(t.AttachmentIdToAttach)?r.Item:r.File;default:throw new Error("Invalid type of attachment "+e.__type)}}},1691:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"SetItemField:#Exchange"},e)}},1693:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("conversationSendStateChanged",(function(e,t){return{viewState:e,isSendPending:t}}))},171:function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"g",(function(){return r}));var r,o="ktp",i="-",a="data-ktp-target",s="data-ktp-execute-target",c="ktp-layer-id",u=", ";!function(e){e.KEYTIP_ADDED="keytipAdded",e.KEYTIP_REMOVED="keytipRemoved",e.KEYTIP_UPDATED="keytipUpdated",e.PERSISTED_KEYTIP_ADDED="persistedKeytipAdded",e.PERSISTED_KEYTIP_REMOVED="persistedKeytipRemoved",e.PERSISTED_KEYTIP_EXECUTE="persistedKeytipExecute",e.ENTER_KEYTIP_MODE="enterKeytipMode",e.EXIT_KEYTIP_MODE="exitKeytipMode"}(r||(r={}))},1727:function(e,t,n){"use strict";var r=n(108),o=n(1672),i=n(963),a=n(283),s=Object(a.action)("setIsPendingDeleteConversationItemParts")(Object(a.select)({conversationItemParts:function(e){return i.w.conversations.get(e)}})((function(e,t,n){var r=n.conversationItemParts;r&&(r.isPendingDelete=t)}))),c=n(1517);n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return f})),n.d(t,"b",(function(){return o.a})),n.d(t,"f",(function(){return s})),n.d(t,"a",(function(){return c.b}));var u=new r.c((function(){return n.e(406).then(n.bind(null,15045))})),l=new r.a(u,(function(e){return e.loadAllRecipientsForItem})),d=new r.a(u,(function(e){return e.loadItem})),f=new r.a(u,(function(e){return e.loadConversation}))},1730:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=0]="Unknown",e[e.Single=1]="Single",e[e.Empty=2]="Empty",e[e.Multi=3]="Multi",e[e.NotSupported=4]="NotSupported"}(r||(r={}))},1731:function(e,t,n){"use strict";var r;!function(e){e[e.Added=0]="Added",e[e.Deleted=1]="Deleted"}(r||(r={})),t.a=r},1732:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Room="room",e.Custom="custom"}(r||(r={}))},1733:function(e,t,n){"use strict";var r;!function(e){e[e.To=0]="To",e[e.Cc=1]="Cc",e[e.Bcc=2]="Bcc",e[e.RequiredAttendees=0]="RequiredAttendees",e[e.OptionalAttendees=1]="OptionalAttendees",e[e.Resources=2]="Resources"}(r||(r={})),t.a=r},1734:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(0),o=n(1),i=n(691),a=n(229),s=n(253),c=n(277),u=n(441),l=n(106),d=n(83),f=n(252),p=n(704),m=Object(s.a)(),g="OverflowSet",h=function(e){function t(t){var n=e.call(this,t)||this;return n._focusZone=o.createRef(),n._persistedKeytips={},n._keytipManager=p.a.getInstance(),n._divContainer=o.createRef(),n._onRenderItems=function(e){return e.map((function(e,t){return o.createElement("div",{key:e.key,className:n._classNames.item},n.props.onRenderItem(e))}))},n._onRenderOverflowButtonWrapper=function(e){var t={className:n._classNames.overflowButton},i=n.props.keytipSequences,a=[];return i?e.forEach((function(e){var t=e.keytipProps;if(t){var o={content:t.content,keySequences:t.keySequences,disabled:t.disabled||!(!e.disabled&&!e.isDisabled),hasDynamicChildren:t.hasDynamicChildren,hasMenu:t.hasMenu};t.hasDynamicChildren||n._getSubMenuForItem(e)?o.onExecute=n._keytipManager.menuExecute.bind(n._keytipManager,i,e.keytipProps.keySequences):o.onExecute=t.onExecute,n._persistedKeytips[o.content]=o;var s=Object(r.__assign)(Object(r.__assign)({},e),{keytipProps:Object(r.__assign)(Object(r.__assign)({},t),{overflowSetSequence:i})});a.push(s)}else a.push(e)})):a=e,o.createElement("div",Object(r.__assign)({},t),n.props.onRenderOverflowButton(a))},Object(c.a)(n),Object(u.a)(g,t,{doNotContainWithinFocusZone:"focusZoneProps"}),n}return Object(r.__extends)(t,e),t.prototype.render=function(){var e,t,n=this.props,s=n.items,c=n.overflowItems,u=n.className,d=n.focusZoneProps,f=n.styles,p=n.vertical,g=n.doNotContainWithinFocusZone,h=n.role,v=n.overflowSide,y=void 0===v?"end":v;this._classNames=m(f,{className:u,vertical:p}),g?(e="div",t=Object(r.__assign)(Object(r.__assign)({},Object(l.j)(this.props,l.h)),{ref:this._divContainer})):(e=i.a,t=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},Object(l.j)(this.props,l.h)),d),{componentRef:this._focusZone,direction:p?a.a.vertical:a.a.horizontal}));var b=c&&c.length>0;return o.createElement(e,Object(r.__assign)({role:h||"group","aria-orientation":"menubar"===h?!0===p?"vertical":"horizontal":void 0},t,{className:this._classNames.root}),"start"===y&&b&&this._onRenderOverflowButtonWrapper(c),s&&this._onRenderItems(s),"end"===y&&b&&this._onRenderOverflowButtonWrapper(c))},t.prototype.focus=function(e){var t=!1;return this.props.doNotContainWithinFocusZone?this._divContainer.current&&(t=Object(d.c)(this._divContainer.current)):this._focusZone.current&&(t=this._focusZone.current.focus(e)),t},t.prototype.focusElement=function(e){var t=!1;return!!e&&(this.props.doNotContainWithinFocusZone?this._divContainer.current&&Object(f.a)(this._divContainer.current,e)&&(e.focus(),t=document.activeElement===e):this._focusZone.current&&(t=this._focusZone.current.focusElement(e)),t)},t.prototype.componentDidMount=function(){this._registerPersistedKeytips()},t.prototype.componentWillUnmount=function(){this._unregisterPersistedKeytips()},t.prototype.UNSAFE_componentWillUpdate=function(){this._unregisterPersistedKeytips()},t.prototype.componentDidUpdate=function(){this._registerPersistedKeytips()},t.prototype._registerPersistedKeytips=function(){var e=this;Object.keys(this._persistedKeytips).forEach((function(t){var n=e._persistedKeytips[t],r=e._keytipManager.register(n,!0);e._persistedKeytips[r]=n,delete e._persistedKeytips[t]}))},t.prototype._unregisterPersistedKeytips=function(){var e=this;Object.keys(this._persistedKeytips).forEach((function(t){e._keytipManager.unregister(e._persistedKeytips[t],t,!0)})),this._persistedKeytips={}},t.prototype._getSubMenuForItem=function(e){return this.props.itemSubMenuProvider?this.props.itemSubMenuProvider(e):e.subMenuProps?e.subMenuProps.items:void 0},t}(o.Component)},1737:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"GetConversationItemsJsonRequest:#Exchange"},e)}},1766:function(e,t,n){"use strict";var r=n(25),o=n(0);function i(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(o.__assign)({__type:"FindFolderJsonRequest:#Exchange"},n)),Object(r.a)("FindFolder",e,t)}n.d(t,"a",(function(){return i}))},1770:function(e,t,n){"use strict";var r=n(1064),o=n(1536),i=n(1042),a=Object(o.a)((function(e,t,n,o){Object(r.a)(t,Object(i.a)(t),e,o)}));t.a=a},1771:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"GetCalendarEventRequest:#Exchange"},e)}},1772:function(e,t,n){"use strict";function r(e){if(null!=e.RightsManagementLicenseData)return!1;if(e.IsDraft)return!1;var t=e.ItemClass?e.ItemClass.toLowerCase():"";return(0!=t.indexOf("ipm.note.smime")||-1!=t.indexOf("ipm.note.smime.multipartsigned"))&&0!=t.indexOf("report")}n.d(t,"a",(function(){return r}))},1775:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"FindFolderRequest:#Exchange"},e)}},1778:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("saveSigningCertificate",(function(e,t){return{smimeViewState:e,signingCertRawData:t}}))},1784:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.InProgress=1]="InProgress",e[e.Failed=2]="Failed",e[e.SucceededWithDLOrGroupMembers=3]="SucceededWithDLOrGroupMembers",e[e.SucceededWithoutDLOrGroupMembers=4]="SucceededWithoutDLOrGroupMembers"}(r||(r={})),t.b=r},1793:function(e,t,n){"use strict";var r=n(76),o=n(1129),i=n(1529),a=function(e){var t=Object(i.c)((function(t){return"SMTP"===t.EmailAddress.RoutingType&&t.EmailAddress.EmailAddress&&t.EmailAddress.EmailAddress.toLowerCase()===e.toLowerCase()}),1);return t.length?t[0]:null},s=n(79),c=function(e){var t=void 0!==e.EmailAddress;return t||s.g.warn("Recipient cache contained a persona that had no EmailAddress"),t};function u(e){if(Object(r.h)("cmp-resolveRecipsFromCache")&&"SMTP"===e.RoutingType&&e.EmailAddress){var t=a(e.EmailAddress);if(t&&c(t))return Object(o.a)(t)}return null}n.d(t,"a",(function(){return u}))},1795:function(e,t,n){"use strict";var r=n(25),o=n(0);function i(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(o.__assign)({__type:"GetCalendarEventJsonRequest:#Exchange"},n)),Object(r.a)("GetCalendarEvent",e,t)}n.d(t,"a",(function(){return i}))},1802:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("TRY_REMOVE_FROM_MAIL_STORE_ITEMS",(function(e,t){return{itemIdToRemove:e,removeItemSource:t}}))},1806:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return a}));var r={};function o(e,t,n){r[e.editorId]={htmlEditor:t,plainTextEditor:n}}function i(e,t,n){var o=r[e.editorId];o&&(o.htmlEditor==t&&(o.htmlEditor=null),o.plainTextEditor==n&&(o.plainTextEditor=null),o.htmlEditor||o.plainTextEditor||delete r[e.editorId])}function a(e,t,n,o){if(e){var i=e.bodyType,a=void 0===i||"HTML"===i,s="Text"===i,c=r[e.editorId]||{},u=c.htmlEditor,l=c.plainTextEditor;a&&t&&(u&&!u.isDisposed()||o)?t(u):s&&n&&(l||o)&&n(l)}}},1818:function(e,t,n){"use strict";t.a={sendFeedback:function(){}}},1826:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(1827),o=n(1828),i=n(2370),a=n(9),s=n(1670),c=n(1109),u=n(947);function l(e,t,n){if(1===e)return Object(a.b)(i.a);if(t){if(Object(u.J)(t))return Object(u.J)(t);var l=Object(u.l)(t),d=Object(u.p)(t.id);if(Object(c.e)()&&0!==d)return Object(s.a)(d).displayText;switch(l){case 0:return Object(a.b)(o.a);case 1:return Object(a.b)(r.a)}}return n}},1827:function(e){e.exports=JSON.parse('{"a":"z5b"}')},1828:function(e){e.exports=JSON.parse('{"a":"y5b"}')},1829:function(e,t,n){"use strict";function r(e){return 0===e.tableQuery.listViewType}n.d(t,"a",(function(){return r}))},1830:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1595),o=n(947);function i(e){return"Unread"==Object(o.K)(e)&&Object(r.a)(e)}},1833:function(e,t,n){"use strict";n.d(t,"m",(function(){return i})),n.d(t,"l",(function(){return a})),n.d(t,"o",(function(){return s})),n.d(t,"q",(function(){return c})),n.d(t,"p",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return p})),n.d(t,"k",(function(){return m})),n.d(t,"n",(function(){return g})),n.d(t,"r",(function(){return h})),n.d(t,"c",(function(){return v})),n.d(t,"d",(function(){return y})),n.d(t,"j",(function(){return b})),n.d(t,"f",(function(){return _})),n.d(t,"i",(function(){return S})),n.d(t,"a",(function(){return C}));var r=n(108),o=(n(1778),new r.c((function(){return Promise.all([n.e(12),n.e(748),n.e(4),n.e(17),n.e(673)]).then(n.bind(null,3541))}))),i=new r.a(o,(function(e){return e.onSmimeItemAttachmentOpened})),a=new r.a(o,(function(e){return e.mergeSmimeDecodedMessageProperties})),s=(new r.b(o,(function(e){return e.fetchAndDecodeSmimeMessage})),new r.b(o,(function(e){return e.setSmimePropertiesInDraftMessage}))),c=new r.b(o,(function(e){return e.trySetSmimeProperties})),u=new r.b(o,(function(e){return e.tryAddSmimeProperties})),l=new r.b(o,(function(e){return e.createMailResponseBodyContent})),d=new r.b(o,(function(e){return e.downloadSmimeAttachment})),f=new r.b(o,(function(e){return e.getMergedSmimeViewState})),p=new r.b(o,(function(e){return e.getMergedSmimeViewStateForDraft})),m=new r.b(o,(function(e){return e.isSmimeItemDecoding})),g=new r.b(o,(function(e){return e.previewSmimeAttachment})),h=new r.b(o,(function(e){return e.updateSmimeAttachmentIds})),v=new r.b(o,(function(e){return e.createSmimeAttachmentsFromFiles})),y=new r.b(o,(function(e){return e.createSmimeAttachmentsViaSmimeQueueManager})),b=new r.b(o,(function(e){return e.initializeAttachmentStateForSmimeAttachments})),_=new r.b(o,(function(e){return e.getAttachmentsForSmimeResponse})),S=new r.b(o,(function(e){return e.getSmimeAttachmentsForRequest})),C=Object(r.d)(o,(function(e){return e.SignatureDetails}))},1836:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(972);function o(e){var t=(Object(r.a)(e)||"").toLowerCase();return!!e&&".fluid"===t}},1850:function(e,t,n){"use strict";function r(e,t){if(t.getClickHandler)t.onClick=t.getClickHandler(e);else if(t.sectionProps){t.sectionProps.items.forEach((function(t){r(e,t)}))}else if(t.subMenuProps){t.subMenuProps.items.forEach((function(t){r(e,t)}))}}n.d(t,"a",(function(){return r}))},1857:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(947);function o(e){var t=Object(r.F)().tableViews.get(e);switch(t.tableQuery.type){case 0:return t.tableQuery.inboxClassificationFilter;case 2:case 1:return 0;default:throw new Error("Table Query should be either of type search, mail folder or group")}}},1871:function(e,t,n){"use strict";var r=n(2129),o=n(1090);var i=n(2130),a=n(27);function s(){var e=null!=Object(o.a)().Context,t=Object(r.a)(),n=Object(a.a)().SegmentationSettings.OnSendAddinsEnabled;return e&&t?n&&Object(i.a)(1).length>0:n}n.d(t,"a",(function(){return s}))},1876:function(e,t,n){"use strict";var r;!function(e){e[e.Selected=0]="Selected",e[e.Deselected=1]="Deselected"}(r||(r={})),t.a=r},1879:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1),o=n(244),i=n(397),a=0;function s(e,t){var n=(t||window).document,s=n.createElement("div");s.id="owa-modal-"+a++,n.body.appendChild(s);var c,u=!1,l=function(){u||(u=!0,o.unmountComponentAtNode(s),n.body.removeChild(s))};return[new Promise((function(t,n){c=n,o.render(r.createElement(i.a,{type:i.b.None,onError:function(){l(),n()}},r.createElement(e,{onDismiss:function(e){l(),t(e)}})),s)})),function(){l(),c()}]}},1882:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(103),o=n(950);function i(e){var t=Object(r.i)(),n=1==t.PolicySettings.MessagePreviewsDisabled;return t.UserOptions.ShowReadingPaneOnFirstLoad&&!n&&e.tableQuery.folderId!==Object(o.a)("junkemail")}},1883:function(e){e.exports=JSON.parse('{"a":"n5b","b":"o5b","c":"p5b"}')},1884:function(e){e.exports=JSON.parse('{"b":"j5b","c":"k5b","d":"l5b","a":"m5b"}')},1885:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(76);function o(e,t){switch(e.tableQuery.type){case 0:return Object(r.h)("tri-triageFolderScope")&&t?e.tableQuery.folderId:e.serverFolderId;case 1:case 2:default:return null}}},1886:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(971),o=n(1286);function i(e,t){var n=r.a.tableViews.get(t),i=e.map((function(e){return Object(o.getRowIdString)(e,n)})).filter((function(e){return e}));return i.filter((function(e,t){return i.indexOf(e)==t}))}},1887:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1148);function o(e,t,n,o){for(var i=[],a=new Map,s=0;s<e.length;s++){var c=e[s],u=Object(r.a)(c,t),l=u.id;!a.get(l)&&n(u,o)&&(i.push(c),a.set(l,!0))}return i}},1888:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.BusStart=1]="BusStart",e[e.BusEnd=2]="BusEnd",e[e.BusStop=3]="BusStop",e[e.NoStop=4]="NoStop",e[e.CheckMark=5]="CheckMark"}(r||(r={})),t.a=r},1890:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var r=n(1275),o=n(1575);function i(e){return e&&0===e.indexOf(r.e)}function a(e){return e&&0===e.indexOf(o.a)&&!i(e)}function s(e){return e&&0===e.indexOf(o.a)}function c(e){return e.match(/^ipm\.(appointment|schedule\.meeting(?!\.notification))/i)}},1900:function(e,t,n){"use strict";var r=n(108),o=n(1538),i=n(1290);function a(){return 0==Object.keys(o.a.inlineImages).length}n.d(t,"d",(function(){return c})),n.d(t,"k",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"j",(function(){return d})),n.d(t,"i",(function(){return f})),n.d(t,"f",(function(){return p})),n.d(t,"e",(function(){return m})),n.d(t,"h",(function(){return g})),n.d(t,"g",(function(){return h})),n.d(t,"a",(function(){return i.a})),n.d(t,"b",(function(){return a}));var s=new r.c((function(){return Promise.all([n.e(4),n.e(346)]).then(n.bind(null,15019))})),c=new r.a(s,(function(e){return e.clearInlineImageStore})),u=new r.b(s,(function(e){return e.tryCreateDataURIFromImage})),l=new r.b(s,(function(e){return e.cacheInlineImage})),d=new r.b(s,(function(e){return e.logImageUpload})),f=new r.b(s,(function(e){return e.logImageLoadError})),p=new r.b(s,(function(e){return e.loadFromAttachmentServiceUrl})),m=new r.b(s,(function(e){return e.loadFromAttachment})),g=new r.b(s,(function(e){return e.loadFromProxy})),h=new r.b(s,(function(e){return e.loadFromImageTag}))},1907:function(e,t,n){"use strict";function r(e){return e&&!!e.setPluginUtils}n.d(t,"a",(function(){return r}))},1908:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return p}));var r=n(1766),o=n(1775),i=n(1616),a=n(964),s=n(246),c=n(1340),u=n(1030),l=n(114),d=1e3;function f(e,t){return Object(o.a)({FolderShape:Object(i.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(a.a)({FieldURI:"DistinguishedFolderId"}),Object(a.a)({FieldURI:"FolderClass"}),Object(a.a)({FieldURI:"FolderDisplayName"}),Object(a.a)({FieldURI:"ParentFolderId"}),Object(a.a)({FieldURI:"TotalCount"}),Object(a.a)({FieldURI:"UnreadCount"})]}),Paging:Object(u.a)({BasePoint:"Beginning",Offset:t,MaxEntriesReturned:d}),ParentFolderIds:e,ReturnParentFolder:!0,ShapeName:"Folder",Traversal:"Deep"})}function p(e,t,n,o){void 0===t&&(t=0),void 0===o&&(o=l.a.UserMailbox);var i=e,a=f([i],t),u=Object(c.a)(i.Id,null,n,o);return Object(r.a)({Header:Object(s.a)(),Body:a},u).then((function(e){return e.Body.ResponseMessages.Items[0]}))}},1910:function(e,t,n){"use strict";n.d(t,"b",(function(){return o}));var r=n(4),o=Object(r.createStore)("popoutParent",{projections:[]}),i=o();t.a=i},1920:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"Message:#Exchange"},e)}},1935:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1910);function o(e){var t;return null===(t=r.a.projections)||void 0===t?void 0:t.filter((function(t){return t.tabId==e||t.window==e}))[0]}},1938:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var r={};function o(e,t){var n,o=e.infoBarHostKey;return null===(n=r[o])||void 0===n?void 0:n[t]}},1956:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"CreateItemJsonRequest:#Exchange"},e)}},1957:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"CreateItemRequest:#Exchange"},e)}},1961:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(4),o=Object(r.action)("FETCH_ARCHIVE_DUMPSTER_FOLDER"),i=Object(r.action)("SET_REPLICA_LIST",(function(e,t){return{folderId:e,replicaList:t}})),a=Object(r.action)("ON_FIND_DUMPSTER_FOLDER_SUCCESS",(function(e,t,n){return{rootFolder:e,treeType:t,principalSMTPAddress:n}}))},2007:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1326),o=n(1836),i=n(76);function a(e){var t=[];return null==e||e.forEach((function(e){var n=Object(r.a)(e),a=function(e){switch(e){case 4:return 4;case 3:return 3;case 6:return 6;case 5:return 5;case 2:return 2;case 1:return 1;default:return 0}}(n.permissionLevel),s=Object(i.h)("cmp-fluidPreredeem")&&function(e){switch(e){case 4:case 3:case 6:case 5:return!0;default:return!1}}(a)&&Object(o.a)(n.fileName);if(1===a||2===a||s){var c={ProviderType:"OneDrivePro",Url:n.url,PermissionType:a};t.push(c)}})),t}},2021:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1085),o=n(2104);function i(){var e=Object(r.c)();switch(e.type){case r.a.SecondaryReadingPane:return e.data.id.Id;case r.a.Primary:default:return Object(o.a)()}}},2037:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"DeleteItemField:#Exchange"},e)}},2098:function(e,t,n){"use strict";var r=n(1879);n.d(t,"a",(function(){return r.a}))},2104:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1088),o=n(556);function i(){var e,t;return Object(o.v)()?null===(e=Object(r.b)().deeplinkId)||void 0===e?void 0:e.id:null===(t=Object(r.b)().primaryReadingPaneTabId)||void 0===t?void 0:t.Id}},211:function(e,t,n){"use strict";var r;!function(e){e[e.None=-1]="None",e[e.Red=0]="Red",e[e.Orange=1]="Orange",e[e.Peach=2]="Peach",e[e.YellowLight=3]="YellowLight",e[e.GreenLight=4]="GreenLight",e[e.TealLight=5]="TealLight",e[e.Olive=6]="Olive",e[e.BlueSky=7]="BlueSky",e[e.PurpleLight=8]="PurpleLight",e[e.Pink=9]="Pink",e[e.SteelLight=10]="SteelLight",e[e.SteelGrey=11]="SteelGrey",e[e.GreyLight=12]="GreyLight",e[e.GreyDark=13]="GreyDark",e[e.Black=14]="Black",e[e.RedDark=15]="RedDark",e[e.OrangeDark=16]="OrangeDark",e[e.BrownMedium=17]="BrownMedium",e[e.YellowDark=18]="YellowDark",e[e.GreenDark=19]="GreenDark",e[e.TealDark=20]="TealDark",e[e.OliveDark=21]="OliveDark",e[e.BlueDark=22]="BlueDark",e[e.PurpleDark=23]="PurpleDark",e[e.MagentaDark=24]="MagentaDark"}(r||(r={})),t.a=r},2114:function(e,t,n){"use strict";var r=n(24),o=n(4),i={sharingLinks:new r.ObservableMap({})},a=Object(o.createStore)("sharingLinkStore",i);t.a=a},2119:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(24),o=n(4),i={clpLabels:[],learnMoreUrl:"",hasMandatoryLabel:!1,rmsTemplates:new r.ObservableMap,messageClassifications:new r.ObservableMap},a=Object(o.createStore)("protection",i),s=a()},2129:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1090);function o(){var e=Object(r.a)().EnabledAddinCommands;return!!e&&e.isInitialized}},2130:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return l}));var r=n(0),o=n(1097),i=n(1090),a="User",s="Organization",c="Default";function u(e){var t=Object(i.a)().EnabledAddinCommands;return t?t.getExtensionPoint(o.a.TrapOnSendEvent).map((function(t){return t.AddinCommands.get(e.toString())})):[]}function l(e){var t=u(e),n=t.filter((function(e){return e.extension.OriginString==a})),o=t.filter((function(e){return e.extension.OriginString==c})),i=t.filter((function(e){return e.extension.OriginString==s}));return n.sort((function(e,t){return d(e,t)})),o.sort((function(e,t){return d(e,t)})),i.sort((function(e,t){return d(e,t)})),Object(r.__spread)(n,o,i)}function d(e,t){var n=e.get_Id(),r=t.get_Id();return n<r?-1:n>r?1:0}},2134:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1016),o=n(1008),i=0;function a(e,t){return{userIdentity:t,recipientWellId:"rw-"+ ++i,queryString:"",recipients:[],isDirty:!1,shouldShowContactPicker:!1,findResultSet:[],findResultType:o.b.None,isSearching:!1,directorySearchType:o.a.None,dropViewState:Object(r.a)(),findPeopleFeedbackManager:e,numberOfCacheResults:0}}},2135:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(4),o=Object(r.action)("ON_DELETE_CONVERSATION_ITEM_PARTS_COMPLETE"),i=Object(r.action)("TOGGLE_ROW_READ_STATE_COMPLETE")},2145:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),o=n(1464),i=n(1793);function a(e){var t=Object(i.a)(e);if(t)return t;var n=Object(o.b)(e);return Object(r.__assign)(Object(r.__assign)({},n),{isPendingResolution:!0,persona:{EmailAddress:e}})}},2195:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),o=n(2145),i=n(2134),a=n(24);function s(e,t,n,s){var c,u,l=Object(i.a)(e,n);if(s&&(l.recipients=Object(a.toJS)(s)),t)try{for(var d=Object(r.__values)(t),f=d.next();!f.done;f=d.next()){var p=f.value;l.recipients.push(Object(o.a)(p))}}catch(e){c={error:e}}finally{try{f&&!f.done&&(u=d.return)&&u.call(d)}finally{if(c)throw c.error}}return l}},2213:function(e,t,n){"use strict";var r=n(947),o=n(948);function i(){var e=Object(r.C)();return e&&0==e.tableQuery.type&&Object(o.G)(e.tableQuery.folderId)}function a(){var e=Object(r.C)();return e&&0==e.tableQuery.type&&Object(o.G)(e.tableQuery.folderId)?e.tableQuery.folderId:null}var s=n(4),c=n(114),u=n(1656),l=n(1423),d=n(24),f=Object(s.createStore)("publicFolderUtilsStore",new d.ObservableMap),p=n(103);function m(e){if(!f().has(e)){var t=l.a.folderTable.get(e),n=null!=t.ReplicaList?t.ReplicaList[0]:Object(p.i)().SessionSettings.DefaultPublicFolderMailbox,r={type:c.a.PublicMailbox,userIdentity:Object(c.e)().userIdentity,mailboxSmtpAddress:n,routingKey:Object(c.c)()+n,requestOptions:Object(u.a)(n)};g(e,r)}return f().get(e)}var g=Object(s.mutatorAction)("addPublicFolderMailboxInfoToStore",(function(e,t){f().set(e,t)}));n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return m}))},2233:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"ConversationRequestType:#Exchange"},e)}},2234:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"GetConversationItemsRequest:#Exchange"},e)}},2235:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(25),o=n(1737);function i(e,t){return void 0===e||e.__type||(e=Object(o.a)(e)),Object(r.a)("GetConversationItems",e,t)}},2264:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(103),o=n(76);function i(){if(Object(o.h)("outlookSpaces-enabled")){var e=Object(r.i)().SessionSettings;switch(null==e?void 0:e.WebSessionType){case 0:return!0;case 1:var t=!!(null==e?void 0:e.IsPremiumConsumerMailbox),n=Object(o.h)("outlookSpaces-free-consumer-enabled");return t||n;case 2:return Object(o.h)("outlookSpaces-gmail-enabled")}}return!1}},2268:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("updateInternetMessageId",(function(e,t,n){return{conversationId:e,itemId:t,internetMessageId:n}}))},230:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(434);function o(e,t){return void 0===t&&(t=!0),e&&(t&&Object(r.a)(e)||e.parentNode&&e.parentNode)}},2342:function(e,t,n){"use strict";var r=n(25),o=n(0);function i(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(o.__assign)({__type:"UpdateItemJsonRequest:#Exchange"},n)),Object(r.a)("UpdateItem",e,t)}n.d(t,"a",(function(){return i}))},235:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Unspecified=0]="Unspecified",e[e.String=1]="String",e[e.Int64=2]="Int64",e[e.Double=3]="Double",e[e.Boolean=4]="Boolean",e[e.Date=5]="Date"}(t.AWTPropertyType||(t.AWTPropertyType={})),function(e){e[e.NotSet=0]="NotSet",e[e.DistinguishedName=1]="DistinguishedName",e[e.GenericData=2]="GenericData",e[e.IPV4Address=3]="IPV4Address",e[e.IPv6Address=4]="IPv6Address",e[e.MailSubject=5]="MailSubject",e[e.PhoneNumber=6]="PhoneNumber",e[e.QueryString=7]="QueryString",e[e.SipAddress=8]="SipAddress",e[e.SmtpAddress=9]="SmtpAddress",e[e.Identity=10]="Identity",e[e.Uri=11]="Uri",e[e.Fqdn=12]="Fqdn",e[e.IPV4AddressLegacy=13]="IPV4AddressLegacy"}(t.AWTPiiKind||(t.AWTPiiKind={})),function(e){e[e.NotSet=0]="NotSet",e[e.GenericContent=1]="GenericContent"}(t.AWTCustomerContentKind||(t.AWTCustomerContentKind={})),function(e){e[e.Low=1]="Low",e[e.Normal=2]="Normal",e[e.High=3]="High",e[e.Immediate_sync=5]="Immediate_sync"}(t.AWTEventPriority||(t.AWTEventPriority={})),function(e){e[e.NonRetryableStatus=1]="NonRetryableStatus",e[e.QueueFull=3]="QueueFull",e[e.MaxRetryLimit=4]="MaxRetryLimit"}(t.AWTEventsDroppedReason||(t.AWTEventsDroppedReason={})),function(e){e[e.InvalidEvent=1]="InvalidEvent",e[e.SizeLimitExceeded=2]="SizeLimitExceeded",e[e.KillSwitch=3]="KillSwitch"}(t.AWTEventsRejectedReason||(t.AWTEventsRejectedReason={}))},2370:function(e){e.exports=JSON.parse('{"a":"A5b"}')},2379:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"UpdateItemRequest:#Exchange"},e)}},2398:function(e,t,n){"use strict";var r,o,i=n(0),a=32,s=126;function c(e){var t,n;if(!e)return!1;try{for(var r=Object(i.__values)(e),o=r.next();!o.done;o=r.next()){var c=o.value;if(null==c||0===c.trim().length)return!1;for(var u=c.length;u--;)if(c.charCodeAt(u)>s||c.charCodeAt(u)<a)return!1}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return!0}function u(e){return!!e&&c(Object.keys(e))}!function(e){e[e.Read=1]="Read",e[e.Create=2]="Create",e[e.DeleteOwn=4]="DeleteOwn",e[e.DeleteAll=8]="DeleteAll",e[e.EditOwn=16]="EditOwn",e[e.EditAll=32]="EditAll"}(r||(r={})),function(e){e.Base64="base64",e.Eml="eml",e.Url="url",e.Ical="iCalendar"}(o||(o={}));var l=n(1732),d=n(1733),f=n(1689),p=n(1731),m=function(e){var t={locationIdentifier:{}};return t.displayName=e.DisplayName,e.PostalAddress&&"Resource"===e.PostalAddress.LocationSource?(t.emailAddress=e.PostalAddress.LocationUri,t.locationIdentifier.id=t.emailAddress,t.locationIdentifier.type=l.a.Room):(t.emailAddress="",t.locationIdentifier.id=t.displayName,t.locationIdentifier.type=l.a.Custom),t};function g(e){var t,n;if(!e||e.length<=0)return!1;try{for(var r=Object(i.__values)(e),o=r.next();!o.done;o=r.next()){if(o.value.id.trim().length<=0)return!1}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return!0}n.d(t,"j",(function(){return c})),n.d(t,"i",(function(){return u})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return l.a})),n.d(t,"e",(function(){return d.a})),n.d(t,"f",(function(){return f.a})),n.d(t,"g",(function(){return f.b})),n.d(t,"b",(function(){return p.a})),n.d(t,"h",(function(){return m})),n.d(t,"k",(function(){return g}))},241:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,o=!1;function i(t){r--,delete e[t]}this.put=function(t,n,o,a){if(void 0!==o&&("number"!=typeof o||isNaN(o)||o<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==a&&"function"!=typeof a)throw new Error("Cache timeout callback must be a function");var s=e[t];s?clearTimeout(s.timeout):r++;var c={value:n,expire:o+Date.now()};return isNaN(c.expire)||(c.timeout=setTimeout(function(){i(t),a&&a(t,n)}.bind(this),o)),e[t]=c,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&i(t),n},this.clear=function(){for(var i in e)clearTimeout(e[i].timeout);r=0,e=Object.create(null),o&&(t=0,n=0)},this.get=function(i){var a=e[i];if(void 0!==a){if(isNaN(a.expire)||a.expire>=Date.now())return o&&t++,a.value;o&&n++,r--,delete e[i]}else o&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){o=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),o=Date.now(),i=n&&n.skipDuplicates;for(var a in r)if(r.hasOwnProperty(a)){if(i)if(e[a])continue;var s=r[a],c=s.expire-o;if(c<=0){this.del(a);continue}c=c>0?c:void 0,this.put(a,s.value,c)}return this.size()}}e.exports=new r,e.exports.Cache=r},2425:function(e,t,n){"use strict";var r=n(2),o=n(27),i=n(76);n(8468);var a=n(8469);OSF.getLocalizedStringsFilePath=function(){var e=Object(r.u)()+"resources/locale/osfruntime/",t=Object(o.a)().SessionSettings?Object(o.a)().SessionSettings.UserLanguage:"en";return e+(a[t]||"en-us")+"/jscript/"},OSF.getManifestHostType=function(){},OSF.AppTelemetry={get enableTelemetry(){return Object(i.h)("addin-oteljs")}}},2427:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),o=n(240),i=n(483),a=n(665);function s(e,t,n,s){var c="read/"+(Object(o.n)(e.mailboxInfo.userIdentity)?"account/"+encodeURIComponent(e.mailboxInfo.userIdentity)+"/":"")+encodeURIComponent(e.Id);Object(i.c)("calendar",c,Object(r.__assign)(Object(r.__assign)({},n),{entrySource:t}),a.a,!1,t)}},2463:function(e){e.exports=JSON.parse('{"a":"u5b","c":"v5b","d":"w5b","b":"x5b"}')},2464:function(e){e.exports=JSON.parse('{"a":"t5b"}')},2465:function(e){e.exports=JSON.parse('{"a":"s5b"}')},2466:function(e){e.exports=JSON.parse('{"a":"r5b"}')},2467:function(e){e.exports=JSON.parse('{"a":"q5b"}')},249:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(280),o=function(){function e(t){this._id=e._uniqueId++,this._parent=t,this._eventRecords=[]}return e.raise=function(t,n,o,i){var a;if(e._isElement(t)){if("undefined"!=typeof document&&document.createEvent){var s=document.createEvent("HTMLEvents");s.initEvent(n,i||!1,!0),Object(r.a)(s,o),a=t.dispatchEvent(s)}else if("undefined"!=typeof document&&document.createEventObject){var c=document.createEventObject(o);t.fireEvent("on"+n,c)}}else for(;t&&!1!==a;){var u=t.__events__,l=u?u[n]:null;if(l)for(var d in l)if(l.hasOwnProperty(d))for(var f=l[d],p=0;!1!==a&&p<f.length;p++){var m=f[p];m.objectCallback&&(a=m.objectCallback.call(m.parent,o))}t=i?t.parent:null}return a},e.isObserved=function(e,t){var n=e&&e.__events__;return!!n&&!!n[t]},e.isDeclared=function(e,t){var n=e&&e.__declaredEvents;return!!n&&!!n[t]},e.stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},e._isElement=function(e){return!!e&&(!!e.addEventListener||"undefined"!=typeof HTMLElement&&e instanceof HTMLElement)},e.prototype.dispose=function(){this._isDisposed||(this._isDisposed=!0,this.off(),this._parent=null)},e.prototype.onAll=function(e,t,n){for(var r in t)t.hasOwnProperty(r)&&this.on(e,r,t[r],n)},e.prototype.on=function(t,n,r,o){var i=this;if(n.indexOf(",")>-1)for(var a=n.split(/[ ,]+/),s=0;s<a.length;s++)this.on(t,a[s],r,o);else{var c=this._parent,u={target:t,eventName:n,parent:c,callback:r,options:o};if((a=t.__events__=t.__events__||{})[n]=a[n]||{count:0},a[n][this._id]=a[n][this._id]||[],a[n][this._id].push(u),a[n].count++,e._isElement(t)){var l=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!i._isDisposed){var n;try{if(!1===(n=r.apply(c,e))&&e[0]){var o=e[0];o.preventDefault&&o.preventDefault(),o.stopPropagation&&o.stopPropagation(),o.cancelBubble=!0}}catch(o){}return n}};u.elementCallback=l,t.addEventListener?t.addEventListener(n,l,o):t.attachEvent&&t.attachEvent("on"+n,l)}else{u.objectCallback=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!i._isDisposed)return r.apply(c,e)}}this._eventRecords.push(u)}},e.prototype.off=function(e,t,n,r){for(var o=0;o<this._eventRecords.length;o++){var i=this._eventRecords[o];if(!(e&&e!==i.target||t&&t!==i.eventName||n&&n!==i.callback||"boolean"==typeof r&&r!==i.options)){var a=i.target.__events__,s=a[i.eventName],c=s?s[this._id]:null;c&&(1!==c.length&&n?(s.count--,c.splice(c.indexOf(i),1)):(s.count-=c.length,delete a[i.eventName][this._id]),s.count||delete a[i.eventName]),i.elementCallback&&(i.target.removeEventListener?i.target.removeEventListener(i.eventName,i.elementCallback,i.options):i.target.detachEvent&&i.target.detachEvent("on"+i.eventName,i.elementCallback)),this._eventRecords.splice(o--,1)}}},e.prototype.raise=function(t,n,r){return e.raise(this._parent,t,n,r)},e.prototype.declare=function(e){var t=this._parent.__declaredEvents=this._parent.__declaredEvents||{};if("string"==typeof e)t[e]=!0;else for(var n=0;n<e.length;n++)t[e[n]]=!0},e._uniqueId=0,e}()},252:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(230);function o(e,t,n){void 0===n&&(n=!0);var o=!1;if(e&&t)if(n)for(o=!1;t;){var i=Object(r.a)(t);if(i===e){o=!0;break}t=i}else e.contains&&(o=e.contains(t));return o}},255:function(e,t,n){"use strict";n.r(t),n.d(t,"ResponsiveMode",(function(){return r})),n.d(t,"setResponsiveMode",(function(){return m})),n.d(t,"initializeResponsiveMode",(function(){return g})),n.d(t,"withResponsiveMode",(function(){return h}));var r,o=n(0),i=n(1),a=n(244),s=n(436),c=n(104),u=n(249),l=n(386);!function(e){e[e.small=0]="small",e[e.medium=1]="medium",e[e.large=2]="large",e[e.xLarge=3]="xLarge",e[e.xxLarge=4]="xxLarge",e[e.xxxLarge=5]="xxxLarge",e[e.unknown=999]="unknown"}(r||(r={}));var d,f,p=[479,639,1023,1365,1919,99999999];function m(e){d=e}function g(e){"undefined"!=typeof window&&v(e&&Object(c.a)(e)||window)}function h(e){var t=function(t){function n(e){var n=t.call(this,e)||this;return n._onResize=function(){var e=Object(a.findDOMNode)(n),t=v(e&&Object(c.a)(e)||window);t!==n.state.responsiveMode&&n.setState({responsiveMode:t})},n._events=new u.a(n),n._updateComposedComponentRef=n._updateComposedComponentRef.bind(n),n.state={responsiveMode:d||f||r.large},n}return Object(o.__extends)(n,t),n.prototype.componentDidMount=function(){this._events.on(window,"resize",this._onResize),this._onResize()},n.prototype.componentWillUnmount=function(){this._events.dispose()},n.prototype.render=function(){var t=this.state.responsiveMode;return t===r.unknown?null:i.createElement(e,Object(o.__assign)({ref:this._updateComposedComponentRef,responsiveMode:t},this.props))},n}(s.a);return Object(l.a)(e,t)}function v(e){var t=r.small;if(e){try{for(;e.innerWidth>p[t];)t++}catch(e){t=d||f||r.large}f=t}else{if(void 0===d)throw new Error("Content was rendered in a server environment without providing a default responsive mode. Call setResponsiveMode to define what the responsive mode is.");t=d}return t}},2601:function(e){e.exports=JSON.parse('{"a":"CFa"}')},2659:function(e){e.exports=JSON.parse('{"a":"kFa","c":"lFa","e":"mFa","b":"nFa","d":"oFa"}')},2661:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Item=0]="Item",e[e.Oof=1]="Oof",e[e.FossilizedText=2]="FossilizedText",e[e.GlobalReply=3]="GlobalReply",e[e.SeeMore=4]="SeeMore"}(r||(r={}))},2666:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"f",(function(){return a})),n.d(t,"i",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return d}));var r="cid:",o="Upload",i="InsertInlineImageFinished",a="InsertInlineImagePlaceholder",s="data-loadPending",c="pastedImage",u=".png",l="Attachment",d={position:3,updateCursor:!0,replaceSelection:!0,insertOnNewLine:!1}},267:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return l}));var r=n(104),o=n(168),i="__currentId__",a="id__",s=Object(r.a)()||{};void 0===s[i]&&(s[i]=0);var c=!1;function u(e){if(!c){var t=o.b.getInstance();t&&t.onReset&&t.onReset(l),c=!0}var n=s[i]++;return(e||a)+n}function l(e){void 0===e&&(e=0),s[i]=e}},2678:function(e,t,n){"use strict";n.d(t,"c",(function(){return _})),n.d(t,"e",(function(){return C})),n.d(t,"f",(function(){return O})),n.d(t,"d",(function(){return A})),n.d(t,"a",(function(){return I}));var r=n(0),o=n(1401),i=n(1579),a=n(4585),s=n(3816),c=n(5877),u=n(6330),l=n(6492),d=n(3646),f=n(4399),p=n(27),m=n(123),g=n(3101),h=n(2839),v=n(76),y={};function b(e){var t=y[e.composeId];return t||(t={activeSaveAction:null,hasPendingSaveAction:!1},y[e.composeId]=t),t}function _(e){var t=y[e.composeId];return t&&!!t.activeSaveAction}function S(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return(t=b(e)).activeSaveAction?[3,1]:[2,Promise.resolve(!0)];case 1:return t.hasPendingSaveAction?[4,t.activeSaveAction]:[3,3];case 2:return n.sent(),[2,Promise.resolve(!1)];case 3:return t.hasPendingSaveAction=!0,[4,t.activeSaveAction];case 4:return n.sent(),t.hasPendingSaveAction=!1,[2,Promise.resolve(!0)]}}))}))}function C(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(n=b(e)).activeSaveAction=t,[4,t.then((function(e){return n.activeSaveAction=null,Promise.resolve(e)})).catch((function(e){return n.activeSaveAction=null,Promise.reject(e)}))];case 1:return r.sent(),[2]}}))}))}function O(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return(null==(t=y[e.composeId])?void 0:t.activeSaveAction)?[4,t.activeSaveAction]:[3,2];case 1:return n.sent(),[2,Promise.resolve(!0)];case 2:return[2,Promise.resolve(!1)]}}))}))}function A(e){var t=y[e.composeId];return t&&!!t.activeSaveAction}function I(e){y[e.composeId]&&delete y[e.composeId]}t.b=Object(m.d)("trySaveMessage",s.b.MailComposeSave)((function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,S(e)];case 1:return r.sent()?e?e.isSending||A(e)?[2,Promise.resolve()]:(t||(Object(i.a)(e,c.a),e.isManuallySaved=!0),function(e){return Object(d.a)(e)<=Object(p.a)().MaxRecipientsPerMessage}(e)?[2,C(e,Object(l.b)(e).then((function(n){return e.isSending||(Object(l.a)(n,e),Object(f.a)()&&Object(a.a)(e,t?2:4),Object(g.a)()&&Object(v.h)("cmp-clp-auto-labeling")&&h.g.import().then((function(t){t(e,e.protectionViewState.clpViewState,e.itemId,e.content)}))),Promise.resolve()})).catch((function(r){if(!t&&!e.isSending){var i=Object(u.a)(r?r.message:null,!1);Object(o.a)(e,i)}return n&&!e.isSending?Promise.reject(r):Promise.resolve()})))]:(t||Object(o.a)(e,"warningMessageMaxRecipientsExceed"),[2,Promise.resolve()])):[2,Promise.reject("could not save message if view state does not exist")]:[2,Promise.resolve()]}}))}))}))},268:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.smallFluid=0]="smallFluid",e[e.smallFixedFar=1]="smallFixedFar",e[e.smallFixedNear=2]="smallFixedNear",e[e.medium=3]="medium",e[e.large=4]="large",e[e.largeFixed=5]="largeFixed",e[e.extraLarge=6]="extraLarge",e[e.custom=7]="custom",e[e.customNear=8]="customNear"}(r||(r={}))},2686:function(e,t,n){"use strict";var r=n(378),o=n(1734),i={flexShrink:0,display:"inherit"};n.d(t,"a",(function(){return a}));var a=Object(r.a)(o.a,(function(e){var t=e.className;return{root:["ms-OverflowSet",{position:"relative",display:"flex",flexWrap:"nowrap"},e.vertical&&{flexDirection:"column"},t],item:["ms-OverflowSet-item",i],overflowButton:["ms-OverflowSet-overflowButton",i]}}),void 0,{scope:"OverflowSet"})},2689:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(108),o=new r.c((function(){return n.e(121).then(n.bind(null,4765))})),i=new r.a(o,(function(e){return e.getTypeOfAttachment})),a=new r.a(o,(function(e){return e.getAllAttachments})),s=new r.a(o,(function(e){return e.getAttachmentContentHelper}))},2700:function(e){e.exports=JSON.parse('{"a":"jFa"}')},2702:function(e,t,n){"use strict";n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"e",(function(){return m})),n.d(t,"f",(function(){return g}));var r,o,i=n(3074),a=n(109),s=n(1013),c=n(103),u=n(76);n(2425);function l(){return r}function d(){void 0===r&&(r="Store"+OSF.OUtil.generateConversationId());var e=Object(s.s)(),t=r+"|"+window.location.href.split("?")[0],n=OSF.OUtil.addXdmInfoAsHash(e.InClientStoreUrl,t);n=i.a(n,"client","WAC_Outlook");var a=Date.now();return n=i.a(n,"cv","16.2130.0.9999"),n=i.a(n,"ui",Object(c.k)()),n=i.a(n,"rs",Object(c.k)()),n=i.a(n,"timestamp",a.toString()),n=i.a(n,"ep",function(){if(o)return"il";return"ma"}()),n=i.a(n,"exchver",i.c()),n=i.a(n,"privateenabled",e.CustomExtensionsEnabled.toString()),n=i.a(n,"cb",i.d()),n=i.a(n,"ClientSessionId",i.e()),n=i.a(n,"userPuid","0"),n=Object(u.h)("cal-addins")?i.a(n,"gates","Marketplace.Outlook.Pin.Addin.Options,Marketplace.Outlook.Pin.Addin.Calendar.Options"):i.a(n,"gates","Marketplace.Outlook.Pin.Addin.Options")}function f(){var e=OSF.OUtil.getUniqueId();return Microsoft.Office.Common.XdmCommunicationManager.createServiceEndPoint(e)}function p(){var e=Object(a.a)();return e.headers.append("X-EWS-TargetVersion","2.80"),delete e.credentials,e}function m(e){return"string"==typeof e?e:["notresponded","notconsented","consented"][e]}var g=function(e){o=e}},2767:function(e){e.exports=JSON.parse('{"a":"qFa"}')},2768:function(e){e.exports=JSON.parse('{"a":"rFa"}')},2788:function(e,t,n){"use strict";var r=n(283),o=n(3385);t.a=Object(r.action)("updateContent")((function(e,t,n){e.content!=t&&(e.content=t,n||Object(o.a)(e,!0))}))},279:function(e,t,n){"use strict";var r=n(560);n.d(t,"a",(function(){return r.a}))},2826:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"GetClientAccessTokenRequest:#Exchange"},e)}},2837:function(e){e.exports=JSON.parse('{"a":"vFa"}')},2839:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"f",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"h",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"g",(function(){return l})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return f}));var r=n(108),o=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(482)]).then(n.bind(null,5135))})),i=new r.a(o,(function(e){return e.loadCLPUserLabels})),a=new r.b(o,(function(e){return e.showJustificationModal})),s=new r.a(o,(function(e){return e.loadItemCLPInfo})),c=new r.b(o,(function(e){return e.updateItemCLPInfo})),u=new r.b(o,(function(e){return e.logReadCLPLabel})),l=new r.b(o,(function(e){return e.triggerCLPAutoLabeling})),d=Object(r.d)(o,(function(e){return e.CLPSubjectHeaderLabel})),f=Object(r.d)(o,(function(e){return e.CLPMandatoryLabelModal}))},287:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"f",(function(){return l}));var r=n(108),o=(n(481),new r.c((function(){return Promise.all([n.e(28),n.e(4),n.e(460)]).then(n.bind(null,901))}))),i=(new r.a(o,(function(e){return e.makeOwsPrimeRequest})).importAndExecute,new r.a(o,(function(e){return e.makePostRequest})).importAndExecute),a=new r.a(o,(function(e){return e.makePatchRequest})).importAndExecute,s=new r.a(o,(function(e){return e.makePutRequest})).importAndExecute,c=new r.a(o,(function(e){return e.makeGetRequest})).importAndExecute,u=new r.a(o,(function(e){return e.makeDeleteRequest})).importAndExecute,l=new r.a(o,(function(e){return e.sendOwsPrimeRequest})).importAndExecute},2905:function(e,t,n){"use strict";var r=n(25),o=n(0);function i(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(o.__assign)({__type:"GetClientAccessTokenJsonRequest:#Exchange"},n)),Object(r.a)("GetClientAccessToken",e,t)}n.d(t,"a",(function(){return i}))},2914:function(e,t,n){"use strict";var r=n(1609),o=n(4),i=Object(o.action)("setAppPaneUnderlayVisibility",(function(e,t,n,r){return{key:e,isShown:t,shrinkable:n,underlayViewState:r}}));Object(o.mutator)(i,(function(e){var t=e.underlayViewState||Object(r.a)();e.isShown?t.shrinkable.set(e.key,e.shrinkable):t.shrinkable.delete(e.key),t.isShown.set(e.key,e.isShown)})),t.a=i},2961:function(e){e.exports=JSON.parse('{"a":"BFa"}')},2977:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return c}));var r=n(0),o=n(1090);function i(e){return Object(o.a)().taskPanes.get(e)}function a(e){return function(e){var t,n,i=Object(o.a)();try{for(var a=Object(r.__values)(i.taskPanes.values()),s=a.next();!s.done;s=a.next()){var c=s.value;if(e(c))return c}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return null}((function(t){return t.controlId===e}))}function s(e){var t,n;try{for(var o=Object(r.__values)(["Persistent","NonPersistent"]),a=o.next();!a.done;a=o.next()){var s=a.value,c=i(s);if(c&&c.controlId===e)return s}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return null}function c(e){return"Persistent"===e?"NonPersistent":"Persistent"}},2996:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1806),o=n(2788);function i(e){Object(r.b)(e,(function(t){Object(o.a)(e,t.getContent(!0))}),(function(t){Object(o.a)(e,t.value)}))}},3028:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s}));var r="X-OWA-SmimeInstalled",o="1",i="SmimeWithoutActiveX",a="message/rfc822",s="ErrorSmimeSendCancelled"},3040:function(e,t,n){"use strict";function r(e,t){var n,r;e&&e((n=t.EventResponseCode,(r={}).Error=n,r))}function o(e,t){(function(e){return void 0!==e.invokeHandlerIfPreviousOnTriggerFailed})(e)&&e.invokeHandlerIfPreviousOnTriggerFailed(t)}var i;!function(e){e[e.SUCCESS=0]="SUCCESS",e[e.API_CALL_NOT_SUPPORTED_BY_EXTENSIONPOINT=9032]="API_CALL_NOT_SUPPORTED_BY_EXTENSIONPOINT",e[e.INTERNAL_ERROR=5001]="INTERNAL_ERROR",e[e.URL_NOT_IN_APP_DOMAINS=12004]="URL_NOT_IN_APP_DOMAINS",e[e.WEB_DIALOG_CLOSED=12006]="WEB_DIALOG_CLOSED",e[e.DIALOG_ALREADY_OPEN=12007]="DIALOG_ALREADY_OPEN"}(i||(i={}));var a=i,s="DialogApiEventError",c="ApiEventError";function u(e,t,n){return{EventResponseCode:e,ErrorClassification:t,ErrorDetails:n}}function l(){return u(a.SUCCESS)}function d(e){return e.EventResponseCode===a.SUCCESS}function f(e,t){return l()}function p(e){return l()}function m(e,t){return l()}function g(e){return e}function h(e){return[JSON.stringify(e)]}var v={};function y(e,t){var n;return(null===(n=v[e])||void 0===n?void 0:n[t])?v[e][t]:null}function b(e){delete v[e]}function _(e,t){return!!y(e,t)}var S=n(254),C=n(1013),O=n(2);function A(e,t,n,o,i){var s=U(e),f=s.onTrigger(n,t);if(d(f)&&(f=function(e,t,n,r){var o=y(e,t);if(!o)return u(a.INTERNAL_ERROR,c,"HandlerNotRegistered");var i=n.formatArgsForHandler(r);return o(i),l()}(t,e,s,n)),r(o,f),i){var p=Object(C.n)(t),m=f.EventResponseCode;Object(S.o)("ExecuteEvent",{dispId:e,Id:p.extension.Id,DisplayName:p.extension.DisplayName,owa_1:Object(O.e)(),owa_2:Object(C.z)(i),extPoint:Object(C.r)(t),owa_4:p.extension.Type,EventResponseCode:m})}}var I,x=n(428);function E(e,t){if(Object(C.H)())return u(a.DIALOG_ALREADY_OPEN,s,a[a.DIALOG_ALREADY_OPEN]);if(!function(e,t){if(t&&1==t.displayInIframe){return function(e,t){return Microsoft.Office.Common.XdmCommunicationManager.checkUrlWithAppDomains(e,t)}(Object(C.n)(e).extension.AppDomains,t.url)}return!0}(e,t))return u(a.URL_NOT_IN_APP_DOMAINS,s,a[a.URL_NOT_IN_APP_DOMAINS]);var n=function(e,t,n){var r=Object(C.w)(e);return t&&1==t.displayInIframe?{controlId:Object(x.a)(),dialogType:1,url:t.url,heightInPercentage:t.height,widthInPercentage:t.width,parentControlId:e,isOpen:n,hostItemIndex:r}:Object(C.O)(e)?{controlId:Object(x.a)(),dialogType:2,parentControlId:e,isOpen:n,hostItemIndex:r}:null}(e,t,!0);return Object(C.Q)(n),l()}function T(e){return Object(C.Q)(null),A(I.DISPLAY_DIALOG_DISPID,e,null),l()}function P(e,t){return l()}function w(e){return function(e){return null!=e&&void 0!==e.messageToParent}(e)?function(e){var t=e.messageToParent;return{messageType:"0",messageContent:t}}(e):{messageType:a.WEB_DIALOG_CLOSED}}!function(e){e[e.DISPLAY_DIALOG_DISPID=10]="DISPLAY_DIALOG_DISPID",e[e.DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID=11]="DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID",e[e.ITEM_CHANGED_EVENT_DISPID=46]="ITEM_CHANGED_EVENT_DISPID",e[e.RECIPIENTS_CHANGED_EVENT_DISPID=47]="RECIPIENTS_CHANGED_EVENT_DISPID",e[e.APPOINTMENT_TIME_CHANGED_EVENT_DISPID=48]="APPOINTMENT_TIME_CHANGED_EVENT_DISPID",e[e.RECURRENCE_CHANGED_EVENT=49]="RECURRENCE_CHANGED_EVENT",e[e.ATTACHMENTS_CHANGED_EVENT_DISPID=50]="ATTACHMENTS_CHANGED_EVENT_DISPID",e[e.LOCATIONS_CHANGED_EVENT=51]="LOCATIONS_CHANGED_EVENT"}(I||(I={}));var M=!1,R=null;function j(e,t){return function(e,t){_(t,I.ITEM_CHANGED_EVENT_DISPID)||(M=!0,R={controlId:t,args:e},Object(S.o)("ExtTriggerUnregisteredItemChangedEvent"))}(e,t),l()}function k(e){M&&R.controlId===e&&A(I.ITEM_CHANGED_EVENT_DISPID,e,R.args),M=!1,R=null}function N(e){return[JSON.stringify(e)]}function D(e){return[JSON.stringify(e)]}function F(e){var t={recurrence:JSON.stringify(e.recurrence)};return[JSON.stringify(t)]}function L(e){return[JSON.stringify(e)]}function U(e){switch(e){case I.DISPLAY_DIALOG_DISPID:case I.DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID:return{register:E,unregister:T,onTrigger:P,formatArgsForHandler:w};case I.ITEM_CHANGED_EVENT_DISPID:return{register:f,unregister:p,onTrigger:j,formatArgsForHandler:g,invokeHandlerIfPreviousOnTriggerFailed:k};case I.APPOINTMENT_TIME_CHANGED_EVENT_DISPID:return{register:f,unregister:p,onTrigger:m,formatArgsForHandler:h};case I.RECIPIENTS_CHANGED_EVENT_DISPID:return{register:f,unregister:p,onTrigger:m,formatArgsForHandler:D};case I.RECURRENCE_CHANGED_EVENT:return{register:f,unregister:p,onTrigger:m,formatArgsForHandler:F};case I.LOCATIONS_CHANGED_EVENT:return{register:f,unregister:p,onTrigger:m,formatArgsForHandler:N};case I.ATTACHMENTS_CHANGED_EVENT_DISPID:return{register:f,unregister:p,onTrigger:m,formatArgsForHandler:L};default:throw new Error("ApiEvent not implemented")}}var B=n(76),H=[I.DISPLAY_DIALOG_DISPID];function W(e,t,n){var i,s,c,f,p,m=(i=t.controlId,s=t.eventDispId,c=Object(C.n)(i),f=Object(C.J)(c),p=H.includes(s),!(!f||!p));if(Object(B.h)("addin-autoRun")&&m)return Object(S.o)("ExtRegisterApiEventNotSupportedInAutorun",[t.eventDispId]),void r(n,u(a.API_CALL_NOT_SUPPORTED_BY_EXTENSIONPOINT));if(Object(C.O)(t.controlId)&&function(e){switch(e){case I.DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID:case I.DISPLAY_DIALOG_DISPID:return!1;case I.APPOINTMENT_TIME_CHANGED_EVENT_DISPID:case I.ITEM_CHANGED_EVENT_DISPID:case I.RECIPIENTS_CHANGED_EVENT_DISPID:case I.RECURRENCE_CHANGED_EVENT:case I.LOCATIONS_CHANGED_EVENT:case I.ATTACHMENTS_CHANGED_EVENT_DISPID:return!0}}(t.eventDispId))r(n,l());else{var g=function(e){return e.targetId?JSON.parse(e.targetId):null}(t),h=U(t.eventDispId),y=h.register(t.controlId,g);d(y)&&(y=function(e,t,n){return function(e,t,n){v[e]||(v[e]={}),v[e][t]=n}(e,t,n),l()}(t.controlId,t.eventDispId,e)),r(n,y),o(h,t.controlId)}}function V(e,t){var n=U(e.eventDispId).unregister(e.controlId);d(n)&&(n=function(e,t){if(!_(e,t))return u(a.INTERNAL_ERROR,c,"ControlNotRegistered");return function(e,t){var n;(null===(n=v[e])||void 0===n?void 0:n[t])&&delete v[e][t]}(e,t),l()}(e.controlId,e.eventDispId)),r(t,n)}function z(e,t,n){var r=Object(C.o)(e),o=!1,i=null;r.forEach((function(r){_(r,t)&&(o||(o=!0,i=n()),A(t,r,i,null,e))}))}var G=n(1046),q=n(1097);function K(e){var t=Object(C.q)(e),n=Object(G.c)(t);if(null!=n&&n.mode===q.a.AppointmentOrganizer){var r=n;z(t,I.APPOINTMENT_TIME_CHANGED_EVENT_DISPID,(function(){return{start:r.getStartTime(),end:r.getEndTime()}}))}}var X=n(314),J=n(2398);function Q(e,t,n){var r=Object(C.q)(e),o=Object(G.c)(r);if(null!=o&&(o.mode===q.a.AppointmentOrganizer||o.mode===q.a.MessageCompose)){var i=null;switch(t){case J.b.Added:i="added";break;case J.b.Deleted:i="removed";break;default:Object(X.a)(t)}var a={attachmentStatus:i,attachmentDetails:n};z(r,I.ATTACHMENTS_CHANGED_EVENT_DISPID,(function(){return a}))}}function Z(e,t){var n=Object(C.q)(e),r=Object(G.c)(n);if(null!=r&&(r.mode===q.a.AppointmentOrganizer||r.mode===q.a.MessageCompose)){var o=null;if(r.mode==q.a.MessageCompose)switch(o={to:!1,cc:!1,bcc:!1},t){case J.e.To:o.to=!0;break;case J.e.Cc:o.cc=!0;break;case J.e.Bcc:o.bcc=!0}else if(r.mode===q.a.AppointmentOrganizer)switch(o={requiredAttendees:!1,optionalAttendees:!1,resources:!1},t){case J.e.RequiredAttendees:o.requiredAttendees=!0;break;case J.e.OptionalAttendees:o.optionalAttendees=!0;break;case J.e.Resources:o.resources=!0}z(n,I.RECIPIENTS_CHANGED_EVENT_DISPID,(function(){return o}))}}var Y=n(4569);function $(e,t){var n=Object(C.q)(e),r=Object(G.c)(n);if(null!=r&&r.mode===q.a.AppointmentOrganizer){var o=Object(Y.a)({recurrenceType:t,startTime:r.getStartTime(),endTime:r.getEndTime(),timeZone:r.getTimeZone()});z(n,I.RECURRENCE_CHANGED_EVENT,(function(){return{recurrence:o}}))}}function ee(e,t){var n=Object(C.q)(e),r=Object(G.c)(n);if(null!=r&&r.mode===q.a.AppointmentOrganizer){var o=t.map(J.h);z(n,I.LOCATIONS_CHANGED_EVENT,(function(){return{enhancedLocations:o}}))}}n.d(t,"c",(function(){return W})),n.d(t,"j",(function(){return V})),n.d(t,"d",(function(){return A})),n.d(t,"b",(function(){return b})),n.d(t,"e",(function(){return K})),n.d(t,"f",(function(){return Q})),n.d(t,"h",(function(){return Z})),n.d(t,"i",(function(){return $})),n.d(t,"g",(function(){return ee})),n.d(t,"a",(function(){return I}))},3074:function(e,t,n){"use strict";n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return p})),n.d(t,"b",(function(){return m})),n.d(t,"g",(function(){return g}));var r,o=n(428),i=n(27),a=n(1013),s=n(5216),c=n(2);function u(){return"x"}function l(e,t,n){if(!e||!t||!n)throw new Error("Key and Value parameters should not be null");var r=e.split("#"),o=1==r.length?"":e.substr(e.indexOf("#"));return e=e.indexOf("?")>0?r[0]+"&"+t+"="+n+o:r[0]+"?"+t+"="+n+o}function d(){return Object(c.z)()}function f(){return null==r&&(r=Object(o.a)()),r}function p(){return Object(i.a)().UserOptions.TimeZone}function m(e){var t=encodeURIComponent(e),n=unescape(t);return btoa(n)}function g(){Object(a.V)(!0),Object(s.a)()}n(288)},309:function(e,t,n){"use strict";var r=n(211);var o=n(4),i=n(24);n.d(t,"b",(function(){return c}));var a,s={categoryIdToNameMap:{},categoryMenuViewState:{findText:"",isFocusInSearchBox:!1,shouldShowAllCategories:!1},categoryColorPickerViewState:{colorPickerTarget:null,shouldShowColorPicker:!1},colorCodeColorValueMap:((a={})[r.a.None]={primaryColor:"#CCCCCC",secondaryColor:"#A6A6A6",iconColor:"#000000",textColor:"#000000"},a[r.a.Red]={primaryColor:"#fce9ea",secondaryColor:"#F1919A",iconColor:"#E74856",textColor:"#D01B2A"},a[r.a.Orange]={primaryColor:"#fff1e0",secondaryColor:"#ffba66",iconColor:"#FF8C00",textColor:"#A35A00"},a[r.a.Peach]={primaryColor:"#fff5e8",secondaryColor:"#ffcd8f",iconColor:"#FFAB45",textColor:"#A35A00"},a[r.a.YellowLight]={primaryColor:"#fffde0",secondaryColor:"#fff766",iconColor:"#FFF100",textColor:"#7A7400"},a[r.a.GreenLight]={primaryColor:"#e9f9e8",secondaryColor:"#91e38d",iconColor:"#47D041",textColor:"#257E20"},a[r.a.TealLight]={primaryColor:"#e6f8f9",secondaryColor:"#83dde0",iconColor:"#30C6CC",textColor:"#1D797C"},a[r.a.Olive]={primaryColor:"#EEF5E4",secondaryColor:"#abcc7c",iconColor:"#73AA24",textColor:"#527A1A"},a[r.a.BlueSky]={primaryColor:"#e0f7fd",secondaryColor:"#66d7f7",iconColor:"#00BCF2",textColor:"#007899"},a[r.a.PurpleLight]={primaryColor:"#f0ecf6",secondaryColor:"#b7a2d4",iconColor:"#8764B8",textColor:"#7D57B2"},a[r.a.Pink]={primaryColor:"#fef2f7",secondaryColor:"#f8bfd9",iconColor:"#F495BF",textColor:"#D8186E"},a[r.a.SteelLight]={primaryColor:"#f3f5f6",secondaryColor:"#c6ced1",iconColor:"#A0AEB2",textColor:"#5E7373"},a[r.a.SteelGrey]={primaryColor:"#D0E0E2",secondaryColor:"#6693a0",iconColor:"#004B60",textColor:"#004B60"},a[r.a.GreyLight]={primaryColor:"#f6f5f5",secondaryColor:"#d0cecd",iconColor:"#B1ADAB",textColor:"#776E6E"},a[r.a.GreyDark]={primaryColor:"#D4D4D4",secondaryColor:"#9e9c9b",iconColor:"#5D5A58",textColor:"#5D5A58"},a[r.a.Black]={primaryColor:"#969696",secondaryColor:"#666666",iconColor:"#000000",textColor:"#000000"},a[r.a.RedDark]={primaryColor:"#C09BA4",secondaryColor:"#ac6d77",iconColor:"#750B1C",textColor:"#750B1C"},a[r.a.OrangeDark]={primaryColor:"#f9eae2",secondaryColor:"#df9670",iconColor:"#CA5010",textColor:"#B3480F"},a[r.a.BrownMedium]={primaryColor:"#f5ece2",secondaryColor:"#cda16e",iconColor:"#AB620D",textColor:"#9D590B"},a[r.a.YellowDark]={primaryColor:"#f7f3e0",secondaryColor:"#dac466",iconColor:"#C19C00",textColor:"#856A00"},a[r.a.GreenDark]={primaryColor:"#C8DACC",secondaryColor:"#669377",iconColor:"#004B1C",textColor:"#004B1C"},a[r.a.TealDark]={primaryColor:"#CEDCDE",secondaryColor:"#669396",iconColor:"#004B50",textColor:"#004B50"},a[r.a.OliveDark]={primaryColor:"#C3DAC3",secondaryColor:"#6da66d",iconColor:"#0B6A0B",textColor:"#0b6a0b"},a[r.a.BlueDark]={primaryColor:"#A6ACC4",secondaryColor:"#667996",iconColor:"#002050",textColor:"#002050"},a[r.a.PurpleDark]={primaryColor:"#B5ACC8",secondaryColor:"#84729c",iconColor:"#32145A",textColor:"#32145A"},a[r.a.MagentaDark]={primaryColor:"#D1B8D1",secondaryColor:"#9d669d",iconColor:"#5C005C",textColor:"#5C005C"},a),pendingCategoryNamesMap:{},categoryDetails:new i.ObservableMap({}),isSearchFolderReady:!1,categoryDialogViewState:null,isApplyingCategoryOperation:!1},c=Object(o.createStore)("category",s);t.a=c()},3099:function(e,t,n){"use strict";t.a=function(e){if(e){var t=e.shouldEncryptMessageAsSmime,n=e.shouldSignMessageAsSmime;return t||n}return!1}},3100:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r=n(6329),o=function(e){return[e.toRecipientWell,e.ccRecipientWell,e.bccRecipientWell]},i=function(e){var t=o(e);return Object(r.a)(t).map((function(e){return e.persona.EmailAddress.EmailAddress}))},a=function(e){var t=o(e);return Object(r.a)(t).map((function(e){return e.persona.EmailAddress}))}},3101:function(e,t,n){"use strict";var r=n(76),o=n(2119),i=n(295);t.a=function(){var e=o.b.clpLabels;return Object(r.h)("cmp-clp")&&e.length>0&&e.some((function(e){return e.isLabelEnabled}))&&!Object(i.a)()}},3112:function(e,t,n){"use strict";var r=n(108),o=n(5208);function i(e){return o.a.addinOptionSurfaceItems[e]}var a=n(9),s=n(4215),c=n(4817),u=n(3900),l=n(3901),d=n(5209),f=n(4818),p=n(3139),m=n(2601),g=n(2961),h=n(5210),v=n(3916),y=n(5211),b=n(4819),_=n(4820),S=n(2837),C=n(4821),O=n(4822),A=n(3917),I=n(2768),x=n(2767),E=n(4034),T=n(2659),P=n(2700),w=n(4033),M=n(4049),R=n(4050),j=n(5212),k=n(4823),N=n(5213),D=n(4824),F=n(4194),L=n(5214),U=n(4825),B=n(295),H=n(5616);function W(e){switch(e){case"AddAttachment":return Object(a.b)(d.a);case"AddInlineImage":return Object(a.b)(v.a);case"AddEmoji":return Object(a.b)(H.c);case"QuickUse":return Object(a.b)(H.p);case"ToggleRibbon":return Object(a.b)(h.a);case"SaveDraft":return Object(a.b)(j.a);case"InsertSignature":return Object(a.b)(y.a);case"ShowFrom":return Object(a.b)(D.a);case"SetImportance":return Object(a.b)(N.a);case"ShowMessageOptions":return Object(a.b)(L.a);case"SwitchBodyType":return Object(a.b)(U.a);case"SensitivityMenu":return Object(a.b)(k.a);case"ProtectMessage":return Object(a.b)(f.a);case"AccChecker":return Object(a.b)(s.a);case"ToggleDarkCompose":return Object(a.b)(H.v);case"ToggleDictation":return Object(a.b)(H.w);case"SetDictationLanguage":return Object(a.b)(H.t);case"ProofingOptions":return Object(a.b)(H.o);case"FluidHeroButton":return Object(a.b)(H.b);default:return""}}function V(e){switch(e){case"LikeUnlike":return Object(a.b)(H.f);case"Reply":return Object(a.b)(I.a);case"ReplyAll":return Object(a.b)(x.a);case"Forward":return Object(a.b)(S.a);case"ReplyByMeeting":return Object(a.b)(H.h);case"ReportAbuse":return Object(a.b)(R.a);case"Popout":return Object(a.b)(M.a);case"Delete":return Object(a.b)(H.e);case"MarkReadUnread":return Object(a.b)(T.a);case"FlagUnflag":return Object(a.b)(_.a);case"AssignPolicy":return Object(a.b)(l.a);case"AddToSafeSenders":return Object(a.b)(H.d);case"MarkJunkNotJunk":return Object(a.b)(O.a);case"MarkAsPhishing":return Object(a.b)(H.g);case"Block":return Object(a.c)(Object(a.b)(b.a),"");case"CreateRule":return Object(a.b)(p.a);case"Print":return Object(a.b)(A.a);case"Translate":return Object(a.b)(E.a);case"ShowInImmersiveReader":return Object(a.b)(F.a);case"ViewMessageSource":return Object(B.a)()?Object(a.b)(H.j):Object(a.b)(H.i);case"ToggleDarkMode":return Object(a.b)(C.a);case"ReplyByIM":return Object(a.b)(H.s);case"ReplyAllByIM":return Object(a.b)(H.r);case"ToggleAmp":return Object(a.b)(H.u);case"AddToProjectSpace":return Object(a.b)(c.a);case"OtherReplyActions":return Object(a.b)(H.n);case"MessageSafety":return Object(a.b)(H.k);case"View":return Object(a.b)(H.x);case"AdvancedActions":return Object(a.b)(H.a);case"Addins":return Object(a.b)(H.m);default:return""}}function z(e){switch(e){case"None":return Object(a.b)(H.l);case"Delete":return Object(a.b)(m.a);case"Archive":return Object(a.b)(u.a);case"PinUnpin":return Object(a.b)(w.a);case"ReadUnread":return Object(a.b)(H.q);case"FlagUnflag":return Object(a.b)(g.a);case"Move":return Object(a.b)(P.a);default:return""}}var G=n(3510),q=n(4216),K=n(5215),X=n(3511),J=n(76),Q=n(2264),Z=n(960),Y=n(27),$=n(242),ee=n(60),te=n(1545);function ne(){var e=[{key:"Reply",hideInGroup:!0,hideInSxS:!1},{key:"ReplyAll",hideInGroup:!1,hideInSxS:!1},{key:"Forward",hideInGroup:!1,hideInSxS:!1}];return e.push({key:"-",hideInGroup:!1,hideInSxS:!1},{key:"ReplyByMeeting",hideInGroup:!0,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1},{key:"Delete",hideInGroup:!1,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1},{key:"MarkReadUnread",hideInGroup:!1,hideInSxS:!0},{key:"FlagUnflag",hideInGroup:!0,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1}),Object(J.h)("fwk-skypeBusinessV2")&&e.push({key:"ReplyByIM",hideInGroup:!0,hideInSxS:!1},{key:"ReplyAllByIM",hideInGroup:!0,hideInSxS:!1},{key:"-",hideInGroup:!0,hideInSxS:!1}),Object(Q.a)()&&e.push({key:"AddToProjectSpace",hideInGroup:!1,hideInSxS:!1},{key:"-",hideInGroup:!1,hideInSxS:!1}),Object(Y.a)().SessionSettings.IsShadowMailbox||(e.push({key:"AddToSafeSenders",hideInGroup:!0,hideInSxS:!0},{key:"MarkJunkNotJunk",hideInGroup:!0,hideInSxS:!0},{key:"MarkAsPhishing",hideInGroup:!0,hideInSxS:!0},{key:"Block",hideInGroup:!0,hideInSxS:!0}),Object(J.h)("tri-reportAbuse")&&e.push({key:"ReportAbuse",hideInGroup:!Object(B.a)(),hideInSxS:!0}),e.push({key:"-",hideInGroup:!1,hideInSxS:!1})),Object(B.a)()||e.push({key:"AssignPolicy",hideInGroup:!1,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1}),Object(Y.a)().SessionSettings.IsShadowMailbox||e.push({key:"CreateRule",hideInGroup:!0,hideInSxS:!0}),e.push({key:"Print",hideInGroup:!1,hideInSxS:!1}),Object(J.h)("rp-inlineTranslation")&&Object(J.h)("rp-inlineTranslationManual")&&e.push({key:"Translate",hideInGroup:!0,hideInSxS:!0}),Object($.c)()&&e.push({key:"ToggleDarkMode",hideInGroup:!1,hideInSxS:!1}),Object(J.h)("rp-immersiveReader")&&e.push({key:"ShowInImmersiveReader",hideInGroup:!1,hideInSxS:!0}),e.push({key:"ViewMessageSource",hideInGroup:!1,hideInSxS:!0}),e.push({key:"Popout",hideInGroup:!1,hideInSxS:!0}),Object(B.a)()||e.push({key:"LikeUnlike",hideInGroup:!1,hideInSxS:!0}),Object(J.h)("rp-amp")&&Object(B.a)()&&e.push({key:"ToggleAmp",hideInGroup:!1,hideInSxS:!0}),Object(J.h)("rp-menuShort")&&e.push({key:"OtherReplyActions",hideInMailSurfaceSettings:!0},{key:"MessageSafety",hideInMailSurfaceSettings:!0},{key:"View",hideInMailSurfaceSettings:!0},{key:"AdvancedActions",hideInMailSurfaceSettings:!0},{key:"Addins",hideInMailSurfaceSettings:!0}),e}function re(){var e=[{key:"AddAttachment",hideInGroup:!1},{key:"AddInlineImage",hideInGroup:!1}];return Object(J.h)("cmp-fluidHeroButton")&&Object(te.a)()&&!Object(B.a)()&&Object(Y.a)().AttachmentPolicy.AttachmentDataProviderAvailable&&e.push({key:"FluidHeroButton",hideInGroup:!1}),e.push({key:"AddEmoji",hideInGroup:!1}),Object(q.a)()&&e.push({key:"ProofingOptions",hideInGroup:!1}),Object(J.h)("honeybee-quickUse")&&e.push({key:"QuickUse",hideInGroup:!1}),(Object(ee.e)()||Object(ee.f)()||Object(ee.c)())&&Object(J.h)("cmp-dictation")&&e.push({key:"ToggleDictation",hideInGroup:!1}),e=e.concat([{key:"ToggleRibbon",hideInGroup:!1},{key:"SaveDraft",hideInGroup:!1},{key:"InsertSignature",hideInGroup:!1},{key:"ShowFrom",hideInGroup:!1},{key:"SetImportance",hideInGroup:!1},{key:"SwitchBodyType",hideInGroup:!1},{key:"AccChecker",hideInGroup:!1}]),Object(J.h)("cmp-clp")&&!Object(B.a)()&&e.push({key:"SensitivityMenu",hideInGroup:!1}),Object(X.a)()&&e.push({key:"ProtectMessage",hideInGroup:!1}),Object(K.a)()&&e.push({key:"ShowMessageOptions",hideInGroup:!1}),e}function oe(e){return"Reply"==e||"ReplyAll"==e||"Forward"==e}function ie(e){return-1!==Object(Z.d)(Z.a.SurfaceActions).readSurfaceActions.indexOf(e)}function ae(e,t){return ie(e)||!(!Object(J.h)("rp-csaPinnedLikes")||"LikeUnlike"!==e||!t.LikeCount)||!(!Object(J.h)("rp-menuShort")||"ToggleDarkMode"!==e||!Object($.c)())||!!(Object(J.h)("rp-menuShort")&&"ToggleAmp"===e&&Object(J.h)("rp-amp")&&Object(B.a)())}var se=n(254);function ce(e,t,n,r,o){var i;if(r?i=r:(i="Pinned",(null==n?void 0:n.renderedInOverflow)&&(i=n.isPinned?"Overflow":"NotPinned")),Object(se.o)(e?"CSACountComposeUserAction":"CSACountReadUserAction",[t,i,Object(J.h)("rp-menuShort")]),Object(J.h)("rp-menuShort")&&!e){var a=o?"CSAReadNested"+t:"CSARead"+t;Object(se.o)(a,[i])}}function ue(e){var t,n;null===(n=null===(t=e.subMenuProps)||void 0===t?void 0:t.items)||void 0===n||n.forEach((function(e){e.renderedInOverflow=!0}))}function le(e){var t,n;null===(n=null===(t=e.subMenuProps)||void 0===t?void 0:t.items)||void 0===n||n.forEach((function(e){e.renderedInOverflow=!1}))}n.d(t,"k",(function(){return fe})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return W})),n.d(t,"g",(function(){return V})),n.d(t,"f",(function(){return z})),n.d(t,"a",(function(){return"-"})),n.d(t,"d",(function(){return G.a})),n.d(t,"h",(function(){return G.c})),n.d(t,"e",(function(){return re})),n.d(t,"i",(function(){return ne})),n.d(t,"p",(function(){return oe})),n.d(t,"o",(function(){return ae})),n.d(t,"j",(function(){return ie})),n.d(t,"l",(function(){return ce})),n.d(t,"n",(function(){return ue})),n.d(t,"m",(function(){return le}));var de=new r.c((function(){return n.e(555).then(n.bind(null,15369))})),fe=new r.a(de,(function(e){return e.setAddinOptionSurfaceItems}))},3139:function(e){e.exports=JSON.parse('{"a":"DFa"}')},3154:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="Addins"},319:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return m})),n.d(t,"g",(function(){return g})),n.d(t,"f",(function(){return h}));var r,o=n(163),i=n(335),a=n(104),s=0,c=Object(i.b)({overflow:"hidden !important"}),u="data-is-scrollable",l=function(e,t){if(e){var n=0,r=null;t.on(e,"touchstart",(function(e){1===e.targetTouches.length&&(n=e.targetTouches[0].clientY)}),{passive:!1}),t.on(e,"touchmove",(function(e){if(1===e.targetTouches.length&&(e.stopPropagation(),r)){var t=e.targetTouches[0].clientY-n,o=h(e.target);o&&(r=o),0===r.scrollTop&&t>0&&e.preventDefault(),r.scrollHeight-Math.ceil(r.scrollTop)<=r.clientHeight&&t<0&&e.preventDefault()}}),{passive:!1}),r=e}},d=function(e,t){if(e){t.on(e,"touchmove",(function(e){e.stopPropagation()}),{passive:!1})}},f=function(e){e.preventDefault()};function p(){var e=Object(o.a)();e&&e.body&&!s&&(e.body.classList.add(c),e.body.addEventListener("touchmove",f,{passive:!1,capture:!1})),s++}function m(){if(s>0){var e=Object(o.a)();e&&e.body&&1===s&&(e.body.classList.remove(c),e.body.removeEventListener("touchmove",f)),s--}}function g(){if(void 0===r){var e=document.createElement("div");e.style.setProperty("width","100px"),e.style.setProperty("height","100px"),e.style.setProperty("overflow","scroll"),e.style.setProperty("position","absolute"),e.style.setProperty("top","-9999px"),document.body.appendChild(e),r=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return r}function h(e){for(var t=e,n=Object(o.a)(e);t&&t!==n.body;){if("true"===t.getAttribute(u))return t;t=t.parentElement}for(t=e;t&&t!==n.body;){if("false"!==t.getAttribute(u)){var r=getComputedStyle(t),i=r?r.getPropertyValue("overflow-y"):"";if(i&&("scroll"===i||"auto"===i))return t}t=t.parentElement}return t&&t!==n.body||(t=Object(a.a)(e)),t}},3197:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1920),o=n(964),i=n(1691);function a(e,t){var n;return Object(i.a)({Path:Object(o.a)({FieldURI:e}),Item:Object(r.a)((n={},n[e]=t,n))})}},3218:function(e,t,n){"use strict";var r=n(0);function o(e,t,n){return"Addin_"+e+"_"+t+"_"+n}var i,a=n(5139),s=n(1046),c=n(1666),u=n(1111);function l(e){return void 0===e&&(e=null),{error:i.Success,data:e}}function d(e){return{error:i.Failed,errorCode:e}}function f(e,t){return!p(e)&&(t(d(u.a.InsufficientItemPermissions)),!0)}function p(e){return!e.isSharedItem||!e.getSharedProperties||(!e.isSharedItem()||e.getSharedProperties().delegatePermissions.EditOwn)}!function(e){e[e.Success=0]="Success",e[e.Failed=1]="Failed"}(i||(i={}));var m=n(1013),g=n(1548);function h(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,f,h,v,y,b;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(i=Object(s.c)(e),f=Object(m.u)(t),h=o(e,f,n),!Object(g.f)(h))return[2,d(u.b.NotificationKeyNotFound)];if(v=Object(g.e)(h),(y=v.Persistent)&&!p(i))return[2,d(u.b.InsufficientItemPermissions)];i.removeNotificationMessage(h),Object(g.h)(h),r.label=1;case 1:return r.trys.push([1,4,,5]),y?[4,Object(a.a)(e,f)]:[3,3];case 2:r.sent(),r.label=3;case 3:return[3,5];case 4:return(b=r.sent())instanceof c.a?[2,d(b.errorCode)]:[3,5];case 5:return[2,l()]}}))}))}function v(e){switch(e){case 0:return"informationalMessage";case 2:return"errorMessage";case 1:return"progressIndicator";case 3:return"insightMessage"}return""}function y(e,t,n,i,f,v,y,b,_){return void 0===y&&(y=null),void 0===b&&(b=!1),void 0===_&&(_=null),Object(r.__awaiter)(this,void 0,void 0,(function(){var S,C,O,A,I,x,E;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(!(S=Object(s.c)(e)))return[2,d(u.b.InvalidSelection)];if(C=Object(m.u)(t),O=o(e,C,i),function(e,t,n){var r=Object(m.n)(t);if(r){var i=r.get_Id(),a=o(e,n,i);Object(g.f)(a)&&h(e,t,i)}}(e,t,C),A=!1,Object(g.f)(O)){if(b)return[2,d(u.b.DuplicateNotificationKey)];I=Object(g.e)(O),A=I.Persistent}else if(Object(g.g)(e,C,_))return[2,d(u.b.NumberOfNotificationsExceeded)];if(x=function(e,t,n,r,o,i,a){return{ExtensionId:e,Persistent:!!t||2===r,Key:n,Type:r,Message:o,Icon:i,Actions:a||null}}(C,n,i,f,v,y,_),!p(S)&&x.Persistent)return[2,d(u.b.InsufficientItemPermissions)];Object(g.a)(e,C,O,x),S.addNotificationMessage(O),r.label=1;case 1:return r.trys.push([1,4,,5]),A||x.Persistent?[4,Object(a.a)(e,C)]:[3,3];case 2:r.sent(),r.label=3;case 3:return[3,5];case 4:return(E=r.sent())instanceof c.a?[2,d(E.errorCode)]:[3,5];case 5:return[2,l()]}}))}))}function b(e){try{var t=(new DOMParser).parseFromString(e,"text/html"),n=t.querySelectorAll("style");if(n&&n.length>0)for(var r=0;r<n.length;r++)n[r]&&(n[r].innerHTML="");return t.body.textContent||""}catch(e){return""}}function _(e){var t=Object(m.B)(e);if(t){var n=t.hostItemIndex,r=Object(m.C)(e);Object(m.bb)(r);var o=Object(s.c)(n);o&&o.closeTaskPane&&o.closeTaskPane()}}var S=n(1097);function C(e){return Object(s.d)(e)}function O(e,t,n){return e&&e.match(function(e,t){var n,r="g";t&&(r="ig");try{n=new RegExp(e,r)}catch(e){return null}return n}(t,n))}var A=n(438),I=255;function x(e){var t,n;try{for(var o=Object(r.__values)(e),i=o.next();!i.done;i=o.next()){var a=i.value.length;if(a<=0||a>I)return!0}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return!1}var E=n(3256);var T=n(2398);var P=n(3512),w=n(428);function M(e,t,n){var o,i,a,s,c=m.k.EnabledAddinCommands;if(!c)return null;try{for(var u=Object(r.__values)(c.getExtensionPoint(n)),l=u.next();!l.done;l=u.next()){var d=l.value;if(d.Id==e&&d.AddinCommands.size>0)try{for(var f=(a=void 0,Object(r.__values)(d.AddinCommands.values())),p=f.next();!p.done;p=f.next()){var g=p.value;if(g.control.Id==t)return g}}catch(e){a={error:e}}finally{try{p&&!p.done&&(s=f.return)&&s.call(f)}finally{if(a)throw a.error}}}}catch(e){o={error:e}}finally{try{l&&!l.done&&(i=u.return)&&i.call(u)}finally{if(o)throw o.error}}return null}var R=n(254);var j=/^[a-zA-Z0-9.!#$%&*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/;function k(e){return j.test(e)}function N(e){var t=[];return e.forEach((function(e){k(e.address)&&t.push({Name:e.name,EmailAddress:e.address})})),t}var D={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"},F=/[&<>"'\/]/g;var L=n(25);function U(e){return(t={input:e},Object(L.a)("SanitizeHtml",t,n)).catch(B);var t,n}function B(){return null}var H="<div>",W="</div>";function V(e){var t=e.trim();return t.substr(0,H.length).toLowerCase()==H&&t.substr(t.length-W.length,W.length).toLowerCase()==W&&(t=t.substring(H.length,t.length-W.length)),t}function z(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,U(e)];case 1:return null==(t=n.sent())?[2,null]:[2,V(t)]}}))}))}var G=n(49),q=null;function K(e){q=e}function X(){return q}var J,Q=function(e,t){var n=X();n&&n(e,t)},Z=n(699);!function(e){e[e.Success=0]="Success",e[e.OperationNotSupported=5e3]="OperationNotSupported",e[e.InternalError=5001]="InternalError",e[e.NotSsoAgave=13e3]="NotSsoAgave",e[e.UserNotSignedIn=13001]="UserNotSignedIn",e[e.UserAborted=13002]="UserAborted",e[e.InvalidResourceUrl=13004]="InvalidResourceUrl",e[e.InvalidGrant=13005]="InvalidGrant",e[e.ClientError=13006]="ClientError",e[e.AddinIsAlreadyRequestingToken=13008]="AddinIsAlreadyRequestingToken",e[e.SSOUnsupportedPlatform=13012]="SSOUnsupportedPlatform"}(J||(J={}));var Y=n(288),$="bc59ab01-8403-45c6-8796-ac3ef710b3e3",ee="/owa/extSSO.aspx";function te(e,t,n){var r=Object(m.E)(e),o=Object(Y.resolve)(window.location.origin,ee);try{Object(Z.getAccessTokenOnBehalfOfResource)($,o,r,t,n,ne)}catch(e){ne(e,void 0)}}function ne(e,t){var n,r;t?Q(null,t):Q((n=e,r=J.ClientError,n&&(n.indexOf(Z.AdalErrorCode.NoUserLogin)>=0?r=J.UserNotSignedIn:n.indexOf(Z.AdalErrorCode.InvalidResourceUrl)>=0?r=J.InvalidResourceUrl:n.indexOf(Z.AdalErrorCode.NoPreAuth)>=0||n.indexOf(Z.AdalErrorCode.NotConsent)>=0?r=J.InvalidGrant:n.indexOf(Z.AdalErrorCode.UserAborted)>=0&&(r=J.UserAborted)),r)),K(null)}var re=1e6;function oe(e,t,n,o,i,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,c,f,p,m;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(t=n.appendTxt||""===n.appendTxt?n.appendTxt:n.data).length>re?(o(d(u.a.OoeInvalidDataFormat)),[2]):(c=null==a?void 0:a(),f=null,n.coercionType!==hn.a.Html?[3,2]:[4,z(t)]);case 1:return null==(f=r.sent())?(o(d(u.a.HtmlSanitizationFailure)),[2]):function(e){for(var t=(new DOMParser).parseFromString(e,"text/html").querySelectorAll("img"),n=0;n<t.length;n++){var r=t[n].getAttribute("src");if(r=decodeURIComponent(r)){var o=r.lastIndexOf(".");if(-1!==o&&"svg"===r.substring(o+1).toLowerCase())return!0}}return!1}(f)?(o(d(J.OperationNotSupported)),[2]):[3,3];case 2:p=Object(s.c)(e),f="HTML"!==p.getBodyType()||n.appendOnSend?t:t.replace(F,(function(e){return D[e]})),r.label=3;case 3:if(n.appendOnSend)n.appendOnSend.txt=f,i(n.appendOnSend);else{if(a&&(m=a(),h=m,!(null==(g=c)&&null==h||null!=g&&null!=h&&g.data===h.data&&g.sourceProperty===h.sourceProperty&&g.startPosition===h.startPosition&&g.endPosition===h.endPosition)))return o(d(u.a.CursorPositionChanged)),[2];i(f),"Firefox"===Object(G.a)().browser&&document.activeElement.blur()}return o(l()),[2]}var g,h}))}))}var ie=n(5614),ae=n(76),se=5e3;var ce,ue=n(7642);function le(e,t,n,o){!function(e){return Object(r.__spread)(Object(m.t)().taskPanes.values()).some((function(t){return t.controlId===e}))}(t)?function(e){return Object(m.t)().runningContextualAddinCommand&&Object(m.t)().runningContextualAddinCommand.controlId===e}(t)&&Object(m.Z)():_(t),o(l())}!function(e){e[e.MaxRecipientsOnDisplayNewAppointment=100]="MaxRecipientsOnDisplayNewAppointment",e[e.MaxSubjectLength=255]="MaxSubjectLength",e[e.MaxBodyLengthOnDisplayApis=32768]="MaxBodyLengthOnDisplayApis",e[e.MaxLocationLengthOnDisplayNewAppointment=255]="MaxLocationLengthOnDisplayNewAppointment",e[e.MaxAttachmentNumberOnDisplayApis=100]="MaxAttachmentNumberOnDisplayApis",e[e.MaxRecipientsPerCall=100]="MaxRecipientsPerCall"}(ce||(ce={}));var de=ce,fe=function(e){return"string"==typeof e?{Name:e,EmailAddress:e}:{Name:e.name,EmailAddress:e.address}},pe=function(e){return e?e.map(fe):[]};function me(e,t){return e&&e.length>t}function ge(e){switch(e[0]){case"file":return function(e){return{id:e[2],name:e[1],attachmentType:T.f.File,isInline:e[3]}}(e);case"item":return function(e){return{id:e[2],name:e[1],attachmentType:T.f.Item,isInline:!1}}(e);default:return null}}function he(e,t,n,o,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,a,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t="",a=[],n.htmlBody?n.htmlBody.length>de.MaxBodyLengthOnDisplayApis?(o(d()),[2]):[4,z(n.htmlBody)]:[3,2];case 1:if(null==(t=r.sent()))return o(d()),[2];r.label=2;case 2:if(n.attachments){if(n.attachments.length>de.MaxAttachmentNumberOnDisplayApis)return o(d()),[2];a=n.attachments.map(ge)}return[4,(c=Object(s.c)(e)).displayReplyForm(c.getItemId(),i,t,a)];case 3:return r.sent(),o(l()),[2]}}))}))}function ve(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,he(e,0,n,o,!0)];case 1:return t.sent(),[2]}}))}))}function ye(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,he(e,0,n,o,!1)];case 1:return t.sent(),[2]}}))}))}n(2425);function be(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"EwsProxyRequestParameters:#Exchange"},n)),Object(L.a)("ExecuteEwsProxy",e,t)}function _e(e,t,n){return be({Body:e,Token:t,ExtensionId:n})}var Se=n(9),Ce="Token type is not supported for caching: {0}",Oe=n(2905),Ae=n(2826),Ie=n(246),xe="CallerIdentity",Ee="ScopedToken",Te="ExtensionRestApiCallback",Pe="ExtensionCallback";function we(e,t,n){var r=new Array(t.length);t.forEach((function(t,o){return r[o]={TokenType:t,Id:e,Scope:n}}));var o=Object(Ae.a)({TokenRequests:r});return Object(Oe.a)({Header:Object(Ie.a)(),Body:o})}var Me=15,Re={},je={};function ke(e,t){Fe(t.TokenType)[e]=function(e){return{cacheTime:Date.now(),token:e}}(t)}function Ne(e,t){var n=Fe(t);return function(e,t){var n=Fe(t);n[e]&&(r=n[e],o=Date.now()-r.cacheTime,i=1e3*(r.token.TTL-Me)*60,o>=i)&&delete n[e];var r,o,i;return!!n[e]}(e,t)?n[e].token:null}function De(e){return e==xe||e==Pe}function Fe(e){switch(e){case xe:return Re;case Pe:return je;default:throw Object(Se.c)(Ce,e)}}var Le="Success";function Ue(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,i,a,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(De(t)&&(o=Ne(e.extension.Id,t)))return[2,o];i=[],Ne(e.extension.Id,xe)||i.push(xe),2!=e.extension.RequestedCapabilities||Ne(e.extension.Id,Pe)||i.push(Pe),t!=Te&&t!=Ee||i.push(t),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,we(e.extension.Id,i,n)];case 2:return a=r.sent(),[3,4];case 3:return r.sent(),[2,null];case 4:return s=function(e){return e.Body.ResponseMessages.Items.forEach(Be),e.Body.ResponseMessages.Items}(a),[2,He(t)(s)]}}))}))}function Be(e){"NoError"==e.ResponseCode&&e.ResponseClass==Le&&De(e.Token.TokenType)&&ke(e.Token.Id,e.Token)}var He=function(e){return function(t){var n=t.filter(We(e))[0];return n?n.Token:null}},We=function(e){return function(t){return"NoError"==t.ResponseCode&&t.ResponseClass==Le&&t.Token.TokenType==e}};var Ve=1e6;var ze="Error",Ge="accessToken";function qe(e){var t;return(t={})[ze]=e,t}var Ke="User",Xe="MarketPlace";function Je(e){if(e){var t;try{var n=new URL(e);if(!n||"https:"!=n.protocol)return;t=n.host}catch(n){var r=document.createElement("a");if(r.href=e,"https:"!==r.protocol)return;var o=function(e){return"/"===e.substring(e.length-1,e.length)};""!==r.pathname&&"/"!==r.pathname||o(e)||(e+="/");var i=r.protocol+"//"+r.hostname+(o(r.hostname)?"":"/")+r.pathname+r.search+r.hash,a=r.protocol+"//"+r.host+(o(r.host)?"":"/")+r.pathname+r.search+r.hash;e!=i&&e!=a||(t="443"==r.port?r.hostname:r.host)}return t}}var Qe=n(314),Ze=n(991),Ye="ItemAttachment:#Exchange";function $e(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,i,a,s,c,u,l,d,f,p,m,g;return Object(r.__generator)(this,(function(h){switch(h.label){case 0:if(o=null,i=t.getItem(),a=!1,!(i.Attachments.length>0))return[3,13];h.label=1;case 1:h.trys.push([1,10,11,12]),s=Object(r.__values)(i.Attachments),c=s.next(),h.label=2;case 2:return c.done?[3,9]:(u=c.value,l=u.AttachmentOriginalUrl,d=u.AttachmentId.Id,"ReferenceAttachment:#Exchange"!==u.__type||n!==l?[3,3]:(f=u,o={format:T.a.Url,content:f.AttachLongPathName},a=!0,[2,o]));case 3:return n!==d?[3,8]:!0!==e?[3,5]:[4,t.getAttachmentContent(n)];case 4:return o=h.sent(),[3,7];case 5:return[4,t.getAttachmentContent(n)];case 6:o=h.sent(),h.label=7;case 7:return a=!0,[2,o];case 8:return c=s.next(),[3,2];case 9:return[3,12];case 10:return p=h.sent(),m={error:p},[3,12];case 11:try{c&&!c.done&&(g=s.return)&&g.call(s)}finally{if(m)throw m.error}return[7];case 12:if(!a)return[2,o];h.label=13;case 13:return[2,o]}}))}))}var et=n(630),tt=n(629),nt=n(553),rt="Success";function ot(e,t,n){var r=e.map((function(e){return Object(nt.a)({Id:e})}));return Object(et.a)({Header:Object(Ie.a)(),Body:Object(tt.a)({ItemShape:t,ItemIds:r,ShapeName:n})}).then((function(e){return(t=e.Body.ResponseMessages.Items[0]).ResponseClass==rt?t.Items[0]:{};var t}))}var it=n(484),at=n(964);function st(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return Object(ae.h)("addin-getBodyAsyncApi-update-fix")?[3,3]:e.NormalizedBody?[3,2]:[4,ot([e.ItemId.Id],ct(),"ItemNormalizedBody")];case 1:t=n.sent(),e.NormalizedBody=t.NormalizedBody,n.label=2;case 2:return[2,e.NormalizedBody.Value];case 3:return[4,ot([e.ItemId.Id],ct(),"ItemNormalizedBody")];case 4:return[2,n.sent().NormalizedBody.Value]}}))}))}function ct(){return Object(it.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(at.a)({FieldURI:"NormalizedBody"})]})}function ut(e,t){return{wasSuccessful:e,token:t}}var lt,dt="ParentItemId:";!function(e){e[e.Message=1]="Message",e[e.Appointment=2]="Appointment",e[e.MeetingRequest=3]="MeetingRequest",e[e.MessageCompose=4]="MessageCompose",e[e.AppointmentCompose=5]="AppointmentCompose"}(lt||(lt={}));var ft=lt;function pt(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t.itemType=ft.AppointmentCompose,n=t,[4,e.getSeriesId()];case 1:return n.seriesId=r.sent(),[2,t]}}))}))}var mt=n(24),gt=n(316);function ht(e,t,n){if(!e)return{};var r={Addresses:e.Addresses?e.Addresses.map((function(e){return e.Address})):[],Urls:e.Urls?e.Urls.map((function(e){return e.Url})):[],PhoneNumbers:e.PhoneNumbers?e.PhoneNumbers:[]};return r.IsLegacyExtraction=function(e){return!(e.EntityDocument||e.PropertyExistence&&e.PropertyExistence.TextEntityExtractions)}(t),0!=n.extension.RequestedCapabilities&&(r.Contacts=e.Contacts?e.Contacts:[],r.EmailAddresses=e.EmailAddresses?e.EmailAddresses.map((function(e){return e.EmailAddress})):[],r.MeetingSuggestions=e.MeetingSuggestions?e.MeetingSuggestions.map(yt.bind(r)):[],r.TaskSuggestions=e.TaskSuggestions?e.TaskSuggestions:[]),r}function vt(e,t){var n,o;try{for(var i=Object(r.__values)(t),a=i.next();!a.done;a=i.next()){var s=O(e,a.value,!0);if(s&&s.length>0)return!0}}catch(e){n={error:e}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}return!1}function yt(e){var t=this.IsLegacyExtraction,n=Object(mt.toJS)(gt({},e));return n.EndTime=t?bt(n.EndTime):new Date(n.EndTime).getTime(),n.StartTime=t?bt(n.StartTime):new Date(n.StartTime).getTime(),n}function bt(e){var t=new Date(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),n.getTime()}function _t(e){var t={};return e&&Object.keys(e).forEach((function(n){var r;e[n]&&(t[n]=(r=e[n],Object(m.t)().contextualCalloutState.selectedTerms.filter((function(e){return r.indexOf(e)>=0}))))})),t}function St(e){return ot([e.ItemId.Id],Object(it.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(at.a)({FieldURI:"EntityExtractionResult"})]}),null)}function Ct(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,a,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(t.EntityExtractionResult||!function(e){return e.PropertyExistence&&(e.PropertyExistence.ExtractedAddresses||e.PropertyExistence.ExtractedContacts||e.PropertyExistence.ExtractedEmails||e.PropertyExistence.ExtractedMeetings||e.PropertyExistence.ExtractedPhones||e.PropertyExistence.ExtractedTasks||e.PropertyExistence.ExtractedUrls)}(t))return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,St(t)];case 2:return i=r.sent(),Object(m.gb)(t,i.EntityExtractionResult),[3,4];case 3:return r.sent(),[3,4];case 4:return t.EntityExtractionResult&&(o.entities=ht(t.EntityExtractionResult,t,n),o.entities&&(a=JSON.parse(JSON.stringify(o.entities)),o.selectedEntities=function(e,t){var n={};return e&&t&&(e.Addresses&&(n.Addresses=e.Addresses.filter((function(e){return vt(e,t)}))),e.MeetingSuggestions&&(n.MeetingSuggestions=e.MeetingSuggestions.filter((function(e){return vt(e.MeetingString,t)}))),e.TaskSuggestions&&(n.TaskSuggestions=e.TaskSuggestions.filter((function(e){return vt(e.TaskString,t)}))),e.PhoneNumbers&&(n.PhoneNumbers=e.PhoneNumbers.filter((function(e){return vt(e.OriginalPhoneString,t)}))),e.Urls&&(n.Urls=e.Urls.filter((function(e){return vt(e,t)}))),e.Contacts&&(n.Contacts=e.Contacts.filter((function(e){return vt(e.ContactString,t)}))),e.EmailAddresses&&(n.EmailAddresses=e.EmailAddresses.filter((function(e){return vt(e,t)})))),n}(a,Object(m.t)().contextualCalloutState.selectedTerms))),(s=function(e,t){var n=Object(m.v)(e);return(null==n?void 0:n.contextualEvaluationResults)&&n.contextualEvaluationResults.has(t)?n.contextualEvaluationResults.get(t):null}(e,n.extension.Id))&&(o.filteredEntities=s.filteredEntityMatches,o.regExMatches=s.regExMatches,o.selectedRegExMatches=_t(o.regExMatches)),[2,o]}}))}))}var Ot,At,It=n(4569);!function(e){e[e.Other=0]="Other",e[e.DistributionList=1]="DistributionList",e[e.User=2]="User",e[e.ExternalUser=3]="ExternalUser"}(Ot||(Ot={})),function(e){e[e.Unknown=0]="Unknown",e[e.Organizer=1]="Organizer",e[e.Tentative=2]="Tentative",e[e.Accept=3]="Accept",e[e.Decline=4]="Decline",e[e.NoResponseReceived=5]="NoResponseReceived"}(At||(At={}));var xt=function(e){return{address:e.EmailAddress,name:e.Name,recipientType:Pt(e.MailboxType)}},Et=function(e){var t=xt(e.Mailbox);return t.appointmentResponse=function(e){switch(e){case"Organizer":return At.Organizer;case"Tentative":return At.Tentative;case"Accept":return At.Accept;case"Decline":return At.Decline;case"NoResponseReceived":return At.NoResponseReceived;default:return At.Unknown}}(e.ResponseType),t},Tt=function(e){return e?e.map((function(e){return Et(e)})):[]};function Pt(e){switch(e){case"PublicDL":case"PrivateDL":case"PublicFolder":return Ot.DistributionList;case"Mailbox":case"Contact":return Ot.User;case"OneOff":return Ot.ExternalUser;default:return Ot.Other}}function wt(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,a,s,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return o.itemType=ft.Appointment,i=e.getItem(),o.id=i.ItemId.Id,o.end=i.End,o.start=i.Start,o.location=i.Location.DisplayName,o.dateTimeCreated=i.DateTimeCreated?new Date(i.DateTimeCreated):null,o.dateTimeModified=i.LastModifiedTime?new Date(i.LastModifiedTime):null,o.itemClass=i.ItemClass,o.subject=i.Subject,o.normalizedSubject=i.Subject,o.organizer=Et(i.Organizer),a=Tt(i.RequiredAttendees),o.to=function(e,t){if(t){if(!e.some((function(e){return e.address.toLowerCase()===t.address.toLowerCase()})))return e.concat(t)}return e}(a,o.organizer),o.cc=Tt(i.OptionalAttendees),o.attachments=i.Attachments?Object(T.g)(i.Attachments):[],[4,e.getRecurrence()];case 1:return s=r.sent(),o.recurrence=Object(It.a)({recurrenceType:s,timeZone:i.StartTimeZoneId,startTime:new Date(i.Start),endTime:new Date(i.End)}),o.resources=Tt(i.Resources),c=o,[4,e.getSeriesId()];case 2:return c.seriesId=r.sent(),[4,Ct(n,i,t,o)];case 3:return[2,o=r.sent()]}}))}))}var Mt=n(6208),Rt=n(161),jt=n(103),kt=n(2);function Nt(e,t,n,r){return r=function(e,t){return t.hostVersion=Object(kt.j)()||"debug",t.owaView="mouse",t.timeZoneOffsets=Object(Rt.e)(),t}(0,r=function(e,t){var n=e.extension;return t.extensionId=n.Id,t.marketplaceContentMarket=n.MarketplaceContentMarket,t.permissionLevel=n.RequestedCapabilities,t.marketplaceAssetId=n.MarketplaceAssetID,t.entryPointUrl=e.get_EntryPoint(),t.consentMetadata=n.ConsentMetadata,t.endNodeUrl=n.EndNodeUrl,t}(t,r)),0!=t.extension.RequestedCapabilities&&(r=function(e,t){return t.userDisplayName=Object(jt.l)(),t.userEmailAddress=Object(jt.m)(),t.userTimeZone=Object(jt.q)(),t.userProfileType=Object(Mt.a)(),t.ewsUrl=Object(m.s)().EwsUrl,t.restUrl=Object(m.s)().RestUrl,t}(0,r)),Object(ae.h)("addin-delegateAccess")&&e.isSharedItem&&e.getSharedProperties&&(r.isFromSharedFolder=e.isSharedItem()),Object(ae.h)("addin-delegateAccess")&&(r.shouldRunNewCodeForFlags|=1),r}var Dt="0xe1d";function Ft(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return o.id=e.getItemId(),o.isRead=!0,o.itemType=ft.Message,i=e.getItem(),o.itemClass=i.ItemClass,o.subject=i.Subject,o.normalizedSubject=function(e,t){if(!e.ExtendedProperty)return null;for(var n=0;n<e.ExtendedProperty.length;n++){var r=e.ExtendedProperty[n];if((null==r?void 0:r.ExtendedFieldURI)&&r.ExtendedFieldURI.PropertyTag===t)return r.Value}return null}(i,Dt),o.conversationId=i.ConversationId.Id,o.internetMessageId=i.InternetMessageId,o.dateTimeCreated=i.DateTimeCreated?new Date(i.DateTimeCreated).getTime():null,o.dateTimeModified=i.LastModifiedTime?new Date(i.LastModifiedTime).getTime():null,o.dateTimeSent=i.DateTimeSent?new Date(i.DateTimeSent).getTime():null,o.attachments=i.Attachments?Object(T.g)(i.Attachments):[],[4,Ct(n,i,t,o)];case 1:return o=r.sent(),0==t.extension.RequestedCapabilities?[3,3]:(o.from=i.From?xt(i.From.Mailbox):null,o.sender=i.Sender?xt(i.Sender.Mailbox):null,o.to=i.ToRecipients?i.ToRecipients.map(xt):[],o.cc=i.CcRecipients?i.CcRecipients.map(xt):[],o.bcc=i.BccRecipients?i.BccRecipients.map(xt):[],function(e){return 0==e.ItemClass.indexOf("IPM.Schedule.Meeting.Request")||0==e.ItemClass.indexOf("IPM.Schedule.Meeting.Canceled")}(i)?[4,Lt(e,o)]:[3,3]);case 2:o=r.sent(),r.label=3;case 3:return[2,o]}}))}))}function Lt(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=e.getItem(),t.itemType=ft.MeetingRequest,t.location=n.Location.DisplayName,t.start=n.Start,t.end=n.End,t.to=n.RequiredAttendees?n.RequiredAttendees.map(Et):[],t.cc=n.OptionalAttendees?n.OptionalAttendees.map(Et):[],t.resources=n.Resources?n.Resources.map(Et):[],o=t,[4,e.getSeriesId()];case 1:return o.seriesId=r.sent(),[4,e.getRecurrence()];case 2:return i=r.sent(),t.recurrence=Object(It.a)({recurrenceType:i,timeZone:n.StartTimeZoneId,startTime:new Date(n.Start),endTime:new Date(n.End)}),[2,t]}}))}))}function Ut(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:switch(n={},o=Object(s.c)(t),Object(m.v)(t),i=Object(m.n)(e),n=Nt(o,i,0,n),o.mode){case S.a.MeetingRequest:case S.a.MessageRead:return[3,1];case S.a.MessageCompose:return[3,3];case S.a.AppointmentAttendee:return[3,4];case S.a.AppointmentOrganizer:return[3,6]}return[3,8];case 1:return[4,Ft(o,i,t,n)];case 2:return n=r.sent(),[3,8];case 3:return n=function(e,t){return t.itemType=ft.MessageCompose,t.conversationId=e.getConversationId(),t.isRead=!1,t}(o,n),[3,8];case 4:return[4,wt(o,i,t,n)];case 5:return n=r.sent(),[3,8];case 6:return[4,pt(o,n)];case 7:return n=r.sent(),[3,8];case 8:return[2,n]}}))}))}var Bt=n(5501);var Ht,Wt=500;!function(e){e[e.Start=1]="Start",e[e.End=2]="End"}(Ht||(Ht={}));var Vt=Ht;var zt=n(315);function Gt(e,t){var n;return void 0===e.request||e.request.__type||(e.request=(n=e.request,Object(r.__assign)({__type:"LoadExtensionCustomPropertiesParameters:#Exchange"},n))),Object(L.a)("LoadExtensionCustomProperties",e,t)}function qt(e,t,n){return Gt({request:{ExtensionId:e,ItemId:t}},n?{headers:Object(zt.f)(n)}:{})}function Kt(e,t,n){return{errorMessage:e,wasSuccessful:t,customProperties:n}}var Xt=n(3040);function Jt(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"RegisterConsentJsonRequest:#Exchange"},n)),Object(L.a)("RegisterConsent",e,t)}function Qt(e,t){var n,o=(n={Id:e,ConsentState:t},Object(r.__assign)({__type:"RegisterConsentRequest:#Exchange"},n));return Jt({Header:Object(Ie.a)(),Body:o})}function Zt(e,t){var n;return void 0===e.request||e.request.__type||(e.request=(n=e.request,Object(r.__assign)({__type:"SaveExtensionCustomPropertiesParameters:#Exchange"},n))),Object(L.a)("SaveExtensionCustomProperties",e,t)}function Yt(e,t,n,r){return Zt({request:{ExtensionId:e,ItemId:t,CustomProperties:r}},n?{headers:Object(zt.f)(n)}:{})}function $t(e,t){var n;return void 0===e.request||e.request.__type||(e.request=(n=e.request,Object(r.__assign)({__type:"SaveExtensionSettingsParameters:#Exchange"},n))),Object(L.a)("SaveExtensionSettings",e,t)}var en=32768;var tn,nn,rn=255;!function(e){e[e.GetInitialData=1]="GetInitialData",e[e.GetUserIdentityToken=2]="GetUserIdentityToken",e[e.EwsRequest=5]="EwsRequest",e[e.LoadCustomProperties=3]="LoadCustomProperties",e[e.SaveCustomProperties=4]="SaveCustomProperties",e[e.DisplayNewAppointmentForm=7]="DisplayNewAppointmentForm",e[e.DisplayMessageForm=8]="DisplayMessageForm",e[e.DisplayAppointmentForm=9]="DisplayAppointmentForm",e[e.DisplayReplyForm=10]="DisplayReplyForm",e[e.DisplayReplyAllForm=11]="DisplayReplyAllForm",e[e.GetCallbackToken=12]="GetCallbackToken",e[e.SetBodySelectedDataAsync=13]="SetBodySelectedDataAsync",e[e.GetBodyTypeAsync=14]="GetBodyTypeAsync",e[e.GetRecipientsAsync=15]="GetRecipientsAsync",e[e.AddFileAttachmentAsync=16]="AddFileAttachmentAsync",e[e.SetSubjectAsync=17]="SetSubjectAsync",e[e.GetSubjectAsync=18]="GetSubjectAsync",e[e.AddItemAttachmentAsync=19]="AddItemAttachmentAsync",e[e.RemoveAttachmentAsync=20]="RemoveAttachmentAsync",e[e.SetRecipientsAsync=21]="SetRecipientsAsync",e[e.AddRecipientsAsync=22]="AddRecipientsAsync",e[e.BodyPrependAsync=23]="BodyPrependAsync",e[e.GetTimeAsync=24]="GetTimeAsync",e[e.SetTimeAsync=25]="SetTimeAsync",e[e.GetLocationAsync=26]="GetLocationAsync",e[e.SetLocationAsync=27]="SetLocationAsync",e[e.GetSelectedDataAsync=28]="GetSelectedDataAsync",e[e.SetSelectedDataAsync=29]="SetSelectedDataAsync",e[e.DisplayReplyFormWithAttachments=30]="DisplayReplyFormWithAttachments",e[e.DisplayReplyAllFormWithAttachments=31]="DisplayReplyAllFormWithAttachments",e[e.SaveAsync=32]="SaveAsync",e[e.AddNotificationMessageAsync=33]="AddNotificationMessageAsync",e[e.GetAllNotificationMessagesAsync=34]="GetAllNotificationMessagesAsync",e[e.ReplaceNotificationMessageAsync=35]="ReplaceNotificationMessageAsync",e[e.RemoveNotificationMessageAsync=36]="RemoveNotificationMessageAsync",e[e.GetBodyAsync=37]="GetBodyAsync",e[e.SetBodyAsync=38]="SetBodyAsync",e[e.RegisterConsentAsync=40]="RegisterConsentAsync",e[e.Close=41]="Close",e[e.CloseApp=42]="CloseApp",e[e.DisplayNewMessageForm=44]="DisplayNewMessageForm",e[e.EventCompleted=94]="EventCompleted",e[e.CloseContainer=97]="CloseContainer",e[e.GetAccessTokenAsync=98]="GetAccessTokenAsync",e[e.GetInitializationContextAsync=99]="GetInitializationContextAsync",e[e.AppendOnSendAsync=100]="AppendOnSendAsync",e[e.GetRecurrenceAsync=103]="GetRecurrenceAsync",e[e.SetRecurrenceAsync=104]="SetRecurrenceAsync",e[e.GetFromAsync=107]="GetFromAsync",e[e.GetSharedPropertiesAsync=108]="GetSharedPropertiesAsync",e[e.MESSAGE_PARENT_DISPID=144]="MESSAGE_PARENT_DISPID",e[e.GetAttachmentsAsync=149]="GetAttachmentsAsync",e[e.AddBase64FileAttachmentAsync=148]="AddBase64FileAttachmentAsync",e[e.GetAttachmentContentAsync=150]="GetAttachmentContentAsync",e[e.GetInternetHeadersAsync=151]="GetInternetHeadersAsync",e[e.SetInternetHeadersAsync=152]="SetInternetHeadersAsync",e[e.RemoveInternetHeadersAsync=153]="RemoveInternetHeadersAsync",e[e.GetEnhancedLocationsAsync=154]="GetEnhancedLocationsAsync",e[e.AddEnhancedLocationsAsync=155]="AddEnhancedLocationsAsync",e[e.RemoveEnhancedLocationsAsync=156]="RemoveEnhancedLocationsAsync",e[e.GetCategoriesAsync=157]="GetCategoriesAsync",e[e.AddCategoriesAsync=158]="AddCategoriesAsync",e[e.RemoveCategoriesAsync=159]="RemoveCategoriesAsync",e[e.GetMasterCategoriesAsync=160]="GetMasterCategoriesAsync",e[e.AddMasterCategoriesAsync=161]="AddMasterCategoriesAsync",e[e.RemoveMasterCategoriesAsync=162]="RemoveMasterCategoriesAsync",e[e.GetItemIdAsync=164]="GetItemIdAsync",e[e.GetAllInternetHeadersAsync=168]="GetAllInternetHeadersAsync",e[e.SaveSettingsRequest=404]="SaveSettingsRequest",e[e.SetSignatureAsync=173]="SetSignatureAsync",e[e.GetComposeTypeAsync=174]="GetComposeTypeAsync",e[e.IsClientSignatureEnabledAsync=175]="IsClientSignatureEnabledAsync",e[e.DisableClientSignatureAsync=176]="DisableClientSignatureAsync"}(tn||(tn={}));var on=function(e,t){this.apiMethodDelegate=e,this.apiPermissionRequired=t},an=((nn={})[tn.GetInitialData]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Ut(t,e)];case 1:return n=r.sent(),Object(Bt.e)(!0,Object(m.n)(t),e,Object(m.r)(t),Object(m.D)(e,t),t),o(n),[2]}}))}))}),1),nn[tn.EwsRequest]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,i,a,s,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return!(e=n.body)||e.length>Ve?(o(d(u.b.GenericResponseError)),[2]):[4,Ue(i=Object(m.n)(t),Pe)];case 1:if(!(a=r.sent()))return o(d(u.b.GenericTokenError)),[2];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,_e(e,a.TokenValue,i.extension.Id)];case 3:return s=r.sent(),c=function(e){return{wasProxySuccessful:e.WasProxySuccessful,errorMessage:e.ErrorMessage,statusCode:e.StatusCode,statusDescription:e.StatusDescription,body:e.Body}}(s),o(c),[3,5];case 4:return r.sent(),o(d(u.b.GenericResponseError)),[3,5];case 5:return[2]}}))}))}),2),nn[tn.GetRecipientsAsync]=new on((function(e,t,n,r){r(l(Object(s.c)(e).getRecipients(n.recipientField).slice(0,Wt).map((function(e){return{name:e.Name,address:e.EmailAddress,recipientType:Pt(e.MailboxType)}}))))}),1),nn[tn.GetSubjectAsync]=new on((function(e,t,n,r){r(l(Object(s.c)(e).getSubject()||""))}),1),nn[tn.SetSubjectAsync]=new on((function(e,t,n,r){if(n.subject.length>rn)r(d(null));else{var o=Object(s.c)(e);f(o,r)||(o.setSubject(n.subject),r(l()))}}),3),nn[tn.SetRecipientsAsync]=new on((function(e,t,n,r){var o=Object(s.c)(e);if(!f(o,r)){var i=N(n.recipientArray);try{o.setRecipients(n.recipientField,i),r(l())}catch(e){r(d(e.errorCode))}}}),3),nn[tn.AddRecipientsAsync]=new on((function(e,t,n,r){var o=Object(s.c)(e);if(!f(o,r)){var i=N(n.recipientArray);try{o.addRecipients(n.recipientField,i),r(l())}catch(e){r(d(e.errorCode))}}}),3),nn[tn.SaveSettingsRequest]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,a,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(i=n[0],(a=JSON.stringify(i)).length>en)return o(d(u.b.GenericSettingsError)),[2];r.label=1;case 1:return r.trys.push([1,3,,4]),s=Object(m.n)(t),[4,(c=s.extension.Id,f=s.extension.Version,p=a,$t({request:{ExtensionId:c,ExtensionVersion:f,Settings:p}}))];case 2:return r.sent(),Object(m.hb)(e,t,a),o(l()),[3,4];case 3:return r.sent(),o(d(u.b.GenericSettingsError)),[3,4];case 4:return[2]}var c,f,p}))}))}),0),nn[tn.GetAccessTokenAsync]=new on((function(e,t,n,r){if(Object(ae.h)("addin-getAccessTokenAsync-api"))if(function(e){return!!Object(m.E)(e)}(t))if(X())r(qe(J.AddinIsAlreadyRequestingToken));else if(Object(m.H)())r(qe(J.InternalError));else if(function(e,t){var n=Object(m.E)(e);n&&(n=n.toLowerCase().replace("api://","https://"));var r=Je(n),o=Je(t);return!r||!o||r.toLowerCase()!=o.toLowerCase()}(t,n.SecurityOrigin))r(qe(J.InvalidResourceUrl));else{var o=n.allowConsentPrompt;if(n.forMSGraphAccess){if(function(e){var t=Object(m.n)(e);return!(null==t||!t.extension||t.extension.OriginString!=Ke||t.extension.TypeString!=Xe)}(t))return void r(qe(J.SSOUnsupportedPlatform));o=!1}!function(e){K(e)}((function(e,t){r(e?qe(e):function(e){var t;return(t={})[ze]=i.Success,t[Ge]=e,t}(t))})),te(t,n.authChallenge,o)}else r(qe(J.NotSsoAgave));else r(qe(J.SSOUnsupportedPlatform))}),1),nn[tn.GetCallbackToken]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,a,c,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return i=Object(m.n)(t),a=function(e){var t=s.c(e).getItemId();if(!t)return;return dt+t}(e),function(e,t){return e==Te&&2==t}(c=n.isRest?Te:Ee,i.extension.RequestedCapabilities)||a?[4,Ue(i,c,a)]:(o(d(u.b.CallSaveAsyncBeforeToken)),[2]);case 1:return l=r.sent(),o(l?ut(!0,l.TokenValue):d(u.b.GenericTokenError)),[2]}}))}))}),1),nn[tn.GetUserIdentityToken]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,Ue(Object(m.n)(t),xe)];case 1:return e=n.sent(),o(e?ut(!0,e.TokenValue):d(u.b.GenericTokenError)),[2]}}))}))}),1),nn[tn.MESSAGE_PARENT_DISPID]=new on((function(e,t,n,r){Object(Xt.d)(Xt.a.DISPLAY_DIALOG_DISPID,t,n,(function(){r(l())}))}),0),nn[tn.SetBodyAsync]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return f(t=Object(s.c)(e),o)?[2]:(i=n.coercionType==hn.a.Html?"HTML":"Text",[4,oe(e,0,n,o,(function(e){return t.setBody(e,i)}))]);case 1:return r.sent(),[2]}}))}))}),1),nn[tn.GetBodyAsync]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(t=Object(s.c)(e),i=t.mode,a=null,i!=S.a.MessageRead&&i!=S.a.AppointmentAttendee)return[3,5];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,st(t.getItem())];case 2:return a=r.sent(),[3,4];case 3:return r.sent(),o(d(u.a.GenericResponseError)),[2];case 4:return[3,6];case 5:i!=S.a.MessageCompose&&i!=S.a.AppointmentOrganizer||(a=t.getBody()),r.label=6;case 6:return n.coercionType==hn.a.Text&&(a=b(a)),o(l(a)),[2]}}))}))}),1),nn[tn.GetBodyTypeAsync]=new on((function(e,t,n,r){var o=Object(s.c)(e).getBodyType();r(l(o&&o.toLowerCase()||null))}),1),nn[tn.BodyPrependAsync]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return f(t=Object(s.c)(e),o)?[2]:n.coercionType===hn.a.Html&&"Text"===t.getBodyType()?(o(d(u.a.OoeInvalidDataFormat)),[2]):[4,oe(e,0,n,o,t.prependBody)];case 1:return r.sent(),[2]}}))}))}),3),nn[tn.Close]=new on((function(e,t){Object(s.c)(e).close(),Object(ue.a)(e)}),0),nn[tn.CloseApp]=new on(le,0),nn[tn.CloseContainer]=new on(le,0),nn[tn.DisplayMessageForm]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(s.c)(e).displayMessageForm(n.itemId)];case 1:return t.sent(),o(l()),[2]}}))}))}),1),nn[tn.DisplayReplyAllForm]=new on(ve,1),nn[tn.DisplayReplyAllFormWithAttachments]=new on(ve,1),nn[tn.DisplayReplyForm]=new on(ye,1),nn[tn.DisplayReplyFormWithAttachments]=new on(ye,1),nn[tn.DisplayAppointmentForm]=new on((function(e,t,n,r){n.itemId?(Object(s.c)(e).displayAppointmentForm(n.itemId),r(l())):r(d())}),1),nn[tn.DisplayNewAppointmentForm]=new on((function(e,t,n,r){var o;!n||me((o=n).requiredAttendees,de.MaxRecipientsOnDisplayNewAppointment)||me(o.optionalAttendees,de.MaxRecipientsOnDisplayNewAppointment)||me(o.subject,de.MaxSubjectLength)||me(o.body,de.MaxBodyLengthOnDisplayApis)||me(o.location,de.MaxLocationLengthOnDisplayNewAppointment)?r(d()):(Object(s.c)(e).displayNewAppointmentForm(pe(n.requiredAttendees),pe(n.optionalAttendees),n.start,n.end,n.location,n.resources,n.subject,n.body),r(l()))}),1),nn[tn.DisplayNewMessageForm]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i,a,c,u,f,p,m;return Object(r.__generator)(this,(function(g){switch(g.label){case 0:if(t=!1,i=Object(r.__read)([n.toRecipients,n.ccRecipients,n.bccRecipients].map((function(e){return e?e.length>de.MaxRecipientsPerCall?(t=!0,null):function(e){var t=[];return e.forEach((function(e){k(e)&&t.push({Name:e,EmailAddress:e,MailboxType:"OneOff",RoutingType:"SMTP"})})),t}(e):[]})),3),a=i[0],c=i[1],u=i[2],t)return o(d()),[2];if(f="",n.subject){if(n.subject.length>de.MaxSubjectLength)return o(d()),[2];f=n.subject}return p="",n.htmlBody?n.htmlBody.length>de.MaxBodyLengthOnDisplayApis?(o(d()),[2]):[4,z(n.htmlBody)]:[3,2];case 1:if(null==(p=g.sent()))return o(d()),[2];g.label=2;case 2:if(m=[],n.attachments){if(n.attachments.length>de.MaxAttachmentNumberOnDisplayApis)return o(d()),[2];m=n.attachments.map(ge)}return[4,Object(s.c)(e).displayNewMessageForm(a,c,u,f,p,m)];case 3:return g.sent(),o(l()),[2]}}))}))}),1),nn[tn.EventCompleted]=new on((function(e,t,n,r){OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(t,n)}),0),nn[tn.GetSelectedDataAsync]=new on((function(e,t,n,r){var o=Object(s.c)(e).getSelectedData();o?(n.coercionType==hn.a.Text&&(o.data=b(o.data)),r(l(o))):r(d(u.a.InvalidSelection))}),1),nn[tn.SetSelectedDataAsync]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return f(t=Object(s.c)(e),o)?[2]:null==(i=t.getSelectedData())?(o(d(u.a.InvalidSelection)),[2]):n.coercionType===hn.a.Html&&("subject"===i.sourceProperty||"body"===i.sourceProperty&&"Text"===t.getBodyType())?(o(d(u.a.OoeInvalidDataFormat)),[2]):[4,oe(e,0,n,o,t.setSelectedData,t.getSelectedData)];case 1:return r.sent(),[2]}}))}))}),3),nn[tn.SetBodySelectedDataAsync]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return f(t=Object(s.c)(e),o)?[2]:[4,oe(e,0,n,o,t.setBodySelectedData,t.getSelectedData)];case 1:return r.sent(),[2]}}))}))}),0),nn[tn.SaveAsync]=new on((function(e,t,n,r){var o=Object(s.c)(e);f(o,r)||o.saveItem().then((function(e){r(e?l(e):d(u.a.SaveError))}))}),3),nn[tn.LoadCustomProperties]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,a,c,l,f,p;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(n=Object(s.c)(e),!(i=n.getItemId()))return o(Kt("",!0,"{}")),[2];a=Object(m.u)(t),r.label=1;case 1:return r.trys.push([1,3,,4]),n.isSharedItem&&n.getSharedProperties&&n.isSharedItem()&&n.isRemoteItem()&&(l=n.getSharedProperties(),c=l.owner),[4,qt(a,i,c)];case 2:return f=r.sent(),(p=f.CustomProperties)&&(p=p.trim()),p||(p="{}"),o(Kt(f.ErrorMessage,f.WasSuccessful,p)),[3,4];case 3:return r.sent(),o(d(u.b.GenericResponseError)),[3,4];case 4:return[2]}}))}))}),1),nn[tn.SaveCustomProperties]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,a,c,p,g,h,v;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:i=Object(s.c)(e),a=Object(m.u)(t),c=JSON.stringify(n.customProperties),p=i.getItemId(),r.label=1;case 1:return r.trys.push([1,5,,6]),f(i,o)?[2]:p?[3,3]:[4,i.saveItem()];case 2:p=r.sent(),r.label=3;case 3:return i.isSharedItem&&i.getSharedProperties&&i.isSharedItem()&&i.isRemoteItem()&&(h=i.getSharedProperties(),g=h.owner),[4,Yt(a,p,g,c)];case 4:return v=r.sent(),Object(ae.h)("addin-delegateAccess")?v.WasSuccessful?o(l()):o(d(u.b.GenericResponseError)):o(Kt(v.ErrorMessage,v.WasSuccessful)),[3,6];case 5:return r.sent(),o(d(u.b.GenericResponseError)),[3,6];case 6:return[2]}}))}))}),1),nn[tn.AddNotificationMessageAsync]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,a,l,f,p,g,h,v,b;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(l=!1,f=Object(s.c)(e),p=f.mode,3===n.type&&!n.actions)return o(d(u.a.InvalidParameterValueError)),[2];if(3===n.type&&n.actions)switch(l=!0,g=Object(m.n)(t),h=g.extension.Id,p){case S.a.MessageRead:case S.a.AppointmentAttendee:return o(d(u.a.OperationNotSupported)),[2];case S.a.MessageCompose:case S.a.AppointmentOrganizer:if(!(i=M(h,n.actions[0].commandId,p)))return o(d(u.a.InvalidParameterValueError)),[2];a={NotificationActionData:n.actions[0],CustomButtonAction:i,CustomButtonIcon:i.get_Size16Icon()}}return[4,y(e,t,n.persistent,n.key,n.type,n.message,n.icon,!0,a)];case 1:return v=r.sent(),b=Object(m.n)(t),Object(R.o)("ShowNotificationBar",{Id:b.extension.Id,DisplayName:b.extension.DisplayName,Scenario:Object(m.z)(e),extPoint:Object(m.r)(t),IsClickableInfobar:l,error:v instanceof c.a?JSON.stringify(v):"",mode:p}),o(v),[2]}}))}))}),1),nn[tn.GetAllNotificationMessagesAsync]=new on((function(e,t,n,o){o(l(Object(s.c)(e).getNotificationMessageIds().reduce((function(e,t){var n=Object(g.e)(t);return n&&e.push(function(e){return Object(r.__assign)({key:e.Key,type:v(e.Type),message:e.Message,icon:e.Icon},e.Persistent&&{persistent:!0})}(n)),e}),[])))}),1),nn[tn.RemoveNotificationMessageAsync]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,h(e,t,n.key)];case 1:return i=r.sent(),o(i),[2]}}))}))}),1),nn[tn.ReplaceNotificationMessageAsync]=new on((function(e,t,n,o){var i,a;return Object(r.__awaiter)(this,void 0,void 0,(function(){var l,f,p,g,h,v,b,_,C;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(p=!1,g=Object(s.c)(e),h=g.mode,3===n.type&&!n.actions)return o(d(u.a.InvalidParameterValueError)),[2];if(3===n.type&&n.actions)switch(p=!0,v=Object(m.n)(t),b=v.extension.Id,h){case S.a.MessageRead:case S.a.AppointmentAttendee:return o(d(u.a.OperationNotSupported)),[2];case S.a.MessageCompose:case S.a.AppointmentOrganizer:if(!(l=M(b,n.actions[0].commandId,h)))return o(d(u.a.InvalidParameterValueError)),[2];f={NotificationActionData:n.actions[0],CustomButtonAction:l,CustomButtonIcon:l.get_Size16Icon()}}return[4,y(e,t,n.persistent,n.key,n.type,n.message,n.icon,!1,f)];case 1:return _=r.sent(),C=Object(m.n)(t),Object(R.o)("ShowNotificationBar",{Id:null===(i=null==C?void 0:C.extension)||void 0===i?void 0:i.Id,DisplayName:null===(a=null==C?void 0:C.extension)||void 0===a?void 0:a.DisplayName,Scenario:Object(m.z)(e),extPoint:Object(m.r)(t),IsClickableInfobar:p,error:_ instanceof c.a?JSON.stringify(_):"",mode:h}),o(_),[2]}}))}))}),1),nn[tn.AddItemAttachmentAsync]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:t=Object(s.c)(e),r.label=1;case 1:return r.trys.push([1,3,,4]),f(t,o)?[2]:[4,t.addItemAttachment(n.name,n.itemId,n.isInline)];case 2:return i=r.sent(),o(i?l(i):d(u.a.AttachmentUploadGeneralFailure)),[3,4];case 3:return a=r.sent(),o(d(a)),[3,4];case 4:return[2]}}))}))}),3),nn[tn.AddFileAttachmentAsync]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:t=Object(s.c)(e),r.label=1;case 1:return r.trys.push([1,3,,4]),f(t,o)?[2]:[4,t.addFileAttachment(n.name,n.uri,n.isInline)];case 2:return i=r.sent(),o(i?l(i):d(u.a.AttachmentUploadGeneralFailure)),[3,4];case 3:return a=r.sent(),o(d(a.errorCode)),[3,4];case 4:return[2]}}))}))}),3),nn[tn.AddBase64FileAttachmentAsync]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:t=Object(s.c)(e),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,t.addFileAttachmentFromBase64(n.base64String,n.name,n.isInline)];case 2:return i=r.sent(),o(i?l(i):d(u.a.AttachmentUploadGeneralFailure)),[3,4];case 3:return a=r.sent(),o(d(a.errorCode)),[3,4];case 4:return[2]}}))}))}),3),nn[tn.RemoveAttachmentAsync]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(!n||!n.attachmentIndex)return o(d(u.a.InvalidAttachmentId)),[2];r.label=1;case 1:return r.trys.push([1,3,,4]),f(t=Object(s.c)(e),o)?[2]:[4,t.removeAttachment(n.attachmentIndex)];case 2:return r.sent(),o(l()),[3,4];case 3:return i=r.sent(),o(d(i.errorCode)),[3,4];case 4:return[2]}}))}))}),3),nn[tn.GetCategoriesAsync]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,a,c;return Object(r.__generator)(this,(function(f){switch(f.label){case 0:t=Object(s.c)(e),n=t.mode,i=null,a=null,f.label=1;case 1:switch(f.trys.push([1,11,,12]),n){case S.a.MessageRead:return[3,2];case S.a.MessageCompose:return[3,4];case S.a.AppointmentAttendee:return[3,5];case S.a.AppointmentOrganizer:return[3,7]}return[3,9];case 2:return[4,t.getCategoriesItem()];case 3:return i=f.sent(),[3,10];case 4:return o(d(u.b.OperationNotSupported)),[2];case 5:return[4,t.getCategoriesItem()];case 6:return i=f.sent(),[3,10];case 7:return[4,t.getCategoriesItem()];case 8:return i=f.sent(),[3,10];case 9:Object(E.a)(n),f.label=10;case 10:return null==i?(o(d(u.b.GenericResponseError)),[2]):(a=function(e){var t,n,o=[];try{for(var i=Object(r.__values)(e),a=i.next();!a.done;a=i.next()){var s=a.value,c={displayName:s.Name,color:P.a[s.Color]};o.push(c)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return o}(i),o(l(a)),[3,12]);case 11:return c=f.sent(),o(d(c.errorCode)),[3,12];case 12:return[2]}}))}))}),1),nn[tn.AddCategoriesAsync]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i,a,c,f,p;return Object(r.__generator)(this,(function(m){switch(m.label){case 0:return t=Object(s.c)(e),i=t.mode,[4,A.t.import()];case 1:if(a=m.sent(),c=a(),function(e,t){var n,o,i=function(e){if(0===t.filter((function(t){return t.Name===e})).length)return{value:!0}};try{for(var a=Object(r.__values)(e),s=a.next();!s.done;s=a.next()){var c=s.value,u=i(c);if("object"==typeof u)return u.value}}catch(e){n={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(n)throw n.error}}return!1}(n.categories,c)||x(n.categories))return o(d(u.a.InvalidCategoryError)),[2];g=n.categories,h=[],g.forEach((function(e){var t,n,o=!1;try{for(var i=Object(r.__values)(h),a=i.next();!a.done;a=i.next())a.value===e&&(o=!0)}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}o||h.push(e)})),f=h,m.label=2;case 2:switch(m.trys.push([2,12,,13]),i){case S.a.MessageRead:return[3,3];case S.a.MessageCompose:return[3,5];case S.a.AppointmentAttendee:return[3,6];case S.a.AppointmentOrganizer:return[3,8]}return[3,10];case 3:return[4,t.addCategoriesItemRead(f)];case 4:return m.sent(),[3,11];case 5:return o(d(u.a.OperationNotSupported)),[2];case 6:return[4,t.addCategoriesItemRead(f)];case 7:return m.sent(),[3,11];case 8:return[4,t.addCategoriesItemCompose(f)];case 9:return m.sent(),[3,11];case 10:Object(E.a)(i),m.label=11;case 11:return o(l()),[3,13];case 12:return p=m.sent(),o(d(p.errorCode)),[3,13];case 13:return[2]}var g,h}))}))}),1),nn[tn.RemoveCategoriesAsync]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(t=Object(s.c)(e),i=t.mode,x(n.categories))return o(d(u.a.InvalidCategoryError)),[2];r.label=1;case 1:switch(r.trys.push([1,11,,12]),i){case S.a.MessageRead:return[3,2];case S.a.MessageCompose:return[3,4];case S.a.AppointmentAttendee:return[3,5];case S.a.AppointmentOrganizer:return[3,7]}return[3,9];case 2:return[4,t.removeCategoriesItemRead(n.categories)];case 3:return r.sent(),[3,10];case 4:return o(d(u.a.OperationNotSupported)),[2];case 5:return[4,t.removeCategoriesItemRead(n.categories)];case 6:return r.sent(),[3,10];case 7:return[4,t.removeCategoriesItemCompose(n.categories)];case 8:return r.sent(),[3,10];case 9:Object(E.a)(i),r.label=10;case 10:return o(l()),[3,12];case 11:return a=r.sent(),o(d(a.errorCode)),[3,12];case 12:return[2]}}))}))}),1),nn[tn.GetAttachmentContentAsync]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i,a,c,f;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(!n||!n.id)return o(d(u.a.InvalidAttachmentId)),[2];if(t=null,i=Object(s.c)(e),a=i.mode,!1,(c=Object(Ze.a)({Id:n.id})).model.__type===Ye&&(f=c.model.EmbeddedItemClass)&&"IPM.Note"!==f&&"IPM.Appointment"!==f)return o(d(u.a.AttachmentTypeNotSupported)),[2];switch(a){case S.a.MessageRead:return[3,1];case S.a.MessageCompose:return[3,3];case S.a.AppointmentAttendee:return[3,5];case S.a.AppointmentOrganizer:return[3,7]}return[3,9];case 1:return[4,$e(!0,i,n.id)];case 2:return t=r.sent(),[3,10];case 3:return[4,i.getAttachmentContent(n.id)];case 4:return t=r.sent(),[3,10];case 5:return[4,$e(!1,i,n.id)];case 6:return t=r.sent(),[3,10];case 7:return[4,i.getAttachmentContent(n.id)];case 8:return t=r.sent(),[3,10];case 9:Object(Qe.a)(a),r.label=10;case 10:if(null==t)return o(d(u.a.InvalidAttachmentId)),[2];try{o(l(t))}catch(e){o(d(u.a.InvalidAttachmentId))}return[2]}}))}))}),1),nn[tn.GetAttachmentsAsync]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:switch(t=Object(s.c)(e),n=null,i=[],t.mode){case S.a.MessageCompose:return[3,1];case S.a.AppointmentOrganizer:return[3,3]}return[3,5];case 1:return[4,t.getAttachments()];case 2:return n=r.sent(),[3,5];case 3:return[4,t.getAttachments()];case 4:return n=r.sent(),[3,5];case 5:if(null==n)return o(d(u.a.GenericResponseError)),[2];i=n.map((function(e){return{id:e.id,name:e.name,contentType:e.contentType,size:e.size,attachmentType:e.attachmentType,isInline:e.isInline,url:e.url?e.url:void 0}}));try{o(l(i))}catch(e){o(d(e.errorCode))}return[2]}}))}))}),1),nn[tn.RegisterConsentAsync]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,a,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(i=n.consentState,!(a=Object(m.u)(t))||!i)return o(d(u.b.GenericResponseError)),[2];r.label=1;case 1:return r.trys.push([1,3,,4]),Object(m.eb)(e,t,i),[4,Qt(a,i)];case 2:return"NoError"===(s=r.sent()).Body.ResponseCode&&"Success"===s.Body.ResponseClass?(o(l()),[2]):(o(d(u.b.GenericResponseError)),[3,4]);case 3:return r.sent(),o(d(u.b.GenericResponseError)),[3,4];case 4:return[2]}}))}))}),0),nn[tn.GetLocationAsync]=new on((function(e,t,n,r){r(l(Object(s.c)(e).getLocation()||""))}),1),nn[tn.SetLocationAsync]=new on((function(e,t,n,r){if(null!=n.location){var o=Object(s.c)(e);f(o,r)||(o.setLocation(n.location),r(l()))}else r(d(null))}),3),nn[tn.GetTimeAsync]=new on((function(e,t,n,r){var o=Object(s.c)(e),i=null;n.TimeProperty===Vt.Start?i=o.getStartTime():n.TimeProperty===Vt.End&&(i=o.getEndTime()),r(l(i))}),1),nn[tn.SetTimeAsync]=new on((function(e,t,n,r){var o=Object(s.c)(e);if(!f(o,r)){var i=new Date(n.time);if(n.TimeProperty===Vt.Start)o.setStartTime(i);else if(n.TimeProperty===Vt.End){if(!o.setEndTime(i))return void r(d(u.a.InvalidEndTime))}r(l())}}),3),nn[tn.GetInitializationContextAsync]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(i){return t=Object(m.t)().taskPanes,n="",Object(r.__spread)(t.values()).forEach((function(t){t.hostItemIndex===e&&t.initializationContext&&(n=t.initializationContext)})),o(null!=n&&null!=n?l(n):d()),[2]}))}))}),1),nn[tn.GetFromAsync]=new on((function(e,t,n,r){var o=Object(s.c)(e).getFrom();r(o?l({name:o.Name,address:o.EmailAddress}):d())}),1),nn[tn.GetSharedPropertiesAsync]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,a,c,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(t=Object(s.c)(e),n=t.getSharedProperties(),!t.isRemoteItem())return[3,5];a=n.owner,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,(d=n.owner,new Promise((function(e,t){if(d){var n="https://outlook.office365.com/autodiscover/autodiscover.json/v1.0/"+d+"?Protocol=REST",r=new XMLHttpRequest;r.open("GET",n),r.onload=function(){if(200===r.status){var n=JSON.parse(this.response).Url;e(n)}else t(new Error("Request failed with status "+r.status+". Message: "+r.responseText))},r.send()}else t(new Error("smtpAddress is null or empty"))})))];case 2:return i=r.sent(),[3,4];case 3:return r.sent(),i=void 0,[3,4];case 4:return[3,6];case 5:a=Object(jt.m)(),i=Object(m.s)().RestUrl,r.label=6;case 6:return c=function(e){var t=0;e.Read&&(t+=T.c.Read);e.Create&&(t+=T.c.Create);e.DeleteOwn&&(t+=T.c.DeleteOwn);e.DeleteAll&&(t+=T.c.DeleteAll);e.EditOwn&&(t+=T.c.EditOwn);e.EditAll&&(t+=T.c.EditAll);return t}(n.delegatePermissions),u={delegatePermissions:c,owner:n.owner,targetRestUrl:i,targetMailbox:a},o(l(u)),[2]}var d}))}))}),1),nn[tn.GetRecurrenceAsync]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,(t=Object(s.c)(e)).getRecurrence()];case 1:return n=r.sent(),i=Object(It.a)({recurrenceType:n,timeZone:t.getTimeZoneName(),endTime:t.getEndTime(),startTime:t.getStartTime()}),o(l(i)),[2]}}))}))}),1),nn[tn.SetRecurrenceAsync]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(It.c)(n.recurrenceData)?f(t=Object(s.c)(e),o)?[2]:[4,t.getSeriesId()]:(o(d(u.a.InvalidRecurrence)),[2]);case 1:return null!=r.sent()?(o(d(u.a.SetRecurrenceOnInstance)),[2]):(null==(i=Object(It.b)(n.recurrenceData))?t.setRecurrence(null):(t.setStartTime(i.startTime),t.setEndTime(i.endTime),t.setRecurrence(i.recurrenceType),t.setTimeZoneName(i.timeZone)),o(l()),[2])}}))}))}),3),nn[tn.GetInternetHeadersAsync]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n&&Object(T.j)(n.internetHeaderKeys)?[4,Object(s.c)(e).getInternetHeaders(n.internetHeaderKeys)]:(o(d()),[2]);case 1:return t=r.sent(),o(l(t)),[2]}}))}))}),1),nn[tn.SetInternetHeadersAsync]=new on((function(e,t,n,r){if(n&&Object(T.i)(n.internetHeaderNameValuePairs)){var o=Object(s.c)(e);f(o,r)||(o.setInternetHeaders(n.internetHeaderNameValuePairs),r(l()))}else r(d())}),1),nn[tn.RemoveInternetHeadersAsync]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n&&Object(T.j)(n.internetHeaderKeys)?f(t=Object(s.c)(e),o)?[2]:[4,t.removeInternetHeaders(n.internetHeaderKeys)]:(o(d()),[2]);case 1:return r.sent(),o(l()),[2]}}))}))}),1),nn[tn.AppendOnSendAsync]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,a,c,l,p,g;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return null!=(i=Object(m.n)(t))&&i.extension?(i.extension.ExtendedPermissions?i.extension.ExtendedPermissions.map((function(e){return e.toLowerCase()})):[]).indexOf("appendonsend")<=-1?(o(d(u.a.MissingExtendedPermissionsForAPIError)),[2]):(a=Object(s.c)(e),c=a.mode,Object(ae.h)("rp-appendOnSend")&&c!=S.a.MessageRead&&c!=S.a.AppointmentAttendee?(l=n.appendTxt)&&l.length>se?(o(d(u.a.OoeInvalidDataFormat)),[2]):f(a,o)?[2]:n.coercionType===hn.a.Html&&"Text"===a.getBodyType()?(o(d(u.a.OoeInvalidDataFormat)),[2]):null==(p=Object(m.u)(t))||Object(ie.a)(p,t)?(o(d(u.a.GenericResponseError)),[2]):(g={id:p,typ:n.coercionType,txt:l},n.appendOnSend=g,[4,oe(e,0,n,o,a.appendOnSend)]):(o(d(u.a.OperationNotSupported)),[2])):(o(d(u.a.GenericResponseError)),[2]);case 1:return r.sent(),[2]}}))}))}),3),nn[tn.GetEnhancedLocationsAsync]=new on((function(e,t,n,r){var o=Object(s.c)(e).getEnhancedLocations();!o||o.length<=0?r(l([])):r(l(o.map(T.h)))}),1),nn[tn.AddEnhancedLocationsAsync]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(f(t=Object(s.c)(e),o))return[2];if(!n||!Object(T.k)(n.enhancedLocations))return o(d()),[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,t.addEnhancedLocations(n.enhancedLocations)];case 2:return r.sent(),o(l()),[3,4];case 3:return r.sent(),o(d()),[3,4];case 4:return[2]}}))}))}),3),nn[tn.RemoveEnhancedLocationsAsync]=new on((function(e,t,n,r){var o=Object(s.c)(e);n&&Object(T.k)(n.enhancedLocations)?(o.removeEnhancedLocations(n.enhancedLocations),r(l())):r(d())}),3),nn[tn.GetMasterCategoriesAsync]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,a,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:t=Object(s.c)(e),n=t.mode,i=[],a=null,r.label=1;case 1:switch(r.trys.push([1,8,,9]),n){case S.a.MessageRead:case S.a.MessageCompose:return[3,2];case S.a.AppointmentAttendee:case S.a.AppointmentOrganizer:return[3,4]}return[3,6];case 2:return[4,t.getCategoriesMailbox()];case 3:return i=r.sent(),[3,7];case 4:return[4,t.getCategoriesMailbox()];case 5:return i=r.sent(),[3,7];case 6:Object(E.a)(n),r.label=7;case 7:return null==i||null==i?(o(d(u.b.GenericResponseError)),[2]):(a=i.map((function(e){return{displayName:e.Name,color:P.a[e.Color]}})),o(l(a)),[3,9]);case 8:return c=r.sent(),o(d(c.errorCode)),[3,9];case 9:return[2]}}))}))}),2),nn[tn.AddMasterCategoriesAsync]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i,a,c,f;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),(t=Object(s.c)(e)).isSharedItem()?(o(d(u.b.InsufficientItemPermissions)),[2]):([],i=n.categoryDetails.map((function(e){return{Name:e.displayName,Id:Object(w.a)(),Color:P.a[e.color]}})),(a=function(e,t){var n=[];return e.forEach((function(e){var t=e.Name.length;if(0===t||t>255)return null;for(var r=!1,o=0;o<n.length;o++)n[o].Name==e.Name&&(n[o].Color=e.Color,r=!0);r||n.push(e)})),n}(i))?function(e){for(var t=Object(A.n)(),n=function(n){if(t.filter((function(t){return t.Name===e[n].Name})).length>0)return{value:!0}},r=0;r<e.length;r++){var o=n(r);if("object"==typeof o)return o.value}return!1}(a)?(o(d(u.b.DuplicateCategoryError)),[2]):[4,t.addCategoriesMailbox(a)]:(o(d(u.b.InvalidCategoryError)),[2]));case 1:return c=r.sent(),o(c?l():d(u.b.GenericResponseError)),[3,3];case 2:return f=r.sent(),o(d(f.errorCode)),[3,3];case 3:return[2]}}))}))}),2),nn[tn.RemoveMasterCategoriesAsync]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i,a,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(r.trys.push([0,2,,3]),(t=Object(s.c)(e)).isSharedItem())return o(d(u.b.InsufficientItemPermissions)),[2];for(i=0;i<n.categories.length;i++)if(0===(a=n.categories[i].length)||a>255)return o(d(u.b.InvalidCategoryError)),[2];return[4,t.removeCategoriesMailbox(n.categories)];case 1:return c=r.sent(),o(c?l():d(u.b.GenericResponseError)),[3,3];case 2:return r.sent(),o(d()),[3,3];case 3:return[2]}}))}))}),2),nn[tn.GetItemIdAsync]=new on((function(e,t,n,r){var o=Object(s.c)(e).getItemId();r(o?l(o):d(u.a.ItemNotSavedError))}),1),nn[tn.GetAllInternetHeadersAsync]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(s.c)(e).getAllInternetHeaders()];case 1:return t=n.sent(),o(null==t?d(u.a.GenericResponseError):l(t)),[2]}}))}))}),1),nn[tn.SetSignatureAsync]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(ae.h)("addin-signatureScenario")?n.data.length>3e4?(o(d(u.a.OoeInvalidDataFormat)),[2]):(t=Object(s.c)(e),n.coercionType===hn.a.Html&&"Text"===t.getBodyType()?(o(d(u.a.OoeInvalidDataFormat)),[2]):f(t,o)?[2]:t.mode!==S.a.MessageCompose?(o(d(J.OperationNotSupported)),[2]):[4,oe(e,0,n,o,(function(e){return t.setSignature(e)}))]):(o(d(u.a.OperationNotSupported)),[2]);case 1:return r.sent(),[2]}}))}))}),3),nn[tn.GetComposeTypeAsync]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){if(!Object(ae.h)("addin-signatureScenario"))return o(d(u.b.OperationNotSupported)),[2];t=Object(s.c)(e),n=t.mode;try{if(n!==S.a.MessageCompose)return o(d(u.b.OperationNotSupported)),[2];void 0,i=t.getComposeTypeAndCoercionType(),o(l(i))}catch(e){o(d(e.errorCode))}return[2]}))}))}),1),nn[tn.IsClientSignatureEnabledAsync]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){if(!Object(ae.h)("addin-signatureScenario"))return o(d(u.b.OperationNotSupported)),[2];t=Object(s.c)(e),n=t.mode;try{if(n!==S.a.MessageCompose)return o(d(u.b.OperationNotSupported)),[2];void 0,i=t.isClientSignatureEnabled(),o(l(i))}catch(e){o(d(e.errorCode))}return[2]}))}))}),1),nn[tn.DisableClientSignatureAsync]=new on((function(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(!Object(ae.h)("addin-signatureScenario"))return o(d(u.b.OperationNotSupported)),[2];t=Object(s.c)(e),n=t.mode,r.label=1;case 1:return r.trys.push([1,5,,6]),n!==S.a.MessageCompose?[3,3]:(i=void 0,[4,t.disableClientSignature()]);case 2:return i=r.sent(),o(l(i)),[2];case 3:return o(d(u.b.OperationNotSupported)),[2];case 4:return[3,6];case 5:return a=r.sent(),o(d(a.errorCode)),[3,6];case 6:return[2]}}))}))}),3),nn),sn=[tn.DisplayAppointmentForm,tn.DisplayMessageForm,tn.DisplayNewAppointmentForm,tn.DisplayNewMessageForm,tn.GetAccessTokenAsync,tn.MESSAGE_PARENT_DISPID];var cn=n(5617);function un(e,t,n,r,o){if(an[t]&&an[t].apiMethodDelegate){var i=an[t].apiMethodDelegate,a=Object(m.n)(n),s="ExecuteApiMethod";if(!C(e))return Object(R.o)("ExtExecuteApiMethodNoItemFailure",[t]),void o(d(u.b.GenericResponseError));if(!function(e,t){var n,r=Object(m.n)(e),o=!1,i=null===(n=null==r?void 0:r.extension)||void 0===n?void 0:n.RequestedCapabilities;switch(t){case 0:o=!0;break;case 1:1!=i&&3!=i&&2!=i||(o=!0);break;case 3:3!=i&&2!=i||(o=!0);break;case 2:2==i&&(o=!0)}return o}(n,an[t].apiPermissionRequired))return Object(R.o)("ExtExecuteApiMethodInsufficientPermissions",[t]),void o(d(u.b.InsufficientItemPermissions));var c=function(e,t){var n=Object(m.n)(e),r=Object(m.J)(n),o=sn.includes(t);return!(!r||!o)}(n,t);if(Object(ae.h)("addin-autoRun")&&c)return Object(R.o)("ExtExecuteApiMethodNotSupportedInAutorun",[t]),void o(d(u.b.ApiCallNotSupportedByExtensionPoint));var l=Object(cn.a)();try{i(e,n,r,(function(r){var i=null;r&&(r.errorCode?i=r.errorCode:r.Error&&(i=r.Error));var c=Object(cn.a)();Object(R.o)(s,{dispId:t,Id:a.extension.Id,DisplayName:a.extension.DisplayName,owa_1:Object(kt.e)(),owa_2:Object(m.z)(e),extPoint:Object(m.r)(n),owa_4:a.extension.Type,apiExecutionTime:c-l,isAutoRun:Object(m.J)(a),errorCode:i}),o(r)}))}catch(r){var f=Object(cn.a)();Object(R.o)(s,{dispId:t,Id:a.extension.Id,DisplayName:a.extension.DisplayName,owa_1:Object(kt.e)(),owa_2:Object(m.z)(e),extPoint:Object(m.r)(n),owa_4:a.extension.Type,apiExecutionTime:f-l,isAutoRun:Object(m.J)(a),error:JSON.stringify(r)}),o(d(u.b.InternalServerError))}}}function ln(e,t){var n;return void 0===e.request||e.request.__type||(e.request=(n=e.request,Object(r.__assign)({__type:"GetExtensibilityContextParameters:#Exchange"},n))),Object(L.a)("GetExtensibilityContext",e,t)}function dn(e,t,n,r,o){return ln({request:{FormFactor:e,ClientLanguage:t,IncludeDisabledExtensions:n,ApiVersionSupported:r,ClientOverrideVersion:o}})}function fn(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"GetAllClientExtensionsNotificationsJsonRequest:#Exchange"},n)),Object(L.a)("GetAllClientExtensionsNotifications",e,t)}function pn(e){var t,n=(t={ItemId:e},Object(r.__assign)({__type:"GetAllClientExtensionsNotificationsRequest:#Exchange"},t));return fn({Header:Object(Ie.a)(),Body:n})}function mn(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(s.c)(e),n={Id:t.getItemId()},t.addNotificationMessage?(Object(g.c)(e).map(t.addNotificationMessage),[4,pn(n).catch(gn)]):[2];case 1:return(i=r.sent())&&(i.Body.Apps||[]).forEach((function(n){var r=!1;n.Notifications.forEach((function(i){var a={ExtensionId:n.Id,Persistent:!0,Key:i.Key,Type:i.Type,Message:i.Message,Icon:i.Icon};2===i.Type&&(a.Persistent=!1,r=!0);var s=o(e,n.Id,i.Key);Object(g.a)(e,n.Id,s,a),t.addNotificationMessage(s)})),r&&Object(a.a)(e,n.Id)})),[2]}}))}))}function gn(){return null}var hn=n(3593);n.d(t,"c",(function(){return y})),n.d(t,"e",(function(){return b})),n.d(t,"d",(function(){return _})),n.d(t,"f",(function(){return g.b})),n.d(t,"g",(function(){return C})),n.d(t,"h",(function(){return O})),n.d(t,"i",(function(){return un})),n.d(t,"j",(function(){return St})),n.d(t,"k",(function(){return dn})),n.d(t,"l",(function(){return mn})),n.d(t,"m",(function(){return h})),n.d(t,"b",(function(){return Ut})),n.d(t,"a",(function(){return hn.a}))},3254:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return u}));var r=n(2661),o=n(1193),i=n(283),a=Object(i.select)({conversationReadingPaneState:function(){return Object(o.a)()}})((function(e){var t;return(null===(t=e.conversationReadingPaneState)||void 0===t?void 0:t.focusedItemPart)?e.conversationReadingPaneState.focusedItemPart.itemPart:null})),s=Object(i.select)({conversationReadingPaneState:function(){return Object(o.a)()}})((function(e){var t;return(null===(t=e.conversationReadingPaneState)||void 0===t?void 0:t.focusedItemPart)?e.conversationReadingPaneState.focusedItemPart.focusedItemArea:null})),c=Object(i.select)({conversationReadingPaneState:function(){return Object(o.a)()}})((function(e){var t;return(null===(t=e.conversationReadingPaneState)||void 0===t?void 0:t.initiallySelectedItemPart)?e.conversationReadingPaneState.initiallySelectedItemPart.itemPart:null})),u=Object(i.select)({conversationReadingPaneState:function(){return Object(o.a)()}})((function(e,t){var n=a(t),o=s(t);return n==e&&o==r.a.Item}))},3256:function(e,t,n){"use strict";function r(e){throw new Error("Unexpected object: "+e)}n.d(t,"a",(function(){return r}))},3261:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),o=n(76),i=n(1545),a=n(960),s=n(483);function c(e,t,n,c){var u=Object(s.e)(n,e,null,t),l=Object(r.__assign)(Object(r.__assign)({},c),{includeFluidOnPopout:Object(a.d)(a.a.Bohemia).bohemiaEnabled&&Object(o.h)("cmp-prague")&&Object(i.a)()});Object(s.c)("mail",u,l,{resizable:!0})}},338:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n(241),o=null,i=3e4;function a(){return null==o&&(o=new r.Cache),o}function s(e){return a().get(e)}function c(e){return a().del(e)}function u(e,t){a().put(e,t,i)}},3385:function(e,t,n){"use strict";var r=n(283);t.a=Object(r.action)("setIsDirty")((function(e,t){e.isDirty=t}))},339:function(e,t,n){"use strict";var r,o;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),function(e){e[e.xSmall=0]="xSmall",e[e.small=1]="small",e[e.medium=2]="medium",e[e.large=3]="large"}(r||(r={})),function(e){e[e.normal=0]="normal",e[e.large=1]="large"}(o||(o={}))},3468:function(e,t,n){"use strict";var r=n(76);function o(){return Object(r.h)("addin-inClientStoreEnabled")}function i(){return Object(r.h)("addin-persistentTaskPane")}function a(){return Object(r.h)("addin-complianceVerification")}n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a}))},347:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(230);function o(e,t){return e&&e!==document.body?t(e)?e:o(Object(r.a)(e),t):null}},348:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(376),o=n(4),i=n(423),a=n(3),s={state:r.a.NotStarted,isPopoutV2:Object(a.a)(i.a)==i.b},c=Object(o.createStore)("popoutChild",s);c()},349:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var r,o={};function i(e,t){o[e]||(o[e]=[]),o[e].push(t)}function a(e,t){if(o[e]){var n=o[e].indexOf(t);n>=0&&(o[e].splice(n,1),0===o[e].length&&delete o[e])}}function s(e){o[e]&&o[e].forEach((function(e){return e()}))}function c(){return r}},3505:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r=n(108),o=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(280)]).then(n.bind(null,5500))})),i=new r.a(o,(function(e){return e.mountAndShowFlexPane})),a=new r.a(o,(function(e){return e.hideFlexPane}))},3508:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(25),o=n(1956);function i(e,t){return void 0===e||e.__type||(e=Object(o.a)(e)),Object(r.a)("CreateItem",e,t)}},3510:function(e,t,n){"use strict";n.d(t,"a",(function(){return y})),n.d(t,"c",(function(){return b})),n.d(t,"b",(function(){return _}));var r=n(2),o=n(288),i=n(242),a="resources/images/surfaceActions",s=a+"/attach.svg",c=a+"/attachDark.svg",u=a+"/inlineimage.svg",l=a+"/inlineimageDark.svg",d=a+"/emoji.svg",f=a+"/fluid.svg",p=a+"/showribbon.svg",m=a+"/showribbonDark.svg",g=a+"/dictate.svg",h=a+"/dictationLanguage.svg",v=a+"/spelling.svg";function y(e){var t,n,a=!1;switch(e){case"AddAttachment":t=Object(o.resolve)(Object(r.u)(),Object(i.c)()?c:s),n=Object(o.resolve)(Object(r.u)(),s),a=!0;break;case"AddInlineImage":t=Object(o.resolve)(Object(r.u)(),Object(i.c)()?l:u),n=Object(o.resolve)(Object(r.u)(),u),a=!0;break;case"AddEmoji":t=Object(o.resolve)(Object(r.u)(),d),a=!0;break;case"ToggleDarkCompose":t="Sunny";break;case"FluidHeroButton":t=Object(o.resolve)(Object(r.u)(),f),a=!0;break;case"QuickUse":t="ClipboardList";break;case"ToggleDictation":t=Object(o.resolve)(Object(r.u)(),g),a=!0;break;case"SetDictationLanguage":t=Object(o.resolve)(Object(r.u)(),h),a=!0;break;case"ToggleRibbon":t=Object(o.resolve)(Object(r.u)(),Object(i.c)()?m:p),n=Object(o.resolve)(Object(r.u)(),p),a=!0;break;case"SensitivityMenu":t="MarkAsProtected";break;case"ProtectMessage":t="Encryption";break;case"SaveDraft":t="Save";break;case"InsertSignature":t="InsertSignatureLine";break;case"ShowFrom":t="ArrangeByFrom";break;case"SetImportance":t="Important";break;case"ShowMessageOptions":t="MailOptions";break;case"SwitchBodyType":t="PlainText";break;case"AccChecker":t="AccessibiltyChecker";break;case"ProofingOptions":t=Object(o.resolve)(Object(r.u)(),v),a=!0;break;default:t=""}return{iconName:t,fallbackIconName:n||t,isImage:a}}function b(e){var t;switch(e){case"-":t="-";break;case"Reply":t="Reply";break;case"ReplyAll":t="ReplyAll";break;case"Forward":t="Forward";break;case"ReplyByMeeting":t="Calendar";break;case"ReportAbuse":t="ReportHacked";break;case"Delete":t="Delete";break;case"MarkReadUnread":t="Mail";break;case"FlagUnflag":t="Flag";break;case"AssignPolicy":t="Assign";break;case"AddToSafeSenders":t="AddFriend";break;case"MarkJunkNotJunk":t="MailAlert";break;case"MarkAsPhishing":t="Phishing";break;case"Block":t="BlockContact";break;case"CreateRule":t="CreateMailRule";break;case"Print":t="Print";break;case"Translate":t="LocaleLanguage";break;case"ShowInImmersiveReader":t="ReadOutLoud";break;case"ViewMessageSource":t="OpenSource";break;case"Popout":t="OpenInNewWindow";break;case"LikeUnlike":t="Like";break;case"ToggleDarkMode":t="Sunny";break;case"ReplyByIM":case"ReplyAllByIM":t="ChatInviteFriend";break;case"ToggleAmp":t="LightningBolt";break;case"AddToProjectSpace":t="NotePinned";break;default:t=""}return{iconName:t,fallbackIconName:t,isImage:!1}}function _(e){var t;switch(e){case"-":t="-";break;case"Delete":t="Delete";break;case"Archive":t="Archive";break;case"PinUnpin":t="Pinned";break;case"ReadUnread":t="Mail";break;case"FlagUnflag":t="Flag";break;case"Move":t="FabricFolder";break;default:t=""}return{iconName:t,fallbackIconName:t,isImage:!1}}},3511:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(27),o=n(295),i=n(76);function a(){return Object(o.a)()?Object(i.h)("cmp-encryption")&&Object(r.a)().SessionSettings.IsPremiumConsumerMailbox:Object(r.a)().SegmentationSettings.Irm}},3512:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=-1]="None",e[e.Preset0=0]="Preset0",e[e.Preset1=1]="Preset1",e[e.Preset2=2]="Preset2",e[e.Preset3=3]="Preset3",e[e.Preset4=4]="Preset4",e[e.Preset5=5]="Preset5",e[e.Preset6=6]="Preset6",e[e.Preset7=7]="Preset7",e[e.Preset8=8]="Preset8",e[e.Preset9=9]="Preset9",e[e.Preset10=10]="Preset10",e[e.Preset11=11]="Preset11",e[e.Preset12=12]="Preset12",e[e.Preset13=13]="Preset13",e[e.Preset14=14]="Preset14",e[e.Preset15=15]="Preset15",e[e.Preset16=16]="Preset16",e[e.Preset17=17]="Preset17",e[e.Preset18=18]="Preset18",e[e.Preset19=19]="Preset19",e[e.Preset20=20]="Preset20",e[e.Preset21=21]="Preset21",e[e.Preset22=22]="Preset22",e[e.Preset23=23]="Preset23",e[e.Preset24=24]="Preset24"}(r||(r={}))},3515:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}));var r=n(108),o=new r.c((function(){return Promise.all([n.e(19),n.e(344)]).then(n.bind(null,5499))})),i=new r.b(o,(function(e){return e.processInlineImageBeforeUpload})),a=new r.b(o,(function(e){return e.setOriginalSrcForSmime})),s=new r.b(o,(function(e){return e.getExpirableImageBase64Src})),c=new r.b(o,(function(e){return e.onImageError}))},3528:function(e,t,n){"use strict";function r(e){return void 0!==e.publicFolderId}n.d(t,"a",(function(){return r}))},353:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var r="data-portal-element";function o(e){e.setAttribute(r,"true")}},356:function(e,t,n){"use strict";function r(e,t,n,r){return e.addEventListener(t,n,r),function(){return e.removeEventListener(t,n,r)}}n.d(t,"a",(function(){return r}))},357:function(e,t,n){"use strict";function r(e,t,n){}n.d(t,"a",(function(){return r}))},3593:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Text=0]="Text",e[e.Html=3]="Html"}(r||(r={}))},3646:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var r=n(6337);function o(e){var t,n,r;return e.isDirty||(null===(t=e.toRecipientWell)||void 0===t?void 0:t.isDirty)||(null===(n=e.ccRecipientWell)||void 0===n?void 0:n.isDirty)||(null===(r=e.bccRecipientWell)||void 0===r?void 0:r.isDirty)}function i(e){return Object(r.a)(e.toRecipientWell)+Object(r.a)(e.ccRecipientWell)+Object(r.a)(e.bccRecipientWell)}},3690:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"MAX_REGEX_MATCHES",(function(){return v})),n.d(r,"MAX_BODY_REGEX_ACTIVATION_LENGTH",(function(){return y})),n.d(r,"MAX_REGEX_MATCH_LENGTH",(function(){return b}));var o=n(1548),i=n(5139),a=n(4816),s=n(0),c=n(5503),u=n(1013),l=n(3218),d=function(){function e(e){this.collectionRule=e}return e.prototype.Evaluate=function(e,t){var n,r,o=this.GetInitialEvaluationResult();try{for(var i=Object(s.__values)(this.collectionRule.Rules),a=i.next();!a.done;a=i.next()){var c=I(a.value).Evaluate(e,t);o=this.UpdateEvaluationResult(o,c)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return o},e.prototype.ItemIsReadyForEvaluation=function(e){var t,n;try{for(var r=Object(s.__values)(this.collectionRule.Rules),o=r.next();!o.done;o=r.next()){if(!I(o.value).ItemIsReadyForEvaluation(e))return!1}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return!0},e.prototype.GetInitialEvaluationResult=function(){if("AND"==this.collectionRule.Mode.toUpperCase())return!0;if("OR"==this.collectionRule.Mode.toUpperCase())return!1;throw new Error("Invalid mode for a Collection rule: "+this.collectionRule.Mode)},e.prototype.UpdateEvaluationResult=function(e,t){return!("AND"==this.collectionRule.Mode.toUpperCase()&&!t)&&(!("OR"!=this.collectionRule.Mode.toUpperCase()||!t)||e)},e}(),f=function(){function e(){}return e.prototype.Evaluate=function(e,t){return!!e.HasAttachments},e.prototype.ItemIsReadyForEvaluation=function(e){return!0},e}(),p=n(316),m="MeetingString",g=function(){function e(e){this.itemHasKnownEntityRule=e}return e.prototype.Evaluate=function(e,t){if(!e.EntityExtractionResult)return!1;switch(this.itemHasKnownEntityRule.EntityType){case 3:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.Addresses,"Address");case 7:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.Contacts,"ContactString");case 6:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.EmailAddresses,"EmailAddress");case 1:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.MeetingSuggestions,m);case 5:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.PhoneNumbers,"OriginalPhoneString");case 2:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.TaskSuggestions,"TaskString");case 4:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.Urls,"Url");default:throw new Error("Unexpected known entity: "+this.itemHasKnownEntityRule.EntityType)}},e.prototype.EvaluateForEntityType=function(e,t,n,r){var o,i;if(!n)return!1;var a=[],c=!1,u=0;try{for(var l=Object(s.__values)(n),d=l.next();!d.done;d=l.next()){var f=d.value;if(this.EvaluateRegExForTerm(f[r])){c=!0,-1===t.evaluationResult.matchedKnownEntityTypes.indexOf(this.itemHasKnownEntityRule.EntityType)&&t.evaluationResult.matchedKnownEntityTypes.push(this.itemHasKnownEntityRule.EntityType),2!==this.itemHasKnownEntityRule.Highlight&&"Subject"!==f.Position&&(t.terms.push(h(f,r)),u++);var m=p({},f);a.push(m)}}}catch(e){o={error:e}}finally{try{d&&!d.done&&(i=l.return)&&i.call(l)}finally{if(o)throw o.error}}if(this.itemHasKnownEntityRule.FilterName&&this.itemHasKnownEntityRule.RegExFilter&&this.SaveRegexMatches(a,t.evaluationResult),u>0){var g=t.highlightableEntities[this.itemHasKnownEntityRule.EntityType];(!g||u>g)&&(t.highlightableEntities[this.itemHasKnownEntityRule.EntityType]=u)}return c},e.prototype.EvaluateRegExForTerm=function(e){var t=this.itemHasKnownEntityRule.IgnoreCase,n=this.itemHasKnownEntityRule.RegExFilter;if(!n)return!0;var r=Object(l.h)(e,n,t);return r&&r.length>0},e.prototype.ItemIsReadyForEvaluation=function(e){return!!e.EntityExtractionResult||!this.ItemHasEntityOnServer(e)},e.prototype.ItemHasEntityOnServer=function(e){if(!e.PropertyExistence)return!1;switch(this.itemHasKnownEntityRule.EntityType){case 3:return e.PropertyExistence.ExtractedAddresses;case 7:return e.PropertyExistence.ExtractedContacts;case 6:return e.PropertyExistence.ExtractedEmails;case 1:return e.PropertyExistence.ExtractedMeetings;case 5:return e.PropertyExistence.ExtractedPhones;case 2:return e.PropertyExistence.ExtractedTasks;case 4:return e.PropertyExistence.ExtractedUrls;default:return!1}},e.prototype.SaveRegexMatches=function(e,t){switch(this.itemHasKnownEntityRule.EntityType){case 3:t.filteredEntityMatches.Addresses||(t.filteredEntityMatches.Addresses={}),t.filteredEntityMatches.Addresses[this.itemHasKnownEntityRule.FilterName]=e;break;case 7:t.filteredEntityMatches.Contacts||(t.filteredEntityMatches.Contacts={}),t.filteredEntityMatches.Contacts[this.itemHasKnownEntityRule.FilterName]=e;break;case 6:t.filteredEntityMatches.EmailAddresses||(t.filteredEntityMatches.EmailAddresses={}),t.filteredEntityMatches.EmailAddresses[this.itemHasKnownEntityRule.FilterName]=e;break;case 1:t.filteredEntityMatches.MeetingSuggestions||(t.filteredEntityMatches.MeetingSuggestions={}),t.filteredEntityMatches.MeetingSuggestions[this.itemHasKnownEntityRule.FilterName]=e;break;case 5:t.filteredEntityMatches.PhoneNumbers||(t.filteredEntityMatches.PhoneNumbers={}),t.filteredEntityMatches.PhoneNumbers[this.itemHasKnownEntityRule.FilterName]=e;break;case 2:t.filteredEntityMatches.TaskSuggestions||(t.filteredEntityMatches.TaskSuggestions={}),t.filteredEntityMatches.TaskSuggestions[this.itemHasKnownEntityRule.FilterName]=e;break;case 4:t.filteredEntityMatches.Urls||(t.filteredEntityMatches.Urls={}),t.filteredEntityMatches.Urls[this.itemHasKnownEntityRule.FilterName]=e}},e}();function h(e,t){return t===m?function(e,t){var n=e[t];if(!e.TimeStringLength)return n;var r=n.slice(e.TimeStringBeginIndex,e.TimeStringBeginIndex+e.TimeStringLength),o=n.slice(e.TimeStringBeginIndex+e.TimeStringLength,n.length);if(0==o.length)return r;return r+"(?="+o+")"}(e,t):e[t]}var v=50,y=5e5,b=10240,_=n(314);function S(e){return 0===e.indexOf("ipm.note")||0===e.indexOf("ipm.schedule")||0===e.indexOf("ipm.sharing")}function C(e){return 0===e.indexOf("ipm.appointment")||"ipm.ole.class.{00061055-0000-0000-c000-000000000046}"==e}var O=function(){function e(e){this.itemIsRule=e}return e.prototype.Evaluate=function(e,t){return this.EvaluateItemType(e)&&this.EvaluateItemClass(e)},e.prototype.EvaluateItemType=function(e){var t=e.ItemClass;return!(1!=this.itemIsRule.ItemType||!t||!S(t.toLowerCase()))||(!(2!=this.itemIsRule.ItemType||!t||!C(t.toLowerCase()))||!this.itemIsRule.ItemType)},e.prototype.EvaluateItemClass=function(e){var t=e.ItemClass;return!this.itemIsRule.ItemClass||(this.itemIsRule.IncludeSubClasses?t&&0===t.toLowerCase().indexOf(this.itemIsRule.ItemClass.toLowerCase()):t&&this.itemIsRule.ItemClass.toLowerCase()===t.toLowerCase())},e.prototype.ItemIsReadyForEvaluation=function(e){return!0},e}(),A=function(){function e(e,t){this.itemHasRegularExpressionMatchRule=e,this.limits=t||r}return e.prototype.Evaluate=function(e,t){var n,r,o=this.GetPropertyForEvaluation(e,t),i=this.itemHasRegularExpressionMatchRule.RegExValue,a=this.itemHasRegularExpressionMatchRule.IgnoreCase,c=null;if(null!=o&&(c=Object(l.h)(o,i,a)),null==c)return t.evaluationResult.regExMatches[this.itemHasRegularExpressionMatchRule.RegExName]=[],!1;var u=this.removeDuplicatesAndApplyMatchLimits(c);if(t.evaluationResult.regExMatches[this.itemHasRegularExpressionMatchRule.RegExName]=u,2===this.itemHasRegularExpressionMatchRule.Highlight)return!0;if(2==this.itemHasRegularExpressionMatchRule.PropertyName)try{for(var d=Object(s.__values)(u),f=d.next();!f.done;f=d.next()){var p=f.value;t.terms.push(p)}}catch(e){n={error:e}}finally{try{f&&!f.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}return!0},e.prototype.ItemIsReadyForEvaluation=function(e){return!0},e.prototype.removeDuplicatesAndApplyMatchLimits=function(e){var t,n,r={},o=0;try{for(var i=Object(s.__values)(e),a=i.next();!a.done;a=i.next()){var c=a.value;if(o>=this.limits.MAX_REGEX_MATCHES)break;c.length<=this.limits.MAX_REGEX_MATCH_LENGTH&&(r[c]=1,o++)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return Object.keys(r)},e.prototype.GetPropertyForEvaluation=function(e,t){switch(this.itemHasRegularExpressionMatchRule.PropertyName){case 1:return e.Subject;case 4:return this.GetSenderSMTPAddress(e);case 3:return this.GetBodyWithLimits(e);case 2:if(t.plainTextBody)return t.plainTextBody;var n=this.GetBodyWithLimits(e);return t.plainTextBody=Object(l.e)(n),t.plainTextBody;default:return Object(_.a)(this.itemHasRegularExpressionMatchRule.PropertyName),""}},e.prototype.GetSenderSMTPAddress=function(e){if(S(e.ItemClass.toLowerCase())){var t=e;if(t.Sender&&t.Sender.Mailbox)return t.Sender.Mailbox.EmailAddress}if(C(e.ItemClass.toLowerCase())){var n=e;if(n.Organizer&&n.Organizer.Mailbox)return n.Organizer.Mailbox.EmailAddress}return null},e.prototype.GetBodyWithLimits=function(e){var t=this.GetBody(e);return null!=t&&t.length>this.limits.MAX_BODY_REGEX_ACTIVATION_LENGTH?null:t},e.prototype.GetBody=function(e){var t;e.NormalizedBody?t=e.NormalizedBody:e.UniqueBody?t=e.UniqueBody:e.Body&&(t=e.Body);var n=this.itemHasRegularExpressionMatchRule.PropertyName;return!t||"Text"===t.BodyType&&3===n?null:t.Value},e}();function I(e){if("ItemIs"==e.Type)return new O(e);if("ItemHasAttachment"==e.Type)return new f;if("ItemHasKnownEntity"==e.Type)return new g(e);if("ItemHasRegularExpressionMatch"==e.Type)return new A(e);if("Collection"==e.Type)return new d(e);throw new Error("Rule type not supported: "+e.Type)}var x=n(24);function E(e,t,n){var r,o={};e.length>0&&e.forEach((function(e){var i,a,c,l;c=r,l={evaluationResult:Object(u.h)(),highlightableEntities:{},terms:[]},c&&(l.plainTextBody=c.plainTextBody,l.highlightableEntities=c.highlightableEntities);var d=function(e,t,n){try{return function(e,t,n){if(I(e).Evaluate(t,n))return n.terms;return[]}(e.detectedEntity.Rule,t,n)}catch(e){return[]}}(e,t,r=l);try{for(var f=Object(s.__values)(d),p=f.next();!p.done;p=f.next()){var m=p.value;o[m]?o[m].push(e):o[m]=[e]}}catch(e){i={error:e}}finally{try{p&&!p.done&&(a=f.return)&&a.call(f)}finally{if(i)throw i.error}}d.length>0&&(n[e.extension.Id]=r.evaluationResult)}));return new x.ObservableMap(o)}function T(e,t){try{return function(e,t){return I(e).ItemIsReadyForEvaluation(t)}(e.detectedEntity.Rule,t)}catch(e){return!0}}function P(e,t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n;return Object(s.__generator)(this,(function(r){switch(r.label){case 0:return function(e,t){var n,r;try{for(var o=Object(s.__values)(e),i=o.next();!i.done;i=o.next()){if(!T(i.value,t))return!1}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return!0}(t,e)?[3,2]:[4,Object(l.j)(e)];case 1:n=r.sent(),Object(u.gb)(e,n.EntityExtractionResult),r.label=2;case 2:return[2]}}))}))}var w=n(1046),M=n(1097),R=n(76);function j(e,t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n,r,o,i,a,c;return Object(s.__generator)(this,(function(l){switch(l.label){case 0:return(n=Object(w.c)(t))?(r=!1,n.isSharedItem&&(r=n.isSharedItem()),o=function(e){var t=u.k.EnabledAddinCommands;if(!t)return[];var n=t.getExtensionPoint(M.a.DetectedEntity);if(0==n.length)return[];if(e){if(!Object(R.h)("addin-delegateAccess"))return[];n=Object(u.m)(n)}return n.map((function(e){return Object(s.__spread)(e.AddinCommands.values())[0]}))}(r),i={},[4,P(e,o)]):[2];case 1:return l.sent(),a=E(o,e,i),c=new x.ObservableMap(i),Object(u.fb)(t,a,c),[2]}}))}))}var k=n(3468),N=n(3850),D=n(5489);function F(e,t,n){return void 0===n&&(n=!0),Object(s.__awaiter)(this,void 0,void 0,(function(){var r;return Object(s.__generator)(this,(function(o){switch(o.label){case 0:return Object(w.a)(e,t),Object(u.G)(e),((i=t.mode)==M.a.MessageRead||i==M.a.MeetingRequest||i==M.a.AppointmentAttendee)&&(r=t,Object(u.kb)(function(e,t){return function(){return j(e.getItem(),t)}}(r,e))),Object(l.l)(e),Object(D.e)(n),[4,Object(N.f)(t.mode)];case 1:return o.sent(),[4,Object(c.a)()];case 2:return o.sent(),Object(k.c)()&&Object(D.f)(D.a.Single,e),[2]}var i}))}))}function L(e){Object(l.f)(e),Object(D.b)(e),Object(u.j)(e),Object(u.i)(e),Object(u.g)(e),function(e,t){Object(u.I)(e)?Object(x.when)((function(){return!Object(u.I)(e)}),(function(){return t(e)})):t(e)}(e,U)}function U(e){Object(u.M)(e)||Object(w.b)(e)}var B=n(1876);function H(e,t){t==B.a.Deselected&&Object(D.b)(e)}function W(e){return!!Object(u.v)(e)&&null!=Object(u.v)(e).contextualTerms}function V(e,t){return Object(x.when)((function(){return W(e)}),(function(){return t(W(n=e)?Object(s.__spread)(Object(u.v)(n).contextualTerms.keys()):null);var n}))}var z=n(3040),G=n(3902),q=function(e){function t(){var t=e.call(this,{},{},{},{})||this;return t.extension={AppDomains:[G.e,G.d],Id:G.k,Version:G.i,Type:"Default",TypeString:"Default",Origin:"Default",OriginString:"Default",IconUrl:G.h,DisplayName:G.c,ConsentState:0,Description:G.b,ProviderName:G.j,HighResolutionIconUrl:G.g,AppStatus:"",LicenseType:0,Settings:"{}",RequestedCapabilities:1,DisableEntityHighlighting:!1,Enabled:!0,LicenseStatus:0,IsMandatory:!1,ExtensionPointCollection:t.get_ExtensionPointCollection()},t.addinId=G.k,t.commandId=G.a,t.endpoint=G.d,t}return Object(s.__extends)(t,e),t.prototype.get_EntryPoint=function(){return this.endpoint.toString()},t.prototype.get_Label=function(){return this.extension.DisplayName},t.prototype.get_ExtensionDisplayName=function(){return this.extension.DisplayName},t.prototype.get_Id=function(){return this.extension.Id},t.prototype.get_Size16Icon=function(){return this.extension.IconUrl},t.prototype.get_Version=function(){return this.extension.Version},t.prototype.get_ExtensionPointCollection=function(){return{FunctionFile:G.f,MessageReadCommandSurface:this.get_ExtensionPoint(),MessageComposeCommandSurface:null,AppointmentOrganizerCommandSurface:null,AppointmentAttendeeCommandSurface:null,Events:null,DetectedEntity:null,CustomPane:null,__type:"MessageReadCommandSurface"}},t.prototype.get_ExtensionPoint=function(){return{Tabs:[this.get_Tab()],__type:""}},t.prototype.get_Tab=function(){return{Type:0,Id:"TabDefault",Groups:[this.get_Group()],Label:G.c,__type:null}},t.prototype.get_Group=function(){return{Id:"ScreamGroup",Label:G.c,Controls:[this.get_TaskPaneControl()],__type:null}},t.prototype.get_IconUrls=function(){return{Size16Url:"https://ogma.osi.office.net/outlooktranslatorapp/Images/TranslateIcon16x16.png",Size32Url:"https://ogma.osi.office.net/outlooktranslatorapp/Images/TranslateIcon32x32.png",Size80Url:"https://ogma.osi.office.net/outlooktranslatorapp/Images/TranslateIcon80x80.png",Size20Url:null,Size24Url:null,Size40Url:null,Size48Url:null,Size64Url:"https://ogma.osi.office.net/outlooktranslatorapp/Images/TranslateIcon64x64.png",__type:null}},t.prototype.get_TaskPaneControl=function(){var e=this.get_Control();return e.Action={SourceLocation:G.f,__type:"TaskPaneButton"},e},t.prototype.get_Control=function(){return{Label:G.c,Supertip:{Title:"Translate Item",Description:G.b},Icon:this.get_IconUrls(),Id:G.a,__type:"ShowTaskpane"}},t}(u.a),K=n(5216);function X(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(K.a)()];case 1:return n.sent(),null!=(t=new q)?(Object(D.g)(e,t,M.a.MessageRead),[2]):[2,null]}}))}))}var J=n(4827),Q=n(1871),Z=n(42),Y=n(1),$=n(1850),ee=n(11103),te=n(9),ne=n(7769),re=n(6163);var oe=n(6271),ie=n(11104),ae=n(4218),se=n(6272),ce=n(989),ue=n(254);function le(){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e;return Object(s.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(ce.b)(Object(te.b)(ie.b),Object(te.b)(ae.b),!1,{okText:Object(te.b)(ie.a),cancelText:Object(te.b)(ae.a)})];case 1:return e=t.sent(),Object(ue.o)("ExtGDPRMinorDialogResponse",[e]),e===ce.a.cancel&&Object(k.b)()&&Object(se.a)(),[2]}}))}))}var de=n(4217);function fe(e,t,n){return Object(s.__awaiter)(this,void 0,void 0,(function(){var r,o,i;return Object(s.__generator)(this,(function(a){switch(a.label){case 0:return Object(de.f)(t)?[4,le()]:[3,2];case 1:return a.sent(),[2];case 2:return r=Object(w.c)(e),o=!0,!r||r.mode!==M.a.MessageRead&&r.mode!==M.a.AppointmentAttendee||(i=r.getItem(),o=Object(u.Y)(i)),[4,Object(ce.b)(Object(te.b)(ee.a),"",o,{bodyElement:Y.createElement("p",null,Object(te.b)(ee.b)),hideCancelButton:!0})];case 3:return a.sent(),o?(ne.c(t.control)?Object(oe.a)(e,t,null==r?void 0:r.mode,n):ne.a(t.control)&&function(e,t){var n=new re.d(e,new re.a),r=n.controlId;Object(u.X)(r,n,t)}(t,e),[2]):[2]}}))}))}var pe=n(7771),me=n(233),ge=function(){function e(e,t){this.key=e,this.name=t}return e.prototype.generateData=function(){return{key:this.key,name:this.name,title:this.description,ariaLabel:this.accessibilityText,iconProps:Object(pe.a)(this.iconUrl),itemType:me.a.Normal,getClickHandler:this.getClickHandler,subMenuProps:this.subMenuData?{items:[this.subMenuData.generateData()]}:null}},e}(),he=function(){function e(e,t){this.key=e,this.header=t,this.menuItemDataList=[]}return e.prototype.addItem=function(e){this.menuItemDataList.push(e)},e.prototype.generateItemsData=function(){var e,t;try{for(var n=Object(s.__values)(this.menuItemDataList),r=n.next();!r.done;r=n.next()){var o=r.value;this.data.push(o.generateData())}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},e.prototype.generateData=function(){return this.data=[],this.generateItemsData(),{key:this.key,itemType:me.a.Section,sectionProps:{title:this.header,items:this.data}}},e}();function ve(e){var t=e.control,n=t.Id,r=t.Label,o=new ge(n,r);return e.isMenu?o.subMenuData=ye(n,r,e.subCommands):e.isActionable&&(o.getClickHandler=Ce(e)),o.iconUrl=e.control.Icon?e.control.Icon.Size16Url:null,o.accessibilityText=e.control.Label,o.description=e.control.Supertip?e.control.Supertip.Title:null,o}function ye(e,t,n){var r,o,i=new he(e,t);try{for(var a=Object(s.__values)(n),c=a.next();!c.done;c=a.next()){var u=c.value;i.addItem(ve(u))}}catch(e){r={error:e}}finally{try{c&&!c.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}return i}function be(e){var t=new ge(e.Id,e.DisplayName);if(Object(de.h)(e))if(Object(de.g)(e))t.subMenuData=ye(e.Id,e.DisplayName,Object(de.d)(e).subCommands);else{var n=Object(s.__spread)(e.AddinCommands.values());t.subMenuData=ye(e.Id,e.DisplayName,n)}else Object(de.a)(e)&&(t.getClickHandler=Ce(Object(de.d)(e)));return t.description=Object(de.e)(e),t.accessibilityText=Object(de.b)(e),t.iconUrl=e.IconUrl,t}var _e=n(11105);var Se=n(7772);function Ce(e){return function(t){return function(n){n.stopPropagation(),fe(t,e)}}}function Oe(e){var t=function(e){var t,n,r=new he("AddinsHeader",Object(te.b)(_e.a));try{for(var o=Object(s.__values)(e),i=o.next();!i.done;i=o.next()){var a=i.value;r.addItem(be(a))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r}(e).generateData();return Object(R.h)("addin-inClientStoreEnabled")&&Object(u.s)()&&Object(u.s)().InClientStoreUrl&&(t.sectionProps.items.push(Object(Se.b)()),t.sectionProps.items.push(Object(Se.a)())),t}var Ae=n(579),Ie=n(389),xe=n(105),Ee=n(11106),Te=Object(Z.a)((function(e){var t=Object(s.__read)(Y.useState(!1),2),n=t[0],r=t[1],o=function(t){t.stopPropagation(),Object(de.a)(e.addin)&&fe(e.hostItemIndex,Object(de.d)(e.addin))},i={iconType:Ie.a.Image,imageProps:{src:e.addin.IconUrl,width:16,height:16,imageFit:xe.b.contain,onLoadingStateChange:function(e){e==xe.c.error?r(!0):r(!1)}}},a={iconType:Ie.a.Default,iconName:"Photo2"},c=Object(de.b)(e.addin),u={className:Ee.addinEntryButton,iconProps:n?a:i,title:c,ariaLabel:c};if(Object(de.a)(e.addin))return Y.createElement(Ae.a,Object(s.__assign)({onClick:o},u));if(Object(de.h)(e.addin)){var l=be(e.addin).generateData();return Object($.a)(e.hostItemIndex,l),Y.createElement(Ae.a,Object(s.__assign)({onMenuClick:o,menuProps:l.subMenuProps,menuIconProps:null},u))}return null})),Pe=n(11108);var we=function(e){var t,n,r=[];try{for(var o=Object(s.__values)(e.addins),i=o.next();!i.done;i=o.next()){var a=i.value;r.push(Y.createElement(Te,{hostItemIndex:e.hostItemIndex,addin:a,key:a.Id}))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return Y.createElement("div",{className:Pe.listViewContainer},r)},Me=n(11110),Re=n(479),je=n.n(Re),ke=n(11111),Ne=Object(Z.a)((function(e){var t={iconType:Ie.a.Default,iconName:"ChevronDownMed",className:je()([ke.overflowChevron])},n={className:je()([ke.overflowChevronContainer]),iconProps:t,title:Object(te.b)(Me.a),ariaLabel:Object(te.b)(ae.c)},r=Oe(e.addins);return Object($.a)(e.hostItemIndex,r),Y.createElement("div",{className:je()([ke.overflowContainer])},Y.createElement("div",{className:je()([ke.overflowDivider])}),Y.createElement(Ae.a,Object(s.__assign)({onMenuClick:De,menuProps:{items:[r]},menuIconProps:null},n)))}));function De(e){e.stopPropagation()}var Fe=n(11113),Le=5,Ue=3,Be=5,He=Object(Z.a)((function(e){var t=u.k.HostItems.get(e.Index),n=u.k.EnabledAddinCommands;if(!t||!n)return Y.createElement("div",null);var r=Object(w.c)(e.Index),o=function(e){switch(e){case M.a.MessageRead:return Ue;case M.a.MessageCompose:return Be;default:return Le}}(r.mode),i=n.getExtensionPoint(r.mode),a=null;return(o=Math.min(o,i.length))<i.length&&(a=Y.createElement(Ne,{hostItemIndex:e.Index,addins:i.slice(o,i.length)})),Y.createElement("div",{className:Fe.divContainer},Y.createElement(we,{hostItemIndex:e.Index,addins:i.slice(0,o)}),a)}));var We=n(7604),Ve=n(7642),ze=n(7770);function Ge(e,t,n){Object(u.F)(e,t,n);var r=Object(u.t)();Object(ze.a)(t,r.contextualCalloutState.activeContextualAddinCommands[0])}function qe(e,t,n,r,o){return Object(s.__awaiter)(this,void 0,void 0,(function(){var i;return Object(s.__generator)(this,(function(a){switch(a.label){case 0:return null==(i=Object(de.c)(t,n,r))?[3,2]:[4,fe(e,i,o)];case 1:return a.sent(),[2];case 2:return[2,null]}}))}))}var Ke={};function Xe(e,t,n){var r=function(e,t,n){return e+"_"+t+"_"+n}(e,t=!!t,n);return Ke[r]||(Ke[r]=Object(x.computed)((function(){var n=Object(u.t)().Context,r=Object(u.t)().EnabledAddinCommands;return r?function(e,t,n,r){if(n&&t.isInitialized){return Oe(t.getExtensionPoint(e,r))}return null}(e,r,n,t):null}))),Ke[r]}var Je=n(6151),Qe=n(8499),Ze=n(11115),Ye=n(27),$e=n(5501),et=function(){return Object(s.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:return e=Object(u.t)().Context,Object(u.K)()&&e?[2,!0]:[3,1];case 1:t={name:"Extensibility initialization observer timeout",timeout:9e3},n.label=2;case 2:return n.trys.push([2,4,,5]),[4,Object(x.when)((function(){return Object(u.t)().Context&&Object(u.K)()}),t)];case 3:return n.sent(),[3,5];case 4:return n.sent(),[2,!1];case 5:return[2,Object(u.t)().Context&&Object(u.K)()]}}))}))};function tt(e){var t;return Object(s.__awaiter)(this,void 0,void 0,(function(){var n,r,o,i,a,c;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:return Object(R.h)("addin-itemSendEvent")?(n=Object($e.b)(),r=Object(Ye.a)().SegmentationSettings.OnSendAddinsEnabled,(o=r)?[4,et()]:[3,2]):[2,!0];case 1:o=!s.sent(),s.label=2;case 2:if(o&&function(e){var t=Object(u.t)().Context,n=Object(u.K)();if(e&&(!t||!n))return Object(ce.b)(Object(te.b)(Qe.a),Object(te.b)(Ze.b),!1,{hideCancelButton:!0}),!0;return!1}(r))return Object($e.d)(n,1),[2,!1];if(i=Object(u.y)(1),a=Object(w.c)(e),null===(t=null==a?void 0:a.isSharedItem)||void 0===t?void 0:t.call(a)){if(!Object(R.h)("addin-delegateAccess"))return[2,!0];i=Object(u.l)(i)}!function(e,t){e.forEach((function(e){return Object(l.m)(t,e.extension.Id,e.extension.Id+"ItemSend")}))}(i,e),c=0,s.label=3;case 3:return c<i.length?[4,nt(e,i[c],n)]:[3,6];case 4:if(!s.sent())return[2,!1];n.addCheckmark("ItemSend"+c),s.label=5;case 5:return c++,[3,3];case 6:return i.length>0?Object($e.d)(n,4):n.invalidate(),[2,!0]}}))}))}function nt(e,t,n){return Object(s.__awaiter)(this,void 0,void 0,(function(){var r,o,i;return Object(s.__generator)(this,(function(a){switch(a.label){case 0:return r=new re.d(t,new re.a),o=r.controlId,[4,Object(u.X)(o,r,e)];case 1:return(i=a.sent()).status!==u.d.Success||!1===i.allowEvent?(Object(l.c)(e,t.extension.Id,!1,t.extension.Id+"ItemSend",0,Object(te.c)(Object(te.b)(Ze.a),t.extension.DisplayName)),Object(u.cb)(o,e,i.status),Object($e.c)(n,i,t),[2,!1]):[2,!0]}}))}))}var rt=n(4),ot=function(e,t){Object(R.h)("addin-autoRun")&&Object(u.K)()&&Object(D.d)(e,t)},it=Object(rt.action)("onNewMessageCompose",(function(e){return{hostItemIndex:e}}));Object(rt.orchestrator)(it,(function(e){ot(e.hostItemIndex,1)}));var at=it,st=Object(rt.action)("onNewAppointmentOrganizer",(function(e){return{hostItemIndex:e}}));Object(rt.orchestrator)(st,(function(e){ot(e.hostItemIndex,2)}));var ct=st;n.d(t,"removeExtensibilityNotification",(function(){return o.h})),n.d(t,"updatePersistentNotifications",(function(){return i.a})),n.d(t,"closeTaskPaneAddinCommand",(function(){return a.a})),n.d(t,"initializeAddinsForItem",(function(){return F})),n.d(t,"deinitializeAddinsForItem",(function(){return L})),n.d(t,"onHostItemChanged",(function(){return H})),n.d(t,"initializeExtensibilityContext",(function(){return c.a})),n.d(t,"whenItemHasContextualAddinKeywords",(function(){return V})),n.d(t,"triggerAppointmentTimeChangedEvent",(function(){return z.e})),n.d(t,"triggerAttachmentsChangedEvent",(function(){return z.f})),n.d(t,"triggerRecipientsChangedEvent",(function(){return z.h})),n.d(t,"triggerRecurrenceChangedEvent",(function(){return z.i})),n.d(t,"triggerLocationsChangedEvent",(function(){return z.g})),n.d(t,"launchTranslateCommand",(function(){return X})),n.d(t,"setPersistedAddin",(function(){return J.a})),n.d(t,"shouldForceOnSendCompliantBehavior",(function(){return Q.a})),n.d(t,"AddinBarView",(function(){return He})),n.d(t,"TaskPaneCollection",(function(){return We.a})),n.d(t,"onComposeClose",(function(){return Ve.a})),n.d(t,"openContextualCallout",(function(){return Ge})),n.d(t,"launchAddinCommand",(function(){return qe})),n.d(t,"observeAddinCommandSurfaceItems",(function(){return Xe})),n.d(t,"onItemNavigation",(function(){return Je.a})),n.d(t,"allowItemSendEvent",(function(){return tt})),n.d(t,"ExecuteEntryPoint",(function(){return fe})),n.d(t,"onNewMessageCompose",(function(){return at})),n.d(t,"onNewAppointmentOrganizer",(function(){return ct}))},3700:function(e,t,n){"use strict";var r=n(0),o=n(283),i=Object(o.action)("setNumberOfWaitingAttachments")((function(e,t){t<0||(e.numberOfWaitingAttachments=t)})),a=n(2678),s=n(254),c=n(114),u=n(4585),l=n(4399),d=n(1833),f=n(3099),p=n(79),m=n(3515),g=n(2666),h=n(1235),v=n(1900);n.d(t,"a",(function(){return S}));var y="ExpirableImageLoadingFail",b=new RegExp("^data:(image\\/\\w+);base64,([A-Za-z0-9+/=]+?)$","i");function _(e,t,n){if(e.isInline){var r=t.length,o=n.attachmentWell.inlineAttachments.length;m.c.import().then((function(e){for(var i=0;i<r;i++){var a=n.attachmentWell.inlineAttachments[o-r+i];e(n.inlineImage,n,a.placeholderId,t[i])}}))}}function S(e,t,n,o,S,C,O){return Object(r.__awaiter)(this,void 0,void 0,(function(){var A,I,x;return Object(r.__generator)(this,(function(E){switch(E.label){case 0:A=!1,I=Object(f.a)(t.smimeViewState),t.itemId||I||(A=!0,i(t,t.numberOfWaitingAttachments+1)),E.label=1;case 1:return E.trys.push([1,,6,7]),(x=!t.itemId&&!I)?[4,Object(a.f)(t)]:[3,3];case 2:x=!E.sent(),E.label=3;case 3:return x?[4,Object(a.b)(t)]:[3,5];case 4:E.sent(),E.label=5;case 5:return function(e,t,n,o,i,a,u){var l=this,S=function(e){for(var t=[],n=[],r=0;r<e.length;r++)e[r].tempId?t.push(e[r]):n.push(e[r]);return{nonExpirableFiles:n,expirableFiles:t}}(e),C=S.nonExpirableFiles,O=S.expirableFiles;Object(f.a)(t.smimeViewState)?d.c.import().then((function(e){return Object(r.__awaiter)(l,void 0,void 0,(function(){var o,i;return Object(r.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,e(C,Object(r.__assign)(Object(r.__assign)({},t.itemId),{mailboxInfo:Object(c.e)()}),t.attachmentWell,n,t)];case 1:return o=a.sent(),_(n,o,t),[3,3];case 2:return i=a.sent(),Object(s.o)("CreateSmimeAttachmentsFromFilesErrorDatapoint",{errorMessage:i.message},{isCore:!0}),p.g.warn(i),[3,3];case 3:return[2]}}))}))})):(O.length>0&&Promise.all([m.a.import(),h.f.import(),m.c.import(),m.b.import()]).then((function(e){var s=Object(r.__read)(e,4),l=s[0],d=s[1],f=s[2],p=s[3];O.forEach((function(e){l(e.imageSrc).then((function(s){var l=s.match(b);e.type=l[1],e.dataUri=l[2],d(t.attachmentWell,Object(r.__assign)(Object(r.__assign)({},t.itemId),{mailboxInfo:n.mailboxInfo?n.mailboxInfo:Object(c.e)()}),[e],t,n,o,i,a,u,e.tempId)})).catch((function(){v.i.import().then((function(e){e(g.c,"",y,"",g.b)})),p(t.inlineImage,t,e.tempId)})),f(t.inlineImage,t,e.tempId,e)}))})),C.length>0&&h.f.import().then((function(e){var s=e(t.attachmentWell,Object(r.__assign)(Object(r.__assign)({},t.itemId),{mailboxInfo:n.mailboxInfo?n.mailboxInfo:Object(c.e)()}),C,t,n,o,i,a,u);_(n,s,t)})))}(e,t,n,(function(e){o&&o(e),Object(l.a)()&&Object(u.a)(t,8)}),S,C,O),[3,7];case 6:return A&&i(t,t.numberOfWaitingAttachments-1),[7];case 7:return[2]}}))}))}},3750:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"SingleRecipientType:#Exchange"},e)}},376:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.NotStarted=0]="NotStarted",e[e.Loading=1]="Loading",e[e.Ready=2]="Ready"}(r||(r={}))},3816:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(5876),o=n(3817),i="MailComposeSend";t.b={MailComposeReply:{name:"MailComposeReply",options:{},customData:function(e){return[e.actionSource,e.useFullCompose]},actionSource:function(e){return e.actionSource},cosmosOnlyData:function(e){return e.referenceItemId}},MailComposeReplyAll:{name:"MailComposeReplyAll",options:{},customData:function(e){return[e.actionSource,e.useFullCompose]},actionSource:function(e){return e.actionSource},cosmosOnlyData:function(e){return e.referenceItemId}},MailComposeForward:{name:"MailComposeForward",options:{},customData:function(e,t,n,r){return[t]},actionSource:function(e,t,n,r){return t},cosmosOnlyData:function(e,t,n,r){return e&&e.toString()}},MailComposeSendE2E:{name:"MailComposeSendE2E",customData:function(e){return{composeTraceId:e.logTraceId,operation:e.operation,isGroupScenario:Object(o.b)(e)}}},MailComposeSave:{name:"MailComposeSave"},MailComposeUpConvert:{name:"MailComposeUpConvert"},ComposeCommandDiscardCompose:{name:"ComposeCommandDiscardCompose",customData:function(e){return{composeTraceId:e.logTraceId}},options:{isCore:!0},cosmosOnlyData:function(e){return JSON.stringify({smartReplyExtractionId:Object(r.a)(e,"smartReply"),smartDocExtractionId:Object(r.a)(e,"smartDoc")})}},ComposeCommandShowFrom:{name:"ComposeCommandShowFrom"},ComposeCommandSetImportance:{name:"ComposeCommmandSetImportance",customData:function(e,t){return[t]}}}},3817:function(e,t,n){"use strict";function r(e){return o(e)&&(2==(t=e).operation||t.toRecipientWell.recipients.some((function(e){return e.persona.EmailAddress.EmailAddress.toLowerCase()===t.groupId.toLowerCase()})));var t}function o(e){return!!e.groupId}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}))},3818:function(e,t,n){"use strict";n.d(t,"f",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return d})),n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return p})),n.d(t,"j",(function(){return m})),n.d(t,"h",(function(){return g})),n.d(t,"i",(function(){return h}));var r=n(0),o=n(254),i=n(7),a=n(27);function s(e,t){var n=v(e.selectedCLPLabel,"Change"),i=e.originalCLPLabel,a=e.selectedCLPLabel,s=Object(r.__assign)(Object(r.__assign)({},n),{IsLabelChanged:!0,LabelIdBefore:i?i.id:null,IsProtectionChanged:!(!i||!a)&&i.isEncryptingLabel!=a.isEncryptingLabel,ProtectedBefore:null==i?void 0:i.isEncryptingLabel,UserJustification:t});o.j.importAndExecute(s)}function c(e){var t=v(e,"Discover");o.j.importAndExecute(t)}function u(e){(null==e?void 0:e.value)&&e.value.length>0&&Object(o.o)("LoadCLPLabelOnBoot",{labelCount:e.value.length})}function l(e){e&&Object(o.o)("LoadCLPLabelComposeUsage",{isDefaultLabel:e.isDefault,isEncryptingLabel:e.isEncryptingLabel})}function d(e,t){t&&e?Object(o.o)("LoadCLPLabelChange",{isDowngrade:e.settingOrder>t.settingOrder,isOriginalLabelDefault:e.isDefault}):e&&Object(o.o)("LoadCLPLabelUnselect",{isOriginalLabelDefault:e.isDefault,isOriginalLabelEncrypting:e.isEncryptingLabel})}function f(e){401!=e.status&&Object(o.o)("CLPAutoLabelEnabled")}function p(){Object(o.o)("CLPAutoLabelAutomaticApplied")}function m(){Object(o.o)("CLPAutoLabelRecommendedShown")}function g(){Object(o.o)("CLPAutoLabelRecommendedApplied")}function h(){Object(o.o)("CLPAutoLabelRecommendedDismissed")}function v(e,t){var n=Object(a.a)().SessionSettings,r=n.ExternalDirectoryTenantGuid,o=n.UserEmailAddress;return{CreationTime:Object(i.ub)(Object(i.Qb)()),Version:"1.1",Operation:t,OrganizationId:r,UserId:o,ApplicationId:"00000002-0000-0ff1-ce00-000000000000",ApplicationName:"Outlook Web",DataState:"Use",LabelId:e?e.id:null,Protected:e?e.isEncryptingLabel:null}}},383:function(e,t,n){"use strict";var r=n(0),o=n(241),i=n(270),a=n(340);function s(e){return Object(r.__assign)({__type:"TokenRequest:#Exchange"},e)}var c=n(120),u=n(25);function l(e,t){return void 0===e||e.__type||(e=s(e)),Object(u.a)("GetAccessTokenforResource",e,t)}var d=n(71),f=n(98),p="OWA_GetAccessTokenForResource";function m(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(d.a)()];case 1:return(o=r.sent())&&e==Object(f.a)()?[2,{AccessToken:o}]:(i={isUserActivity:!1,datapoint:{customData:{Scenario:p,Resource_Url:e,Retry_attempt:t,Request_Id:n},headersCustomData:function(e){return{TokenResultDetails:e.get("x-tokenresult")}},jsonCustomData:function(e){var t;return{TokenStatus:(null===(t=null==e?void 0:e.TokenResultCode)||void 0===t?void 0:t.toString())||2}}},returnFullResponseOnSuccess:!0},[4,l(s({Resource:e,UserToken:o}),i)]);case 2:return[4,r.sent().json()];case 3:return[2,r.sent()]}}))}))}function g(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){return t<1?[2,Promise.reject()]:[2,m(e,t,o).catch((function(r){return Object(c.a)(n).then((function(){return g(e,t-1,2*n,o)}))}))]}))}))}var h,v=n(76),y=n(482),b=3,_=500;function S(e,t){var n=this,o=null,i=null,a=new Promise((function(e,t){return Object(r.__awaiter)(n,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){return o=e,i=t,[2]}))}))})),s={onFulfilled:o,onRejected:i,resource:e,requestId:t};return(null==h&&(h=new y.a(b,C,_)),h).add(s),a}function C(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){return k(e.resource,e.requestId).then((function(t){e.onFulfilled(t)})).catch((function(t){e.onRejected(t)})),[2]}))}))}var O=n(338),A=n(123),I=n(428);n.d(t,"d",(function(){return M})),n.d(t,"b",(function(){return R})),n.d(t,"c",(function(){return j})),n.d(t,"a",(function(){return k}));var x=1,E=8e3,T=3,P=1500,w=null;function M(e){w=e}function R(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=N(D(),e),t=t||Object(I.a)(),null!=n?[3,2]:[4,k(e,t)];case 1:n=r.sent(),r.label=2;case 2:return[2,null!=n?n.AccessToken:void 0]}}))}))}function j(e,t){t=t||Object(I.a)();var n=N(D(),e);if(n)return[n.AccessToken,void 0];if(Object(v.h)("auth-getAccessTokenQueueEnabled")){var r=Object(O.a)(e),o=void 0;return r?o=r:(o=S(e,t),Object(O.b)(e,o)),[void 0,o.then((function(t){return Object(O.c)(e),t.AccessToken})).catch((function(n){Object(O.c)(e),Object(A.h)(p,{category:"Promise_For_Token_Request_Failed",err:n?n.toString():"",message:n?n.message:"",stk:n?n.stack:"",resource:e,requestId:t})}))]}return[void 0,k(e,t).then((function(e){return e.AccessToken}))]}function k(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(v.h)("auth-getAccessTokenQueueEnabled")?[4,g(e,T,P,t)]:[3,2];case 1:return o=r.sent(),[3,4];case 2:return[4,m(e,T,t)];case 3:o=r.sent(),r.label=4;case 4:return null!=(n=o)&&0==n.TokenResultCode&&null!=n.AccessTokenExpiry&&(n.ExpiresIn&&n.ExpiresIn>0&&(n.AccessTokenExpiry=Object(a.a)(Date.now(),n.ExpiresIn).toISOString()),(i=new Date(n.AccessTokenExpiry).getTime()-Date.now()-E)>0&&D().put(e,n,i,(function(e,n){k(e,t).catch((function(n){Object(A.h)(p,{category:"Cache_Expired",err:n?n.toString():"",message:n?n.message:"",stk:n?n.stack:"",resource:e,requestId:t})}))}))),[2,n]}}))}))}function N(e,t){var n=e.get(t),r=void 0;(null==n?void 0:n.AccessTokenExpiry)&&n.AccessToken&&(Object(i.a)(new Date(n.AccessTokenExpiry),-x)>new Date(Date.now())&&(r=n));return r}function D(){return null==w&&(w=new o.Cache),w}},384:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),o=n(14),i=n(245),a=Object(i.c)((function(e,t){var n,i,a,s,c,u,l,d,f,p,m=e.effects,g=e.palette,h=e.semanticColors,v={position:"absolute",width:1,right:31,top:8,bottom:8},y={splitButtonContainer:[Object(o.getFocusStyle)(e,{highContrastStyle:{left:-2,top:-2,bottom:-2,right:-2,border:"none"},inset:2}),{display:"inline-flex",selectors:{".ms-Button--default":{borderTopRightRadius:"0",borderBottomRightRadius:"0",borderRight:"none"},".ms-Button--primary":{borderTopRightRadius:"0",borderBottomRightRadius:"0",border:"none",selectors:(n={},n[o.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",MsHighContrastAdjust:"none"},n)},".ms-Button--primary + .ms-Button":{border:"none"}}}],splitButtonContainerHovered:{selectors:{".ms-Button--primary":{selectors:(i={},i[o.HighContrastSelector]={color:"Window",backgroundColor:"Highlight"},i)},".ms-Button.is-disabled":{color:h.buttonTextDisabled,selectors:(a={},a[o.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},a)}}},splitButtonContainerChecked:{selectors:{".ms-Button--primary":{selectors:(s={},s[o.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",MsHighContrastAdjust:"none"},s)}}},splitButtonContainerCheckedHovered:{selectors:{".ms-Button--primary":{selectors:(c={},c[o.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",MsHighContrastAdjust:"none"},c)}}},splitButtonContainerFocused:{outline:"none!important"},splitButtonMenuButton:{padding:6,height:"auto",boxSizing:"border-box",borderRadius:0,borderTopRightRadius:m.roundedCorner2,borderBottomRightRadius:m.roundedCorner2,border:"1px solid "+g.neutralSecondaryAlt,borderLeft:"none",outline:"transparent",userSelect:"none",display:"inline-block",textDecoration:"none",textAlign:"center",cursor:"pointer",verticalAlign:"top",width:32,marginLeft:-1,marginTop:0,marginRight:0,marginBottom:0},splitButtonDivider:Object(r.__assign)(Object(r.__assign)({},v),{selectors:(u={},u[o.HighContrastSelector]={backgroundColor:"WindowText"},u)}),splitButtonDividerDisabled:Object(r.__assign)(Object(r.__assign)({},v),{selectors:(l={},l[o.HighContrastSelector]={backgroundColor:"GrayText"},l)}),splitButtonMenuButtonDisabled:{pointerEvents:"none",border:"none",selectors:(d={":hover":{cursor:"default"},".ms-Button--primary":{selectors:(f={},f[o.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},f)}},d[o.HighContrastSelector]={border:"1px solid GrayText",color:"GrayText",backgroundColor:"Window"},d)},splitButtonFlexContainer:{display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"center",alignItems:"center"},splitButtonContainerDisabled:{outline:"none",border:"none",selectors:(p={},p[o.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},p)}};return Object(o.concatStyleSets)(y,t)}))},3850:function(e,t,n){"use strict";var r=n(7669),o=n(4826);function i(e){var t=Object(r.a)(e);return Object(o.a)()[t]}var a=n(4827);function s(e){return e.isActionable&&e.control.Action.SupportsPersistence}var c=n(0),u=n(9),l=n(1097),d=n(3468),f=n(7621),p=!1;function m(e){return Object(c.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(c.__generator)(this,(function(r){switch(r.label){case 0:return Object(d.c)()?e===l.a.AppointmentAttendee||e===l.a.AppointmentOrganizer?[2]:p?[3,2]:[4,Object(f.a)()]:[2];case 1:t=r.sent(),(n=JSON.parse(t)).addins&&(p=!0,n.addins.forEach((function(e){if(function(e){return!Object(u.f)(e.mode)&&!Object(u.f)(e.addinId)&&!Object(u.f)(e.commandId)}(e)){var t={addinId:e.addinId,commandId:e.commandId};Object(o.a)()[e.mode]=t}}))),r.label=2;case 2:return[2]}}))}))}function g(){return p}function h(e){return{addinId:e.extension.Id,commandId:e.control.Id}}var v=n(1013);function y(e){for(var t=Object.keys(Object(o.a)()),n=0;n<t.length;n++){var r=t[n],i=Object(o.a)()[r];i&&e.indexOf(i.addinId)<0&&(Object(a.b)(r,null),Object(v.ab)(i.addinId))}}var b=function(e){var t=i(l.a.MessageRead),n=i(l.a.MessageCompose);return!!(t&&e.extension.Id===t.addinId&&e.get_Id().indexOf(t.commandId)>=0)||!!(n&&e.extension.Id===n.addinId&&e.get_Id().indexOf(n.commandId)>=0)};n.d(t,"c",(function(){return i})),n.d(t,"h",(function(){return a.a})),n.d(t,"a",(function(){return s})),n.d(t,"f",(function(){return m})),n.d(t,"e",(function(){return g})),n.d(t,"b",(function(){return h})),n.d(t,"g",(function(){return y})),n.d(t,"d",(function(){return b}))},386:function(e,t,n){"use strict";function r(e,t){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}n.d(t,"a",(function(){return r}))},387:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r,o=n(255);n.d(t,"b",(function(){return o.ResponsiveMode})),function(e){e[e.normal=0]="normal",e[e.largeHeader=1]="largeHeader",e[e.close=2]="close"}(r||(r={}))},3900:function(e){e.exports=JSON.parse('{"a":"JFa"}')},3901:function(e){e.exports=JSON.parse('{"a":"IFa"}')},3902:function(e,t,n){"use strict";n.d(t,"k",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"f",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"i",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return d})),n.d(t,"j",(function(){return f})),n.d(t,"g",(function(){return p}));var r="27797656-b5ea-4db3-8043-0230f0b4d6d6",o="translate.buttonDesktop1_1",i="https://ogma.osi.office.net/outlooktranslatorapp/desktop",a="https://ogma.osi.office.net",s="https://ogma.osi.office.net/outlooktranslatorapp/desktop",c="1.0.8.1",u="https://ogma.osi.office.net/outlooktranslatorapp/Images/TranslateIcon64x64.png",l="Translator",d="Help you translate messages in your preferred language across devices",f="Microsoft",p="https://ogma.osi.office.net/outlooktranslatorapp/Images/TranslateIcon128x128.png"},3916:function(e){e.exports=JSON.parse('{"a":"zFa"}')},3917:function(e){e.exports=JSON.parse('{"a":"sFa"}')},3922:function(e,t,n){"use strict";function r(e,t,n){var r=n.fromHtml(e,t);return r&&0!=r.length?1==r.length?r[0]:n.wrap(r,"SPAN"):null}n.d(t,"a",(function(){return r}))},3963:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Manual="manual",e.Automatic="automatic",e.Default="default"}(r||(r={}))},4033:function(e){e.exports=JSON.parse('{"a":"iFa"}')},4034:function(e){e.exports=JSON.parse('{"a":"pFa"}')},4049:function(e){e.exports=JSON.parse('{"a":"hFa"}')},4050:function(e){e.exports=JSON.parse('{"a":"gFa"}')},4085:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(27);function o(){return Object(r.a)().SessionSettings.UserEmailAddress}},4086:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){var t,n,o=[];if(null==e?void 0:e.recipients)try{for(var i=Object(r.__values)(e.recipients),a=i.next();!a.done;a=i.next()){var s=a.value,c=s.persona.EmailAddress;(null==c?void 0:c.ItemId)&&"PrivateDL"==c.MailboxType?o.push({Name:c.Name,RoutingType:c.RoutingType,MailboxType:c.MailboxType,ItemId:{Id:c.ItemId.Id,ChangeKey:null},EmailAddressIndex:c.EmailAddressIndex,RelevanceScore:c.RelevanceScore||0}):o.push(s.persona.EmailAddress)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return o}},413:function(e,t,n){"use strict";var r=n(480).a.Symbol;t.a=r},415:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(27),o=n(240),i=n(103);function a(e){var t,n=null==(t=e&&Object(o.n)(e.userIdentity)?Object(i.j)(e.userIdentity):Object(r.a)())?void 0:t.MasterCategoryList;return(null==n?void 0:n.MasterList)||[]}},416:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(211),o=r.a.GreyDark,i=r.a.Red},417:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(416),o=n(309),i=n(415);function a(e,t){t||(t=Object(i.a)());for(var n=0;n<t.length;n++){var r=t[n];if(r.Name.toLowerCase()===e.toLowerCase())return o.a.colorCodeColorValueMap[r.Color.toString()]}return s()}function s(){return o.a.colorCodeColorValueMap[r.a]}},4194:function(e){e.exports=JSON.parse('{"a":"bFa"}')},420:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var r=n(273),o=n(303),i=n(302),a=n(296);function s(e){return Object(r.a)({RequestServerVersion:"Exchange2015",TimeZoneContext:Object(o.a)({TimeZoneDefinition:Object(i.a)({Id:null!=e?e:"Pacific Standard Time"})})})}function c(e,t,n){return Object(a.a)({PropertySetId:e,PropertyName:t,PropertyType:n})}},421:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(0),o=n(1),i=n(243),a=n(386),s=n(284),c=n(306);function u(e,t,n){return function(u){var l,d=((l=function(a){function l(e){var t=a.call(this,e)||this;return t._styleCache={},t._onSettingChanged=t._onSettingChanged.bind(t),t}return Object(r.__extends)(l,a),l.prototype.componentDidMount=function(){i.a.observe(this._onSettingChanged)},l.prototype.componentWillUnmount=function(){i.a.unobserve(this._onSettingChanged)},l.prototype.render=function(){var a=this;return o.createElement(s.a.Consumer,null,(function(s){var l=i.a.getSettings(t,e,s.customizations),d=a.props;if(l.styles&&"function"==typeof l.styles&&(l.styles=l.styles(Object(r.__assign)(Object(r.__assign)({},l),d))),n&&l.styles){if(a._styleCache.default!==l.styles||a._styleCache.component!==d.styles){var f=Object(c.a)(l.styles,d.styles);a._styleCache.default=l.styles,a._styleCache.component=d.styles,a._styleCache.merged=f}return o.createElement(u,Object(r.__assign)({},l,d,{styles:a._styleCache.merged}))}return o.createElement(u,Object(r.__assign)({},l,d))}))},l.prototype._onSettingChanged=function(){this.forceUpdate()},l}(o.Component)).displayName="Customized"+e,l);return Object(a.a)(u,d)}}},4215:function(e){e.exports=JSON.parse('{"a":"LFa"}')},4216:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(76),o=n(60);function i(){return!!Object(r.h)("mc-officeEditorBX")&&(Object(o.c)()||Object(o.d)()||Object(r.h)("mc-officeEditorBXFirefoxSafari")&&(Object(o.f)()||Object(o.h)()))}},4217:function(e,t,n){"use strict";n.d(t,"h",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"g",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"f",(function(){return f}));var r=n(0),o=n(1013);function i(e){return s(e)?c(e).isMenu:e.AddinCommands.size>1}function a(e){return!!s(e)&&c(e).isActionable}function s(e){return 1==e.AddinCommands.size}function c(e){return e.AddinCommands.size>0?Object(r.__spread)(e.AddinCommands.values())[0]:null}function u(e){return s(e)?c(e).control.Supertip.Title:""}function l(e){var t=e.DisplayName;s(e)&&(t+=" - "+c(e).control.Supertip.Title);return t}function d(e,t,n){var i,a,s,c,u=o.k.EnabledAddinCommands;if(!u)return null;try{for(var l=Object(r.__values)(u.getExtensionPoint(n)),d=l.next();!d.done;d=l.next()){var f=d.value;if(f.Id==e&&f.AddinCommands.size>0)try{for(var p=(s=void 0,Object(r.__values)(f.AddinCommands.values())),m=p.next();!m.done;m=p.next()){var g=m.value;if(g.control.Id==t)return g}}catch(e){s={error:e}}finally{try{m&&!m.done&&(c=p.return)&&c.call(p)}finally{if(s)throw s.error}}}}catch(e){i={error:e}}finally{try{d&&!d.done&&(a=l.return)&&a.call(l)}finally{if(i)throw i.error}}return null}function f(e){return o.k.compliance.isMinor&&(!function(e){return"Default"===e.TypeString}(t=e.extension)&&!function(e){return"Organization"===e.OriginString}(t)&&!function(e){return"Private"===e.TypeString}(t));var t}},4218:function(e){e.exports=JSON.parse('{"b":"gZa","a":"hZa","c":"iZa","g":"jZa","f":"kZa","d":"lZa","e":"mZa"}')},422:function(e,t,n){"use strict";var r=n(0),o=n(1);var i=n(488),a=n(704),s=n(708);function c(e){var t,n,c,u,l=o.useRef(),d=e.keytipProps?Object(r.__assign)({disabled:e.disabled},e.keytipProps):void 0,f=(c=a.a.getInstance(),void 0===(u=o.useRef()).current&&(u.current={value:"function"==typeof c?c():c}),u.current.value);o.useEffect((function(){return d&&(l.current=f.register(d)),function(){d&&f.unregister(d,l.current)}}),[]);var p=function(e){var t=Object(o.useRef)();return Object(o.useEffect)((function(){t.current=e})),t.current}(e);l.current&&d&&((null===(t=p)||void 0===t?void 0:t.keytipProps)!==e.keytipProps||(null===(n=p)||void 0===n?void 0:n.disabled)!==e.disabled)&&f.update(d,l.current);var m={ariaDescribedBy:void 0,targetElementAttributes:{},executeElementAttributes:{}};return d&&(m=function(e,t,n){var o=e.addParentOverflow(t),a=Object(i.a)(n,Object(s.a)(o.keySequences)),c=Object(r.__spreadArrays)(o.keySequences);o.overflowSetSequence&&(c=Object(s.d)(c,o.overflowSetSequence));var u=Object(s.e)(c);return{ariaDescribedBy:a,targetElementAttributes:{"data-ktp-target":u},executeElementAttributes:{"data-ktp-execute-target":u}}}(f,d,e.ariaDescribedBy)),m}n.d(t,"a",(function(){return u}));var u=function(e){var t=e.children,n=c(Object(r.__rest)(e,["children"])),o=n.targetElementAttributes,i=n.executeElementAttributes,a=n.ariaDescribedBy;return t(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},o),i),{"aria-describedby":a}))}},423:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i}));var r="popoutv2",o="1",i="_owa_projection_root"},429:function(e,t,n){"use strict";t.a=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},433:function(e,t,n){"use strict";function r(e){return e&&!!e._virtual}n.d(t,"a",(function(){return r}))},434:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(433);function o(e){var t;return e&&Object(r.a)(e)&&(t=e._virtual.parent),t}},435:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(347);function o(e,t){var n=Object(r.a)(e,(function(e){return e.hasAttribute(t)}));return n&&n.getAttribute(t)}},436:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),o=n(1),i=n(443),a=function(e){function t(t){var n=e.call(this,t)||this;return n._updateComposedComponentRef=n._updateComposedComponentRef.bind(n),n}return Object(r.__extends)(t,e),t.prototype._updateComposedComponentRef=function(e){this._composedComponentInstance=e,e?this._hoisted=Object(i.a)(this,e):this._hoisted&&Object(i.b)(this,this._hoisted)},t}(o.Component)},437:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r,o=n(0),i=n(1),a=n(244),s=n(545),c=n(253),u=n(163),l=n(353),d=n(511),f=n(421),p=n(349),m=Object(c.a)(),g=function(e){function t(t){var n=e.call(this,t)||this;return n._rootRef=i.createRef(),n._createLayerElement=function(){var e=n.props.hostId,t=Object(u.a)(n._rootRef.current),r=n._getHost();if(t&&r){n._removeLayerElement();var o=t.createElement("div"),i=n._getClassNames();o.className=i.root,Object(l.b)(o),Object(d.a)(o,n._rootRef.current),n.props.insertFirst?r.insertBefore(o,r.firstChild):r.appendChild(o),n.setState({hostId:e,layerElement:o},(function(){var e=n.props,t=e.onLayerDidMount,r=e.onLayerMounted;r&&r(),t&&t()}))}},n.state={},n}return Object(o.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this.props.hostId;this._createLayerElement(),e&&Object(p.c)(e,this._createLayerElement)},t.prototype.render=function(){var e=this.state.layerElement,t=this._getClassNames(),n=this.props.eventBubblingEnabled;return i.createElement("span",{className:"ms-layer",ref:this._rootRef},e&&a.createPortal(i.createElement(s.a,Object(o.__assign)({},!n&&function(){r||(r={},["onClick","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOver","onMouseOut","onMouseUp","onTouchMove","onTouchStart","onTouchCancel","onTouchEnd","onKeyDown","onKeyPress","onKeyUp","onFocus","onBlur","onChange","onInput","onInvalid","onSubmit"].forEach((function(e){return r[e]=h})));return r}(),{className:t.content}),this.props.children),e))},t.prototype.componentDidUpdate=function(){this.props.hostId!==this.state.hostId&&this._createLayerElement()},t.prototype.componentWillUnmount=function(){var e=this.props.hostId;this._removeLayerElement(),e&&Object(p.d)(e,this._createLayerElement)},t.prototype._removeLayerElement=function(){var e=this.props.onLayerWillUnmount,t=this.state.layerElement;if(e&&e(),t&&t.parentNode){var n=t.parentNode;n&&n.removeChild(t)}},t.prototype._getClassNames=function(){var e=this.props,t=e.className,n=e.styles,r=e.theme;return m(n,{theme:r,className:t,isNotHost:!this.props.hostId})},t.prototype._getHost=function(){var e=this.props.hostId,t=Object(u.a)(this._rootRef.current);if(t){if(e)return t.getElementById(e);var n=Object(p.a)();return n?t.querySelector(n):t.body}},t.defaultProps={onLayerDidMount:function(){},onLayerWillUnmount:function(){}},t=Object(o.__decorate)([Object(f.a)("Layer",["theme","hostId"])],t)}(i.Component),h=function(e){e.eventPhase===Event.BUBBLING_PHASE&&"mouseenter"!==e.type&&"mouseleave"!==e.type&&"touchstart"!==e.type&&"touchend"!==e.type&&e.stopPropagation()}},438:function(e,t,n){"use strict";var r=n(108),o=n(309),i=n(1),a=n(254),s=n(42);var c=Object(s.a)((function(e){var t=e.categoryContainerClass,n=e.categories,r=e.categoryWellContainerClass,o=e.onCategoryClicked,s=e.categoryList;!function(e){i.useEffect((function(){Object(a.o)("Category_Well_TotalCategories",[e.length],{sessionSampleRate:10})}),[e])}(n);var c=i.useCallback((function(e){var n=e.categoryName,r=e.isLastInWell;return i.createElement(f,{actionSource:"CategoryWell",category:n,containerClassName:t,isLastInWell:r,onCategoryClicked:o,categoryList:s})}),[t,o,s]);return i.createElement("div",{className:r},n.map((function(e,t){return i.createElement(c,{key:e,categoryName:e,isLastInWell:t===n.length-1})})))})),u=n(567),l=n(718),d=n(308).bind(l),f=Object(s.a)((function(e){var t=i.useRef(),n=Object(u.a)((function(){return Object(p.a)(e.category,e.categoryList?e.categoryList:Object(y.a)())})),r={backgroundColor:n.get().primaryColor,borderColor:n.get().secondaryColor,color:n.get().textColor,cursor:e.onCategoryClicked?"pointer":"initial"},o=e.category,s=d(e.containerClassName,e.isLastInWell?l.lastCategoryContainer:l.categoryContainer),c=i.createElement("span",{className:l.categoryName},o);return i.createElement("div",{ref:function(e){return t.current=e},key:o,className:s,style:r,title:o,onMouseEnter:function(){e.onCategoryClicked&&(t.current.style.borderColor=n.get().textColor)},onMouseLeave:function(){e.onCategoryClicked&&(t.current.style.borderColor=n.get().secondaryColor)},onClick:function(t){e.onCategoryClicked&&(Object(a.o)("Category_Well_Click",[e.actionSource]),e.onCategoryClicked(t,e.category,e.actionSource))}},c)})),p=n(417),m=(n(211),n(100)),g=n(720);function h(e){var t=[];return t.push({key:"CategoryMenuItemDiv",onRender:function(){return i.createElement(k,{mailboxInfo:e.mailboxInfo,onAfterCreateNewCategory:e.onAfterCreateNewCategory,addFavoriteCategory:e.addFavoriteCategory,onCheckedCategoryClicked:e.onCheckedCategoryClicked,onUncheckedCategoryClicked:e.onUncheckedCategoryClicked,actionSource:e.actionSource,categoryList:e.categoryList,categoriesToCheck:e.getCategoriesToCheck(),dismissMenu:e.dismissMenu,shouldShowSearchBox:e.shouldShowSearchBox,shouldShowManageCategories:e.shouldShowManageCategories,shouldShowClearCategories:e.getShouldShowClearCategories(),manageCategoriesDisabled:e.manageCategoriesDisabled,createNewCategoryDisabled:e.createNewCategoryDisabled,onManageCategoryClicked:e.onManageCategoryClicked,onClearCategoriesClicked:e.onClearCategoriesClicked})}}),{className:g.categoryMenu,styles:{title:{},container:{},root:{width:e.width?e.width+"px":null},header:{},list:{}},directionalHintFixed:!0,items:t,onMenuDismissed:function(){return j.importAndExecute()},shouldFocusOnMount:!e.shouldShowSearchBox,useTargetWidth:e.useTargetWidth,coverTarget:e.coverTarget,directionalHint:e.directionalHint?e.directionalHint:m.DirectionalHint.bottomLeftEdge,focusZoneProps:{shouldInputLoseFocusOnArrowKey:function(e){return!0}},calloutProps:{className:"customScrollBar"}}}var v=n(590),y=n(415),b=(n(416),n(513));function _(e){return 1===Object(y.a)().filter((function(t){return t.Id===e})).length}var S=n(514),C=n(588);n.d(t,"q",(function(){return A})),n.d(t,"v",(function(){return I})),n.d(t,"z",(function(){return x})),n.d(t,"t",(function(){return E})),n.d(t,"w",(function(){return T})),n.d(t,"s",(function(){return P})),n.d(t,"y",(function(){return w})),n.d(t,"r",(function(){return M})),n.d(t,"x",(function(){return R})),n.d(t,"u",(function(){return j})),n.d(t,"e",(function(){return k})),n.d(t,"c",(function(){return N})),n.d(t,"b",(function(){return D})),n.d(t,"o",(function(){return o.b})),n.d(t,"f",(function(){return c})),n.d(t,"a",(function(){return f})),n.d(t,"g",(function(){return p.a})),n.d(t,"i",(function(){return h})),n.d(t,"k",(function(){return v.a})),n.d(t,"n",(function(){return y.a})),n.d(t,"m",(function(){return b.b})),n.d(t,"l",(function(){return b.a})),n.d(t,"p",(function(){return _})),n.d(t,"h",(function(){return S.a})),n.d(t,"j",(function(){return S.b})),n.d(t,"d",(function(){return C.a}));var O=new r.c((function(){return Promise.all([n.e(5),n.e(6),n.e(85),n.e(688),n.e(204)]).then(n.bind(null,15001))})),A=new r.b(O,(function(e){return e.addMasterCategories})),I=new r.a(O,(function(e){return e.removeMasterCategories})),x=(new r.a(O,(function(e){return e.changeMasterCategories})),new r.a(O,(function(e){return e.updateLastTimeUsedMasterCategories}))),E=new r.a(O,(function(e){return e.getMasterCategoryList})),T=new r.a(O,(function(e){return e.setInitialCategoryDialogViewState})),P=(new r.a(O,(function(e){return e.addCategory})),new r.a(O,(function(e){return e.fetchCategoryDetails}))),w=new r.a(O,(function(e){return e.subscribeToCategoryNotifications})),M=new r.a(O,(function(e){return e.applyCategoryOperationHelper})),R=new r.a(O,(function(e){return e.setIsApplyingCategoryOperation})),j=new r.a(O,(function(e){return e.onMenuDismissed})),k=Object(r.d)(O,(function(e){return e.CategoryMenu})),N=Object(r.d)(O,(function(e){return e.CategoryDialog})),D=Object(r.d)(O,(function(e){return e.CategoryColorPickerHost}))},439:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.zero=0]="zero",e[e.medium=1]="medium",e[e.long=2]="long"}(r||(r={}))},4398:function(e,t,n){"use strict";function r(e){return e.policyMatchDetails.slice().sort((function(e,t){var n=o(t.Action)-o(e.Action);return 0==n?null==e.MatchPriority?null==t.MatchPriority?n:1:null==t.MatchPriority?-1:e.MatchPriority-t.MatchPriority:n}))[0]}function o(e){switch(e){case 1:return 0;case 4:case 2:case 3:return 1;case 5:return 2;default:return 3}}n.d(t,"a",(function(){return r}))},4399:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(27);function o(){return Object(r.a)().PolicyTipsEnabled}},441:function(e,t,n){"use strict";function r(e,t,n){}n.d(t,"a",(function(){return r}))},443:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=["setState","render","componentWillMount","UNSAFE_componentWillMount","componentDidMount","componentWillReceiveProps","UNSAFE_componentWillReceiveProps","shouldComponentUpdate","componentWillUpdate","getSnapshotBeforeUpdate","UNSAFE_componentWillUpdate","componentDidUpdate","componentWillUnmount"];function o(e,t,n){void 0===n&&(n=r);var o=[],i=function(r){"function"!=typeof t[r]||void 0!==e[r]||n&&-1!==n.indexOf(r)||(o.push(r),e[r]=function(){t[r].apply(t,arguments)})};for(var a in t)i(a);return o}function i(e,t){t.forEach((function(t){return delete e[t]}))}},448:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return s}));var r,o=2,i=[window.location.origin];function a(e,t,n){var r={version:o,type:t,serializedData:JSON.stringify(n)};e.postMessage(JSON.stringify(r),"*")}function s(e){if(i.indexOf(e.origin)>=0){var t=void 0;try{t=JSON.parse(e.data)}catch(e){return null}if(t&&o==t.version)return t}return null}!function(e){e[e.Unknown=0]="Unknown",e[e.PopoutReady=1]="PopoutReady",e[e.SetData=2]="SetData",e[e.CloseWindow=3]="CloseWindow"}(r||(r={}))},4569:function(e,t,n){"use strict";var r=n(0),o=n(7),i=60,a=6e4;function s(e){var t=e.split("-");return{year:parseInt(t[0]),month:parseInt(t[1]),day:parseInt(t[2])}}function c(e){var t=Number(e).toFixed(2);return Number(t)}var u="Monday",l="Tuesday",d="Wednesday",f="Thursday",p="Friday",m="Saturday",g="Sunday",h=[u,l,d,f,p].join(" "),v=[m,g].join(" "),y=[h,v].join(" ");function b(e){switch(e){case"mon":return u;case"tue":return l;case"wed":return d;case"thu":return f;case"fri":return p;case"sat":return m;case"sun":return g;case"weekday":return h;case"weekendDay":return v;case"day":return y}return""}function _(e){switch(e){case u:return"mon";case l:return"tue";case d:return"wed";case f:return"thu";case p:return"fri";case m:return"sat";case g:return"sun";case h:return"weekday";case v:return"weekendDay";case y:return"day"}return""}var S=n(161),C="January",O="February",A="March",I="April",x="May",E="June",T="July",P="August",w="September",M="October",R="November",j="December";function k(e){switch(e){case"jan":return C;case"feb":return O;case"mar":return A;case"apr":return I;case"may":return x;case"jun":return E;case"jul":return T;case"aug":return P;case"sep":return w;case"oct":return M;case"nov":return R;case"dec":return j}return""}function N(e){switch(e){case C:return"jan";case O:return"feb";case A:return"mar";case I:return"apr";case x:return"may";case E:return"jun";case T:return"jul";case P:return"aug";case w:return"sep";case M:return"oct";case R:return"nov";case j:return"dec"}return""}var D="First",F="Second",L="Third",U="Fourth",B="Last";function H(e){switch(e){case"first":return D;case"second":return F;case"third":return L;case"fourth":return U;case"last":return B}return""}function W(e){switch(e){case D:return"first";case F:return"second";case L:return"third";case U:return"fourth";case B:return"last"}return""}function V(e){if(null==e.recurrenceType)return null;var t=function(e){var t,n=e.startTime,u=e.endTime,l=e.recurrenceType,d=e.timeZone,f=s(l.RecurrenceRange.StartDate),p=(u.getTime()-n.getTime())/a,m=Object(o.Rb)(d,n.valueOf()).toString().split("T")[1].split(":");t=c(m[0])*i+c(m[1]);var g={startYear:f.year,startMonth:f.month,startDay:f.day,startTimeMin:t,durationMin:p};if(l.RecurrenceRange.EndDate){var h=s(l.RecurrenceRange.EndDate);g=Object(r.__assign)(Object(r.__assign)({},g),{endDay:h.day,endMonth:h.month,endYear:h.year})}else g.noEndDate=!0;return g}(e),n={name:e.timeZone,offset:Object(S.h)(e.startTime,e.timeZone)},u=e.recurrenceType.RecurrencePattern;switch(u.__type){case"DailyRecurrence:#Exchange":return function(e,t,n){return{recurrenceProperties:{interval:e.Interval},recurrenceType:"daily",seriesTimeJson:t,recurrenceTimeZone:n}}(u,t,n);case"WeeklyRecurrence:#Exchange":return function(e,t,n){if(1===e.Interval&&"weekday"===_(e.DaysOfWeek))return{recurrenceProperties:void 0,recurrenceType:"weekday",seriesTimeJson:t,recurrenceTimeZone:n};return{recurrenceProperties:{interval:e.Interval,days:e.DaysOfWeek.split(" ").map(_),firstDayOfWeek:_(e.FirstDayOfWeek)},recurrenceType:"weekly",seriesTimeJson:t,recurrenceTimeZone:n}}(u,t,n);case"AbsoluteMonthlyRecurrence:#Exchange":return function(e,t,n){return{recurrenceProperties:{interval:e.Interval,dayOfMonth:e.DayOfMonth},recurrenceType:"monthly",seriesTimeJson:t,recurrenceTimeZone:n}}(u,t,n);case"RelativeMonthlyRecurrence:#Exchange":return function(e,t,n){return{recurrenceProperties:{interval:e.Interval,dayOfWeek:_(e.DaysOfWeek),weekNumber:W(e.DayOfWeekIndex)},recurrenceType:"monthly",seriesTimeJson:t,recurrenceTimeZone:n}}(u,t,n);case"AbsoluteYearlyRecurrence:#Exchange":return function(e,t,n){return{recurrenceProperties:{interval:0,dayOfMonth:e.DayOfMonth,month:N(e.Month)},recurrenceType:"yearly",seriesTimeJson:t,recurrenceTimeZone:n}}(u,t,n);case"RelativeYearlyRecurrence:#Exchange":return function(e,t,n){return{recurrenceProperties:{interval:0,dayOfWeek:_(e.DaysOfWeek),weekNumber:W(e.DayOfWeekIndex),month:N(e.Month)},recurrenceType:"yearly",seriesTimeJson:t,recurrenceTimeZone:n}}(u,t,n)}return null}var z=60;function G(e,t,n,r){var o=Math.floor(r/z);return r-=o*z,new Date(Date.UTC(e,t-1,n,o,r))}function q(e,t){switch(e){case"daily":return function(e){return{__type:"DailyRecurrence:#Exchange",Interval:e.interval}}(t);case"weekday":return{__type:"WeeklyRecurrence:#Exchange",Interval:1,FirstDayOfWeek:"Monday",DaysOfWeek:"Monday Tuesday Wednesday Thursday Friday"};case"weekly":return function(e){return{__type:"WeeklyRecurrence:#Exchange",Interval:e.interval,FirstDayOfWeek:b(e.firstDayOfWeek),DaysOfWeek:e.days.map(b).join(" ")}}(t);case"monthly":return function(e){return e.dayOfMonth?{__type:"AbsoluteMonthlyRecurrence:#Exchange",DayOfMonth:e.dayOfMonth,Interval:e.interval}:{__type:"RelativeMonthlyRecurrence:#Exchange",Interval:e.interval,DaysOfWeek:b(e.dayOfWeek),DayOfWeekIndex:H(e.weekNumber)}}(t);case"yearly":return function(e){return e.dayOfMonth?{__type:"AbsoluteYearlyRecurrence:#Exchange",Month:k(e.month),DayOfMonth:e.dayOfMonth}:{__type:"RelativeYearlyRecurrence:#Exchange",Month:k(e.month),DaysOfWeek:b(e.dayOfWeek),DayOfWeekIndex:H(e.weekNumber)}}(t);default:return null}}function K(e,t,n){return e+"-"+X(t)+"-"+X(n)}function X(e){return e<10?"0"+e:""+e}var J=n(103);function Q(e){if(null==e)return null;var t,n,r,o=e.seriesTimeJson,i=e.recurrenceProperties,a=e.recurrenceType,s=e.recurrenceTimeZone,c=o.startDay,u=o.startMonth,l=o.startYear,d=o.startTimeMin,f=o.durationMin;return t=s?s.name:Object(J.q)(),{recurrenceType:{__type:"RecurrenceType:#Exchange",RecurrenceRange:(n=o,r=K(n.startYear,n.startMonth,n.startDay),n.noEndDate?{__type:"NoEndRecurrence:#Exchange",StartDate:r}:{__type:"EndDateRecurrence:#Exchange",StartDate:r,EndDate:K(n.endYear,n.endMonth,n.endDay)}),RecurrencePattern:q(a,i)},timeZone:t,startTime:G(l,u,c,d),endTime:G(l,u,c,d+f)}}function Z(e,t,n){return e>=1601&&t>=1&&t<=12&&n>=1&&n<=31}function Y(e,t,n){var r=new Date;return r.setFullYear(e),r.setMonth(t-1),r.setDate(n),r}function $(e){return null==e||!!e.recurrenceType&&(!(!e.seriesTimeJson||!function(e){if(!e)return!1;if(!Z(e.startYear,e.startMonth,e.startDay))return!1;if(!e.noEndDate){if(!Z(e.endYear,e.endMonth,e.endDay))return!1;if(Y(e.startYear,e.startMonth,e.startDay)>=Y(e.endYear,e.endMonth,e.endDay))return!1}return!(e.startTimeMin<0||e.durationMin<0)}(e.seriesTimeJson))&&!!function(e,t){switch(e){case"daily":return function(e){if(!e)return!1;if(!e.interval||e.interval<1)return!1;return!0}(t);case"weekly":return function(e){if(!e)return!1;if(!e.interval||e.interval<1)return!1;if(!e.days||e.days.length<1)return!1;if(!e.firstDayOfWeek)return!1;return!0}(t);case"monthly":return function(e){if(!e)return!1;if(!e.interval||e.interval<1)return!1;if(e.dayOfMonth&&!e.dayOfWeek&&!e.weekNumber)return!0;if(e.dayOfWeek&&e.weekNumber&&!e.dayOfMonth)return!0;return!1}(t);case"yearly":return function(e){if(!e)return!1;if(!e.interval||e.interval<1)return!1;if(!e.month)return!1;if(e.dayOfMonth&&!e.dayOfWeek&&!e.weekNumber)return!0;if(e.dayOfWeek&&e.weekNumber&&!e.dayOfMonth)return!0;return!1}(t);case"weekday":return!t}}(e.recurrenceType,e.recurrenceProperties))}n.d(t,"a",(function(){return V})),n.d(t,"b",(function(){return Q})),n.d(t,"c",(function(){return $}))},4575:function(e,t,n){"use strict";var r=n(0),o=n(1013),i="permission";n(2425);var a="DefaultSettings",s="0",c={cache:function(e,t){var n,c,u=e.addinCommand,d=u.extension,f="Preinstalled"===d.TypeString&&2!==d.ConsentState?function(e){var t,n=function(e){switch(e){case 1:return"ReadItem";case 2:return"ReadWriteMailbox";case 3:return"ReadWriteItem";default:return"Restricted"}}(e),r=Object(o.s)().ConsentUrl;if(r.indexOf("?")>0)t=(a=r.split("?"))[0]+"?"+i+"="+n+"&"+a[1];else if(r.indexOf("#")>0){var a;t=(a=r.split("#"))[0]+"?"+i+"="+n+"#"+a[1]}else t=r+"?"+i+"="+n;return t}(d.RequestedCapabilities):u.get_EntryPoint();c=l(f,t),n=function(e,t,n){var o=n._sourceLocations[t];return new OSF.Manifest.Manifest((function(t){t._id=e.get_Id(),t._version=e.extension.Version,t._extensionSettings={},t._displayNames={},t._defaultLocale="",t._displayNames[s]=e.extension.DisplayName,t._extensionSettings[a]=n,t._appDomains=Object(r.__spread)(e.extension.AppDomains,[o])}))}(u,t,c),OSF.OsfManifestManager.cacheManifest(u.extension.Id,u.extension.Version,n)}},u={cache:function(e,t){var n=e.addinCommand,r=e.controlId,o=e.sourceLocation,i=function(e,t,n,r){var o=OSF.OsfManifestManager.getCachedManifest(e.extension.Id,e.extension.Version),i=OfficeExt.AddinCommandsManifestManager.createManifestForAddinAction(o,r,null,t);return i._extensionSettings={},i._extensionSettings[a]=l(r,n),i}(n,r,t,o);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(i,r,n.extension.Version)}};function l(e,t){var n=new OSF.Manifest.ExtensionSettings;return n._sourceLocations={},n._sourceLocations[t]=e,n}var d=n(8475),f=n(9);var p=function(e){return function(){window.open(e.extension.EndNodeUrl)}};function m(e){switch(e){case 0:case 3:case 1:return 2;case 2:default:return 0}}var g=n(2),h=n(103),v={sets:[{name:"mailbox",maxVersion:"1.8"},{name:"DialogAPI"},{name:"react"}]};var y=["progress.gif","agavedefaulticon96x96.png","moe_status_icons.png"],b=["moeerrorux.css"],_="resources/images/osfruntime/",S="resources/styles/osfruntime/";function C(e,t,n){t.getLocalizedCSSFilePath=O(b,Object(g.u)()+S),t.getLocalizedImageFilePath=O(y,Object(g.u)()+_),t._notifyHostError=t._notifyHost,t._hostType="Outlook",t._hostPlatform="Web",t._hostSpecificFileVersion="16.01",t.getRequirementsChecker().setRequirements(v)}function O(e,t){return function(n){var r=e.filter((function(e){return n==e}))[0];return(r=function(e){if(!Object(h.w)())return e;switch(e){case"moeerrorux.css":return"moerroruxrtl.css";default:return e}}(r))?t+r:""}}var A=n(3218),I=n(3040),x=function(e){return function(t,n){if(t){var r=t.ApiParams,o=j(t.MethodData.ControlId),i=t.MethodData.DispatchId;Object(A.i)(e,i,o,r,n)}}},E=function(e,t,n){Object(I.c)(e,n,t)},T=function(e,t,n){n.controlId=j(n.controlId),n.eventDispId=function(e){if(e==I.a.DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID)return I.a.DISPLAY_DIALOG_DISPID;return e}(n.eventDispId),Object(I.j)(n,t)},P=[{name:"GetInitialData",isBlocking:!0,action:x},{name:"executeMethod",isBlocking:!1,action:function(e){return function(t,n){if(t){var r=j(t.DdaMethod.ControlId),o=t.DdaMethod.DispatchId;Object(A.i)(e,o,r,t,n)}}}},{name:"ExecuteMethod",isBlocking:!1,action:x}];function w(e){return[{name:"appCommandInvoked",registerAction:OfficeExt.AddinCommandsRuntimeManager.registerEvent,unregisterAction:OfficeExt.AddinCommandsRuntimeManager.unregisterEvent},{name:"dialogMessageReceived",registerAction:E,unregisterAction:T},{name:"dialogNotificationShown",registerAction:E,unregisterAction:T},{name:"olkItemSelectedChanged",registerAction:E,unregisterAction:T},{name:"olkAppointmentTimeChanged",registerAction:E,unregisterAction:T},{name:"olkRecipientsChanged",registerAction:E,unregisterAction:T},{name:"olkRecurrenceChanged",registerAction:E,unregisterAction:T},{name:"olkEnhancedLocationsChanged",registerAction:E,unregisterAction:T},{name:"olkAttachmentsChanged",registerAction:E,unregisterAction:T}]}function M(e,t){P.forEach((function(n){t.registerMethod(n.name,n.action(e),Microsoft.Office.Common.InvokeType.async,n.isBlocking)})),w().forEach((function(e){t.registerEventEx(e.name,e.registerAction,Microsoft.Office.Common.InvokeType.asyncRegisterEvent,e.unregisterAction,Microsoft.Office.Common.InvokeType.asyncUnregisterEvent)}))}function R(e,t){P.forEach((function(e){return t.unregisterMethod(e.name)})),w().forEach((function(e){return t.unregisterEvent(e.name)}))}function j(e){var t=Object(o.t)().activeDialog;return t&&t.controlId===e?t.parentControlId:e}var k=n(1046),N=n(6208);function D(e,t,n){var r=t.addinCommand,i=t.controlId,a=t.isDialog,s=r.extension.Settings?JSON.parse(r.extension.Settings):{},c=function(e,t){var n,r=Object(k.c)(t);return JSON.stringify({userType:Object(N.a)(),userId:Object(g.i)(),extensionType:e.extension.TypeString,module:Object(g.e)(),deployment:Object(g.q)(),scenario:Object(o.z)(t),clientVersion:Object(g.j)(),isPinned:null===(n=null==r?void 0:r.isAddinPinned)||void 0===n?void 0:n.call(r,e.extension.Id),react:!0,disableLogging:!1})}(r,e);return{div:n,id:i,marketplaceID:a?i:r.extension.Id,marketplaceVersion:r.extension.Version,settings:s,store:"",storeType:OSF.StoreType.Exchange,hostCustomMessage:c,isDialog:a,isVirtualOsfControl:!1}}var F=n(9964),L=n(5501),U=n(76),B=n(254),H=function(){function e(e,t,n,o,i,a){var s,c,u=this;this.notifyHost=function(e,t,n){return Object(r.__awaiter)(u,void 0,void 0,(function(){var o,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(o=this.notifyHostActions)&&(i=o[t])?[4,i(e,n)]:[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},this.hostItemIndex=e,this.addinCommandTelemetry=a,this.contextActivationManager=(s=Object(h.k)(),c=this.notifyHost,OSF.AppSpecificSetup._setupFacade=C,new OSF.ContextActivationManager({appName:64,appVersion:"16.01",clientMode:1,appUILocale:s,lcid:s,notifyHost:c,dataLocale:"",hostControl:{},localizedScriptsUrl:OSF.getLocalizedStringsFilePath(),docUrl:""})),this.notifyHostActions=n||{},this.onInsertOsfControlAction=o,this.onDisplayNotificationAction=i,this.manifestCacheProvider=t;var l=this.notifyHostActions[8];this.notifyHostActions[8]=function(e,t){return Object(r.__awaiter)(u,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){return l&&l(e,t),this.notifyHostError(e,t),this.tryTerminateUiLessAddin(t.errorCode,e),[2]}))}))},this.notifyHostActions[23]=this.sendTelemetryEvent.bind(this)}return e.prototype.insertOsfControl=function(e,t){M(this.hostItemIndex,this.contextActivationManager._serviceEndPoint),this.activeOsfControl=e,this.extensionContainer=t,this.manifestCacheProvider.cache(e,Object(h.k)()),this.contextActivationManager.insertOsfControl(D(this.hostItemIndex,this.activeOsfControl,t))},e.prototype.purgeOsfControl=function(){if(this.activeOsfControl&&this.extensionContainer){var e=this.activeOsfControl.controlId;R(this.hostItemIndex,this.contextActivationManager._serviceEndPoint),Object(I.b)(e),this.contextActivationManager.purgeOsfControl(e,!1),this.activeOsfControl=null,this.extensionContainer=null}},e.prototype.onInsertOsfControl=function(){var e=this.activeOsfControl.addinCommand.extension;("User"==e.OriginString||"Organization"==e.OriginString)&&o.k.Context&&o.k.Context.IsInOrgMarketplaceRole&&this.tryDisplayNotification(e.AppStatus,e.LicenseType),this.onInsertOsfControlAction&&this.onInsertOsfControlAction()},e.prototype.notifyAgave=function(e){var t=this.activeOsfControl.controlId;this.contextActivationManager.notifyAgave(t,e)},e.prototype.updateHostItemIndex=function(e){R(this.hostItemIndex,this.contextActivationManager._serviceEndPoint),this.hostItemIndex=e,M(e,this.contextActivationManager._serviceEndPoint)},e.prototype.dispose=function(){this.contextActivationManager.dispose(),this.contextActivationManager=null},e.prototype.notifyHostError=function(e,t){var n;Object(L.e)(!1,null===(n=this.activeOsfControl)||void 0===n?void 0:n.addinCommand,this.hostItemIndex,Object(o.r)(e),this.addinCommandTelemetry,e,t.errorCode)},e.prototype.sendTelemetryEvent=function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,n,o,i,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(U.h)("addin-oteljs")?[4,Object(B.g)(t.telemetryProperties.ariaTenantToken)]:[3,2];case 1:e=r.sent(),n=Object(F.a)(t,[],Date.now()),o=this.activeOsfControl,i=o.addinCommand,a=o.controlId,Object(L.a)(n,i,this.hostItemIndex,a),e.logEvent(n),r.label=2;case 2:return[2]}}))}))},e.prototype.displayNotification=function(e){this.contextActivationManager.displayNotification(e),this.onDisplayNotificationAction&&this.onDisplayNotificationAction(e)},e.prototype.tryDisplayNotification=function(e,t){var n=this.activeOsfControl,r=n.addinCommand,o=n.controlId;if(e){var i=function(e,t,n){var r="",o="",i=!1,a=!1;switch(n){case"1.0":r=Object(f.b)(d.b),o=Object(f.b)(d.l),i=!0,a=!0;break;case"1.1":r=Object(f.b)(d.c),o=Object(f.b)(d.l),i=!0,a=!0;break;case"1.2":r=Object(f.b)(d.d),o=Object(f.b)(d.l),i=!0,a=!0;break;case"2.0":r=Object(f.b)(d.e),o=Object(f.b)(d.l);break;case"2.1":r=Object(f.b)(d.f),o=Object(f.b)(d.l);break;case"3.0":r=Object(f.b)(d.g),o=Object(f.b)(d.k);break;case"3.1":r=Object(f.b)(d.h),o=Object(f.b)(d.k);break;case"3.2":r=Object(f.b)(d.i),o=Object(f.b)(d.k);break;case"3.3":r=Object(f.b)(d.j),o=Object(f.b)(d.k);break;default:return null}return{infoType:1,id:e,title:Object(f.b)(d.m),description:r,buttonTxt:o,buttonCallback:p(t),detailView:i,displayDeactive:a,reDisplay:!0}}(o,r,e);i&&this.displayNotification(i)}else 1==t&&this.displayNotification(function(e,t){return{infoType:2,id:t,title:Object(f.b)(d.n),description:Object(f.b)(d.o),buttonTxt:Object(f.b)(d.a),buttonCallback:function(){window.open(e.extension.EndNodeUrl)},reDisplay:!0}}(r,o))},e.prototype.tryTerminateUiLessAddin=function(e,t){if(1042==e){Object(o.cb)(t,this.hostItemIndex,o.d.TimedOut,{allowEvent:!1})}},e}();n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return m})),n.d(t,"c",(function(){return H}))},4585:function(e,t,n){"use strict";var r=n(9),o=n(5875),i=n(1401),a=n(1770),s=n(25),c=n(0);function u(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(c.__assign)({__type:"GetDlpPolicyTipsRequest:#Exchange"},n)),Object(s.a)("GetDlpPolicyTips",e,t)}var l=n(295),d=n(1579),f=n(283),p=n(3100),m=n(4398),g=n(76),h=n(79),v=Object(f.action)("triggerPolicyTips")((function(e,t,n,r,i){var a,s=e.policyTipsViewState;if(!(s.handlerDisabled||Object(g.h)("cmp-dlp-check-irmdata")&&(null===(a=e.protectionViewState)||void 0===a?void 0:a.IRMData))){var c,l=s.inProgressPolicyMatch,f=s.succeededPolicyMatch,m=s.pendingPolicyMatch;if(n||(n=_(e.subject)),r||(r=_(e.content)),i||(i=Object(o.a)(e)),s.isRequestInProgress)s.pendingRequests=!0,m.itemId=e.itemId,m.subjectChecksum=n,m.contentChecksum=r,m.eventTrigger=t,m.attachmentIds=i;else{if(s.pendingRequests=!1,l.itemId=e.itemId,l.subjectChecksum=n,l.contentChecksum=r,l.eventTrigger=t,l.attachmentIds=i,0==(c=l).subjectChecksum&&0==c.contentChecksum&&0==c.attachmentIds.length)return f.policyMatchDetails=[],f.subjectChecksum=0,f.contentChecksum=0,f.attachmentIds=[],void Object(d.a)(e,"dlpPolicyTips");(S(l,f)||function(e,t){if(e.attachmentIds.length!=t.attachmentIds.length)return!0;for(var n=0;n<e.attachmentIds.length;n++)if(null!=e.attachmentIds[n]&&null!=t.attachmentIds[n]&&e.attachmentIds[n].Id!=t.attachmentIds[n].Id)return!0;return!1}(l,f)||1==t)&&function(e){var t=e.policyTipsViewState,n=t.succeededPolicyMatch,r=t.inProgressPolicyMatch,o=e.itemId;if(null==o?void 0:o.Id){var i={ItemId:o,ClientSupportsScanResultData:!0,ScanResultData:n.scanResultData,ScanResultMetadata:n.scanResultMetaData,BodyOrSubjectChanged:S(r,n),NeedToReclassify:!n.itemId,CustomizedStringsNeeded:!0,Recipients:Object(p.a)(e),EventTrigger:r.eventTrigger};e.policyTipsViewState.isRequestInProgress=!0,u(i).then((function(t){!function(e,t,n,r){var o=t.policyTipsViewState,i=o.pendingPolicyMatch;o.isRequestInProgress=!1,o.pendingRequests&&i&&v(t,i.eventTrigger,i.subjectChecksum,i.contentChecksum,i.attachmentIds);0==e.EvaluationResult||1==e.OptimizationResult||2==e.EvaluationResult?n(t,e):r(t,e)}(t,e,y,b)}))}}(e)}}}));t.a=v;function y(e,t){var n,r=e.policyTipsViewState,o=r.succeededPolicyMatch,s=r.inProgressPolicyMatch;o.itemId=s.itemId,o.attachmentIds=s.attachmentIds,o.subjectChecksum=s.subjectChecksum,o.contentChecksum=s.contentChecksum,o.policyMatchDetails=t.Matches,t.ScanResultData&&(o.scanResultData=t.ScanResultData),t.ScanResultMetadata&&(o.scanResultMetaData=t.ScanResultMetadata),1==t.OptimizationResult&&(r.handlerDisabled=!0),function(e,t){if(t){var n=e.policyTipsViewState,r={complianceUrl:t.ComplianceURL,blockString:t.PolicyTipMessageBlockString,notifyString:t.PolicyTipMessageNotifyString,overrideString:t.PolicyTipMessageOverrideString};Object(a.a)(n,r,(function(e,t){return t||e}))}}(e,t.CustomizedStrings),n=e,Object(d.a)(n,["consumerDlpPolicyTips","enterpriseDlpPolicyTips"]),Object(m.a)(n.policyTipsViewState.succeededPolicyMatch)&&(Object(l.a)()?Object(i.a)(n,"consumerDlpPolicyTips"):Object(i.a)(n,"enterpriseDlpPolicyTips"))}function b(e,t){var n=e.policyTipsViewState;t?(h.g.warn(Object(r.c)("PolicyTips failed with EvaluationResult code of: {0}",t.EvaluationResult)+" Diagnostic: "+t.DiagnosticData),4!=t.EvaluationResult&&7!=t.EvaluationResult&&1!=t.EvaluationResult&&6!=t.EvaluationResult&&8!=t.EvaluationResult||(h.g.warn("Disabling further PolicyTips requests because of the failure"),n.handlerDisabled=!0)):(h.g.warn("PolicyTipsResponse is null (PolicyTipsRequest is timed out)"),n.handlerDisabled=!0),Object(d.a)(e,"dlpPolicyTips")}function _(e){var t=0;if(e)for(var n=0;n<e.length;n++)t+=e.charCodeAt(n);return t}function S(e,t){return e.subjectChecksum!=t.subjectChecksum||e.contentChecksum!=t.contentChecksum}},4666:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(1347),o=n(108),i=new o.c((function(){return Promise.all([n.e(0),n.e(10),n.e(12),n.e(15),n.e(330)]).then(n.bind(null,7594))})),a=Object(r.a)(i,(function(e){return e.AtMentionPickerPlugin}),"AtMentionsPicker",(function(e){return 10==e.eventType})),s=new o.b(i,(function(e){return e.loadAtMentionsData}))},4698:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var r=function(e,t,n){return void 0===e&&(e=!1),void 0===t&&(t=!1),void 0===n&&(n=0),{shouldEncryptMessageAsSmime:e,shouldSignMessageAsSmime:t,signingCertRawData:null,errorCode:n,errorContext:0,smimeBccForkingMode:0,currentBccRecipientIndex:-1}};function o(e){switch(e){case 6:return r(!0,!1);case 10:case 11:return r(!1,!0);case 12:case 13:case 14:return r(!0,!0);case-1:case 0:default:return r()}}},4699:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return s}));var r="msip_labels",o="X-MS-Exchange-Organization-ModifySensitivityLabel",i="00000000-0000-0000-0000-000000000000",a="Standard",s="Privileged"},4700:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var r={Name:{id:34230,propertyType:"String"},Description:{id:34231,propertyType:"String"},Id:{id:34232,propertyType:"String"},IsClassified:{id:34229,propertyType:"Boolean"}},o="messageClassification"},4701:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(484),o=n(1200),i=n(964),a=n(1290),s=n(1664),c=n(76),u=n(5880);function l(e){var t=Object(r.a)({BaseShape:"IdOnly",ClientSupportsIrm:!0,FilterHtmlContent:!0,InlineImageCustomDataTemplate:o.e,InlineImageUrlOnLoadTemplate:"",InlineImageUrlTemplate:o.f,AdditionalProperties:[Object(i.a)({FieldURI:"ItemLastModifiedTime"})]});return Object(u.a)(t),e&&(t.BodyType=e),t.ImageProxyCapability=Object(c.h)("rp-replyImageProxy")&&Object(a.a)()?s.a.OwaConnectorsProxyAndCompose:s.a.None,t}},4702:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(27);function o(e){return e===Object(r.a)().SessionSettings.UserEmailAddress}},4769:function(e,t,n){"use strict";var r=n(4924),o=n(4085),i=n(1159),a=n(27),s=n(295);var c=n(5380);function u(){var e,t,n=(e=Object(a.a)(),t=Object(s.a)()?e.SessionSettings.DefaultFromAddress:e.UserOptions.SendAddressDefault,Object(i.c)(t)?t:Object(o.a)()),u=Object(o.a)();if(u===n&&Object(c.a)(n)){var l=Object(r.b)(u,!0);if(l&&l.length>0)return l[0]}return n}var l=n(6331),d=n(963);function f(e){var t;if(e){var n=Object(d.i)(),r=null==n?void 0:n.items,o=r&&r.has(e.Id)&&r.get(e.Id);t=o&&Object(l.a)(o.ToRecipients,o.CcRecipients)}return{MailboxType:"Mailbox",RoutingType:"SMTP",EmailAddress:t||u(),Name:Object(a.a)().SessionSettings.UserDisplayName}}n.d(t,"a",(function(){return f}))},480:function(e,t,n){"use strict";var r=n(568),o="object"==typeof self&&self&&self.Object===Object&&self,i=r.a||o||Function("return this")();t.a=i},481:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var r="owsserver",o="owsapi"},4816:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1013);function o(e){var t=Object(r.A)("NonPersistent");!t||e&&t.hostItemIndex!==e||Object(r.bb)("NonPersistent")}},4817:function(e){e.exports=JSON.parse('{"a":"KFa"}')},4818:function(e){e.exports=JSON.parse('{"a":"EFa","b":"FFa"}')},4819:function(e){e.exports=JSON.parse('{"a":"xFa"}')},482:function(e,t,n){"use strict";var r=function(){function e(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}return e.prototype.add=function(e){this.taskList.unshift(e),this.scheduleTask()},e.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},e.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},e.prototype.scheduleTask=function(){var e=this;this.canRunMoreTasks()&&setTimeout((function(){e.tryRunTask()}),this.taskDelay)},e.prototype.tryRunTask=function(){this.canRunMoreTasks()&&this.runTask()},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e.prototype.runTask=function(){var e=this,t=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(t).then((function(){e.onTaskComplete()})).catch((function(){e.onTaskComplete()})),this.scheduleTask()},e}();n.d(t,"a",(function(){return r}))},4820:function(e){e.exports=JSON.parse('{"a":"wFa"}')},4821:function(e){e.exports=JSON.parse('{"a":"uFa"}')},4822:function(e){e.exports=JSON.parse('{"a":"tFa"}')},4823:function(e){e.exports=JSON.parse('{"a":"eFa"}')},4824:function(e){e.exports=JSON.parse('{"a":"cFa"}')},4825:function(e){e.exports=JSON.parse('{"a":"$Ea"}')},4826:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r={};function o(){return r}},4827:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(7669),o=n(4826),i=n(7621);function a(e,t){s(Object(r.a)(e),t)}function s(e,t){var n=t?t.addinId:"",r=t?t.commandId:"";Object(o.a)()[e]=t||void 0,Object(i.b)(e,n,r)}},4828:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),o=n(1),i=n(3468),a=n(4575),s=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.refCallback=function(e){e&&(r.extensionContainer=e,r.osfControlAdapter.insertOsfControl(r.props,r.extensionContainer))},r.handlerContainerOnFocus=function(){r.notifyAgave(11)},r.osfControlAdapter=r.props.osfControlAdapter?r.props.osfControlAdapter:new a.c(t.hostItemIndex,t.manifestCacheProvider,t.notifyHostActions,t.onInsertOsfControl,t.onDisplayNotification,t.addinCommandTelemetry),r}return Object(r.__extends)(t,e),t.prototype.componentDidMount=function(){this.osfControlAdapter.onInsertOsfControl()},t.prototype.UNSAFE_componentWillReceiveProps=function(e){Object(i.c)()&&this.isNewHostItemIndex(e)&&this.osfControlAdapter.updateHostItemIndex(e.hostItemIndex)},t.prototype.shouldComponentUpdate=function(e){return this.isNewOsfControl(e)},t.prototype.componentWillUpdate=function(){this.osfControlAdapter.purgeOsfControl()},t.prototype.componentDidUpdate=function(){this.osfControlAdapter.onInsertOsfControl()},t.prototype.componentWillUnmount=function(){this.osfControlAdapter.purgeOsfControl(),this.osfControlAdapter.dispose(),this.osfControlAdapter=null},t.prototype.notifyAgave=function(e){this.osfControlAdapter.notifyAgave(e)},t.prototype.isNewOsfControl=function(e){return this.props.controlId!=e.controlId},t.prototype.isNewHostItemIndex=function(e){return this.props.hostItemIndex!=e.hostItemIndex},t.prototype.render=function(){return this.extensionContainer&&this.osfControlAdapter.insertOsfControl(this.props,this.extensionContainer),o.createElement("div",{ref:this.refCallback,style:this.props.style,className:this.props.className,onFocus:this.handlerContainerOnFocus})},t}(o.Component)},483:function(e,t,n){"use strict";var r=n(108),o=n(584),i=n(487),a=n(42),s=n(1),c=n(486),u=n(348),l=n(76),d=n(376),f=n(905),p=n(715),m=Object(a.a)((function(e){s.useEffect((function(){Object(l.h)("rp-popoutsDebug")||g()}),[]);return s.createElement("div",{className:p.view},Object(u.a)().state==d.a.Loading?s.createElement("span",null,s.createElement(f.a,null),e.loadingString):s.createElement("button",{onClick:g},"Get Data"))}));function g(){Object(c.a)()}var h=n(114);function v(e,t,n,r){var o="";if(r)o="readimid/",o+=encodeURIComponent(btoa(r));else{if(o=n?"readconv/":"read/",e&&e.type==h.a.GroupMailbox){o+="group/";var i=e.mailboxSmtpAddress.split("@");o+=i[1]+"/"+i[0]+"/"}o+=encodeURIComponent(n||t)}return o}n.d(t,"g",(function(){return b})),n.d(t,"c",(function(){return o.a})),n.d(t,"h",(function(){return i.a})),n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return d.a})),n.d(t,"f",(function(){return u.a})),n.d(t,"d",(function(){return c.b})),n.d(t,"e",(function(){return v}));var y=new r.c((function(){return n.e(474).then(n.bind(null,15071))})),b=new r.b(y,(function(e){return e.bootPopout}))},484:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"ItemResponseShape:#Exchange"},e)}},485:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=n(14),o=r.AnimationVariables.durationValue2,i={root:"ms-Modal",main:"ms-Dialog-main",scrollableContent:"ms-Modal-scrollableContent",isOpen:"is-open",layer:"ms-Modal-Layer"},a=function(e){var t,n=e.className,a=e.containerClassName,s=e.scrollableContentClassName,c=e.isOpen,u=e.isVisible,l=e.hasBeenOpened,d=e.modalRectangleTop,f=e.theme,p=e.topOffsetFixed,m=e.isModeless,g=e.layerClassName,h=e.isDefaultDragHandle,v=f.palette,y=f.effects,b=f.fonts,_=Object(r.getGlobalClassNames)(i,f);return{root:[_.root,b.medium,{backgroundColor:"transparent",position:m?"absolute":"fixed",height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",opacity:0,pointerEvents:"none",transition:"opacity "+o},p&&l&&{alignItems:"flex-start"},c&&_.isOpen,u&&{opacity:1,pointerEvents:"auto"},n],main:[_.main,{boxShadow:y.elevation64,borderRadius:y.roundedCorner2,backgroundColor:v.white,boxSizing:"border-box",position:"relative",textAlign:"left",outline:"3px solid transparent",maxHeight:"calc(100% - 32px)",maxWidth:"calc(100% - 32px)",minHeight:"176px",minWidth:"288px",overflowY:"auto",zIndex:m?r.ZIndexes.Layer:void 0},p&&l&&{top:d},h&&{cursor:"move"},a],scrollableContent:[_.scrollableContent,{overflowY:"auto",flexGrow:1,maxHeight:"100vh",selectors:(t={},t["@supports (-webkit-overflow-scrolling: touch)"]={maxHeight:window.innerHeight},t)},s],layer:m&&[g,_.layer,{position:"static",width:"unset",height:"unset"}],keyboardMoveIconContainer:{position:"absolute",display:"flex",justifyContent:"center",width:"100%",padding:"3px 0px"},keyboardMoveIcon:{fontSize:b.xLargePlus.fontSize,width:"24px"}}}},486:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return d}));var r,o=n(0),i=n(487),a=n(448),s=n(376),c=n(348),u=!1;function l(){Object(i.a)(s.a.Loading),r?r():u=!0}function d(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return u?[3,2]:[4,new Promise((function(e){r=function(){e()}}))];case 1:t.sent(),t.label=2;case 2:return[2,Object(c.a)().isPopoutV2?new Promise((function(t,n){var r=function(n){var o=Object(a.b)(n);if(o&&o.type==a.a.SetData){window.removeEventListener("message",r);var i=void 0;try{i=e?e(o.serializedData):JSON.parse(o.serializedData)}catch(e){}t(i)}};window.addEventListener("message",r);try{var o=window.opener;Object(a.c)(o,a.a.PopoutReady,null)}catch(e){t(null)}})):Promise.resolve(null)]}}))}))}},487:function(e,t,n){"use strict";var r=n(348),o=n(4);t.a=Object(o.mutatorAction)("setPopoutChildState",(function(e){Object(r.a)().state=e}))},488:function(e,t,n){"use strict";function r(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.filter((function(e){return e})).join(" ").trim();return""===n?void 0:n}n.d(t,"a",(function(){return r}))},4924:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}));var r=n(4085),o=n(5380),i=n(27),a=n(295);function s(e){var t=[],n=Object(r.a)();Object(o.a)(n)||t.push(n);var a=c(n,e);return t=function(e){var t=Object(i.a)().SessionSettings.ConnectedAccountInfos;t&&t.length>0&&t.forEach((function(t){-1==e.lastIndexOf(t.EmailAddress)&&e.push(t.EmailAddress)}));return e}(t=t.concat(a))}function c(e,t){var n=[];if(Object(a.a)()||t){var r=function(e){return u(e,Object(i.a)().SessionSettings.UserProxyAddresses)}(e);n=n.concat(r)}if(Object(a.a)()){var o=function(e){return u(e,Object(i.a)().SessionSettings.NotManagedEmailAddresses)}(e);n=n.concat(o)}return n}function u(e,t){var n=[];return t&&t.length>0&&t.forEach((function(t){e==t||Object(o.a)(t)||n.push(t)})),n}},4925:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(27);function o(e,t){return e===t||e&&t&&e.toLowerCase()==t.toLowerCase()}function i(e){return e&&o(e.EmailAddress,Object(r.a)().SessionSettings.UserEmailAddress)}},4926:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r="<div id=appendonsend></div>";function o(e){var t="";return"HTML"==e&&(t+=r),t}},4927:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1289),o=n(296),i=n(1920),a=n(1691);function s(e){return Object(a.a)({Path:Object(o.a)(e.ExtendedFieldURI),Item:Object(i.a)({ExtendedProperty:[Object(r.a)(e)]})})}},507:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Parent=0]="Parent",e[e.Self=1]="Self"}(r||(r={}))},511:function(e,t,n){"use strict";function r(e,t){var n=e,r=t;n._virtual||(n._virtual={children:[]});var o=n._virtual.parent;if(o&&o!==t){var i=o._virtual.children.indexOf(n);i>-1&&o._virtual.children.splice(i,1)}n._virtual.parent=r||void 0,r&&(r._virtual||(r._virtual={children:[]}),r._virtual.children.push(n))}n.d(t,"a",(function(){return r}))},512:function(e,t,n){"use strict";function r(e,t,n){void 0===n&&(n=0);for(var r=-1,o=n;e&&o<e.length;o++)if(t(e[o],o)){r=o;break}return r}function o(e,t){var n=r(e,t);if(!(n<0))return e[n]}function i(e,t){for(var n=[],r=0;r<e;r++)n.push(t(r));return n}function a(e,t){return e.reduce((function(e,n,r){return r%t==0?e.push([n]):e[e.length-1].push(n),e}),[])}function s(e,t){return e.filter((function(e,n){return t!==n}))}function c(e,t,n){var r=e.slice();return r[n]=t,r}function u(e,t,n){var r=e.slice();return r.splice(t,0,n),r}function l(e){var t=[];return e.forEach((function(e){return t=t.concat(e)})),t}function d(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}n.d(t,"e",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"i",(function(){return a})),n.d(t,"g",(function(){return s})),n.d(t,"h",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"b",(function(){return d}))},513:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var r=n(309);function o(e){var t,n=null===(t=Object(r.b)().categoryDetails.get(e))||void 0===t?void 0:t.unreadCount;return n||0}function i(e){var t,n=null===(t=Object(r.b)().categoryDetails.get(e))||void 0===t?void 0:t.totalCount;return n||0}},5139:function(e,t,n){"use strict";var r=n(0),o=n(1666),i=n(1111),a=n(25);function s(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"UpdateClientExtensionNotificationsJsonRequest:#Exchange"},n)),Object(a.a)("UpdateClientExtensionNotifications",e,t)}var c=n(246);function u(e,t,n){var o,i=(o={ItemId:t,Id:e,Notifications:n},Object(r.__assign)({__type:"UpdateClientExtensionNotificationsRequest:#Exchange"},o));return s({Header:Object(c.a)(),Body:i})}var l=n(1046),d=n(1548);function f(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a,s,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(n=Object(l.c)(e),!(a={Id:n.getItemId()}).Id)throw new o.a(i.b.CannotPersistPropertyInUnsavedDraftError);return s=Object(d.d)(e,t),c=Object.keys(s).map((function(e){var t=s[e];return{Key:t.Key,Type:t.Type,Message:t.Message,Icon:t.Icon}})),[4,u(t,a,c).catch((function(e){throw new o.a(i.b.PersistedNotificationArraySaveError)}))];case 1:return r.sent(),[2]}}))}))}n.d(t,"a",(function(){return f}))},514:function(e,t,n){"use strict";function r(e,t){var n=t.filter((function(t){return t.Name===e}));return n.length>0?n[0].Id:null}function o(e,t){var n=t.filter((function(t){return t.Id===e}));return n.length>0?n[0].Name:null}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}))},5208:function(e,t,n){"use strict";var r=n(4),o=Object(r.createStore)("SurfaceActionsStore",{addinOptionSurfaceItems:{}})();t.a=o},5209:function(e){e.exports=JSON.parse('{"a":"GFa","b":"HFa"}')},5210:function(e){e.exports=JSON.parse('{"a":"AFa"}')},5211:function(e){e.exports=JSON.parse('{"a":"yFa"}')},5212:function(e){e.exports=JSON.parse('{"a":"fFa"}')},5213:function(e){e.exports=JSON.parse('{"a":"dFa"}')},5214:function(e){e.exports=JSON.parse('{"a":"aFa"}')},5215:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(103);function o(){return!Object(r.u)()}},5216:function(e,t,n){"use strict";var r=n(5503);n.d(t,"a",(function(){return r.a}));var o=n(5619);n.d(t,"b",(function(){return o.a}))},5380:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(27),o=n(295);function i(e){var t=!1;if(Object(o.a)()){var n=Object(r.a)();t=0==(e=e.toLowerCase()).indexOf("outlook_"+n.HexCID)||-1!=e.indexOf("@shadow.outlook.com")}return t}},5399:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),o=n(1049),i=n(1077),a=n(966);function s(e){var t,n,s=[];try{for(var c=Object(r.__values)(e),u=c.next();!u.done;u=c.next()){var l=u.value,d=null;l.attachmentType==o.j.Item?d={fileType:i.a.MailItem,name:l.name,size:l.size,itemId:l.id}:l.attachmentType==o.j.File&&(d={fileType:i.a.Uri,name:l.name,size:l.size,uri:l.id,type:Object(a.b)(l.id)}),d&&s.push({file:d,isInline:l.isInline})}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return s}},5406:function(e){e.exports=JSON.parse('{"a":"QSa"}')},5489:function(e,t,n){"use strict";var r=n(6151),o=n(1730),i=n(4816),a=n(6271),s=n(1),c=n(244),u=n(42),l=n(4218),d=n(9),f=n(7770),p=n(6272),m=n(3468),g=n(8473),h=Object(u.a)((function(e){return s.createElement("div",{className:g.divContainer},s.createElement("div",null,Object(d.b)(l.b)," ",s.createElement("a",{href:"",onClick:function(t){t.stopPropagation(),t.preventDefault(),e.onClickUninstall&&e.onClickUninstall(),Object(m.b)()&&Object(p.a)()}},Object(d.b)(l.a))))})),v=n(565),y=n(579),b=n(4575),_=n(687),S=n(305),C=n(2686),O=n(4217),A=n(4828),I=(n(2425),n(1013)),x=n(8476),E=Object(u.a)((function(e){var t=s.useRef(),n=function(){t.current.focus()},r=Object(I.t)();if(!r.runningContextualAddinCommand)return s.createElement("div",null);var o,i,a=r.contextualCalloutState.contextualAnchor,c=r.runningContextualAddinCommand,u=c.hostItemIndex,l=c.addinCommand,d=(o=r.contextualCalloutState.activeContextualAddinCommands,i=l,o.map((function(e){var t,n=e.get_Id()===i.get_Id();return{key:e.get_Id(),className:n&&x.selected,text:e.detectedEntity.Label,onClick:(t=e,function(){var e=Object(I.t)().runningContextualAddinCommand,n=e.hostItemIndex,r=e.addinCommand;t.get_Id()!==r.get_Id()&&Object(f.a)(n,t)})}}))),p={height:l.detectedEntity.RequestedHeight?l.detectedEntity.RequestedHeight+"px":"350px"},m={};m[13]=n,m[14]=n,m[15]=T;var g=Object(O.f)(l)?s.createElement(h,{onClickUninstall:T}):s.createElement(A.a,{addinCommand:r.runningContextualAddinCommand.addinCommand,controlId:r.runningContextualAddinCommand.controlId,hostItemIndex:u,manifestCacheProvider:b.a,style:p,notifyHostActions:m});return s.createElement(_.a,{gapSpace:0,target:a,onDismiss:T,setInitialFocus:!0,calloutWidth:parseInt("570px"),beakWidth:19,className:x.divContainer},s.createElement(S.a,{className:x.appIcon,iconName:"OfficeAddinsLogo"}),s.createElement("div",{className:x.divider}),s.createElement(C.a,{componentRef:function(e){t.current=e},items:d,className:x.contextualBar,onRenderItem:P,onRenderOverflowButton:w}),s.createElement("div",{className:x.contextualAddinFrame},g))}));function T(){Object(I.t)().activeDialog||(Object(I.t)().contextualCalloutState.contextualAnchor.focus(),Object(I.Z)())}function P(e){return s.createElement(v.a,{className:e.className,onClick:e.onClick,text:e.text,ariaLabel:e.text})}function w(e){return s.createElement(y.a,{menuIconProps:{iconName:"More"},menuProps:{items:e},ariaLabel:Object(d.b)(l.c)})}var M=n(8478),R=n(899),j=n(387),k=n(3040),N=n(8479),D=Object(u.a)((function(e){var t,n=Object(I.t)().activeDialog,r=s.useCallback((function(){return F(n.parentControlId)}),[null==n?void 0:n.parentControlId]);if(!n)return s.createElement("div",{className:N.divContainer});if(n.isOpen&&1==n.dialogType){var o=Object(I.n)(n.parentControlId),i=null===(t=null==o?void 0:o.extension)||void 0===t?void 0:t.DisplayName,a={height:n.heightInPercentage+"vh",width:n.widthInPercentage+"vw",overflow:"hidden"},c=Object(d.b)(M.a);c&&(c=c.replace("{0}",i));var u={};return u[15]=F,s.createElement(R.a,{hidden:!n.isOpen,onDismiss:r,dialogContentProps:{type:j.a.close,title:i,closeButtonAriaLabel:c},modalProps:{isBlocking:!0,containerClassName:N.dialogContainer},forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0},s.createElement(A.a,{addinCommand:o,controlId:n.controlId,isDialog:!0,hostItemIndex:n.hostItemIndex,sourceLocation:n.url,manifestCacheProvider:b.b,notifyHostActions:u,style:a}))}return s.createElement("div",{className:N.divContainer})}));function F(e){Object(k.j)({eventDispId:k.a.DISPLAY_DIALOG_DISPID,controlId:e})}var L=n(7604),U=n(8491),B=Object(u.a)((function(e){var t=I.k.activeDialog,n=!1;t&&t.parentControlId==e.controlId&&2==t.dialogType&&(n=!0);var r=e.addinCommand,o=r.extension.ConsentState,i=r.extension.Type,a=2!=o&&"Preinstalled"==i?U.consentContainer:U.uiLessContainer,c=n?"":U.hiddenContainer;return s.createElement("div",null,s.createElement(R.a,{hidden:!1,onDismiss:function(){Object(k.j)({eventDispId:k.a.DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID,controlId:e.controlId})},dialogContentProps:{type:j.a.normal,title:r.extension.DisplayName},modalProps:{isBlocking:n,containerClassName:U.dialogContainer,className:c},forceFocusInsideTrap:n,containerClassName:U.dialogContainer,isClickableOutsideFocusTrap:!0},s.createElement("div",{className:a},e.children)))})),H=n(0),W=n(8493),V=n(554),z=n(3218),G=n(4),q=Object(G.action)("onUILessExecutionCompleted",(function(e,t,n,r,o){return{addinCommand:e,controlId:t,hostItemIndex:n,args:r,status:o}}));Object(G.orchestrator)(q,(function(e){var t=e.args?e.args.completedContext:void 0,n=Object(I.J)(e.addinCommand);Object(I.cb)(e.controlId,e.hostItemIndex,e.status,t),n&&e.status==I.d.Success&&Object(I.P)(e.hostItemIndex)}));var K,X=q,J=n(254),Q=n(2),Z=n(8494),Y=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.addDisplayNotification=function(e){Object(z.c)(r.props.hostItemIndex,r.props.controlId,!1,""+r.props.extendedAddinCommand.addinCommand.get_Id()+r.infoBarId++,Object(b.d)(e.infoType),e.description)},r.addGenericErrorNotification=function(){var e=Object(d.c)(Object(d.b)(W.b),r.props.extendedAddinCommand.addinCommand.get_ExtensionDisplayName());Object(z.c)(r.props.hostItemIndex,r.props.controlId,!1,r.props.extendedAddinCommand.addinCommand.get_Id(),2,e,r.props.extendedAddinCommand.addinCommand.get_Size16Icon())},r.invokeAppCommand=function(){r.props.extendedAddinCommand.addinCommandTelemetry.setExecutionStartTime();var e=r.props.extendedAddinCommand.addinCommand.getControl(),t=e.Action.FunctionName,n={source:{id:e.Id}};r.props.disableProgressBar||r.addProgressNotification(),OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(r.props.controlId,t,n,r.onEventCompleted)},r.onEventCompleted=function(e,t){r.props.disableProgressBar||r.removeProgressNotification(),e!=I.d.Success&&Object(I.I)(r.props.hostItemIndex)&&r.addGenericErrorNotification(),r.props.extendedAddinCommand.addinCommandTelemetry.setExecutionEndTime(),Object(I.J)(r.props.extendedAddinCommand.addinCommand)&&Object(J.o)("AddinExecutionCompleted",{id:r.props.extendedAddinCommand.addinCommand.extension.Id,controlId:r.props.controlId,owa_1:Object(Q.e)(),owa_2:Object(I.z)(r.props.hostItemIndex),executionEndTime:r.props.extendedAddinCommand.addinCommandTelemetry.getExecutionEndTime()}),X(r.props.extendedAddinCommand.addinCommand,r.props.controlId,r.props.hostItemIndex,t,e)},r.infoBarId=0,r}return Object(H.__extends)(t,e),t.prototype.removeProgressNotification=function(){Object(z.m)(this.props.hostItemIndex,this.props.controlId,this.props.extendedAddinCommand.addinCommand.get_Id())},t.prototype.addProgressNotification=function(){var e=Object(d.c)(Object(d.b)(W.a),this.props.extendedAddinCommand.addinCommand.get_ExtensionDisplayName(),this.props.extendedAddinCommand.addinCommand.get_Label());Object(z.c)(this.props.hostItemIndex,this.props.controlId,!1,this.props.extendedAddinCommand.addinCommand.get_Id(),1,e)},t.prototype.render=function(){var e={};return e[8]=this.addGenericErrorNotification,s.createElement(A.a,{addinCommand:this.props.extendedAddinCommand.addinCommand,addinCommandTelemetry:this.props.extendedAddinCommand.addinCommandTelemetry,controlId:this.props.controlId,hostItemIndex:this.props.hostItemIndex,manifestCacheProvider:b.a,onInsertOsfControl:this.invokeAppCommand,onDisplayNotification:this.addDisplayNotification,notifyHostActions:e,className:Z.uiLessContainer})},t=Object(H.__decorate)([V.observer],t)}(s.Component),$=Object(u.a)((function(e){var t=[];return Object(I.t)().runningUILessExtendedAddinCommands.forEach((function(e,n){e.forEach((function(e,r){e.addinCommandTelemetry.setExecutionInitTime();var o=e.addinCommand,i=Object(I.J)(o);t.push(s.createElement(B,{hostItemIndex:n,controlId:r,addinCommand:o,key:r},s.createElement(Y,{extendedAddinCommand:e,controlId:r,hostItemIndex:n,disableProgressBar:i})))}))})),s.createElement("div",null,t)}));function ee(e){K||(K=document.createElement("div"),document.body.appendChild(K),c.render(s.createElement(s.StrictMode,null,s.createElement(te,{renderTaskPaneInPanel:e})),K))}function te(e){return s.createElement("div",null,e.renderTaskPaneInPanel&&s.createElement(L.a,{renderTaskPaneInPanel:!0}),s.createElement($,null),s.createElement(E,null),s.createElement(D,null))}var ne=n(7771),re=n(7772),oe=n(233);function ie(e){var t,n=e.map(ae);return n.push({key:(t=Object(re.a)()).key,name:t.name,itemType:t.itemType,iconProps:t.iconProps}),n}function ae(e){return{key:e.Id,name:e.DisplayName,itemType:oe.a.Normal,iconProps:Object(ne.a)(e.IconUrl)}}var se=n(76),ce=n(6163),ue=function(e,t){if(Object(se.h)("addin-autoRun")){var n=Object(I.p)(t).map((function(e){return new ce.d(e,new ce.b)}));Object(I.e)(n,e),Object(I.P)(e)}};n.d(t,"f",(function(){return r.a})),n.d(t,"a",(function(){return o.a})),n.d(t,"b",(function(){return i.a})),n.d(t,"g",(function(){return a.a})),n.d(t,"e",(function(){return ee})),n.d(t,"c",(function(){return ie})),n.d(t,"d",(function(){return ue}))},5501:function(e,t,n){"use strict";var r=function(){return{tenantTokens:["56468f6991c348029c6bba403b444607-7f5d6cd1-7fbe-4ab1-be03-3b2b6aeb3eb4-7696"]}},o=n(1046),i=n(254),a=n(76),s=n(103),c=n(1013),u=n(2),l=function(e,t,n,l,d,f,p){if(Object(a.h)("addin-launchDatapoint")){var m=function(e){if(Object(a.h)("addin-delegateAccess")){var t=Object(o.c)(e);if(t.isSharedItem)return t.isSharedItem()}return!1}(n),g=!!Object(c.J)(t);if(function(e,t,n,o,a,l,d,f,p){var m,g;f&&(m=f.getExecutionInitTime(),g=f.getExecutionStartTime());var h=new i.a("ExtAddinLaunched",r());h.addCustomData({id:t.extension.Id,name:t.extension.DisplayName,owa_1:Object(u.e)(),owa_2:Object(c.z)(n),owa_3:o,lang:Object(s.k)(),owa_4:t.extension.Type,errorCode:a,delegate:l,isAutoRun:d,executionInitTime:m,executionStartTime:g,controlId:p}),e?h.end():h.endWithError("Timeout",new Error("Add-in failed to load with code: "+a))}(e,t,n,l,p,m,g,d,f),e&&m&&function(e,t){var n=new i.a("ExtDelegateAddinLaunched",r());n.addCustomData({id:e.extension.Id,name:e.extension.DisplayName,owa_1:Object(u.e)(),owa_2:Object(c.z)(t)}),n.end()}(t,n),e&&g){var h=function(e){return e.getLaunchEventType()}(t);!function(e,t,n,o,a){var s,c;o&&(s=o.getQueuePushTime(),c=o.getQueuePopTime());var u=new i.a("ExtAutoRunAddinLaunched",r());u.addCustomData({id:e.extension.Id,name:e.extension.DisplayName,launchEventType:n,autoRunQueuePushTimeTime:s,autorunQueuePopTime:c,controlId:a}),u.end()}(t,0,h,d,f)}}};var d=9e5;function f(){var e=r();return e.timeout=d,new i.a("ExtItemSendEvent",e)}function p(e,t){e.addCustomData({owa_1:t}),e.end()}function m(e,t,n){e.addCustomData({reason:g(t),id:n.extension.Id,name:n.extension.DisplayName,module:Object(u.e)()}),e.end()}function g(e){if(e.status===c.d.Success)return e.allowEvent?4:2;switch(e.status){case c.d.TimedOut:return 16;case c.d.FunctionNotFound:return 8;default:return 32}}var h=n(6208),v=n(3850),y=n(1097),b=n(49);function _(e,t,n,r){var i,a=Object(s.i)();e.properties["App.Name"]="Outlook",e.properties["App.Platform"]="Web",e.properties["App.Version"]=Object(u.j)(),e.properties["Release.AudienceGroup"]=function(){switch(Object(u.q)()){case"Dogfood":return"Dogfood";case"Microsoft":return"Microsoft";default:return"Production"}}(),e.properties["Release.Audience"]=Object(u.q)(),e.properties["User.TenantId"]=a.SessionSettings.ExternalDirectoryTenantGuid,e.properties["User.TenantGroup"]="outlookCom"===(i=Object(h.a)())||"gmail"===i?"Consumer":"Commercial",e.properties["User.PrimaryIdentitySpace"]=function(){switch(Object(h.a)()){case"outlookCom":return"MsaPuid";case"office365":return"OrgIdPuid";default:return"Unknown"}}(),e.properties["User.PrimaryIdentityHash"]=a.SessionSettings.UserPuid,e.properties["Browser.Name"]=Object(b.a)().browser,e.properties["Browser.Version"]=Object(b.a)().browserVersion.join("."),e.properties["Session.Id"]=function(e){if(void 0!==e)return(e.slice(0,8)+"-"+e.slice(8,12)+"-"+e.slice(12,16)+"-"+e.slice(16,20)+"-"+e.slice(20)).toLowerCase();return e}(Object(u.i)()),e.properties["Event.Time"]=(new Date).toISOString(),e.properties["Data.SDX.AppState"]=function(e){var t=Object(o.c)(e);switch(null==t?void 0:t.mode){case y.a.MessageRead:return"MessageRead";case y.a.MessageCompose:return"MessageCompose";case y.a.AppointmentAttendee:return"AppointmentAttendee";case y.a.AppointmentOrganizer:return"AppointmentOrganizer";default:return"Unknown"}}(n),e.properties["Device.OsVersion"]="N/A",e.properties["Device.OsBuild"]="N/A",e.properties["Data.SDX.LaunchReason"]=function(e,t){if(Object(c.N)(e.extension.Id,t)||Object(v.d)(e)||Object(c.J)(e))return"Auto";return"Manual"}(t,r),e.properties["Data.SDX.CommandPlacement"]=function(e,t,n){var r;if(Object(c.N)(e.extension.Id,n))return"OnSend";if(Object(v.d)(e))return"Persistent";if(Object(c.J)(e))return"LaunchEvent";if(e.detectedEntity)return"Contextual";var i=Object(o.c)(t);return(null===(r=null==i?void 0:i.isAddinPinned)||void 0===r?void 0:r.call(i,e.extension.Id))?"Ribbon":"Overflow"}(t,n,r),e.properties["Data.SDX.ActionType"]=function(e){switch(Object(c.r)(e)){case 2:return"ShowTaskpane";case 3:return"ExecuteFunction";case 1:return"Contextual";case 5:return"Dialog";case 4:return"Unknown"}}(r),e.properties["Data.ExEnv"]=Object(u.q)()}n.d(t,"e",(function(){return l})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return m})),n.d(t,"d",(function(){return p})),n.d(t,"a",(function(){return _}))},5503:function(e,t,n){"use strict";var r=n(0),o=n(1097),i=function(){function e(e){this.addinFactory=e}return e.prototype.activate=function(e){var t=this;return new Promise((function(n,r){var i=new Map;Object.values(o.a).filter((function(e){return isNaN(Number(o.a[e]))})).forEach((function(n){i.set(n,[]),e.forEach((function(e){var r=t.addinFactory.CreateAddinIfEntryPointSupported(e,n);r&&i.get(n).push(r)}))})),n(i)}))},e}(),a=n(3112),s=n(5489);var c=n(1013),u=n(6163),l=n(3850);function d(e,t){var n=new u.c;return t.activate(e).then((function(e){Object.values(o.a).forEach((function(t){n.setExtensionPoint(e.get(t),t)}))})).then((function(){n.isInitialized=!0,Object(c.T)(n),function(e){var t={};[o.a.MessageRead,o.a.MessageCompose,o.a.AppointmentAttendee,o.a.AppointmentOrganizer].forEach((function(n){var r=e.getExtensionPoint(n);t[n]=Object(s.c)(r)})),a.k.importAndExecute(t)}(n);var t=e.map((function(e){return e.Id}));Object(l.g)(t)}))}var f=n(5619),p=n(3468),m=n(79);n.d(t,"a",(function(){return h}));var g=!1;function h(){var e=this;return new Promise((function(t,n){return Object(r.__awaiter)(e,void 0,void 0,(function(){var e,n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if((g||Object(c.K)())&&!Object(c.L)())return Object(c.kb)(t),[2];Object(c.V)(!1),v(!0),[],e=new i(new c.c(new c.b)),n=null,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(f.a)()];case 2:return n=r.sent(),[3,4];case 3:return o=r.sent(),m.d(o),[3,4];case 4:return Object(c.U)(n),null!==(n=Object(c.s)())&&Object(p.a)()&&Object(c.R)(n.GenericInfo),[4,d(function(e){return(null==e?void 0:e.Extensions)?e.Extensions.filter((function(e){return e.Enabled&&null!=e.ExtensionPointCollection})):[]}(n),e)];case 5:return r.sent(),v(!1),t(),[2]}}))}))}))}function v(e){g=e}},557:function(e,t,n){"use strict";t.a=function(e){return null!=e&&"object"==typeof e}},559:function(e,t,n){"use strict";var r=n(413),o=Object.prototype,i=o.hasOwnProperty,a=o.toString,s=r.a?r.a.toStringTag:void 0;var c=function(e){var t=i.call(e,s),n=e[s];try{e[s]=void 0;var r=!0}catch(e){}var o=a.call(e);return r&&(t?e[s]=n:delete e[s]),o},u=Object.prototype.toString;var l=function(e){return u.call(e)},d="[object Null]",f="[object Undefined]",p=r.a?r.a.toStringTag:void 0;t.a=function(e){return null==e?void 0===e?f:d:p&&p in Object(e)?c(e):l(e)}},560:function(e,t,n){"use strict";function r(e){return e>=200&&e<300}n.d(t,"a",(function(){return r}))},5614:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1013);function o(e,t){var n=Object(r.n)(t);return!!n&&n.get_Id()===e+"ItemSend"}},5615:function(e,t,n){"use strict";var r=n(2977),o=n(4);t.a=Object(o.mutatorAction)("updatePersistentTaskPaneError",(function(e){var t=Object(r.b)("Persistent");t&&(t.errorType=e)}))},5616:function(e){e.exports=JSON.parse('{"a":"DEa","c":"EEa","f":"FEa","h":"GEa","e":"HEa","d":"IEa","g":"JEa","j":"KEa","i":"LEa","k":"MEa","l":"NEa","m":"OEa","n":"PEa","o":"QEa","p":"REa","q":"SEa","s":"TEa","r":"UEa","t":"VEa","u":"WEa","v":"XEa","w":"YEa","x":"ZEa","b":"_Ea"}')},5617:function(e,t,n){"use strict";var r=n(108),o=(n(6270),n(5618));n.d(t,"a",(function(){return o.a}));var i=new r.c((function(){return n.e(370).then(n.bind(null,10622))}));new r.b(i,(function(e){return e.logJank}))},5618:function(e,t,n){"use strict";t.a=function(){return window.performance?performance.now():Date.now()}},5619:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(0),o=n(3218),i=n(103),a=3,s=3e3,c=3,u=!0,l="1.8",d="1.1";function f(){return function e(t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,(f=t==a?0:s,new Promise((function(e,t){setTimeout((function(){e()}),f)})))];case 1:return r.sent(),[4,Object(o.k)(c,Object(i.n)(),u,l,d)];case 2:return[2,r.sent()];case 3:if(n=r.sent(),0==t)throw n;return[3,4];case 4:return[4,e(--t)];case 5:return[2,r.sent()]}var f}))}))}(a)}},5620:function(e,t,n){var r=n(8486),o=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},564:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(14),o=n(245),i=n(345),a=Object(o.c)((function(e,t){var n,o=Object(i.a)(e),a={root:{padding:"0 4px",height:"40px",color:e.palette.neutralPrimary,backgroundColor:"transparent",border:"1px solid transparent"},rootHovered:{color:e.palette.themePrimary,selectors:(n={},n[r.HighContrastSelector]={borderColor:"Highlight",color:"Highlight"},n)},iconHovered:{color:e.palette.themePrimary},rootPressed:{color:e.palette.black},rootExpanded:{color:e.palette.themePrimary},iconPressed:{color:e.palette.themeDarker},rootDisabled:{color:e.palette.neutralTertiary,backgroundColor:"transparent",borderColor:"transparent"},rootChecked:{color:e.palette.black},iconChecked:{color:e.palette.themeDarker},flexContainer:{justifyContent:"flex-start"},icon:{color:e.palette.themeDarkAlt},iconDisabled:{color:"inherit"},menuIcon:{color:e.palette.neutralSecondary},textContainer:{flexGrow:0}};return Object(r.concatStyleSets)(o,a,t)}))},565:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(0),o=n(1),i=n(344),a=n(427),s=n(421),c=n(564),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.styles,n=e.theme;return o.createElement(i.a,Object(r.__assign)({},this.props,{variantClassName:"ms-Button--action ms-Button--command",styles:Object(c.a)(n,t),onRenderDescription:a.b}))},t=Object(r.__decorate)([Object(s.a)("ActionButton",["theme","styles"],!0)],t)}(o.Component)},5657:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1806);function o(e){var t=null;return Object(r.b)(e,(function(e){var n=e.getSelectionRange();if(n){var r=n.cloneContents(),o=e.getDocument().createElement("div");o.appendChild(r),t={data:o.innerHTML,sourceProperty:"body",startPosition:n.startOffset,endPosition:n.endOffset}}}),(function(e){var n=e.value,r=e.selectionStart,o=e.selectionEnd;t={data:n.substring(r,o),sourceProperty:"body",startPosition:r,endPosition:o}})),t}},566:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(0),o=n(1),i=n(253),a=n(277),s=n(319),c=n(106),u=Object(i.a)(),l=function(e){function t(t){var n=e.call(this,t)||this;Object(a.a)(n);var r=n.props.allowTouchBodyScroll,o=void 0!==r&&r;return n._allowTouchBodyScroll=o,n}return Object(r.__extends)(t,e),t.prototype.componentDidMount=function(){!this._allowTouchBodyScroll&&Object(s.d)()},t.prototype.componentWillUnmount=function(){!this._allowTouchBodyScroll&&Object(s.e)()},t.prototype.render=function(){var e=this.props,t=e.isDarkThemed,n=e.className,i=e.theme,a=e.styles,s=Object(c.j)(this.props,c.h),l=u(a,{theme:i,className:n,isDark:t});return o.createElement("div",Object(r.__assign)({},s,{className:l.root}))},t}(o.Component)},567:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(24),o=n(1);function i(e){return{get:e}}function a(e,t){return Object(o.useMemo)((function(){return Object(r.computed)(e)}),t).get()}},568:function(e,t,n){"use strict";(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.a=n}).call(this,n(113))},569:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n(0),o=n(1),i=n(14),a=n(253),s=n(267),c=n(714),u=n(426),l=n(78),d=n(277),f=n(312),p=n(280),m=n(106),g=n(507),h=n(571),v=n(439),y=Object(a.a)(),b=function(e){function t(n){var r=e.call(this,n)||this;return r._tooltipHost=o.createRef(),r._defaultTooltipId=Object(s.a)("tooltip"),r.show=function(){r._toggleTooltip(!0)},r.dismiss=function(){r._hideTooltip()},r._getTargetElement=function(){if(r._tooltipHost.current){var e=r.props.overflowMode;if(void 0!==e)switch(e){case g.a.Parent:return r._tooltipHost.current.parentElement;case g.a.Self:return r._tooltipHost.current}return r._tooltipHost.current}},r._onTooltipMouseEnter=function(e){var n=r.props,o=n.overflowMode,i=n.delay;if(t._currentVisibleTooltip&&t._currentVisibleTooltip!==r&&t._currentVisibleTooltip.dismiss(),t._currentVisibleTooltip=r,void 0!==o){var a=r._getTargetElement();if(a&&!Object(c.b)(a))return}if(!e.target||!Object(u.a)(e.target,r._getTargetElement()))if(r._clearDismissTimer(),r._clearOpenTimer(),i!==v.a.zero){r.setState({isAriaPlaceholderRendered:!0});var s=r._getDelayTime(i);r._openTimerId=r._async.setTimeout((function(){r._toggleTooltip(!0)}),s)}else r._toggleTooltip(!0)},r._onTooltipMouseLeave=function(e){var n=r.props.closeDelay;r._clearDismissTimer(),r._clearOpenTimer(),n?r._dismissTimerId=r._async.setTimeout((function(){r._toggleTooltip(!1)}),n):r._toggleTooltip(!1),t._currentVisibleTooltip===r&&(t._currentVisibleTooltip=void 0)},r._onTooltipKeyDown=function(e){e.which===l.a.escape&&r._hideTooltip()},r._clearDismissTimer=function(){r._async.clearTimeout(r._dismissTimerId)},r._clearOpenTimer=function(){r._async.clearTimeout(r._openTimerId)},r._hideTooltip=function(){r._clearOpenTimer(),r._clearDismissTimer(),r._toggleTooltip(!1)},r._toggleTooltip=function(e){r.state.isTooltipVisible!==e&&r.setState({isAriaPlaceholderRendered:!1,isTooltipVisible:e},(function(){return r.props.onTooltipToggle&&r.props.onTooltipToggle(e)}))},r._getDelayTime=function(e){switch(e){case v.a.medium:return 300;case v.a.long:return 500;default:return 0}},Object(d.a)(r),r.state={isAriaPlaceholderRendered:!1,isTooltipVisible:!1},r._async=new f.a(r),r}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.calloutProps,n=e.children,a=e.content,s=e.directionalHint,c=e.directionalHintForRTL,u=e.hostClassName,l=e.id,d=e.setAriaDescribedBy,f=void 0===d||d,g=e.tooltipProps,v=e.styles,b=e.theme;this._classNames=y(v,{theme:b,className:u});var _=this.state,S=_.isAriaPlaceholderRendered,C=_.isTooltipVisible,O=l||this._defaultTooltipId,A=!!(a||g&&g.onRenderContent&&g.onRenderContent()),I=C&&A,x=f&&C&&A?O:void 0;return o.createElement("div",Object(r.__assign)({className:this._classNames.root,ref:this._tooltipHost},{onFocusCapture:this._onTooltipMouseEnter},{onBlurCapture:this._hideTooltip},{onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave,onKeyDown:this._onTooltipKeyDown,"aria-describedby":x}),n,I&&o.createElement(h.a,Object(r.__assign)({id:O,content:a,targetElement:this._getTargetElement(),directionalHint:s,directionalHintForRTL:c,calloutProps:Object(p.a)({},t,{onDismiss:this._hideTooltip,onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave}),onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave},Object(m.j)(this.props,m.h),g)),S&&o.createElement("div",{id:O,style:i.hiddenContentStyle},a))},t.prototype.componentWillUnmount=function(){t._currentVisibleTooltip&&t._currentVisibleTooltip===this&&(t._currentVisibleTooltip=void 0),this._async.dispose()},t.defaultProps={delay:v.a.medium},t}(o.Component)},570:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(0),o=n(1),i=n(253),a=n(106),s=n(687),c=n(100),u=Object(i.a)(),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onRenderContent=function(e){return o.createElement("p",{className:t._classNames.subText},e.content)},t}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.calloutProps,i=e.directionalHint,c=e.directionalHintForRTL,l=e.styles,d=e.id,f=e.maxWidth,p=e.onRenderContent,m=void 0===p?this._onRenderContent:p,g=e.targetElement,h=e.theme;return this._classNames=u(l,{theme:h,className:t||n&&n.className,beakWidth:n&&n.beakWidth,gapSpace:n&&n.gapSpace,maxWidth:f}),o.createElement(s.a,Object(r.__assign)({target:g,directionalHint:i,directionalHintForRTL:c},n,Object(a.j)(this.props,a.h,["id"]),{className:this._classNames.root}),o.createElement("div",{className:this._classNames.content,id:d,role:"tooltip",onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave},m(this.props,this._onRenderContent)))},t.defaultProps={directionalHint:c.DirectionalHint.topCenter,maxWidth:"364px",calloutProps:{isBeakVisible:!0,beakWidth:16,gapSpace:0,setInitialFocus:!0,doNotLayer:!1}},t}(o.Component)},571:function(e,t,n){"use strict";var r=n(378),o=n(570),i=n(14);n.d(t,"a",(function(){return a}));var a=Object(r.a)(o.a,(function(e){var t=e.className,n=e.beakWidth,r=void 0===n?16:n,o=e.gapSpace,a=void 0===o?0:o,s=e.maxWidth,c=e.theme,u=c.semanticColors,l=c.fonts,d=c.effects,f=-(Math.sqrt(r*r/2)+a);return{root:["ms-Tooltip",c.fonts.medium,i.AnimationClassNames.fadeIn200,{background:u.menuBackground,boxShadow:d.elevation8,padding:"8px",maxWidth:s,selectors:{":after":{content:"''",position:"absolute",bottom:f,left:f,right:f,top:f,zIndex:0}}},t],content:["ms-Tooltip-content",l.small,{position:"relative",zIndex:1,color:u.menuItemText,wordWrap:"break-word",overflowWrap:"break-word",overflow:"hidden"}],subText:["ms-Tooltip-subtext",{fontSize:"inherit",fontWeight:"inherit",color:"inherit",margin:0}]}}),void 0,{scope:"Tooltip"})},572:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),o=n(1),i=n(253),a=n(277),s=Object(i.a)(),c=function(e){function t(t){var n=e.call(this,t)||this;return Object(a.a)(n),n}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.styles,r=e.theme;return this._classNames=s(n,{theme:r,className:t}),o.createElement("div",{className:this._classNames.actions},o.createElement("div",{className:this._classNames.actionsRight},this._renderChildrenAsActions()))},t.prototype._renderChildrenAsActions=function(){var e=this;return o.Children.map(this.props.children,(function(t){return t?o.createElement("span",{className:e._classNames.action},t):null}))},t}(o.Component)},573:function(e,t,n){"use strict";var r=n(378),o=n(572),i=n(14),a={actions:"ms-Dialog-actions",action:"ms-Dialog-action",actionsRight:"ms-Dialog-actionsRight"};n.d(t,"a",(function(){return s}));var s=Object(r.a)(o.a,(function(e){var t=e.className,n=e.theme,r=Object(i.getGlobalClassNames)(a,n);return{actions:[r.actions,{position:"relative",width:"100%",minHeight:"24px",lineHeight:"24px",margin:"16px 0 0",fontSize:"0",selectors:{".ms-Button":{lineHeight:"normal"}}},t],action:[r.action,{margin:"0 4px"}],actionsRight:[r.actionsRight,{textAlign:"right",marginRight:"-4px",fontSize:"0"}]}}),void 0,{scope:"DialogFooter"})},574:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(0),o=n(1),i=n(253),a=n(267),s=n(387),c=n(724),u=n(255),l=n(576),d=Object(i.a)(),f={isDarkOverlay:!1,isBlocking:!1,className:"",containerClassName:"",topOffsetFixed:!1},p={type:s.a.normal,className:"",topButtonsProps:[]},m=function(e){function t(t){var n=e.call(this,t)||this;return n._getSubTextId=function(){var e=n.props,t=e.ariaDescribedById,r=e.modalProps,o=e.dialogContentProps,i=e.subText,a=r&&r.subtitleAriaId||t;return a||(a=(o&&o.subText||i)&&n._defaultSubTextId),a},n._getTitleTextId=function(){var e=n.props,t=e.ariaLabelledById,r=e.modalProps,o=e.dialogContentProps,i=e.title,a=r&&r.titleAriaId||t;return a||(a=(o&&o.title||i)&&n._defaultTitleTextId),a},n._id=Object(a.a)("Dialog"),n._defaultTitleTextId=n._id+"-title",n._defaultSubTextId=n._id+"-subText",n}return Object(r.__extends)(t,e),t.prototype.render=function(){var e,t,n,i,a=this.props,s=a.className,u=a.containerClassName,m=a.contentClassName,g=a.elementToFocusOnDismiss,h=a.firstFocusableSelector,v=a.forceFocusInsideTrap,y=a.styles,b=a.hidden,_=a.ignoreExternalFocusing,S=a.isBlocking,C=a.isClickableOutsideFocusTrap,O=a.isDarkOverlay,A=a.isOpen,I=a.onDismiss,x=a.onDismissed,E=a.onLayerDidMount,T=a.responsiveMode,P=a.subText,w=a.theme,M=a.title,R=a.topButtonsProps,j=a.type,k=a.minWidth,N=a.maxWidth,D=a.modalProps,F=Object(r.__assign)({},D?D.layerProps:{onLayerDidMount:E});E&&!F.onLayerDidMount&&(F.onLayerDidMount=E),D&&D.dragOptions&&!D.dragOptions.dragHandleSelector?(n="ms-Dialog-draggable-header",i=Object(r.__assign)(Object(r.__assign)({},D.dragOptions),{dragHandleSelector:"."+n})):i=D&&D.dragOptions;var L=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},f),{className:s,containerClassName:u,isBlocking:S,isDarkOverlay:O,onDismissed:x}),D),{layerProps:F,dragOptions:i}),U=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({className:m,subText:P,title:M,topButtonsProps:R,type:j},p),this.props.dialogContentProps),{draggableHeaderClassName:n,titleProps:Object(r.__assign)({id:(null===(e=this.props.dialogContentProps)||void 0===e?void 0:e.titleId)||this._defaultTitleTextId},null===(t=this.props.dialogContentProps)||void 0===t?void 0:t.titleProps)}),B=d(y,{theme:w,className:L.className,containerClassName:L.containerClassName,hidden:b,dialogDefaultMinWidth:k,dialogDefaultMaxWidth:N});return o.createElement(c.a,Object(r.__assign)({elementToFocusOnDismiss:g,firstFocusableSelector:h,forceFocusInsideTrap:v,ignoreExternalFocusing:_,isClickableOutsideFocusTrap:C,onDismissed:L.onDismissed,responsiveMode:T},L,{isDarkOverlay:L.isDarkOverlay,isBlocking:L.isBlocking,isOpen:void 0!==A?A:!b,className:B.root,containerClassName:B.main,onDismiss:I||L.onDismiss,subtitleAriaId:this._getSubTextId(),titleAriaId:this._getTitleTextId()}),o.createElement(l.a,Object(r.__assign)({subTextId:this._defaultSubTextId,title:U.title,subText:U.subText,showCloseButton:L.isBlocking,topButtonsProps:U.topButtonsProps,type:U.type,onDismiss:I||U.onDismiss,className:U.className},U),this.props.children))},t.defaultProps={hidden:!0},t=Object(r.__decorate)([u.withResponsiveMode],t)}(o.Component)},575:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(0),o=n(1),i=n(253),a=n(277),s=n(357),c=n(282),u=n(387),l=n(579),d=n(573),f=n(255),p=Object(i.a)(),m=o.createElement(d.a,null).type,g="DialogContent",h=function(e){function t(t){var n=e.call(this,t)||this;return Object(a.a)(n),Object(s.a)(g,t,{titleId:"titleProps.id"}),n}return Object(r.__extends)(t,e),t.prototype.render=function(){var e,t=this.props,n=t.showCloseButton,i=t.className,a=t.closeButtonAriaLabel,s=t.onDismiss,d=t.subTextId,f=t.subText,m=t.titleProps,g=void 0===m?{}:m,h=t.titleId,v=t.title,y=t.type,b=t.styles,_=t.theme,S=t.draggableHeaderClassName,C=p(b,{theme:_,className:i,isLargeHeader:y===u.a.largeHeader,isClose:y===u.a.close,draggableHeaderClassName:S}),O=this._groupChildren();return f&&(e=o.createElement("p",{className:C.subText,id:d},f)),o.createElement("div",{className:C.content},o.createElement("div",{className:C.header},o.createElement("div",Object(r.__assign)({id:h,role:"heading","aria-level":1},g,{className:Object(c.css)(C.title,g.className)}),v),o.createElement("div",{className:C.topButton},this.props.topButtonsProps.map((function(e,t){return o.createElement(l.a,Object(r.__assign)({key:e.uniqueId||t},e))})),(y===u.a.close||n&&y!==u.a.largeHeader)&&o.createElement(l.a,{className:C.button,iconProps:{iconName:"Cancel"},ariaLabel:a,onClick:s,title:a}))),o.createElement("div",{className:C.inner},o.createElement("div",{className:C.innerContent},e,O.contents),O.footers))},t.prototype._groupChildren=function(){var e={footers:[],contents:[]};return o.Children.map(this.props.children,(function(t){"object"==typeof t&&null!==t&&t.type===m?e.footers.push(t):e.contents.push(t)})),e},t.defaultProps={showCloseButton:!1,className:"",topButtonsProps:[],closeButtonAriaLabel:"Close"},t=Object(r.__decorate)([f.withResponsiveMode],t)}(o.Component)},576:function(e,t,n){"use strict";var r=n(378),o=n(575),i=n(14),a={contentLgHeader:"ms-Dialog-lgHeader",close:"ms-Dialog--close",subText:"ms-Dialog-subText",header:"ms-Dialog-header",headerLg:"ms-Dialog--lgHeader",button:"ms-Dialog-button ms-Dialog-button--close",inner:"ms-Dialog-inner",content:"ms-Dialog-content",title:"ms-Dialog-title"};n.d(t,"a",(function(){return s}));var s=Object(r.a)(o.a,(function(e){var t,n,r,o=e.className,s=e.theme,c=e.isLargeHeader,u=e.isClose,l=e.hidden,d=e.isMultiline,f=e.draggableHeaderClassName,p=s.palette,m=s.fonts,g=s.effects,h=s.semanticColors,v=Object(i.getGlobalClassNames)(a,s);return{content:[c&&[v.contentLgHeader,{borderTop:"4px solid "+p.themePrimary}],u&&v.close,{flexGrow:1,overflowY:"hidden"},o],subText:[v.subText,m.medium,{margin:"0 0 24px 0",color:h.bodySubtext,lineHeight:"1.5",wordWrap:"break-word",fontWeight:i.FontWeights.regular}],header:[v.header,{position:"relative",width:"100%",boxSizing:"border-box"},u&&v.close,f&&[f,{cursor:"move"}]],button:[v.button,l&&{selectors:{".ms-Icon.ms-Icon--Cancel":{color:h.buttonText,fontSize:i.IconFontSizes.medium}}}],inner:[v.inner,{padding:"0 24px 24px",selectors:(t={},t["@media (min-width: "+i.ScreenWidthMinSmall+"px) and (max-width: "+i.ScreenWidthMaxSmall+"px)"]={padding:"0 16px 16px"},t)}],innerContent:[v.content,{position:"relative",width:"100%"}],title:[v.title,m.xLarge,{color:h.bodyText,margin:"0",minHeight:m.xLarge.fontSize,padding:"16px 46px 20px 24px",lineHeight:"normal",selectors:(n={},n["@media (min-width: "+i.ScreenWidthMinSmall+"px) and (max-width: "+i.ScreenWidthMaxSmall+"px)"]={padding:"16px 46px 16px 16px"},n)},c&&{color:h.menuHeader},d&&{fontSize:m.xxLarge.fontSize}],topButton:[{display:"flex",flexDirection:"row",flexWrap:"nowrap",position:"absolute",top:"0",right:"0",padding:"15px 15px 0 0",selectors:(r={"> *":{flex:"0 0 auto"},".ms-Dialog-button":{color:h.buttonText},".ms-Dialog-button:hover":{color:h.buttonTextHovered,borderRadius:g.roundedCorner2}},r["@media (min-width: "+i.ScreenWidthMinSmall+"px) and (max-width: "+i.ScreenWidthMaxSmall+"px)"]={padding:"15px 8px 0 0"},r)}]}}),void 0,{scope:"DialogContent"})},579:function(e,t,n){"use strict";var r=n(0),o=n(1),i=n(344),a=n(427),s=n(421),c=n(14),u=n(245),l=n(345),d=n(384),f=Object(u.c)((function(e,t){var n,r=Object(l.a)(e),o=Object(d.a)(e),i=e.palette,a={root:{padding:"0 4px",width:"32px",height:"32px",backgroundColor:"transparent",border:"none",color:e.semanticColors.link},rootHovered:{color:i.themeDarkAlt,backgroundColor:i.neutralLighter,selectors:(n={},n[c.HighContrastSelector]={borderColor:"Highlight",color:"Highlight"},n)},rootHasMenu:{width:"auto"},rootPressed:{color:i.themeDark,backgroundColor:i.neutralLight},rootExpanded:{color:i.themeDark,backgroundColor:i.neutralLight},rootChecked:{color:i.themeDark,backgroundColor:i.neutralLight},rootCheckedHovered:{color:i.themeDark,backgroundColor:i.neutralQuaternaryAlt},rootDisabled:{color:i.neutralTertiaryAlt}};return Object(c.concatStyleSets)(r,a,o,t)}));n.d(t,"a",(function(){return p}));var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.styles,n=e.theme;return o.createElement(i.a,Object(r.__assign)({},this.props,{variantClassName:"ms-Button--icon",styles:f(n,t),onRenderText:a.b,onRenderDescription:a.b}))},t=Object(r.__decorate)([Object(s.a)("IconButton",["theme","styles"],!0)],t)}(o.Component)},580:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(0),o=n(1),i=n(339),a=n(253),s=n(106),c=n(663),u=Object(a.a)(),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.type,n=e.size,a=e.ariaLabel,l=e.ariaLive,d=e.styles,f=e.label,p=e.theme,m=e.className,g=e.labelPosition,h=a,v=Object(s.j)(this.props,s.h,["size"]),y=n;void 0===y&&void 0!==t&&(y=t===i.b.large?i.a.large:i.a.medium);var b=u(d,{theme:p,size:y,className:m,labelPosition:g});return o.createElement("div",Object(r.__assign)({},v,{className:b.root}),o.createElement("div",{className:b.circle}),f&&o.createElement("div",{className:b.label},f),h&&o.createElement("div",{role:"status","aria-live":l},o.createElement(c.a,null,o.createElement("div",{className:b.screenReaderText},h))))},t.defaultProps={size:i.a.medium,ariaLive:"polite",labelPosition:"bottom"},t}(o.Component)},582:function(e,t,n){"use strict";var r=n(0),o=n(1),i=n(253),a=n(319),s=n(78),c=n(252),u=n(312),l=n(249),d=n(357),f=n(267),p=n(895),m=n(485),g=n(896),h=n(709),v=n(707),y=n(255),b=n(100),_=n(305),S=n(245),C=n(14),O=Object(S.c)((function(e,t){return{root:Object(C.mergeStyles)(e,t&&{touchAction:"none",selectors:{"& *":{userSelect:"none"}}})}})),A=n(356),I={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}},x=function(e){function t(t){var n=e.call(this,t)||this;return n._currentEventType=I.mouse,n._events=[],n._onMouseDown=function(e){var t=o.Children.only(n.props.children).props.onMouseDown;return t&&t(e),n._currentEventType=I.mouse,n._onDragStart(e)},n._onMouseUp=function(e){var t=o.Children.only(n.props.children).props.onMouseUp;return t&&t(e),n._currentEventType=I.mouse,n._onDragStop(e)},n._onTouchStart=function(e){var t=o.Children.only(n.props.children).props.onTouchStart;return t&&t(e),n._currentEventType=I.touch,n._onDragStart(e)},n._onTouchEnd=function(e){var t=o.Children.only(n.props.children).props.onTouchEnd;t&&t(e),n._currentEventType=I.touch,n._onDragStop(e)},n._onDragStart=function(e){if("number"==typeof e.button&&0!==e.button)return!1;if(!(n.props.handleSelector&&!n._matchesSelector(e.target,n.props.handleSelector)||n.props.preventDragSelector&&n._matchesSelector(e.target,n.props.preventDragSelector))){n._touchId=n._getTouchId(e);var t=n._getControlPosition(e);if(void 0!==t){var r=n._createDragDataFromPosition(t);n.props.onStart&&n.props.onStart(e,r),n.setState({isDragging:!0,lastPosition:t}),n._events=[Object(A.a)(document.body,n._currentEventType.move,n._onDrag,!0),Object(A.a)(document.body,n._currentEventType.stop,n._onDragStop,!0)]}}},n._onDrag=function(e){"touchmove"===e.type&&e.preventDefault();var t=n._getControlPosition(e);if(t){var r=n._createUpdatedDragData(n._createDragDataFromPosition(t)),o=r.position;n.props.onDragChange&&n.props.onDragChange(e,r),n.setState({position:o,lastPosition:t})}},n._onDragStop=function(e){if(n.state.isDragging){var t=n._getControlPosition(e);if(t){var r=n._createDragDataFromPosition(t);n.setState({isDragging:!1,lastPosition:void 0}),n.props.onStop&&n.props.onStop(e,r),n.props.position&&n.setState({position:n.props.position}),n._events.forEach((function(e){return e()}))}}},n.state={isDragging:!1,position:n.props.position||{x:0,y:0},lastPosition:void 0},n}return Object(r.__extends)(t,e),t.prototype.componentDidUpdate=function(e){!this.props.position||e.position&&this.props.position===e.position||this.setState({position:this.props.position})},t.prototype.componentWillUnmount=function(){this._events.forEach((function(e){return e()}))},t.prototype.render=function(){var e=o.Children.only(this.props.children),t=e.props,n=this.props.position,i=this.state,a=i.position,s=i.isDragging,c=a.x,u=a.y;return n&&!s&&(c=n.x,u=n.y),o.cloneElement(e,{style:Object(r.__assign)(Object(r.__assign)({},t.style),{transform:"translate("+c+"px, "+u+"px)"}),className:O(t.className,this.state.isDragging).root,onMouseDown:this._onMouseDown,onMouseUp:this._onMouseUp,onTouchStart:this._onTouchStart,onTouchEnd:this._onTouchEnd})},t.prototype._getControlPosition=function(e){var t=this._getActiveTouch(e);if(void 0===this._touchId||t){var n=t||e;return{x:n.clientX,y:n.clientY}}},t.prototype._getActiveTouch=function(e){return e.targetTouches&&this._findTouchInTouchList(e.targetTouches)||e.changedTouches&&this._findTouchInTouchList(e.changedTouches)},t.prototype._getTouchId=function(e){var t=e.targetTouches&&e.targetTouches[0]||e.changedTouches&&e.changedTouches[0];if(t)return t.identifier},t.prototype._matchesSelector=function(e,t){if(!e||e===document.body)return!1;var n=e.matches||e.webkitMatchesSelector||e.msMatchesSelector;return!!n&&(n.call(e,t)||this._matchesSelector(e.parentElement,t))},t.prototype._findTouchInTouchList=function(e){if(void 0!==this._touchId)for(var t=0;t<e.length;t++)if(e[t].identifier===this._touchId)return e[t]},t.prototype._createDragDataFromPosition=function(e){var t=this.state.lastPosition;return void 0===t?{delta:{x:0,y:0},lastPosition:e,position:e}:{delta:{x:e.x-t.x,y:e.y-t.y},lastPosition:t,position:e}},t.prototype._createUpdatedDragData=function(e){var t=this.state.position;return{position:{x:t.x+e.delta.x,y:t.y+e.delta.y},delta:e.delta,lastPosition:t}},t}(o.Component),E=n(277);n.d(t,"a",(function(){return M}));var T={eventBubblingEnabled:!1},P=Object(i.a)(),w="Modal",M=function(e){function t(t){var n=e.call(this,t)||this;n._focusTrapZone=o.createRef(),n._allowScrollOnModal=function(e){e?n._allowTouchBodyScroll?Object(a.b)(e,n._events):Object(a.c)(e,n._events):n._events.off(n._scrollableContent),n._scrollableContent=e},n._onModalContextMenuClose=function(){n.setState({isModalMenuOpen:!1})},n._onModalClose=function(){n._lastSetX=0,n._lastSetY=0,n.setState({isModalMenuOpen:!1,isInKeyboardMoveMode:!1,isOpen:!1,x:0,y:0}),n.props.dragOptions&&n._hasRegisteredKeyUp&&n._events.off(window,"keyup",n._onKeyUp,!0),n.props.onDismissed&&n.props.onDismissed()},n._onDragStart=function(){n.setState({isModalMenuOpen:!1,isInKeyboardMoveMode:!1})},n._onDrag=function(e,t){var r=n.state,o=r.x,i=r.y;n.setState({x:o+t.delta.x,y:i+t.delta.y})},n._onDragStop=function(){n.focus()},n._onKeyUp=function(e){e.altKey&&e.ctrlKey&&e.keyCode===s.a.space&&Object(c.a)(n._scrollableContent,e.target)&&(n.setState({isModalMenuOpen:!n.state.isModalMenuOpen}),e.preventDefault(),e.stopPropagation())},n._onKeyDown=function(e){if(e.altKey&&e.ctrlKey&&e.keyCode===s.a.space)return e.preventDefault(),void e.stopPropagation();if(n.state.isModalMenuOpen&&(e.altKey||e.keyCode===s.a.escape)&&n.setState({isModalMenuOpen:!1}),!n.state.isInKeyboardMoveMode||e.keyCode!==s.a.escape&&e.keyCode!==s.a.enter||(n.setState({isInKeyboardMoveMode:!1}),e.preventDefault(),e.stopPropagation()),n.state.isInKeyboardMoveMode){var t=!0,r=n._getMoveDelta(e);switch(e.keyCode){case s.a.escape:n.setState({x:n._lastSetX,y:n._lastSetY});case s.a.enter:n._lastSetX=0,n._lastSetY=0,n.setState({isInKeyboardMoveMode:!1});break;case s.a.up:n.setState({y:n.state.y-r});break;case s.a.down:n.setState({y:n.state.y+r});break;case s.a.left:n.setState({x:n.state.x-r});break;case s.a.right:n.setState({x:n.state.x+r});break;default:t=!1}t&&(e.preventDefault(),e.stopPropagation())}},n._onEnterKeyboardMoveMode=function(){n._lastSetX=n.state.x,n._lastSetY=n.state.y,n.setState({isInKeyboardMoveMode:!0,isModalMenuOpen:!1}),n._events.on(window,"keydown",n._onKeyDown,!0)},n._onExitKeyboardMoveMode=function(){n._lastSetX=0,n._lastSetY=0,n.setState({isInKeyboardMoveMode:!1}),n._events.off(window,"keydown",n._onKeyDown,!0)},n._registerForKeyUp=function(){n._hasRegisteredKeyUp||(n._events.on(window,"keyup",n._onKeyUp,!0),n._hasRegisteredKeyUp=!0)},n._async=new u.a(n),n._events=new l.a(n),Object(E.a)(n),Object(d.a)(w,t,{onLayerDidMount:"layerProps.onLayerDidMount"}),n.state={id:Object(f.a)("Modal"),isOpen:t.isOpen,isVisible:t.isOpen,hasBeenOpened:t.isOpen,x:0,y:0},n._lastSetX=0,n._lastSetY=0;var r=n.props.allowTouchBodyScroll,i=void 0!==r&&r;return n._allowTouchBodyScroll=i,n}return Object(r.__extends)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){if(clearTimeout(this._onModalCloseTimer),e.isOpen)if(this.state.isOpen){if(this.setState({hasBeenOpened:!0,isVisible:!0}),e.topOffsetFixed){var t=document.getElementsByClassName("ms-Dialog-main"),n=void 0;t.length>0&&(n=t[0].getBoundingClientRect(),this.setState({modalRectangleTop:n.top}))}}else this.setState({isOpen:!0}),e.dragOptions&&this._registerForKeyUp();!e.isOpen&&this.state.isOpen&&(this._onModalCloseTimer=this._async.setTimeout(this._onModalClose,1e3*parseFloat(m.a)),this.setState({isVisible:!1}))},t.prototype.componentDidMount=function(){this.state.isOpen&&this.state.isVisible&&this._registerForKeyUp()},t.prototype.componentDidUpdate=function(e,t){e.isOpen||t.isVisible||this.setState({isVisible:!0})},t.prototype.componentWillUnmount=function(){this._async.dispose(),this._events.dispose()},t.prototype.render=function(){var e=this.props,t=e.className,n=e.containerClassName,i=e.scrollableContentClassName,a=e.elementToFocusOnDismiss,s=e.firstFocusableSelector,c=e.forceFocusInsideTrap,u=e.ignoreExternalFocusing,l=e.isBlocking,d=e.isClickableOutsideFocusTrap,f=e.isDarkOverlay,m=e.onDismiss,S=e.layerProps,C=e.overlay,O=e.responsiveMode,A=e.titleAriaId,I=e.styles,E=e.subtitleAriaId,w=e.theme,M=e.topOffsetFixed,R=e.onLayerDidMount,j=e.isModeless,k=e.dragOptions,N=e.enableAriaHiddenSiblings,D=this.state,F=D.isOpen,L=D.isVisible,U=D.hasBeenOpened,B=D.modalRectangleTop,H=D.x,W=D.y,V=D.isInKeyboardMoveMode;if(!F)return null;var z=void 0===S?"":S.className,G=P(I,{theme:w,className:t,containerClassName:n,scrollableContentClassName:i,isOpen:F,isVisible:L,hasBeenOpened:U,modalRectangleTop:B,topOffsetFixed:M,isModeless:j,layerClassName:z,isDefaultDragHandle:k&&!k.dragHandleSelector}),q=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},T),this.props.layerProps),{onLayerDidMount:S&&S.onLayerDidMount?S.onLayerDidMount:R,insertFirst:j,className:G.layer}),K=o.createElement(p.a,{componentRef:this._focusTrapZone,className:G.main,elementToFocusOnDismiss:a,isClickableOutsideFocusTrap:j||d||!l,ignoreExternalFocusing:u,forceFocusInsideTrap:j?!j:c,firstFocusableSelector:s,focusPreviouslyFocusedInnerElement:!0,onBlur:V?this._onExitKeyboardMoveMode:void 0,enableAriaHiddenSiblings:N},k&&V&&o.createElement("div",{className:G.keyboardMoveIconContainer},k.keyboardMoveIconProps?o.createElement(_.a,Object(r.__assign)({},k.keyboardMoveIconProps)):o.createElement(_.a,{iconName:"move",className:G.keyboardMoveIcon})),o.createElement("div",{ref:this._allowScrollOnModal,className:G.scrollableContent,"data-is-scrollable":!0},k&&this.state.isModalMenuOpen&&o.createElement(k.menu,{items:[{key:"move",text:k.moveMenuItemText,onClick:this._onEnterKeyboardMoveMode},{key:"close",text:k.closeMenuItemText,onClick:this._onModalClose}],onDismiss:this._onModalContextMenuClose,alignTargetEdge:!0,coverTarget:!0,directionalHint:b.DirectionalHint.topLeftEdge,directionalHintFixed:!0,shouldFocusOnMount:!0,target:this._scrollableContent}),this.props.children));return O>=y.ResponsiveMode.small?o.createElement(h.a,Object(r.__assign)({},q),o.createElement(v.a,{role:j||!l?"dialog":"alertdialog","aria-modal":!j,ariaLabelledBy:A,ariaDescribedBy:E,onDismiss:m,shouldRestoreFocus:!u},o.createElement("div",{className:G.root},!j&&o.createElement(g.a,Object(r.__assign)({isDarkThemed:f,onClick:l?void 0:m,allowTouchBodyScroll:this._allowTouchBodyScroll},C)),k?o.createElement(x,{handleSelector:k.dragHandleSelector||"."+G.main.split(" ")[0],preventDragSelector:"button",onStart:this._onDragStart,onDragChange:this._onDrag,onStop:this._onDragStop,position:{x:H,y:W}},K):K))):null},t.prototype.focus=function(){this._focusTrapZone.current&&this._focusTrapZone.current.focus()},t.prototype._getMoveDelta=function(e){var t=10;return e.shiftKey?e.ctrlKey||(t=50):e.ctrlKey&&(t=1),t},t.defaultProps={isOpen:!1,isDarkOverlay:!0,isBlocking:!1,className:"",containerClassName:""},t=Object(r.__decorate)([y.withResponsiveMode],t)}(o.Component)},583:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(163);function o(e){for(var t,n=[],o=Object(r.a)(e)||document;e!==o.body;){for(var i=0,a=e.parentElement.children;i<a.length;i++){var s=a[i];s!==e&&"true"!==(null===(t=s.getAttribute("aria-hidden"))||void 0===t?void 0:t.toLowerCase())&&n.push(s)}if(!e.parentElement)break;e=e.parentElement}return n.forEach((function(e){e.setAttribute("aria-hidden","true")})),function(){!function(e){e.forEach((function(e){e.setAttribute("aria-hidden","false")}))}(n),n=[]}}},584:function(e,t,n){"use strict";var r=n(0),o=n(49),i=600,a=800,s=8,c=25,u={location:!1,menubar:!1,resizable:!0,scrollbars:!1,status:!1,toolbar:!1},l=-1;function d(e,t){try{t=function(e){var t=c*(1+(l=(l+1)%s)),n={left:window.screenX+t,top:window.screenY+t,height:Math.max(25*Math.pow(window.innerHeight,.5),i),width:Math.max(8*Math.pow(window.innerWidth,2/3),a)};return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},u),n),e)}(t);var n=window.open(e,"_blank",function(e){return Object.getOwnPropertyNames(e).map((function(t){return t+"="+("boolean"==typeof(n=e[t])?n?"1":"0":n?String(n):void 0);var n})).join(",")}(t));return(Object(o.e)()||Object(o.f)())&&n.moveTo(t.left,t.top),n}catch(e){return null}}var f=n(2),p=n(556),m=n(423),g="version";var h=n(123),v=n(483);t.a=Object(h.d)("addPopoutV2",{name:"PopoutAddPopout",customData:function(e,t,n,r,o,i){return[(t||"").split("/")[0],i]}})((function(e,t,n,r,i,a,s){var c=function(e){var t=null,n=void 0,r=null;return e&&(!function(e){return void 0!==e.deeplinkData||!!e.projectionTabId}(e)?n=e:(n=e.deeplinkData,(Object(o.e)()||Object(o.h)()||Object(o.f)())&&(t=e.projectionTabId||null),r=e.projectionTargetWindow)),{deeplinkCallback:void 0===n?function(){return Promise.resolve(null)}:"function"==typeof n?n:function(){return Promise.resolve(n)},projectionTabId:t,projectionTargetWindow:r}}(n),u=c.deeplinkCallback,l=c.projectionTabId,h=c.projectionTargetWindow,y=l?"about:blank":function(e,t,n,r){var o;void 0===r&&(r={});var i=((o={})[g]=Object(f.j)(),o[m.a]=m.b,o);return Object.keys(r).map((function(e){i[e]=r[e]})),Object(p.q)(e,t,n,i)}(e,t,i,s),b=h||d(y,r);b&&v.g.import().then((function(t){return t(e,b,l,u)}))}))},5875:function(e,t,n){"use strict";function r(e){var t=[],n=e.attachmentWell;return n&&(n.docViewAttachments.forEach((function(e){t.push(e.attachmentId)})),n.inlineAttachments.forEach((function(e){t.push(e.attachmentId)})),n.imageViewAttachments.forEach((function(e){t.push(e.attachmentId)}))),t}n.d(t,"a",(function(){return r}))},5876:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(963);function o(e,t){var n,o,i,a="";if(e){var s=r.w.items.get(null===(n=e.referenceItemId)||void 0===n?void 0:n.Id);switch(t){case"smartReply":(null===(o=null==s?void 0:s.SmartReplyData)||void 0===o?void 0:o.ExtractionID)&&(a=s.SmartReplyData.ExtractionID);break;case"smartDoc":(null===(i=null==s?void 0:s.SmartDocData)||void 0===i?void 0:i.EntityId)&&(a=s.SmartDocData.EntityId)}}return a}},5877:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=["errorMessageAccountSuspend","errorMessageAccountSuspendShowTierUpgrade","errorMessageExceededHourlyMessageLimit","errorMessageExceededMaxRecipientLimit","errorMessageExceededMaxRecipientLimitShowTierUpgrade","errorMessageExceededMessageLimit","errorMessageExceededMessageLimitShowTierUpgrade","errorMessageMessageSubmissionBlocked","errorMessageMessageBlocked","errorMessageTimeout","errorMessageThrottled","errorMessageTransientError","errorMessageItemNoLongerExistToSave","errorMessageItemNoLongerExistToSend","errorMessageQuotaExceededMessageCanNotBeSaved","errorMessageQuotaExceededMessageCanNotBeSent","errorMessageSubmissionQuotaExceededMessageCanNotBeSent","errorMessageMessageCanNotBeSaved","errorMessageMessageCanNotBeSent","errorMessageNoPermissionToSendAs","errorMessageNoRecipentsMailCanNotBeSend","errorMessageInvalidSenderMailCanNotBeSend","warningMessageMaxRecipientsExceed","warningMessageNoPermissionToPerformAction","error500","error503","errorFailedToFetch","errorSessionTimeout","errorMailboxStoreUnavailable","errorMessageErrorWithDetail","smimeEncodeError","smimeBccForkingFailedError"]},5878:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(553);function o(e){return e?Object(r.a)({Id:e.Id,ChangeKey:e.ChangeKey}):null}},5879:function(e,t,n){"use strict";function r(e){if(e.smimeBccForkingMode){var t=e.smimeBccForkingMode;return 2===t||3===t}return!1}n.d(t,"a",(function(){return r}))},588:function(e,t,n){"use strict";var r=n(42),o=n(305),i=n(417),a=n(309),s=n(1),c=n(438),u=n(722),l=n(308).bind(u),d=Object(r.a)((function(e){var t={color:(e.categoryName?Object(i.a)(e.categoryName,e.categoryList?e.categoryList:Object(c.n)()):e.categoryColorId?a.a.colorCodeColorValueMap[e.categoryColorId]:Object(i.b)()).iconColor},n=l(u.categoryIcon,e.iconClassName);return s.createElement(o.a,{className:n,iconName:"TagSolid",style:t})}));t.a=d},5880:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(76),o=n(296);function i(e){Object(r.h)("cmp-clp")&&e.AdditionalProperties.push(Object(o.a)({PropertyName:"msip_labels",DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"}))}},590:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e,t){var n,o,i=[],a=!1,s=e.trim().toLocaleLowerCase();try{for(var c=Object(r.__values)(t),u=c.next();!u.done;u=c.next()){var l=u.value,d=l.Name.trim().toLocaleLowerCase();""!=d&&d.indexOf(s)>=0&&(i.push(l),d==s&&(a=!0))}}catch(e){n={error:e}}finally{try{u&&!u.done&&(o=c.return)&&o.call(c)}finally{if(n)throw n.error}}var f=e.toLocaleLowerCase().trim();return i.sort((function(e,t){var n=e.Name.toLocaleLowerCase().trim(),r=t.Name.toLocaleLowerCase().trim(),o=n.indexOf(f),i=r.indexOf(f);return o==i?n.localeCompare(r):o-i})),{suggestions:i,hasExactMatch:a}}},5903:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(5399),o=n(1292);function i(e,t,n,i,a,s){var c={operation:0,bodyType:"HTML",subject:i,newContent:a,to:e,cc:t,bcc:n,preferAsyncSend:!0,attachmentFilesToUpload:Object(r.a)(s)};o.m.importAndExecute(c,2)}},593:function(e,t,n){"use strict";var r=n(0),o=n(283),i=function(){function e(e){this.maxSize=e,this.references=[],this.mruList=[]}return e.prototype.initialize=function(e,t){var n,o;if(this.store)throw new Error("MruCache cannot be initialized twice.");this.store=e,this.deleteCallback=t;try{for(var i=Object(r.__values)(e.keys()),a=i.next();!a.done;a=i.next()){var s=a.value;this.mruList.push(s)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}},e.prototype.add=function(e,t){var n=this;Object(o.action)("MruCache_add")((function(){n.store.set(e,t),n.mruList.indexOf(e)>=0?n.touch(e):(n.mruList.push(e),n.purgeIfNecessary())}))()},e.prototype.get=function(e){return this.store.get(e)},e.prototype.getAndTouch=function(e){var t=this.store.get(e);return t&&this.touch(e),t},e.prototype.has=function(e){return this.store.has(e)},e.prototype.remove=function(e){var t=this;Object(o.action)("MruCache_remove")((function(){if(t.store.has(e)&&!t.isReferenced(e))return t.removeItemAtIndex(t.mruList.indexOf(e))}))()},e.prototype.registerReference=function(e){this.references.push(e)},e.prototype.clear=function(){var e=this;Object(o.action)("MruCache_clear")((function(){e.purgeTillSize(0)}))()},e.prototype.getItemIds=function(){return new(Array.bind.apply(Array,Object(r.__spread)([void 0],this.mruList)))},e.prototype.touch=function(e){var t=this.mruList.indexOf(e);if(t<0)throw new Error("Item with key '"+e+"' does not exist in the cache.");this.mruList.splice(t,1),this.mruList.push(e)},e.prototype.purgeIfNecessary=function(){this.purgeTillSize(this.maxSize)},e.prototype.purgeTillSize=function(e){for(var t=0;this.mruList.length>e&&t<this.mruList.length;){var n=this.mruList[t];this.isReferenced(n)?t++:this.removeItemAtIndex(t)}},e.prototype.removeItemAtIndex=function(e){if(e<0||e>=this.mruList.length)throw new Error("Invalid index to remove: "+e);var t=this.mruList[e];this.mruList.splice(e,1),this.deleteCallback?this.deleteCallback(t):this.store.delete(t)},e.prototype.isReferenced=function(e){for(var t=0;t<this.references.length;t++){var n=this.references[t]();if(Array.isArray(n)){if(-1!=n.indexOf(e))return!0}else if(n==e)return!0}return!1},e}();n.d(t,"a",(function(){return i}))},6151:function(e,t,n){"use strict";var r=n(4217),o=n(1046),i=n(3850),a=n(76),s=n(1013);function c(e,t){var n,c=Object(o.c)(e);if(c){var u=c.mode,l=Object(i.c)(u);if(l){var d=Object(r.c)(l.addinId,l.commandId,u);if(null===(n=c.isSharedItem)||void 0===n||!n.call(c)||Object(a.h)("addin-delegateAccess")&&Object(s.f)(d))if(d&&!Object(r.f)(d)){var f=Object(s.x)();Object(s.W)(f,e,d,"Persistent",u,t)}else!d&&Object(s.K)()&&Object(i.h)(u,null)}}}var u=n(1097),l={hostItemIndex:null,mode:u.a.Unknown,isNullSent:!1};function d(){return l}function f(e){l=e}function p(e){switch(Object(o.c)(e).mode){case u.a.MessageRead:case u.a.MeetingRequest:return u.a.MessageRead;case u.a.MessageCompose:return u.a.MessageCompose;default:return u.a.Unknown}}function m(){Object(s.bb)("Persistent"),f({hostItemIndex:null,mode:u.a.Unknown,isNullSent:!1})}var g=n(0),h=n(3218),v=n(3040);function y(e){var t=d();t.mode!==u.a.MessageCompose&&t.mode!==u.a.Unknown?(Object(s.ib)(e),t.isNullSent||(!function(){var e=Object(s.A)("Persistent");if(e){Object(v.d)(v.a.ITEM_CHANGED_EVENT_DISPID,e.controlId,null)}}(),f({hostItemIndex:null,mode:u.a.MessageRead,isNullSent:!0}))):m()}var b=n(5615);function _(e){Object(b.a)(0),Object(s.A)("Persistent")?(Object(s.jb)(e),function(e){Object(g.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(g.__generator)(this,(function(r){switch(r.label){case 0:return(t=Object(s.A)("Persistent"))?[4,Object(h.b)(t.controlId,e)]:[3,2];case 1:n=r.sent(),Object(v.d)(v.a.ITEM_CHANGED_EVENT_DISPID,t.controlId,n),r.label=2;case 2:return[2]}}))}))}(e)):c(e),f({hostItemIndex:e,mode:p(e),isNullSent:!1})}var S=n(3468),C=n(1730);function O(e,t){if(Object(S.c)())switch(e){case C.a.NotSupported:m();break;case C.a.Empty:y(1);break;case C.a.Multi:y(2);break;case C.a.Single:t&&function(e){Object(h.g)(e)&&Object(s.K)()&&Object(i.e)()&&!function(e){var t=Object(o.c)(e);return t.mode===u.a.MessageRead&&t.isInlineComposeOpen()}(e)&&function(e){var t=Object(o.c)(e);return t.mode!==u.a.MessageRead||t.isItemSelected()}(e)&&!function(e){return e===d().hostItemIndex}(e)&&(function(e){var t=Object(o.c)(e),n=t.mode;return!(!Object(a.h)("addin-delegateAccess")&&t.isSharedItem&&t.isSharedItem())&&(n!==u.a.MessageRead||Object(s.Y)(t.getItem()))}(e)?function(e){return p(e)!==d().mode}(e)?function(e){Object(s.bb)("Persistent"),c(e),f({hostItemIndex:e,mode:p(e),isNullSent:!1})}(e):!function(e){var t=Object(o.c)(e),n=Object(s.A)("Persistent");return!!n&&(!Object(s.f)(n.addinCommand)&&!!(t&&t.isSharedItem&&t.isSharedItem()))}(e)?_(e):y(4):y(3))}(t)}}n.d(t,"a",(function(){return O}))},6163:function(e,t,n){"use strict";var r=n(0),o=n(1013),i=n(1097),a=n(76),s=function(){function e(){var e=this;this.getAutoRunAddinsByLaunchEventType=function(t){var n=e.getAddinsForMode(i.a.LaunchEvent),r=[],o=[];return(r=e.autoRunAddinsIndexMapping.get(t))&&r.map((function(e){o.push(n[e])})),o},this.setAutoRunAddinsMapping=function(t){t.forEach((function(t,n){Object(r.__spread)(t.AddinCommands.values()).forEach((function(t){var r=t.getLaunchEventType();e.setAutoRunAddinMapForLaunchEventType(r,n)}))}))},this.setAutoRunAddinMapForLaunchEventType=function(t,n){e.autoRunAddinsIndexMapping.has(t)?e.autoRunAddinsIndexMapping.get(t).push(n):e.autoRunAddinsIndexMapping.set(t,[n])},this.isInitialized=!1,this.appointmentAttendeeAddins=[],this.appointmentOrganizerAddins=[],this.detectedEntityAddins=[],this.messageReadAddins=[],this.messageComposeAddins=[],this.meetingRequestAddins=[],this.eventsAddins=[],this.autoRunAddins=[],this.autoRunAddinsIndexMapping=new Map}return e.prototype.getExtensionPoint=function(e,t){var n=this.getAddinsForMode(e);if(t){if(!Object(a.h)("addin-delegateAccess"))return[];n&&(n=Object(o.m)(n))}return n},e.prototype.setExtensionPoint=function(e,t){switch(t){case i.a.MeetingRequest:this.meetingRequestAddins=e;break;case i.a.AppointmentAttendee:this.appointmentAttendeeAddins=e;break;case i.a.AppointmentOrganizer:this.appointmentOrganizerAddins=e;break;case i.a.DetectedEntity:this.detectedEntityAddins=e;break;case i.a.MessageCompose:this.messageComposeAddins=e;break;case i.a.MessageRead:this.messageReadAddins=e;break;case i.a.TrapOnSendEvent:this.eventsAddins=e;break;case i.a.LaunchEvent:this.autoRunAddins=e,this.setAutoRunAddinsMapping(e)}},e.prototype.getAddinsForMode=function(e){switch(e){case i.a.MeetingRequest:return this.meetingRequestAddins;case i.a.AppointmentAttendee:return this.appointmentAttendeeAddins;case i.a.AppointmentOrganizer:return this.appointmentOrganizerAddins;case i.a.DetectedEntity:return this.detectedEntityAddins;case i.a.MessageCompose:return this.messageComposeAddins;case i.a.MessageRead:return this.messageReadAddins;case i.a.TrapOnSendEvent:return this.eventsAddins;case i.a.LaunchEvent:return this.autoRunAddins;default:return null}},e}(),c=n(5617),u=function(){function e(){}return e.prototype.setExecutionInitTime=function(){this.executionInitTime=Object(c.a)()},e.prototype.setExecutionStartTime=function(){this.executionStartTime=Object(c.a)()},e.prototype.setExecutionEndTime=function(){this.executionEndTime=Object(c.a)()},e.prototype.setQueuePushTime=function(){this.queuePushTime=Object(c.a)()},e.prototype.setQueuePopTime=function(){this.queuePopTime=Object(c.a)()},e.prototype.getExecutionInitTime=function(){return this.executionInitTime},e.prototype.getExecutionStartTime=function(){return this.executionStartTime},e.prototype.getExecutionEndTime=function(){return this.executionEndTime},e.prototype.getQueuePushTime=function(){return this.queuePushTime},e.prototype.getQueuePopTime=function(){return this.queuePopTime},e}(),l=function(e,t){this.addinCommand=e,this.addinCommandTelemetry=t,this.controlId=Object(o.x)()},d=function(){function e(){}return e.prototype.setExecutionInitTime=function(){this.executionInitTime=Object(c.a)()},e.prototype.setExecutionStartTime=function(){this.executionStartTime=Object(c.a)()},e.prototype.setExecutionEndTime=function(){this.executionEndTime=Object(c.a)()},e.prototype.getExecutionInitTime=function(){return this.executionInitTime},e.prototype.getExecutionStartTime=function(){return this.executionStartTime},e.prototype.getExecutionEndTime=function(){return this.executionEndTime},e}();n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return d}))},6208:function(e,t,n){"use strict";var r=n(27);function o(){return function(){var e=Object(r.a)().SessionSettings.WebSessionType;if(1===e)return"outlookCom";if(2===e)return"gmail";if(0==e)return"office365";return"unknown"}()}n.d(t,"a",(function(){return o}))},6270:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));n(0),n(5618);var r={currentAction:null,rootActions:[]};function o(e){return void 0===e&&(e=r),JSON.stringify(e.rootActions)}},6271:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(4816),o=n(1046),i=n(3850),a=n(1013);function s(e,t,n,s){var c;Object(r.a)(e);var u=Object(a.A)("Persistent");if(!(u&&(l=u.addinCommand,d=t,l&&d&&l.get_Id()===d.get_Id()))){var l,d,f=Object(o.c)(e);(null===(c=f)||void 0===c?void 0:c.openTaskPane)&&f.openTaskPane();var p=Object(a.x)();Object(a.W)(p,e,t,function(e,t){var n=Object(i.c)(t);if(!n)return"NonPersistent";var r=n.addinId,o=n.commandId;return e.get_Id()===""+r+o?"Persistent":"NonPersistent"}(t,n),n,s)}}},6272:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r,o=n(1),i=n(244),a=n(6707),s=n(7590);function c(){Object(s.a)().then((function(e){i.render(o.createElement(a.a,{storeUrl:e,ref:function(e){return!!e&&e.setPanelOpen()}}),r)}))}r=document.createElement("div"),document.body.appendChild(r)},629:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"GetItemRequest:#Exchange"},e)}},630:function(e,t,n){"use strict";var r=n(25),o=n(0);function i(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(o.__assign)({__type:"GetItemJsonRequest:#Exchange"},n)),Object(r.a)("GetItem",e,t)}n.d(t,"a",(function(){return i}))},6329:function(e,t,n){"use strict";var r=n(0);t.a=function(e){return e&&0!==e.length?e.filter((function(e){return!!e})).reduce((function(e,t){return Object(r.__spread)(e,(null==(n=t)?void 0:n.recipients)?n.recipients.slice():[]);var n}),[]):[]}},6330:function(e,t,n){"use strict";function r(e,t){if(e){if(e.indexOf("500")>=0)return"error500";if(e.indexOf("503")>=0)return"error503";if(e.indexOf("Failed to fetch")>=0)return"errorFailedToFetch"}switch(e){case"ErrorSessionTimeout":return"errorSessionTimeout";case"ErrorMailboxStoreUnavaiable":return"errorMailboxStoreUnavailable";case"ErrorSendAsDenied":return"errorMessageNoPermissionToSendAs";case"ErrorRightsManagementPermanentException":return null;case"ErrorSubmissionQuotaExceeded":return"errorMessageSubmissionQuotaExceededMessageCanNotBeSent";case"ErrorAccountSuspend":return"errorMessageAccountSuspend";case"ErrorExceededMaxRecipientLimit":return"errorMessageExceededMaxRecipientLimit";case"ErrorExceededMessageLimit":return"errorMessageExceededMessageLimit";case"ErrorExceededHourlyMessageLimit":return"errorMessageExceededHourlyMessageLimit";case"ErrorMessageBlocked":return"errorMessageMessageBlocked";case"ErrorMessageSubmissionBlocked":return"errorMessageMessageSubmissionBlocked";case"ErrorAccountSuspendShowTierUpgrade":return"errorMessageAccountSuspendShowTierUpgrade";case"ErrorExceededMaxRecipientLimitShowTierUpgrade":return"errorMessageExceededMaxRecipientLimitShowTierUpgrade";case"ErrorExceededMessageLimitShowTierUpgrade":return"errorMessageExceededMessageLimitShowTierUpgrade";case"ErrorMessageTimeout":return"errorMessageTimeout";case"ErrorMessageThrottled":return"errorMessageThrottled";case"ErrorMessageTransientError":return"errorMessageTransientError";case"ErrorItemNotFound":return t?"errorMessageItemNoLongerExistToSend":"errorMessageItemNoLongerExistToSave";case"ErrorAccessDenied":return"warningMessageNoPermissionToPerformAction";case"SmimeEncodeError":return"smimeEncodeError";case"ErrorQuotaExceeded":return t?"errorMessageQuotaExceededMessageCanNotBeSent":"errorMessageQuotaExceededMessageCanNotBeSaved";default:return t?"errorMessageMessageCanNotBeSent":"errorMessageMessageCanNotBeSaved"}}n.d(t,"a",(function(){return r}))},6331:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),o=n(4924),i=n(4925);function a(e,t){return function(e,t){for(var n=0;n<t.length;n++)if(s(t[n],e))return t[n];return null}((e||[]).concat(t||[]),Object(o.a)(!0))}function s(e,t){var n,o;if(t&&t.length>0)try{for(var a=Object(r.__values)(t),s=a.next();!s.done;s=a.next()){var c=s.value;if(c&&Object(i.a)(e,c.EmailAddress))return!0}}catch(e){n={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(n)throw n.error}}return!1}},6332:function(e,t,n){"use strict";n.d(t,"d",(function(){return f})),n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return h}));var r=n(0),o=n(7224),i=n(9),a=n(1579),s=n(2678),c=n(6333),u=n(2098),l="",d="";function f(e,t){var n;if(e){e.WasclUpgradeToPremiumUrl&&(l=e.WasclUpgradeToPremiumUrl),e.AccountRecoveryFlowUrl&&(d=e.AccountRecoveryFlowUrl);var r=(null===(n=e.ResponseMessages)||void 0===n?void 0:n.Items)?e.ResponseMessages.Items[0]:null;!r||"ErrorExceededMessageLimit"!=r.ResponseCode&&"ErrorExceededHourlyMessageLimit"!=r.ResponseCode&&"ErrorExceededMessageLimitShowTierUpgrade"!=r.ResponseCode||Object(s.b)(t,!0)}}function p(e){return{text:Object(i.b)(o.a),action:function(){Object(a.a)(e,["errorMessageExceededMessageLimit","errorMessageExceededMaxRecipientLimit"]),window.open(l)}}}var m=null;function g(e,t){return{text:Object(i.b)(o.b),action:function(){var n;null===m&&(n=Object(r.__read)(Object(u.a)(c.a,t),1),(m=n[0]).then((function(t){var n=t.success;m=null,n&&function(e){Object(a.a)(e,["errorMessageMessageSubmissionBlocked","errorMessageExceededMaxRecipientLimitShowTierUpgrade","errorMessageExceededMessageLimitShowTierUpgrade"])}(e)}),(function(e){m=null})))}}}function h(e){return{text:Object(i.b)(o.b),action:function(){Object(a.a)(e,["errorMessageAccountSuspend","errorMessageAccountSuspendShowTierUpgrade"]),window.open(d)}}}},6333:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(108),o=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(448)]).then(n.bind(null,9874))})),i=Object(r.d)(o,(function(e){return e.HipCheckModal}))},6334:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n(0),o=n(4701),i=n(76),a=n(1656),s=n(1423),c=n(1957),u=n(431),l=n(484),d=n(964),f=n(1020),p=n(3508),m=n(246),g=n(27),h=n(1653);function v(e,t,n,v,y,b,_,S,C){var O,A=function(e,t,n,a,s,p,m,g,v){var y="PostItem:#Exchange"==e.__type?"newPost":"newMail",b=m?Object(f.a)({BaseFolderId:Object(u.a)({Id:m})}):null,_=Object(c.a)(Object(r.__assign)({ClientSupportsIrm:!0,ComposeOperation:y,MessageDisposition:n?"SendAndSaveCopy":"SaveOnly",Items:[e],TimeFormat:a,SendOnNotFoundError:!0,RemoteExecute:g,ItemShape:Object(l.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(d.a)({FieldURI:"ItemLastModifiedTime"})]}),SavedItemFolderId:b,SuppressMarkAsReadOnReplyOrForward:Object(i.h)("tri-suppressMarkReadBehaviorOnRF")&&v},Object(h.a)()));return(null==p?void 0:p.IsOwner)&&(_.ComplianceId=p.RmsTemplateId?p.RmsTemplateId.toUpperCase():"0"),n?s&&(_.ItemShape.ReturnOnlyInternetMessageId=!0):(_.ItemShape=Object(o.a)(t),_.ShapeName="MailCompose"),_}(e,t,n,v,y,b,_,S,C);if("PostItem:#Exchange"==e.__type){var I=s.a.folderTable.get(_);O=Object(a.a)(null!=I.ReplicaList?I.ReplicaList[0]:Object(g.a)().SessionSettings.DefaultPublicFolderMailbox)}return Object(p.a)({Header:Object(m.a)(),Body:A},O).then((function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))}))}},6335:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"ReplyAllToItem:#Exchange"},e)}},6336:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"ReplyToItem:#Exchange"},e)}},6337:function(e,t,n){"use strict";function r(e){return(null==e?void 0:e.recipients)?e.recipients.length:0}n.d(t,"a",(function(){return r}))},6343:function(e,t,n){"use strict";var r=n(283);t.a=Object(r.action)("setIsDirty")((function(e,t){void 0===t&&(t=!0),e.isDirty=t}))},6344:function(e,t,n){"use strict";var r=n(2195),o=n(4);t.a=Object(o.mutatorAction)("showCcWell",(function(e){e.ccRecipientWell||(e.ccRecipientWell=Object(r.a)(e.toRecipientWell.findPeopleFeedbackManager,[]))}))},6348:function(e,t,n){"use strict";var r=n(283);t.a=Object(r.action)("switchToReadWriteRecipient")((function(e){e.showCompactRecipientWell=!1}))},6492:function(e,t,n){"use strict";var r=n(0),o=n(5878),i=n(4769),a=n(4086),s=n(4698),c=n(5879);var u=new RegExp("<img[^>]*\\s+src=[\"']data:image\\/[^<]+;base64,\\s*[a-zA-Z0-9+\\/=&#;]+[\"'][^>]*>","gi");function l(e){var t=0;if(e){var n=e.match(u);t=n?n.length:0}return t}var d=new RegExp('<IMG[^>]+?ORIGINALSRC\\s*=\\s*"[\\s\\S]+?"[\\s\\S]*?>',"gim"),f=new RegExp('\\sSRC\\s*=\\s*"DATA:[\\s\\S]+?"',"im"),p=new RegExp('\\sORIGINALSRC\\s*=\\s*"',"im");function m(e,t){return e?e.replace(d,(function(e){return e=e.replace(f,""),t&&(e=e.replace(p,' src="')),e})):e}var g=n(27),h=n(3750),v=n(1289),y=n(296),b=35356;var _=n(7),S="0x3FEF";function C(e,t){if(t.ExtendedProperty)for(var n=e.length;n--&&t.ExtendedProperty.length>0;)for(var r=t.ExtendedProperty.length;r--;)if(e[n]===t.ExtendedProperty[r].ExtendedFieldURI.PropertyName){t.ExtendedProperty.splice(r,1);break}}function O(e,t,n){var r,o;n?C(["AppendOnSend"],t):e.appendOnSend&&e.appendOnSend.length>0&&(r=e.appendOnSend,(o=t).ExtendedProperty||(o.ExtendedProperty=[]),o.ExtendedProperty.push(Object(v.a)({Value:JSON.stringify(r),ExtendedFieldURI:Object(y.a)({DistinguishedPropertySetId:"Common",PropertyName:"AppendOnSend",PropertyType:"String"})})))}function A(e,t){e.internetHeaders.size>0&&function(e,t){var n,o;t.ExtendedProperty||(t.ExtendedProperty=[]);try{for(var i=Object(r.__values)(e.keys()),a=i.next();!a.done;a=i.next()){var s=a.value;t.ExtendedProperty.push(Object(v.a)({Value:e.get(s),ExtendedFieldURI:Object(y.a)({DistinguishedPropertySetId:"InternetHeaders",PropertyName:s,PropertyType:"String"})}))}}catch(e){n={error:e}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}}(e.internetHeaders,t),e.keysOfInternetHeadersToBeRemoved.length>0&&C(e.keysOfInternetHeadersToBeRemoved,t)}function I(e,t,n){n?C(["ComposeType"],t):null!==e.draftComposeType&&function(e,t){t.ExtendedProperty||(t.ExtendedProperty=[]);t.ExtendedProperty.push(Object(v.a)({Value:e,ExtendedFieldURI:Object(y.a)({DistinguishedPropertySetId:"Common",PropertyName:"ComposeType",PropertyType:"String"})}))}(e.draftComposeType,t)}var x=n(3817),E=n(6332),T=n(4),P=Object(T.mutatorAction)("clearKeysOfInternetHeadersToBeRemoved",(function(e){e.keysOfInternetHeadersToBeRemoved=[]})),w=n(553),M=n(283);function R(e){e&&(e.isDirty=!1)}var j=Object(M.action)("updateComposeItemId")((function(e,t,n,r){e&&(e.itemId?e.itemId.ChangeKey=n:e.itemId=Object(w.a)({Id:t,ChangeKey:n}),r&&(e.lastSaveTimeStamp=r,e.isDirty=!1,R(e.toRecipientWell),R(e.ccRecipientWell),R(e.bccRecipientWell)))})),k=n(2268),N=n(4926),D=n(1235),F=n(76),L=n(953),U=n(1648),B=n(2007),H=n(9),W=n(3963),V=n(4699),z=function(e){switch(e.labelApplyMethod){case W.a.Manual:return V.d;case W.a.Default:case W.a.Automatic:default:return V.e}},G=n(3818),q="MSIP_Label";function K(e,t){var n=Object(g.a)().SessionSettings.ExternalDirectoryTenantGuid,r=e.selectedCLPLabel,o=e.originalCLPLabel,i=e.nonTenantLabelString;if(function(e,t,n){if(!e&&!t)return;var r=e&&!t&&e.isDefault;if(e&&t&&e.id==t.id&&!t.isDefault)return;var o=(t&&!r?t.id:V.a)+";"+(e?e.id:V.a);X(V.b,o,n)}(r,o,t),r||i){var a="";if(r)a=function(e,t){return Object.keys(e).map((function(n){return q+"_"+t.id+"_"+n+"="+e[n]+";"})).join("")}({Enabled:"True",SiteId:n,SetDate:Object(_.ub)(Object(_.Qb)()),Name:r.displayName,ContentBits:0,Method:z(e)},r);var s=i?i+a:a;X(V.c,s,t),Object(G.c)(r)}}function X(e,t,n){var r=Object(v.a)({ExtendedFieldURI:Object(y.a)({PropertyName:e,DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"}),Value:t});n.ExtendedProperty?n.ExtendedProperty.push(r):n.ExtendedProperty=[r]}var J=n(3528),Q=n(1108),Z=n(4700);var Y=n(6334),$=n(6506),ee=n(315),te=n(484);var ne=n(964),re=n(25);function oe(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"PostGroupItemJsonRequest:#Exchange"},n)),Object(re.a)("PostGroupItem",e,t)}var ie=n(246),ae=n(1653);function se(e,t,n,o,i,a){var s,c=(s=Object(r.__assign)({ModernGroupEmailAddress:{EmailAddress:e,MailboxType:"GroupMailbox"},ClientSupportsIrm:!0,ComposeOperation:"newPost",MessageDisposition:"SendAndSaveCopy",Items:[t],TimeFormat:o,ItemShape:Object(te.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(ne.a)({FieldURI:"ItemLastModifiedTime"})]})},Object(ae.a)()),Object(r.__assign)({__type:"PostGroupItemRequest:#Exchange"},s));return a&&(c.ItemShape.ReturnOnlyInternetMessageId=!0),(null==i?void 0:i.IsOwner)&&(c.ComplianceId=i.RmsTemplateId?i.RmsTemplateId.toUpperCase():"0"),c}function ce(e,t,n,r,o,i){var a=se(e,t,0,r,o,i),s={headers:Object(ee.f)(null,"GroupMailbox")};return oe({Header:Object(ie.a)(),Body:a},s).then((function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))}))}function ue(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"PostUnifiedGroupItemJsonRequest:#Exchange"},n)),Object(re.a)("PostUnifiedGroupItem",e,t)}function le(e,t,n,o,i){var a,s=(a={ModernGroupEmailAddress:{EmailAddress:e,MailboxType:"GroupMailbox"},SkipGroupSyncDelivery:!0,ClientSupportsIrm:!0,Item:t,ItemShape:Object(te.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(ne.a)({FieldURI:"ItemLastModifiedTime"})]})},Object(r.__assign)({__type:"PostUnifiedGroupItemRequest:#Exchange"},a));return i&&(s.ItemShape.ReturnOnlyInternetMessageId=!0),s}var de=n(4927),fe=n(3197),pe=n(2037);function me(e,t){return Object(pe.a)({Path:Object(y.a)({DistinguishedPropertySetId:e,PropertyName:t,PropertyType:"String"})})}var ge=n(1569),he=n(2379),ve=n(2342);function ye(e,t,n,o){var i=function(e,t,n,o){var i,a=[];e.MimeContent&&a.push(Object(fe.a)("MimeContent",e.MimeContent));var s=[Object(fe.a)("ToRecipients",e.ToRecipients),Object(fe.a)("CcRecipients",e.CcRecipients),Object(fe.a)("BccRecipients",e.BccRecipients),Object(fe.a)("Subject",e.Subject),Object(fe.a)("Body",e.Body),Object(fe.a)("Importance",e.Importance),Object(fe.a)("IsReadReceiptRequested",e.IsReadReceiptRequested),Object(fe.a)("IsDeliveryReceiptRequested",e.IsDeliveryReceiptRequested)];(null===(i=e.Attachments)||void 0===i?void 0:i.length)&&s.push(Object(fe.a)("Attachments",e.Attachments)),e.ItemClass&&s.push(Object(fe.a)("ItemClass",e.ItemClass)),e.From&&s.push(Object(fe.a)("From",e.From)),o.length>0&&o.map((function(e){s.push(me("InternetHeaders",e))})),t&&s.push(me("Common","AppendOnSend")),e.MentionsEx&&s.push(Object(fe.a)("MentionsEx",e.MentionsEx)),e.Sensitivity&&s.push(Object(fe.a)("Sensitivity",e.Sensitivity)),e.ExtendedProperty&&e.ExtendedProperty.map((function(e){s.push(Object(de.a)(e))})),t&&e.DocLinks&&e.DocLinks.length>0&&s.push(Object(fe.a)("DocLinks",e.DocLinks));var c=Object(ge.a)({Updates:Object(r.__spread)(a,s),ItemId:Object(w.a)({Id:e.ItemId.Id,ChangeKey:e.ItemId.ChangeKey})}),u=Object(he.a)(Object(r.__assign)({ItemChanges:[c],ConflictResolution:"AlwaysOverwrite",ClientSupportsIrm:!0,SendCalendarInvitationsOrCancellations:"SendToNone",MessageDisposition:t?"SendAndSaveCopy":"SaveOnly",SuppressReadReceipts:!1,ComposeOperation:"newMail",PromoteInlineAttachments:!1,SendOnNotFoundError:!0,ItemShape:Object(te.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(ne.a)({FieldURI:"ItemLastModifiedTime"})]})},Object(ae.a)()));return(null==n?void 0:n.IsOwner)&&(u.ComplianceId=n.RmsTemplateId?n.RmsTemplateId.toUpperCase():"0"),u}(e,t,n,o);return Object(ve.a)({Header:Object(ie.a)(),Body:i}).then((function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))}))}var be=n(1421),_e=n(965),Se="InternetHeaders",Ce="X-Ms-Exchange-Organization-Dlp-SenderOverrideJustification",Oe="X-Ms-Exchange-Organization-Dlp-FalsePositive";var Ae=n(2119);function Ie(e){if(!e)return null;var t=e.IRMData;return!t||t.RmsTemplateId&&!Ae.b.rmsTemplates.get(t.RmsTemplateId)?null:t}function xe(e){return Object(r.__assign)({__type:"ApproveRequestItem:#Exchange"},e)}var Ee=n(1182),Te=n(1920);function Pe(e){return Object(r.__assign)({__type:"RejectRequestItem:#Exchange"},e)}var we=n(6335),Me=n(6336),Re=n(295),je=n(3028),ke=n(3099),Ne=n(1890),De=n(4666),Fe=n(4702),Le="X-MS-Exchange-Organization-ClientSubmitSmtp-OriginalFrom";var Ue=n(1833);n.d(t,"c",(function(){return Ke})),n.d(t,"b",(function(){return Xe})),n.d(t,"a",(function(){return Je}));var Be='<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style type="text/css" style="display:none;"> P {{margin-top:0;margin-bottom:0;}} </style></head><body dir="{0}">{1}</body></html>',He="IPM.Note";function We(e){var t=e.content,n=0;if("HTML"==e.bodyType){var o=Qe(e);n=l(t=m(t)),t=Object(H.c)(Be,o,t)}var i,a=Object(Ee.a)({BodyType:e.bodyType,Value:t});a.DataUriCount=n;var s,c={Subject:e.subject||"",Importance:e.importance,Sensitivity:e.sensitivity};return s=Object(r.__assign)(Object(r.__assign)({},c),{Body:a}),i=Object(r.__assign)({__type:"PostItem:#Exchange"},s),e.itemId&&(i.ItemId=e.itemId),e.fromViewState&&function(e,t){var n=e.from;t.From=Object(h.a)({Mailbox:n.email})}(e.fromViewState,i),i}var Ve=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(ke.a)(e.smimeViewState)?[2,null]:[4,D.h.import()];case 1:return(null==(t=r.sent()(e.attachmentWell,e.content,e.bodyType,!0))?void 0:t.length)?[4,Ue.i.import()]:[3,3];case 2:return n=r.sent()(t),[3,4];case 3:n=null,r.label=4;case 4:return[2,n]}}))}))};function ze(e){var t=e.content,n=0,i=Object(ke.a)(e.smimeViewState);if(e.useSmartResponse&&(t+=Object(N.a)(e.bodyType)),"HTML"==e.bodyType){var s=Qe(e);n=l(t=m(t,i)),t=Object(H.c)(Be,s,t)}var c=Object(Ee.a)({BodyType:e.bodyType,Value:t});c.DataUriCount=n;var u,d=Object(o.a)(e.itemId),f=Object(o.a)(e.referenceItemId),p=[],C=[],O=[];if(e.smimeViewState&&0!=e.smimeViewState.smimeBccForkingMode)switch(e.smimeViewState.smimeBccForkingMode){case 1:p=Object(a.a)(e.toRecipientWell),C=Object(a.a)(e.ccRecipientWell);break;case 2:if(e.bccRecipientWell){var A=e.smimeViewState.currentBccRecipientIndex;O=[Object(a.a)(e.bccRecipientWell)[A]]}break;case 3:e.bccRecipientWell&&(O=Object(a.a)(e.bccRecipientWell))}else p=Object(a.a)(e.toRecipientWell),C=Object(a.a)(e.ccRecipientWell),O=Object(a.a)(e.bccRecipientWell);var I={Subject:e.subject||"",Importance:e.importance,IsReadReceiptRequested:e.isReadReceiptRequested,IsDeliveryReceiptRequested:e.isDeliveryReceiptRequested,ToRecipients:p,CcRecipients:C,BccRecipients:O,Sensitivity:e.sensitivity};return e.useSmartResponse?u=(2==e.operation?we.a:Me.a)(Object(r.__assign)(Object(r.__assign)({},I),{UpdateResponseItemId:d,ReferenceItemId:f,ReferenceItemDocumentId:e.referenceItemDocumentId||0,NewBodyContent:c})):5==e.operation||6==e.operation?u=(5==e.operation?xe:Pe)(Object(r.__assign)(Object(r.__assign)({},I),{ReferenceItemId:f,ItemId:d,Body:c})):(u=Object(Te.a)(Object(r.__assign)(Object(r.__assign)({},I),{Body:c})),e.itemId&&(u.ItemId=e.itemId)),e.fromViewState&&function(e,t){var n=e.from;if(n){var r=!1,o=Object(g.a)().SessionSettings.ConnectedAccountInfos;if(o)for(var i=0;i<o.length;i++){var a=o[i];if(a.EmailAddress==n.email.EmailAddress){r=!0;var s=Object(v.a)({Value:a.SubscriptionGuid,ExtendedFieldURI:Object(y.a)({PropertyId:b,DistinguishedPropertySetId:"Sharing",PropertyType:"CLSID"})});t.ExtendedProperty?t.ExtendedProperty.push(s):t.ExtendedProperty=[s],t.From=Object(h.a)({Mailbox:{MailboxType:n.email.MailboxType,RoutingType:"SMTP",EmailAddress:n.email.EmailAddress,Name:a.DisplayName}});break}}r||(t.From=Object(h.a)({Mailbox:n.email}))}}(e.fromViewState,u),e.deferredSendTime&&function(e,t){if(e){var n=Object(v.a)({Value:Object(_.ub)(e),ExtendedFieldURI:Object(y.a)({PropertyTag:S,PropertyType:"SystemTime"})});t.ExtendedProperty?t.ExtendedProperty.push(n):t.ExtendedProperty=[n]}}(e.deferredSendTime,u),u}function Ge(e,t){var n,o;return Object(r.__awaiter)(this,void 0,void 0,(function(){var u,l,d,f,p,m,h,b,_,S,C,T,w;return Object(r.__generator)(this,(function(M){switch(M.label){case 0:return d=Object(g.a)().UserOptions.TimeFormat,Object(J.a)(e)?(f=e,u=We(e),[4,Object(Y.a)(u,e.bodyType,t,d,e.isInlineCompose,Ie(e.protectionViewState),f.publicFolderId)]):[3,2];case 1:return l=M.sent(),[3,14];case 2:return u=ze(e),p=u,[4,Ve(e)];case 3:return p.Attachments=M.sent(),A(e.addin,u),O(e.addin,u,t),I(e.addin,u,t),m=e.protectionViewState,Object(F.h)("cmp-clp")&&!Object(x.a)(e)&&K(m.clpViewState,u),Object(F.h)("cmp-message-classification")&&function(e,t){var n=e.messageClassification;if(n){t.ExtendedProperty||(t.ExtendedProperty=[]),Object.keys(n).forEach((function(e){var r=Z.b[e];r&&t.ExtendedProperty.push(Object(v.a)({ExtendedFieldURI:Object(y.a)({PropertyId:r.id,DistinguishedPropertySetId:"Common",PropertyType:r.propertyType}),Value:n[e]}))}));var r=Z.b.IsClassified;t.ExtendedProperty.push(Object(v.a)({ExtendedFieldURI:Object(y.a)({PropertyId:r.id,DistinguishedPropertySetId:"Common",PropertyType:r.propertyType}),Value:"true"}))}}(m.classificationViewState,u),(Object(F.h)("cmp-proxy-address")||Object(F.h)("cmp-proxy-address-sendas-param"))&&function(e,t){var n,r,o,i,a=null===(r=null===(n=null==e?void 0:e.from)||void 0===n?void 0:n.email)||void 0===r?void 0:r.EmailAddress;if(a&&!Object(Fe.a)(a)){var s=Object(v.a)({ExtendedFieldURI:Object(y.a)({PropertyName:Le,DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"}),Value:null===(i=null===(o=null==e?void 0:e.from)||void 0===o?void 0:o.email)||void 0===i?void 0:i.EmailAddress});t.ExtendedProperty?t.ExtendedProperty.push(s):t.ExtendedProperty=[s]}}(e.fromViewState,u),(null===(n=e.mentionsPicker)||void 0===n?void 0:n.atMentionTuples)&&Object.keys(e.mentionsPicker.atMentionTuples).length>0?[4,De.b.import()]:[3,5];case 4:return b=M.sent(),[3,6];case 5:b=null,M.label=6;case 6:if(null==(h=b)||h(e.mentionsPicker,t,u),!Object(ke.a)(e.smimeViewState))return[3,11];M.label=7;case 7:return M.trys.push([7,9,,10]),_=function(e,t,n){var o,u=e.smimeViewState||Object(s.a)(),l=e.attachmentWell,d=l.docViewAttachments,f=l.inlineAttachments,p=Object(c.a)(u);return(o=d.slice(0)).push.apply(o,Object(r.__spread)(f)),{smimeViewState:u,message:t,fromAddress:Object(i.a)(),isSend:n,composeId:e.composeId,toRecipients:p?Object(a.a)(e.toRecipientWell):[],ccRecipients:p?Object(a.a)(e.ccRecipientWell):[],attachments:o}}(e,u,t),[4,Ue.p.import().then((function(e){return e(_)}))];case 8:return M.sent(),[3,10];case 9:return S=M.sent(),(w=new Error).message=S.message==je.a?je.a:"SmimeEncodeError",[2,Promise.reject(w)];case 10:return[3,12];case 11:e.itemId&&(C=Object(_e.b)().items.get(e.itemId.Id))&&Object(Ne.b)(C.ItemClass)&&(u.ItemClass=He),M.label=12;case 12:return t&&function(e){var t=[];if(e.isReportedFalsePositive){var n={ExtendedFieldURI:{PropertyName:Oe,PropertyType:"String",DistinguishedPropertySetId:Se},Value:""};t.push(n)}if(e.isOverridden){n={ExtendedFieldURI:{PropertyName:Ce,PropertyType:"String",DistinguishedPropertySetId:Se},Value:e.overrideJustification};t.push(n)}return t}(e.policyTipsViewState).map((function(e){return function(e,t){null==e.ExtendedProperty?e.ExtendedProperty=[t]:e.ExtendedProperty.push(t)}(u,e)})),[4,qe(e,u,d,t)];case 13:l=M.sent(),M.label=14;case 14:return P(e.addin),(T=(null===(o=null==l?void 0:l.ResponseMessages)||void 0===o?void 0:o.Items)?l.ResponseMessages.Items[0]:l&&!l.ResponseMessages?l:null)&&"Success"==T.ResponseClass?[2,Promise.resolve(T)]:(Object(E.d)(l,e),w=void 0,T?(w=new Error(T.ResponseCode)).messageText=T.MessageText:w=new Error("Unrecognized response"),[2,Promise.reject(w)])}}))}))}function qe(e,t,n,o){var i,a;return Object(r.__awaiter)(this,void 0,void 0,(function(){var s,c,u,l,d,f;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(x.a)(e)?o&&3!=e.operation?Object(Re.a)()||e.itemId||t.RightsManagementLicenseData||(null===(i=e.protectionViewState)||void 0===i?void 0:i.IRMData)?[4,ce(e.groupId,t,e.bodyType,n,Ie(e.protectionViewState),e.isInlineCompose)]:[3,2]:[3,4]:[3,6];case 1:return[2,r.sent()];case 2:return s=Object(U.m)(e.groupId),[4,(p=e.groupId,m=t,e.bodyType,g=s.requestOptions,h=e.isInlineCompose,v=le(p,m,0,0,h),ue({Header:Object(ie.a)(),Body:v},g).then((function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))})))];case 3:return[2,r.sent()];case 4:return c=1==e.operation||2==e.operation,!e.itemId&&c||e.useSmartResponse?[4,Object($.a)(e.groupId,t,e.bodyType,!1,n,e.isInlineCompose)]:[3,6];case 5:return[2,r.sent()];case 6:return u=Object(Q.c)(),l=!(!u||u.treeType!==L.j&&u.treeType!==L.c),o&&(d=Object(B.a)(null===(a=e.attachmentWell)||void 0===a?void 0:a.sharingLinkIds))&&d.length>0&&(t.DocLinks=d),!e.useSmartResponse&&e.itemId?[3,8]:[4,Object(Y.a)(t,e.bodyType,o,n,e.isInlineCompose,Ie(e.protectionViewState),null,l)];case 7:return f=r.sent(),[3,10];case 8:return[4,ye(t,o,Ie(e.protectionViewState),e.addin.keysOfInternetHeadersToBeRemoved)];case 9:f=r.sent(),r.label=10;case 10:return[2,f]}var p,m,g,h,v}))}))}function Ke(e){return Ge(e,!0)}function Xe(e){return Ge(e,!1)}function Je(e,t){if(Object(be.a)(e)){var n=function(e){var t;if(null==e?void 0:e.Items)return e.Items[0];if(null===(t=e)||void 0===t?void 0:t.Item)return e.Item;return null}(e);return n&&(Object(ke.a)(t.smimeViewState)||D.h.import().then((function(e){var r=e(t.attachmentWell,t.content,t.bodyType,!0);r.length&&Ue.r.import().then((function(e){return e(r,n.Attachments,Object(w.a)({Id:t.composeId}))}))})),n.ItemId&&(j(t,n.ItemId.Id,n.ItemId.ChangeKey,n.LastModifiedTime),n.Body&&Object(x.a)(t)&&(t.lastSavedMessageBody=n.Body.Value)),n.InternetMessageId&&Object(k.a)(t.conversationId,t.itemId?t.itemId.Id:null,n.InternetMessageId)),!0}return!1}function Qe(e){return e.textDirection||(Object(g.a)().SessionSettings.IsUserCultureRightToLeft?"rtl":"ltr")}},6506:function(e,t,n){"use strict";var r=n(0),o=n(4701);var i=n(484),a=n(964),s=n(25);function c(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"CreateResponseFromModernGroupJsonRequest:#Exchange"},n)),Object(s.a)("CreateResponseFromModernGroup",e,t)}var u=n(246),l=n(1653);function d(e,t,n,s,c,u){var d,f=(d=Object(r.__assign)({ClientSupportsIrm:!0,ComposeOperation:"newPost",MessageDisposition:s?"SendAndSaveCopy":"SaveOnly",Items:[t],TimeFormat:c,ItemShape:Object(i.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(a.a)({FieldURI:"ItemLastModifiedTime"})]})},Object(l.a)()),Object(r.__assign)({__type:"CreateResponseFromModernGroupRequest:#Exchange"},d));return s?u&&(f.ItemShape.ReturnOnlyInternetMessageId=!0):(f.ItemShape=Object(o.a)(n),f.ShapeName="MailCompose"),f.GroupSmtpAddress=e,f}function f(e,t,n,r,o,i){var a=d(e,t,n,r,o,i);return c({Header:Object(u.a)(),Body:a}).then((function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))}))}n.d(t,"a",(function(){return f}))},665:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return c}));var r=n(0),o=n(114),i=n(483),a={width:1095,height:640};function s(e,t,n,i){if(e){var a=Object(o.e)();c(Object(r.__assign)({ItemId:Object(r.__assign)({mailboxInfo:a},e)},t),n,!!t,i||0)}}function c(e,t,n,r,o,s){Object(i.c)("calendar","compose",{event:e,composeEntrySource:t,shouldDuplicate:o,eventScope:s,eventHasUpdates:n},a)}},6707:function(e,t,n){"use strict";var r=n(0),o=n(42),i=n(6708),a=n(9),s=n(1),c=n(1818),u=n(579),l=n(724),d=n(8470);function f(){c.a.sendFeedback()}t.a=Object(o.a)((function(e,t){var n=Object(r.__read)(s.useState(!0),2),o=n[0],c=n[1];return s.useImperativeHandle(t,(function(){return{setPanelOpen:function(){c(!0)}}}),[]),s.createElement(l.a,{isOpen:o,onDismiss:function(){return c(!1)}},s.createElement("div",{className:d.container},s.createElement(u.a,{className:d.closeButton,onClick:function(){c(!1)},iconProps:{iconName:"Cancel"}}),s.createElement("iframe",{src:e.storeUrl,title:"",className:d.inClientStoreIFrameCenter,frameBorder:0})),s.createElement("div",{className:d.FeedbackCommandBarCenter},s.createElement("div",{onClick:f},Object(a.b)(i.a))))}),{forwardRef:!0})},6708:function(e){e.exports=JSON.parse('{"a":"oka"}')},6762:function(e){e.exports=JSON.parse('{"a":"f9b"}')},6763:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3154),o=n(1271);function i(e,t){return o.c.import().then((function(n){n(e,(function(e,n){return e.focus(),e.addUndoSnapshot((function(){e.insertContent(t,{position:0,updateCursor:!1,replaceSelection:!1,insertOnNewLine:!1})}),r.a),n}),(function(e,n,r){return{value:t+e,selectionStart:n,selectionEnd:r,focus:!0}}))}))}},6764:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3154),o=n(1271);function i(e,t){return o.c.import().then((function(n){n(e,(function(e,n){var o=n?3:1;return e.addUndoSnapshot((function(){e.insertContent(t,{position:o,updateCursor:!0,replaceSelection:!0,insertOnNewLine:!1})}),r.a),n}),(function(e,n,r){return{value:e.substring(0,n)+t+e.substring(r+1),selectionStart:n,selectionEnd:r,focus:!0}}))}))}},6765:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3922),o=n(3154),i=n(1271);function a(e,t){return i.c.import().then((function(n){n(e,(function(e,n,i){if(e.getContent(!1)==t)return null;var a=Object(r.a)(t,e.getDocument(),i);return e.addUndoSnapshot((function(){e.setContent("",!1),e.insertNode(a,{position:0,updateCursor:!0,replaceSelection:!1,insertOnNewLine:!1})}),o.a),a?i.createRange(a,-3):null}),(function(e,n,r){return{value:t,selectionStart:0,selectionEnd:0}}))}))}},699:function(e,t,n){"use strict";n.r(t);var r=n(241),o=n(383);function i(e){Object(o.d)(new r.Cache),Object(o.b)(e.location.origin)}var a=n(0),s=n(58),c=n(107),u=n(340),l=n(123),d="OWA_GetDelegationAccessToken",f={};function p(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(a.__generator)(this,(function(r){switch(r.label){case 0:t=encodeURIComponent(e.client_id+e.scope+e.requestId),n={},r.label=1;case 1:return r.trys.push([1,3,4,5]),[4,m(e,window,t)];case 2:return n=r.sent(),[3,5];case 3:return r.sent(),n.TokenResultCode=2,[3,5];case 4:return function(e,t){var n=t.document.getElementById(e);null!=n&&(n.removeEventListener("load",f[e]),t.document.body.removeChild(n),delete f[e])}(t,window),[7];case 5:return[2,n]}}))}))}function m(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,(function(){var r,o;return Object(a.__generator)(this,(function(i){return r=function(e){var t={response_type:"token",prompt:"none",redirect_uri:e.redirect_uri,scope:e.scope,client_id:e.client_id};return e.authorization_uri+"?"+s.stringify(t)}(e),t.document.getElementById(n)?[2,{TokenResultCode:2}]:((o=t.document.createElement("iframe")).src=r.toString(),o.style.display="none",o.id=n,t.document.body.appendChild(o),[2,new Promise((function(r,i){f[n]=function(n){var a={};try{o.contentWindow&&o.contentWindow.location.host==t.location.host&&(a=function(e,t){var n=s.parse(e),r={};n.access_token?(r.AccessToken=n.access_token,r.AccessTokenExpiry=Object(u.a)(Date.now(),parseInt(n.expires_in)).toISOString(),r.TokenResultCode=0):"login_required"==n.error||"interaction_required"==n.error||"consent_required"==n.error?(r.TokenResultCode=3,Object(l.h)(d+" MSA Failure Unauthorized",{error:n.error,param:e,requestId:t})):(r.TokenResultCode=2,Object(l.h)(d+" MSA Failure",{error:n.error,param:e,requestId:t}));return r}(o.contentWindow.location.hash.substring(1),e.requestId))}catch(t){Object(l.h)(d+" Hash Param Parsing Failure ",{err:t.toString(),message:t.message,stk:t.stack||"",scope:e.scope,uri:e.redirect_uri,requestId:e.requestId}),a.TokenResultCode=2,i(a)}r(a)},o.addEventListener("load",f[n],!1)}))])}))}))}var g,h=n(76),v=n(338),y=n(482),b=3,_=1500;function S(e){var t=this,n=null,r=null,o=new Promise((function(e,o){return Object(a.__awaiter)(t,void 0,void 0,(function(){return Object(a.__generator)(this,(function(t){return n=e,r=o,[2]}))}))})),i={onFulfilled:n,onRejected:r,options:e};return(null==g&&(g=new y.a(b,C,_)),g).add(i),o}function C(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(t){return p(e.options).then((function(t){e.onFulfilled(t)})).catch((function(t){e.onRejected(t)})),[2]}))}))}var O=n(98),A=n(428),I=null,x="OWA_GetDelegationAccessToken",E="https://login.live.com/oauth20_authorize.srf",T="/owa/auth/dt.aspx",P="292841";function w(e,t){return Object(a.__awaiter)(this,void 0,void 0,(function(){var n,r,o,i,u;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:n={scope:e,client_id:"",authorization_uri:"",redirect_uri:"",requestId:t||Object(A.a)()},r=void 0,o=void 0,a.label=1;case 1:return a.trys.push([1,7,,8]),Object(h.h)("auth-disableGetAuthenticationCall")?[4,M(k(n))]:[3,3];case 2:return r=a.sent(),[3,6];case 3:return[4,Object(c.a)()];case 4:return 0!=(o=a.sent()).ResultCode||null==o.ImplicitGrantAuthorizationUrl||""==o.ImplicitGrantAuthorizationUrl?(Object(l.h)(x+" ImplicitGrantAuthorizationUrl is empty or null ",{scope:e,correlationId:n.requestId}),[2,r]):(i=s.parse(o.ImplicitGrantAuthorizationUrl.split("?")[1]||"")).client_id&&i.redirect_uri?(n.client_id=i.client_id,n.authorization_uri=o.ImplicitGrantAuthorizationUrl.split("?")[0],n.redirect_uri=i.redirect_uri,[4,M(n)]):[3,6];case 5:r=a.sent(),a.label=6;case 6:return[2,r];case 7:return u=a.sent(),Object(l.h)(x+" GetDelegationToken Operation failed ",{err:u.toString(),message:u.message,stk:u.stack||"",scope:e,requestId:n.requestId}),[2,r];case 8:return[2]}}))}))}function M(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n,r,o;return Object(a.__generator)(this,(function(i){switch(i.label){case 0:return t=e.client_id+e.scope,(null==(n=function(e,t){var n=e.get(t),r=void 0;if(null==n?void 0:n.AccessTokenExpiry){new Date(n.AccessTokenExpiry)>new Date(Date.now())&&(r=n)}return r}(j(),t))?void 0:n.AccessToken)?[2,n.AccessToken]:[3,1];case 1:return Object(h.h)("auth-getDelegationTokenQueueEnabled")?(r=Object(v.a)(t),o=void 0,r?o=r:(o=S(e),Object(v.b)(t,o)),[2,o.then((function(e){return R(t,e),Object(v.c)(t),e.AccessToken})).catch((function(n){Object(v.c)(t),Object(l.h)(x,{category:"Promise_For_Token_Request_Failed",err:n?n.toString():"",message:n?n.message:"",scope:e.scope,requestId:e.requestId})}))]):[3,2];case 2:return[4,p(e)];case 3:return n=i.sent(),R(t,n),[2,0==n.TokenResultCode?n.AccessToken:void 0]}}))}))}function R(e,t){if(t&&0==t.TokenResultCode&&t.AccessTokenExpiry){var n=new Date(t.AccessTokenExpiry).getTime()-Date.now();n>0&&j().put(e,t,n)}}function j(){return null==I&&(I=new r.Cache),I}function k(e){return e.redirect_uri=Object(O.a)()+T,e.authorization_uri=E,e.client_id=P,e}var N=n(5),D=n(440);var F=!1;function L(){var e;F||(e=Object(D.a)("/owa"),Object(N.b)({baseUrl:e}),F=!0)}var U={NoUserLogin:"AADSTS50058",InvalidResourceUrl:"AADSTS50001",NoPreAuth:"AADSTS65001",UserAborted:"AADSTS65004",NotConsent:"AADSTS70011"};function B(e,t,n,r,o){n?e.acquireTokenPopup(t,null,n,o):e.acquireToken(t,(function(n,i){n&&n.indexOf(U.NoPreAuth)>=0&&r?e.acquireTokenPopup(t,null,null,o):o(n,i)}))}var H=n(108),W=new H.c((function(){return Promise.all([n.e(683),n.e(115)]).then(n.bind(null,15326))})),V=new H.a(W,(function(e){return e.createAdalAuthenticationContext}));var z=function(e,t,n,r,o){return function(i,a){i||!a?o(i,null):(e.getCachedUser(),B(e,t,n,r,o))}},G="adalIdTokenFrame";function q(e,t,n,r,o){e.config.displayCall=function(i){!function(e){if(-1==e.indexOf("?"))throw new Error("Invalid Url in Adal Auth Context Display Call")}(i),window.detectUserCachedCallback=z(e,t,n,r,o),function(e,t){e._addAdalFrame(G).src="about:blank",e._loadFrame(t+"&prompt=none",G)}(e,i)},e.login()}var K=n(27);function X(e,t,n,r,o,i){var s,c;return Object(a.__awaiter)(this,void 0,void 0,(function(){var u,l,d,f;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return"https://login.microsoftonline.com/",[4,V.importAndExecute("https://login.microsoftonline.com/",e,t)];case 1:return u=a.sent(),l=Object(K.a)(),d=null===(s=l.SessionSettings)||void 0===s?void 0:s.UserPrincipalName,f=null===(c=l.SessionSettings)||void 0===c?void 0:c.UserEmailAddress,u._user={profile:{upn:d||f}},u.getCachedUser()?B(u,n,r,o,i):q(u,n,r,o,i),[2]}}))}))}var J=n(71);n.d(t,"registerTokenProvider",(function(){return i})),n.d(t,"getAccessTokenforResource",(function(){return o.b})),n.d(t,"getAccessTokenforResourceAsLazy",(function(){return o.c})),n.d(t,"getDelegationToken",(function(){return M})),n.d(t,"getDelegationTokenForOwa",(function(){return w})),n.d(t,"bootstrap",(function(){return L})),n.d(t,"getAccessTokenOnBehalfOfResource",(function(){return X})),n.d(t,"AdalErrorCode",(function(){return U})),n.d(t,"setUserTokenCallback",(function(){return J.b}))},704:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),o=n(249),i=n(267),a=n(171),s=function(){function e(){this.keytips={},this.persistedKeytips={},this.sequenceMapping={},this.inKeytipMode=!1,this.shouldEnterKeytipMode=!0,this.delayUpdatingKeytipChange=!1}return e.getInstance=function(){return this._instance},e.prototype.init=function(e){this.delayUpdatingKeytipChange=e},e.prototype.register=function(e,t){void 0===t&&(t=!1);var n=e;t||(n=this.addParentOverflow(e),this.sequenceMapping[n.keySequences.toString()]=n);var r=this._getUniqueKtp(n);if(t?this.persistedKeytips[r.uniqueID]=r:this.keytips[r.uniqueID]=r,this.inKeytipMode||!this.delayUpdatingKeytipChange){var i=t?a.g.PERSISTED_KEYTIP_ADDED:a.g.KEYTIP_ADDED;o.a.raise(this,i,{keytip:n,uniqueID:r.uniqueID})}return r.uniqueID},e.prototype.update=function(e,t){var n=this.addParentOverflow(e),r=this._getUniqueKtp(n,t),i=this.keytips[t];i&&(r.keytip.visible=i.keytip.visible,this.keytips[t]=r,delete this.sequenceMapping[i.keytip.keySequences.toString()],this.sequenceMapping[r.keytip.keySequences.toString()]=r.keytip,!this.inKeytipMode&&this.delayUpdatingKeytipChange||o.a.raise(this,a.g.KEYTIP_UPDATED,{keytip:r.keytip,uniqueID:r.uniqueID}))},e.prototype.unregister=function(e,t,n){void 0===n&&(n=!1),n?delete this.persistedKeytips[t]:delete this.keytips[t],!n&&delete this.sequenceMapping[e.keySequences.toString()];var r=n?a.g.PERSISTED_KEYTIP_REMOVED:a.g.KEYTIP_REMOVED;!this.inKeytipMode&&this.delayUpdatingKeytipChange||o.a.raise(this,r,{keytip:e,uniqueID:t})},e.prototype.enterKeytipMode=function(){o.a.raise(this,a.g.ENTER_KEYTIP_MODE)},e.prototype.exitKeytipMode=function(){o.a.raise(this,a.g.EXIT_KEYTIP_MODE)},e.prototype.getKeytips=function(){var e=this;return Object.keys(this.keytips).map((function(t){return e.keytips[t].keytip}))},e.prototype.addParentOverflow=function(e){var t=Object(r.__spreadArrays)(e.keySequences);if(t.pop(),0!==t.length){var n=this.sequenceMapping[t.toString()];if(n&&n.overflowSetSequence)return Object(r.__assign)(Object(r.__assign)({},e),{overflowSetSequence:n.overflowSetSequence})}return e},e.prototype.menuExecute=function(e,t){o.a.raise(this,a.g.PERSISTED_KEYTIP_EXECUTE,{overflowButtonSequences:e,keytipSequences:t})},e.prototype._getUniqueKtp=function(e,t){return void 0===t&&(t=Object(i.a)()),{keytip:Object(r.__assign)({},e),uniqueID:t}},e._instance=new e,e}()},707:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(0),o=n(1),i=n(78),a=n(252),s=n(312),c=n(163),u=n(356),l=n(104),d=n(83),f=n(106),p=function(e){function t(t){var n=e.call(this,t)||this;return n._root=o.createRef(),n._disposables=[],n._onKeyDown=function(e){switch(e.which){case i.a.escape:n.props.onDismiss&&(n.props.onDismiss(e),e.preventDefault(),e.stopPropagation())}},n._onFocus=function(){n._containsFocus=!0},n._onBlur=function(e){n._root.current&&e.relatedTarget&&!Object(a.a)(n._root.current,e.relatedTarget)&&(n._containsFocus=!1)},n._async=new s.a(n),n.state={needsVerticalScrollBar:!1},n}return Object(r.__extends)(t,e),t.prototype.UNSAFE_componentWillMount=function(){this._originalFocusedElement=Object(c.a)().activeElement},t.prototype.componentDidMount=function(){if(this._root.current){this._disposables.push(Object(u.a)(this._root.current,"focus",this._onFocus,!0),Object(u.a)(this._root.current,"blur",this._onBlur,!0));var e=Object(l.a)(this._root.current);e&&this._disposables.push(Object(u.a)(e,"keydown",this._onKeyDown)),Object(d.a)(this._root.current)&&(this._containsFocus=!0)}this._updateScrollBarAsync()},t.prototype.componentDidUpdate=function(){this._updateScrollBarAsync(),this._async.dispose()},t.prototype.componentWillUnmount=function(){if(this._disposables.forEach((function(e){return e()})),this.props.shouldRestoreFocus){var e=this.props.onRestoreFocus;(void 0===e?m:e)({originalElement:this._originalFocusedElement,containsFocus:this._containsFocus})}delete this._originalFocusedElement},t.prototype.render=function(){var e=this.props,t=e.role,n=e.className,i=e.ariaLabel,a=e.ariaLabelledBy,s=e.ariaDescribedBy,c=e.style;return o.createElement("div",Object(r.__assign)({ref:this._root},Object(f.j)(this.props,f.h),{className:n,role:t,"aria-label":i,"aria-labelledby":a,"aria-describedby":s,onKeyDown:this._onKeyDown,style:Object(r.__assign)({overflowY:this.state.needsVerticalScrollBar?"scroll":void 0,outline:"none"},c)}),this.props.children)},t.prototype._updateScrollBarAsync=function(){var e=this;this._async.requestAnimationFrame((function(){e._getScrollBar()}))},t.prototype._getScrollBar=function(){if(!this.props.style||!this.props.style.overflowY){var e=!1;if(this._root&&this._root.current&&this._root.current.firstElementChild){var t=this._root.current.clientHeight,n=this._root.current.firstElementChild.clientHeight;t>0&&n>t&&(e=n-t>1)}this.state.needsVerticalScrollBar!==e&&this.setState({needsVerticalScrollBar:e})}},t.defaultProps={shouldRestoreFocus:!0},t}(o.Component);function m(e){var t=e.originalElement,n=e.containsFocus;t&&n&&t!==window&&t.focus&&t.focus()}},708:function(e,t,n){"use strict";n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l}));var r=n(0),o=n(171),i=n(512);function a(e){return e.reduce((function(e,t){return e+o.f+t.split("").join(o.f)}),o.e)}function s(e,t){var n=t.length,o=Object(r.__spreadArrays)(t).pop(),a=Object(r.__spreadArrays)(e);return Object(i.a)(a,n-1,o)}function c(e){return"["+o.b+'="'+a(e)+'"]'}function u(e){return"["+o.a+'="'+e+'"]'}function l(e){var t=" "+o.d;return e.length?t+" "+a(e):t}},709:function(e,t,n){"use strict";var r=n(378),o=n(437),i=n(14),a={root:"ms-Layer",rootNoHost:"ms-Layer--fixed",content:"ms-Layer-content"};n.d(t,"a",(function(){return s}));var s=Object(r.a)(o.a,(function(e){var t=e.className,n=e.isNotHost,r=e.theme,o=Object(i.getGlobalClassNames)(a,r);return{root:[o.root,r.fonts.medium,n&&[o.rootNoHost,{position:"fixed",zIndex:i.ZIndexes.Layer,top:0,left:0,bottom:0,right:0,visibility:"hidden"}],t],content:[o.content,{visibility:"visible"}]}}),void 0,{scope:"Layer",fields:["hostId","theme","styles"]})},714:function(e,t,n){"use strict";function r(e){return e.clientWidth<e.scrollWidth}function o(e){return e.clientHeight<e.scrollHeight}function i(e){return r(e)||o(e)}n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return i}))},715:function(e,t,n){var r=n(716),o=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},716:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,"._3k2DZQclSrOtYR-5XBK9RP{width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}",""]),t.locals={view:"_3k2DZQclSrOtYR-5XBK9RP"}},718:function(e,t,n){var r=n(719),o=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},719:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,"._2xN9TZyXtoJZK5Lfq0Po_e,._3Syrcsld5EhJ0NsexwVKCW{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;height:18px;max-width:120px;white-space:nowrap;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto}html[dir] ._2xN9TZyXtoJZK5Lfq0Po_e,html[dir] ._3Syrcsld5EhJ0NsexwVKCW{border-radius:2px;border-style:solid;border-width:1px}html[dir=ltr] ._2xN9TZyXtoJZK5Lfq0Po_e{margin-right:4px}html[dir=rtl] ._2xN9TZyXtoJZK5Lfq0Po_e{margin-left:4px}html[dir=ltr] ._3Syrcsld5EhJ0NsexwVKCW{margin-right:0}html[dir=rtl] ._3Syrcsld5EhJ0NsexwVKCW{margin-left:0}.GW-PnOYWKlba0TwtiRFoK{font-size:12px;font-weight:400;max-width:120px;overflow:hidden;text-overflow:ellipsis}html[dir] .GW-PnOYWKlba0TwtiRFoK{padding-bottom:2px}html[dir=ltr] .GW-PnOYWKlba0TwtiRFoK,html[dir=rtl] .GW-PnOYWKlba0TwtiRFoK{padding-right:4px;padding-left:4px}",""]),t.locals={categoryContainer:"_2xN9TZyXtoJZK5Lfq0Po_e",lastCategoryContainer:"_3Syrcsld5EhJ0NsexwVKCW",categoryName:"GW-PnOYWKlba0TwtiRFoK"}},720:function(e,t,n){var r=n(721),o=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},721:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,"._2vy8bJGTwEqZL1fhtL8s3m{max-height:436px}",""]),t.locals={categoryMenu:"_2vy8bJGTwEqZL1fhtL8s3m"}},722:function(e,t,n){var r=n(723),o=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},7224:function(e){e.exports=JSON.parse('{"a":"Ohb","b":"Phb"}')},723:function(e,t,n){(e.exports=n(115)(!1)).push([e.i,"",""])},724:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(378),o=n(582),i=n(485),a=Object(r.a)(o.a,i.b,void 0,{scope:"Modal",fields:["theme","styles","enableAriaHiddenSiblings"]})},7590:function(e,t,n){"use strict";n(2425);var r=n(2702),o=n(3074),i=n(0);function a(e){return Object(i.__assign)({__type:"InstallExtensionJsonRequest:#Exchange"},e)}var s=n(25);function c(e,t){return void 0===e||e.__type||(e=a(e)),Object(s.a)("InstallExtension",e,t)}var u=n(2),l=n(420);function d(e){e.registerMethod("InstallOutlookWebExt",(function(e,t){(function(e){var t={__type:"InstallAppRequest:#Exchange",MarketplaceAssetId:e[1],MarketplaceContentMarket:e[0],Client:"WAC_Outlook",ClientVersion:Object(u.j)(),SendWelcomeEmail:!0,ManifestUrl:null,Manifest:null},n=a({Header:Object(l.b)(o.f()),Body:t}),i=Object(r.b)();return c(n,i)})(e).then((function(n){if("Error"==n.Body.ResponseClass.toString())t([n.Body.MessageText.toString(),n.Body.ResponseCode.toString()],-1);else{var r=n.Body.Extension?n.Body.Extension.MarketplaceAssetID:e[1],i=!!n.Body.WasFirstInstall;t([r,i],0),o.g()}}))}),Microsoft.Office.Common.InvokeType.async,!1)}var f=n(27),p=n(295),m=n(1013);function g(e){return Object(i.__assign)({__type:"DisableExtensionJsonRequest:#Exchange"},e)}function h(e){e.registerMethod("DisableOutlookWebExt",(function(e,t){(function(e){var t={__type:"DisableAppRequest:#Exchange",ID:e.toString(),DisableReason:"NoReason"},n=g({Header:Object(l.b)(o.f()),Body:t}),i=Object(r.b)();return a=n,c=i,void 0===a||a.__type||(a=g(a)),Object(s.a)("DisableExtension",a,c);var a,c})(e).then((function(n){"Error"==n.Body.ResponseClass.toString()?t([n.Body.MessageText.toString(),n.Body.ResponseCode.toString()],-1):t([e.toString()],0),o.g()}))}),Microsoft.Office.Common.InvokeType.async,!1)}function v(e){return Object(i.__assign)({__type:"UninstallExtensionJsonRequest:#Exchange"},e)}function y(e){e.registerMethod("UninstallOutlookWebExt",(function(e,t){(function(e){var t={__type:"UninstallAppRequest:#Exchange",ID:e.toString()},n=v({Header:Object(l.b)(o.f()),Body:t}),i=Object(r.b)();return a=n,c=i,void 0===a||a.__type||(a=v(a)),Object(s.a)("UninstallExtension",a,c);var a,c})(e).then((function(n){"Error"==n.Body.ResponseClass.toString()?t([n.Body.MessageText.toString(),n.Body.ResponseCode.toString()],-1):(t([e.toString()],0),o.g())}))}),Microsoft.Office.Common.InvokeType.async,!1)}function b(e){e.registerMethod("InstallOutlookWebExtByManifest",(function(e,t){(function(e){var t={__type:"InstallAppRequest:#Exchange",MarketplaceAssetId:null,MarketplaceContentMarket:null,Client:"WAC_Outlook",ClientVersion:Object(u.j)(),SendWelcomeEmail:!0,ManifestUrl:null,Manifest:e[0],Id:null};t.Manifest=o.b(t.Manifest);var n=a({Header:Object(l.b)(o.f()),Body:t}),i=Object(r.b)();return c(n,i)})(e).then((function(e){"Error"==e.Body.ResponseClass.toString()?t([e.Body.MessageText.toString(),e.Body.ResponseCode.toString()],-1):(t([!!e.Body.WasFirstInstall,e.Body.Extension?e.Body.Extension.Id:null,e.Body.Extension?e.Body.Extension.Enabled.toString():"false",e.Body.Extension?e.Body.Extension.ConsentState.toString():null,e.Body.Extension?e.Body.Extension.TypeString.toString():null,e.Body.Extension?e.Body.Extension.LicenseStatus.toString():null,e.Body.Extension?e.Body.Extension.TrialExpirationDate:null,e.Body.Extension?e.Body.Extension.Description:null,e.Body.Extension?e.Body.Extension.ProviderName:null,e.Body.Extension?e.Body.Extension.IconUrl:null,e.Body.Extension?e.Body.Extension.HighResolutionIconUrl:null,e.Body.Extension?e.Body.Extension.DisplayName:null,e.Body.Extension?e.Body.Extension.Requirements.toString():null,e.Body.Extension?e.Body.Extension.Version:null],0),o.g())}))}),Microsoft.Office.Common.InvokeType.async,!1)}function _(e){e.registerMethod("InstallOutlookWebExtByManifestUrl",(function(e,t){(function(e){var t={__type:"InstallAppRequest:#Exchange",MarketplaceAssetId:null,MarketplaceContentMarket:null,Client:"WAC_Outlook",ClientVersion:Object(u.j)(),SendWelcomeEmail:!0,ManifestUrl:e[0],Manifest:null,Id:null},n=a({Header:Object(l.b)(o.f()),Body:t}),i=Object(r.b)();return c(n,i)})(e).then((function(e){"Error"==e.Body.ResponseClass.toString()?t([e.Body.MessageText.toString(),e.Body.ResponseCode.toString()],-1):(t([!!e.Body.WasFirstInstall,e.Body.Extension?e.Body.Extension.Id:null,!!e.Body.Extension&&e.Body.Extension.Enabled.toString(),e.Body.Extension?e.Body.Extension.ConsentState.toString():null,e.Body.Extension?e.Body.Extension.TypeString.toString():null,e.Body.Extension?e.Body.Extension.LicenseStatus.toString():null,e.Body.Extension?e.Body.Extension.TrialExpirationDate:null,e.Body.Extension?e.Body.Extension.Description:null,e.Body.Extension?e.Body.Extension.ProviderName:null,e.Body.Extension?e.Body.Extension.IconUrl:null,e.Body.Extension?e.Body.Extension.HighResolutionIconUrl:null,e.Body.Extension?e.Body.Extension.DisplayName:null,e.Body.Extension?e.Body.Extension.Requirements.toString():null,e.Body.Extension?e.Body.Extension.Version:null],0),o.g())}))}),Microsoft.Office.Common.InvokeType.async,!1)}function S(e){e.registerMethod("InstallOutlookWebExtByProductId",(function(e,t){(function(e){var t={__type:"InstallAppRequest:#Exchange",MarketplaceAssetId:null,MarketplaceContentMarket:null,Client:"WAC_Outlook",ClientVersion:Object(u.j)(),SendWelcomeEmail:!0,ManifestUrl:null,Manifest:null,Id:e},n=a({Header:Object(l.b)(o.f()),Body:t}),i=Object(r.b)();return c(n,i)})(e).then((function(n){if("Error"==n.Body.ResponseClass.toString())t([n.Body.MessageText.toString(),n.Body.ResponseCode.toString()],-1);else{t([e,!1],0)}o.g()}))}),Microsoft.Office.Common.InvokeType.async,!1)}function C(e){return Object(i.__assign)({__type:"EnableAppDataRequest:#Exchange"},e)}var O=n(5216);function A(e){e.registerMethod("EnableApp",(function(e,t){(function(e){var t={DisplayName:e[0],RawIdentity:e[1]},n=C({Header:Object(l.b)(o.f()),Identity:t}),i=Object(r.b)();return a=n,c=i,void 0===a||a.__type||(a=C(a)),Object(s.a)("EnableApp",a,c);var a,c})(e).then((function(e){t([e.WasSuccessful],0),Object(O.b)().then((function(e){Object(m.U)(e),Object(m.V)(!0)}))})).catch((function(e){e.ErrorMessage?t([e.ErrorMessage],-1):t([],-1)}))}),Microsoft.Office.Common.InvokeType.async,!1)}var I=n(960);function x(e,t){!function(e){e.registerMethod("GetTelemetryInfoFromOutlook",(function(e,t){var n=Object(m.s)(),r=Object(f.a)(),i=!r.SessionSettings.IsSPOnPrem,a=Object(p.a)(),s=i?a?"Consumer":"Business":"OnPremise";t([Object(u.A)(),r.SessionSettings.UserCulture,"16.2130.0.9999",o.c(),s,i,a,n.MarketplaceUrl,r.SessionSettings.ExternalDirectoryUserGuid,r.SessionSettings.OrganizationDomain,o.e(),"other","OWA_REACT",n.GenericInfo],0)}),Microsoft.Office.Common.InvokeType.async,!1)}(e),function(e){e.registerMethod("GetAllInstalledAddIns",(function(e,t){var n=Object(m.s)(),o=[];n.Extensions.forEach((function(e){"Private"!==e.TypeString&&"Default"!==e.TypeString&&o.push([e.Id,e.MarketplaceAssetID,e.Enabled.toString(),Object(r.e)(e.ConsentState),e.TypeString,e.LicenseStatus.toString(),e.TrialExpirationDate,e.IsMandatory.toString(),e.OriginString])})),t(o,0)}),Microsoft.Office.Common.InvokeType.async,!1)}(e),function(e){e.registerMethod("GetAllPrivateAddIns",(function(e,t){var n=Object(m.s)().Extensions,o=[];n.forEach((function(e){"Private"!==e.TypeString&&"Default"!==e.TypeString||o.push([e.Id,e.Enabled.toString(),Object(r.e)(e.ConsentState),e.TypeString.toString(),e.LicenseStatus.toString(),e.TrialExpirationDate,e.Description,e.ProviderName,e.IconUrl,e.HighResolutionIconUrl,e.DisplayName,e.RequestedCapabilities.toString(),e.Version,e.OriginString,e.IsMandatory.toString()])})),t(o,0)}),Microsoft.Office.Common.InvokeType.async,!1)}(e),d(e),h(e),y(e),b(e),_(e),S(e),A(e),function(e){e.registerMethod("LaunchUrl",(function(e){var t=e;return window.open(t),null}),Microsoft.Office.Common.InvokeType.sync,!1)}(e),function(e){e.registerMethod("UpdateAddinPinOptions",(function(e){var t={readMode:e[2],composeMode:e[3],calendarMode:e[4]};I.h.importAndExecute(e[0],e[1],t)}),Microsoft.Office.Common.InvokeType.async,!1)}(e),e.registerConversation(r.d(),t,null,null)}t.a=function(){var e=r.c();return Object(O.a)().then((function(){var t=r.a();return x(e,t),t}))}},7604:function(e,t,n){"use strict";var r=n(0),o=n(1),i=n(42),a=n(8481),s=n(9),c=n(479),u=n.n(c),l=n(4218),d=n(8482),f=n(305),p=n(8483),m=Object(i.a)((function(e){var t=function(e){switch(e){case 1:return{title:Object(s.b)(d.d),description:Object(s.b)(d.e)};case 2:return{title:Object(s.b)(l.d),description:Object(s.b)(l.e)};case 3:return{title:Object(s.b)(d.a),description:Object(s.b)(d.b)};case 4:return{title:Object(s.b)(d.a),description:Object(s.b)(d.c)};default:return{title:null,description:null}}}(e.errorType);return o.createElement("div",{className:p.errorContainer},o.createElement("div",{className:p.errorContent},o.createElement(f.a,{className:p.errorIcon,iconName:"OfficeAddinsLogo"}),o.createElement("span",{className:u()([p.errorTextCommon,p.errorTextTitle])},t.title),o.createElement("span",{className:u()([p.errorTextCommon,p.errorTextDescription])},t.description)))}));var g=n(8485),h=n(389),v=n(105),y=n(358),b=n(5620),_=Object(i.a)((function(e){var t=Object(r.__read)(o.useState(!1),2),n=t[0],i=t[1];return n?o.createElement(f.a,{iconName:"Photo2",iconType:h.a.default,className:u()([b.fallbackIcon,e.className])}):o.createElement(y.a,{onLoadingStateChange:function(e){e==v.c.error?i(!0):i(!1)},src:e.src,width:e.width,height:e.height,imageFit:v.b.contain,className:e.className})})),S=n(579),C=n(5620),O=Object(i.a)((function(e){var t,n=e.isPersisted?"Pinned":"Pin",r=(t=e.isPersisted?Object(s.b)(l.g):Object(s.b)(l.f),Object(s.c)(t,e.displayName));return o.createElement(S.a,{className:C.persistIcon,onClick:e.togglePersist,title:r,ariaLabel:r,iconProps:{iconName:n}})})),A=n(3468),I=n(5620),x=Object(i.a)((function(e,t){var n=o.useRef();o.useImperativeHandle(t,(function(){return{focusCloseButton:function(){n.current&&n.current.focus()}}}),[]);var r=e.isCalendar;return o.createElement("div",{className:u()(I.addinPaneHeader,r&&I.addinPaneHeaderCalendar)},o.createElement(_,{src:e.iconUrl,width:32,height:32,className:I.addinPaneIcon}),o.createElement("div",{className:u()([I.addinPaneLabelText,I.ellipsis])},e.displayName),o.createElement("div",{className:I.rightButtons},Object(A.c)()&&e.isPersistable&&!r&&o.createElement(O,{displayName:e.displayName,isPersisted:e.isPersisted,togglePersist:e.togglePersist}),o.createElement(S.a,{componentRef:function(e){return n.current=e},className:I.closeButton,onClick:e.closeOnClick,ariaLabel:Object(s.b)(g.a),iconProps:{iconName:"Cancel"}})))}),{forwardRef:!0}),E=n(4575),T=n(895),P=n(908),w=n(1565),M=n(8487),R=function(e){return e.renderInPanel?o.createElement(P.a,{focusTrapZoneProps:{forceFocusInsideTrap:!1,disableFirstFocus:e.disableFirstFocus,isClickableOutsideFocusTrap:!0},hasCloseButton:!1,isOpen:!0,onDismiss:e.onDismiss,className:u()(M.taskPane,e.isDeepLink&&M.taskPaneNoHeader,{isShyHeaderMode:Object(w.a)()}),isBlocking:!1,isFooterAtBottom:!0,isLightDismiss:!0},e.children):o.createElement(T.a,{forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,className:M.taskPane},e.children)},j=n(3218),k=n(1097),N=n(556),D=n(4828),F=(n(2425),n(1013)),L=n(3850),U=n(8489),B=Object(i.a)((function(e){var t=o.useRef(),n=function(){t.current&&t.current.focusCloseButton()},r=function(){return e.instance.mode===k.a.AppointmentAttendee||e.instance.mode===k.a.AppointmentOrganizer},i=function(){return"Persistent"===e.type},c=function(){return 0!==e.instance.errorType},l=function(){var t=e.instance,n=t.mode,r=t.controlId;i()&&Object(L.h)(n,null),Object(j.d)(r)},d=e.instance,f=void 0===e.renderInPanel||e.renderInPanel;if(!d)return o.createElement("div",{className:U.divContainer});var p,g=d.addinCommand;return o.createElement(R,{renderInPanel:f,onDismiss:l,isDeepLink:Object(N.v)(),disableFirstFocus:i()},o.createElement(x,{iconUrl:g.extension.IconUrl,displayName:g.extension.DisplayName,closeOnClick:l,ref:t,isCalendar:r(),isPersistable:Object(L.a)(e.instance.addinCommand),isPersisted:i(),togglePersist:function(){var t=i()?null:Object(L.b)(e.instance.addinCommand);Object(L.h)(e.instance.mode,t),Object(F.db)(e.type)}}),o.createElement("div",{tabIndex:0,className:u()(U.extensionContainer,r()&&U.extensionContainerCalendar),"aria-label":Object(s.c)(Object(s.b)(a.a),g.extension.DisplayName),role:"complementary"},(p=e.instance.errorType,c()&&o.createElement(m,{errorType:p})),function(){var t=e.instance,r=t.hostItemIndex,i=t.controlId,a=t.addinCommand,s={};return s[15]=n,s[14]=n,s[13]=n,o.createElement(D.a,{addinCommand:a,controlId:i,className:u()([U.extensionHost,c()&&U.hide]),hostItemIndex:r,manifestCacheProvider:E.a,notifyHostActions:s})}()))})),H=n(2914),W=n(3505),V=n(1416),z="addinTaskPane";var G=n(2),q=n(554),K=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.componentDidUpdate=function(){if("Mail"===Object(G.e)()){var e=Object(F.t)().taskPanes;!this.previousTaskPanesSize&&e.size?(Object(H.a)(z,!0,!1),V.b.importAndExecute(),W.a.importAndExecute()):this.previousTaskPanesSize&&!e.size&&(Object(H.a)(z,!1,!1),V.b.importAndExecute()),this.previousTaskPanesSize=e.size}},t.prototype.renderTaskPane=function(e){var t=Object(F.A)(e);return t&&o.createElement(B,{key:t.controlId,type:e,instance:t,renderInPanel:this.props.renderTaskPaneInPanel})},t.prototype.render=function(){var e=Object(A.c)()&&this.renderTaskPane("Persistent"),t=this.renderTaskPane("NonPersistent");return o.createElement(o.Fragment,null,[e,t])},t=Object(r.__decorate)([q.observer],t)}(o.Component);t.a=K},7621:function(e,t,n){"use strict";var r=n(428),o=n(287),i="/ows/api/beta/PersistedAddins";function a(e,t,n){var a=Object(r.a)();Object(o.c)(i,{Addin:{mode:e,addinId:t,commandId:n}},a)}var s=n(0),c=n(279);function u(){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:return e=Object(r.a)(),[4,Object(o.b)(i,e,!0)];case 1:return t=n.sent(),Object(c.a)(t.status)?[4,t.text()]:[3,3];case 2:return[2,n.sent()];case 3:return[2,"{}"]}}))}))}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return u}))},7642:function(e,t,n){"use strict";var r=n(0),o=n(3040),i=n(1013),a=function(e){Object(i.t)().activeDialog&&Object(i.t)().activeDialog.parentControlId==e&&Object(o.j)({eventDispId:o.a.DISPLAY_DIALOG_DISPID,controlId:e})};function s(e){Object(i.t)().runningUILessExtendedAddinCommands.has(e)&&Object(r.__spread)(Object(i.t)().runningUILessExtendedAddinCommands.get(e).keys()).forEach((function(t,n){!function(e,t,n){a(e),Object(i.cb)(e,t,n)}(t,e,i.d.NavigatedBeforeCompleted)}))}function c(e){s(e),Object(i.g)(e)}n.d(t,"a",(function(){return c}))},7669:function(e,t,n){"use strict";var r;!function(e){e.MailRead="MailRead",e.MailCompose="MailCompose",e.NoEndpoint=""}(r||(r={}));var o=r,i=n(1097);function a(e){switch(e){case i.a.MessageRead:case i.a.MeetingRequest:return o.MailRead;case i.a.MessageCompose:return o.MailCompose;default:return o.NoEndpoint}}n.d(t,"a",(function(){return a}))},7769:function(e,t,n){"use strict";function r(e){var t=e&&e.Action;return t&&!!t.SourceLocation}function o(e){var t=e&&e.Action;return t&&!!t.FunctionName}function i(e){return!!e&&!!e.MenuItems}n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}))},7770:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1013);function o(e,t){var n=Object(r.x)();Object(r.S)(n,e,t)}},7771:function(e,t,n){"use strict";var r=n(1),o=n(389),i=n(305),a=n(105),s=n(8496);t.a=function(e){return{iconType:o.a.Image,imageProps:{src:e,width:16,height:16,imageFit:a.b.contain,shouldFadeIn:!1},styles:{root:{width:"16px !important",height:"16px !important"}},imageErrorAs:function(e){return r.createElement(i.a,{className:s.fallbackIcon,iconName:"Photo2",iconType:o.a.Default})}}}},7772:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n(8498),o=n(9),i=n(6272),a=n(389),s=n(233);function c(){return{key:"AddinMarketplace",name:Object(o.b)(r.a),title:Object(o.b)(r.a),ariaLabel:Object(o.b)(r.a),iconProps:{iconName:"AddIn",iconType:a.a.default},itemType:s.a.Normal,onClick:function(){Object(i.a)()}}}function u(){return{key:"AddinMarketplaceDivider",displayName:"-",itemType:s.a.Divider,iconProps:{iconName:"AddIn",iconType:a.a.default},onClick:null}}},83:function(e,t,n){"use strict";n.d(t,"e",(function(){return f})),n.d(t,"h",(function(){return p})),n.d(t,"f",(function(){return m})),n.d(t,"i",(function(){return g})),n.d(t,"c",(function(){return h})),n.d(t,"k",(function(){return v})),n.d(t,"j",(function(){return y})),n.d(t,"o",(function(){return b})),n.d(t,"n",(function(){return _})),n.d(t,"m",(function(){return S})),n.d(t,"l",(function(){return C})),n.d(t,"a",(function(){return O})),n.d(t,"p",(function(){return A})),n.d(t,"b",(function(){return x})),n.d(t,"g",(function(){return E})),n.d(t,"d",(function(){return T}));var r=n(435),o=n(252),i=n(230),a=n(104),s=n(163),c="data-is-focusable",u="data-is-visible",l="data-focuszone-id",d="data-is-sub-focuszone";function f(e,t,n){return y(e,t,!0,!1,!1,n)}function p(e,t,n){return v(e,t,!0,!1,!0,n)}function m(e,t,n,r){return void 0===r&&(r=!0),y(e,t,r,!1,!1,n,!1,!0)}function g(e,t,n,r){return void 0===r&&(r=!0),v(e,t,r,!1,!0,n,!1,!0)}function h(e){var t=y(e,e,!0,!1,!1,!0);return!!t&&(x(t),!0)}function v(e,t,n,r,o,i,a,s){if(!t||!a&&t===e)return null;var c=b(t);if(o&&c&&(i||!S(t)&&!C(t))){var u=v(e,t.lastElementChild,!0,!0,!0,i,a,s);if(u){if(s&&_(u,!0)||!s)return u;var l=v(e,u.previousElementSibling,!0,!0,!0,i,a,s);if(l)return l;for(var d=u.parentElement;d&&d!==t;){var f=v(e,d.previousElementSibling,!0,!0,!0,i,a,s);if(f)return f;d=d.parentElement}}}if(n&&c&&_(t,s))return t;var p=v(e,t.previousElementSibling,!0,!0,!0,i,a,s);return p||(r?null:v(e,t.parentElement,!0,!1,!1,i,a,s))}function y(e,t,n,r,o,i,a,s){if(!t||t===e&&o&&!a)return null;var c=b(t);if(n&&c&&_(t,s))return t;if(!o&&c&&(i||!S(t)&&!C(t))){var u=y(e,t.firstElementChild,!0,!0,!1,i,a,s);if(u)return u}if(t===e)return null;var l=y(e,t.nextElementSibling,!0,!0,!1,i,a,s);return l||(r?null:y(e,t.parentElement,!1,!1,!0,i,a,s))}function b(e){if(!e||!e.getAttribute)return!1;var t=e.getAttribute(u);return null!=t?"true"===t:0!==e.offsetHeight||null!==e.offsetParent||!0===e.isVisible}function _(e,t){if(!e||e.disabled)return!1;var n=0,r=null;e&&e.getAttribute&&(r=e.getAttribute("tabIndex"))&&(n=parseInt(r,10));var o=e.getAttribute?e.getAttribute(c):null,i=null!==r&&n>=0,a=!!e&&"false"!==o&&("A"===e.tagName||"BUTTON"===e.tagName||"INPUT"===e.tagName||"TEXTAREA"===e.tagName||"SELECT"===e.tagName||"true"===o||i);return t?-1!==n&&a:a}function S(e){return!!(e&&e.getAttribute&&e.getAttribute(l))}function C(e){return!(!e||!e.getAttribute||"true"!==e.getAttribute(d))}function O(e){var t=Object(s.a)(e),n=t&&t.activeElement;return!(!n||!Object(o.a)(e,n))}function A(e,t){return"true"!==Object(r.a)(e,t)}var I=void 0;function x(e){if(e){if(I)return void(I=e);I=e;var t=Object(a.a)(e);t&&t.requestAnimationFrame((function(){I&&I.focus(),I=void 0}))}}function E(e,t){for(var n=e,r=0,o=t;r<o.length;r++){var i=o[r],a=n.children[Math.min(i,n.children.length-1)];if(!a)break;n=a}return n=_(n)&&b(n)?n:y(e,n,!0)||v(e,n)}function T(e,t){for(var n=[];t&&e&&t!==e;){var r=Object(i.a)(t,!0);if(null===r)return[];n.unshift(Array.prototype.indexOf.call(r.children,t)),t=r}return n}},8468:function(e,t){
/*!
    Your use of this file is governed by the Microsoft Services Agreement http://go.microsoft.com/fwlink/?LinkId=266419.

    This file also contains the following Promise implementation (with a few small modifications):
        * @overview es6-promise - a tiny implementation of Promises/A+.
        * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
        * @license   Licensed under MIT license
        *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
        * @version   2.3.0
*/
var n,r;n=l||(l={}),r=function(){var e=!0;function t(){}return t.prototype.isMsAjaxLoaded=function(){var t="function",n="undefined";return!!(typeof Sys!==n&&typeof Type!==n&&Sys.StringBuilder&&typeof Sys.StringBuilder===t&&Type.registerNamespace&&typeof Type.registerNamespace===t&&Type.registerClass&&typeof Type.registerClass===t&&typeof Function._validateParams===t&&Sys.Serialization&&Sys.Serialization.JavaScriptSerializer&&typeof Sys.Serialization.JavaScriptSerializer.serialize===t)&&e},t.prototype.loadMsAjaxFull=function(e){var t=("https:"===window.location.protocol.toLowerCase()?"https:":"http:")+"//ajax.aspnetcdn.com/ajax/3.5/MicrosoftAjax.js";i.OUtil.loadScript(t,e)},Object.defineProperty(t.prototype,"msAjaxError",{get:function(){var e=this;return null==e._msAjaxError&&e.isMsAjaxLoaded()&&(e._msAjaxError=Error),e._msAjaxError},set:function(e){this._msAjaxError=e},enumerable:e,configurable:e}),Object.defineProperty(t.prototype,"msAjaxString",{get:function(){var e=this;return null==e._msAjaxString&&e.isMsAjaxLoaded()&&(e._msAjaxString=String),e._msAjaxString},set:function(e){this._msAjaxString=e},enumerable:e,configurable:e}),Object.defineProperty(t.prototype,"msAjaxDebug",{get:function(){var e=this;return null==e._msAjaxDebug&&e.isMsAjaxLoaded()&&(e._msAjaxDebug=Sys.Debug),e._msAjaxDebug},set:function(e){this._msAjaxDebug=e},enumerable:e,configurable:e}),t}(),n.MicrosoftAjaxFactory=r;var o=new l.MicrosoftAjaxFactory,i=i||{};!function(e){var t=function(){function e(e){this._internalStorage=e}return e.prototype.getItem=function(e){try{return this._internalStorage&&this._internalStorage.getItem(e)}catch(e){return null}},e.prototype.setItem=function(e,t){try{this._internalStorage&&this._internalStorage.setItem(e,t)}catch(e){}},e.prototype.clear=function(){try{this._internalStorage&&this._internalStorage.clear()}catch(e){}},e.prototype.removeItem=function(e){try{this._internalStorage&&this._internalStorage.removeItem(e)}catch(e){}},e.prototype.getKeysWithPrefix=function(e){var t=[];try{for(var n=this._internalStorage&&this._internalStorage.length||0,r=0;r<n;r++){var o=this._internalStorage.key(r);0===o.indexOf(e)&&t.push(o)}}catch(e){}return t},e}();e.SafeStorage=t}(l||(l={})),i.XdmFieldName={ConversationUrl:"ConversationUrl",AppId:"AppId"},i.FlightNames={UseOriginNotUrl:0,CheckReceiverOrigin:1,AddinEnforceHttps:2},i.Flights=[],i.WindowNameItemKeys={BaseFrameName:"baseFrameName",HostInfo:"hostInfo",XdmInfo:"xdmInfo",SerializerVersion:"serializerVersion",AppContext:"appContext",Flights:"flights"},i.OUtil=function(){var e="focus",t="on",n="configurable",r="writable",a="enumerable",s="",c="undefined",u=!1,d=!0,f=2147483647,p=null,m=-1,g=m,h="&_xdm_Info=",v="&_serializer_version=",y="&_flights=",b="_xdm_",_="#",S="class",C={},O=p,A=p,I=(new Date).getTime();function x(){var e=f*Math.random();return(e^=I^(new Date).getMilliseconds()<<Math.floor(21*Math.random())).toString(16)}function E(){if(!O){try{var e=window.sessionStorage}catch(t){e=p}O=new l.SafeStorage(e)}return O}function T(e){for(var t,n=[],r=[],o=e.length,i=0;i<o;i++)(t=e[i]).tabIndex?t.tabIndex>0?r.push(t):0===t.tabIndex&&n.push(t):n.push(t);return r=r.sort((function(e,t){var n=e.tabIndex-t.tabIndex;return 0===n&&(n=r.indexOf(e)-r.indexOf(t)),n})),[].concat(r,n)}return{set_entropy:function(e){if("string"==typeof e)for(var t=0;t<e.length;t+=4){for(var n=0,r=0;r<4&&t+r<e.length;r++)n=(n<<8)+e.charCodeAt(t+r);I^=n}else I^="number"==typeof e?e:f*Math.random();I&=f},extend:function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.uber=t.prototype,t.prototype.constructor===Object.prototype.constructor&&(t.prototype.constructor=t)},setNamespace:function(e,t){t&&e&&!t[e]&&(t[e]={})},unsetNamespace:function(e,t){t&&e&&t[e]&&delete t[e]},serializeSettings:function(e){var t={};for(var n in e){var r=e[n];try{r=JSON?JSON.stringify(r,(function(e,t){return i.OUtil.isDate(this[e])?i.DDA.SettingsManager.DateJSONPrefix+this[e].getTime()+i.DDA.SettingsManager.DataJSONSuffix:t})):Sys.Serialization.JavaScriptSerializer.serialize(r),t[n]=r}catch(e){}}return t},deserializeSettings:function(e){var t={};for(var n in e=e||{}){var r=e[n];try{r=JSON?JSON.parse(r,(function(e,t){var n;return"string"==typeof t&&t&&t.length>6&&t.slice(0,5)===i.DDA.SettingsManager.DateJSONPrefix&&t.slice(m)===i.DDA.SettingsManager.DataJSONSuffix&&(n=new Date(parseInt(t.slice(5,m))))?n:t})):Sys.Serialization.JavaScriptSerializer.deserialize(r,d),t[n]=r}catch(e){}}return t},loadScript:function(e,t,n){if(e&&t){var r=window.document,o=C[e];if(o)o.loaded?t():o.pendingCallbacks.push(t);else{var i=r.createElement("script");i.type="text/javascript",o={loaded:u,pendingCallbacks:[t],timer:p},C[e]=o;var a=function(){o.timer!=p&&(clearTimeout(o.timer),delete o.timer),o.loaded=d;for(var e=o.pendingCallbacks.length,t=0;t<e;t++){o.pendingCallbacks.shift()()}},s=function(){delete C[e],o.timer!=p&&(clearTimeout(o.timer),delete o.timer);for(var t=o.pendingCallbacks.length,n=0;n<t;n++){o.pendingCallbacks.shift()()}};i.readyState?i.onreadystatechange=function(){"loaded"!=i.readyState&&"complete"!=i.readyState||(i.onreadystatechange=p,a())}:i.onload=a,i.onerror=s,n=n||3e4,o.timer=setTimeout(s,n),i.setAttribute("crossOrigin","anonymous"),i.src=e,r.getElementsByTagName("head")[0].appendChild(i)}}},loadCSS:function(e){if(e){var t=window.document,n=t.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=e,t.getElementsByTagName("head")[0].appendChild(n)}},parseEnum:function(e,t){var n=t[e.trim()];if(typeof n==c)throw o.msAjaxDebug.trace("invalid enumeration string:"+e),o.msAjaxError.argument("str");return n},delayExecutionAndCache:function(){var e={calc:arguments[0]};return function(){return e.calc&&(e.val=e.calc.apply(this,arguments),delete e.calc),e.val}},getUniqueId:function(){return(g+=1).toString()},formatString:function(){var e=arguments,t=e[0];return t.replace(/{(\d+)}/gm,(function(t,n){var r=parseInt(n,10)+1;return void 0===e[r]?"{"+n+"}":e[r]}))},generateConversationId:function(){return[x(),x(),(new Date).getTime().toString()].join("_")},getFrameName:function(e){return b+e+this.generateConversationId()},addXdmInfoAsHash:function(e,t){return i.OUtil.addInfoAsHash(e,h,t,u)},addSerializerVersionAsHash:function(e,t){return i.OUtil.addInfoAsHash(e,v,t,d)},addFlightsAsHash:function(e,t){return i.OUtil.addInfoAsHash(e,y,t,d)},addInfoAsHash:function(e,t,n,r){var o,i=(e=e.trim()||s).split(_),a=i.shift(),c=i.join(_);return o=r?[t,encodeURIComponent(n),c].join(s):[c,t,n].join(s),[a,_,o].join(s)},parseHostInfoFromWindowName:function(e,t){return i.OUtil.parseInfoFromWindowName(e,t,i.WindowNameItemKeys.HostInfo)},parseXdmInfo:function(e){var t=i.OUtil.parseXdmInfoWithGivenFragment(e,window.location.hash);return t||(t=i.OUtil.parseXdmInfoFromWindowName(e,window.name)),t},parseXdmInfoFromWindowName:function(e,t){return i.OUtil.parseInfoFromWindowName(e,t,i.WindowNameItemKeys.XdmInfo)},parseXdmInfoWithGivenFragment:function(e,t){return i.OUtil.parseInfoWithGivenFragment(h,b,u,e,t)},parseSerializerVersion:function(e){var t=i.OUtil.parseSerializerVersionWithGivenFragment(e,window.location.hash);return isNaN(t)&&(t=i.OUtil.parseSerializerVersionFromWindowName(e,window.name)),t},parseSerializerVersionFromWindowName:function(e,t){return parseInt(i.OUtil.parseInfoFromWindowName(e,t,i.WindowNameItemKeys.SerializerVersion))},parseSerializerVersionWithGivenFragment:function(e,t){return parseInt(i.OUtil.parseInfoWithGivenFragment(v,"_serializer_version=",d,e,t))},parseFlights:function(e){var t=i.OUtil.parseFlightsWithGivenFragment(e,window.location.hash);return 0==t.length&&(t=i.OUtil.parseFlightsFromWindowName(e,window.name)),t},checkFlight:function(e){return i.Flights&&i.Flights.indexOf(e)>=0},pushFlight:function(e){return i.Flights.indexOf(e)<0?(i.Flights.push(e),d):u},parseFlightsFromWindowName:function(e,t){return i.OUtil.parseArrayWithDefault(i.OUtil.parseInfoFromWindowName(e,t,i.WindowNameItemKeys.Flights))},parseFlightsWithGivenFragment:function(e,t){return i.OUtil.parseArrayWithDefault(i.OUtil.parseInfoWithGivenFragment(y,"_flights=",d,e,t))},parseArrayWithDefault:function(e){var t=[];try{t=JSON.parse(e)}catch(e){}return Array.isArray(t)||(t=[]),t},parseInfoFromWindowName:function(e,t,n){try{var r=JSON.parse(t),o=r!=p?r[n]:p,a=E();if(!e&&a&&r!=p){var s=r[i.WindowNameItemKeys.BaseFrameName]+n;o?a.setItem(s,o):o=a.getItem(s)}return o}catch(e){return p}},parseInfoWithGivenFragment:function(e,t,n,r,o){var i=o.split(e),a=i.length>1?i[i.length-1]:p;n&&a!=p&&(a.indexOf("&")>=0&&(a=a.split("&")[0]),a=decodeURIComponent(a));var s=E();if(!r&&s){var c=window.name.indexOf(t);if(c>m){var u=window.name.indexOf(";",c);u==m&&(u=window.name.length);var l=window.name.substring(c,u);a?s.setItem(l,a):a=s.getItem(l)}}return a},getConversationId:function(){var e=window.location.search,t=p;if(e){var n=e.indexOf("&");(t=n>0?e.substring(1,n):e.substr(1))&&"="===t.charAt(t.length-1)&&(t=t.substring(0,t.length-1))&&(t=decodeURIComponent(t))}return t},getInfoItems:function(e){var t=e.split("$");return typeof t[1]==c&&(t=e.split("|")),typeof t[1]==c&&(t=e.split("%7C")),t},getXdmFieldValue:function(e,t){var n=s,r=i.OUtil.parseXdmInfo(t);if(r){var o=i.OUtil.getInfoItems(r);if(null!=o&&o.length>=3)switch(e){case i.XdmFieldName.ConversationUrl:n=o[2];break;case i.XdmFieldName.AppId:n=o[1]}}return n},validateParamObject:function(e,t){var n=Function._validateParams(arguments,[{name:"params",type:Object,mayBeNull:u},{name:"expectedProperties",type:Object,mayBeNull:u},{name:"callback",type:Function,mayBeNull:d}]);if(n)throw n;for(var r in t)if(n=Function._validateParameter(e[r],t[r],r))throw n},writeProfilerMark:function(e){window.msWriteProfilerMark&&(window.msWriteProfilerMark(e),o.msAjaxDebug.trace(e))},outputDebug:function(e){typeof o!==c&&o.msAjaxDebug&&o.msAjaxDebug.trace&&o.msAjaxDebug.trace(e)},defineNondefaultProperty:function(e,t,n,r){for(var o in n=n||{},r){var i=r[o];null==n[i]&&(n[i]=d)}return Object.defineProperty(e,t,n),e},defineNondefaultProperties:function(e,t,n){for(var r in t=t||{})i.OUtil.defineNondefaultProperty(e,r,t[r],n);return e},defineEnumerableProperty:function(e,t,n){return i.OUtil.defineNondefaultProperty(e,t,n,[a])},defineEnumerableProperties:function(e,t){return i.OUtil.defineNondefaultProperties(e,t,[a])},defineMutableProperty:function(e,t,o){return i.OUtil.defineNondefaultProperty(e,t,o,[r,a,n])},defineMutableProperties:function(e,t){return i.OUtil.defineNondefaultProperties(e,t,[r,a,n])},finalizeProperties:function(e,t){t=t||{};for(var n=Object.getOwnPropertyNames(e),r=n.length,o=0;o<r;o++){var i=n[o],a=Object.getOwnPropertyDescriptor(e,i);a.get||a.set||(a.writable=t.writable||u),a.configurable=t.configurable||u,a.enumerable=t.enumerable||d,Object.defineProperty(e,i,a)}return e},mapList:function(e,t){var n=[];if(e)for(var r in e)n.push(t(e[r]));return n},listContainsKey:function(e,t){for(var n in e)if(t==n)return d;return u},listContainsValue:function(e,t){for(var n in e)if(t==e[n])return d;return u},augmentList:function(e,t){var n=e.push?function(t,n){e.push(n)}:function(t,n){e[t]=n};for(var r in t)n(r,t[r])},redefineList:function(e,t){for(var n in e)delete e[n];for(var r in t)e[r]=t[r]},isArray:function(e){return"[object Array]"===Object.prototype.toString.apply(e)},isFunction:function(e){return"[object Function]"===Object.prototype.toString.apply(e)},isDate:function(e){return"[object Date]"===Object.prototype.toString.apply(e)},addEventListener:function(e,n,r){e.addEventListener?e.addEventListener(n,r,u):Sys.Browser.agent===Sys.Browser.InternetExplorer&&e.attachEvent?e.attachEvent(t+n,r):e[t+n]=r},removeEventListener:function(e,n,r){e.removeEventListener?e.removeEventListener(n,r,u):Sys.Browser.agent===Sys.Browser.InternetExplorer&&e.detachEvent?e.detachEvent(t+n,r):e[t+n]=p},getCookieValue:function(e){return RegExp(e+"[^;]+").exec(document.cookie).toString().replace(/^[^=]+./,s)},xhrGet:function(e,t,n){var r;try{(r=new XMLHttpRequest).onreadystatechange=function(){4==r.readyState&&(200==r.status?t(r.responseText):n(r.status))},r.open("GET",e,d),r.send()}catch(e){n(e)}},xhrGetFull:function(e,t,n,r){var o,i=t;try{(o=new XMLHttpRequest).onreadystatechange=function(){4==o.readyState&&(200==o.status?n(o,i):r(o.status))},o.open("GET",e,d),o.send()}catch(e){r(e)}},encodeBase64:function(e){if(!e)return e;var t,n,r,o,i,a,c,u=[],l=[],d=0,f=e.length;do{t=e.charCodeAt(d++),n=e.charCodeAt(d++),r=e.charCodeAt(d++),c=0,o=255&t,i=t>>8,a=255&n,l[c++]=o>>2,l[c++]=(3&o)<<4|i>>4,l[c++]=(15&i)<<2|a>>6,l[c++]=63&a,isNaN(n)||(o=n>>8,i=255&r,a=r>>8,l[c++]=o>>2,l[c++]=(3&o)<<4|i>>4,l[c++]=(15&i)<<2|a>>6,l[c++]=63&a),isNaN(n)?l[c-1]=64:isNaN(r)&&(l[c-2]=64,l[c-1]=64);for(var p=0;p<c;p++)u.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(l[p]))}while(d<f);return u.join(s)},getSessionStorage:function(){return E()},getLocalStorage:function(){if(!A){try{var e=window.localStorage}catch(t){e=p}A=new l.SafeStorage(e)}return A},convertIntToCssHexColor:function(e){return"#"+(Number(e)+16777216).toString(16).slice(-6)},attachClickHandler:function(e,t){e.onclick=function(){t()},e.ontouchend=function(e){t(),e.preventDefault()}},getQueryStringParamValue:function(e,t){var n=Function._validateParams(arguments,[{name:"queryString",type:String,mayBeNull:u},{name:"paramName",type:String,mayBeNull:u}]);if(n)return o.msAjaxDebug.trace("OSF_Outil_getQueryStringParamValue: Parameters cannot be null."),s;var r=new RegExp("[\\?&]"+t+"=([^&#]*)","i");return r.test(e)?r.exec(e)[1]:(o.msAjaxDebug.trace("OSF_Outil_getQueryStringParamValue: The parameter is not found."),s)},getHostnamePortionForLogging:function(e){var t=Function._validateParams(arguments,[{name:"hostname",type:String,mayBeNull:u}]);if(t){var n=e.split("."),r=n.length;if(r>=2)return n[r-2]+"."+n[r-1];if(1==r)return n[0]}return s},isiOS:function(){return window.navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?d:u},isChrome:function(){return window.navigator.userAgent.indexOf("Chrome")>0&&!i.OUtil.isEdge()},isEdge:function(){return window.navigator.userAgent.indexOf("Edge")>0},isIE:function(){return window.navigator.userAgent.indexOf("Trident")>0},isFirefox:function(){return window.navigator.userAgent.indexOf("Firefox")>0},parseUrl:function(e,t){if(void 0===t&&(t=u),typeof e!==c&&e){var n="NotHttps",r=this.isIE(),o=this.isEdge(),a={protocol:void 0,hostname:void 0,port:void 0};try{if(r)throw"Browser doesn't support new URL library";if(o)throw"Browser has inconsistent URL library";var l=new URL(e);if(l&&(a.protocol=l.protocol,a.hostname=l.hostname,a.port=l.port,i.OUtil.checkFlight(i.FlightNames.AddinEnforceHttps)&&t&&"https:"!=l.protocol))throw new Error(n)}catch(o){if(o.message===n)throw o;var d=document.createElement("a");if(d.href=e,d.pathname!=s&&"/"!=d.pathname||"/"===e.substring(e.length-1,e.length)||(e+="/"),i.OUtil.checkFlight(i.FlightNames.AddinEnforceHttps)&&t&&"https:"!=d.protocol)throw new Error(n);var f=d.protocol+"//"+d.hostname+(r?"/":s)+d.pathname+d.search+d.hash,p=d.protocol+"//"+d.host+(r?"/":s)+d.pathname+d.search+d.hash;e!=f&&e!=p||(a.protocol=d.protocol,a.hostname=d.hostname,a.port=d.port)}return a}},shallowCopy:function(e){if(e==p)return p;if(e instanceof Object){if(Array.isArray(e)){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t}var r=e.constructor();for(var o in e)e.hasOwnProperty(o)&&(r[o]=e[o]);return r}return e},createObject:function(e){var t=p;if(e){t={};for(var n=e.length,r=0;r<n;r++)t[e[r].name]=e[r].value}return t},addClass:function(e,t){if(!i.OUtil.hasClass(e,t)){var n=e.getAttribute(S);n?e.setAttribute(S,n+" "+t):e.setAttribute(S,t)}},removeClass:function(e,t){if(i.OUtil.hasClass(e,t)){var n=e.getAttribute(S),r=new RegExp("(\\s|^)"+t+"(\\s|$)");n=n.replace(r,s),e.setAttribute(S,n)}},hasClass:function(e,t){var n=e.getAttribute(S);return n&&n.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},focusToFirstTabbable:function(t,n){var r,o,i=u,a=function(){i=d},s=function(e,t,n){return t<0||t>e?m:0===t&&n?m:t!==e-1||n?n?t-1:t+1:m};if(t=T(t),r=n?t.length-1:0,0===t.length)return p;for(;!i&&r>=0&&r<t.length;)o=t[r],window.focus(),o.addEventListener(e,a),o.focus(),o.removeEventListener(e,a),r=s(t.length,r,n),i||o!==document.activeElement||(i=d);return i?o:p},focusToNextTabbable:function(t,n,r){var o,i,a,s=u,c=function(){s=d},l=function(e,t,n){return t<0||t>e?m:0===t&&n?m:t!==e-1||n?n?t-1:t+1:m};if(o=function(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;return m}(t=T(t),n),(i=l(t.length,o,r))<0)return p;for(;!s&&i>=0&&i<t.length;)(a=t[i]).addEventListener(e,c),a.focus(),a.removeEventListener(e,c),i=l(t.length,i,r),s||a!==document.activeElement||(s=d);return s?a:p},isNullOrUndefined:function(e){return typeof e===c?d:e===p?d:u},stringEndsWith:function(e,t){if(!i.OUtil.isNullOrUndefined(e)&&!i.OUtil.isNullOrUndefined(t)){if(t.length>e.length)return u;if(e.substr(e.length-t.length)===t)return d}return u}}}(),i.OUtil.Guid=function(){var e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return{generateNewGuid:function(){for(var t="",n=(new Date).getTime(),r=0;r<32&&n>0;r++)8!=r&&12!=r&&16!=r&&20!=r||(t+="-"),t+=e[n%16],n=Math.floor(n/16);for(;r<32;r++)8!=r&&12!=r&&16!=r&&20!=r||(t+="-"),t+=e[Math.floor(16*Math.random())];return t}}}();try{i.Flights=i.OUtil.parseFlights(!0)}catch(e){}window.OSF=i,function(e){var t="\n",n=!0,r=null,i="undefined",a=function(){function e(){}return e.isInstanceOfType=function(e,t){if(typeof t===i||t===r)return!1;if(t instanceof e)return n;var o=t.constructor;return o&&"function"==typeof o&&o.__typeName&&"Object"!==o.__typeName||(o=Object),!(o!==e)||o.__typeName&&e.__typeName&&o.__typeName===e.__typeName},e}();e.MsAjaxTypeHelper=a;var s=function(){var e="Parameter name: {0}";function n(){}return n.create=function(e,t){var n=new Error(e);if(n.message=e,t)for(var r in t)n[r]=t[r];return n.popStackFrame(),n},n.parameterCount=function(e){var t="Sys.ParameterCountException: "+(e||"Parameter count mismatch."),r=n.create(t,{name:"Sys.ParameterCountException"});return r.popStackFrame(),r},n.argument=function(r,o){var i="Sys.ArgumentException: "+(o||"Value does not fall within the expected range.");r&&(i+=t+c.format(e,r));var a=n.create(i,{name:"Sys.ArgumentException",paramName:r});return a.popStackFrame(),a},n.argumentNull=function(r,o){var i="Sys.ArgumentNullException: "+(o||"Value cannot be null.");r&&(i+=t+c.format(e,r));var a=n.create(i,{name:"Sys.ArgumentNullException",paramName:r});return a.popStackFrame(),a},n.argumentOutOfRange=function(o,a,s){var u="Sys.ArgumentOutOfRangeException: "+(s||"Specified argument was out of the range of valid values.");o&&(u+=t+c.format(e,o)),typeof a!==i&&a!==r&&(u+=t+c.format("Actual value was {0}.",a));var l=n.create(u,{name:"Sys.ArgumentOutOfRangeException",paramName:o,actualValue:a});return l.popStackFrame(),l},n.argumentType=function(r,o,i,a){var s="Sys.ArgumentTypeException: ";s+=a||(o&&i?c.format("Object of type '{0}' cannot be converted to type '{1}'.",o.getName?o.getName():o,i.getName?i.getName():i):"Object cannot be converted to the required type."),r&&(s+=t+c.format(e,r));var u=n.create(s,{name:"Sys.ArgumentTypeException",paramName:r,actualType:o,expectedType:i});return u.popStackFrame(),u},n.argumentUndefined=function(r,o){var i="Sys.ArgumentUndefinedException: "+(o||"Value cannot be undefined.");r&&(i+=t+c.format(e,r));var a=n.create(i,{name:"Sys.ArgumentUndefinedException",paramName:r});return a.popStackFrame(),a},n.invalidOperation=function(e){var t="Sys.InvalidOperationException: "+(e||"Operation is not valid due to the current state of the object."),r=n.create(t,{name:"Sys.InvalidOperationException"});return r.popStackFrame(),r},n}();e.MsAjaxError=s;var c=function(){function e(){}return e.format=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=e;return r.replace(/{(\d+)}/gm,(function(e,n){var r=parseInt(n,10);return void 0===t[r]?"{"+n+"}":t[r]}))},e.startsWith=function(e,t){return e.substr(0,t.length)===t},e}();e.MsAjaxString=c;var u=function(){function e(){}return e.trace=function(){},e}();if(e.MsAjaxDebug=u,!o.isMsAjaxLoaded()){var l=function(e,t,n){void 0!==e.__typeName&&e.__typeName!==r||(e.__typeName=t),void 0!==e.__class&&e.__class!==r||(e.__class=n)};l(Function,"Function",n),l(Error,"Error",n),l(Object,"Object",n),l(String,"String",n),l(Boolean,"Boolean",n),l(Date,"Date",n),l(Number,"Number",n),l(RegExp,"RegExp",n),l(Array,"Array",n),Function.createCallback||(Function.createCallback=function(e,t){var r=Function._validateParams(arguments,[{name:"method",type:Function},{name:"context",mayBeNull:n}]);if(r)throw r;return function(){var n=arguments.length;if(n>0){for(var r=[],o=0;o<n;o++)r[o]=arguments[o];return r[n]=t,e.apply(this,r)}return e.call(this,t)}}),Function.createDelegate||(Function.createDelegate=function(e,t){var r=Function._validateParams(arguments,[{name:"instance",mayBeNull:n},{name:"method",type:Function}]);if(r)throw r;return function(){return t.apply(e,arguments)}}),Function._validateParams||(Function._validateParams=function(e,t,n){var o,a=t.length;if(n=n||typeof n===i,o=Function._validateParameterCount(e,t,n))return o.popStackFrame(),o;for(var s=0,c=e.length;s<c;s++){var u=t[Math.min(s,a-1)],l=u.name;if(u.parameterArray)l+="["+(s-a+1)+"]";else if(!n&&s>=a)break;if(o=Function._validateParameter(e[s],u,l))return o.popStackFrame(),o}return r}),Function._validateParameterCount||(Function._validateParameterCount=function(e,t,o){var i,a,c=t.length,u=e.length;if(u<c){var l=c;for(i=0;i<c;i++){var d=t[i];(d.optional||d.parameterArray)&&l--}u<l&&(a=n)}else if(o&&u>c)for(a=n,i=0;i<c;i++)if(t[i].parameterArray){a=!1;break}if(a){var f=s.parameterCount();return f.popStackFrame(),f}return r}),Function._validateParameter||(Function._validateParameter=function(e,t,n){var o,a=t.type,s=!!t.integer,c=!!t.domElement,u=!!t.mayBeNull;if(o=Function._validateParameterType(e,a,s,c,u,n))return o.popStackFrame(),o;var l=t.elementType,d=!!t.elementMayBeNull;if(a===Array&&typeof e!==i&&e!==r&&(l||!d))for(var f=!!t.elementInteger,p=!!t.elementDomElement,m=0;m<e.length;m++){var g=e[m];if(o=Function._validateParameterType(g,l,f,p,d,n+"["+m+"]"))return o.popStackFrame(),o}return r}),Function._validateParameterType||(Function._validateParameterType=function(t,n,o,a,s,c){var u;return typeof t===i?s?r:((u=e.MsAjaxError.argumentUndefined(c)).popStackFrame(),u):t===r?s?r:((u=e.MsAjaxError.argumentNull(c)).popStackFrame(),u):n&&!e.MsAjaxTypeHelper.isInstanceOfType(n,t)?((u=e.MsAjaxError.argumentType(c,typeof t,n)).popStackFrame(),u):r}),window.Type||(window.Type=Function),Type.registerNamespace||(Type.registerNamespace=function(e){for(var t=e.split("."),n=window,r=0;r<t.length;r++)n[t[r]]=n[t[r]]||{},n=n[t[r]]}),Type.prototype.registerClass||(Type.prototype.registerClass=function(e){({})}),typeof Sys===i&&Type.registerNamespace("Sys"),Error.prototype.popStackFrame||(Error.prototype.popStackFrame=function(){var e=this;if(0!==arguments.length)throw s.parameterCount();if(typeof e.stack!==i&&e.stack!==r&&typeof e.fileName!==i&&e.fileName!==r&&typeof e.lineNumber!==i&&e.lineNumber!==r){for(var n=e.stack.split(t),o=n[0],a=e.fileName+":"+e.lineNumber;typeof o!==i&&o!==r&&-1===o.indexOf(a);)n.shift(),o=n[0];var c=n[1];if(typeof c!==i&&c!==r){var u=c.match(/@(.*):(\d+)$/);typeof u!==i&&u!==r&&(e.fileName=u[1],e.lineNumber=parseInt(u[2]),n.shift(),e.stack=n.join(t))}}}),o.msAjaxError=s,o.msAjaxString=c,o.msAjaxDebug=u}}(l||(l={})),i.OUtil.setNamespace("Microsoft",window),i.OUtil.setNamespace("Office",Microsoft),i.OUtil.setNamespace("Common",Microsoft.Office),Microsoft.Office.Common.InvokeType={async:0,sync:1,asyncRegisterEvent:2,asyncUnregisterEvent:3,syncRegisterEvent:4,syncUnregisterEvent:5},i.SerializerVersion={MsAjax:0,Browser:1},function(e){e.appSpecificCheckOrigin=function(){return!1}}(l||(l={})),Microsoft.Office.Common.InvokeType={async:0,sync:1,asyncRegisterEvent:2,asyncUnregisterEvent:3,syncRegisterEvent:4,syncUnregisterEvent:5},Microsoft.Office.Common.InvokeResultCode={noError:0,errorInRequest:-1,errorHandlingRequest:-2,errorInResponse:-3,errorHandlingResponse:-4,errorHandlingRequestAccessDenied:-5,errorHandlingMethodCallTimedout:-6},Microsoft.Office.Common.MessageType={request:0,response:1},Microsoft.Office.Common.ActionType={invoke:0,registerEvent:1,unregisterEvent:2},Microsoft.Office.Common.ResponseType={forCalling:0,forEventing:1},Microsoft.Office.Common.HostTrustStatus={unknown:0,untrusted:1,nothttps:2,trusted:3},Microsoft.Office.Common.MethodObject=function(e,t,n){this._method=e,this._invokeType=t,this._blockingOthers=n},Microsoft.Office.Common.MethodObject.prototype={getMethod:function(){return this._method},getInvokeType:function(){return this._invokeType},getBlockingFlag:function(){return this._blockingOthers}},Microsoft.Office.Common.EventMethodObject=function(e,t){this._registerMethodObject=e,this._unregisterMethodObject=t},Microsoft.Office.Common.EventMethodObject.prototype={getRegisterMethodObject:function(){return this._registerMethodObject},getUnregisterMethodObject:function(){return this._unregisterMethodObject}},Microsoft.Office.Common.ServiceEndPoint=function(e){var t=this,n=Function._validateParams(arguments,[{name:"serviceEndPointId",type:String,mayBeNull:!1}]);if(n)throw n;t._methodObjectList={},t._eventHandlerProxyList={},t._Id=e,t._conversations={},t._policyManager=null,t._appDomains={},t._onHandleRequestError=null},Microsoft.Office.Common.ServiceEndPoint.prototype={registerMethod:function(e,t,n,r){var i="invokeType",a=!1,s=Function._validateParams(arguments,[{name:"methodName",type:String,mayBeNull:a},{name:"method",type:Function,mayBeNull:a},{name:i,type:Number,mayBeNull:a},{name:"blockingOthers",type:Boolean,mayBeNull:a}]);if(s)throw s;if(n!==Microsoft.Office.Common.InvokeType.async&&n!==Microsoft.Office.Common.InvokeType.sync)throw o.msAjaxError.argument(i);var c=new Microsoft.Office.Common.MethodObject(t,n,r);this._methodObjectList[e]=c},unregisterMethod:function(e){var t=Function._validateParams(arguments,[{name:"methodName",type:String,mayBeNull:!1}]);if(t)throw t;delete this._methodObjectList[e]},registerEvent:function(e,t,n){var r=!1,o=Function._validateParams(arguments,[{name:"eventName",type:String,mayBeNull:r},{name:"registerMethod",type:Function,mayBeNull:r},{name:"unregisterMethod",type:Function,mayBeNull:r}]);if(o)throw o;var i=new Microsoft.Office.Common.EventMethodObject(new Microsoft.Office.Common.MethodObject(t,Microsoft.Office.Common.InvokeType.syncRegisterEvent,r),new Microsoft.Office.Common.MethodObject(n,Microsoft.Office.Common.InvokeType.syncUnregisterEvent,r));this._methodObjectList[e]=i},registerEventEx:function(e,t,n,r,o){var i=!1,a=Function._validateParams(arguments,[{name:"eventName",type:String,mayBeNull:i},{name:"registerMethod",type:Function,mayBeNull:i},{name:"registerMethodInvokeType",type:Number,mayBeNull:i},{name:"unregisterMethod",type:Function,mayBeNull:i},{name:"unregisterMethodInvokeType",type:Number,mayBeNull:i}]);if(a)throw a;var s=new Microsoft.Office.Common.EventMethodObject(new Microsoft.Office.Common.MethodObject(t,n,i),new Microsoft.Office.Common.MethodObject(r,o,i));this._methodObjectList[e]=s},unregisterEvent:function(e){var t=Function._validateParams(arguments,[{name:"eventName",type:String,mayBeNull:!1}]);if(t)throw t;this.unregisterMethod(e)},registerConversation:function(e,t,n,r){var i="appDomains",a=!0,s=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:!1},{name:"conversationUrl",type:String,mayBeNull:!1,optional:a},{name:i,type:Object,mayBeNull:a,optional:a},{name:"serializerVersion",type:Number,mayBeNull:a,optional:a}]);if(s)throw s;if(n){if(!(n instanceof Array))throw o.msAjaxError.argument(i);this._appDomains[e]=n}this._conversations[e]={url:t,serializerVersion:r}},unregisterConversation:function(e){var t=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:!1}]);if(t)throw t;delete this._conversations[e]},setPolicyManager:function(e){var t="policyManager",n=Function._validateParams(arguments,[{name:t,type:Object,mayBeNull:!1}]);if(n)throw n;if(!e.checkPermission)throw o.msAjaxError.argument(t);this._policyManager=e},getPolicyManager:function(){return this._policyManager},dispose:function(){var e=null,t=this;t._methodObjectList=e,t._eventHandlerProxyList=e,t._Id=e,t._conversations=e,t._policyManager=e,t._appDomains=e,t._onHandleRequestError=e}},Microsoft.Office.Common.ClientEndPoint=function(e,t,n,r){var a="targetWindow",s=!1,c=this,u=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:s},{name:a,mayBeNull:s},{name:"targetUrl",type:String,mayBeNull:s},{name:"serializerVersion",type:Number,mayBeNull:!0,optional:!0}]);if(u)throw u;try{if(!t.postMessage)throw o.msAjaxError.argument(a)}catch(e){if(!Object.prototype.hasOwnProperty.call(t,"postMessage"))throw o.msAjaxError.argument(a)}c._conversationId=e,c._targetWindow=t,c._targetUrl=n,c._callingIndex=0,c._callbackList={},c._eventHandlerList={},c._serializerVersion=null!=r?r:i.SerializerVersion.Browser,c._checkReceiverOriginAndRun=null,c._hostTrustCheckStatus=Microsoft.Office.Common.HostTrustStatus.unknown,c._checkStatusLogged=s},Microsoft.Office.Common.ClientEndPoint.prototype={invoke:function(e,t,n){var r=Function._validateParams(arguments,[{name:"targetMethodName",type:String,mayBeNull:!1},{name:"callback",type:Function,mayBeNull:!0},{name:"param",mayBeNull:!0}]);if(r)throw r;var o=this,a=function(){var r=o._callingIndex++,i=new Date,a={callback:t,createdOn:i.getTime()};n&&"object"==typeof n&&"number"==typeof n.__timeout__&&(a.timeout=n.__timeout__,delete n.__timeout__),o._callbackList[r]=a;try{if(o._hostTrustCheckStatus!==Microsoft.Office.Common.HostTrustStatus.trusted&&"ContextActivationManager_getAppContextAsync"!==e)throw"Access Denied";var s=new Microsoft.Office.Common.Request(e,Microsoft.Office.Common.ActionType.invoke,o._conversationId,r,n),c=Microsoft.Office.Common.MessagePackager.envelope(s,o._serializerVersion);o._targetWindow.postMessage(c,o._targetUrl),Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer()}catch(e){try{null!==t&&t(Microsoft.Office.Common.InvokeResultCode.errorInRequest,e)}finally{delete o._callbackList[r]}}};i.OUtil.checkFlight(i.FlightNames.CheckReceiverOrigin)&&o._checkReceiverOriginAndRun?o._checkReceiverOriginAndRun(a):(o._hostTrustCheckStatus=Microsoft.Office.Common.HostTrustStatus.trusted,a())},registerForEvent:function(e,t,n,r){var o=this,i=Function._validateParams(arguments,[{name:"targetEventName",type:String,mayBeNull:!1},{name:"eventHandler",type:Function,mayBeNull:!1},{name:"callback",type:Function,mayBeNull:!0},{name:"data",mayBeNull:!0,optional:!0}]);if(i)throw i;var a=o._callingIndex++,s=new Date;o._callbackList[a]={callback:n,createdOn:s.getTime()};try{var c=new Microsoft.Office.Common.Request(e,Microsoft.Office.Common.ActionType.registerEvent,o._conversationId,a,r),u=Microsoft.Office.Common.MessagePackager.envelope(c,o._serializerVersion);o._targetWindow.postMessage(u,o._targetUrl),Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer(),o._eventHandlerList[e]=t}catch(e){try{null!==n&&n(Microsoft.Office.Common.InvokeResultCode.errorInRequest,e)}finally{delete o._callbackList[a]}}},unregisterForEvent:function(e,t,n){var r=this,o=Function._validateParams(arguments,[{name:"targetEventName",type:String,mayBeNull:!1},{name:"callback",type:Function,mayBeNull:!0},{name:"data",mayBeNull:!0,optional:!0}]);if(o)throw o;var i=r._callingIndex++,a=new Date;r._callbackList[i]={callback:t,createdOn:a.getTime()};try{var s=new Microsoft.Office.Common.Request(e,Microsoft.Office.Common.ActionType.unregisterEvent,r._conversationId,i,n),c=Microsoft.Office.Common.MessagePackager.envelope(s,r._serializerVersion);r._targetWindow.postMessage(c,r._targetUrl),Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer()}catch(e){try{null!==t&&t(Microsoft.Office.Common.InvokeResultCode.errorInRequest,e)}finally{delete r._callbackList[i]}}finally{delete r._eventHandlerList[e]}}},Microsoft.Office.Common.XdmCommunicationManager=function(){var e="serviceEndPointId",t=!0,n="a",r="null",a="channel is not ready.",s="conversationId",c="Unknown conversation Id.",u=!1,d=null,f=[],p=d,m=d,g=10,h=u,v=d,y=65e3,b=y,_={},S={},C=u;function O(e){for(var t in _)if(_[t]._conversations[e])return _[t];throw o.msAjaxDebug.trace(c),o.msAjaxError.argument(s)}function A(e){var t=S[e];return!t&&o.msAjaxDebug.trace(c),t}function I(e){f.push(e)}function x(){if(m!==d){if(!h)if(f.length>0){E(f.shift())}else clearInterval(m),m=d}else o.msAjaxDebug.trace(a)}function E(e){h=e.getInvokeBlockingFlag(),e.invoke(),p=(new Date).getTime()}function T(){if(v){var e,t,n=0,r=new Date;for(var i in S)for(var s in(e=S[i])._callbackList){var c=e._callbackList[s];if((t=c.timeout?c.timeout:b)>=0&&Math.abs(r.getTime()-c.createdOn)>=t)try{c.callback&&c.callback(Microsoft.Office.Common.InvokeResultCode.errorHandlingMethodCallTimedout,d)}finally{delete e._callbackList[s]}else n++}0===n&&(clearInterval(v),v=d)}else o.msAjaxDebug.trace(a)}function P(){h=u}function w(e,t){var o,a,s=u;if(!(e&&t&&e!==r&&t!==r&&e.length&&t.length))return s;i.OUtil.checkFlight(i.FlightNames.AddinEnforceHttps)?s=k(e,t):(o=document.createElement(n),a=document.createElement(n),o.href=e,a.href=t,s=N(o,a),delete o);return s}function M(e,t){var o=u;if(!(t&&t!==r&&t.length&&e&&e instanceof Array&&e.length))return o;var a=document.createElement(n),s=document.createElement(n);a.href=t;for(var c=0;c<e.length&&!o;c++)-1!==e[c].indexOf("://")&&(i.OUtil.checkFlight(i.FlightNames.AddinEnforceHttps)?o=k(t,e[c]):(s.href=e[c],o=N(a,s)));return delete a,o}function R(e){if(!e||e===r)return u;var t=["^office-int\\.com$","^officeapps\\.live-int\\.com$","^.*\\.dod\\.online\\.office365\\.us$","^.*\\.gov\\.online\\.office365\\.us$","^.*\\.officeapps\\.live\\.com$","^.*\\.officeapps\\.live-int\\.com$","^.*\\.officeapps-df\\.live\\.com$","^.*\\.online\\.office\\.de$","^.*\\.partner\\.officewebapps\\.cn$","^"+document.domain.replace(new RegExp("\\.","g"),"\\.")+"$"];return new RegExp(t.join("|")).test(e)}function j(e,o){if(!e||!o||e===r||o===r)return u;var a,s;i.OUtil.checkFlight(i.FlightNames.AddinEnforceHttps)?(a=i.OUtil.parseUrl(e,t),s=i.OUtil.parseUrl(o,t)):((a=document.createElement(n)).href=e,(s=document.createElement(n)).href=o);var c=a.protocol===s.protocol,l=a.port===s.port,d=s.hostname,f=a.hostname,p=d===f,m=u;return!p&&d.length>f.length+1&&(m=d.slice(-(f.length+1))==="."+f),l&&c&&(p||m)}function k(e,n){return N(i.OUtil.parseUrl(e,t),i.OUtil.parseUrl(n,t))}function N(e,t){return e.hostname==t.hostname&&e.protocol==t.protocol&&e.port==t.port}function D(e){var a="Access Denied";if(i&&""!=e.data){var s,c=i.SerializerVersion.Browser,f=e.data;try{c=(s=Microsoft.Office.Common.MessagePackager.unenvelope(f,i.SerializerVersion.Browser))._serializerVersion!=d?s._serializerVersion:c}catch(e){return}if(s._messageType===Microsoft.Office.Common.MessageType.request){var v=e.origin==d||e.origin===r?s._origin:e.origin;try{var y=O(s._conversationId),b=y._conversations[s._conversationId];c=b.serializerVersion!=d?b.serializerVersion:c;var _=[b.url].concat(y._appDomains[s._conversationId]);if(!M(_,e.origin)&&!l.appSpecificCheckOrigin(_,e,s._origin,M))if(!j(b.url,e.origin))throw"Failed origin check";var S=s._data!=d?s._data:{};S.SecurityOrigin=e.origin;var C=y.getPolicyManager();if(C&&!C.checkPermission(s._conversationId,s._actionName,S))throw a;var T=function(e,t){var n=e._methodObjectList[t._actionName];if(!n)throw o.msAjaxDebug.trace("The specified method is not registered on service endpoint:"+t._actionName),o.msAjaxError.argument("messageObject");return t._actionType===Microsoft.Office.Common.ActionType.invoke?n:t._actionType===Microsoft.Office.Common.ActionType.registerEvent?n.getRegisterMethodObject():n.getUnregisterMethodObject()}(y,s),k=new Microsoft.Office.Common.InvokeCompleteCallback(e.source,v,s._actionName,s._conversationId,s._correlationId,P,c),N=new Microsoft.Office.Common.Invoker(T,S,k,y._eventHandlerProxyList,s._conversationId,s._actionName,c),D=t;m==d&&((p==d||(new Date).getTime()-p>g)&&!h?(E(N),D=u):m=setInterval(x,g)),D&&I(N)}catch(o){y&&y._onHandleRequestError&&y._onHandleRequestError(s,o);var F=Microsoft.Office.Common.InvokeResultCode.errorHandlingRequest;o==a&&(F=Microsoft.Office.Common.InvokeResultCode.errorHandlingRequestAccessDenied);var L=new Microsoft.Office.Common.Response(s._actionName,s._conversationId,s._correlationId,F,Microsoft.Office.Common.ResponseType.forCalling,o),U=Microsoft.Office.Common.MessagePackager.envelope(L,c),B=u;try{B=!(!e.source||!e.source.postMessage)}catch(e){}var H=u;if(window.location.href&&e.origin&&e.origin!==r&&j(window.location.href,e.origin))H=t;else if(e.origin&&e.origin!==r)if(i.OUtil.checkFlight(i.FlightNames.AddinEnforceHttps)){H=R(i.OUtil.parseUrl(e.origin,t).hostname)}else{(V=document.createElement(n)).href=e.origin,H=R(V.hostname)}B&&H&&e.source.postMessage(U,v)}}else{if(s._messageType!==Microsoft.Office.Common.MessageType.response)return;var W=A(s._conversationId);if("ContextActivationManager_getAppContextAsync"==s._actionName)try{if(i.OUtil.checkFlight(i.FlightNames.AddinEnforceHttps))H=R(i.OUtil.parseUrl(e.origin,t).hostname);else{var V,z=e.origin;(V=document.createElement(n)).href=z;H=R(V.hostname)}var G=H?1:0,q=i._OfficeAppFactory.getHostInfo();i.AppTelemetry.onCheckWACHost(G,s._data._id,q.hostType,q.hostPlatform,s._data._correlationId,z),G||W&&W._onSenderOriginNotTrusted&&W._onSenderOriginNotTrusted()}catch(e){}if(!W)return;if(W._serializerVersion=c,!w(W._targetUrl,e.origin))throw"Failed orgin check";if(s._responseType===Microsoft.Office.Common.ResponseType.forCalling){var K=W._callbackList[s._correlationId];if(K)try{K.callback&&K.callback(s._errorCode,s._data)}finally{delete W._callbackList[s._correlationId]}}else{var X=W._eventHandlerList[s._actionName];void 0!==X&&X!==d&&X(s._data)}}}}function F(){C||(!function(e){if(window.addEventListener)window.addEventListener("message",e,u);else{if(!(navigator.userAgent.indexOf("MSIE")>-1&&window.attachEvent))throw o.msAjaxDebug.trace("Browser doesn't support the required API."),o.msAjaxError.argument("Browser");window.attachEvent("onmessage",e)}}(D),C=t)}return{connect:function(e,t,n,r){var o=S[e];return o||(F(),o=new Microsoft.Office.Common.ClientEndPoint(e,t,n,r),S[e]=o),o},getClientEndPoint:function(e){var t=Function._validateParams(arguments,[{name:s,type:String,mayBeNull:u}]);if(t)throw t;return S[e]},createServiceEndPoint:function(e){F();var t=new Microsoft.Office.Common.ServiceEndPoint(e);return _[e]=t,t},getServiceEndPoint:function(t){var n=Function._validateParams(arguments,[{name:e,type:String,mayBeNull:u}]);if(n)throw n;return _[t]},deleteClientEndPoint:function(e){var t=Function._validateParams(arguments,[{name:s,type:String,mayBeNull:u}]);if(t)throw t;delete S[e]},deleteServiceEndPoint:function(t){var n=Function._validateParams(arguments,[{name:e,type:String,mayBeNull:u}]);if(n)throw n;delete _[t]},checkUrlWithAppDomains:function(e,t){return M(e,t)},isTargetSubdomainOfSourceLocation:function(e,t){return j(e,t)},_setMethodTimeout:function(e){var t=Function._validateParams(arguments,[{name:"methodTimeout",type:Number,mayBeNull:u}]);if(t)throw t;b=e<=0?y:e},_startMethodTimeoutTimer:function(){v||(v=setInterval(T,2e3))},isHostNameValidWacDomain:function(e){return R(e)}}}(),Microsoft.Office.Common.Message=function(e,t,n,r,o){var i=!1,a=this,s=Function._validateParams(arguments,[{name:"messageType",type:Number,mayBeNull:i},{name:"actionName",type:String,mayBeNull:i},{name:"conversationId",type:String,mayBeNull:i},{name:"correlationId",mayBeNull:i},{name:"data",mayBeNull:!0,optional:!0}]);if(s)throw s;a._messageType=e,a._actionName=t,a._conversationId=n,a._correlationId=r,a._origin=window.location.origin,a._data=void 0===o?null:o},Microsoft.Office.Common.Message.prototype={getActionName:function(){return this._actionName},getConversationId:function(){return this._conversationId},getCorrelationId:function(){return this._correlationId},getOrigin:function(){return this._origin},getData:function(){return this._data},getMessageType:function(){return this._messageType}},Microsoft.Office.Common.Request=function(e,t,n,r,o){Microsoft.Office.Common.Request.uber.constructor.call(this,Microsoft.Office.Common.MessageType.request,e,n,r,o),this._actionType=t},i.OUtil.extend(Microsoft.Office.Common.Request,Microsoft.Office.Common.Message),Microsoft.Office.Common.Request.prototype.getActionType=function(){return this._actionType},Microsoft.Office.Common.Response=function(e,t,n,r,o,i){Microsoft.Office.Common.Response.uber.constructor.call(this,Microsoft.Office.Common.MessageType.response,e,t,n,i),this._errorCode=r,this._responseType=o},i.OUtil.extend(Microsoft.Office.Common.Response,Microsoft.Office.Common.Message),Microsoft.Office.Common.Response.prototype.getErrorCode=function(){return this._errorCode},Microsoft.Office.Common.Response.prototype.getResponseType=function(){return this._responseType},Microsoft.Office.Common.MessagePackager={envelope:function(e){return"object"==typeof e&&(e._serializerVersion=i.SerializerVersion.Browser),JSON.stringify(e)},unenvelope:function(e){return JSON.parse(e)}},Microsoft.Office.Common.ResponseSender=function(e,t,n,r,i,a,s){var c=!1,u=this,l=Function._validateParams(arguments,[{name:"requesterWindow",mayBeNull:c},{name:"requesterUrl",type:String,mayBeNull:c},{name:"actionName",type:String,mayBeNull:c},{name:"conversationId",type:String,mayBeNull:c},{name:"correlationId",mayBeNull:c},{name:"responsetype",type:Number,maybeNull:c},{name:"serializerVersion",type:Number,maybeNull:!0,optional:!0}]);if(l)throw l;u._requesterWindow=e,u._requesterUrl=t,u._actionName=n,u._conversationId=r,u._correlationId=i,u._invokeResultCode=Microsoft.Office.Common.InvokeResultCode.noError,u._responseType=a;var d=u;u._send=function(e){try{var t=new Microsoft.Office.Common.Response(d._actionName,d._conversationId,d._correlationId,d._invokeResultCode,d._responseType,e),n=Microsoft.Office.Common.MessagePackager.envelope(t,s);d._requesterWindow.postMessage(n,d._requesterUrl)}catch(e){o.msAjaxDebug.trace("ResponseSender._send error:"+e.message)}}},Microsoft.Office.Common.ResponseSender.prototype={getRequesterWindow:function(){return this._requesterWindow},getRequesterUrl:function(){return this._requesterUrl},getActionName:function(){return this._actionName},getConversationId:function(){return this._conversationId},getCorrelationId:function(){return this._correlationId},getSend:function(){return this._send},setResultCode:function(e){this._invokeResultCode=e}},Microsoft.Office.Common.InvokeCompleteCallback=function(e,t,n,r,i,a,s){var c=this;Microsoft.Office.Common.InvokeCompleteCallback.uber.constructor.call(c,e,t,n,r,i,Microsoft.Office.Common.ResponseType.forCalling,s),c._postCallbackHandler=a;var u=c;c._send=function(e,t){null!=t&&(u._invokeResultCode=t);try{var n=new Microsoft.Office.Common.Response(u._actionName,u._conversationId,u._correlationId,u._invokeResultCode,u._responseType,e),r=Microsoft.Office.Common.MessagePackager.envelope(n,s);u._requesterWindow.postMessage(r,u._requesterUrl),u._postCallbackHandler()}catch(e){o.msAjaxDebug.trace("InvokeCompleteCallback._send error:"+e.message)}}},i.OUtil.extend(Microsoft.Office.Common.InvokeCompleteCallback,Microsoft.Office.Common.ResponseSender),Microsoft.Office.Common.Invoker=function(e,t,n,r,o,i,a){var s=!0,c=!1,u=this,l=Function._validateParams(arguments,[{name:"methodObject",mayBeNull:c},{name:"paramValue",mayBeNull:s},{name:"invokeCompleteCallback",mayBeNull:c},{name:"eventHandlerProxyList",mayBeNull:s},{name:"conversationId",type:String,mayBeNull:c},{name:"eventName",type:String,mayBeNull:c},{name:"serializerVersion",type:Number,mayBeNull:s,optional:s}]);if(l)throw l;u._methodObject=e,u._param=t,u._invokeCompleteCallback=n,u._eventHandlerProxyList=r,u._conversationId=o,u._eventName=i,u._serializerVersion=a},Microsoft.Office.Common.Invoker.prototype={invoke:function(){var e=this;try{var t;switch(e._methodObject.getInvokeType()){case Microsoft.Office.Common.InvokeType.async:e._methodObject.getMethod()(e._param,e._invokeCompleteCallback.getSend());break;case Microsoft.Office.Common.InvokeType.sync:t=e._methodObject.getMethod()(e._param),e._invokeCompleteCallback.getSend()(t);break;case Microsoft.Office.Common.InvokeType.syncRegisterEvent:var n=e._createEventHandlerProxyObject(e._invokeCompleteCallback);t=e._methodObject.getMethod()(n.getSend(),e._param),e._eventHandlerProxyList[e._conversationId+e._eventName]=n.getSend(),e._invokeCompleteCallback.getSend()(t);break;case Microsoft.Office.Common.InvokeType.syncUnregisterEvent:var r=e._eventHandlerProxyList[e._conversationId+e._eventName];t=e._methodObject.getMethod()(r,e._param),delete e._eventHandlerProxyList[e._conversationId+e._eventName],e._invokeCompleteCallback.getSend()(t);break;case Microsoft.Office.Common.InvokeType.asyncRegisterEvent:var o=e._createEventHandlerProxyObject(e._invokeCompleteCallback);e._methodObject.getMethod()(o.getSend(),e._invokeCompleteCallback.getSend(),e._param),e._eventHandlerProxyList[e._callerId+e._eventName]=o.getSend();break;case Microsoft.Office.Common.InvokeType.asyncUnregisterEvent:var i=e._eventHandlerProxyList[e._callerId+e._eventName];e._methodObject.getMethod()(i,e._invokeCompleteCallback.getSend(),e._param),delete e._eventHandlerProxyList[e._callerId+e._eventName]}}catch(t){e._invokeCompleteCallback.setResultCode(Microsoft.Office.Common.InvokeResultCode.errorInResponse),e._invokeCompleteCallback.getSend()(t)}},getInvokeBlockingFlag:function(){return this._methodObject.getBlockingFlag()},_createEventHandlerProxyObject:function(e){return new Microsoft.Office.Common.ResponseSender(e.getRequesterWindow(),e.getRequesterUrl(),e.getActionName(),e.getConversationId(),e.getCorrelationId(),Microsoft.Office.Common.ResponseType.forEventing,this._serializerVersion)}},i.OUtil.setNamespace("OSF",window),i.MessageIDs={FetchBundleUrl:0,LoadReactBundle:1,LoadBundleSuccess:2,LoadBundleError:3},i.AppName={Unsupported:0,Excel:1,Word:2,PowerPoint:4,Outlook:8,ExcelWebApp:16,WordWebApp:32,OutlookWebApp:64,Project:128,AccessWebApp:256,PowerpointWebApp:512,ExcelIOS:1024,Sway:2048,WordIOS:4096,PowerPointIOS:8192,Access:16384,Lync:32768,OutlookIOS:65536,OneNoteWebApp:131072,OneNote:262144,ExcelWinRT:524288,WordWinRT:1048576,PowerpointWinRT:2097152,OutlookAndroid:4194304,OneNoteWinRT:8388608,ExcelAndroid:8388609,VisioWebApp:8388610,OneNoteIOS:8388611,WordAndroid:8388613,PowerpointAndroid:8388614,Visio:8388615,OneNoteAndroid:4194305},i.InternalPerfMarker={DataCoercionBegin:"Agave.HostCall.CoerceDataStart",DataCoercionEnd:"Agave.HostCall.CoerceDataEnd"},i.HostCallPerfMarker={IssueCall:"Agave.HostCall.IssueCall",ReceiveResponse:"Agave.HostCall.ReceiveResponse",RuntimeExceptionRaised:"Agave.HostCall.RuntimeExecptionRaised"},i.AgaveHostAction={Select:0,UnSelect:1,CancelDialog:2,InsertAgave:3,CtrlF6In:4,CtrlF6Exit:5,CtrlF6ExitShift:6,SelectWithError:7,NotifyHostError:8,RefreshAddinCommands:9,PageIsReady:10,TabIn:11,TabInShift:12,TabExit:13,TabExitShift:14,EscExit:15,F2Exit:16,ExitNoFocusable:17,ExitNoFocusableShift:18,MouseEnter:19,MouseLeave:20,UpdateTargetUrl:21,InstallCustomFunctions:22,SendTelemetryEvent:23,UninstallCustomFunctions:24,SendMessage:25,LaunchExtensionComponent:26,StopExtensionComponent:27,RestartExtensionComponent:28,EnableTaskPaneHeaderButton:29,DisableTaskPaneHeaderButton:30,TaskPaneHeaderButtonClicked:31,RemoveAppCommandsAddin:32,RefreshRibbonGallery:33},i.SharedConstants={NotificationConversationIdSuffix:"_ntf"},i.DialogMessageType={DialogMessageReceived:0,DialogParentMessageReceived:1,DialogClosed:12006},i.OfficeAppContext=function(e,t,n,r,o,i,a,s,c,u,l,d,f,p,m,g,h,v,y,b,_,S,C,O,A,I,x){var E=this;E._id=e,E._appName=t,E._appVersion=n,E._appUILocale=r,E._dataLocale=o,E._docUrl=i,E._clientMode=a,E._settings=s,E._reason=c,E._osfControlType=u,E._eToken=l,E._correlationId=d,E._appInstanceId=f,E._touchEnabled=p,E._commerceAllowed=m,E._appMinorVersion=g,E._requirementMatrix=h,E._hostCustomMessage=v,E._hostFullVersion=y,E._isDialog=!1,E._clientWindowHeight=b,E._clientWindowWidth=_,E._addinName=S,E._appDomains=C,E._dialogRequirementMatrix=O,E._featureGates=A,E._officeTheme=I,E._initialDisplayMode=x,E.get_id=function(){return this._id},E.get_appName=function(){return this._appName},E.get_appVersion=function(){return this._appVersion},E.get_appUILocale=function(){return this._appUILocale},E.get_dataLocale=function(){return this._dataLocale},E.get_docUrl=function(){return this._docUrl},E.get_clientMode=function(){return this._clientMode},E.get_bindings=function(){return this._bindings},E.get_settings=function(){return this._settings},E.get_reason=function(){return this._reason},E.get_osfControlType=function(){return this._osfControlType},E.get_eToken=function(){return this._eToken},E.get_correlationId=function(){return this._correlationId},E.get_appInstanceId=function(){return this._appInstanceId},E.get_touchEnabled=function(){return this._touchEnabled},E.get_commerceAllowed=function(){return this._commerceAllowed},E.get_appMinorVersion=function(){return this._appMinorVersion},E.get_requirementMatrix=function(){return this._requirementMatrix},E.get_dialogRequirementMatrix=function(){return this._dialogRequirementMatrix},E.get_hostCustomMessage=function(){return this._hostCustomMessage},E.get_hostFullVersion=function(){return this._hostFullVersion},E.get_isDialog=function(){return this._isDialog},E.get_clientWindowHeight=function(){return this._clientWindowHeight},E.get_clientWindowWidth=function(){return this._clientWindowWidth},E.get_addinName=function(){return this._addinName},E.get_appDomains=function(){return this._appDomains},E.get_featureGates=function(){return this._featureGates},E.get_officeTheme=function(){return this._officeTheme},E.get_initialDisplayMode=function(){return this._initialDisplayMode?this._initialDisplayMode:0}},i.OsfControlType={DocumentLevel:0,ContainerLevel:1},i.ClientMode={ReadOnly:0,ReadWrite:1},i.OUtil.setNamespace("Microsoft",window),i.OUtil.setNamespace("Office",Microsoft),i.OUtil.setNamespace("Client",Microsoft.Office),i.OUtil.setNamespace("WebExtension",Microsoft.Office),Microsoft.Office.WebExtension.InitializationReason={Inserted:"inserted",DocumentOpened:"documentOpened"},Microsoft.Office.WebExtension.ValueFormat={Unformatted:"unformatted",Formatted:"formatted"},Microsoft.Office.WebExtension.FilterType={All:"all"},Microsoft.Office.WebExtension.Parameters={BindingType:"bindingType",CoercionType:"coercionType",ValueFormat:"valueFormat",FilterType:"filterType",Columns:"columns",SampleData:"sampleData",GoToType:"goToType",SelectionMode:"selectionMode",Id:"id",PromptText:"promptText",ItemName:"itemName",FailOnCollision:"failOnCollision",StartRow:"startRow",StartColumn:"startColumn",RowCount:"rowCount",ColumnCount:"columnCount",Callback:"callback",AsyncContext:"asyncContext",Data:"data",Rows:"rows",OverwriteIfStale:"overwriteIfStale",FileType:"fileType",EventType:"eventType",Handler:"handler",SliceSize:"sliceSize",SliceIndex:"sliceIndex",ActiveView:"activeView",Status:"status",PlatformType:"platformType",HostType:"hostType",ForceConsent:"forceConsent",ForceAddAccount:"forceAddAccount",AuthChallenge:"authChallenge",AllowConsentPrompt:"allowConsentPrompt",ForMSGraphAccess:"forMSGraphAccess",AllowSignInPrompt:"allowSignInPrompt",Reserved:"reserved",Tcid:"tcid",Xml:"xml",Namespace:"namespace",Prefix:"prefix",XPath:"xPath",Text:"text",ImageLeft:"imageLeft",ImageTop:"imageTop",ImageWidth:"imageWidth",ImageHeight:"imageHeight",TaskId:"taskId",FieldId:"fieldId",FieldValue:"fieldValue",ServerUrl:"serverUrl",ListName:"listName",ResourceId:"resourceId",ViewType:"viewType",ViewName:"viewName",GetRawValue:"getRawValue",CellFormat:"cellFormat",TableOptions:"tableOptions",TaskIndex:"taskIndex",ResourceIndex:"resourceIndex",CustomFieldId:"customFieldId",Url:"url",MessageHandler:"messageHandler",Width:"width",Height:"height",RequireHTTPs:"requireHTTPS",MessageToParent:"messageToParent",DisplayInIframe:"displayInIframe",MessageContent:"messageContent",HideTitle:"hideTitle",UseDeviceIndependentPixels:"useDeviceIndependentPixels",PromptBeforeOpen:"promptBeforeOpen",EnforceAppDomain:"enforceAppDomain",UrlNoHostInfo:"urlNoHostInfo",AppCommandInvocationCompletedData:"appCommandInvocationCompletedData",Base64:"base64",FormId:"formId"},i.OUtil.setNamespace("DDA",i),i.DDA.DocumentMode={ReadOnly:1,ReadWrite:0},i.DDA.PropertyDescriptors={AsyncResultStatus:"AsyncResultStatus"},i.DDA.EventDescriptors={},i.DDA.ListDescriptors={},i.DDA.UI={},i.DDA.getXdmEventName=function(e,t){return t==Microsoft.Office.WebExtension.EventType.BindingSelectionChanged||t==Microsoft.Office.WebExtension.EventType.BindingDataChanged||t==Microsoft.Office.WebExtension.EventType.DataNodeDeleted||t==Microsoft.Office.WebExtension.EventType.DataNodeInserted||t==Microsoft.Office.WebExtension.EventType.DataNodeReplaced?e+"_"+t:t},i.DDA.MethodDispId={dispidMethodMin:64,dispidGetSelectedDataMethod:64,dispidSetSelectedDataMethod:65,dispidAddBindingFromSelectionMethod:66,dispidAddBindingFromPromptMethod:67,dispidGetBindingMethod:68,dispidReleaseBindingMethod:69,dispidGetBindingDataMethod:70,dispidSetBindingDataMethod:71,dispidAddRowsMethod:72,dispidClearAllRowsMethod:73,dispidGetAllBindingsMethod:74,dispidLoadSettingsMethod:75,dispidSaveSettingsMethod:76,dispidGetDocumentCopyMethod:77,dispidAddBindingFromNamedItemMethod:78,dispidAddColumnsMethod:79,dispidGetDocumentCopyChunkMethod:80,dispidReleaseDocumentCopyMethod:81,dispidNavigateToMethod:82,dispidGetActiveViewMethod:83,dispidGetDocumentThemeMethod:84,dispidGetOfficeThemeMethod:85,dispidGetFilePropertiesMethod:86,dispidClearFormatsMethod:87,dispidSetTableOptionsMethod:88,dispidSetFormatsMethod:89,dispidExecuteRichApiRequestMethod:93,dispidAppCommandInvocationCompletedMethod:94,dispidCloseContainerMethod:97,dispidGetAccessTokenMethod:98,dispidGetAuthContextMethod:99,dispidOpenBrowserWindow:102,dispidCreateDocumentMethod:105,dispidInsertFormMethod:106,dispidDisplayRibbonCalloutAsyncMethod:109,dispidGetSelectedTaskMethod:110,dispidGetSelectedResourceMethod:111,dispidGetTaskMethod:112,dispidGetResourceFieldMethod:113,dispidGetWSSUrlMethod:114,dispidGetTaskFieldMethod:115,dispidGetProjectFieldMethod:116,dispidGetSelectedViewMethod:117,dispidGetTaskByIndexMethod:118,dispidGetResourceByIndexMethod:119,dispidSetTaskFieldMethod:120,dispidSetResourceFieldMethod:121,dispidGetMaxTaskIndexMethod:122,dispidGetMaxResourceIndexMethod:123,dispidCreateTaskMethod:124,dispidAddDataPartMethod:128,dispidGetDataPartByIdMethod:129,dispidGetDataPartsByNamespaceMethod:130,dispidGetDataPartXmlMethod:131,dispidGetDataPartNodesMethod:132,dispidDeleteDataPartMethod:133,dispidGetDataNodeValueMethod:134,dispidGetDataNodeXmlMethod:135,dispidGetDataNodesMethod:136,dispidSetDataNodeValueMethod:137,dispidSetDataNodeXmlMethod:138,dispidAddDataNamespaceMethod:139,dispidGetDataUriByPrefixMethod:140,dispidGetDataPrefixByUriMethod:141,dispidGetDataNodeTextMethod:142,dispidSetDataNodeTextMethod:143,dispidMessageParentMethod:144,dispidSendMessageMethod:145,dispidExecuteFeature:146,dispidQueryFeature:147,dispidMethodMax:147},i.DDA.EventDispId={dispidEventMin:0,dispidInitializeEvent:0,dispidSettingsChangedEvent:1,dispidDocumentSelectionChangedEvent:2,dispidBindingSelectionChangedEvent:3,dispidBindingDataChangedEvent:4,dispidDocumentOpenEvent:5,dispidDocumentCloseEvent:6,dispidActiveViewChangedEvent:7,dispidDocumentThemeChangedEvent:8,dispidOfficeThemeChangedEvent:9,dispidDialogMessageReceivedEvent:10,dispidDialogNotificationShownInAddinEvent:11,dispidDialogParentMessageReceivedEvent:12,dispidObjectDeletedEvent:13,dispidObjectSelectionChangedEvent:14,dispidObjectDataChangedEvent:15,dispidContentControlAddedEvent:16,dispidActivationStatusChangedEvent:32,dispidRichApiMessageEvent:33,dispidAppCommandInvokedEvent:39,dispidOlkItemSelectedChangedEvent:46,dispidOlkRecipientsChangedEvent:47,dispidOlkAppointmentTimeChangedEvent:48,dispidOlkRecurrenceChangedEvent:49,dispidOlkAttachmentsChangedEvent:50,dispidOlkEnhancedLocationsChangedEvent:51,dispidOlkInfobarClickedEvent:52,dispidTaskSelectionChangedEvent:56,dispidResourceSelectionChangedEvent:57,dispidViewSelectionChangedEvent:58,dispidDataNodeAddedEvent:60,dispidDataNodeReplacedEvent:61,dispidDataNodeDeletedEvent:62,dispidEventMax:63},i.Constants={FileVersion:"0.0.0.0",ThreePartsFileVersion:"0.0.0",OmexAnonymousServiceExtension:"/anonymousserviceextension.aspx",OmexGatedServiceExtension:"/gatedserviceextension.aspx",OmexUnGatedServiceExtension:"/ungatedserviceextension.aspx",OmexConsentNotificationPage:"/client/consentnotification.aspx",Http:"http",Https:"https",ProtocolSeparator:"://",SignInRedirectUrl:"/logontoliveforwac.aspx?returnurl=",ETokenParameterName:"et",ActivatedCacheKey:"__OSF_RUNTIME_.Activated.{0}.{1}.{2}",AuthenticatedConnectMaxTries:3,IgnoreSandBoxSupport:"Ignore_SandBox_Support",IEUpgradeUrl:"https://office.microsoft.com/redir/HA102789344.aspx",OmexForceAnonymousParamName:"SKAV",OmexForceAnonymousParamValue:"274AE4CD-E50B-4342-970E-1E7F36C70037",EndPointInternalSuffix:"_internal",PreloadOfficeJsId:"OFFICEJSPRELOAD",PreloadOfficeJsUrl:"//appsforoffice.microsoft.com/preloading/preloadoffice.js",StringResourceFile:"osfruntime_strings.js"},function(e){var t=function(){function t(){}return t.init=function(){return e.OsfExtendedManifestCache.getAll().then((function(t){e.ShortcutTableManager.init(t)}))},t.getActionFromShortcutKey=function(t,n){if(n<1||n>255)throw i.OUtil.formatString(Strings.OfficeOM.L_InvalidParameters,n);return e.ShortcutTableManager.getShortcutInfo(t,n)},t}();e.ActionMetadataManager=t}(l||(l={})),function(e){var t=function(){var e=null;function t(){}return t.convertModifierKeyToNumber=function(n){var r=(n=n.trim()).toUpperCase();return t.modifierKeys[r]==e?1==r.length||t.keyCodes[r]?(s.RuntimeTelemetryHelper.LogExceptionTag("Error: Multiple virtual key",e,e,e),e):(s.RuntimeTelemetryHelper.LogExceptionTag("Error: Invalid modifier key",e,e,e),e):t.modifierKeys[r]},t.convertModifierKeys=function(e){for(var n=0,r=0;r<e.length;r++)n|=t.convertModifierKeyToNumber(e[r]);return n},t.convertStringToKeys=function(n){var r=n.split("+");if(r.length<2)return s.RuntimeTelemetryHelper.LogExceptionTag("Error: Invalid key combination",e,e,e),e;var o=r.splice(0,r.length-1),i=r[r.length-1];return{modifierKeys:t.convertModifierKeys(o),virtualKey:t.convertVirtualKeyToInt(i)}},t.convertVirtualKeyToInt=function(e){var n=(e=e.trim()).toUpperCase();return 1==n.length?n.charCodeAt(0):t.keyCodes[n]?t.keyCodes[n]:-1},t.getShortcutInfo=function(n,r){if(t.shortcutTable[r]==e)return e;var o=t.shortcutTable[r][n];return o==e?e:{addinId:o.addinId,actionId:o.actionId}},t.init=function(n){t.shortcutTable={};for(var r=0;r<n.length;r++){var o=n[r].extendedManifest.shortcuts;if(o){for(var i=n[r].addinId,a=0;a<o.length;a++){var c=o[a].key,u=t.convertStringToKeys(c),l={modifierKeys:u.modifierKeys,virtualKey:u.virtualKey,enabled:!1,actionId:o[a].id,addinId:i,usedByHost:!1};t.shortcutTable[u.virtualKey]==e&&(t.shortcutTable[u.virtualKey]={}),t.shortcutTable[u.virtualKey][u.modifierKeys]&&s.RuntimeTelemetryHelper.LogExceptionTag("Error: Duplicate key combination",e,e,0),t.shortcutTable[u.virtualKey][u.modifierKeys]=l}if("undefined"!=typeof Otel){var d={otelEvent:{eventName:"Office.Extensibility.Shortcuts.InstallationInfo",dataFields:[{name:"addinId",dataType:1,value:i},{name:"shortcutCount",dataType:2,value:o.length}],telemetryProperties:{ariaTenantToken:"db334b301e7b474db5e0f02f07c51a47-a1b5bc36-1bbe-482f-a64a-c2d9cb606706-7439",nexusTenantToken:1755}}};Otel.Telemetry.sendOtelEvent(d)}else s.RuntimeTelemetryHelper.LogCommonMessageTag("The Otel isn't aviable, couldn't call sendOtelEvent for logging the shortcuts telemetry",e,0)}}},t.shortcutTable={},t.keyCodes={ALT:18,BACKQUOTE:192,BACKSLASH:220,BACKSPACE:8,CAPSLOCK:20,COMMA:188,CTRL:17,DASH:189,DEL:46,DOWN:40,END:35,ENTER:13,EQUALSIGN:187,ESC:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,HOME:36,INS:45,LEFT:37,LEFTBRACKET:219,META:91,NUM0:48,NUM1:49,NUM2:50,NUM3:51,NUM4:52,NUM5:53,NUM6:54,NUM7:55,NUM8:56,NUM9:57,NUMLOCK:114,NUMPAD0:96,NUMPAD1:97,NUMPAD2:98,NUMPAD3:99,NUMPAD4:100,NUMPAD5:101,NUMPAD6:102,NUMPAD7:103,NUMPAD8:104,NUMPAD9:105,NUMPADDIVIDE:111,NUMPADDOT:110,NUMPADMINUS:109,NUMPADMULTIPLY:106,NUMPADPLUS:107,PAGEDOWN:34,PAGEUP:33,PAUSE:179,PERIOD:190,PRINTSCREEN:44,RIGHT:39,RIGHTBRACKET:221,SCROLLLOCK:145,SEMICOLON:186,SINGLEQUOTE:222,SLASH:191,SPACE:32,TAB:9,UP:38,SHIFT:16},t.modifierKeys={SHIFT:4,CTRL:8,CONTROL:8,ALT:32,COMMAND:256},t}();e.ShortcutTableManager=t}(l||(l={}));var a,s,c=this&&this.__extends||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);function r(){this.constructor=e}e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)};!function(e){!function(e){var t="ov:Control",n="ov:SourceLocation",r=!1,o="resid",i="ov:Description",a="ov:Title",s="bt:Image",u="ov:VersionOverrides",l="o:OfficeApp",d=null,f=function(e){this.name="AddinManifestError",this.message=this.name+": "+e},p=function(e){this.name="AddinInternalError",this.message=e};function m(e,t){if(e==d)throw new f(t)}var g=function(){function e(e){var t="bt:String",n=this;n.Images={},n.Urls={},n.LongStrings={},n.ShortStrings={};var r=e.manifest._xmlProcessor.selectSingleNode(l),o=e.selectSingleNode(r,[u,"ov:Resources"]);n.parseCollection(e,e.selectChildNodes(s,o,["bt:Images"]),n.Images),n.parseCollection(e,e.selectChildNodes("bt:Url",o,["bt:Urls"]),n.Urls),n.parseCollection(e,e.selectChildNodes(t,o,["bt:LongStrings"]),n.LongStrings),n.parseCollection(e,e.selectChildNodes(t,o,["bt:ShortStrings"]),n.ShortStrings)}return e.prototype.parseCollection=function(e,t,n){for(var r=t.length,o=0;o<r;o++){var i=t[o];n[i.getAttribute("id")]=e.parseLocaleAwareSettingsAndGetValue(i)}},e}();e.ManifestResourceManager=g;var h=function(){function e(e,t,n,r){var o=this;o.hostType=e,o.formFactor=t,o.entitlement=n,o.manifest=r,o.resources=new g(o)}return e.prototype.parseIdRequired=function(e){var t=e.getAttribute("id");return m(t,"Id required"),t},e.prototype.parseLabel=function(e){var t=this.manifest._xmlProcessor.selectSingleNode("ov:Label",e);return t!=d?this.getShortString(t):d},e.prototype.parseLabelRequired=function(e){var t=this.parseLabel(e);return m(t,"Label required"),t},e.prototype.parseRequiredSuperTip=function(e){var t=this.parseSuperTip(e);return m(t,"SuperTip required"),t},e.prototype.parseSuperTip=function(e){var t=this,n=d,r=t.manifest._xmlProcessor.selectSingleNode("ov:Supertip",e);if(r!=d){var o,s=r;m(r=t.manifest._xmlProcessor.selectSingleNode(a,s),"Title is necessary for SuperTip."),o=t.getShortString(r),m(r=t.manifest._xmlProcessor.selectSingleNode(i,s),"Description is necessary for SuperTip."),n={title:o,description:t.getLongString(r)}}return n},e.prototype.parseRequiredIcon=function(e){var t=this.parseIcon(e);return m(t,"Icon required"),t},e.prototype.parseIcon=function(e){var t=this.selectChildNodes(s,e,["ov:Icon"]),n=t.length;if(0==n)return d;for(var r={},o=0;o<n;o++){var i=t[o];r[i.getAttribute("size")]=this.getImageResource(i)}return r},e.prototype.parseChildControls=function(e,t,n){var r=this.manifest._xmlProcessor.selectNodes(e,t);return this.parseControls(r,n)},e.prototype.parseControls=function(e,t){for(var n=[],r=e.length,o=0;o<r;o++){var i=t(this,e[o]);m(i,"parser must return a control."),n.push(i)}return n},e.prototype.parseControlInGroup=function(t){var n,r=t.getAttribute(e.typeAttributeName);switch(r){case"Menu":n=new A;break;case"Button":n=new x(r);break;default:throw new f("Unsupported control type.")}return n.parse(this,t),n},e.prototype.parseMenuItem=function(e){var t=new E;return t.parse(this,e),t},e.prototype.parseLocaleAwareSettingsAndGetValue=function(e){var t=this,n={},r=e.getAttribute("DefaultValue");n[t.manifest._defaultLocale]=r,n[t.manifest._defaultLocale.toLocaleLowerCase()]=r;var o=t.manifest._xmlProcessor.selectNodes("bt:Override",e);if(o)for(var i=o.length,a=0;a<i;a++){var s=(e=o[a]).getAttribute("Locale"),c=e.getAttribute("Value");n[s]=c,n[s.toLocaleLowerCase()]=c}return t.manifest._getDefaultValue(n)},e.prototype.selectSingleNode=function(e,t){if(t==d)return e;for(var n=0;n<t.length&&(e=this.manifest._xmlProcessor.selectSingleNode(t[n],e))!=d;n++);return e},e.prototype.selectChildNodes=function(e,t,n){return(t=this.selectSingleNode(t,n))==d?[]:this.manifest._xmlProcessor.selectNodes(e,t)},e.prototype.getResourceByNode=function(e,t){var n=t.getAttribute(o),r=e[n];return m(r,"resid: "+n+" not found"),r},e.prototype.getImageResource=function(e){return this.getResourceByNode(this.resources.Images,e)},e.prototype.getUrlResource=function(e){return this.getResourceByNode(this.resources.Urls,e)},e.prototype.getLongString=function(e){return this.getResourceByNode(this.resources.LongStrings,e)},e.prototype.getShortString=function(e){return this.getResourceByNode(this.resources.ShortStrings,e)},e.typeAttributeName="xsi:type",e}();e.ParsingContext=h;var v=function(){function e(){}return e.buildControls=function(e,t){for(var n=t.length,r=0;r<n;r++){t[r].apply(e)}},e}(),y=function(e,t,n){var o=this;void 0===n&&(n=r),o.multipleCustomTabsEnabled=r,o.functionFile=e,o.builder=t,o.multipleCustomTabsEnabled=n},b=function(){function e(){}return e.prototype.parse=function(e,t){var n=e.manifest._xmlProcessor,r=n.selectSingleNode(a,t);m(r,"Title is necessary for GetStarted."),this.title=e.getShortString(r);var o=n.selectSingleNode(i,t);m(o,"Description is necessary for GetStarted."),this.description=e.getLongString(o);var s=n.selectSingleNode("ov:LearnMoreUrl",t);this.learnMoreUrl=e.getUrlResource(s)},e}(),_=function(){function e(e){this.type=e}return e.prototype.buildAction=function(){},e.prototype.parse=function(){},e}(),S=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.buildAction=function(e){return e.actionBuilder.buildShowTaskpane(this.sourceLocation,this.title,this.taskpaneId)},t.prototype.parse=function(t,n){var r=this;e.prototype.parse.call(r,t,n);var i=t.manifest._xmlProcessor.selectSingleNode("ov:TaskpaneId",n);i!=d&&(r.taskpaneId=i.firstChild.nodeValue),(i=t.manifest._xmlProcessor.selectSingleNode("ov:SourceLocation ",n))!=d&&(r.sourceLocationResid=i.getAttribute(o)),(i=t.manifest._xmlProcessor.selectSingleNode(a,n))!=d&&(r.title=t.getShortString(i))},t}(function(e){function t(){e.apply(this,arguments),this.title=d}return c(t,e),t.prototype.parse=function(e,t){var r=e.manifest._xmlProcessor.selectSingleNode(n,t);m(r,"SourceLocation is necessary for ShowTaskpane action"),this.sourceLocation=e.getUrlResource(r),e.manifest.addManifestUrl(this.sourceLocation)},t}(_)),C=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.buildAction=function(e){return m(e.functionFile,"Function file source url is necessary for ExecuteFunctionAction."),e.actionBuilder.buildCallFunction(e.functionFile,this.functionName,this.controlId)},t.prototype.parse=function(e,t){var n=e.manifest._xmlProcessor.selectSingleNode("ov:FunctionName",t);m(n,"FunctionName is necessary for ExecuteFunctionAction."),this.functionName=e.manifest._xmlProcessor.getNodeValue(n)},t}(_),O=function(){function e(){}return e.prototype.parse=function(e,t){this.id=e.parseIdRequired(t),this.label=e.parseLabelRequired(t)},e}(),A=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.apply=function(e){e.controlBuilder.startBuildMenu(this),v.buildControls(e,this.children),e.controlBuilder.endBuildMenu()},t.prototype.parse=function(t,n){var r=this;e.prototype.parse.call(r,t,n),r.icon=t.parseRequiredIcon(n),r.superTip=t.parseRequiredSuperTip(n);var o=t.selectChildNodes("ov:Item",n,["ov:Items"]);r.children=t.parseControls(o,(function(e,t){return e.parseMenuItem(t)}))},t}(O);e.MenuControl=A;var I=function(e){function t(t){e.call(this),this.enabled=!0,this.controlType=t}return c(t,e),t.prototype.apply=function(e){var t=this,n=t.action.buildAction(e),r={id:t.id,label:t.label,icon:t.icon,superTip:t.superTip,actionType:t.actionType,action:n,enabled:t.enabled};t.applyControl(e,r)},t.prototype.parse=function(t,n){var r=this;e.prototype.parse.call(r,t,n),r.icon=r.parseIcon(t,n),r.superTip=t.parseRequiredSuperTip(n);var o=t.manifest._xmlProcessor.selectSingleNode("ov:Action",n);m(o,"Action is necessary for itemControl.");var i,a=o.getAttribute(h.typeAttributeName);switch(a){case"ShowTaskpane":i=new S(a);break;case"ExecuteFunction":(i=new C(a)).controlId=r.id;break;default:throw new f("Unsupported action type.")}i.parse(t,o),r.actionType=a,r.action=i;var s=t.manifest._xmlProcessor.selectSingleNode("ov:Enabled",n);s!=d&&(r.enabled=t.manifest._parseBooleanNode(s))},t.prototype.applyControl=function(){throw new p("Not implemented method applyControl for ItemControl.")},t.prototype.parseIcon=function(e,t){return e.parseIcon(t)},t}(O),x=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.applyControl=function(e,t){e.controlBuilder.addButton(t)},t.prototype.parseIcon=function(e,t){return e.parseRequiredIcon(t)},t}(I),E=function(e){function t(){e.call(this,"MenuItem")}return c(t,e),t.prototype.applyControl=function(e,t){e.controlBuilder.addMenuItem(t)},t}(I),T=function(){function e(e){var t=this;t.label=d,t.isOfficeTab=r,t.visible=!0,t.children=[],t.tabType="default",t.isOfficeTab=e}return e.prototype.apply=function(e){e.builder.ribbonBuilder.startBuildTab(this);for(var t=this.children.length,n=0;n<t;n++){this.children[n].apply(e)}e.builder.ribbonBuilder.endBuildTab()},e.prototype.parse=function(e,t){var n=this;n.id=e.parseIdRequired(t),n.isOfficeTab||(n.label=e.parseLabelRequired(t)),n.children=e.parseChildControls("ov:Group",t,(function(e,t){var n=new P;return n.parse(e,t),n}))},e}(),P=function(e){function n(){e.apply(this,arguments)}return c(n,e),n.prototype.parse=function(n,r){e.prototype.parse.call(this,n,r),this.icon=n.parseRequiredIcon(r),this.children=n.parseChildControls(t,r,(function(e,t){return e.parseControlInGroup(t)}))},n.prototype.apply=function(e){e.builder.ribbonBuilder.startBuildGroup(this),v.buildControls({functionFile:e.functionFile,actionBuilder:e.builder.actionBuilder,controlBuilder:e.builder.ribbonBuilder},this.children),e.builder.ribbonBuilder.endBuildGroup()},n}(O),w=function(){function e(e){this.type=e,this.tabs=[]}return e.prototype.apply=function(e){if(this.type==e.builder.commandSurface)for(var t=this.tabs.length,n=0;n<t;n++){if(this.tabs[n].apply(e),!e.multipleCustomTabsEnabled)break}},e.prototype.parse=function(e,t){var n=e.manifest._xmlProcessor.selectSingleNode("ov:OfficeTab",t);n!=d&&((s=new T(!0)).parse(e,n),this.tabs.push(s));var o=e.manifest._xmlProcessor.selectNodes("ov:CustomTab",t);if(o)for(var i=o.length,a=0;a<i;a++){var s;if((n=o[a])!=d)(s=new T(r)).parse(e,n),this.tabs.push(s)}},e}(),M=function(){function e(){}return e.prototype.parse=function(e,n){this.id=e.parseIdRequired(n),this.children=e.parseChildControls(t,n,(function(e,t){return e.parseControlInGroup(t)}))},e.prototype.apply=function(e){e.controlBuilder.startBuildMenu({id:this.id,label:d,superTip:d}),v.buildControls(e,this.children),e.controlBuilder.endBuildMenu()},e}(),R=function(){function e(e){this.type=e}return e.prototype.apply=function(e){this.type==e.builder.commandSurface&&v.buildControls({functionFile:e.functionFile,actionBuilder:e.builder.actionBuilder,controlBuilder:e.builder.contextMenuBuilder},this.children)},e.prototype.parse=function(e,t){this.children=e.parseChildControls("ov:OfficeMenu",t,(function(e,t){var n=new M;return n.parse(e,t),n}))},e}(),j=function(){function e(e){this.type=e}return e.prototype.apply=function(){},e.prototype.parse=function(e,t){var n=this,r=e.manifest._xmlProcessor.selectSingleNode("ov:Namespace",t);r&&(n.namespaceResId=r.getAttribute(o));var i=e.manifest._xmlProcessor.selectSingleNode("ov:Script",t);if(i&&(n.scriptResId=n._parseSourceLocationResId(e,i)),!n.scriptResId)throw new f("Missing required <Script> element under element <ExtensionPoint xsi:type='CustomFunctions'>.");var a=e.manifest._xmlProcessor.selectSingleNode("ov:Page",t);if(a&&(n.pageResId=n._parseSourceLocationResId(e,a)),!n.pageResId)throw new f("Missing required <Page> element under element <ExtensionPoint xsi:type='CustomFunctions'>.");var s=e.manifest._xmlProcessor.selectSingleNode("ov:Metadata",t);if(s&&(n.metadataResId=n._parseSourceLocationResId(e,s)),!n.metadataResId)throw new f("Missing required <Metadata> element under element <ExtensionPoint xsi:type='CustomFunctions'>.")},e.prototype._parseSourceLocationResId=function(e,t){var r=e.manifest._xmlProcessor.selectSingleNode(n,t);if(r)return r.getAttribute(o)},e}();e.CustomFunctionsExtensionPoint=j;var k=function(){function e(){var e=this;e.getStartedNode=d,e.functionFile=d,e.functionFileResid=d,e.cacheableUrls=[],e.ExtensionPoints=[]}return e.prototype.cacheableResources=function(){return this.cacheableUrls},e.prototype.apply=function(e,t,n){var o=this;void 0===n&&(n=r);try{e.startApplyAddin({entitlement:o.extensionEntitlement,manifest:o.extensionManifest,startedNode:o.getStartedNode,overrides:{type:o.type,description:o.description}});for(var i=new y(o.functionFile,e,n),a=o.ExtensionPoints.length,s=0;s<a;s++){o.ExtensionPoints[s].apply(i)}e.endApplyAddin()}catch(e){throw e instanceof f&&t.setErrorMessageForAddin(o.extensionEntitlement.assetId,Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message),e}},e.prototype.parse=function(e,t){var n=this;n.type=t.getAttribute(h.typeAttributeName);var r=e.manifest._xmlProcessor.selectSingleNode(i,t);r!=d&&(n.description=e.getLongString(r));for(var a=e.selectChildNodes("ov:Host",t,["ov:Hosts"]),s=d,c=a.length,u=0;u<c;u++){var l=a[u];if(l.getAttribute(h.typeAttributeName)==e.hostType){(s=e.manifest._xmlProcessor.selectSingleNode("ov:"+e.formFactor,l))==d&&(s=e.manifest._xmlProcessor.selectSingleNode("ov:AllFormFactors",l));break}}var p=e.manifest._xmlProcessor.selectSingleNode("ov:GetStarted",s);p!=d&&(n.getStartedNode=new b,n.getStartedNode.parse(e,p)),(r=e.manifest._xmlProcessor.selectSingleNode("ov:FunctionFile",s))!=d&&(n.functionFileResid=r.getAttribute(o),n.functionFile=e.getUrlResource(r),e.manifest.addManifestUrl(n.functionFile));var m=e.manifest._xmlProcessor.selectNodes("ov:ExtensionPoint",s);c=m.length;for(u=0;u<c;u++){var g,v=m[u],y=v.getAttribute(h.typeAttributeName);switch(y){case"Events":throw"Not Implemented";case"PrimaryCommandSurface":g=new w(y);break;case"ContextMenu":g=new R(y);break;case"CustomFunctions":g=new j(y);break;default:throw new f("Unsupported extension type.")}g.parse(e,v),n.ExtensionPoints.push(g)}var _=e.resources.Images;for(var S in _)n.cacheableUrls.push(_[S]);n.extensionEntitlement=e.entitlement,n.extensionManifest=e.manifest},e}();e.VersionOverrides=k;var N=function(){function e(){}return e.prototype.cacheableResources=function(){return[]},e.prototype.apply=function(){},e}(),D=function(){function e(e,t){this.hostType=e,this.formFactor=t}return e.prototype.parseExtensions=function(e,t,n){try{var r=t._xmlProcessor.selectSingleNode(l),o=t._xmlProcessor.selectSingleNode(u,r);if(o==d)return new N;var i=new k;return i.parse(new h(this.hostType,this.formFactor,e,t),o),i}catch(t){throw t instanceof f&&n.setErrorMessageForAddin(e.assetId,Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message),t}},e}();e.AddinCommandsManifestParser=D}(e.Parser||(e.Parser={}))}(l||(l={})),function(e){!function(e){var t,n="Button",r="MenuItem",o=!1,i="ShowTaskpane",a=null;!function(e){var t="LongString",n="ShortString";e[e.Image=0]="Image",e[e.Url=1]="Url",e[e[n]=2]=n,e[e[t]=3]=t}(t||(t={}));var s=function(e){this.name="AddinManifestError",this.message=this.name+": "+e};function u(e,t){if(void 0!==typeof e&&e===a)throw new s(t)}function l(e,t){if(void 0!==typeof e&&e===a&&""===e)throw new s(t)}var d=function(){function e(e,t,n,r,o){var i=this;i.hostType=e,i.formFactor=t,i.entitlement=n,i.manifest=r,i.ribbonData=o,i.parseResources(o.resources),u(i.resources,"Resources is required"),i.actions=i.parseActions(o.actions),u(i.actions,"actions is required")}return e.prototype.getResource=function(e,n){var r=this;l(e=e||a,"Resource Id required");var o,i=a;switch(n){case t.Image:o=r.resources.images;break;case t.Url:o=r.resources.urls;break;case t.ShortString:o=r.resources.shortStrings;break;case t.LongString:o=r.resources.longStrings;break;default:throw new s("Unknown resource type")}if(!o[e])throw new s("Invalid resource ID");return u(i=o[e],"Resource cannot be null"),i},e.prototype.parseResources=function(e){var t=this;t.resources=new f,t.resources.images=t.convertToDictionary(e.images),t.resources.urls=t.convertToDictionary(e.urls),t.resources.shortStrings=t.convertToDictionary(e.shortStrings),t.resources.longStrings=t.convertToDictionary(e.longStrings)},e.prototype.parseActions=function(e){for(var t={},n=0;n<e.length;n++){var r=e[n];if(r.id&&r.type){var o;switch(r.type){case i:(o=new m).parse(this,r);break;case"ExecuteFunction":(o=new g).parse(this,r);break;default:throw new s("Unknown action type")}t[r.id]=o}}return t},e.prototype.convertToDictionary=function(e){for(var t={},n=0;n<e.length;n++){var r=e[n];t[r.id]=r.value}return t},e.prototype.parseIdRequired=function(e){var t=e.id?e.id:a;return l(t,"Id required"),t},e.prototype.parseLabelRequired=function(e){if(!e.labelResourceId)throw new s("Label required.");var t=this.parseLabel(e);return u(t,"Label required"),t},e.prototype.parseLabel=function(e){var n="";try{n=this.getResource(e.labelResourceId,t.ShortString)}catch(e){}return n},e.prototype.parseSuperTipRequired=function(e){if(!e.superTip)throw new s("Supertip required");return this.parseSuperTip(e)},e.prototype.parseSuperTip=function(e){var n={title:"",description:""};return e.superTip&&(n.title=this.getResource(e.superTip.titleResourceId,t.ShortString),n.description=this.getResource(e.superTip.descriptionResourceId,t.LongString)),n},e.prototype.parseIconRequired=function(e){if(e.icon)return this.parseIcon(e);throw new s("Icon required")},e.prototype.parseIcon=function(e){var n={};if(e.icon)for(var r=0,o=e.icon;r<o.length;r++){var i=o[r];i.size&&i.resourceId&&(n[i.size]=this.getResource(i.resourceId,t.Image))}return n},e.typeAttributeName="xsi:type",e}();e.ParsingContext=d;var f=function(){},p=function(){function e(){}return e.prototype.buildAction=function(){},e.prototype.parse=function(e,t){l(t.type,"Action type required."),this.type=t.type},e}(),m=function(e){function n(){var t=this;e.apply(t,arguments),t.type=i,t.title=a,t.supportsPinning=o}return c(n,e),n.prototype.buildAction=function(e){return e.buildShowTaskpane(this.sourceLocation,this.title,this.taskpaneId)},n.prototype.parse=function(n,r){var o=this;e.prototype.parse.call(o,n,r),l(r.taskpaneId,"Taskpane ID required"),o.taskpaneId=r.taskpaneId,l(r.sourceLocationResourceId,"Source Location required"),o.sourceLocation=n.getResource(r.sourceLocationResourceId,t.Url),u(r.titleResourceId,"Title required"),o.title=n.getResource(r.titleResourceId,t.ShortString),r.supportPinning||(o.supportsPinning=r.supportPinning)},n}(p),g=function(e){function n(){e.apply(this,arguments)}return c(n,e),n.prototype.buildAction=function(e){return e.buildCallFunction(this.functionFile,this.functionName,this.controlId)},n.prototype.parse=function(n,r){e.prototype.parse.call(this,n,r),this.functionFile=n.getResource(r.functionFile,t.Url),this.functionName=r.functionName},n}(p),h=function(){function e(){}return e.prototype.parse=function(e,t){this.id=e.parseIdRequired(t),this.label=e.parseLabelRequired(t)},e}(),v=function(e){function t(){e.call(this),this.enabled=!0}return c(t,e),t.prototype.apply=function(){},t.prototype.parse=function(t,i){var a=this;if(e.prototype.parse.call(a,t,i),a.icon=t.parseIconRequired(i),a.superTip=t.parseSuperTipRequired(i),a.enabled=!!i.enabled||o,i.type&&(a.controlType=i.type,i.type==r||i.type==n)){if(!(i.actionId&&i.actionId in t.actions))throw new s("Action is required");a.actionParsed=t.actions[i.actionId],a.actionType=t.actions[i.actionId].type,a.actionParsed.controlId=a.id}},t}(h),y=function(e){function t(){e.call(this),this.children=[],this.controlType="Menu"}return c(t,e),t.prototype.apply=function(t,n){e.prototype.apply.call(this,t,n),t.ribbonBuilder.startBuildMenu(this);for(var r=0,o=this.children;r<o.length;r++){o[r].apply(t,n)}t.ribbonBuilder.endBuildMenu()},t.prototype.parse=function(t,n){if(e.prototype.parse.call(this,t,n),!(n.items&&n.items instanceof Array))throw new s("Menu items required.");for(var r=0,o=n.items;r<o.length;r++){var i=o[r],a=new b;a.parse(t,i),this.children.push(a)}},t}(v);e.Menu=y;var b=function(e){function t(){e.call(this),this.controlType=r}return c(t,e),t.prototype.apply=function(t,n){var r=this;e.prototype.apply.call(r,t,n);var o=r.actionParsed.buildAction(t.actionBuilder),i={id:r.id,label:r.label,icon:r.icon,superTip:r.superTip,actionType:r.actionType,action:o,enabled:r.enabled};t.ribbonBuilder.addMenuItem(i)},t}(v),_=function(e){function t(){e.call(this),this.controlType=n}return c(t,e),t.prototype.apply=function(t,n){var r=this;e.prototype.apply.call(r,t,n);var o=r.actionParsed.buildAction(t.actionBuilder),i={id:r.id,label:r.label,icon:r.icon,superTip:r.superTip,actionType:r.actionType,action:o,enabled:r.enabled};t.ribbonBuilder.addButton(i)},t}(v),S=function(e){function t(){e.apply(this,arguments),this.children=[]}return c(t,e),t.prototype.parse=function(t,r){var o=this;e.prototype.parse.call(o,t,r),o.icon=t.parseIconRequired(r);for(var i=0,a=r.controls;i<a.length;i++){var c=a[i];switch(l(c.type,"Control type required."),c.type){case n:var u=new _;u.parse(t,c),o.children.push(u);break;case"Menu":var d=new y;d.parse(t,c),o.children.push(d);break;default:throw new s("Unknown control type.")}}},t.prototype.apply=function(e,t){e.ribbonBuilder.startBuildGroup(this);for(var n=0,r=this.children;n<r.length;n++){r[n].apply(e,t)}e.ribbonBuilder.endBuildGroup()},t}(h),C=function(){function e(){var e=this;e.label=a,e.isOfficeTab=o,e.visible=!0,e.children=[],e.tabType="contextual"}return e.prototype.apply=function(e,t){e.ribbonBuilder.startBuildTab(this);for(var n=0,r=this.children;n<r.length;n++){r[n].apply(e,t)}e.ribbonBuilder.endBuildTab()},e.prototype.parse=function(e,t){var n=this;n.id=t.id,n.visible=o,n.label=e.parseLabelRequired(t);for(var r=0,i=t.groups;r<i.length;r++){var a=i[r],s=new S;s.parse(e,a),n.children.push(s)}},e}(),O=function(){function e(e,t,n){this.entitlement=t,this.manifest=n,this.tabs=e}return e.prototype.cacheableResources=function(){return[]},e.prototype.apply=function(e,t){var n={entitlement:this.entitlement,manifest:this.manifest,overrides:a,startedNode:a};e.startApplyAddin(n);for(var r=0,o=this.tabs;r<o.length;r++){o[r].apply(e,t)}e.endApplyAddin()},e}(),A=function(){function e(e,t){this.hostType=e,this.formFactor=t,this.tabs=[]}return e.prototype.parse=function(e,t,n,r){var o=[];try{var i=new d(this.hostType,this.formFactor,e,t,n);i.parseActions(n.actions);for(var a=0,c=n.tabs;a<c.length;a++){var u=c[a],l=new C;l.parse(i,u),o.push(l)}}catch(t){throw t instanceof s&&r.setErrorMessageForAddin(e.assetId,Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message),t}return new O(o,e,t)},e}();e.AddinCommandsJsonParser=A}(e.JsonParser||(e.JsonParser={}))}(l||(l={})),function(e){var t=function(){function e(){}return e.createManifestForAddinAction=function(e,t,n,r){var o=null,a=new i.Manifest.ExtensionSettings,s=(i.FormFactor.Default,{}),c=e._UILocale.toLocaleLowerCase();s[c]=n,a._defaultHeight=o,a._defaultWidth=o,a._sourceLocations={},a._sourceLocations[c]=t;var u=e;return new i.Manifest.Manifest((function(e){e._xmlProcessor=u._xmlProcessor,e._displayNames=n!=o?s:u._displayNames,e._iconUrls=u._iconUrls,e._extensionSettings={formFactor:a},e._highResolutionIconUrls=u._highResolutionIconUrls,e._target=u._target,e._id=r!=o?r:u._id,e._version=u._version,e._providerName=u._providerName,e._idIssuer=u._idIssuer,e._alternateId=u._alternateId,e._defaultLocale=u._defaultLocale,e._signature=u._signature,e._capabilities=u._capabilities,e._hosts=u._hosts,e._descriptions=u._descriptions,e._appDomains=u._appDomains,e._permissions=u._permissions,e._requirements=u._requirements,e._webApplicationResource=u._webApplicationResource,e._webApplicationId=u._webApplicationId,e._webApplicationMsaId=u._webApplicationMsaId,e._webApplicationScopes=u._webApplicationScopes,e._webApplicationAuthorizations=u._webApplicationAuthorizations,e._ribbonExtensionControls=u._ribbonExtensionControls,e._equivalentAddins=u._equivalentAddins,e._versionOverrides=u._versionOverrides}),u._UILocale)},e.cacheManifestForAction=function(e,t,n){i.OsfManifestManager.cacheManifest(t,n,e)},e.purgeManifestForAction=function(e,t){i.OsfManifestManager.purgeManifest(e,t)},e}();e.AddinCommandsManifestManager=t}(l||(l={})),function(e){var t="##UILessContainer##",n=null;e.AddinActionContextMap={},e.AutoShowTaskPaneControlIdMap={};var r={};!function(e){var t="ExclusiveForNew",n="ExclusiveForCur";e[e.Default=1]="Default",e[e[n]=2]=n,e[e[t]=3]=t}(e.CommandInvokeMode||(e.CommandInvokeMode={}));var o,a=e.CommandInvokeMode;!function(e){var t="ooeOperationNotSupported",n="ooeSuccess",r="ooeTimeout";e[e[r]=-1]=r,e[e[n]=0]=n,e[e[t]=5e3]=t}(o||(o={}));var s=function(){function a(e,t,n){this.contextProvider=e,this.manifest=n,this.entitlement=t}return a.prototype.buildShowTaskpane=function(e,t,n){return this.CreateManifestAndActivationContextForTaskpaneCommand(e,t,n)},a.prototype.buildCallFunction=function(e,t,n){return this.CreateManifestAndActivationContextForUILessCommand(e,t,n)},a.prototype.CreateManifestAndActivationContextForTaskpaneCommand=function(e,t,i){var a=function(e,t){t==o.ooeSuccess&&i!=n&&(r[i]=e)},s=function(e,t){var o=r[e];if(o==n)return!1;var i=t.getOsfControl(o);return i!=n&&(i._sharedRuntimeId==n&&i._refresh(),!0)};return this.CreateManifestAndActivationContext(e,t,i,(function(e,t,r,o){i!=n&&s(i,t),e.showTaskpane(r,o,a)}))},a.prototype.CreateManifestAndActivationContext=function(t,r,o,a){var s=this,c=e.AddinCommandsManifestManager.createManifestForAddinAction(this.manifest,t,r,n);return function(t){var r=s.contextProvider.createActionContext(t,(function(r,u){var l=s.entitlement.assetId,d={assetId:l+(o||t),appVersion:s.entitlement.appVersion,storeId:s.entitlement.storeId,storeType:i.StoreType.InMemory,targetType:i.OsfControlTarget.TaskPane};c._inMemoryEToken=s.entitlement.eToken;var f=d.assetId,p=u==n?i.ManifestHostType.Workbook:i.getManifestHostType(u._hostType),m=c.getSharedRuntimeForTaskpane(p,o||t);m!=n&&m.Resid!=n&&m.Resid.length>0&&(f=i.OsfManifestManager.getSharedRuntimeManifestCacheKey(l,m.Resid)),e.AddinCommandsManifestManager.cacheManifestForAction(c,f,d.appVersion),a(r,u,d,c)}));e.AddinActionContextMap[t]=r,e.AutoShowTaskPaneControlIdMap[s.entitlement.assetId]==n&&"Office.AutoShowTaskpaneWithDocument"==o&&(e.AutoShowTaskPaneControlIdMap[s.entitlement.assetId]=t)}},a.prototype.CreateManifestAndActivationContextForUILessCommand=function(r,a,s){var c=this,u=function(e,t){if(t==o.ooeSuccess){var n={source:{id:s}};d.invokeAppCommand(e,a,n,(function(){}))}},l=e.AddinCommandsManifestManager.createManifestForAddinAction(this.manifest,r,n,n);return function(r){var a=c.contextProvider.createActionContext(r,(function(r,a){var s=c.entitlement.assetId,f={assetId:s+t,appVersion:c.entitlement.appVersion,storeId:c.entitlement.storeId,storeType:i.StoreType.InMemory,targetType:i.OsfControlTarget.TaskPane},p=f.assetId,m=a==n?i.ManifestHostType.Workbook:i.getManifestHostType(a._hostType),g=l.getSharedRuntimeForAppCmdsExecuteFunction(m);g!=n&&g.Resid!=n&&g.Resid.length>0&&(p=i.OsfManifestManager.getSharedRuntimeManifestCacheKey(s,g.Resid)),e.AddinCommandsManifestManager.cacheManifestForAction(l,p,f.appVersion),r.createUILessSandbox(f,l,(function(e,t){if(t==o.ooeSuccess)d.ensureOsfHostEntry(e,r);u(e,t)}))}));e.AddinActionContextMap[r]=a}},a}(),c=function(){function n(e,t){this.contextProvider=e,this.entitlement=t}return n.prototype.buildShowTaskpane=function(){var t=this;return function(n){delete e.AddinActionContextMap[n],e.AddinCommandsManifestManager.purgeManifestForAction(t.entitlement.assetId+n,t.entitlement.appVersion)}},n.prototype.buildCallFunction=function(){var n=this;return function(r){delete e.AddinActionContextMap[r],e.AddinCommandsManifestManager.purgeManifestForAction(n.entitlement.assetId+t,n.entitlement.appVersion)}},n}(),u=function(){function t(){}return t.createActionBuilder=function(e,t,n){return new s(e,t,n)},t.createDeleterActionBuilder=function(e,t){return new c(e,t)},t.bindAction=function(e,t){t(e)},t.retrieveActionContext=function(t){return e.AddinActionContextMap[t]},t.retrieveAutoShowTaskPaneControlIdMap=function(){return e.AutoShowTaskPaneControlIdMap},t}();e.DefaultControlActionBinder=u;var l=function(){function e(){this.invocationQueue={}}return e.prototype.invokeAppCommand=function(t,r,o,s,c){var u=this,l={dispid:i.DDA.EventDispId.dispidAppCommandInvokedEvent,controlId:u.osfControlId};l[0]=t,l[1]=r,l[2]=JSON.stringify(o),c=c||e.defaultTimeout;var d=o&&o.commandMode?o.commandMode:a.Default,f={args:l,onComplete:s,timeout:c,timeoutTimer:n},p=u.invocationQueue[r];p==n&&(p=[],u.invocationQueue[r]=p),!(d==a.ExclusiveForCur&&p.length>0)&&!(d==a.ExclusiveForNew&&p.length>1)&&p.push(f),1==p.length&&u.trySendInvocation(f)},e.prototype.invocationCompleted=function(e,t,r){var o=this,i=o;for(var a in o.invocationQueue){var s=o.invocationQueue[a],c=s[0];if(e==c.args[0]){if(s.length>1){s.splice(0,1);var u=s[0];window.setTimeout((function(){i.trySendInvocation(u)}),0)}else delete o.invocationQueue[a];return c.timeoutTimer!=n&&(window.clearTimeout(c.timeoutTimer),c.timeoutTimer=n),void c.onComplete(t,r)}}},e.prototype.sendInvocations=function(e){var t=this;if(t.eventHandler=e,e!=n)for(var r in t.invocationQueue){var o=t.invocationQueue[r][0];t.sendInvocation(e,o)}},e.prototype.trySendInvocation=function(e){var t=this.eventHandler;t!=n&&this.sendInvocation(t,e)},e.prototype.sendInvocation=function(e,t){var n=this,r=t.args;e(r),t.timeoutTimer=window.setTimeout((function(){n.invocationTimeout(r[0])}),t.timeout)},e.prototype.invocationTimeout=function(e){this.invocationCompleted(e,o.ooeTimeout,n)},e.prototype.disposeHost=function(){var e=this;for(var t in e.invocationQueue)return;e.host.disposeHost(e.osfControlId),e.onDisposed!=n&&e.onDisposed(e)},e.defaultTimeout=3e5,e}(),d=function(){var e="targetId",t="controlId",r="eventDispId";function a(){}return a.registerEvent=function(n,o,i){a.registerEventInternal(i[r],i[t],i[e],n,(function(e){o&&o(0==e)}))},a.unregisterEvent=function(n,o,i){a.unregisterEventInternal(i[r],i[t],i[e],n,(function(e){o&&o(0==e)}))},a.invokeAppCommand=function(e,t,n,r){var o=a.getOrCreateOsfHostEntry(e),i=a.getNextAppCommandId();o.invokeAppCommand(i,t,n,r)},a.invocationCompleted=function(e,t){var r=a.getOrCreateOsfHostEntry(e),o=t[0],i=t[1],s=t[2]?JSON.parse(t[2]):n;r.invocationCompleted(o,i,s)},a.ensureOsfHostEntry=function(e,t){var r=a.getOrCreateOsfHostEntry(e);return r.host==n&&(r.host=t),r},a.getNextAppCommandId=function(){return"AppCmd"+a._nextAppCommandId++},a.getOrCreateOsfHostEntry=function(e){var t=a._invocationQueues[e];return t==n&&((t=new l).osfControlId=e,t.onDisposed=function(e){delete a._invocationQueues[e.osfControlId]},a._invocationQueues[e]=t),t},a.registerEventInternal=function(e,t,n,r,s){switch(e){case i.DDA.EventDispId.dispidAppCommandInvokedEvent:var c=a.getOrCreateOsfHostEntry(t);return s(o.ooeSuccess),void c.sendInvocations(r)}s(o.ooeOperationNotSupported)},a.unregisterEventInternal=function(e,t,r,s,c){switch(e){case i.DDA.EventDispId.dispidAppCommandInvokedEvent:var u=a.getOrCreateOsfHostEntry(t);return u.eventHandler==s&&(u.eventHandler=n),void c(o.ooeSuccess)}c(o.ooeOperationNotSupported)},a._nextAppCommandId=0,a._invocationQueues={},a}();e.AddinCommandsRuntimeManager=d}(l||(l={})),i.ShowWindowDialogParameterKeys={Url:"url",Width:"width",Height:"height",DisplayInIframe:"displayInIframe",HideTitle:"hideTitle",UseDeviceIndependentPixels:"useDeviceIndependentPixels",PromptBeforeOpen:"promptBeforeOpen",EnforceAppDomain:"enforceAppDomain",UrlNoHostInfo:"urlNoHostInfo"},i.HostThemeButtonStyleKeys={ButtonBorderColor:"buttonBorderColor",ButtonBackgroundColor:"buttonBackgroundColor"},i.OmexPageParameterKeys={AppName:"client",AppVersion:"cv",AppUILocale:"ui",AppDomain:"appDomain",StoreLocator:"rs",AssetId:"assetid",NotificationType:"notificationType",AppCorrelationId:"corr",AuthType:"authType",AppId:"appid",Scopes:"scopes"},i.AuthType={Anonymous:0,MSA:1,OrgId:2,ADAL:3},i.OmexMessageKeys={MessageType:"messageType",MessageValue:"messageValue"},i.OmexRemoveAddinMessageKeys={RemoveAddinResultCode:"resultCode",RemoveAddinResultValue:"resultValue"},i.OmexRemoveAddinResultCode={Success:0,ClientError:400,ServerError:500,UnknownError:600},function(e){!function(e){var t="undefined",n="^https://[a-z0-9-]+.(officeapps.live|officeapps-df.live|partner.officewebapps).com/";function r(e){if(typeof JSON!==t)try{return JSON.stringify(e)}catch(e){}return""}function a(){try{var e=window.navigator.userAgent;return e.indexOf("MSIE ")>-1||e.indexOf("Trident/")>-1||e.indexOf("Edge/")>-1}catch(e){return s("Error happens in isInternetExplorer.",e),!1}}function s(e,t){o.msAjaxDebug.trace(e+" Exception details: "+r(t))}e.parseAppContextFromWindowName=function(e,t){return i.OUtil.parseInfoFromWindowName(e,t,i.WindowNameItemKeys.AppContext)},e.serializeObjectToString=r,e.isHostTrusted=function(){return new RegExp(n).test(i.getClientEndPoint()._targetUrl.toLowerCase())},e.addHostInfoAsQueryParam=function(e,t){if(!e)return null;var n,r="#",o=(e=e.trim()||"").split(r),i=o.shift(),a=o.join(r),s=i.split("?");return s.length>1?n=i+"&_host_Info="+t:s.length>0&&(n=i+"?_host_Info="+t),a?[n,r,a].join(""):n},e.getDomainForUrl=function(e){if(!e)return null;var t=document.createElement("a");return t.href=e,t.protocol+"//"+t.host},e.shouldUseLocalStorageToPassMessage=function(){try{for(var e=["Windows NT 6.1","Windows NT 6.2","Windows NT 6.3","Windows NT 10.0"],t=window.navigator.userAgent,n=0,r=e.length;n<r;n++)if(t.indexOf(e[n])>-1)return a();return!1}catch(e){return s("Error happens in shouldUseLocalStorageToPassMessage.",e),!1}},e.isInternetExplorer=a,e.removeMatchesFromLocalStorage=function(e){for(var t=i.OUtil.getLocalStorage(),n=t.getKeysWithPrefix(""),r=0,o=n.length;r<o;r++)for(var a=n[r],s=0,c=e.length;s<c;s++)if(e[s].test(a)){t.removeItem(a);break}},e.logExceptionToBrowserConsole=s,e.isTeamsWebView=function(){var e=navigator.userAgent;return/Teams\/((?:(\d+)\.)?(?:(\d+)\.)?(?:(\d+)\.\d+)).* Electron\/((?:(\d+)\.)?(?:(\d+)\.)?(?:(\d+)\.\d+))/.test(e)},e.getHostSecure=function(e){if(typeof e!==t&&e){var n,r="https:";try{var o=new URL(e);if(o&&(n=o.host),o.protocol!==r)return}catch(t){var i=document.createElement("a");if(i.href=e,i.protocol!==r)return;var a=function(e){return"/"===e.substring(e.length-1,e.length)};""!==i.pathname&&"/"!==i.pathname||a(e)||(e+="/");var s=i.protocol+"//"+i.hostname+(a(i.hostname)?"":"/")+i.pathname+i.search+i.hash,c=i.protocol+"//"+i.host+(a(i.host)?"":"/")+i.pathname+i.search+i.hash;e!=s&&e!=c||(n="443"==i.port?i.hostname:i.host)}return n}};var c=function(){function e(){}return e.GatedCacheKeyPrefix="__OSF_GATED_OMEX.",e.AnonymousCacheKeyPrefix="__OSF_ANONYMOUS_OMEX.",e.UngatedCacheKeyPrefix="__OSF_OMEX.",e.ActivatedCacheKeyPrefix="__OSF_RUNTIME_.Activated.",e.AppinstallAuthenticated="appinstall_authenticated.",e.Entitlement="entitle.",e.AppState="appState.",e.AppDetails="appDetails.",e.AppInstallInfo="appInstallInfo.",e.AuthenticatedAppInstallInfoCacheKey=e.GatedCacheKeyPrefix+e.AppinstallAuthenticated+"{0}.{1}.{2}.{3}",e.EntitlementsKey=e.Entitlement+"{0}.{1}",e.AppStateCacheKey="{0}"+e.AppState+"{1}.{2}",e.AppDetailKey="{0}"+e.AppDetails+"{1}",e.AppInstallInfoKey="{0}"+e.AppInstallInfo+"{1}.{2}",e.ActivatedCacheKey=e.ActivatedCacheKeyPrefix+"{0}.{1}.{2}",e}();e.CacheConstants=c}(e.WACUtils||(e.WACUtils={}))}(l||(l={})),i.XmlConstants={MaxXmlSize:1048576,MaxElementDepth:64},i.Xpath3Provider=function(e,t){var n=this;n._xmldoc=(new DOMParser).parseFromString(e,"text/xml"),n._evaluator=new XPathEvaluator,n._namespaceMapping={},n._defaultNamespace=null;for(var r,o=t.split(" "),i=0;i<o.length;++i)(r=/xmlns="([^"]*)"/g.exec(o[i]))?n._defaultNamespace=r[1]:(r=/xmlns:([^=]*)="([^"]*)"/g.exec(o[i]))&&(n._namespaceMapping[r[1]]=r[2]);n._resolver=n},i.Xpath3Provider.prototype={lookupNamespaceURI:function(e){return this._namespaceMapping[e]||this._defaultNamespace},addNamespaceMapping:function(e,t){return!this._namespaceMapping[e]&&(this._namespaceMapping[e]=t,!0)},selectSingleNode:function(e,t){var n=(t?"./":"/")+e;t=t||this.getDocumentElement();var r=this._evaluator.evaluate(n,t,this._resolver,XPathResult.FIRST_ORDERED_NODE_TYPE,null);return r?r.singleNodeValue:null},selectNodes:function(e,t){var n=(t?"./":"/")+e;t=t||this.getDocumentElement();var r=this._evaluator.evaluate(n,t,this._resolver,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),o=[];if(r)for(var i=r.iterateNext();i;)o.push(i),i=r.iterateNext();return o},selectNodesByXPath:function(e,t){var n=this._evaluator.evaluate(e,t,this._resolver,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),r=[];if(n)for(var o=n.iterateNext();o;)r.push(o),o=n.iterateNext();return r},getDocumentElement:function(){return this._xmldoc.documentElement}},i.IEXpathProvider=function(e,t){for(var n=null,r=["MSXML2.DOMDocument.6.0"],a=0;a<r.length;a++)try{(n=new ActiveXObject(r[a])).setProperty("ResolveExternals",!1),n.setProperty("ValidateOnParse",!1),n.setProperty("ProhibitDTD",!0),n.setProperty("MaxXMLSize",i.XmlConstants.MaxXmlSize),n.setProperty("MaxElementDepth",i.XmlConstants.MaxElementDepth),n.async=!1,n.loadXML(e),n.setProperty("SelectionLanguage","XPath"),n.setProperty("SelectionNamespaces",t);break}catch(e){o.msAjaxDebug.trace("xml doc creating error:"+e)}this._xmldoc=n},i.IEXpathProvider.prototype={selectSingleNode:function(e,t){var n=(t?"./":"/")+e;return(t=t||this.getDocumentElement()).selectSingleNode(n)},addNamespaceMapping:function(e,t){var n="SelectionNamespaces",r=this._xmldoc.getProperty(n),o="xmlns:"+e+"=",i="xmlns:"+e+'="'+t+'"';return-1==r.indexOf(o)&&(r=r+" "+i,this._xmldoc.setProperty(n,r),!0)},selectNodes:function(e,t){var n=(t?"./":"/")+e;return(t=t||this.getDocumentElement()).selectNodes(n)},selectNodesByXPath:function(e,t){return t.selectNodes(e)},getDocumentElement:function(){return this._xmldoc.documentElement},getActiveXObject:function(){return this._xmldoc}},i.DomParserProvider=function(e,t){var n=this;try{n._xmldoc=(new DOMParser).parseFromString(e,"text/xml")}catch(e){Sys.Debug.trace("xml doc creating error:"+e)}n._namespaceMapping={},n._defaultNamespace=null;for(var r,o=t.split(" "),i=0;i<o.length;++i)(r=/xmlns="([^"]*)"/g.exec(o[i]))?n._defaultNamespace=r[1]:(r=/xmlns:([^=]*)="([^"]*)"/g.exec(o[i]))&&(n._namespaceMapping[r[1]]=r[2])},i.DomParserProvider.prototype={addNamespaceMapping:function(e,t){return!this._namespaceMapping[e]&&(this._namespaceMapping[e]=t,!0)},selectSingleNode:function(e,t){var n=t||this._xmldoc,r=this._selectNodes(e,n);return 0===r.length?null:r[0]},selectNodes:function(e,t){var n=t||this._xmldoc;return this._selectNodes(e,n)},selectNodesByXPath:function(){return null},_selectNodes:function(e,t){var n=[];if(!e)return n;var r,i,a=e.split(":");if(1===a.length)r=null,i=a[0];else{if(2!==a.length)throw o.msAjaxError.argument("name");r=this._namespaceMapping[a[0]],i=a[1]}if(!t.hasChildNodes)return n;for(var s=t.childNodes,c=0;c<s.length;c++)i===this._removeNodePrefix(s[c].nodeName)&&r===s[c].namespaceURI&&n.push(s[c]);return n},_removeNodePrefix:function(e){var t=e.split(":");return 1===t.length?e:t[1]},getDocumentElement:function(){return this._xmldoc.documentElement}},i.XmlProcessor=function(e,t){var n=this,r=Function._validateParams(arguments,[{name:"xml",type:String,mayBeNull:!1},{name:"xmlNamespaces",type:String,mayBeNull:!1}]);if(r)throw r;document.implementation&&document.implementation.hasFeature("XPath","3.0")?n._provider=new i.Xpath3Provider(e,t):(n._provider=new i.IEXpathProvider(e,t),n._provider.getActiveXObject()||(n._provider=new i.DomParserProvider(e,t)))},i.XmlProcessor.prototype={addNamespaceMapping:function(e,t){var n=Function._validateParams(arguments,[{name:"namespacePrefix",type:String,mayBeNull:!1},{name:"namespaceUri",type:String,mayBeNull:!1}]);if(n)throw n;return this._provider.addNamespaceMapping(e,t)},selectSingleNode:function(e,t){var n=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1},{name:"contextNode",mayBeNull:!0,optional:!0}]);if(n)throw n;return this._provider.selectSingleNode(e,t)},selectNodes:function(e,t){var n=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1},{name:"contextNode",mayBeNull:!0,optional:!0}]);if(n)throw n;return this._provider.selectNodes(e,t)},selectNodesByXPath:function(e,t){var n=Function._validateParams(arguments,[{name:"xpath",type:String,mayBeNull:!1},{name:"contextNode",mayBeNull:!0,optional:!0}]);if(n)throw n;return t=t||this._provider.getDocumentElement(),this._provider.selectNodesByXPath(e,t)},getDocumentElement:function(){return this._provider.getDocumentElement()},getNodeValue:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return e.text?e.text:e.textContent},getNodeText:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return 9==this.getNodeType(e)?this.getNodeText(this.getDocumentElement()):e.text?e.text:e.textContent},setNodeText:function(e,t){var n=!1,r=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:n},{name:"text",type:String,mayBeNull:n}]);if(r)throw r;if(9==this.getNodeType(e))return n;try{e.text?e.text=t:e.textContent=t}catch(e){return n}return!0},getNodeXml:function(e){var t,n=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(n)throw n;return e.xml?t=e.xml:(t=(new XMLSerializer).serializeToString(e),2==this.getNodeType(e)&&(t=this.getNodeBaseName(e)+'="'+t+'"')),t},setNodeXml:function(e,t){var n=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1},{name:"xml",type:String,mayBeNull:!1}]);if(n)throw n;var r=new i.XmlProcessor(t,"");if(!r.isValidXml())return null;var o=r.getDocumentElement();try{e.parentNode.replaceChild(o,e)}catch(e){return null}return o},getNodeNamespaceURI:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return e.namespaceURI},getNodePrefix:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return e.prefix},getNodeBaseName:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return!e.nodeType||1!=e.nodeType&&2!=e.nodeType?e.nodeName:e.baseName?e.baseName:e.localName},getNodeType:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return e.nodeType},appendChild:function(e,t){var n=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1},{name:"childXml",type:String,mayBeNull:!1}]);if(n)throw n;var r=new i.XmlProcessor(t,"");if(!r.isValidXml())return null;var o=r.getDocumentElement();return e.appendChild(o),o},_getAttributeLocalName:function(e){return e.localName?e.localName:e.baseName},readAttributes:function(e,t,n){var r=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1},{name:"attributesToRead",type:Object,mayBeNull:!1},{name:"objectToFill",type:Object,mayBeNull:!1}]);if(r)throw r;for(var o,i,a=0;a<e.attributes.length;a++)for(var s in o=e.attributes[a],i=this._getAttributeLocalName(o),t)i===s&&(n[t[s]]=o.value)},isValidXml:function(){var e="parsererror";if(null==this.getDocumentElement())return!1;if(this._provider._xmldoc.getElementsByTagName(e).length>0){var t=(new DOMParser).parseFromString("<","text/xml").getElementsByTagName(e)[0].namespaceURI;return this._provider._xmldoc.getElementsByTagNameNS(t,e).length<=0}return!0}},function(e){var t=function(){function e(){}return e.prototype.Serialize=function(e){try{return JSON.stringify(e)}catch(e){return null}},e.prototype.Deserialize=function(e){try{return JSON.parse(e)}catch(e){return null}},e}();e.SafeSerializer=t;var n=function(){function e(e,t){this._localStorage=e,this._serializer=t}return e.prototype.GetCacheItem=function(t,n,r,o,i){var a="cacheExpired",s=this;void 0===n&&(n=!0),void 0===i&&(i=!0),s.ValidateCurrentCache();var c=s._localStorage.getItem(t);if(c){var u=s._serializer.Deserialize(c);if(void 0!==o&&o>0&&o-u.createdOn>0)s._localStorage.removeItem(t),r&&(r[a]=!0);else{if(!n)return u.data;var l=new Date;if(Math.abs(l.getTime()-u.createdOn)<e.msPerDay*u.refreshRate)return u.data;i&&(s._localStorage.removeItem(t),r&&(r[a]=!0))}}},e.prototype.SetCacheItem=function(t,n,r){r=r||e.defaultRefreshRateInDays;var o={data:n,createdOn:(new Date).getTime(),refreshRate:r};this._localStorage.setItem(t,this._serializer.Serialize(o))},e.prototype.RemoveCacheItem=function(e){this._localStorage.removeItem(e)},e.prototype.RemoveAll=function(e){for(var t=this._localStorage.getKeysWithPrefix(e),n=0,r=t.length;n<r;n++)this._localStorage.removeItem(t[n])},e.prototype.RemoveMatches=function(e){for(var t=this._localStorage.getKeysWithPrefix(""),n=0,r=t.length;n<r;n++)for(var o=t[n],i=0,a=e.length;i<a;i++)if(e[i].test(o)){this._localStorage.removeItem(o);break}},e.prototype.ValidateCurrentCache=function(){this._localStorage.getItem(e.cacheVersionKey)!=e.currentSchemaVersion&&(this.RemoveMatches([new RegExp("__OSF_(?!.*activated).*$","i")]),this._localStorage.setItem(e.cacheVersionKey,e.currentSchemaVersion))},e.defaultRefreshRateInDays=3,e.msPerDay=864e5,e.currentSchemaVersion="1",e.checkedCache=!1,e.cacheVersionKey="osfCacheVersion",e}();e.AppsDataCacheManager=n;var r=function(e){function t(t,n){e.call(this,t,n)}return c(t,e),t.prototype.GetRefreshToken=function(n,r){var o=i.OUtil.formatString(t._refreshTokenCacheKey,n,r);return e.prototype.GetCacheItem.call(this,o)},t.prototype.AddRefreshToken=function(n,r,o){var a=i.OUtil.formatString(t._refreshTokenCacheKey,r,o);e.prototype.SetCacheItem.call(this,a,n)},t.prototype.RemoveAll=function(){e.prototype.RemoveAll.call(this,t._refreshTokenCachePrefixKey)},t.prototype.RemoveRefreshToken=function(n,r){var o=i.OUtil.formatString(t._refreshTokenCacheKey,n,r);e.prototype.RemoveCacheItem.call(this,o)},t._refreshTokenCacheKey="_OSF_PRIVATECATALOG_REFRESHTOKEN_{0}_{1}",t._refreshTokenCachePrefixKey="_OSF_PRIVATECATALOG_REFRESHTOKEN",t}(n);e.TokenCacheManager=r}(l||(l={})),function(e){var t="Error",n="ResponseTime",r="Result",o="OperationMetadata",i="ErrorResult",a="AssetId",s="CorrelationId",u=!0,l=function(){function e(e){this._table=e,this._fields={}}return Object.defineProperty(e.prototype,"Fields",{get:function(){return this._fields},enumerable:u,configurable:u}),Object.defineProperty(e.prototype,"Table",{get:function(){return this._table},enumerable:u,configurable:u}),e.prototype.SerializeFields=function(){},e.prototype.SetSerializedField=function(e,t){null!=t&&(this._serializedFields[e]=t.toString())},e.prototype.SerializeRow=function(){var e=this;return e._serializedFields={},e.SetSerializedField("Table",e._table),e.SerializeFields(),JSON.stringify(e._serializedFields)},e}();e.BaseUsageData=l;var d=function(e){var t="Stage11Time",n="Stage10Time",r="Stage9Time",o="Stage8Time",l="Stage7Time",d="Stage6Time",f="Stage5Time",p="Stage4Time",m="Stage3Time",g="Stage2Time",h="Stage1Time",v="InstanceId",y="ActivationInfo",b="AppInfo";function _(){e.call(this,"AppLoadTime")}return c(_,e),Object.defineProperty(_.prototype,s,{get:function(){return this.Fields[s]},set:function(e){this.Fields[s]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,b,{get:function(){return this.Fields[b]},set:function(e){this.Fields[b]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,y,{get:function(){return this.Fields[y]},set:function(e){this.Fields[y]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,v,{get:function(){return this.Fields[v]},set:function(e){this.Fields[v]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,h,{get:function(){return this.Fields[h]},set:function(e){this.Fields[h]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,g,{get:function(){return this.Fields[g]},set:function(e){this.Fields[g]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,m,{get:function(){return this.Fields[m]},set:function(e){this.Fields[m]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,p,{get:function(){return this.Fields[p]},set:function(e){this.Fields[p]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,f,{get:function(){return this.Fields[f]},set:function(e){this.Fields[f]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,d,{get:function(){return this.Fields[d]},set:function(e){this.Fields[d]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,l,{get:function(){return this.Fields[l]},set:function(e){this.Fields[l]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,o,{get:function(){return this.Fields[o]},set:function(e){this.Fields[o]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,i,{get:function(){return this.Fields[i]},set:function(e){this.Fields[i]=e},enumerable:u,configurable:u}),_.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(s,e.CorrelationId),e.SetSerializedField(b,e.AppInfo),e.SetSerializedField(y,e.ActivationInfo),e.SetSerializedField(v,e.InstanceId),e.SetSerializedField(a,e.AssetId),e.SetSerializedField(h,e.Stage1Time),e.SetSerializedField(g,e.Stage2Time),e.SetSerializedField(m,e.Stage3Time),e.SetSerializedField(p,e.Stage4Time),e.SetSerializedField(f,e.Stage5Time),e.SetSerializedField(d,e.Stage6Time),e.SetSerializedField(l,e.Stage7Time),e.SetSerializedField(o,e.Stage8Time),e.SetSerializedField(r,e.Stage9Time),e.SetSerializedField(n,e.Stage10Time),e.SetSerializedField(t,e.Stage11Time),e.SetSerializedField(i,e.ErrorResult)},_}(l);e.AppLoadTimeUsageData=d;var f=function(e){var t="NotificationClickInfo";function n(){e.call(this,"AppNotification")}return c(n,e),Object.defineProperty(n.prototype,s,{get:function(){return this.Fields[s]},set:function(e){this.Fields[s]=e},enumerable:u,configurable:u}),Object.defineProperty(n.prototype,i,{get:function(){return this.Fields[i]},set:function(e){this.Fields[i]=e},enumerable:u,configurable:u}),Object.defineProperty(n.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:u,configurable:u}),n.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(s,e.CorrelationId),e.SetSerializedField(i,e.ErrorResult),e.SetSerializedField(t,e.NotificationClickInfo)},n}(l);e.AppNotificationUsageData=f;var p=function(e){function t(){e.call(this,"AppManagementMenu")}return c(t,e),Object.defineProperty(t.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:u,configurable:u}),Object.defineProperty(t.prototype,o,{get:function(){return this.Fields[o]},set:function(e){this.Fields[o]=e},enumerable:u,configurable:u}),Object.defineProperty(t.prototype,i,{get:function(){return this.Fields[i]},set:function(e){this.Fields[i]=e},enumerable:u,configurable:u}),t.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(a,e.AssetId),e.SetSerializedField(o,e.OperationMetadata),e.SetSerializedField(i,e.ErrorResult)},t}(l);e.AppManagementMenuUsageData=p;var m=function(e){var t="LastActiveTabCount",n="LastActiveTab",r="DialogState",o="TrustPageSessionTime",i="TotalSessionTime";function s(){e.call(this,"InsertionDialogSession")}return c(s,e),Object.defineProperty(s.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:u,configurable:u}),Object.defineProperty(s.prototype,i,{get:function(){return this.Fields[i]},set:function(e){this.Fields[i]=e},enumerable:u,configurable:u}),Object.defineProperty(s.prototype,o,{get:function(){return this.Fields[o]},set:function(e){this.Fields[o]=e},enumerable:u,configurable:u}),Object.defineProperty(s.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:u,configurable:u}),Object.defineProperty(s.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:u,configurable:u}),Object.defineProperty(s.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:u,configurable:u}),s.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(a,e.AssetId),e.SetSerializedField(i,e.TotalSessionTime),e.SetSerializedField(o,e.TrustPageSessionTime),e.SetSerializedField(r,e.DialogState),e.SetSerializedField(n,e.LastActiveTab),e.SetSerializedField(t,e.LastActiveTabCount)},s}(l);e.InsertionDialogSessionUsageData=m;var g=function(e){function t(){e.call(this,"UploadFileDevCatelog")}return c(t,e),Object.defineProperty(t.prototype,s,{get:function(){return this.Fields[s]},set:function(e){this.Fields[s]=e},enumerable:u,configurable:u}),Object.defineProperty(t.prototype,o,{get:function(){return this.Fields[o]},set:function(e){this.Fields[o]=e},enumerable:u,configurable:u}),Object.defineProperty(t.prototype,i,{get:function(){return this.Fields[i]},set:function(e){this.Fields[i]=e},enumerable:u,configurable:u}),t.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(s,e.CorrelationId),e.SetSerializedField(o,e.OperationMetadata),e.SetSerializedField(i,e.ErrorResult)},t}(l);e.UploadFileDevCatelogUsageData=g;var h=function(e){var t="AppSizeHeight",n="AppSizeWidth",r="IsAppCommand",o="AppTargetType",i="AppVersion",a="AppId",l="StoreType";function d(){e.call(this,"UploadFileDevCatalogUsage")}return c(d,e),Object.defineProperty(d.prototype,s,{get:function(){return this.Fields[s]},set:function(e){this.Fields[s]=e},enumerable:u,configurable:u}),Object.defineProperty(d.prototype,l,{get:function(){return this.Fields[l]},set:function(e){this.Fields[l]=e},enumerable:u,configurable:u}),Object.defineProperty(d.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:u,configurable:u}),Object.defineProperty(d.prototype,i,{get:function(){return this.Fields[i]},set:function(e){this.Fields[i]=e},enumerable:u,configurable:u}),Object.defineProperty(d.prototype,o,{get:function(){return this.Fields[o]},set:function(e){this.Fields[o]=e},enumerable:u,configurable:u}),Object.defineProperty(d.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:u,configurable:u}),Object.defineProperty(d.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:u,configurable:u}),Object.defineProperty(d.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:u,configurable:u}),d.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(s,e.CorrelationId),e.SetSerializedField(l,e.StoreType),e.SetSerializedField(a,e.AppId),e.SetSerializedField(i,e.AppVersion),e.SetSerializedField(o,e.AppTargetType),e.SetSerializedField(r,e.IsAppCommand),e.SetSerializedField(n,e.AppSizeWidth),e.SetSerializedField(t,e.AppSizeHeight)},d}(l);e.UploadFileDevCatalogUsageUsageData=h;var v=function(e){function o(){e.call(this,"OneDriveCatalogGetAccessToken")}return c(o,e),Object.defineProperty(o.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:u,configurable:u}),Object.defineProperty(o.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:u,configurable:u}),Object.defineProperty(o.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:u,configurable:u}),o.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(r,e.Result),e.SetSerializedField(n,e.ResponseTime),e.SetSerializedField(t,e.Error)},o}(l);e.OneDriveCatalogGetAccessTokenUsageData=v;var y=function(e){function o(){e.call(this,"OneDriveCatalogGetManifests")}return c(o,e),Object.defineProperty(o.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:u,configurable:u}),Object.defineProperty(o.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:u,configurable:u}),Object.defineProperty(o.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:u,configurable:u}),o.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(r,e.Result),e.SetSerializedField(n,e.ResponseTime),e.SetSerializedField(t,e.Error)},o}(l);e.OneDriveCatalogGetManifestsUsageData=y;var b=function(e){var o="id";function i(){e.call(this,"OneDriveCatalogGetManifest")}return c(i,e),Object.defineProperty(i.prototype,o,{get:function(){return this.Fields.id},set:function(e){this.Fields.id=e},enumerable:u,configurable:u}),Object.defineProperty(i.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:u,configurable:u}),Object.defineProperty(i.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:u,configurable:u}),Object.defineProperty(i.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:u,configurable:u}),i.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(o,e.id),e.SetSerializedField(r,e.Result),e.SetSerializedField(n,e.ResponseTime),e.SetSerializedField(t,e.Error)},i}(l);e.OneDriveCatalogGetManifestUsageData=b;var _=function(e){function o(){e.call(this,"OneDriveCatalogInsertManifest")}return c(o,e),Object.defineProperty(o.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:u,configurable:u}),Object.defineProperty(o.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:u,configurable:u}),Object.defineProperty(o.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:u,configurable:u}),o.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(r,e.Result),e.SetSerializedField(n,e.ResponseTime),e.SetSerializedField(t,e.Error)},o}(l);e.OneDriveCatalogInsertManifestUsageData=_}(a||(a={})),function(e){var t=null;!function(e){var t="verboseEx",n="unexpected";e[e[n]=10]=n,e[e.warning=15]="warning",e[e.info=50]="info",e[e.verbose=100]="verbose",e[e[t]=200]=t}(e.ULSTraceLevel||(e.ULSTraceLevel={}));var n=e.ULSTraceLevel;!function(e){var t="msoulscat_Osf_UploadFileDevCatalogUsage",n="msoulscat_Osf_UploadFileDevCatelog",r="msoulscat_Osf_InsertionDialogSession",o="msoulscat_Osf_AppManagementMenu",i="msoulscat_Osf_Runtime",a="msoulscat_Osf_Notification",s="msoulscat_Osf_Latency";e[e[s]=1401]=s,e[e[a]=1402]=a,e[e[i]=1403]=i,e[e[o]=1404]=o,e[e[r]=1405]=r,e[e[n]=1406]=n,e[e[t]=1411]=t}(e.ULSCat||(e.ULSCat={}));var r,o,s=e.ULSCat;!function(e){var t="IsAnonymous",n="InsertionDialogClosed",r="ConfirmationDialogCancel";e[e[r]=256]=r,e[e[n]=512]=n,e[e[t]=1024]=t}(r||(r={})),function(e){var t="TrustPageVisited",n="Canceled",r="Inserted",o="Undefined";e[e[o]=0]=o,e[e[r]=1]=r,e[e[n]=2]=n,e[e.Closed=3]="Closed",e[e[t]=8]=t}(o||(o={}));var c=function(){function e(){this.timeValue=0}return e.prototype.Start=function(){this.timeValue=-(new Date).getTime(),this.finishedMeasurement=!1},e.prototype.Stop=function(){this.timeValue<0&&(this.timeValue+=(new Date).getTime(),this.finishedMeasurement=!0)},Object.defineProperty(e.prototype,"Finished",{get:function(){return this.finishedMeasurement},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ElapsedTime",{get:function(){var e=this.timeValue;return!this.Finished&&e<0&&(e=Math.abs(e)-(new Date).getTime()),e},enumerable:!0,configurable:!0}),e}();e.LatencyStopwatch=c;var u=function(){};e.Context=u;var l=function(){function e(){}return e.SendULSTraceTag=function(e,t,n,r){Microsoft.Office.WebExtension.FULSSupported&&Diag.UULS.trace(r,e,t,n)},e}(),d=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){l.SendULSTraceTag(e.category,e.level,t.SerializeRow(),6062431)},e.category=s.msoulscat_Osf_Notification,e.level=n.info,e}();e.NotificationLogger=d;var f=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){l.SendULSTraceTag(e.category,e.level,t.SerializeRow(),17085957)},e.category=s.msoulscat_Osf_AppManagementMenu,e.level=n.info,e}();e.AppManagementMenuLogger=f;var p=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){l.SendULSTraceTag(e.category,e.level,t.SerializeRow(),17085958)},e.category=s.msoulscat_Osf_UploadFileDevCatelog,e.level=n.info,e}();e.UploadFileDevCatelogLogger=p;var m=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){l.SendULSTraceTag(e.category,e.level,t.SerializeRow(),17834653)},e.category=s.msoulscat_Osf_UploadFileDevCatalogUsage,e.level=n.info,e}();e.UploadFileDevCatalogUsageLogger=m;var g=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){l.SendULSTraceTag(e.category,e.level,t.SerializeRow(),4748055)},e.category=s.msoulscat_Osf_Latency,e.level=n.info,e}();e.LatencyLogger=g;var h=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){l.SendULSTraceTag(e.category,e.level,t.SerializeRow(),17085959)},e.category=s.msoulscat_Osf_InsertionDialogSession,e.level=n.info,e}();e.InsertionDialogSessionLogger=h;var v=function(){function e(){}return e.LogNotification=function(e,t,n){var r=new a.AppNotificationUsageData;r.CorrelationId=e,r.ErrorResult=t,r.NotificationClickInfo=n,d.Instance().LogData(r)},e}();e.AppNotificationHelper=v;var y=function(){function e(){}return e.LogAppManagementMenuAction=function(e,t,n,o,i,s){var c=new a.AppManagementMenuUsageData,u=0===e.toLowerCase().indexOf("wa")?parseInt(e.substring(2),10):parseInt(e,10);o&&(t|=r.InsertionDialogClosed),i&&(t|=r.IsAnonymous),c.AssetId=u,c.OperationMetadata=t,c.ErrorResult=s,f.Instance().LogData(c)},e}();e.AppManagementMenuHelper=y;var b=function(){function e(){}return e.LogUploadFileDevCatelogAction=function(e,t,n,r,o,i){var s=new a.UploadFileDevCatelogUsageData;s.CorrelationId=e,s.OperationMetadata=t,s.ErrorResult=i,p.Instance().LogData(s)},e}();e.UploadFileDevCatelogHelper=b;var _=function(){function e(){}return e.LogUploadFileDevCatalogUsageAction=function(e,t,n,r,o,i,s,c){var u=new a.UploadFileDevCatalogUsageUsageData;u.CorrelationId=e,u.StoreType=t,u.AppId=n,u.AppVersion=r,u.AppTargetType=o,u.IsAppCommand=i,u.AppSizeWidth=s,u.AppSizeHeight=c,m.Instance().LogData(u)},e}();e.UploadFileDevCatalogUsageHelper=_;var S=function(){var e="Stage11Time",r="Stage10Time",o="Stage9Time",i="Stage8Time",u="Stage7Time",d="Stage5Time",f="Stage4Time",p="Stage2Time",m="Stage1Time";function h(){}return h.GenerateActivationMessage=function(e,n){var r="";return e!=t&&(r+="ActivationRuntimeType: "+e.toString()+"|"),n!=t&&(r+="CorrelationId: "+n),r},h.ActivationStart=function(t,g,v,y,b,_){h.activatingNumber++,t.LoadTime=new a.AppLoadTimeUsageData,t.Timers={},t.LoadTime.CorrelationId=y,t.LoadTime.AppInfo=g,t.LoadTime.ActivationInfo=0,t.LoadTime.InstanceId=b,t.LoadTime.AssetId=v,t.LoadTime.Stage1Time=0,t.Timers[m]=new c,t.LoadTime.Stage2Time=0,t.Timers[p]=new c,t.LoadTime.Stage3Time=0,t.LoadTime.Stage4Time=0,t.Timers[f]=new c,t.LoadTime.Stage5Time=0,t.Timers[d]=new c,t.LoadTime.Stage6Time=h.activatingNumber,t.LoadTime.Stage7Time=0,t.Timers[u]=new c,t.LoadTime.Stage8Time=0,t.Timers[i]=new c,t.LoadTime.Stage9Time=0,t.Timers[o]=new c,t.LoadTime.Stage10Time=0,t.Timers[r]=new c,t.LoadTime.Stage11Time=0,t.Timers[e]=new c,t.LoadTime.ErrorResult=0,t.ActivationRuntimeType=_,h.StartStopwatch(t,m),l.SendULSTraceTag(s.msoulscat_Osf_Runtime,n.info,h.GenerateActivationMessage(_,y),19515419)},h.ActivationEnd=function(e){h.ActivateEndInternal(e)},h.PageStart=function(e){h.StartStopwatch(e,p)},h.PageLoaded=function(e){h.StopStopwatch(e,p)},h.ServerCallStart=function(e){h.StartStopwatch(e,f)},h.ServerCallEnd=function(e){h.StopStopwatch(e,f)},h.AuthenticationStart=function(e){h.StartStopwatch(e,d)},h.AuthenticationEnd=function(e){h.StopStopwatch(e,d)},h.EntitlementCheckStart=function(e){h.StartStopwatch(e,u)},h.EntitlementCheckEnd=function(e){h.StopStopwatch(e,u)},h.KilledAppsCheckStart=function(e){h.StartStopwatch(e,i)},h.KilledAppsCheckEnd=function(e){h.StopStopwatch(e,i)},h.AppStateCheckStart=function(e){h.StartStopwatch(e,o)},h.AppStateCheckEnd=function(e){h.StopStopwatch(e,o)},h.ManifestRequestStart=function(e){h.StartStopwatch(e,r)},h.ManifestRequestEnd=function(e){h.StopStopwatch(e,r)},h.OfficeJSStartToLoad=function(t){h.StartStopwatch(t,e)},h.OfficeJSLoaded=function(t){h.StopStopwatch(t,e)},h.SetAnonymousFlag=function(e,t){h.SetActivationInfoField(e,h.ConvertFlagToBit(t),2,0)},h.SetRetryCount=function(e,t){h.SetActivationInfoField(e,t,3,2)},h.SetManifestTrustCachedFlag=function(e,t){h.SetActivationInfoField(e,h.ConvertFlagToBit(t),2,5)},h.SetManifestDataCachedFlag=function(e,t){h.SetActivationInfoField(e,h.ConvertFlagToBit(t),2,7)},h.SetOmexHasEntitlementFlag=function(e,t){h.SetActivationInfoField(e,h.ConvertFlagToBit(t),2,9)},h.SetManifestDataInvalidFlag=function(e,t){h.SetActivationInfoField(e,h.ConvertFlagToBit(t),2,11)},h.SetAppStateDataCachedFlag=function(e,t){h.SetActivationInfoField(e,h.ConvertFlagToBit(t),2,13)},h.SetAppStateDataInvalidFlag=function(e,t){h.SetActivationInfoField(e,h.ConvertFlagToBit(t),2,15)},h.SetActivationRuntimeType=function(e,t){h.SetActivationInfoField(e,t,2,17)},h.SetErrorResult=function(e,t){e.LoadTime&&(e.LoadTime.ErrorResult=t,h.ActivateEndInternal(e))},h.SetBit=function(e,t,n,r){h.SetActivationInfoField(e,t,r||2,n)},h.StartStopwatch=function(e,t){e.LoadTime&&e.Timers&&e.Timers[t]&&(e.Timers[t].Start(),h.UpdateActivatingNumber(e))},h.StopStopwatch=function(e,t){e.LoadTime&&e.Timers&&e.Timers[t]&&(e.Timers[t].Stop(),h.UpdateActivatingNumber(e))},h.ConvertFlagToBit=function(e){return e?2:1},h.SetActivationInfoField=function(e,t,n,r){e.LoadTime&&(h.UpdateActivatingNumber(e),e.LoadTime.ActivationInfo=h.SetBitField(e.LoadTime.ActivationInfo,t,n,r))},h.SetBitField=function(e,t,n,r){return e&~(Math.pow(2,n)-1<<r)|t<<r},h.UpdateActivatingNumber=function(e){e.LoadTime&&(e.LoadTime.Stage6Time=e.LoadTime.Stage6Time>h.activatingNumber?e.LoadTime.Stage6Time:h.activatingNumber)},h.ActivateEndInternal=function(e){if(e.LoadTime){if(h.StopStopwatch(e,m),e.Timers)for(var r in e.Timers)e.Timers[r].ElapsedTime!=t&&(e.LoadTime[r]=e.Timers[r].ElapsedTime);l.SendULSTraceTag(s.msoulscat_Osf_Runtime,n.info,h.GenerateActivationMessage(e.ActivationRuntimeType,e.LoadTime.CorrelationId),19515420),g.Instance().LogData(e.LoadTime),e.LoadTime=t,h.activatingNumber--}},h.activatingNumber=0,h}();e.AppLoadTimeHelper=S;var C=function(){var e=" AppCorrelationId:";function r(){}return r.LogProxyFailure=function(e,o,a){var s;e==t&&(e=""),s=i.OUtil.formatString("appCorrelationId:{0}, methodName:{1}",e,o),Object.keys(a).forEach((function(e){var n=a[e];n!=t&&(n=n.toString()),s+=", "+e+":"+n})),l.SendULSTraceTag(r.category,n.warning,s,6062432)},r.LogExceptionTag=function(o,i,a,s){var c=o;i&&(i.name&&(c+=" Exception name:"+i.name+"."),i.paramName&&(c+=" Param name:"+i.paramName+"."),i.message&&(c+=" Message:"+i.message+"."),i.stack&&(c+=" [Stack:"+i.stack+"]")),a!=t&&(c+=e+a+"."),l.SendULSTraceTag(r.category,n.warning,c,s)},r.LogCommonMessageTag=function(o,i,a){i!=t&&(o+=e+i+"."),l.SendULSTraceTag(r.category,n.info,o,a)},r.category=s.msoulscat_Osf_Runtime,r}();e.RuntimeTelemetryHelper=C;var O=function(){function e(){}return e.LogInsertionDialogSession=function(e,t,n,r,i,s){var c=new a.InsertionDialogSessionUsageData,u=0===e.toLowerCase().indexOf("wa")?parseInt(e.substring(2),10):parseInt(e,10),l=o.Undefined;l|=r?o.Inserted:o.Canceled,n>0&&(l|=o.TrustPageVisited),c.AssetId=u,c.TotalSessionTime=t,c.TrustPageSessionTime=n,c.DialogState=l,c.LastActiveTab=i,c.LastActiveTabCount=s,h.Instance().LogData(c)},e}();e.InsertionDialogSessionHelper=O}(s||(s={})),function(e){var t=!0,n=function(){function e(){this.m_osfControlId=null,this.m_isControlReady=!1,this.m_queue=[]}return Object.defineProperty(e.prototype,"osfControlId",{get:function(){return this.m_osfControlId},set:function(e){this.m_osfControlId=e},enumerable:t,configurable:t}),Object.defineProperty(e.prototype,"isControlReady",{get:function(){return this.m_isControlReady},set:function(e){this.m_isControlReady=e},enumerable:t,configurable:t}),Object.defineProperty(e.prototype,"isEmpty",{get:function(){return 0===this.m_queue.length},enumerable:t,configurable:t}),e.prototype.queueAction=function(e,t){var n={eventData:e,actionSender:t};this.m_queue.push(n)},e.prototype.sendActions=function(){var e=this;return new Promise((function(t){window.setTimeout((function(){for(;e.m_queue.length>0;){var n=e.m_queue[0];e.m_queue.splice(0,1),e.sendAction(n)}t()}),0)}))},e.prototype.sendAction=function(e){var t=e.eventData,n=e.actionSender;t&&n&&this.m_isControlReady&&n(this.m_osfControlId,t)},e}(),r=function(){function r(){}return r.init=function(){return e.ActionMetadataManager.init()},r.tryDispatchShortcutKey=function(n,r,o){if(!o)throw i.OUtil.formatString(Strings.OfficeOM.L_InvalidParameters,o);var a=e.ActionMetadataManager.getActionFromShortcutKey(n,r);return!!(a&&a.addinId&&a.actionId)&&(o(a.addinId,a.actionId),t)},r.sendQueuedActions=function(e){var n=r.getOrCreateAddinActionQueue(e);n&&(n.isControlReady=t,n.sendActions())},r.queueOrSendActionIfControlReady=function(e,t,n){var o=r.getOrCreateAddinActionQueue(e);o.isControlReady?o.isEmpty?n(e,t):(o.queueAction(t,n),o.sendActions()):o.queueAction(t,n)},r.getOrCreateAddinActionQueue=function(e){var t=r.s_actionQueues[e];return t||((t=new n).osfControlId=e,r.s_actionQueues[e]=t),t},r.s_actionQueues={},r}();e.ShortcutKeyDispatchManager=r}(l||(l={}));var u='xmlns="urn:schemas-microsoft-com:office:office" xmlns:o="urn:schemas-microsoft-com:office:office"';i.AppVersion={access:"ZAC150",excel:"ZXL150",excelwebapp:"WAE160",outlook:"ZOL150",outlookwebapp:"MOW150",powerpoint:"ZPP151",powerpointwebapp:"WAP160",project:"ZPJ150",word:"ZWD150",wordwebapp:"WAW160",onenotewebapp:"WAO160",visio:"ZVO161",visiowebapp:"WAV161"},i.AppSubType={Taskpane:1,Content:2,Contextual:3,Dictionary:4},i.ClientAppInfoReturnType={urlOnly:0,etokenOnly:1,both:2};i.HostSpecificFileVersionDefault="16.00",i.HostSpecificFileVersionMap={access:{web:"16.00"},agavito:{winrt:"16.00"},excel:{ios:"16.00",mac:"16.00",web:"16.00",win32:"16.01",winrt:"16.00"},onenote:{android:"16.00",web:"16.00",win32:"16.00",winrt:"16.00"},outlook:{ios:"16.00",mac:"16.00",web:"16.01",win32:"16.02"},powerpoint:{ios:"16.00",mac:"16.00",web:"16.00",win32:"16.01",winrt:"16.00"},project:{win32:"16.00"},sway:{web:"16.00"},word:{ios:"16.00",mac:"16.00",web:"16.00",win32:"16.01",winrt:"16.00"},visio:{web:"16.00",win32:"16.00"}},i.HostType={Excel:"Excel",Outlook:"Outlook",Access:"Access",PowerPoint:"PowerPoint",Word:"Word",Sway:"Sway",OneNote:"OneNote",Visio:"Visio"},i.ManifestHostType={Workbook:"Workbook",Document:"Document",Presentation:"Presentation",Notebook:"Notebook",Mailbox:"Mailbox",Drawing:"Drawing"},i.HostPlatform={Web:"Web"},i.getAppVerCode=function(e){var t,n="Invalid appName.";switch(e){case i.AppName.ExcelWebApp:t="excel.exe";break;case i.AppName.AccessWebApp:t="ZAC";break;case i.AppName.PowerpointWebApp:t="WAP";break;case i.AppName.WordWebApp:t="WAW";break;case i.AppName.OneNoteWebApp:t="WAO";break;case i.AppName.VisioWebApp:t="WAV";break;default:throw o.msAjaxDebug.trace(n),n}return t},i.getModernAppVerCode=function(e){var t,n="Invalid appName.";switch(e){case i.AppName.ExcelWebApp:t="WAC_Excel";break;case i.AppName.PowerpointWebApp:t="WAC_PowerPoint";break;case i.AppName.WordWebApp:t="WAC_Word";break;case i.AppName.OneNoteWebApp:t="WAC_OneNote";break;case i.AppName.OutlookWebApp:t="WAC_Outlook";break;case i.AppName.VisioWebApp:t="WAC_Visio";break;default:throw o.msAjaxDebug.trace(n),n}return t},i.getManifestHostType=function(e){var t;switch(e){case i.HostType.Excel:t=i.ManifestHostType.Workbook;break;case i.HostType.Word:t=i.ManifestHostType.Document;break;case i.HostType.PowerPoint:t=i.ManifestHostType.Presentation;break;case i.HostType.OneNote:t=i.ManifestHostType.Notebook;break;case i.HostType.Outlook:t=i.ManifestHostType.Mailbox;break;case i.HostType.Visio:t=i.ManifestHostType.Drawing;break;default:throw o.msAjaxDebug.trace("Invalid host type."),"Invalid hostType."}return t},i.Capability={Mailbox:"Mailbox",Document:"Document",Workbook:"Workbook",Project:"Project",Presentation:"Presentation",Database:"Database",Sway:"Sway",Notebook:"Notebook",Drawing:"Drawing"},i.HostCapability={Excel:i.Capability.Workbook,Outlook:i.Capability.Mailbox,Access:i.Capability.Database,PowerPoint:i.Capability.Presentation,Word:i.Capability.Document,Sway:i.Capability.Sway,OneNote:i.Capability.Notebook,Visio:i.Capability.Drawing},i.OsfControlTarget={Undefined:-1,InContent:0,TaskPane:1,Contextual:2},i.OsfControlPermission={Restricted:1,ReadDocument:2,WriteDocument:4,ReadItem:32,ReadWriteMailbox:64,ReadAllDocument:131,ReadWriteDocument:135},i.OsfControlStatus={NotActivated:1,Activated:2,AppStoreNotReachable:3,InvalidOsfControl:4,UnsupportedStore:5,UnknownStore:6,ActivationFailed:7,NotSandBoxSupported:8},i.OsfControlPageStatus={NotStarted:1,Loading:2,Ready:3,FailedHandleRequest:4,FailedOriginCheck:5,FailedPermissionCheck:6},i.StoreType={OMEX:"omex",SPCatalog:"spcatalog",SPApp:"spapp",Exchange:"exchange",FileSystem:"filesystem",Registry:"registry",InMemory:"inmemory",OneDrive:"onedrive",PrivateCatalog:"excatalog",HardCodedPreinstall:"hardcodedpreinstall",FirstParty:"firstparty",UploadFileDevCatalog:"uploadfiledevcatalog",Sdx:"sdxcatalog"},i.StoreTypeEnum={MarketPlace:0,Catalog:1,SPApp:2,Exchange:3,FileSystem:4,Registry:5,OneDrive:9,PrivateCatalog:10,HardCodedPreinstall:11,FirstParty:12,Sdx:14,UploadFileDevCatalog:15},i.ManifestIdIssuer={Microsoft:"Microsoft",Custom:"Custom"},i.OmexClientAppStatus={OK:1,UnknownAssetId:2,KilledAsset:3,NoEntitlement:4,DownloadsExceeded:5,Expired:6,Invalid:7,Revoked:8,ServerError:9,BadRequest:10,LimitedTrial:11,TrialNotSupported:12,EntitlementDeactivated:13,VersionMismatch:14,VersionNotSupported:15,UserIsMinor:16},i.OmexState={Killed:0,OK:1,Withdrawn:2,Flagged:3,DeveloperWithdrawn:4},i.OmexTrialType={None:0,Office:1,External:2},i.OmexEntitlementType={Free:"free",Trial:"trial",Paid:"paid"},i.OmexAuthNStatus={NotAttempted:-1,CheckFailed:0,Authenticated:1,Anonymous:2,Unknown:3},i.OmexRemoveAppStatus={Failed:0,Success:1},i.OfficeAppType={ContentApp:i.OsfControlTarget.InContent,TaskPaneApp:i.OsfControlTarget.TaskPane,MailApp:i.OsfControlTarget.Contextual},i.FormFactor={Default:"DefaultSettings",Desktop:"DesktopSettings",Tablet:"TabletSettings",Phone:"PhoneSettings"},i.OsfOfficeExtensionManagerPerfMarker={GetEntitlementStart:"Agave.OfficeExtensionManager.GetEntitlementStart",GetEntitlementEnd:"Agave.OfficeExtensionManager.GetEntitlementEnd"},i.OsfControlActivationPerfMarker={ActivationStart:"Agave.AgaveActivationStart",ActivationEnd:"Agave.AgaveActivationEnd",DeactivationStart:"Agave.AgaveDeactivationStart",DeactivationEnd:"Agave.AgaveDeactivationEnd",SelectionTimeout:"Agave.AgaveSelectionTimeout"},i.NotificationUxPerfMarker={RenderLoadingAnimationStart:"Agave.NotificationUx.RenderLoadingAnimationStart",RenderLoadingAnimationEnd:"Agave.NotificationUx.RenderLoadingAnimationEnd",RemoveLoadingAnimationStart:"Agave.NotificationUx.RemoveLoadingAnimationStart",RemoveLoadingAnimationEnd:"Agave.NotificationUx.RemoveLoadingAnimationEnd",RenderStage1Start:"Agave.NotificationUx.RenderStage1Start",RenderStage1End:"Agave.NotificationUx.RenderStage1End",RemoveStage1Start:"Agave.NotificationUx.RemoveStage1Start",RemoveStage1End:"Agave.NotificationUx.RemoveStage1End",RenderStage2Start:"Agave.NotificationUx.RenderStage2Start",RenderStage2End:"Agave.NotificationUx.RenderStage2End",RemoveStage2Start:"Agave.NotificationUx.RemoveStage2Start",RemoveStage2End:"Agave.NotificationUx.RemoveStage2End"},i.ProxyCallStatusCode={Succeeded:1,Failed:0,ProxyNotReady:-1},i.HostFrameTrustState={NotImplemented:0,NotReady:1,Exempted:2,NotTrusted:3,Trusted:4},i.ClientAppInfoReturnType={urlOnly:0,etokenOnly:1,both:2},i.SQMDataPoints={DATAID_APPSFOROFFICEUSAGE:10595,DATAID_APPSFOROFFICENOTIFICATIONS:10942},i.BWsaStreamTypes={Static:1},i.BWsaConfig={defaultMaxStreamRows:1e3},i.ErrorStatusCodes={E_OEM_EXTENSION_NOT_ENTITLED:2147758662,E_MANIFEST_SERVER_UNAVAILABLE:2147758672,E_USER_NOT_SIGNED_IN:2147758677,E_MANIFEST_DOES_NOT_EXIST:2147758673,E_OEM_EXTENSION_KILLED:2147758660,E_OEM_OMEX_EXTENSION_KILLED:2147758686,E_MANIFEST_UPDATE_AVAILABLE:2147758681,S_OEM_EXTENSION_TRIAL_MODE:275013,E_OEM_EXTENSION_WITHDRAWN_FROM_SALE:2147758690,E_TOKEN_EXPIRED:2147758675,E_TRUSTCENTER_CATALOG_UNTRUSTED_ADMIN_CONTROLLED:2147757992,E_MANIFEST_REFERENCE_INVALID:2147758678,S_USER_CLICKED_BUY:274205,E_MANIFEST_INVALID_VALUE_FORMAT:2147758654,E_TRUSTCENTER_MOE_UNACTIVATED:2147757996,S_OEM_EXTENSION_FLAGGED:275040,S_OEM_EXTENSION_DEVELOPER_WITHDRAWN_FROM_SALE:275041,E_BROWSER_VERSION:2147758194,E_TRUSTCENTER_APP_BLOCKED_FOR_MINOR:-2147209295,E_PRIVACY_SERVICE_DISABLED_ADMIN:2147758792,WAC_AgaveUnsupportedStoreType:1041,WAC_AgaveActivationError:1042,WAC_ActivateAttempLoading:1043,WAC_HTML5IframeSandboxNotSupport:1044,WAC_AgaveRequirementsErrorOmex:1045,WAC_AgaveRequirementsError:1046,WAC_AgaveOriginCheckError:1047,WAC_AgavePermissionCheckError:1048,WAC_AgaveHostHandleRequestError:1049,WAC_AgaveUnknownClientAppStatus:1050,WAC_AgaveAnonymousProxyCreationError:1051,WAC_AgaveOsfControlActivationError:1052,WAC_AgaveEntitlementRequestFailure:1053,WAC_AgaveManifestRequestFailure:1054,WAC_AgaveManifestAndEtokenRequestFailure:1055,WAC_FirstPartyAddInListRequestFailure:1056,WAC_SDX_DMSRequestFailed:1058,WAC_SDX_AssetIdNotInDMSResponse:1059,WAC_CustomFunctionsRegistrationError:1060,WAC_WopiHostCheckStatusNotTrusted:1061,WAC_WopiHostCheckStatusNotReady:1062},i.InvokeResultCode={S_OK:0,E_REQUEST_TIME_OUT:-2147471590,E_USER_NOT_SIGNED_IN:-2147208619,E_CATALOG_ACCESS_DENIED:-2147471591,E_CATALOG_REQUEST_FAILED:-2147471589,E_OEM_NO_NETWORK_CONNECTION:-2147208640,E_PROVIDER_NOT_REGISTERED:-2147208617,E_OEM_CACHE_SHUTDOWN:-2147208637,E_OEM_REMOVED_FAILED:-2147209421,E_CATALOG_NO_APPS:-1,E_GENERIC_ERROR:-1e3,S_HIDE_PROVIDER:10},i.OmexClientNames=function(){var e={},t=i.AppName;return e[t.ExcelWebApp]="WAC_Excel",e[t.WordWebApp]="WAC_Word",e[t.OutlookWebApp]="WAC_Outlook",e[t.AccessWebApp]="WAC_Access",e[t.PowerpointWebApp]="WAC_Powerpoint",e[t.OneNoteWebApp]="WAC_OneNote",e[t.VisioWebApp]="WAC_Visio",e}(),i.OmexAppVersions=function(){var e={},t=i.AppName;return e[t.ExcelWebApp]=i.AppVersion.excelwebapp,e[t.WordWebApp]=i.AppVersion.wordwebapp,e[t.OutlookWebApp]=i.AppVersion.outlookwebapp,e[t.AccessWebApp]=i.AppVersion.access,e[t.PowerpointWebApp]=i.AppVersion.powerpointwebapp,e[t.OneNoteWebApp]=i.AppVersion.onenotewebapp,e[t.VisioWebApp]=i.AppVersion.visiowebapp,e}(),i.ActivationTypes={V1Enabled:0,V1S2SEnabled:1,V2Enabled:2,V2S2SEnabled:3},i.ManifestRequestTypes={Manifest:1,Etoken:2,Both:3},i.HostInfoFlags={None:0,SharedApp:1,CustomFunction:2},i.MaxAppContextLength=10240,i.HostFeatureGateFlags={None:0,EnableSetAppContextInIFrameName:1,Enable3rdPartySetAppContextInIFrameName:2},i.SdxAssetIds={Ideas:"fa000000029",ExperimentationSdx:"fa000000059"},function(e){var t=null,n=function(){function n(){}return n.versionLessThan=function(e,t){return i.OsfManifestManager.versionLessThan(e,t)},n.ParseManifest=function(e,n,r){try{return new i.Manifest.Manifest(e,n)}catch(e){return s.RuntimeTelemetryHelper.LogExceptionTag("Invalid manifest:",e,r,20306078),t}},n.constructAddInId=function(t,n,r,o){return e.MsAjaxString.format("{0}|{1}|{2}|{3}|{4}|||","2",t,n,this.GetStoreTypeId(r).toString(),o)},n.GetStoreTypeId=function(e){return e==i.StoreType.OMEX?i.StoreTypeEnum.MarketPlace:e==i.StoreType.SPCatalog?i.StoreTypeEnum.Catalog:e==i.StoreType.SPApp?i.StoreTypeEnum.SPApp:e==i.StoreType.Exchange?i.StoreTypeEnum.Exchange:e==i.StoreType.FileSystem?i.StoreTypeEnum.FileSystem:e==i.StoreType.Registry?i.StoreTypeEnum.Registry:e==i.StoreType.OneDrive?i.StoreTypeEnum.OneDrive:e==i.StoreType.PrivateCatalog?i.StoreTypeEnum.PrivateCatalog:e==i.StoreType.HardCodedPreinstall?i.StoreTypeEnum.HardCodedPreinstall:e==i.StoreType.FirstParty?i.StoreTypeEnum.FirstParty:e==i.StoreType.UploadFileDevCatalog?i.StoreTypeEnum.UploadFileDevCatalog:-1},n.GetStoreTypeName=function(e){var n=parseInt(e);return n==i.StoreTypeEnum.MarketPlace?i.StoreType.OMEX:n==i.StoreTypeEnum.Catalog?i.StoreType.SPCatalog:n==i.StoreTypeEnum.SPApp?i.StoreType.SPApp:n==i.StoreTypeEnum.Exchange?i.StoreType.Exchange:n==i.StoreTypeEnum.FileSystem?i.StoreType.FileSystem:n==i.StoreTypeEnum.Registry?i.StoreType.Registry:n==i.StoreTypeEnum.OneDrive?i.StoreType.OneDrive:n==i.StoreTypeEnum.PrivateCatalog?i.StoreType.PrivateCatalog:n==i.StoreTypeEnum.HardCodedPreinstall?i.StoreType.HardCodedPreinstall:n==i.StoreTypeEnum.FirstParty?i.StoreType.FirstParty:n==i.StoreTypeEnum.UploadFileDevCatalog?i.StoreType.UploadFileDevCatalog:t},n}();e.ManifestUtil=n;var r=function(){function n(){}return n.failed=function(n,r,o){if(n.status!=e.DataServiceResultCode.Succeeded){var i={status:n.status,httpStatus:n.httpStatus};return o!=t&&(i.value=o),r(i),!0}return!1},n.retry=function(e,t){void 0===t&&(t={});var n=t.retries,r=void 0===n?3:n,o=t.factor,i=void 0===o?2:o,a=t.minTimeout,s=void 0===a?300:a,c=t.maxTimeout,u=void 0===c?1/0:c;return new Promise((function(t,n){var o=function(a){e().then(t,(function(e){a>=r?n(e):setTimeout((function(){return o(a+1)}),Math.min(s*Math.pow(i,a),u))}))};o(0)}))},n.limitRate=function(e,t){var n=[],r=-1/0,o=function(){var i=n.shift();n.length>0&&setTimeout(o,t),r=performance.now(),e.apply(void 0,i)};return function(){for(var e=[],i=0;i<arguments.length;i++)e[i-0]=arguments[i];0===n.length&&setTimeout(o,Math.max(0,t-(performance.now()-r))),n.push(e)}},n.withCache=function(e,t,r){var o="__OSF_AsyncCache_",i=t.forceUpdateCache,a=void 0!==i&&i,s=t.maxAgeInSecs,c=void 0===s?259200:s;if(!a&&n.Cache.hasOwnProperty(e))return Promise.resolve({cacheType:"memory",value:n.Cache[e]});var u=o+e,l="__OSF_AsyncCacheExpiry",d=Date.now();try{if(d>=n.NextCheckExpiry){var f=JSON.parse(localStorage.getItem(l))||{},p=!1;for(var m in n.NextCheckExpiry=1/0,f)d>f[m]?(localStorage.removeItem(o+m),delete f[m],p=!0):n.NextCheckExpiry=Math.min(n.NextCheckExpiry,f[m]);p&&localStorage.setItem(l,JSON.stringify(f))}if(!a&&localStorage.hasOwnProperty(u))return Promise.resolve({cacheType:"localStorage",value:localStorage.getItem(u)})}catch(e){}return r().then((function(t){n.Cache[e]=t;try{var r=JSON.parse(localStorage.getItem(l))||{};r[e]=d+1e3*c,n.NextCheckExpiry=Math.min(n.NextCheckExpiry,r[e]),localStorage.setItem(l,JSON.stringify(r)),localStorage.setItem(u,t)}catch(e){}return{cacheType:"none",value:t}}))},n.fetch=function(e,n){return void 0===n&&(n={}),new Promise((function(r,o){var i=new XMLHttpRequest,a=n.method,s=void 0===a?"GET":a,c=n.headers,u=void 0===c?{}:c,l=n.body,d=void 0===l?t:l;for(var f in i.onreadystatechange=function(){4==i.readyState&&r({ok:i.status>=200&&i.status<=299,status:i.status,statusText:i.statusText,text:function(){return Promise.resolve(i.responseText)},json:function(){return Promise.resolve(JSON.parse(i.responseText))}})},i.onerror=o,i.open(s,e,!0),u)i.setRequestHeader(f,u[f]);i.send(d)}))},n.Cache={},n.NextCheckExpiry=0,n}();e.AsyncUtil=r;var o=function(){function e(){}return e.register=function(e,t){this._registry[e]=t},e.resolve=function(e,n){var r=this,o=r._resolved[e];if(o!=t)return o;if((n=n||r._hostInfo)!=t){var i=r._registry[e];if(i==t)return t;r._resolved[e]=o=i(n)}return o},e.setHostContext=function(e){this._hostInfo=e},e.getHostContext=function(){return this._hostInfo},e._registry={},e._resolved={},e}();e.CatalogFactory=o}(l||(l={})),function(e){var t=function(){function t(e){this._initParams=e}return t.prototype.getEntitlementAsync=function(t,n,r){r({status:e.DataServiceResultCode.Failed,httpStatus:403})},t.prototype.getAndCacheManifest=function(t,n,r,o){o({status:e.DataServiceResultCode.Failed,httpStatus:404})},t.prototype.activateAsync=function(t,n){var r=this;r._initParams&&r._initParams.loaderParams?r._initParams.controlStatus===i.OsfControlStatus.ActivationFailed?n.fail(r._initParams.loaderParams,r._initParams.controlStatus):n.notifyUser(r._initParams.loaderParams):n.fail(e.LoaderUtil.error({description:Strings.OsfRuntime.L_AgaveActivationError_ERR,errorCode:i.ErrorStatusCodes.WAC_AgaveActivationError}),i.OsfControlStatus.ActivationFailed)},t.prototype.removeAsync=function(t,n,r){r({status:e.DataServiceResultCode.Failed,httpStatus:403})},t.prototype.getAppDetails=function(t,n,r,o){o({status:e.DataServiceResultCode.Failed,httpStatus:403})},t}();e.ForbiddenCatalog=t}(l||(l={})),function(e){var t=function(){var e=null;function t(){}return t.defaultTitle=function(e){switch(e){case i.InfoType.Information:return Strings.OsfRuntime.L_AgaveInformationTitle_TXT;case i.InfoType.Error:return Strings.OsfRuntime.L_AgaveErrorTile_TXT;case i.InfoType.Warning:return Strings.OsfRuntime.L_AgaveWarningTitle_TXT}return Strings.OsfRuntime.L_AgaveInformationTitle_TXT},t.fillMissing=function(n){return n.infoType=t.isNullOrUndefined(n.infoType)?i.InfoType.Information:n.infoType,n.title=n.title||t.defaultTitle(n.infoType),n.buttonTxt=n.buttonTxt||Strings.OsfRuntime.L_OkButton_TXT,n.buttonCallback=n.buttonCallback||e,n.url=n.url||e,n.urlButtonTxt=n.urlButtonTxt||e,n.dismissCallback=n.dismissCallback||e,n.reDisplay=!n.dismissCallback,n.displayDeactive=n.displayDeactive==e||n.displayDeactive,n.detailView=n.detailView||!1,n.logAsError=n.logAsError||!1,n.highPriority=n.highPriority||!1,n.retryAll=n.retryAll||!1,n.errorCode=n.errorCode?n.errorCode:0,n},t.error=function(n){return n.infoType=t.isNullOrUndefined(n.infoType)?i.InfoType.Error:n.infoType,n.logAsError=n.logAsError==e||n.logAsError,t.fillMissing(n)},t.warning=function(n){return n.infoType=t.isNullOrUndefined(n.infoType)?i.InfoType.Warning:n.infoType,n.logAsError=n.logAsError==e||n.logAsError,t.fillMissing(n)},t.showNotification=function(e,n){e.notifyUser(t.fillMissing(n))},t.showError=function(e,n){e.notifyUser(t.error(n))},t.showWarning=function(e,n){e.notifyUser(t.warning(n))},t.failWithWarning=function(e,n,r){r=t.isNullOrUndefined(r)?i.OsfControlStatus.ActivationFailed:r,e.fail(t.warning(n),r)},t.failWithError=function(e,n,r){r=t.isNullOrUndefined(r)?i.OsfControlStatus.ActivationFailed:r,e.fail(t.error(n),r)},t.isNullOrUndefined=function(t){return t===e||void 0===t},t}();e.LoaderUtil=t}(l||(l={})),function(e){var t=function(){function t(e,t){this.osfControl=e,this.trusted=t}return t.prototype.getRequirementsChecker=function(){return this.osfControl._contextActivationMgr.getRequirementsChecker()},t.prototype.load=function(t,n){var r=null,o=this,a=o,s=performance.now();o.osfControl.getReason()==Microsoft.Office.WebExtension.InitializationReason.Inserted&&(o.osfControl._retryActivate=r,o.osfControl._contextActivationMgr.retryAll(t.entitlement.assetId)),o.osfControl._status!==i.OsfControlStatus.NotActivated&&o.osfControl.deActivate();var c=t.manifest,u=o.osfControl;if(u._etoken=t.eToken,u._manifest=c,u._sourceLocationOverrideUrl?u._iframeUrl=u._sourceLocationOverrideUrl:u._sourceLocationOverrideResourceId?u._iframeUrl=c.getSourceLocationOverrideByResourceId(u._sourceLocationOverrideResourceId):u._iframeUrl=c.getDefaultSourceLocation(u._contextActivationMgr.getFormFactor()),u._iframeUrl&&u.updateUrlsForSdx(t.manifestUrl),u._permission=c.getPermission(),u._appDomains=c.getAppDomains(),u.processManifestForCustomFunctions(c),c.getExtendedOverridesUrl()&&u.downloadExtendedOverride(c),n!=r&&(u._iframeUrl=n.decorateUrl(u._iframeUrl)),u._contextActivationMgr._doesUrlHaveSupportedProtocol(u._iframeUrl)){n!=r&&n.preLoad(u,u._contextActivationMgr);var l=c.getDefaultDisplayName();u._isAddinCommands((function(e){e?(u._isvirtualOsfControl=!0,u.invokeVirtualOsfControlActivationCallback(c)):(a.osfControl._sdxTelemetryContext.iframeCreateStart=performance.now(),u._createIframeAndActivateOsfControl(l),a.osfControl._sdxTelemetryContext.iframeCreateEnd=performance.now())})),t.entitlement!=r&&t.entitlement.storeType===i.StoreType.Sdx&&e.SDXCatalog.recordActivity("IframeCreate",s,!0,[{name:"OsfControlId",string:u._id},{name:"AssetId",string:t.entitlement.assetId}]),n!=r&&n.postLoad(u,u._contextActivationMgr)}else e.LoaderUtil.failWithError(o,{description:Strings.OsfRuntime.L_AgaveManifestError_ERR,detailView:!0,errorCode:i.ErrorStatusCodes.E_MANIFEST_INVALID_VALUE_FORMAT})},t.prototype.skipTrust=function(){var e=this;return e.osfControl._contextActivationMgr._autoTrusted||e.osfControl.getTrustNoPrompt()||e.osfControl._isOsfControlInEmbeddingMode(e.osfControl)},t.prototype.hasConsent=function(){return this.trusted||this.isInsertion()},t.prototype.isInsertion=function(){return this.osfControl.getReason()==Microsoft.Office.WebExtension.InitializationReason.Inserted},t.prototype.setRetryCall=function(e){this.osfControl._retryActivate=e},t.prototype.askForTrust=function(e,t){var n=this;this.osfControl._showTrustError(e.clientName,e.displayName,e.providerName,e.iconUrl,e.entitlement.storeType,(function(){n.restartActivation(),t()}),e.url,e.isSSOAddin)},t.prototype.askForUpgrade=function(e,t){var n=this;e.buttonCallback=function(){n.restartActivation(),t()},this.notifyUser(e)},t.prototype.fail=function(e,t){var n=this.osfControl;n._status=t,this.notifyUser(e),n._contextActivationMgr.raiseOsfControlStatusChange(n)},t.prototype.notifyUser=function(e){var t=this.osfControl;e.id=t._id,t._contextActivationMgr.displayNotification(e)},t.prototype.restartActivation=function(){this.osfControl._restartActivate()},t.prototype.isForCustomFunctionSandbox=function(){return this.osfControl.isCustomFunctionSandbox()},t.prototype.setIsUpgrading=function(e){this.osfControl.setIsUpgrading(e)},t.prototype.getIsUpgrading=function(){return this.osfControl.getIsUpgrading()},t.prototype.setUpgradingFailed=function(e){this.osfControl.setUpgradingFailed(e)},t}();e.OsfControlLoader=t}(l||(l={})),function(e){var t=function(){function e(e){this._requirementsChecker=e}return e.prototype.getRequirementsChecker=function(){return this._requirementsChecker},e.prototype.load=function(){},e.prototype.skipTrust=function(){return!1},e.prototype.hasConsent=function(){return!1},e.prototype.setRetryCall=function(){},e.prototype.askForTrust=function(){},e.prototype.askForUpgrade=function(){},e.prototype.fail=function(){},e.prototype.notifyUser=function(){},e.prototype.restartActivation=function(){},e.prototype.isForCustomFunctionSandbox=function(){return!1},e.prototype.setIsUpgrading=function(){},e.prototype.getIsUpgrading=function(){return!1},e.prototype.setUpgradingFailed=function(){},e}();e.PreCacher=t}(l||(l={})),function(e){var t=function(){var t=null;function n(){var e=this;e.isReady=!1,e.clientEndPoint=t,e.pendingCallbacks=[],e.iframe=t,e._pendingRequests={},e.conversationId=i.OUtil.generateConversationId()}return n.prototype.invokeProxyCommandAsync=function(n,r,o){var i=this,a=r||r.correlationId||"";this.prepareProxy((function(c){c.value!=t?i.invokeProxyMethodAsync(n,o,r):(s.RuntimeTelemetryHelper.LogExceptionTag("clientendpoint is invalid",t,a,18940552),o({status:e.DataServiceResultCode.ProxyNotReady}))}),(function(){s.RuntimeTelemetryHelper.LogExceptionTag("proxysetup failure",t,a,18940553),o({status:e.DataServiceResultCode.ProxyNotReady})}))},n.prototype.prepareProxy=function(){},n.prototype.doesUrlHaveSupportedProtocol=function(e){var n=!1;e&&(n=decodeURIComponent(e).match(/^https?:\/\/.+$/gi)!=t);return n},n.prototype.invokeProxyMethodAsync=function(n,r,o){var a,c=o||o.correlationId||"",u=[this.clientEndPoint._targetUrl,n];for(var l in o)("string"===(a=typeof o[l])||"number"===a||"boolean"===a)&&u.push(o[l]);var d=u.join("."),f=this._pendingRequests,p={onCompleted:r,methodName:n,correlationId:c},m=f[d];if(m)m.push(p);else{f[d]=[p];o||(o={}),o.officeVersion=i.Constants.ThreePartsFileVersion,this.clientEndPoint.invoke(n,(function(n,r){var o=t,i=0,a=e.DataServiceResultCode.Failed;0===n&&r.status&&(o=r.result,a=e.DataServiceResultCode.Succeeded);var c=f[d];delete f[d];for(var u=c.length,l=0;l<u;l++){var p=c.shift();try{r&&r.failureInfo&&(i=r.failureInfo.statusCode||t,r.failureInfo.result=r.result,s.RuntimeTelemetryHelper.LogProxyFailure(p.correlationId,p.methodName,r.failureInfo)),p.onCompleted({status:a,httpStatus:i,value:o})}catch(t){var m="invokeProxyMethodAsync failed";e.WACUtils.logExceptionToBrowserConsole(m,t),s.RuntimeTelemetryHelper.LogExceptionTag(m,t,p.correlationId,19015124)}}}),o)}},n}();e.ProxyBase=t}(l||(l={})),function(e){!function(e){var t="ManifestRequest",n="KilledAppsCheck",r="AppStateCheck",o="EntitlementCheck",i="Authentication",a="ServerCall",s="Activation";e[e[s]=0]=s,e[e[a]=1]=a,e[e[i]=2]=i,e[e[o]=3]=o,e[e[r]=4]=r,e[e[n]=5]=n,e[e[t]=6]=t}(e.Activity||(e.Activity={}));var t=e.Activity;!function(e){var t="DmsRequestCachedFlag",n="ManifestRequestType",r="ActivationRuntimeType",o="AppStateDataInvalidFlag",i="AppStateDataCachedFlag",a="ManifestDataInvalidFlag",s="OmexHasEntitlementFlag",c="ManifestDataCachedFlag",u="ManifestTrustCachedFlag",l="RetryCount",d="AnonymousFlag";e[e[d]=0]=d,e[e[l]=1]=l,e[e[u]=2]=u,e[e[c]=3]=c,e[e[s]=4]=s,e[e[a]=5]=a,e[e[i]=6]=i,e[e[o]=7]=o,e[e[r]=8]=r,e[e[n]=9]=n,e[e[t]=10]=t}(e.FlagName||(e.FlagName={}));var n=e.FlagName,r=function(){function r(e,t,n,r,o){var i=this;i.correlationId=e,i.perfContext=t,i.appInfo=n,i.assetId=r,i.instanceId=o}return r.prototype.startActivity=function(o){var a=this;switch(o){case t.Activation:var c=i.ActivationTypes.V2Enabled;return 0==(15&a.appInfo)&&e.S2SOmexCatalogService._requestHandler&&(c=i.ActivationTypes.V2S2SEnabled),s.AppLoadTimeHelper.ActivationStart(a.perfContext,a.appInfo,a.assetId,a.correlationId,a.instanceId,c),void a.setBits(n.ActivationRuntimeType,c)}s.AppLoadTimeHelper.StartStopwatch(a.perfContext,r.StopWatchName[o])},r.prototype.stopActivity=function(e){s.AppLoadTimeHelper.StopStopwatch(this.perfContext,r.StopWatchName[e])},r.prototype.setFlag=function(e,t){var n=t?2:1;this.setBits(e,n)},r.prototype.setBits=function(e,t){s.AppLoadTimeHelper.SetBit(this.perfContext,t,r.FlagOffsetMap[e],2)},r.FlagOffsetMap=[0,2,5,7,9,11,13,15,17,19,21],r.StopWatchName=["Stage1Time","Stage4Time","Stage5Time","Stage7Time","Stage9Time","Stage8Time","Stage10Time"],r}();e.ActivationTelemetryContext=r;var o=function(){function e(e){this.correlationId=e}return e.prototype.startActivity=function(){},e.prototype.stopActivity=function(){},e.prototype.setFlag=function(){},e.prototype.setBits=function(){},e}();e.AddinCommandsTelemetryContext=o;var a=function(){function e(e){this.correlationId=e}return e.prototype.startActivity=function(){},e.prototype.stopActivity=function(){},e.prototype.setFlag=function(){},e.prototype.setBits=function(){},e}();e.InsertDialogTelemetryContext=a;var c=function(){function e(){}return e.prototype.startActivity=function(){},e.prototype.stopActivity=function(){},e.prototype.setFlag=function(){},e.prototype.setBits=function(){},e}();e.SimpleTelemetryContext=c}(l||(l={})),function(e){var t=null,n=function(){var n=".";function r(n,r){void 0===r&&(r=t),this._initParam=n,this._cacheManager=r||new e.AppsDataCacheManager(i.OUtil.getLocalStorage(),new e.SafeSerializer)}return r.prototype.getEntitlementAsync=function(n,r,o){var a=this,s=a,c=[],u=[],l=n?a.getUploadFileDevCatalogAddinCommandsMyAddinsCacheKey():a.getUploadFileDevCatalogAddinsCacheKey(),d=a._cacheManager.GetCacheItem(l);d!=t&&(d.forEach((function(n){var r=s._cacheManager.GetCacheItem(s.getUploadFileDevCatalogManifestCacheKey(n));if(r!=t){var o=e.ManifestUtil.ParseManifest(r,s._initParam.appUILocale);if(o==t)return;var a={assetId:n,appVersion:o.getMarketplaceVersion(),storeId:"developer",storeType:i.StoreType.UploadFileDevCatalog,targetType:o.getTarget()};u.push(a),c.push(n)}})),c.length!=d.length&&(c.length>0?a._cacheManager.SetCacheItem(l,c):a._cacheManager.RemoveCacheItem(l))),o({status:e.DataServiceResultCode.Succeeded,value:u})},r.prototype.getAndCacheManifest=function(n,o,a,s){var c=this,u=i.OsfManifestManager.getCachedManifest(n.assetId,n.appVersion);if(u==t){var l=function(e,r,o){var i=c._cacheManager.GetCacheItem(c.getUploadFileDevCatalogManifestCacheKey(n.assetId));i==t&&e>=1?setTimeout((function(){return l(e-1,2*r,o)}),r):o(i)};l(r.GetManifestRetryLimit,r.GetManifestRetryWaitMs,(function(r){var o;r!=t&&(o=e.ManifestUtil.ParseManifest(r,c._initParam.appUILocale))!=t&&i.OsfManifestManager.cacheManifest(n.assetId,n.appVersion,o),s({status:o!=t?e.DataServiceResultCode.Succeeded:e.DataServiceResultCode.Failed,value:o})}))}else s({status:e.DataServiceResultCode.Succeeded,value:u})},r.prototype.activateAsync=function(n,r,o){var a=this;this.getAndCacheManifest(n,n.storeId,o,(function(s){if(s.status!=e.DataServiceResultCode.Succeeded)e.LoaderUtil.failWithError(r,{description:Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){r.restartActivation(),a.activateAsync(n,r,o)},errorCode:i.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE});else{var c=e.HostFeatureEnabledInfo.getHostFeatureEnabledInfo();if(c&&c.enableSingleSignOnForAddin&&!r.isForCustomFunctionSandbox())s.value;r.load({entitlement:n,eToken:"",manifest:s.value},t)}}))},r.prototype.removeAsync=function(t,n,r){r({status:e.DataServiceResultCode.Failed})},r.prototype.getAppDetails=function(t,n,r,o){o({status:e.DataServiceResultCode.Failed})},r.prototype.validateAndCacheNewManifest=function(e,t,n,r){return!!this.validateAddinIdAndVersion(e,t)&&(this.cacheManifest(e,t,n,r),!0)},r.prototype.localCacheAddinCommands=function(e){this.cacheMyAddins(this.getUploadFileDevCatalogAddinCommandsMyAddinsCacheKey(),e)},r.prototype.validateAddinIdAndVersion=function(e,t){return r.idRegExp.test(e)&&r.versionRegExp.test(t)},r.prototype.cacheManifest=function(e,t,n,r){var o=this;i.OsfManifestManager.cacheManifest(e,t,r),o.cacheMyAddins(o.getUploadFileDevCatalogAddinsCacheKey(),e),o._cacheManager.SetCacheItem(o.getUploadFileDevCatalogManifestCacheKey(e),n)},r.prototype.cacheMyAddins=function(e,n){var r=this._cacheManager.GetCacheItem(e);r==t&&(r=[]),r.lastIndexOf(n)<0&&(r.push(n),this._cacheManager.SetCacheItem(e,r))},r.prototype.getUploadFileDevCatalogAddinsCacheKey=function(){return r.UploadFileCatalogCacheKey.myAddins+n+this._initParam.appName+n+this._initParam.userNameHashCode},r.prototype.getUploadFileDevCatalogAddinCommandsMyAddinsCacheKey=function(){return r.UploadFileCatalogCacheKey.addinCommandsMyAddins+n+this._initParam.appName+n+this._initParam.userNameHashCode},r.prototype.getUploadFileDevCatalogManifestCacheKey=function(e){return r.UploadFileCatalogCacheKey.manifest+n+this._initParam.appName+n+e},r.UploadFileCatalogCacheKeyPrefix="__OSF_UPLOADFILE.",r.UploadFileCatalogCacheKey={myAddins:r.UploadFileCatalogCacheKeyPrefix+"MyAddins",addinCommandsMyAddins:r.UploadFileCatalogCacheKeyPrefix+"AddinCommandsMyAddins",manifest:r.UploadFileCatalogCacheKeyPrefix+"Manifest"},r.idRegExp=new RegExp("[\\w-]+"),r.versionRegExp=new RegExp("(\\d{1,2}.)*\\d{1,2}"),r.GetManifestRetryLimit=4,r.GetManifestRetryWaitMs=500,r}();e.CatalogFactory.register(i.StoreType.UploadFileDevCatalog,(function(r){return r.enableUploadFileDevCatalog?new n({appName:r.appName,appUILocale:r.appUILocale,userNameHashCode:r.userNameHashCode}):new e.ForbiddenCatalog(t)}));var r=function(){var t="Should never here";function n(e,t){this._catalog=e,this._storeType=t}return n.prototype.validateAndCacheNewManifest=function(){throw t},n.prototype.getEntitlementsAsync=function(t,n,r,o){this._catalog.getEntitlementAsync(n,new e.AddinCommandsTelemetryContext(i.OUtil.Guid.generateNewGuid()),(function(e){o(e.value)}),!1,r)},n.prototype.getManifestAsync=function(){throw t},n.prototype.localCacheAddinCommands=function(e,t,n,r){this._storeType==i.StoreType.UploadFileDevCatalog&&this._catalog.localCacheAddinCommands(t,n,r)},n}(),o=function(){function n(){}return n.createAddinDataProvider=function(n){var o=e.CatalogFactory.resolve(n);return o==t?t:new r(o,n)},n}();e.AddinDataProviderFactory=o}(l||(l={})),function(e){!function(e){var t="Unauthenticated",n="UnknownUserType",r="PrxoyUrlEmpty",o="ProxyNotReady",i="Succeeded";e[e[i]=1]=i,e[e.Failed=0]="Failed",e[e[o]=-1]=o,e[e[r]=-2]=r,e[e[n]=2]=n,e[e[t]=3]=t}(e.DataServiceResultCode||(e.DataServiceResultCode={}));e.DataServiceResultCode}(l||(l={})),function(e){var t=function(){var t=null;function n(n,r){void 0===r&&(r=t),this._initParam=n,this._cacheManager=r||new e.AppsDataCacheManager(i.OUtil.getLocalStorage(),new e.SafeSerializer)}return n.LogFirstPartyCatalogMonitoringError=function(e,n){s.RuntimeTelemetryHelper.LogExceptionTag("First Party Catalog Error AssetId: "+n+" Message: "+e,t,t,39068e3)},n.prototype.getEntitlementAsync=function(){throw new Error("in firstParty get Entitlementasync")},n.prototype.getAndCacheManifest=function(){throw new Error("in firstParty getAndCacheManifest")},n.prototype.removeAsync=function(){throw new Error("in firstParty removeAsync")},n.prototype.getAppDetails=function(){throw new Error("in firstParty getappDetails")},n.prototype.TryFallBackFirstPartyAddInList=function(r,o,i){var a=this._cacheManager.GetCacheItem(e.CacheConsts.firstPartyAddinListCacheKey,!1);a?(n.LogFirstPartyCatalogMonitoringError("Falling back to stale 1st party add-ins list.",o),i({status:e.DataServiceResultCode.Succeeded,value:a})):i({status:e.DataServiceResultCode.Failed,value:t})},n.prototype.GetFirstyPartyAddInsInfo=function(n,r,o,i){var a=this,c=this._cacheManager.GetCacheItem(e.CacheConsts.firstPartyAddinListCacheKey,!0,t,t,!1);if(c){var u={addInList:c,refreshRate:t};i({status:e.DataServiceResultCode.Succeeded,value:u})}else n.getFirstPartyAddInList((function(n){if(n.status==e.DataServiceResultCode.Succeeded){var c=t;try{c=e.OmexXmlProcessor.ProcessFirstPartyAddInList(n.value)}catch(e){return s.RuntimeTelemetryHelper.LogExceptionTag("Problem parsing first party list.",e,r.correlationId,34366472),void a.TryFallBackFirstPartyAddInList(r,o,i)}a._cacheManager.SetCacheItem(e.CacheConsts.firstPartyAddinListCacheKey,c.addInList,c.refreshRate/e.CacheConsts.hourToDayConversionFactor),i({status:e.DataServiceResultCode.Succeeded,value:c})}else a.TryFallBackFirstPartyAddInList(r,o,i)}))},n.prototype.TryFallBackFirstPartyManifest=function(r,o,i){var a=this.ReadFirstPartyManifestFromLocalStorage(o,r);a?(n.LogFirstPartyCatalogMonitoringError("Falling back to stale manifest.",r),i({status:e.DataServiceResultCode.Succeeded,value:a})):i({status:e.DataServiceResultCode.Failed,value:t})},n.prototype.ReadFirstPartyManifestFromLocalStorage=function(n,r){var o=i.OUtil.formatString(e.CacheConsts.firstPartyManifestCacheKey,r),a=this._cacheManager.GetCacheItem(o,!1);return a?e.ManifestUtil.ParseManifest(a,this._initParam.appUILocale,n.correlationId):t},n.prototype.GetCachedManifest=function(e,t){var n=i.OsfManifestManager.getCachedManifest(t,"");return n||(n=this.ReadFirstPartyManifestFromLocalStorage(e,t))&&i.OsfManifestManager.cacheManifest(t,"",n),n},n.prototype.GetFirstPartyManifest=function(t,n,r,o){var a=this,s=this.GetCachedManifest(n,r.assetId);if(!s||i.OsfManifestManager.versionLessThan(s.getMarketplaceVersion(),r.version)){var c=i.OUtil.formatString("{0}/{1}",this._initParam.firstPartyManifestCDNUrl,r.path);t.getFirstPartyManifest(c,(function(t){if(t.status==e.DataServiceResultCode.Succeeded){var s=e.ManifestUtil.ParseManifest(t.value,a._initParam.appUILocale,n.correlationId);if(s){i.OsfManifestManager.cacheManifest(r.assetId,"",s);var c=i.OUtil.formatString(e.CacheConsts.firstPartyManifestCacheKey,r.assetId);a._cacheManager.SetCacheItem(c,t.value),o({status:e.DataServiceResultCode.Succeeded,value:s})}else a.TryFallBackFirstPartyManifest(r.assetId,n,o)}else a.TryFallBackFirstPartyManifest(r.assetId,n,o)}))}else o({status:e.DataServiceResultCode.Succeeded,value:s})},n.prototype.getDataService=function(n,r){var o=this,i=o;if(o._dataService==t){var a={status:e.DataServiceResultCode.Failed,value:t},s=function(t,n){t.status==e.DataServiceResultCode.Succeeded?(i._dataService=n,a.value=n,a.status=e.DataServiceResultCode.Succeeded,r(a)):(a.httpStatus=t.httpStatus,r(a))},c=e.ProxyBasedCatalogService.getFirstPartyInstance(o._initParam);c.prepareProxy(n.correlationId,(function(e){s(e,c)}))}else r({status:e.DataServiceResultCode.Succeeded,value:o._dataService})},n.prototype.createActivityScope=function(t,n){var r=this;this.getDataService(t,(function(o){if(!e.AsyncUtil.failed(o,n)){var i=o.value,a={cacheManager:r._cacheManager,cachePrefix:e.CacheConsts.anonymousCacheKeyPrefix,cid:i.getCID(),anonymous:!0,telemetryContext:t},s=i.createScope(a);n({status:e.DataServiceResultCode.Succeeded,value:s})}}))},n.prototype.activateAsync=function(r,o,a){var s=this,c=s;a.startActivity(e.Activity.Activation),a.startActivity(e.Activity.ServerCall);var u=e.HostFeatureEnabledInfo.getHostFeatureEnabledInfo(),l=u&&u.enableFirstPartySDXErrorMessages;if(s._cacheManager.GetCacheItem(e.CacheConsts.firstPartyAddinListCacheKey,!0,t,t,!1)){var d=s.GetCachedManifest(a,r.assetId);if(d)return a.stopActivity(e.Activity.ServerCall),void o.load({entitlement:r,manifest:d,eToken:""},t)}s.createActivityScope(a,(function(s){if(s.status!=e.DataServiceResultCode.Succeeded)return n.LogFirstPartyCatalogMonitoringError("Failed to create 1st party activity scope.",r.assetId),void e.LoaderUtil.failWithError(o,{title:l?Strings.OsfRuntime.L_AgaveErrorTile_TXT_FirstParty:Strings.OsfRuntime.L_AgaveErrorTile_TXT,description:l?Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR_FirstParty:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){o.restartActivation(),c.activateAsync(r,o,a)},errorCode:i.ErrorStatusCodes.WAC_AgaveAnonymousProxyCreationError});var u=s.value;c.GetFirstyPartyAddInsInfo(u,a,r.assetId,(function(s){if(s.status!=e.DataServiceResultCode.Succeeded)return n.LogFirstPartyCatalogMonitoringError("Failed get list of 1st party addIns.",r.assetId),void e.LoaderUtil.failWithError(o,{title:l?Strings.OsfRuntime.L_AgaveErrorTile_TXT_FirstParty:Strings.OsfRuntime.L_AgaveErrorTile_TXT,description:l?Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR_FirstParty:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){o.restartActivation(),c.activateAsync(r,o,a)},errorCode:i.ErrorStatusCodes.WAC_FirstPartyAddInListRequestFailure});var d=s.value.addInList[r.assetId];if(!d)return n.LogFirstPartyCatalogMonitoringError("Could not find 1st party addin assetId in list.",r.assetId),void e.LoaderUtil.failWithError(o,{title:l?Strings.OsfRuntime.L_AgaveErrorTile_TXT_FirstParty:Strings.OsfRuntime.L_AgaveErrorTile_TXT,description:l?Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR_FirstParty:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){o.restartActivation(),c.activateAsync(r,o,a)},errorCode:i.ErrorStatusCodes.WAC_FirstPartyAddInListRequestFailure});a.startActivity(e.Activity.ManifestRequest),c.GetFirstPartyManifest(u,a,d,(function(s){if(s.status!=e.DataServiceResultCode.Succeeded)return n.LogFirstPartyCatalogMonitoringError("Could not get 1st party manifest.",r.assetId),void e.LoaderUtil.failWithError(o,{title:l?Strings.OsfRuntime.L_AgaveErrorTile_TXT_FirstParty:Strings.OsfRuntime.L_AgaveErrorTile_TXT,description:l?Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR_FirstParty:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){o.restartActivation(),c.activateAsync(r,o,a)},errorCode:i.ErrorStatusCodes.WAC_AgaveManifestRequestFailure});a.stopActivity(e.Activity.ManifestRequest),a.stopActivity(e.Activity.ServerCall);var u=s.value;o.load({entitlement:r,manifest:u,eToken:""},t)}))}))}))},n}();e.FirstPartyCatalog=t,e.CatalogFactory.register(i.StoreType.FirstParty,(function(n){if(n.osfOmexBaseUrl&&n.firstPartyManifestCDNUrl){var r,o=n.osfOmexBaseUrl.indexOf(i.Constants.ProtocolSeparator);r=o>=0?n.osfOmexBaseUrl.substr(o):i.Constants.ProtocolSeparator+n.osfOmexBaseUrl;var a=i.Constants.Https+r;return new t({appName:n.appName,appUILocale:n.appUILocale,AppVersion:n.appVersion,clientMode:n.clientMode,docUrl:n.docUrl,omexBaseUrl:a,omexForceAnonymous:!0,firstPartyManifestCDNUrl:n.firstPartyManifestCDNUrl})}return new e.ForbiddenCatalog({loaderParams:e.LoaderUtil.error({description:Strings.OsfRuntime.L_AgaveOmexNotConfigured_ERR,errorCode:i.ErrorStatusCodes.E_TRUSTCENTER_CATALOG_UNTRUSTED_ADMIN_CONTROLLED}),controlStatus:i.OsfControlStatus.ActivationFailed})}))}(l||(l={})),function(e){var t=function(){var e="OMEX_clearCacheAsync",t="OMEX_removeCacheAsync",n="OMEX_getAppStateAsync",r="OMEX_getKilledAppsAsync",o="OMEX_getManifestAndETokenAsync";function i(){}return i.CheckProxyIsReady="OMEX_isProxyReady",i.Gated_GetManifestAndEToken=o,i.Gated_GetKilledApps=r,i.Gated_GetEntitlementSummary="OMEX_getEntitlementSummaryAsync",i.Gated_GetAppState=n,i.Gated_RemoveApp="OMEX_removeAppAsync",i.Gated_RemoveCache=t,i.Gated_ClearCache=e,i.UnGated_GetAppDetails="OMEX_getAppDetailsAsync",i.UnGated_GetRecommendations="OMEX_getRecommendationsAsync",i.UnGated_ClearCache=e,i.Anonymous_GetManifestAndEToken=o,i.Anonymous_GetKilledApps=r,i.Anonymous_GetAppState=n,i.Anonymous_RemoveCache=t,i.Anonymous_ClearCache=e,i.Anonymous_GetAuthNStatus="OMEX_getAuthNStatus",i.Anonymous_GetFirstPartyAddInList="OMEX_getFirstPartyAddInListAsync",i.Anonymous_GetFirstPartyManifest="OMEX_getFirstPartyManifestAsync",i}();e.OmexProxyMethods=t;var n=function(n){var r=null;function o(e){n.call(this),this.osfOmexBaseUrl=e}return c(o,n),o.prototype.prepareProxy=function(e,t,n){var i=this;n&&(i.isReady=!1,o.resetProxy(i)),i.isReady?e({status:r,value:{clientEndpoint:i.clientEndPoint}}):i.clientEndPoint?i.pendingCallbacks.push([e,t]):i.createProxy(e,t)},o.resetProxy=function(e){Microsoft.Office.Common.XdmCommunicationManager.getClientEndPoint(e.conversationId)&&Microsoft.Office.Common.XdmCommunicationManager.deleteClientEndPoint(e.conversationId),e.iframe&&(i.OUtil.removeEventListener(e.iframe,"load",e.iframeOnload),e.iframe.parentNode.removeChild(e.iframe),e.iframe=r),e.clientEndPoint=r},o.prototype.createProxy=function(n,a){var c=this;try{!c.doesUrlHaveSupportedProtocol(c.proxyUrl)&&a({status:r,value:{errorMessage:"Protocal of proxyUrl is not supported."}});var u=document.createElement("iframe");u.setAttribute("id",c.proxyName),u.setAttribute("name",c.proxyName);var l=c.proxyUrl+"?"+c.conversationId,d=window.location.origin;l=i.OUtil.addXdmInfoAsHash(l,c.conversationId+"|"+c.proxyName+"|"+d),l=i.OUtil.addSerializerVersionAsHash(l,i.SerializerVersion.Browser),l=i.OUtil.addFlightsAsHash(l,JSON.stringify(i.Flights)),u.setAttribute("src",l),u.setAttribute("scrolling","auto"),u.setAttribute("border","0"),u.setAttribute("width","0"),u.setAttribute("height","0"),u.setAttribute("style","position: absolute; left: -100px; top:0px;"),document.body.appendChild(u);var f=c,p=function(){if(f.clientEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(f.conversationId,u.contentWindow,f.proxyUrl),f.clientEndPoint)f.clientEndPoint.invoke(t.CheckProxyIsReady,(function(e,t){var n=f.pendingCallbacks.length;if(0!=n){var i=r;0===e&&t.status?(f.isReady=!0,i={status:r,value:{clientEndpoint:f.clientEndPoint}}):(o.resetProxy(f),i={status:r,value:{errorMessage:"isProxyReadyCallback failed, error code "+e}});for(var a=0;a<n;a++){var s=f.pendingCallbacks.shift();f.isReady?s[0](i):s[1](i)}}}),{__timeout__:500});else{var e="Unexpected error, iframe loaded again after failing OMEX_isProxyReady";s.RuntimeTelemetryHelper.LogExceptionTag(e,r,r,18121820),a({status:r,value:{errorMessage:e}})}i.OUtil.set_entropy((new Date).getTime())};i.OUtil.addEventListener(u,"load",p),c.iframeOnload=p,c.pendingCallbacks.push([n,a]),c.iframe=u}catch(t){var m="Error creating client endpoint with proxyUrl = ["+c.proxyUrl+"], msg:"+e.WACUtils.serializeObjectToString(t);a({status:r,value:{errorMessage:m}})}},o}(e.ProxyBase);e.OmexProxyBase=n}(l||(l={})),function(e){var t=function(t){function n(e){var n=this;t.call(n,e),n.proxyName="__omexExtensionAnonymousProxy",n.proxyUrl=n.osfOmexBaseUrl+"/anonymousserviceextension.aspx"}return c(n,t),n.prototype.getManifestAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.Anonymous_GetManifestAndEToken,t,(function(t){null!=t.value&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertClientAppInstallInfo(t.value)),n(t)}))},n.prototype.getFirstPartyAddInListAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.Anonymous_GetFirstPartyAddInList,t,(function(e){n(e)}))},n.prototype.getFirstPartyManifestAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.Anonymous_GetFirstPartyManifest,t,(function(e){n(e)}))},n.prototype.getAppStateAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.Anonymous_GetAppState,t,(function(t){null!=t.value&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertAppState(t.value)),n(t)}))},n.prototype.getKilledAppAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.Anonymous_GetKilledApps,t,(function(t){null!=t.value&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertKilledAppsInfo(t.value)),n(t)}))},n.prototype.getAuthNStatusAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.Anonymous_GetAuthNStatus,t,n)},n}(e.OmexProxyBase);e.AnonymousOmexProxy=t}(l||(l={})),function(e){var t=function(t){var n=null;function r(e){var n=this;t.call(n,e),n.proxyName="__omexExtensionGatedProxy",n.proxyUrl=n.osfOmexBaseUrl+"/gatedserviceextension.aspx"}return c(r,t),r.prototype.getOmexEntitlementsAsync=function(t,r){this.invokeProxyCommandAsync(e.OmexProxyMethods.Gated_GetEntitlementSummary,t,(function(t){t.value!=n&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertEntitlementInfo(t.value)),r(t)}))},r.prototype.getManifestAndETokenAsync=function(t,r){this.invokeProxyCommandAsync(e.OmexProxyMethods.Gated_GetManifestAndEToken,t,(function(t){t.value!=n&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertClientAppInstallInfo(t.value)),r(t)}))},r.prototype.getAppStateAsync=function(t,r){this.invokeProxyCommandAsync(e.OmexProxyMethods.Gated_GetAppState,t,(function(t){t.value!=n&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertAppState(t.value)),r(t)}))},r.prototype.getKilledAppAsync=function(t,r){this.invokeProxyCommandAsync(e.OmexProxyMethods.Gated_GetKilledApps,t,(function(t){t.value!=n&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertKilledAppsInfo(t.value)),r(t)}))},r.prototype.removeApps=function(t,r){this.invokeProxyCommandAsync(e.OmexProxyMethods.Gated_RemoveApp,t,(function(t){t.value!=n&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertRemoveAppResponse(t.value)),r(t)}))},r}(e.OmexProxyBase);e.GatedOmexProxy=t}(l||(l={})),function(e){var t,n="",r=null;!function(e){var t="AnonymousUser",n="AuthedUser",r="NotDetected";e[e[r]=0]=r,e[e[n]=1]=n,e[e[t]=2]=t}(t||(t={}));var o=function(){function o(n){var r=this;r.currentUserType=t.NotDetected,r.omexAuthNStatus=i.OmexAuthNStatus.NotAttempted,r.omexAuthConnectTries=1,r.initParams=n,r.gatedProxy=new e.GatedOmexProxy(n.omexBaseUrl),r.ungatedProxy=new e.UnGatedOmexProxy(n.omexBaseUrl),r.anonymousProxy=new e.AnonymousOmexProxy(n.omexBaseUrl)}return o.getInstance=function(e){return o._instance==r&&(o._instance=new o(e)),o._instance},o.getFirstPartyInstance=function(e){if(o._firstPartyInstance==r){var t=new o(e);t._isFirstParty=!0,t.omexAuthNStatus=i.OmexAuthNStatus.Anonymous,this._firstPartyInstance=t}return o._firstPartyInstance},o.prototype.prepareProxy=function(o,i){var a=this;o=o||n;this.ensureOmexProxySetUp(o,(function(n){var o;n&&n.status!=r?n.status:e.DataServiceResultCode.ProxyNotReady;n&&n.value&&(a._isFirstParty?o=!0:n.value.currentUserType&&(n.value.currentUserType==t.AuthedUser?o=!1:n.value.currentUserType==t.AnonymousUser&&(o=!0))),i({status:n.status,value:{anonymous:o}})}))},o.prototype.createScope=function(e){return new c(e,this)},o.prototype.getCID=function(){switch(this.currentUserType){case t.AuthedUser:return this._cid;case t.AnonymousUser:return n}throw"not initialized"},o.prototype.ensureOmexProxySetUp=function(n,o){var a=this;if(a.currentUserType==t.NotDetected||!a.anonymousProxy.isReady&&!a.gatedProxy.isReady){var c=a,u=function(){c.currentUserType=t.AuthedUser,o({status:e.DataServiceResultCode.Succeeded,value:c})},l=function(){c.omexAuthConnectTries<i.Constants.AuthenticatedConnectMaxTries?(c.omexAuthConnectTries++,c.omexAuthNStatus!==i.OmexAuthNStatus.CheckFailed?c.anonymousProxy.prepareProxy(d,p):c.gatedProxy.prepareProxy(u,l)):(s.RuntimeTelemetryHelper.LogExceptionTag("exceed maximum tries and fail",r,n,18657693),c.anonymousProxy.prepareProxy(f,p))},d=function(e){if(e&&e.value){c.anonymousProxy.getAuthNStatusAsync({correlationId:n},(function(e){if(e.status===i.ProxyCallStatusCode.Succeeded){var t=e.value;t==i.OmexAuthNStatus.Authenticated?(c.omexAuthNStatus=i.OmexAuthNStatus.Authenticated,c.gatedProxy.prepareProxy(u,l)):t!=i.OmexAuthNStatus.Anonymous&&t!=i.OmexAuthNStatus.Unknown||(c.omexAuthNStatus=i.OmexAuthNStatus.Anonymous,c.anonymousProxy.prepareProxy(f,p))}else s.RuntimeTelemetryHelper.LogExceptionTag("auth check failure.",r,n,18657694),c.omexAuthNStatus=i.OmexAuthNStatus.CheckFailed,c.initParams.omexForceAnonymous?c.anonymousProxy.prepareProxy(f,p):c.gatedProxy.prepareProxy(u,l)}))}else s.RuntimeTelemetryHelper.LogExceptionTag("GetAuthNStatus callback param invalid",r,n,18657695)},f=function(n){c.omexAuthNStatus==i.OmexAuthNStatus.NotAttempted?d(n):(c.currentUserType=t.AnonymousUser,o({status:e.DataServiceResultCode.Succeeded,value:c}))},p=function(){s.RuntimeTelemetryHelper.LogExceptionTag("create anonymous proxy failure",r,n,18657696),o({status:e.DataServiceResultCode.ProxyNotReady})};c.initParams.omexForceAnonymous?c.anonymousProxy.prepareProxy(f,p):c.gatedProxy.prepareProxy(u,l)}else o({status:e.DataServiceResultCode.Succeeded,value:a})},o}();e.ProxyBasedCatalogService=o;var a=function(){function e(){}return e.dummyApplicationName="unused",e}(),c=function(){var o="contentMarket",c="assetID",l="applicationName",d="errors";function f(e,t){var r=this;r._build=i.Constants.FileVersion,r._catalogService=t,r._appVersion=i.OmexAppVersions[r._catalogService.initParams.appName],r._clientName=i.OmexClientNames[r._catalogService.initParams.appName],r._clientVersion=u.getClientVersionFromWACAppVersion(r._catalogService.initParams.AppVersion),r._correlationId=e.telemetryContext.correlationId||n}return f.prototype.getFirstPartyAddInList=function(e){var t=this.buildOmexRequestParameters();t[d]={},this._catalogService.anonymousProxy.getFirstPartyAddInListAsync(t,e)},f.prototype.getFirstPartyManifest=function(e,t){var n=this.buildOmexRequestParameters();n[d]={},n.manifestUrl=e,this._catalogService.anonymousProxy.getFirstPartyManifestAsync(n,t)},f.prototype.tryFail=function(t,n,r){return t!=e.DataServiceResultCode.Succeeded&&(r({status:t}),!0)},f.prototype.isUserTypeValid=function(e){return e!==t.NotDetected||(s.RuntimeTelemetryHelper.LogExceptionTag("userType is invalid.",r,this._correlationId,18657698),!1)},f.prototype.getEntitlementAsync=function(n,r,o){var i=this,s=i,c=i.buildOmexRequestParameters();c[l]=a.dummyApplicationName,c.appVersion=i._appVersion,c.clearEntitlement=o||!1;var u=i._catalogService.currentUserType;i.isUserTypeValid(u)?u===t.AuthedUser?i._catalogService.gatedProxy.getOmexEntitlementsAsync(c,(function(e){s.tryFail(e.status,e.httpStatus,r)||(s._catalogService._cid=e.value.cid,r(e))})):u===t.AnonymousUser&&r({status:e.DataServiceResultCode.Succeeded,value:{refreshRate2:0,entitlements:[]}}):r({status:e.DataServiceResultCode.UnknownUserType,value:{refreshRate2:0,entitlements:[]}})},f.prototype.getLastStoreUpdate=function(){},f.prototype.isStoreDisabled=function(t){t({status:e.DataServiceResultCode.Succeeded,value:!1})},f.prototype.getManifest=function(t,r,o){this.getETokenAndManifestInternal(t,r,i.ClientAppInfoReturnType.urlOnly,(function(t){var r=t&&t.value&&t.value.manifest?t.value.manifest:n,a=t&&t.value&&t.value.status2?t.value.status2:i.OmexClientAppStatus.ServerError,s=t?t.status:e.DataServiceResultCode.Failed;o({status:s,value:{status2:a,manifest:r}})}))},f.prototype.getEToken=function(e,t,n){this.getETokenAndManifestInternal(e,t,i.ClientAppInfoReturnType.etokenOnly,n)},f.prototype.getETokenAndManifest=function(e,t,n){this.getETokenAndManifestInternal(e,t,i.ClientAppInfoReturnType.both,n)},f.prototype.getAppState=function(r,i){var a=this,s=a,u=a.buildOmexRequestParameters();u[c]=r.assetId,u[o]=r.storeId,u[d]={};var l=a._catalogService.currentUserType;a.isUserTypeValid(l)?l===t.AuthedUser?a._catalogService.gatedProxy.getAppStateAsync(u,(function(e){s.tryFail(e.status,e.httpStatus,i)?s.logServiceCallResponseError("appstate",e.httpStatus):i(e)})):l===t.AnonymousUser&&a._catalogService.anonymousProxy.getAppStateAsync(u,i):i({status:e.DataServiceResultCode.UnknownUserType,value:{refreshRate2:0,assetId:n,productId:n,version:n,state2:-1}})},f.prototype.getKilledApps=function(n){var o=this,i=o,a=o.buildOmexRequestParameters(),s=o._catalogService.currentUserType;o.isUserTypeValid(s)?s===t.AuthedUser?o._catalogService.gatedProxy.getKilledAppAsync(a,(function(e){i.tryFail(e.status,e.httpStatus,n)?i.logServiceCallResponseError("killedapps",e.httpStatus):n(e)})):s===t.AnonymousUser&&o._catalogService.anonymousProxy.getKilledAppAsync(a,n):n({status:e.DataServiceResultCode.UnknownUserType,value:{refreshRate2:0,killedApps:r}})},f.prototype.getAppDetails=function(e,t,r){var i=this,a=this.buildOmexRequestParameters();a.assetid=n,a[c]=e.join(","),a[o]=t,this._catalogService.ungatedProxy.getAppDetailsAsync(a,(function(e){i.tryFail(e.status,e.httpStatus,r)?i.logServiceCallResponseError("appdetails",e.httpStatus):r(e)}))},f.prototype.removeApps=function(r,o){var i=this,a=i,s=i.buildOmexRequestParameters();s.assetid=n,s[c]=r.join(",");var u=i._catalogService.currentUserType;i.isUserTypeValid(u)?u===t.AuthedUser?i._catalogService.gatedProxy.removeApps(s,(function(e){a.tryFail(e.status,e.httpStatus,o)?a.logServiceCallResponseError("removeapps",e.httpStatus):o(e)})):u===t.AnonymousUser&&o({status:e.DataServiceResultCode.Succeeded,value:{removedApps:[]}}):o({status:e.DataServiceResultCode.UnknownUserType,value:{removedApps:[]}})},f.prototype.getETokenAndManifestInternal=function(s,u,d,f){var p=this,m=p,g=p.buildOmexRequestParameters();g[l]=a.dummyApplicationName,g[c]=s.assetId,g.clientAppInfoReturnType=d;var h=p._catalogService.currentUserType;p.isUserTypeValid(h)?h===t.AuthedUser&&d!=i.ClientAppInfoReturnType.urlOnly?(g.assetContentMarket=u,g.userContentMarket=s.storeId,g.expectedVersion=s.appVersion,p._catalogService.gatedProxy.getManifestAndETokenAsync(g,(function(e){m.tryFail(e.status,e.httpStatus,f)?m.logServiceCallResponseError("manifestandetoken",e.httpStatus):f(e)}))):(g[o]=s.storeId,g.clientAppInfoReturnType==i.ClientAppInfoReturnType.etokenOnly?f({status:e.DataServiceResultCode.Succeeded,value:{status2:i.OmexClientAppStatus.OK,etoken:n,manifest:r}}):p._catalogService.anonymousProxy.getManifestAsync(g,(function(e){m.tryFail(e.status,e.httpStatus,f)?m.logServiceCallResponseError("manifest",e.httpStatus):f(e)}))):f({status:e.DataServiceResultCode.UnknownUserType,value:{etoken:n,manifest:r}})},f.prototype.buildOmexRequestParameters=function(){var e=this;return{clientName:e._clientName,clientVersion:e._clientVersion,correlationId:e._correlationId,build:e._build}},f.prototype.logServiceCallResponseError=function(e,t){var n="proxybased request "+e+" failed";t&&(n+=":"+t),s.RuntimeTelemetryHelper.LogExceptionTag(n,r,this._correlationId,18657697)},f}();e.ProxyBasedCatalogServiceScope=c;var u=function(){function e(){}return e.getClientVersionFromWACAppVersion=function(e){if(e){var t=e.split("."),n=parseInt(t[0],10),r=parseInt(t[1],10)||0;if(!(n<=15&&r<=0)){var o=i.Constants.FileVersion.split(".");return n+"."+r+"."+o[2]+"."+o[3]}}},e.getOmexEndPointPageUrl=function(e,t,n){return i.OUtil.formatString("{0}/{1}/downloads/{2}.aspx",e,n,t)},e}();e.OmexUtils=u}(l||(l={})),function(e){var t=function(t){function n(e){var n=this;t.call(n,e),n.proxyName="__omexExtensionProxy",n.proxyUrl=n.osfOmexBaseUrl+"/ungatedserviceextension.aspx"}return c(n,t),n.prototype.getAppDetailsAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.UnGated_GetAppDetails,t,(function(t){null!=t.value&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertAppDetails(t.value)),n(t)}))},n}(e.OmexProxyBase);e.UnGatedOmexProxy=t}(l||(l={})),function(e){var t=!1,n=null,r=!0,o=function(){var o="cacheExpired";function a(e,t){var n=this;n._initParam=t,n._cacheManager=e.cacheManager,n._cachePrefix=e.cachePrefix,n._cid=e.cid,n._anonymous=e.anonymous,n._telemetryContext=e.telemetryContext}return a.prototype.GetCacheKeyPrefix=function(){return this._cachePrefix},a.prototype.getOmexEndPointPageUrl=function(t,n){return e.OmexUtils.getOmexEndPointPageUrl(this._initParam.omexBaseUrl,t,n)},a.prototype.getKilledApps=function(t,o,a){var s=this,c=s;s._telemetryContext.startActivity(e.Activity.KilledAppsCheck);var u=i.OUtil.formatString(e.CacheConsts.killedAppsCacheKey,s.GetCacheKeyPrefix());if(a)s._cacheManager.RemoveCacheItem(u);else{var l=s._cacheManager.GetCacheItem(u,r);if(l&&l.refreshRate2!=n)return s._telemetryContext.stopActivity(e.Activity.KilledAppsCheck),void o({status:e.DataServiceResultCode.Succeeded,value:l})}t.getKilledApps((function(t){t.status==e.DataServiceResultCode.Succeeded?(c._telemetryContext.stopActivity(e.Activity.KilledAppsCheck),l=t.value,c._cacheManager.SetCacheItem(u,l,l.refreshRate/e.CacheConsts.hourToDayConversionFactor),o(t)):o(t)}))},a.prototype.getAppState=function(a,s,c,u){var l=this,d=l;l._telemetryContext.startActivity(e.Activity.AppStateCheck);var f,p=i.OUtil.formatString(e.CacheConsts.appStateCacheKey,l.GetCacheKeyPrefix(),s.storeId,s.assetId);if(u)l._cacheManager.RemoveCacheItem(p);else{var m={};if(f=l._cacheManager.GetCacheItem(p,r,m),l._telemetryContext.setFlag(e.FlagName.AppStateDataInvalidFlag,m[o]||t),f&&f.state2!=n)return l._telemetryContext.stopActivity(e.Activity.AppStateCheck),l._telemetryContext.setFlag(e.FlagName.AppStateDataCachedFlag,r),void c({status:e.DataServiceResultCode.Succeeded,value:f})}a.getAppState(s,(function(n){n.status==e.DataServiceResultCode.Succeeded?(d._telemetryContext.stopActivity(e.Activity.AppStateCheck),d._telemetryContext.setFlag(e.FlagName.AppStateDataCachedFlag,t),f=n.value,d._cacheManager.SetCacheItem(p,f,f.refreshRate2/e.CacheConsts.hourToDayConversionFactor),c(n)):c(n)}))},a.prototype.getManifest=function(a,s,c,u,l){var d=this,f=d;d._telemetryContext.startActivity(e.Activity.ManifestRequest);var p,m=i.OUtil.formatString(e.CacheConsts.anonymousAppInstallInfoCacheKey,s.assetId,s.storeId);if(l)d._cacheManager.RemoveCacheItem(m);else{var g={};if(p=d._cacheManager.GetCacheItem(m,r,g),d._telemetryContext.setFlag(e.FlagName.ManifestDataInvalidFlag,g[o]||t),p&&p.status2!=n)return d._telemetryContext.stopActivity(e.Activity.ManifestRequest),d._telemetryContext.stopActivity(e.Activity.ServerCall),d._telemetryContext.setFlag(e.FlagName.ManifestDataCachedFlag,r),void u({status:e.DataServiceResultCode.Succeeded,value:{status2:p.status2,manifest:p.manifest}})}a.getManifest(s,c,(function(n){n.status==e.DataServiceResultCode.Succeeded&&n.value.status2==i.OmexClientAppStatus.OK?(f._telemetryContext.stopActivity(e.Activity.ManifestRequest),f._telemetryContext.stopActivity(e.Activity.ServerCall),f._telemetryContext.setFlag(e.FlagName.ManifestDataCachedFlag,t),f._telemetryContext.setBits(e.FlagName.ManifestRequestType,i.ManifestRequestTypes.Manifest),p={etoken:"",status2:n.value.status2,manifest:n.value.manifest},f._cacheManager.SetCacheItem(m,p,e.CacheConsts.manifestRefreshRate),u(n)):u(n)}))},a.prototype.removeApps=function(n,o,a){var s=this;n.removeApps(o,(function(n){if(n.status==e.DataServiceResultCode.Succeeded){for(var o=".*",c=t,u=[],l=n.value.removedApps,d=0;d<l.length;++d)l[d].result2==i.OmexRemoveAppStatus.Success&&(u.push(new RegExp(i.OUtil.formatString(e.WACUtils.CacheConstants.AuthenticatedAppInstallInfoCacheKey,o,l[d].assetId,o,o),"i")),c=r);c&&s._cacheManager.RemoveMatches(u),a(n)}else a(n)}))},a.prototype.getCachedETokenAndManifest=function(i){var a={},s=this._cacheManager.GetCacheItem(i,r,a);if(this._telemetryContext.setFlag(e.FlagName.ManifestDataInvalidFlag,a[o]||t),s){if(s.status2&&s.tokenExpirationDate2&&s.tokenExpirationDate2>(new Date).getTime())return s;s.etoken=n,s.tokenExpirationDate2=n,s.entitlementType=n}return s},a.prototype.getETokenAndManifest=function(o,a,s,c,u){var l=this,d=l;if(l._anonymous)l.getManifest(o,a,s,(function(t){e.AsyncUtil.failed(t,c)||c({status:t.status,value:{etoken:"",status2:t.value.status2,manifest:t.value.manifest}})}),u);else{l._telemetryContext.startActivity(e.Activity.ManifestRequest);var f,p=function(t,n){d._telemetryContext.stopActivity(e.Activity.ManifestRequest),d._telemetryContext.stopActivity(e.Activity.ServerCall),d._telemetryContext.setFlag(e.FlagName.ManifestDataCachedFlag,t),n&&d._telemetryContext.setBits(e.FlagName.ManifestRequestType,n)},m=i.OUtil.formatString(e.WACUtils.CacheConstants.AuthenticatedAppInstallInfoCacheKey,l._cid,a.assetId,a.storeId,s);if(u)l._cacheManager.RemoveCacheItem(m);else{if((f=l.getCachedETokenAndManifest(m))&&f.etoken&&f.manifest)return p(r),void c({status:e.DataServiceResultCode.Succeeded,value:f});var g=f?f.manifest:n;if(g==n||""==g){var h=i.OUtil.formatString(e.CacheConsts.anonymousAppInstallInfoCacheKey,a.assetId,a.storeId),v=l._cacheManager.GetCacheItem(h,r);v&&(g=v.manifest)}if(g)return void(f&&f.etoken?(p(r),f.manifest=g,c({status:e.DataServiceResultCode.Succeeded,value:f})):o.getEToken(a,s,(function(n){n.status===e.DataServiceResultCode.Succeeded&&n.value&&(p(t,i.ManifestRequestTypes.Etoken),(f=n.value).status2===i.OmexClientAppStatus.OK&&(d._cacheManager.SetCacheItem(m,f,e.CacheConsts.manifestRefreshRate),f.manifest=g)),c(n)})))}o.getETokenAndManifest(a,s,(function(n){n.status==e.DataServiceResultCode.Succeeded?(p(t,i.ManifestRequestTypes.Both),n.value.status2===i.OmexClientAppStatus.OK&&d._cacheManager.SetCacheItem(m,n.value,e.CacheConsts.manifestRefreshRate),c(n)):c(n)}))}},a.prototype.getEntitlements=function(t,r,o,i){var a=this,s=a;a._telemetryContext.startActivity(e.Activity.EntitlementCheck);var c,u,l=function(){u!=n&&c!=n&&(c=c.filter((function(e){return u.every((function(t){return t.assetId!=e.assetId}))})),o({status:e.DataServiceResultCode.Succeeded,value:{entitlements:c,killed:u}}))};a._anonymous?(c=[],a._telemetryContext.stopActivity(e.Activity.EntitlementCheck),l()):t.getEntitlementAsync(r,(function(t){s._telemetryContext.stopActivity(e.Activity.EntitlementCheck),o!=n&&(e.AsyncUtil.failed(t,o)?o=n:(s._cid||(s._cid=t.value.cid),c=t.value.entitlements,l()))}),i),a.getKilledApps(t,(function(t){o!=n&&(u=t.status==e.DataServiceResultCode.Succeeded?t.value.killedApps:[],l())}))},a.prototype.activate=function(o,a,c){var u,l,d=this,f={assetId:a.assetId,appVersion:a.appVersion,storeId:a.storeId,storeType:a.storeType,targetType:a.targetType},p=t,m=this.getOmexEndPointPageUrl(f.assetId,f.storeId),g=e.HostFeatureEnabledInfo.getHostFeatureEnabledInfo(),h=function(l,p){switch(l.status2){case i.OmexClientAppStatus.OK:if(l.tokenExpirationDate2&&l.tokenExpirationDate2<=(new Date).getTime())return void e.LoaderUtil.failWithWarning(c,e.LoaderUtil.warning({description:Strings.OsfRuntime.L_AgaveLicenseExpired_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){return v()},errorCode:i.ErrorStatusCodes.E_TOKEN_EXPIRED}));var h=e.ManifestUtil.ParseManifest(l.manifest,d._initParam.appUILocale,d._telemetryContext.correlationId);if(h==n)return void e.LoaderUtil.failWithError(c,{infoType:i.InfoType.Error,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),v()},description:Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,errorCode:i.ErrorStatusCodes.E_MANIFEST_INVALID_VALUE_FORMAT});var b=h.getMarketplaceVersion();if(i.OsfManifestManager.cacheManifest(f.assetId,a.appVersion,h),h.requirementsSupported===t||void 0===h.requirementsSupported&&!c.getRequirementsChecker().isManifestSupported(h)){h.requirementsSupported=t;var S;return S=Strings.OsfRuntime.L_AgaveManifestRequirementsErrorOmex_ERR||Strings.OsfRuntime.L_AgaveManifestError_ERR,void e.LoaderUtil.failWithError(c,{description:S,url:m,detailView:r,errorCode:i.ErrorStatusCodes.WAC_AgaveRequirementsErrorOmex})}h.requirementsSupported=r,d._telemetryContext.setFlag(e.FlagName.ManifestTrustCachedFlag,!p);var C=i.OUtil.formatString(i.Constants.ActivatedCacheKey,a.assetId.toLowerCase(),a.storeType,a.storeId);if(p&&!c.skipTrust(a)){var O=i.OmexClientNames[d._initParam.appName];if(!(d._anonymous&&d._cacheManager.GetCacheItem(C,t))&&!c.hasConsent(a)&&!c.isForCustomFunctionSandbox())return void c.askForTrust({anonymous:t,clientName:O,entitlement:f,displayName:h.getDefaultDisplayName(),providerName:h.getProviderName(),iconUrl:h.getDefaultIconUrl(),url:m,isSSOAddin:h.isSSOAddin()},(function(){d.restartActivationTelemetry(),d._cacheManager.SetCacheItem(C,r),d._anonymous?c.load({entitlement:f,manifest:h,eToken:l.etoken},n):d.getETokenAndManifest(o,f,f.storeId,(function(t){t.status==e.DataServiceResultCode.Succeeded&&t.value.status2==i.OmexClientAppStatus.OK?(t.value.version!=n&&e.ManifestUtil.versionLessThan(f.appVersion,t.value.version)&&(f.appVersion=t.value.version),_(r)):e.LoaderUtil.failWithError(c,{infoType:i.InfoType.Error,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),v()},description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,errorCode:i.ErrorStatusCodes.WAC_AgaveManifestAndEtokenRequestFailure})}))}))}c.hasConsent(a)&&d._cacheManager.SetCacheItem(C,r);var A=u.version;e.ManifestUtil.versionLessThan(A,a.appVersion)&&(A=a.appVersion),e.ManifestUtil.versionLessThan(b,A)?(f.appVersion=A,e.LoaderUtil.showWarning(c,{description:Strings.OsfRuntime.L_AgaveNewerVersion_ERR,buttonTxt:Strings.OsfRuntime.L_UpdateButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),c.setIsUpgrading(r),c.setUpgradingFailed(t),v(r),y()},url:m,highPriority:r,displayDeactive:t,errorCode:i.ErrorStatusCodes.E_MANIFEST_UPDATE_AVAILABLE})):u.state2===i.OmexState.DeveloperWithdrawn?e.LoaderUtil.showWarning(c,{description:Strings.OsfRuntime.L_AgaveRetiring_ERR,buttonTxt:Strings.OsfRuntime.L_OkButton_TXT,url:m,displayDeactive:t,errorCode:i.ErrorStatusCodes.S_OEM_EXTENSION_DEVELOPER_WITHDRAWN_FROM_SALE}):u.state2===i.OmexState.Flagged?e.LoaderUtil.showWarning(c,{description:Strings.OsfRuntime.L_AgaveSoftKilled_ERR,buttonTxt:Strings.OsfRuntime.L_OkButton_TXT,url:m,displayDeactive:t,errorCode:i.ErrorStatusCodes.S_OEM_EXTENSION_FLAGGED}):!d._anonymous&&l.entitlementType&&l.entitlementType.toLowerCase()===i.OmexEntitlementType.Trial&&(e.LoaderUtil.showNotification(c,{description:Strings.OsfRuntime.L_AgaveTrial_ERR,buttonTxt:Strings.OsfRuntime.L_BuyButton_TXT,buttonCallback:function(){return window.open(m)},reDisplay:r,highPriority:r,displayDeactive:t,errorCode:i.ErrorStatusCodes.S_OEM_EXTENSION_TRIAL_MODE}),e.LoaderUtil.showNotification(c,{description:Strings.OsfRuntime.L_AgaveTrialRefresh_ERR,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),v(r)},detailView:r,reDisplay:r,highPriority:r,displayDeactive:t,errorCode:i.ErrorStatusCodes.S_USER_CLICKED_BUY})),c.load({entitlement:f,manifest:h,eToken:l.etoken},n);break;case i.OmexClientAppStatus.KilledAsset:e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveDisabledByOmex_ERR,url:m,errorCode:i.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED});break;case i.OmexClientAppStatus.NoEntitlement:case i.OmexClientAppStatus.TrialNotSupported:case i.OmexClientAppStatus.LimitedTrial:case i.OmexClientAppStatus.EntitlementDeactivated:if(d._anonymous){e.LoaderUtil.failWithError(c,{title:Strings.OsfRuntime.L_AgaveSigninRequiredTitle_TXT,description:Strings.OsfRuntime.L_AgaveNotViewableAnonymous_ERR,buttonTxt:Strings.OsfRuntime.L_SignInButton_TXT,buttonCallback:function(){var e=window.location.href,t=d._initParam.omexBaseUrl+i.Constants.SignInRedirectUrl+encodeURIComponent(e);window.open(t)},errorCode:i.ErrorStatusCodes.E_USER_NOT_SIGNED_IN})}else{c.setRetryCall((function(){d.restartActivationTelemetry(),v(r)})),e.LoaderUtil.failWithWarning(c,{description:Strings.OsfRuntime.L_AgaveLicenseNotAquired_ERR,buttonTxt:Strings.OsfRuntime.L_BuyButton_TXT,buttonCallback:function(){window.open(m),e.LoaderUtil.showWarning(c,{description:Strings.OsfRuntime.L_AgaveLicenseNotAquiredRefresh_ERR,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),v(r)},detailView:r,retryAll:r,errorCode:i.ErrorStatusCodes.E_OEM_EXTENSION_NOT_ENTITLED})},errorCode:i.ErrorStatusCodes.E_OEM_EXTENSION_NOT_ENTITLED})}break;case i.OmexClientAppStatus.UnknownAssetId:e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveNotExist_ERR,errorCode:i.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST});break;case i.OmexClientAppStatus.Expired:case i.OmexClientAppStatus.Invalid:e.LoaderUtil.failWithWarning(c,{description:Strings.OsfRuntime.L_AgaveLicenseExpired_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),v()},errorCode:i.ErrorStatusCodes.E_TOKEN_EXPIRED});break;case i.OmexClientAppStatus.Revoked:e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveRetired_ERR,url:m,errorCode:i.ErrorStatusCodes.E_OEM_EXTENSION_WITHDRAWN_FROM_SALE});break;case i.OmexClientAppStatus.VersionMismatch:f.appVersion=l.version,c.askForUpgrade(e.LoaderUtil.warning({description:Strings.OsfRuntime.L_AgaveNewerVersion_ERR,buttonTxt:Strings.OsfRuntime.L_UpdateButton_TXT,url:m,highPriority:r,logAsError:r,errorCode:i.ErrorStatusCodes.E_MANIFEST_UPDATE_AVAILABLE}),(function(){d.restartActivationTelemetry(),c.setIsUpgrading(r),c.setUpgradingFailed(t),v(r)}));break;case i.OmexClientAppStatus.VersionNotSupported:e.LoaderUtil.failWithWarning(c,{description:Strings.OsfRuntime.L_AgaveUnsupportedStoreType_ERR,errorCode:i.ErrorStatusCodes.WAC_AgaveUnsupportedStoreType},i.OsfControlStatus.UnsupportedStore);break;case i.OmexClientAppStatus.UserIsMinor:g&&g.enableDisplayBlockedMinorError&&e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveDisabledForMinor_ERR,errorCode:i.ErrorStatusCodes.E_TRUSTCENTER_APP_BLOCKED_FOR_MINOR});break;default:s.RuntimeTelemetryHelper.LogExceptionTag("unknown clientAppStatus in manifestAndEtoken: "+l.status2,n,d._telemetryContext.correlationId,20030238),e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),v(r)},errorCode:i.ErrorStatusCodes.WAC_AgaveUnknownClientAppStatus})}},v=function(a){var s=l?l.contentMarket:f.storeId,m=function(n,o){return n.status!=e.DataServiceResultCode.Succeeded?g&&g.enableDisplayBlockedMinorError&&451===n.httpStatus?(e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveDisabledForMinor_ERR,errorCode:i.ErrorStatusCodes.E_TRUSTCENTER_APP_BLOCKED_FOR_MINOR}),r):(e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),v(a)},errorCode:o}),r):t};c.skipTrust(f)?d.getManifest(o,f,s,(function(e){if(m(e,i.ErrorStatusCodes.WAC_AgaveManifestRequestFailure))c.getIsUpgrading()&&(c.setUpgradingFailed(r),c.setIsUpgrading(t));else{if(a)return u=n,void S(r);c.getIsUpgrading()&&c.setIsUpgrading(t),h({etoken:"",status2:e.value.status2,manifest:e.value.manifest})}}),a):d.getETokenAndManifest(o,f,s,(function(e){if(m(e,i.ErrorStatusCodes.WAC_AgaveManifestAndEtokenRequestFailure))c.getIsUpgrading()&&(c.setUpgradingFailed(r),c.setIsUpgrading(t));else{if(a)return u=n,p=t,_(r),void S(r);c.getIsUpgrading()&&c.setIsUpgrading(t),h(e.value)}}),a)},y=function(){var t=i.OUtil.formatString(e.CacheConsts.anonymousAppInstallInfoCacheKey,f.assetId,f.storeId);d._cacheManager.RemoveCacheItem(t)},b=function(){if(u!=n&&p){if(l!=n)return f.appVersion=l.version,void v();var t,s,g;if(u.state2===i.OmexState.Flagged?t=r:u.state2===i.OmexState.DeveloperWithdrawn?s=r:u.state2===i.OmexState.Withdrawn&&(g=r),!(t||s||g)||(e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveRetired_ERR,url:m,errorCode:i.ErrorStatusCodes.E_OEM_EXTENSION_WITHDRAWN_FROM_SALE}),!t))if(c.hasConsent(a))v();else{var y=l?l.contentMarket:f.storeId;d.getManifest(o,f,y,(function(t){t.status==e.DataServiceResultCode.Succeeded?h({etoken:"",status2:t.value.status2,manifest:t.value.manifest},r):e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),b()},errorCode:i.ErrorStatusCodes.WAC_AgaveManifestRequestFailure})}))}}},_=function(a){l=n,p=t,d.getEntitlements(o,t,(function(o){if(o.status!=e.DataServiceResultCode.Succeeded)return g&&g.enableDisplayBlockedMinorError&&451===o.httpStatus?void e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveDisabledForMinor_ERR,errorCode:i.ErrorStatusCodes.E_TRUSTCENTER_APP_BLOCKED_FOR_MINOR}):void e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){c.restartActivation(),_()},errorCode:i.ErrorStatusCodes.WAC_AgaveEntitlementRequestFailure});o.value.killed.some((function(e){return e.assetId==f.assetId}))?e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveDisabledByOmex_ERR,url:m,errorCode:i.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED}):(o.value.entitlements.some((function(e){return e.assetId.toLowerCase()==f.assetId.toLowerCase()?(l=e,m=d.getOmexEndPointPageUrl(e.assetId,e.contentMarket),r):t})),d._telemetryContext.setFlag(e.FlagName.OmexHasEntitlementFlag,l!=n),p=r,b())}),a)},S=function(t){u=n,d.getAppState(o,f,(function(t){if(t.status!=e.DataServiceResultCode.Succeeded)return u={state2:i.OmexState.OK,productId:n,assetId:f.assetId,version:f.appVersion,refreshRate2:0},void b();t.value.state2!==i.OmexState.Killed?(u=t.value,b()):e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveDisabledByOmex_ERR,url:m,errorCode:i.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED})}),t)};S(),_()},a.prototype.restartActivationTelemetry=function(){var t=this;t._telemetryContext.startActivity(e.Activity.Activation),t._telemetryContext.startActivity(e.Activity.ServerCall),t._telemetryContext.setFlag(e.FlagName.AnonymousFlag,t._anonymous)},a}(),a=function(){function a(t,o){void 0===o&&(o=n),this._anonymous=r,this._initParam=t,this._cacheManager=o||new e.AppsDataCacheManager(i.OUtil.getLocalStorage(),new e.SafeSerializer)}return a.prototype.GetCacheKeyPrefix=function(){return this._anonymous?e.CacheConsts.anonymousCacheKeyPrefix:e.WACUtils.CacheConstants.GatedCacheKeyPrefix},a.prototype.getOmexEndPointPageUrl=function(e,t){return i.OUtil.formatString("{0}/{1}/downloads/{2}.aspx",this._initParam.omexBaseUrl,t,e)},a.prototype.getDataService=function(t,r){var o=this,a=o;if(o._dataService==n)if(o._dataServiceReady==n){o._dataServiceReady=r;var s={status:e.DataServiceResultCode.Failed,value:n},c=function(t,r){var o=a._dataServiceReady;a._dataServiceReady=n,t.status==e.DataServiceResultCode.Succeeded?(a._anonymous=t.value.anonymous,a._dataService=r,s.value=r,s.status=e.DataServiceResultCode.Succeeded,o(s)):(s.httpStatus=t.httpStatus,o(s))};t.startActivity(e.Activity.Authentication);var u=new e.S2SOmexCatalogService(o._initParam);u.initialize(t.correlationId,(function(n){if(n.status==e.DataServiceResultCode.Succeeded){var r=e.HostFeatureEnabledInfo.getHostFeatureEnabledInfo();if(!r||!r.enableAnonymousUseLegacyCatalogService||!n.value.anonymous)return t.stopActivity(e.Activity.Authentication),void c(n,u)}t.setBits(e.FlagName.ActivationRuntimeType,i.ActivationTypes.V2Enabled);var o=e.ProxyBasedCatalogService.getInstance(a._initParam);o.prepareProxy(t.correlationId,(function(n){t.stopActivity(e.Activity.Authentication),t.setBits(e.FlagName.RetryCount,o.omexAuthConnectTries),c(n,o)}))}))}else{t.startActivity(e.Activity.Authentication);var l=o._dataServiceReady;o._dataServiceReady=function(n){t.stopActivity(e.Activity.Authentication),l(n),r(n)}}else r({status:e.DataServiceResultCode.Succeeded,value:o._dataService})},a.prototype.createActivityScope=function(t,r){var i=this;this.getDataService(t,(function(a){if(e.AsyncUtil.failed(a,r))s.RuntimeTelemetryHelper.LogExceptionTag("failed to get data service.",n,t.correlationId,18657692);else{t.setFlag(e.FlagName.AnonymousFlag,i._anonymous);var c=a.value,u={cacheManager:i._cacheManager,cachePrefix:i.GetCacheKeyPrefix(),cid:c.getCID(),anonymous:i._anonymous,telemetryContext:t},l=c.createScope(u),d=new o(u,i._initParam);r({status:e.DataServiceResultCode.Succeeded,value:{serviceScope:l,activityScope:d}})}}))},a.prototype.getEntitlementAsync=function(t,n,r,o,a){var s=this;this.createActivityScope(n,(function(n){e.AsyncUtil.failed(n,r,[])||(s._anonymous?r({status:e.DataServiceResultCode.Failed,httpStatus:403}):n.value.serviceScope.getEntitlementAsync(t,(function(t){if(!e.AsyncUtil.failed(t,r,[])){for(var n=t.value.entitlements,o=0;o<n.length;o++){var a=n[o],s=a;s.appVersion=a.version,s.storeId=a.contentMarket,s.storeType=i.StoreType.OMEX,s.targetType=i.OUtil.getTargetType(a.appSubType)}r({status:t.status,value:n})}}),o,a))}))},a.prototype.getAndCacheManifest=function(r,o,a,s,c){var u=this;c=c||t;var l=i.OsfManifestManager.getCachedManifest(r.assetId,r.appVersion);c||l==n?this.createActivityScope(a,(function(t){if(!e.AsyncUtil.failed(t,s)){var l=t.value.serviceScope;t.value.activityScope.getManifest(l,r,o,(function(t){if(!e.AsyncUtil.failed(t,s))if(t.value.status2==i.OmexClientAppStatus.OK){var o=e.ManifestUtil.ParseManifest(t.value.manifest,u._initParam.appUILocale,a.correlationId);o!=n?(i.OsfManifestManager.cacheManifest(r.assetId,r.appVersion,o),s({status:e.DataServiceResultCode.Succeeded,value:o})):s({status:e.DataServiceResultCode.Failed,value:o})}else s({status:e.DataServiceResultCode.Failed})}),c)}})):s({status:e.DataServiceResultCode.Succeeded,value:l})},a.prototype.activateAsync=function(t,n,o){var a=this;o.startActivity(e.Activity.Activation),o.startActivity(e.Activity.ServerCall),this.createActivityScope(o,(function(s){a.isStoreDisabled(o,(function(c){if(c.value===r)e.LoaderUtil.failWithError(n,{description:Strings.OsfRuntime.L_OmexStoreDisabledByAdmin,errorCode:i.ErrorStatusCodes.E_TRUSTCENTER_CATALOG_UNTRUSTED_ADMIN_CONTROLLED});else if(s.status!=e.DataServiceResultCode.Succeeded)return void e.LoaderUtil.failWithError(n,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){n.restartActivation(),a.activateAsync(t,n,o)},errorCode:i.ErrorStatusCodes.WAC_AgaveAnonymousProxyCreationError})}));var c=s.value.serviceScope;s.value.activityScope.activate(c,t,n)}))},a.prototype.removeAsync=function(t,n,r){this.createActivityScope(n,(function(n){if(!e.AsyncUtil.failed(n,r)){var o=n.value.serviceScope;n.value.activityScope.removeApps(o,t,r)}}))},a.prototype.getAppDetails=function(t,o,a,s,c){var u=this,l=u,d=[];if(c)u._cacheManager.RemoveAll(e.CacheConsts.ungatedCacheKeyPrefix);else{for(var f=t,p=[],m=0;m<f.length;++m){var g=i.OUtil.formatString(e.CacheConsts.appDetailKey,f[m]),h=u._cacheManager.GetCacheItem(g,r);h&&h.state2!=n?d.push(h):p.push(f[m])}if(0===p.length)return void s({status:e.DataServiceResultCode.Succeeded,value:d});t=p}u.createActivityScope(a,(function(n){e.AsyncUtil.failed(n,s,d)||n.value.serviceScope.getAppDetails(t,o,(function(t){if(!e.AsyncUtil.failed(t,s,d)){for(var n=t.value,r=0;r<n.length;++r){var o=n[r],a=i.OUtil.formatString(e.CacheConsts.appDetailKey,o.assetId);l._cacheManager.SetCacheItem(a,o),d.push(o)}t.value=d,s(t)}}))}))},a.prototype.isStoreDisabled=function(n,r){this.createActivityScope(n,(function(n){e.AsyncUtil.failed(n,r,t)||n.value.serviceScope.isStoreDisabled(r)}))},a}();e.OmexCatalog=a,e.CatalogFactory.register(i.StoreType.OMEX,(function(t){if(t.allowExternalMarketplace&&t.osfOmexBaseUrl){var n,o=t.osfOmexBaseUrl.indexOf(i.Constants.ProtocolSeparator);n=o>=0?t.osfOmexBaseUrl.substr(o):i.Constants.ProtocolSeparator+t.osfOmexBaseUrl;var s=i.Constants.Https+n;return i.OUtil.getQueryStringParamValue(window.location.search,i.Constants.OmexForceAnonymousParamName).toLowerCase()==i.Constants.OmexForceAnonymousParamValue.toLowerCase()&&(t.omexForceAnonymous=r),new a({appName:t.appName,appUILocale:t.appUILocale,AppVersion:t.appVersion,clientMode:t.clientMode,docUrl:t.docUrl,omexBaseUrl:s,omexForceAnonymous:t.omexForceAnonymous})}return new e.ForbiddenCatalog({loaderParams:e.LoaderUtil.error({description:Strings.OsfRuntime.L_AgaveOmexNotConfigured_ERR,errorCode:i.ErrorStatusCodes.E_TRUSTCENTER_CATALOG_UNTRUSTED_ADMIN_CONTROLLED}),controlStatus:i.OsfControlStatus.ActivationFailed})}))}(l||(l={})),function(e){var t=function(){function e(){}return e.anonymousCacheKeyPrefix="__OSF_ANONYMOUS_OMEX.",e.ungatedCacheKeyPrefix="__OSF_OMEX.",e.manifestRefreshRate=1825,e.hourToDayConversionFactor=24,e.anonymousAppInstallInfoCacheKey=e.anonymousCacheKeyPrefix+"appInstallInfo.{0}.{1}",e.firstPartyAddinListCacheKey=e.anonymousCacheKeyPrefix+"firstPartyAddInList",e.firstPartyManifestCacheKey=e.anonymousCacheKeyPrefix+"firstPartyManifest.{0}",e.killedAppsCacheKey="{0}killedApps",e.appStateCacheKey="{0}appState.{1}.{2}",e.appDetailKey="__OSF_OMEX.appDetails.{0}",e}();e.CacheConsts=t}(l||(l={})),function(e){var t=null,n=function(){function n(e,t,n){var r=this;r._handler=e,r._initParam=t,r._cacheManager=n.cacheManager,r._cachePrefix=n.cachePrefix,r._cid=n.cid,r._correlationId=n.telemetryContext.correlationId}return n.prototype.tryFail=function(t,n){return 200!=t&&(n({httpStatus:t,status:e.DataServiceResultCode.Failed}),!0)},n.prototype.getLastStoreUpdate=function(t){var n=this,r=n,o=n._initParam.appUILocale;n._handler.getLastStoreUpdate(o,n._correlationId,(function(n,o){r.tryFail(n,t)?r.logServiceCallResponseError("laststoreupdate",n):t({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ProcessLastStoreUpdate(o)})}))},n.prototype.getEntitlementAsync=function(n,r,o,a){var s=this,c=s,u=i.OmexAppVersions[s._initParam.appName],l=i.OUtil.formatString(s._cachePrefix+e.WACUtils.CacheConstants.EntitlementsKey,u,s._cid);if(o)s._cacheManager.RemoveCacheItem(l);else{var d=s._cacheManager.GetCacheItem(l,!0,t,a);if(d!=t)return void r({status:e.DataServiceResultCode.Succeeded,value:d})}s._handler.getEntitlement(n,u,s._correlationId,(function(t,n){if(c.tryFail(t,r))c.logServiceCallResponseError("entitlement",t);else{var o=e.OmexXmlProcessor.ProcessEntitlement(n);o.cid=c._cid,c._cacheManager.SetCacheItem(l,o,o.refreshRate2/e.CacheConsts.hourToDayConversionFactor),r({status:e.DataServiceResultCode.Succeeded,value:o})}}))},n.prototype.getEToken=function(t,n,r){var o=this,a=n,s=t.storeId,c=t.assetId,u=t.appVersion;this._handler.getEToken(s,a,c,u,this._correlationId,(function(t,n){o.tryFail(t,r)?o.logServiceCallResponseError("etoken",t):r({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ProcessClientAppInstallInfo(n,i.ClientAppInfoReturnType.etokenOnly)})}))},n.prototype.getETokenAndManifest=function(t,n,r){var o=this;this.getEToken(t,n,(function(i){i.status==e.DataServiceResultCode.Succeeded?o.getManifest(t,n,(function(t){if(t.status!=e.DataServiceResultCode.Succeeded)return i.status=t.status,i.httpStatus=t.httpStatus,void r(i);i.value.manifest=t.value.manifest,r(i)})):r(i)}))},n.prototype.getManifest=function(t,n,r){var o=n;this._handler.getManifest(o,t.assetId,this._correlationId,(function(t,n){r({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ConvertAnonymousManifest(t,n)})}))},n.prototype.getAppState=function(t,n){var r=this,o=t.storeId+":"+t.assetId;this._handler.getAppState(o,this._correlationId,(function(t,o){r.tryFail(t,n)?r.logServiceCallResponseError("appstate",t):n({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ProcessAppState(o)})}))},n.prototype.getKilledApps=function(t){var n=this;this._handler.getKilledApps(this._correlationId,(function(r,o){n.tryFail(r,t)?n.logServiceCallResponseError("killedapps",r):t({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ProcessKilledApps(o)})}))},n.prototype.getAppDetails=function(t,n,r){var o=this;this._handler.getAppDetails(n,t.join(","),this._correlationId,(function(t,n){o.tryFail(t,r)?o.logServiceCallResponseError("appdetails",t):r({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ProcessAppDetails(n)})}))},n.prototype.removeApps=function(t,n){var r=this;this._handler.removeApps(t.join(","),this._correlationId,(function(t,o){if(r.tryFail(t,n))r.logServiceCallResponseError("removeapps",t);else{var a=e.OmexXmlProcessor.ProcessRemoveAppResponse(o);a.removedApps.some((function(e){return e.result2==i.OmexRemoveAppStatus.Success}))&&r.clearEntitlementCache(),n({status:e.DataServiceResultCode.Succeeded,value:a})}}))},n.prototype.clearEntitlementCache=function(){var t=new RegExp(i.OUtil.formatString(e.WACUtils.CacheConstants.EntitlementsKey,".*",".*"),"i");this._cacheManager.RemoveMatches([t])},n.prototype.isStoreDisabled=function(t){var n=this;this._handler.isStoreDisabled(this._correlationId,(function(r){if(200!=r&&403!=r&&401!=r)return n.logServiceCallResponseError("isStoreDisabled",r),void t({status:e.DataServiceResultCode.Failed,value:!1});t({status:e.DataServiceResultCode.Succeeded,value:401==r})}))},n.prototype.logServiceCallResponseError=function(e,n){var r="s2s request "+e+" failed";n&&(r+=":"+n),s.RuntimeTelemetryHelper.LogExceptionTag(r,t,this._correlationId,18657699)},n}();e.OmexCatalogServiceS2SScope=n;var r=function(){function r(e){this._cid="",this._initParam=e}return r.initRequestHandler=function(e){r._requestHandler==t&&(r._requestHandler=e)},r.prototype.getCID=function(){return this._cid},r.prototype.initialize=function(n,o){var i=this;r._requestHandler!=t?this._initParam.omexForceAnonymous?o({status:e.DataServiceResultCode.Succeeded,value:{anonymous:!0}}):r._requestHandler.getUserId(n,(function(r,a){200==r?(i._cid=a.trim(),o({status:e.DataServiceResultCode.Succeeded,value:{anonymous:!1}})):403==r?o({status:e.DataServiceResultCode.Succeeded,value:{anonymous:!0}}):(s.RuntimeTelemetryHelper.LogExceptionTag("s2s getuserId request failed "+r,t,n,18657728),o({status:e.DataServiceResultCode.Failed,httpStatus:r}))})):o({status:e.DataServiceResultCode.Failed,httpStatus:404})},r.prototype.createScope=function(e){return new n(r._requestHandler,this._initParam,e)},r}();e.S2SOmexCatalogService=r}(l||(l={})),function(e){var t=function(){var e="description",t="provider",n="o:assets",r="contentMarket",o="appSubType",a="expirationDate",s="state",c="version",l="productId",d="assetId",f="o:asset",p="o:results",m="refreshRate",g=null;function h(){}return h.ProcessLastStoreUpdate=function(e){var t=new i.XmlProcessor(e,u).getDocumentElement().selectSingleNode("o:update");return t.firstChild!=g?Date.parse(t.firstChild.nodeValue):g},h.ProcessAppState=function(e){var t={},n=new i.XmlProcessor(e,u),r=n.getDocumentElement();n.readAttributes(r,{rr:m},t);var o=n.selectSingleNode(p),g=n.selectSingleNode("o:lang",o),v=n.selectSingleNode(f,g);return n.readAttributes(v,{assetid:d,prodid:l,ver:c,state:s,tdurl:"takeDownUrl",upv:"unsafePreviousVersion",expiry:a},t),h.ConvertAppState(t)},h.ProcessFirstPartyAddInList=function(e){var t={addInList:{},refreshRate:g},n=new i.XmlProcessor(e,u),r=n.getDocumentElement(),o=n.selectSingleNode("o:Apps",r),a=o.getAttribute("d1p1:rr");t.refreshRate=a?parseInt(a):0;for(var s=n.selectNodes("o:App",o),c=0;c<s.length;c++){var l=s[c],f={assetId:g,path:g,version:g};n.readAttributes(l,{assetid:d},f);var p=n.selectSingleNode("o:Path",l);f.path=p.text!=g?p.text:p.textContent!=g?p.textContent:p.nodeTypedValue;var m=n.selectSingleNode("o:Version",l);f.version=m.text!=g?m.text:m.textContent!=g?m.textContent:m.nodeTypedValue,t.addInList[f.assetId]=f}return t},h.ConvertAppState=function(e){return e.refreshRate2=e.refreshRate?parseInt(e.refreshRate):0,e.state2=e.state?parseInt(e.state):0,e.expirationDate2=h.GetTickByDate(e.expirationDate),e},h.ProcessEntitlement=function(e){var t={},n=new i.XmlProcessor(e,u),s=n.selectSingleNode("o:entitlementlist"),f=n.selectSingleNode("o:hdr",s);n.readAttributes(f,{pm:"billingMarket",pagesize:"pageSize",rr:m},t);for(var p,g,v=n.selectNodes("o:entitlement",n.selectSingleNode("o:entitlements",s)),y=[],b=0;b<v.length;++b)g={},p=v[b],n.readAttributes(p,{assetid:d,pid:l,ver:c,appst:o,cm:r,trlt:"licenseType",acqdate:"acquireDate",expiry2:a,attreq:"attentionRequired"},g),y.push(g);return t.entitlements=y,h.ConvertEntitlementInfo(t)},h.ConvertEntitlementInfo=function(e){for(var t=e.entitlements,n=0;n<t.length;++n){var r=t[n];r.appSubType2=r.appSubType?parseInt(r.appSubType):0,r.acquireDate2=h.GetTickByDate(r.acquireDate),r.expirationDate2=h.GetTickByDate(r.expirationDate),r.attentionRequired2="true"===r.attentionRequired}return e.refreshRate2=e.refreshRate?parseInt(e.refreshRate):0,e},h.ProcessKilledApps=function(e){var t={},r=new i.XmlProcessor(e,u),o=r.getDocumentElement();r.readAttributes(o,{rr:m},t);for(var a=[],s=r.selectSingleNode(n),c=r.selectNodes(f,s),p=0;p<c.length;++p){var g=c[p],v={};r.readAttributes(g,{assetid:d,pid:l},v),a.push({assetId:v.assetId,productId:v.productId})}return t.killedApps=a,h.ConvertKilledAppsInfo(t)},h.ConvertKilledAppsInfo=function(e){return e.refreshRate2=e.refreshRate?parseInt(e.refreshRate):0,e},h.ProcessClientAppInstallInfo=function(e,t){var o=new i.XmlProcessor(e,u),a=o.selectSingleNode(n),s=o.selectSingleNode(f,a),l={etoken:g,manifest:g};if(t===i.ClientAppInfoReturnType.urlOnly?o.readAttributes(s,{url:"url"},l):t===i.ClientAppInfoReturnType.etokenOnly?o.readAttributes(s,{etok:"etoken"},l):o.readAttributes(s,{url:"url",etok:"etoken"},l),o.readAttributes(s,{status:"status",cm:r,assetid:d,ver:c},l),t!=i.ClientAppInfoReturnType.urlOnly&&l.etoken){var p=new i.XmlProcessor(l.etoken,""),m=p.selectSingleNode("t",p.selectSingleNode("r"));p.readAttributes(m,{te:"tokenExpirationDate",et:"entitlementType",cid:"cid"},l)}return h.ConvertClientAppInstallInfo(l)},h.ConvertClientAppInstallInfo=function(e){return e.status2=e.status?parseInt(e.status):0,e.tokenExpirationDate2=h.GetTickByDate(e.tokenExpirationDate),e},h.ProcessManifest=function(e){return{manifest:e}},h.ProcessRemoveAppResponse=function(e){for(var t,n,r={removedApps:[]},o=new i.XmlProcessor(e,u),a=(o.getDocumentElement(),o.selectSingleNode("o:apps",o.selectSingleNode("o:removedApps"))),s=o.selectNodes("o:app",a),c=0;c<s.length;++c)t=s[c],n={},o.readAttributes(t,{assetid:d,result:"result"},n),r.removedApps.push(n);return h.ConvertRemoveAppResponse(r)},h.ConvertRemoveAppResponse=function(e){for(var t=e.removedApps,n=0;n<t.length;++n){var r=t[n];r.result2=r.result?parseInt(r.result):0}return e},h.ProcessAppDetails=function(n){for(var r,a,l=new i.XmlProcessor(n,u),f=l.selectSingleNode(p),m=l.selectNodes("o:wainfo",f),g=[],v=0;v<m.length;++v)r=m[v],a={},l.readAttributes(r,{assetid:d,appid:"webApplicationId",defhei:"defaultHeight",defwid:"defaultWidth",title:"name",prov:t,desc:e,icon:"iconUrl",ver:c,state:s,appst:o,appvers:"appVersions",req:"requirements",hosts:"hosts",highresicon:"highResolutionIconUrl"},a),g.push(a);return h.ConvertAppDetails(g)},h.ConvertAppDetails=function(e){for(var t=0;t<e.length;++t){var n=e[t];n.defaultHeight2=n.defaultHeight?parseInt(n.defaultHeight):0,n.defaultWidth2=n.defaultWidth?parseInt(n.defaultWidth):0,n.state2=n.state?parseInt(n.state):0,n.appSubType2=n.appSubType?parseInt(n.appSubType):0}return e},h.ProcessRecommendations=function(n){for(var r,o,a,l=new i.XmlProcessor(n,u),f=l.selectSingleNode(p),m=l.selectNodes("o:wa",f),g=[],h=0;h<m.length;++h)r=m[h],a={},l.readAttributes(r,{assetid:d,title:"name",desc:e,icon:"iconUrl",ver:c,state:s,rat:"rating",dls:"downloads",prov:t},a),o=l.selectSingleNode("o:price",r),l.readAttributes(o,{fop:"originalPrice",opt:"originalPriceTier",fpp:"promotionalPrice",ppt:"promotionalPriceTier",cmod:"priceModel"},a),g.push(a);return g},h.ConvertAnonymousManifest=function(e,t){var n,r="";switch(e){case 200:n=i.OmexClientAppStatus.OK,r=t;break;case 204:case 1223:n=i.OmexClientAppStatus.NoEntitlement;break;case 400:n=i.OmexClientAppStatus.BadRequest;break;case 410:n=i.OmexClientAppStatus.KilledAsset;break;case 404:n=i.OmexClientAppStatus.UnknownAssetId;break;case 412:n=i.OmexClientAppStatus.VersionNotSupported;break;case 451:n=i.OmexClientAppStatus.UserIsMinor;break;default:n=i.OmexClientAppStatus.ServerError}return{status2:n,manifest:r}},h.GetTickByDate=function(e){return e?new Date(e).getTime():g},h}();e.OmexXmlProcessor=t}(l||(l={})),function(e){var t=function(){var t=null;function n(n,r,o,a){void 0===a&&(a=t),this._cacheManager=a||new e.AppsDataCacheManager(i.OUtil.getLocalStorage(),new e.SafeSerializer),this._privateCatalogService=new e.PrivateCatalogService(i.OmexClientNames[n],i.OUtil.normalizeAppVersion(r)),this._uiLocale=o}return n.prototype.getEntitlementAsync=function(t,r,o,i){r.startActivity(e.Activity.EntitlementCheck),i&&(this._cacheManager.RemoveAll(n._addInsCacheKey),this._cacheManager.RemoveCacheItem(n._lastCatalogUpdateKey)),this.GetAddInList(t,r,(function(t){for(var i=[],a=0;a<t.length;a++){var s=t[a];s.addInState===n._addInOkState&&i.push(s)}r.stopActivity(e.Activity.EntitlementCheck),o({status:e.DataServiceResultCode.Succeeded,value:i})}),(function(e){o({status:e})}))},n.prototype.getAppDetails=function(r,o,i,a,s){var c=this,u=c;s&&c._cacheManager.RemoveAll(n._addInDetailsCacheKeyPrefix);for(var l=[],d=[],f=0;f<r.length;f++){var p=n.GetAppDetailsCacheKey(r[f].ProductId),m=c._cacheManager.GetCacheItem(p);m?l.push(m):d.push(r[f])}0!==d.length?c._privateCatalogService.GetManifests(d,t,t,i,(function(t){for(var r=0;r<t.length;r++){var o=u.ParseAndCacheManifest(t[r],i);if(o){var s=n.CreateAddInDetails(o);l.push(s);var c=n.GetAppDetailsCacheKey(s.assetId);u._cacheManager.SetCacheItem(c,s,n._addInDetailsRefreshRateDays)}}a({status:e.DataServiceResultCode.Succeeded,value:l})}),(function(e){a({status:e})})):a({status:e.DataServiceResultCode.Succeeded,value:l})},n.prototype.getAndCacheManifest=function(t,r,o,i){var a={ProductId:t.assetId,Version:t.appVersion,AddInState:n._addInOkState,StoreInfo:{AssetId:t.storeId,ContentMarket:r}};this.GetManifest(a,o,(function(t){i({status:e.DataServiceResultCode.Succeeded,value:t})}),(function(e){i({status:e})}))},n.prototype.activateAsync=function(r,o,a){var s=this;a.startActivity(e.Activity.Activation);var c=this;this.GetAddInList(!1,a,(function(u){for(var l,d=/[{}]/g,f=0;f<u.length;f++){var p=u[f];if(r.assetId.replace(d,"").toLowerCase()===p.assetId.replace(d,"").toLowerCase()){l=p;break}}if(l)if(l.addInState===n._addInOkState){r.appVersion=l.appVersion;var m={ProductId:l.assetId,Version:l.appVersion,AddInState:n._addInOkState,StoreInfo:{AssetId:l.storeId,ContentMarket:""}};s.GetManifest(m,a,(function(e){o.load({entitlement:r,manifest:e,eToken:""},t)}),(function(){e.LoaderUtil.failWithError(o,{description:Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message,url:"",errorCode:i.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){o.restartActivation(),c.activateAsync(r,o,a)}})}))}else e.LoaderUtil.failWithError(o,{description:Strings.OsfRuntime.L_AgaveDisabledByAdmin_ERR,url:"",errorCode:i.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED});else e.LoaderUtil.showWarning(o,{description:Strings.OsfRuntime.L_AgaveNotExist_ERR,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){o.restartActivation(),c._cacheManager.RemoveAll(n._addInsCacheKey),c._cacheManager.RemoveCacheItem(n._lastCatalogUpdateKey),c.activateAsync(r,o,a)},detailView:!0,retryAll:!0,errorCode:i.ErrorStatusCodes.E_OEM_EXTENSION_NOT_ENTITLED})}),(function(){e.LoaderUtil.showWarning(o,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){o.restartActivation(),c._cacheManager.RemoveAll(n._addInsCacheKey),c._cacheManager.RemoveCacheItem(n._lastCatalogUpdateKey),c.activateAsync(r,o,a)},detailView:!0,retryAll:!0,errorCode:i.ErrorStatusCodes.WAC_AgaveActivationError}),a.stopActivity(e.Activity.Activation)}))},n.prototype.removeAsync=function(t,n,r){r({status:e.DataServiceResultCode.Failed})},n.GetAppDetailsCacheKey=function(e){return n._addInDetailsCacheKeyPrefix+i.OUtil.formatString(n._addInDetailsCacheKeySufix,e)},n.GetManifestCacheKey=function(e,t){return n._manifestCacheKeyPrefix+i.OUtil.formatString(n._manifestCacheKeySufix,e,t)},n.CreateAddInDetails=function(e){return{assetId:e.getMarketplaceID(),webApplicationId:e.getWebApplicationId(),defaultHeight2:e.getDefaultHeight()||0,defaultHeight:String(e.getDefaultHeight()||0),defaultWidth2:e.getDefaultWidth()||0,defaultWidth:String(e.getDefaultWidth()||0),name:e.getDefaultDisplayName(),provider:e.getProviderName(),description:e.getDefaultDescription(),iconUrl:e.getDefaultIconUrl(),version:e.getMarketplaceVersion(),state2:1,state:"1",appSubType2:e.getOmexTargetCode(),appSubType:String(e.getOmexTargetCode()),appVersions:void 0,requirements:e.getRequirementsXml(),hosts:e.getHostsXml(),highResolutionIconUrl:e.getDefaultHighResolutionIconUrl()}},n.prototype.GetAddInList=function(e,r,o,i){var a,s=this;e||!(a=this._cacheManager.GetCacheItem(n._addInsCacheKey))?this._privateCatalogService.GetAddInList(t,t,r,(function(e){for(var t=0;t<e.length;t++){var r=e[t],i=n.GetAppDetailsCacheKey(r.assetId),a=s._cacheManager.GetCacheItem(i);a&&a.version!==r.appVersion&&s._cacheManager.RemoveCacheItem(i)}s._cacheManager.SetCacheItem(n._addInsCacheKey,e,n._addInListRefreshRateDays),o(e)}),i):o(a)},n.prototype.GetManifest=function(r,o,a,s){var c=this,u=c;o.startActivity(e.Activity.ManifestRequest);var l=i.OsfManifestManager.getCachedManifest(r.ProductId,r.Version);if(l)return o.stopActivity(e.Activity.ManifestRequest),void a(l);var d=n.GetManifestCacheKey(r.ProductId,r.Version),f=c._cacheManager.GetCacheItem(d);if(f)return(l=new i.Manifest.Manifest(f,c._uiLocale))?(o.stopActivity(e.Activity.ManifestRequest),void a(l)):void s(e.DataServiceResultCode.Failed);c._privateCatalogService.GetManifests([r],t,t,o,(function(t){(l=u.ParseAndCacheManifest(t[0],o))?(i.OsfManifestManager.cacheManifest(r.ProductId,r.Version,l),o.stopActivity(e.Activity.ManifestRequest),a(l)):s(e.DataServiceResultCode.Failed)}),(function(e){s(e)}))},n.prototype.ParseAndCacheManifest=function(e,r){try{var o=new i.Manifest.Manifest(e,this._uiLocale),a=n.GetManifestCacheKey(o.getMarketplaceID(),o.getMarketplaceVersion());return this._cacheManager.SetCacheItem(a,e,n._addInManifestRefreshRateDays),o}catch(e){s.RuntimeTelemetryHelper.LogExceptionTag("Invalid manifest retrieved from Private Catalog.",e,r.correlationId,19965729)}return t},n._addInsCacheKey="__OSF_PRIVATECATALOG_ADDINS",n._addInDetailsCacheKeyPrefix="__OSF_PRIVATECATALOG_ADDINDETAILS",n._addInDetailsCacheKeySufix="_{0}",n._manifestCacheKeyPrefix="__OSF_PRIVATECATALOG_MANIFEST",n._manifestCacheKeySufix="_{0}_{1}",n._lastCatalogUpdateKey="_OSF_PRIVATECATALOG_LASTUPDATE",n._addInListRefreshRateDays=1/24,n._addInDetailsRefreshRateDays=365,n._addInManifestRefreshRateDays=365,n._addInOkState="Ok",n}();e.PrivateCatalog=t,e.CatalogFactory.register(i.StoreType.PrivateCatalog,(function(e){return new t(e.appName,e.appVersion,e.appUILocale)}))}(l||(l={})),function(e){var t=function(){var t="Failed to parse response into PrivateCatalogServiceResponse object.",n=200,r=!0,o=null,a=!1;function c(e,t){this._clientCode=e,this._clientVersion=t}return c.initRequestHandler=function(t,n,s,u){void 0===u&&(u=a),c._requestHandler==o&&(c._requestHandler=t),c.authenticationProxy==o&&(c.authenticationProxy=n),c._isThirdPartyHostEnabled=s,c._resultCodeIsEnabled=u&&u===r,c._tokenCacheManager=new e.TokenCacheManager(i.OUtil.getLocalStorage(),new e.SafeSerializer),c._cacheManager=new e.AppsDataCacheManager(i.OUtil.getLocalStorage(),new e.SafeSerializer)},c.ParseAddInList=function(e,t){var n,r=[];try{n=JSON.parse(e)}catch(e){return s.RuntimeTelemetryHelper.LogExceptionTag("Could not parse GetAddIns reponse.",e,t.correlationId,19965730),o}if(!n||!n.AddIns)return s.RuntimeTelemetryHelper.LogCommonMessageTag("GetPrivateCatalogAddIns response could not be parsed.",t.correlationId,20194262),r;for(var a=0,u=n.AddIns;a<u.length;a++){var l=u[a];l.AddInState&&l.ProductId&&l.Version?(r.push({assetId:l.ProductId,storeId:l.StoreInfo?l.StoreInfo.AssetId:"none",appVersion:l.Version,storeType:i.StoreType.PrivateCatalog,targetType:i.OsfControlTarget.Undefined,addInState:l.AddInState,contentMarket:l.StoreInfo?l.StoreInfo.ContentMarket:""}),c.StoreAuthenticationData(n)):s.RuntimeTelemetryHelper.LogCommonMessageTag(i.OUtil.formatString('Add-In metadata was missing some data. ID: "{0}", Version: "{1}", State: "{2}".',l.ProductId||"",l.Version||"",l.AddInState||""),t.correlationId,20194263)}return r},c.ParseAndCacheManifestList=function(e,t){var n,r=[];try{n=JSON.parse(e)}catch(e){return s.RuntimeTelemetryHelper.LogExceptionTag("Could not parse GetManifests reponse.",e,t.correlationId,19965731),o}if(!n||!n.Manifests)return s.RuntimeTelemetryHelper.LogCommonMessageTag("GetAddInManifests response could not be parsed.",t.correlationId,20194264),r;for(var i=0,a=n.Manifests;i<a.length;i++){var u=a[i];r.push(u)}return c.StoreAuthenticationData(n),r},c.StoreAuthenticationData=function(e){c._tokenCacheManager.AddRefreshToken(e.RefreshToken,e.UserId,e.TenantId),c._userId=e.UserId,c._tenantId=e.TenantId},c.prototype.GetLastPrivateCatalogUpdate=function(t,i,u,l,d){var f=this,p=0;c._requestHandler.getLastPrivateCatalogUpdate(this._clientCode,this._clientVersion,t,i,u.correlationId,(function(m,g){var h="GetLastPrivateCatalogUpdate response could not be parsed.",v="Could not parse GetLastPrivateCatalogUpdate reponse.";if(p++,c._resultCodeIsEnabled){if(m===n){var y=c.ParsePrivateCatalogServiceResponse(g,u);if(!y)return void d(e.DataServiceResultCode.Failed);if(1===y.ResponseCode){try{_=JSON.parse(g)}catch(t){return s.RuntimeTelemetryHelper.LogExceptionTag(v,t,u.correlationId,42284249),void d(e.DataServiceResultCode.Failed)}return _&&_.LastUpdate?(c.StoreAuthenticationData(_),void l(_.LastUpdate)):(s.RuntimeTelemetryHelper.LogCommonMessageTag(h,u.correlationId,42284250),void d(e.DataServiceResultCode.Failed))}if(2===y.ResponseCode)if(S=c.TryGetRefreshToken(g,u))return void f.GetLastPrivateCatalogUpdate(o,S,u,l,d);if(2===y.ResponseCode||3===y.ResponseCode){var b=r;return setTimeout((function(){c.authenticationProxy.tryAuthorize((function(e){b&&(b=a,f.GetLastPrivateCatalogUpdate(e,o,u,l,d))}),(function(){if(b){b=a;var t=c._isThirdPartyHostEnabled?e.DataServiceResultCode.Unauthenticated:e.DataServiceResultCode.Failed;d(t)}}))}),0),void setTimeout((function(){if(b){b=a;var t=c._isThirdPartyHostEnabled?e.DataServiceResultCode.Unauthenticated:e.DataServiceResultCode.Failed;d(t)}}),c._authenticationTimeout)}return void c.HandleLogging(y,u,d)}}else{if(m===n){var _;try{_=JSON.parse(g)}catch(t){return s.RuntimeTelemetryHelper.LogExceptionTag(v,t,u.correlationId,22823177),void d(e.DataServiceResultCode.Failed)}return _&&_.LastUpdate?(c.StoreAuthenticationData(_),void l(_.LastUpdate)):(s.RuntimeTelemetryHelper.LogCommonMessageTag(h,u.correlationId,22823178),void d(e.DataServiceResultCode.Failed))}if(403===m){var S;if(1==p)if(p++,(S=c.TryGetRefreshToken(g,u))!=o)return void f.GetLastPrivateCatalogUpdate(t,S,u,l,d);if(p>c._maxAuthenticationAttempts||t!=o)return s.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetLastPrivateCatalogUpdate authentication loop occured.",o,u.correlationId,22823179),void d(e.DataServiceResultCode.Unauthenticated);p++;b=r;return setTimeout((function(){c.authenticationProxy.tryAuthorize((function(e){b&&(b=a,f.GetLastPrivateCatalogUpdate(e,i,u,l,d))}),(function(){b&&(b=a,d(e.DataServiceResultCode.Unauthenticated))}))}),0),void setTimeout((function(){b&&(b=a,d(e.DataServiceResultCode.Unauthenticated))}),5e3)}}s.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetLastPrivateCatalogUpdate request failed with status code "+m,o,u.correlationId,22823180),d(e.DataServiceResultCode.Failed)}))},c.prototype.GetAddInList=function(t,i,u,l,d){var f=this,p=0;c._requestHandler.getPrivateCatalogAddIns(this._clientCode,this._clientVersion,t,i,u.correlationId,(function(m,g){if(p++,c._resultCodeIsEnabled){if(m===n){var h=c.ParsePrivateCatalogServiceResponse(g,u);if(!h)return void d(e.DataServiceResultCode.Failed);if(1===h.ResponseCode)return(y=c.ParseAddInList(g,u))?void l(y):void d(e.DataServiceResultCode.Failed);if(2===h.ResponseCode)if(b=c._tokenCacheManager.GetRefreshToken(h.UserId,h.TenantId))return void f.GetAddInList(o,b,u,l,d);if(2===h.ResponseCode||3===h.ResponseCode){var v=r;return setTimeout((function(){c.authenticationProxy.tryAuthorize((function(e){v&&(v=a,f.GetAddInList(e,o,u,l,d))}),(function(){if(v){v=a;var t=c._isThirdPartyHostEnabled?e.DataServiceResultCode.Unauthenticated:e.DataServiceResultCode.Failed;d(t)}}))}),0),void setTimeout((function(){if(v){v=a;var t=c._isThirdPartyHostEnabled?e.DataServiceResultCode.Unauthenticated:e.DataServiceResultCode.Failed;d(t)}}),c._authenticationTimeout)}return void c.HandleLogging(h,u,d)}}else{var y;if(m===n)return(y=c.ParseAddInList(g,u))?void l(y):void d(e.DataServiceResultCode.Failed);if(403===m){var b;if(1==p)if(p++,(b=c.TryGetRefreshToken(g,u))!=o)return void f.GetAddInList(t,b,u,l,d);if(p>c._maxAuthenticationAttempts||t!=o)return s.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetAddInList authentication loop occured. Either authentication attempts count is greater than 2, or authorizationCode is not null. attemptsCount: "+p,o,u.correlationId,20497158),void d(e.DataServiceResultCode.Unauthenticated);p++;v=r;return setTimeout((function(){c.authenticationProxy.tryAuthorize((function(e){v&&(v=a,f.GetAddInList(e,i,u,l,d))}),(function(){if(v){v=a;var t=c._isThirdPartyHostEnabled?e.DataServiceResultCode.Unauthenticated:e.DataServiceResultCode.Failed;d(t)}}))}),0),void setTimeout((function(){if(v){v=a;var t=c._isThirdPartyHostEnabled?e.DataServiceResultCode.Unauthenticated:e.DataServiceResultCode.Failed;d(t)}}),5e3)}}s.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetAddInList request failed with status code "+m,o,u.correlationId,20497159),d(e.DataServiceResultCode.Failed)}))},c.prototype.GetManifests=function(t,i,u,l,d,f){var p=this,m=0,g={AddIns:t,RefreshToken:u,ResponseCode:1,UserId:"",TenantId:""};c._requestHandler.getPrivateCatalogManifests(e.WACUtils.serializeObjectToString(g),i,u,l.correlationId,(function(g,h){if(m++,c._resultCodeIsEnabled){if(g===n){var v=c.ParsePrivateCatalogServiceResponse(h,l);if(!v)return void f(e.DataServiceResultCode.Failed);if(1===v.ResponseCode)return(b=c.ParseAndCacheManifestList(h,l))?void d(b):void f(e.DataServiceResultCode.Failed);if(2===v.ResponseCode)if(_=c.TryGetRefreshToken(h,l))return void p.GetManifests(t,o,_,l,d,f);if(2===v.ResponseCode||3===v.ResponseCode){var y=r;return setTimeout((function(){c.authenticationProxy.tryAuthorize((function(e){y&&(y=a,p.GetManifests(t,e,o,l,d,f))}),(function(){if(y){y=a;var t=c._isThirdPartyHostEnabled?e.DataServiceResultCode.Unauthenticated:e.DataServiceResultCode.Failed;f(t)}}))}),0),void setTimeout((function(){if(y){y=a;var t=c._isThirdPartyHostEnabled?e.DataServiceResultCode.Unauthenticated:e.DataServiceResultCode.Failed;f(t)}}),c._authenticationTimeout)}return void c.HandleLogging(v,l,f)}}else{var b;if(g===n)return(b=c.ParseAndCacheManifestList(h,l))?void d(b):void f(e.DataServiceResultCode.Failed);if(403===g){var _;if(1==m)if(m++,(_=c.TryGetRefreshToken(h,l))!=o)return void p.GetManifests(t,i,_,l,d,f);return m>c._maxAuthenticationAttempts||i!=o?(s.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetManifests authentication loop occured.",o,l.correlationId,20497160),void f(e.DataServiceResultCode.Unauthenticated)):(m++,void c.authenticationProxy.tryAuthorize((function(e){p.GetManifests(t,e,u,l,d,f)}),(function(){f(e.DataServiceResultCode.Unauthenticated)})))}}s.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetManifests request failed with status code "+g,o,l.correlationId,20497161),f(e.DataServiceResultCode.Failed)}))},c.TryGetRefreshToken=function(e,n){var r;try{r=JSON.parse(e)}catch(e){s.RuntimeTelemetryHelper.LogCommonMessageTag(t,n.correlationId,40748691)}return r?c._tokenCacheManager.GetRefreshToken(r.UserId,r.TenantId):o},c.HandleLogging=function(t,n,r){return t?4===t.ResponseCode||5===t.ResponseCode?(5===t.ResponseCode?s.RuntimeTelemetryHelper.LogCommonMessageTag("PrivateCatalogService: User not authenticated.",o,42768075):s.RuntimeTelemetryHelper.LogExceptionTag("PrivateCatalogService: All authentication attempts failed. ResponseCode: "+t.ResponseCode,o,n.correlationId,42284252),void r(c._isThirdPartyHostEnabled?e.DataServiceResultCode.Unauthenticated:e.DataServiceResultCode.Failed)):((0===t.ResponseCode||7===t.ResponseCode)&&s.RuntimeTelemetryHelper.LogExceptionTag("Call to AddinServiceHandler failed. ResponseCode: "+t.ResponseCode,o,n.correlationId,42284253),6===t.ResponseCode&&s.RuntimeTelemetryHelper.LogCommonMessageTag("PrivateCatalogService: User not supported.",o,42284254),void r(e.DataServiceResultCode.Failed)):(s.RuntimeTelemetryHelper.LogExceptionTag("PrivateCatalogService.HandleLogging: parsedResponse object is null.",o,n.correlationId,42284251),void r(e.DataServiceResultCode.Failed))},c.ParsePrivateCatalogServiceResponse=function(e,n){var r;try{r=JSON.parse(e)}catch(e){s.RuntimeTelemetryHelper.LogCommonMessageTag(t,n.correlationId,42284255)}return r},c.SignOutUser=function(){s.RuntimeTelemetryHelper.LogCommonMessageTag(i.OUtil.formatString("PrivateCatalogService.SignOutUser: userId = {0}, tenantId = {1}",c._userId,c._tenantId),o,21616005),c._tokenCacheManager.RemoveRefreshToken(c._userId,c._tenantId),c.authenticationProxy.signOut((function(){c._cacheManager.RemoveAll(e.PrivateCatalog._addInsCacheKey),c._cacheManager.RemoveAll(e.PrivateCatalog._addInDetailsCacheKeyPrefix)}),(function(){s.RuntimeTelemetryHelper.LogCommonMessageTag("Private Catalog: Failed to sign out ",o,22316866)}))},c._maxAuthenticationAttempts=3,c._authenticationTimeout=3e3,c}();e.PrivateCatalogService=t}(l||(l={})),function(e){var t=function(){var t="requestIdleCallback",n="SDX Catalog Error AssetId: ",r=!0,o=null,a="fetch",c=!1,u="errorMessage",l="manifestParseEnd",d="manifestParseStart",f="manifestRetrievalEnd",p="manifestRetrievalStart",m="packageListParseEnd",g="packageListParseStart",h="packageListRetrievalEnd",v="packageListRetrievalStart",y="activateAsyncStart",b="cachedUrls",_="Version",S="FFN",C="AssetId",O="OsfControlId",A="performanceTimestampOrigin";function I(){}return I.recordActivity=function(e,t,n,r){otel&&otel.sendActivityEvent&&otel.sendActivityEvent({name:"Office.Online.Sdx."+e,durationMs:performance.now()-t,succeeded:n,dataFields:r})},I.recordActivationActivity=function(e,t){var n="activationStart";I.recordActivity("Activation",t[n],e,[{name:"PerformanceTimestampOrigin",double:t[A]},{name:O,string:t.osfControlId},{name:C,string:t.assetId},{name:S,string:t.ffn},{name:_,string:t.version},{name:"SourceLocationOverrideResourceId",string:t.sourceLocationOverrideResourceId},{name:"IframeUrl",string:t.iframeUrl},{name:"CachedUrls",string:t[b]},{name:"ActivationStart",double:t[n]},{name:"ActivateAsyncStart",double:t[y]},{name:"PackageListRetrievalStart",double:t[v]},{name:"PackageListRetrievalEnd",double:t[h]},{name:"PackageListParseStart",double:t[g]},{name:"PackageListParseEnd",double:t[m]},{name:"ManifestRetrievalStart",double:t[p]},{name:"ManifestRetrievalEnd",double:t[f]},{name:"ManifestParseStart",double:t[d]},{name:"ManifestParseEnd",double:t[l]},{name:"IframeCreateStart",double:t.iframeCreateStart},{name:"IframeCreateEnd",double:t.iframeCreateEnd},{name:"GetAppContextStart",double:t.getAppContextStart},{name:"GetAppContextEnd",double:t.getAppContextEnd},{name:"IframeOnLoadReceived",double:t.iframeOnLoadReceived},{name:"ErrorMessage",string:t[u]}])},I.GetPackageList=function(t,n,r,u,l,d){void 0===d&&(d=c);var f=window[a]||e.AsyncUtil.fetch,p={automation:"Dogfood",microsoft:"Microsoft",dogfood:"Dogfood"}[JSON.parse(l).AudienceGroup.toLowerCase()]||"Production";return e.AsyncUtil.withCache("SDXPackageList_"+r+"_"+n.toLowerCase(),{forceUpdateCache:d,maxAgeInSecs:3600},(function(){return e.AsyncUtil.retry((function(){var e=i.OUtil.Guid.generateNewGuid();return s.RuntimeTelemetryHelper.LogCommonMessageTag("Making network call to DMS. DMSActivityId="+e,o,594629387),f(t,{method:"POST",body:JSON.stringify({Context:{Hosts:[r],ReactNativeVersion:"0.0.0.0",Channel:"DevMain",Capabilities:i.AppSpecificSetup.BuildRequirementsChecker()._getSupportedSetAsDmsCapabilities(),Ring:p,Platform:"Web",Locales:[n],ClientId:u},SyncId:0}),headers:{"Content-Type":"application/json",DMSActivityId:e}}).then((function(e){if(!e.ok)throw new Error("GetPackageList error: "+e.status+" - "+e.statusText);return e.text()}))}))}))},I.GetManifest=function(t,n,r,i){void 0===i&&(i=c);var u=window[a]||e.AsyncUtil.fetch,l=I.GetManifestCdnUrl(t,n);return e.AsyncUtil.withCache("SDXManifest_"+n.AssetId+"_"+n.FFN+"_"+n.Version,{forceUpdateCache:i},(function(){return e.AsyncUtil.retry((function(){return s.RuntimeTelemetryHelper.LogCommonMessageTag("Making network call to CDN. Url="+l,o,594629386),u(l).then((function(e){if(!e.ok)throw new Error("GetManifest error: "+e.status+" - "+e.statusText);return e.text()}))}))}))},I.GetManifestCdnUrl=function(e,t){return i.OUtil.formatString(e,t.AssetId,t.FFN,t.Version,"en-us")},I.IsAbsoluteUrl=function(e){return/^(?:[a-z]+:)?\/\//i.test(e)},I.ResolveUrl=function(e,t){if(I.IsAbsoluteUrl(t))return t;var n=e.lastIndexOf("/");return e.substr(0,n)+("/"===t.charAt(0)?"":"/")+t},I.UpdateManifestIconUrl=function(e,t,n){for(var r=["_iconUrls","_highResolutionIconUrls"],o=0;o<r.length;o++){var i=r[o];e[i]&&e[i][n]&&(e[i][n]=I.ResolveUrl(t,e[i][n]))}},I.InitializeSdxList=function(e,t,n,a,c,u){var l=I.GetPackageList(e,n,i.getManifestHostType(a),c,u,r).then((function(e){var t=e.value;return JSON.parse(t).Packages}));l.then((function(e){return e.forEach((function(e){return I.requestIdleCallback(function(e){return function(){return I.GetManifest(t,e,n,r).catch((function(){}))}}(e))})),e}),(function(e){s.RuntimeTelemetryHelper.LogExceptionTag("Error in getting SDX package list.",e,o,594629385)})),I.SdxCdnManifestUrlByAssetId=l.then((function(e){var n={};return e.forEach((function(e){n[e.AssetId.toLowerCase()]=I.GetManifestCdnUrl(t,e)})),n}))},I.PrefetchUrl=function(t,n){if(void 0===n&&(n=c),!I.PrefetchedAssetSet.hasOwnProperty(t)){var r={start:performance.now()};if(I.PrefetchedAssetSet[t]=r,n){var o=document.createElement("link");o.rel="prefetch",o.href=t,o.onload=function(){r.end=performance.now()},document.head.appendChild(o)}else{var i=window[a]||e.AsyncUtil.fetch;I.requestIdleCallback((function(){i(t,{mode:"no-cors"}).then((function(){r.end=performance.now()}))}))}}},I.ResolveRelativeUrl=function(e,t){return I.SdxCdnManifestUrlByAssetId.then((function(n){var r=n[t.toLowerCase()];if(r==o)throw new Error("Unable to find manifestUrl");return I.ResolveUrl(r,e)}))},I.PrefetchAsset=function(e,t,n,a){var s=e.match(I.OfficeJsEntryRegex);if(s===o){var u=c;"iframeUrl:"===e.slice(0,10)&&(e=e.slice(10),u=r),I.IsAbsoluteUrl(e)?I.PrefetchUrl(e,u):u?I.ResolveRelativeUrl(e,a).then((function(e){return I.PrefetchUrl(e,r)}),(function(){})):I.ResolveRelativeUrl(e,a).then((function(e){return I.PrefetchUrl(e,c)}),(function(){}))}else{var l=s[1],d=s[2],f="https://appsforoffice.microsoft.com/lib/"+s[3]+"/hosted/",p=n.toLowerCase(),m=i.HostSpecificFileVersionMap[p].web||i.HostSpecificFileVersionDefault;I.PrefetchUrl(""+f+l),I.PrefetchUrl(""+f+p+"-web-"+m+(d||"")+".js"),I.PrefetchUrl(f+"en-us/office_strings.js"),I.PrefetchUrl(f+"telemetry/oteljs_agave.js"),I.PrefetchUrl(f+"webauth/webauth.implicit.js")}},I.PrefetchSdxAssets=function(e,t,n,i){var a="Microsoft.Office.OEP.",u=e.SdxAssetsToPrefetchMapping;if(u!=o){var l=[],d=[];try{l=JSON.parse(t[a+i.toUpperCase()+".SdxPrefetchAssetsToAdd"]||"[]"),d=JSON.parse(t[a+i.toUpperCase()+".SdxPrefetchAssetsToRemove"]||"[]")}catch(e){s.RuntimeTelemetryHelper.LogExceptionTag("Error in parsing the sdx prefetch override flighting treatment variables.",e,o,593052824)}if("Word"===n){var f;try{f=JSON.parse(u)[i.toLowerCase()]}catch(e){return void I.LogSDXCatalogMonitoringError("Parsing SdxAssetsToPrefetchMapping failed.",i)}if(Array.isArray(f))for(var p=0;p<f.length;p++){var m=f[p];-1===d.indexOf(m)&&I.PrefetchAsset(m,e,n,i)}else for(var g=0,h=Object.keys(f);g<h.length;g++){var v=h[g],y=c;if(""===v)y=r;else{var b=v.split("=="),_=b[0],S=b[1];e[_]==S?y=r:t["Microsoft.Office."+_]==S&&(y=r)}if(y)for(var C=0,O=f[v];C<O.length;C++){m=O[C];-1===d.indexOf(m)&&I.PrefetchAsset(m,e,n,i)}}for(var A=0;A<l.length;A++){m=l[A];I.PrefetchAsset(m,e,n,i)}}}},I.AddWacSettingParametersToIframeUrl=function(e,t){var n=document.createElement("a");n.href=e;var r=Object.keys(t).map((function(e){return"wacSetting"+e+"="+encodeURIComponent(t[e].toString())})).join("&"),o=n.search.length>1?n.search.substr(1)+"&":"";return n.search=o+r,n.href},I.activateAsync=function(t,a,x,E,T,P){var w="WasCachedInMemory",M="PackageListRetrieval";x.startActivity(e.Activity.Activation),P[y]=performance.now(),P.assetId=t.assetId.toUpperCase();var R=e.CatalogFactory.getHostContext();s.RuntimeTelemetryHelper.LogCommonMessageTag("Start activating SDX with assetId: "+t.assetId+".",x.correlationId,37291606),x.startActivity(e.Activity.ServerCall);var j=o,k=performance.now();P[v]=performance.now(),I.GetPackageList(R.sdxDmsUrl,R.appUILocale,i.getManifestHostType(R.hostType),T.clientId,T.sessionStartInfoJson).then((function(e){var t=e.cacheType,n=e.value;P[h]=performance.now(),P[g]=performance.now();var r={cacheType:t,packages:JSON.parse(n).Packages};return P[m]=performance.now(),r})).then((function(e){var t=e.cacheType,n=e.packages;return I.recordActivity(M,k,r,[{name:O,string:x.instanceId},{name:w,bool:"memory"==t}]),n}),(function(e){throw P[h]=performance.now(),I.recordActivity(M,k,c,[{name:O,string:x.instanceId},{name:w,bool:c}]),e.sdxErrorCode=i.ErrorStatusCodes.WAC_SDX_DMSRequestFailed,e})).then((function(e){if((j=e.filter((function(e){return e.AssetId.toLowerCase()==t.assetId.toLowerCase()}))[0])==o){var n=new Error('Unable to find SDX "'+t.assetId+'" in the package list.');throw n.sdxErrorCode=i.ErrorStatusCodes.WAC_SDX_AssetIdNotInDMSResponse,n}return j})).then((function(t){var n="ManifestRetrieval";x.startActivity(e.Activity.ManifestRequest);var o=performance.now();return P[p]=performance.now(),P.ffn=t.FFN,P.version=t.Version,I.GetManifest(R.sdxCdnUrl,t,R.appUILocale).then((function(e){var i=e.cacheType,a=e.value;return P[f]=performance.now(),I.recordActivity(n,o,r,[{name:O,string:x.instanceId},{name:C,string:t.AssetId},{name:S,string:t.FFN},{name:_,string:t.Version},{name:w,bool:"memory"==i}]),a}),(function(e){throw P[f]=performance.now(),I.recordActivity(n,o,c,[{name:O,string:x.instanceId},{name:C,string:t.AssetId},{name:S,string:t.FFN},{name:_,string:t.Version},{name:w,bool:c}]),e.sdxErrorCode=i.ErrorStatusCodes.WAC_AgaveManifestRequestFailure,e}))})).then((function(t){P[d]=performance.now();var n=e.ManifestUtil.ParseManifest(t,R.appUILocale,x.correlationId);if(P[l]=performance.now(),I.recordActivity("ManifestParse",P[d],n!=o,[{name:O,string:x.instanceId},{name:C,string:j.AssetId},{name:S,string:j.FFN},{name:_,string:j.Version}]),n==o){var r=new Error("Unable to parse manifest.");throw r.sdxErrorCode=i.ErrorStatusCodes.WAC_AgaveManifestRequestFailure,r}return i.OsfManifestManager.cacheManifest(j.AssetId,"",n),n})).then((function(n){x.stopActivity(e.Activity.ServerCall),x.stopActivity(e.Activity.ManifestRequest);var r=I.GetManifestCdnUrl(R.sdxCdnUrl,j);I.UpdateManifestIconUrl(n,r,R.appUILocale),P[b]=JSON.stringify(I.PrefetchedAssetSet),P[A]=Date.now()-performance.now(),a.load({entitlement:t,manifest:n,eToken:"",manifestUrl:r},o)}),(function(r){if(P[u]=r.toString(),P[b]=JSON.stringify(I.PrefetchedAssetSet),P[A]=Date.now()-performance.now(),e.SDXCatalog.recordActivationActivity(c,P),s.RuntimeTelemetryHelper.LogExceptionTag(n+t.assetId,r,o,39068003),r.sdxErrorCode!=o){var i=e.HostFeatureEnabledInfo.getHostFeatureEnabledInfo(),l=i&&i.enableFirstPartySDXErrorMessages;e.LoaderUtil.failWithError(a,{title:l?Strings.OsfRuntime.L_AgaveErrorTile_TXT_FirstParty:Strings.OsfRuntime.L_AgaveErrorTile_TXT,description:l?Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR_FirstParty:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){a.restartActivation(),I.activateAsync(t,a,x,E,T,P)},errorCode:r.sdxErrorCode})}}))},I.LogSDXCatalogMonitoringError=function(e,t){s.RuntimeTelemetryHelper.LogExceptionTag(n+t+" Message: "+e,o,o,594350788)},I.PrefetchedAssetSet={},I.OfficeJsEntryRegex=/^(office(\.debug)?\.js)@(1|1\.0|1\.1|beta)$/i,I.requestIdleCallback=window[t]?window[t].bind(window):e.AsyncUtil.limitRate((function(e){return e()}),50),I}();e.SDXCatalog=t}(l||(l={})),function(e){var t=!1,n=null,r=!0,o=function(){function o(e,t){this._initParam=t,this._cacheManager=e.cacheManager,this._telemetryContext=e.telemetryContext}return o.prototype.getManifest=function(o,a,s,c){var u=this,l=u;u._telemetryContext.startActivity(e.Activity.ManifestRequest);var d=i.OsfManifestManager.getCachedManifest(a.OfficeExtensionID,a.OfficeExtensionVersion);if(d)return u._telemetryContext.stopActivity(e.Activity.ManifestRequest),u._telemetryContext.stopActivity(e.Activity.ServerCall),void s({status:e.DataServiceResultCode.Succeeded,value:{manifest:d,cached:r}});a.EncodedAbsUrl?o.getManifest(a.EncodedAbsUrl,a.OfficeExtensionID,a.OfficeExtensionVersion,(function(r){if(l._telemetryContext.stopActivity(e.Activity.ManifestRequest),l._telemetryContext.stopActivity(e.Activity.ServerCall),r.status==e.DataServiceResultCode.Succeeded){var o=e.ManifestUtil.ParseManifest(r.value.manifest,l._initParam.appUILocale,l._telemetryContext.correlationId);o==n&&(r.status=e.DataServiceResultCode.Failed),s({status:r.status,value:{manifest:o,cached:t}})}else s({status:r.status,value:{manifest:n,cached:t}})}),c):s({status:e.DataServiceResultCode.Failed,value:{manifest:n,cached:t}})},o.prototype.activate=function(o,a,s){var c,u=this,l={assetId:a.assetId,appVersion:a.appVersion,storeId:a.storeId,storeType:a.storeType,targetType:a.targetType},d=function(o,c){var d=o.manifest,f=d.getMarketplaceVersion();if(i.OsfManifestManager.cacheManifest(a.assetId,a.appVersion,d),o.cached&&e.ManifestUtil.versionLessThan(f,a.appVersion))m(r);else{if(d.requirementsSupported===t||void 0===d.requirementsSupported&&!s.getRequirementsChecker().isManifestSupported(d)){d.requirementsSupported=t;var p;return p=Strings.OsfRuntime.L_AgaveManifestRequirementsError_ERR||Strings.OsfRuntime.L_AgaveManifestError_ERR,void e.LoaderUtil.failWithError(s,{description:p,detailView:r,errorCode:i.ErrorStatusCodes.WAC_AgaveRequirementsError})}if(d.requirementsSupported=r,c&&!s.skipTrust(a)){var g=i.OUtil.formatString(i.Constants.ActivatedCacheKey,a.assetId.toLowerCase(),a.storeType,a.storeId),h=i.OmexClientNames[u._initParam.applicationName];if(!u._cacheManager.GetCacheItem(g,t)&&!s.hasConsent(a)&&!s.isForCustomFunctionSandbox())return void s.askForTrust({anonymous:n,clientName:h,entitlement:l,displayName:d.getDefaultDisplayName(),providerName:d.getProviderName(),iconUrl:d.getDefaultIconUrl(),isSSOAddin:d.isSSOAddin()},(function(){u._cacheManager.SetCacheItem(g,r),s.load({entitlement:l,manifest:d,eToken:n},n)}))}s.hasConsent(a)&&u._cacheManager.SetCacheItem(g,r),s.load({entitlement:l,manifest:d,eToken:n},n)}},f=function(t){u.getManifest(o,c,(function(n){n.status===e.DataServiceResultCode.Succeeded&&n.value.manifest?d(n.value,r):e.LoaderUtil.failWithError(s,{description:Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){s.restartActivation(),f(t)},errorCode:i.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE})}),t)},p=function(t){c?c.OfficeExtensionKillbit?e.LoaderUtil.failWithError(s,{description:Strings.OsfRuntime.L_AgaveDisabledByAdmin_ERR,errorCode:i.ErrorStatusCodes.E_OEM_EXTENSION_KILLED}):f(t):e.LoaderUtil.failWithError(s,{description:Strings.OsfRuntime.L_AgaveNotExist_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){s.restartActivation(),u._telemetryContext.startActivity(e.Activity.Activation),u._telemetryContext.startActivity(e.Activity.ServerCall),m(r)},errorCode:i.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST})},m=function(r){c=n,u._telemetryContext.startActivity(e.Activity.EntitlementCheck),o.getEntitlementAsync(t,a.targetType,(function(t){if(t.status==e.DataServiceResultCode.Succeeded){u._telemetryContext.stopActivity(e.Activity.EntitlementCheck);for(var o,a=n,d=t.value.entitlements,f=0;f<d.length;f++)(o=d[f]).OfficeExtensionID&&l.assetId&&o.OfficeExtensionID.toLowerCase()==l.assetId.toLowerCase()&&(a&&!e.ManifestUtil.versionLessThan(a.OfficeExtensionVersion,o.OfficeExtensionVersion)||(a=o));c=a,p(r)}else e.LoaderUtil.failWithError(s,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){s.restartActivation(),u._telemetryContext.startActivity(e.Activity.Activation),u._telemetryContext.startActivity(e.Activity.ServerCall),m()},errorCode:i.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE})}),r)};m()},o}(),a=function(){function a(t,r){var o=this;void 0===r&&(r=n),o._appDataService={},o._catalogUrlDataService={},o._initParam=t,o._cacheManager=r||new e.AppsDataCacheManager(i.OUtil.getLocalStorage(),new e.SafeSerializer)}return a.prototype.getDataService=function(e,t,n){this.getDataServiceInternal(this._appDataService,e,t,n)},a.prototype.getCatalogUrlDataService=function(e,t,n){this.getDataServiceInternal(this._catalogUrlDataService,e,t,n)},a.prototype.getDataServiceInternal=function(t,r,o,i){if(t[r]==n&&(t[r]={spCatalogService:n,spCatalogServiceReady:n}),t[r].spCatalogService==n)if(t[r].spCatalogServiceReady==n){t[r].spCatalogServiceReady=i;var a={status:e.DataServiceResultCode.Failed,value:n},s=function(o,i){var s=t[r].spCatalogServiceReady;t[r].spCatalogServiceReady=n,o.status==e.DataServiceResultCode.Succeeded?(t[r].spCatalogService=i,a.value=i,a.status=e.DataServiceResultCode.Succeeded,s(a)):(a.httpStatus=o.httpStatus,s(a))};o.startActivity(e.Activity.Authentication);var c=e.SPCatalogProxyBasedCatalogService.getInstance(this._initParam);c.prepareProxy(r,o.correlationId,(function(t){o.stopActivity(e.Activity.Authentication),s(t,c)}))}else{var u=t[r].spCatalogServiceReady;t[r].spCatalogServiceReady=function(e){u(e),i(e)}}else i({status:e.DataServiceResultCode.Succeeded,value:t[r].spCatalogService})},a.prototype.createActivityScope=function(t,n,r){var i=this;this.getDataService(t,n,(function(a){if(!e.AsyncUtil.failed(a,r)){var s=a.value,c={cacheManager:i._cacheManager,storeId:t,telemetryContext:n},u=s.createScope(c),l=new o(c,i._initParam);r({status:e.DataServiceResultCode.Succeeded,value:{serviceScope:u,activityScope:l}})}}))},a.prototype.getEntitlementAsync=function(t,r,o,a,s,c){var u=this,l=function(s){s.status===e.DataServiceResultCode.Succeeded?(u.myOrgCatalogUrl=s.value,u.createActivityScope(s.value,r,(function(r){e.AsyncUtil.failed(r,o,[])||r.value.serviceScope.getEntitlementAsync(t,n,(function(t){if(!e.AsyncUtil.failed(t,o,[])){for(var n=t.value.entitlements,r=0;r<n.length;r++){var a=n[r];a.assetId=a.OfficeExtensionID,a.appVersion=a.OfficeExtensionVersion,a.storeId=u.myOrgCatalogUrl,a.storeType=i.StoreType.SPCatalog,a.targetType=i.OfficeAppType[a.OEType]}o({status:t.status,value:n})}}),a)}))):o({status:s.status,value:n})};(c=c||this.myOrgCatalogUrl||n)?l({status:e.DataServiceResultCode.Succeeded,value:c}):this.getSPCatalogUrl(r,l)},a.prototype.getAndCacheManifest=function(o,a,s,c){var u=this;this.getEntitlementAsync(r,s,(function(t){if(i.OUtil.writeProfilerMark(i.OsfOfficeExtensionManagerPerfMarker.GetEntitlementEnd),t.status===e.DataServiceResultCode.Succeeded&&t.value){for(var r=t.value,a=r.length,l=n,d=0;d<a;d++){var f=r[d];f.OfficeExtensionID&&o.assetId&&f.OfficeExtensionID.toLowerCase()===o.assetId.toLowerCase()&&(l&&!i.OsfManifestManager.versionLessThan(l.OfficeExtensionVersion,f.OfficeExtensionVersion)||(l=f))}l!=n?u.createActivityScope(u.myOrgCatalogUrl,s,(function(t){e.AsyncUtil.failed(t,c)||t.value.activityScope.getManifest(t.value.serviceScope,l,(function(e){c({status:e.status,value:e.value.manifest})}))})):c({status:e.DataServiceResultCode.Failed,value:n})}else c({status:e.DataServiceResultCode.Failed,value:n})}),t,0,o.storeId)},a.prototype.isUpnMatchAsync=function(r,o,i){var a=this,s=this.myOrgCatalogUrl||n,c=function(s){s.status===e.DataServiceResultCode.Succeeded?(a.myOrgCatalogUrl=s.value,a.createActivityScope(s.value,o,(function(n){e.AsyncUtil.failed(n,i,t)||n.value.serviceScope.isUpnMatchAsync(r,i)}))):i({status:s.status,value:n})};s?c({status:e.DataServiceResultCode.Succeeded,value:s}):this.getSPCatalogUrl(o,c)},a.prototype.activateAsync=function(t,n,r){var o=this;r.startActivity(e.Activity.Activation),r.startActivity(e.Activity.ServerCall),this.createActivityScope(t.storeId,r,(function(a){if(a.status==e.DataServiceResultCode.Succeeded){var s=a.value.serviceScope;a.value.activityScope.activate(s,t,n)}else e.LoaderUtil.failWithError(n,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){n.restartActivation(),o.activateAsync(t,n,r)},errorCode:i.ErrorStatusCodes.WAC_AgaveAnonymousProxyCreationError})}))},a.prototype.removeAsync=function(t,n,r){r({status:e.DataServiceResultCode.Failed})},a.prototype.getAppDetails=function(t,n,r,o){o({status:e.DataServiceResultCode.Failed})},a.prototype.getSPCatalogUrl=function(t,n){var r=this;this.getCatalogUrlDataService(this._initParam.spBaseUrl,t,(function(){e.SPCatalogProxyBasedCatalogService.getInstance(r._initParam).getSPCatalogUrl(r._initParam.spBaseUrl,t.correlationId,n)}))},a}();e.CatalogFactory.register(i.StoreType.SPCatalog,(function(e){return new a({applicationName:i.HostCapability[e.hostType],AppVersion:e.appVersion,clientMode:e.clientMode,appUILocale:e.appUILocale,spBaseUrl:e.spBaseUrl,docUrl:e.docUrl})}))}(l||(l={})),function(e){var t=function(){function e(){}return e.CheckProxyIsReady="OEM_isProxyReady",e.GetEntitlementSummary="OEM_getEntitlementSummaryAsync",e.GetManifest="OEM_getManifestAsync",e.GetSPCatalogUrl="OEM_getSPCatalogUrlAsync",e.IsUpnMatch="OEM_isUpnMatchAsync",e}();e.SPCatalogProxyMethods=t;var n=function(){function e(){this.iframeProxies={},this.iframeProxyCount=0}return e.iframeNamePrefix="__officeExtensionProxy",e}();e.IframeProxyGroup=n;var r=function(r){var o=null;function a(e,t){r.call(this),this.proxyUrl=e,this.iframeProxyGroup=t}return c(a,r),a.prototype.getEntitlementsAsync=function(e,n){this.invokeProxyCommandAsync(t.GetEntitlementSummary,e,n)},a.prototype.getManifestAsync=function(e,n){this.invokeProxyCommandAsync(t.GetManifest,e,n)},a.prototype.getSPCatalogUrlAsync=function(e,n){this.invokeProxyCommandAsync(t.GetSPCatalogUrl,e,n)},a.prototype.isUpnMatchAsync=function(e,n){this.invokeProxyCommandAsync(t.IsUpnMatch,e,n)},a.prototype.prepareProxy=function(e,t){var n=this;n.isReady?e({status:o,value:{clientEndpoint:n.clientEndPoint}}):n.clientEndPoint?n.pendingCallbacks.push([e,t]):n.createProxy(e,t)},a.resetProxy=function(e){delete e.iframeProxyGroup.iframeProxies[e.proxyUrl],e.iframeProxyGroup.iframeProxyCount=e.iframeProxyGroup.iframeProxyCount-1,Microsoft.Office.Common.XdmCommunicationManager.getClientEndPoint(e.conversationId)&&Microsoft.Office.Common.XdmCommunicationManager.deleteClientEndPoint(e.conversationId),e.iframe&&(i.OUtil.removeEventListener(e.iframe,"load",e.iframeOnload),e.iframe.parentNode.removeChild(e.iframe),e.iframe=o),e.clientEndPoint=o},a.prototype.createProxy=function(r,c){var u=this;try{if(!u.doesUrlHaveSupportedProtocol(u.proxyUrl))return void c({status:o,value:{errorMessage:"Protocal of proxyUrl is not supported."}});u.iframeProxyGroup.iframeProxies[u.proxyUrl]=u,u.iframeProxyGroup.iframeProxyCount=u.iframeProxyGroup.iframeProxyCount+1;var l=u.proxyUrl,d=l.length;"/"===l.charAt(d-1)&&(l=l.substr(0,d-1));var f=document.createElement("iframe"),p=n.iframeNamePrefix+u.iframeProxyGroup.iframeProxyCount;f.setAttribute("id",p),f.setAttribute("name",p);var m=l+"/_layouts/15/OfficeExtensionManager.aspx?"+u.conversationId,g=window.location.origin;m=i.OUtil.addXdmInfoAsHash(m,u.conversationId+"|"+p+"|"+g),m=i.OUtil.addSerializerVersionAsHash(m,i.SerializerVersion.Browser),m=i.OUtil.addFlightsAsHash(m,JSON.stringify(i.Flights)),f.setAttribute("scrolling","auto"),f.setAttribute("border","0"),f.setAttribute("width","0"),f.setAttribute("height","0"),f.setAttribute("style","position: absolute; left: -100px; top:0px;");var h=u;document.body.appendChild(f);var v=function(){if(h.clientEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(h.conversationId,f.contentWindow,h.proxyUrl),h.clientEndPoint)h.clientEndPoint.invoke(t.CheckProxyIsReady,(function(e,t){var n=o;0===e&&t.status?(h.isReady=!0,n={status:o,value:{clientEndpoint:h.clientEndPoint}}):(a.resetProxy(h),n={status:o,value:{errorMessage:"isProxyReadyCallback failed, error code "+e}});for(var r=h.pendingCallbacks.length,i=0;i<r;i++){var s=h.pendingCallbacks.shift();h.isReady?s[0](n):s[1](n)}}),{__timeout__:2e3});else{var e="Unexpected error, iframe loaded again after failing OEM_isProxyReady";s.RuntimeTelemetryHelper.LogExceptionTag(e,o,o,18657365),c({status:o,value:{errorMessage:e}})}};i.OUtil.addEventListener(f,"load",v),f.setAttribute("src",m),u.iframeOnload=v,u.pendingCallbacks.push([r,c]),u.iframe=f}catch(t){var y="Error creating client endpoint with proxyUrl = ["+u.proxyUrl+"], msg:"+e.WACUtils.serializeObjectToString(t);c({status:o,value:{errorMessage:y}})}},a}(e.ProxyBase);e.SPCatalogProxy=r}(l||(l={})),function(e){var t="webUrl",n=null,r=function(){function r(t){this.proxyRetries={},this.initParams=t,this.iframeProxyGroup=new e.IframeProxyGroup}return r.getInstance=function(e){return r._instance==n&&(r._instance=new r(e)),r._instance},r.prototype.prepareProxy=function(t,r,o){r=r||"";this.proxyRetries[t]=1,this.ensureSPCatalogProxySetUp(t,r,(function(t){t&&t.status!=n?t.status:e.DataServiceResultCode.ProxyNotReady;o({status:t.status})}))},r.prototype.createScope=function(e){return new a(e,this)},r.prototype.getSPCatalogUrl=function(r,a,c){var u=this;this.prepareProxy(r,a,(function(){var l;if(r)if(l=u.iframeProxyGroup.iframeProxies[r]){var d={};d[t]=r,l.getSPCatalogUrlAsync(d,(function(t){var r="getspcatalogurl failed";t.status!==e.DataServiceResultCode.Succeeded&&(s.RuntimeTelemetryHelper.LogExceptionTag(r,n,a,19015125),o.msAjaxDebug.trace(r)),c(t)}))}else s.RuntimeTelemetryHelper.LogExceptionTag(i.OUtil.formatString("getspcatalogurl proxy not found, webUrl: {0}",r),n,a,19969545),c({status:e.DataServiceResultCode.ProxyNotReady});else s.RuntimeTelemetryHelper.LogExceptionTag("getspcatalogurl proxy URL empty",n,a,595190872),c({status:e.DataServiceResultCode.PrxoyUrlEmpty})}))},r.prototype.ensureSPCatalogProxySetUp=function(t,r,o){if(!t)return s.RuntimeTelemetryHelper.LogExceptionTag("proxyUrl is null",n,r,19969546),void o({status:e.DataServiceResultCode.Failed});var a=this.iframeProxyGroup.iframeProxies[t];if(a||(a=new e.SPCatalogProxy(t,this.iframeProxyGroup)),a.isReady)o({status:e.DataServiceResultCode.Succeeded});else{var c=this,u=function(){o({status:e.DataServiceResultCode.Succeeded})},l=function(){c.proxyRetries[t]<i.Constants.AuthenticatedConnectMaxTries?(c.proxyRetries[t]++,a.prepareProxy(u,l)):(s.RuntimeTelemetryHelper.LogExceptionTag("sp exceed maximum tries and fail",n,r,18940555),o({status:e.DataServiceResultCode.ProxyNotReady}))};a.prepareProxy(u,l)}},r}();e.SPCatalogProxyBasedCatalogService=r;var a=function(){var r="clearCache";function o(e,t){this._catalogService=t,this.proxyUrl=e.storeId,this._correlationId=e.telemetryContext.correlationId||""}return o.prototype.tryFail=function(t,n,r){return t!=e.DataServiceResultCode.Succeeded&&(r({status:t}),!0)},o.prototype.getEntitlementAsync=function(e,n,o,i){var a=this,s=a,c=a._catalogService.iframeProxyGroup.iframeProxies[a.proxyUrl],u={};u[t]=a.proxyUrl,u.applicationName=a._catalogService.initParams.applicationName,u.officeExtentionTarget=n,u[r]=i||!1,u.supportedManifestVersions={"1.0":!0,1.1:!0},c.getEntitlementsAsync(u,(function(e){s.tryFail(e.status,e.httpStatus,o)?s.logServiceCallResponseError("entitlement",e.httpStatus):o(e)}))},o.prototype.getLastStoreUpdate=function(){},o.prototype.getManifest=function(e,t,n,o,i){var a=this,s=this._catalogService.iframeProxyGroup.iframeProxies[this.proxyUrl],c={};c.manifestUrl=e,c.id=t,c.version=n,c[r]=i,s.getManifestAsync(c,(function(e){a.tryFail(e.status,e.httpStatus,o)?a.logServiceCallResponseError("manifest",e.httpStatus):o(e)}))},o.prototype.isUpnMatchAsync=function(e,n){var r=this,o=r,i=r._catalogService.iframeProxyGroup.iframeProxies[r.proxyUrl],a={};a.upn=e,a[t]=r.proxyUrl,i.isUpnMatchAsync(a,(function(e){o.tryFail(e.status,e.httpStatus,n)?o.logServiceCallResponseError("isUpnMatch",e.httpStatus):n(e)}))},o.prototype.logServiceCallResponseError=function(e,t){var r="spproxy request "+e+" failed";t&&(r+=":"+t),s.RuntimeTelemetryHelper.LogExceptionTag(r,n,this._correlationId,18940556)},o}();e.SPCatalogProxyBasedCatalogServiceScope=a}(l||(l={})),i.InfoType={Error:0,Warning:1,Information:2,SecurityInfo:3},i.NotificationType={TrustYellowBar:0,TrustPromptTaskpane:3,TrustPromptContent:4},i.OmexMessageType={TabExit:1,ButtonClick:2,PageLoad:3},i._ErrorUXHelper=function(e){var t="progress_",n="input,a,button",r="moe-infobar-button2_",o=!0,a="moe-infobar-button_",c="moe-infobar-button",u=!1,d="button",f="moe-infobar-dismiss_",p="moe-infobar-dismiss",m="moe-infobar-message",g="moe-infobar-message_",h="moe-infobar-title",v="span",y="moe-infobar-message-div",b="moe-infobar-secinfo",_="moe-infobar-info",S="moe-infobar-warning",C="moe-infobar-error",O="moe-infobar-button-cell",A="moe-infobar-top-right-cell",I="moe-infobar-message-cell",x="moe-infobar-top-left-cell",E="presentation",T="role",P="moe-infobar-infotable",w="table",M="moe-infobar-body",R="alt",j=null,k="100%",N="center",D="no-repeat",F="alpha(opacity=100)",L="1",U="white",B="url(",H="onclick",W="tabindex",V="image",z="type",G="input",q="id",K="moe-background",X="class",J="div",Q="moe-trust-prompt-table_",Z="notificationbackground_",Y="moe-infobar-body_",$="agavedefaulticon96x96.png",ee="moe_status_icons.png",te="progress.gif",ne="img",re=e,oe=re.getOsfOmexBaseUrl(),ie="omexNotificationIframeClassName";i.OUtil.loadCSS(re.getLocalizedCSSFilePath("moeerrorux.css")),document.createElement(ne).src=re.getLocalizedImageFilePath(te),document.createElement(ne).src=re.getLocalizedImageFilePath(ee),document.createElement(ne).src=re.getLocalizedImageFilePath($);var ae={},se=0,ce=function(e){for(var t,n=e.childNodes.length,r=0;r<n;)"iframe"===(t=e.childNodes.item(r)).tagName.toLowerCase()?r++:(e.removeChild(t),n--)},ue=function(e){var t=document.getElementById(e);t&&t.parentNode.removeChild(t)},le=function(e,t){var n;i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RemoveStage2Start),n=t?Y+e:Z+e;var r=Pe(e);r&&ae[e][0].highPriority&&se--,ue(n),r&&ae[e].shift(),i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RemoveStage2End)},de=function(e){i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RemoveStage2Start);var t=Q+e.id,n=Pe(e.id);n&&ae[e.id][0].highPriority&&se--,ue(t),n&&ae[e.id].shift(),i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RemoveStage2End)},fe=function(e){i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderStage1Start),ce(e.div);var t=document.createElement(J);t.setAttribute(X,K),t.setAttribute(q,"icon_"+e.id);var n=document.createElement(G);n.setAttribute(q,"iconImg_"+e.id),n.setAttribute(z,V),n.setAttribute(W,"0"),n.src=re.getLocalizedImageFilePath(ee);var r,o,a;n.setAttribute(H,"getIntoStage2(params)"),i.OUtil.attachClickHandler(n,(function(){!function(e){e.sqmDWords[1]|=2,Oe(e.id);var t=l.HostFeatureEnabledInfo.getHostFeatureEnabledInfo();t&&t.enableSingleSignOnForAddin?me(e):pe(e)}(e)})),t.appendChild(n),e.displayDeactive&&(t.style.backgroundImage=B+re.getLocalizedImageFilePath($)+")",t.style.backgroundColor=U,t.style.opacity=L,t.style.filter=F,t.style.backgroundRepeat=D,t.style.backgroundPosition=N,t.style.height=k),e.infoType===i.InfoType.Error?(r="moe-status-error-icon",o="iconImg_error_"+e.id,a=Strings.OsfRuntime.L_InfobarIconErrorAccessibleName_TXT):e.infoType===i.InfoType.Warning?(r="moe-status-warning-icon",o="iconImg_warning_"+e.id,a=Strings.OsfRuntime.L_InfobarIconWarningAccessibleName_TXT):e.infoType===i.InfoType.Information?(r="moe-status-info-icon",o="iconImg_info_"+e.id,a=Strings.OsfRuntime.L_InfobarIconInfoAccessibleName_TXT):(r="moe-status-secinfo-icon",o="iconImg_secinfo_"+e.id,a=Strings.OsfRuntime.L_InfobarIconSecInfoAccessibleName_TXT),new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent)!=j&&9==parseFloat(RegExp.$1)&&(r+="_ie"),n.setAttribute(X,r),n.setAttribute(q,o),n.setAttribute(R,a),0!=e.div.childNodes.length?e.div.insertBefore(t,e.div.childNodes[0]):e.div.appendChild(t),Ie(e.id,i.AgaveHostAction.TabIn),i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderStage1End)},pe=function(e){i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderStage2Start),ce(e.div);var t=e.description;e.title.length>100&&(e.title=e.title.substring(0,99)),e.description.length>255&&(e.description=e.description.substring(0,254));var n=Y+e.id,l=document.getElementById(n);null==l&&((l=document.createElement(J)).setAttribute(X,M),l.setAttribute(q,n));var Q=document.createElement(J);Q.innerHTML=t,l.setAttribute("title",Q.textContent),Q=j;var te=document.createElement(w);te.setAttribute(X,P),te.setAttribute(T,E);for(var oe=0;oe<3;oe++)te.insertRow(oe).setAttribute(T,E);var ie=te.rows;ie[0].insertCell(0),ie[0].insertCell(1),ie[0].insertCell(2),ie[0].cells[1].setAttribute("rowSpan","2"),ie[1].insertCell(0),ie[1].insertCell(1),ie[2].insertCell(0),ie[2].insertCell(1),ie[2].insertCell(2),ie[0].cells[0].setAttribute(X,x),ie[0].cells[1].setAttribute(X,I),ie[0].cells[2].setAttribute(X,A),ie[2].cells[1].setAttribute(X,O);var ae,se,ue=document.createElement(ne);ue.src=re.getLocalizedImageFilePath(ee),e.infoType===i.InfoType.Error?(ae=C,se=Strings.OsfRuntime.L_InfobarIconErrorAccessibleName_TXT):e.infoType===i.InfoType.Warning?(ae=S,se=Strings.OsfRuntime.L_InfobarIconWarningAccessibleName_TXT):e.infoType===i.InfoType.Information?(ae=_,se=Strings.OsfRuntime.L_InfobarIconInfoAccessibleName_TXT):(ae=b,se=Strings.OsfRuntime.L_InfobarIconSecInfoAccessibleName_TXT),ue.setAttribute(X,ae),ue.setAttribute(R,se),ie[0].cells[0].appendChild(ue);var de=document.createElement("a");de.setAttribute(X,y),de.setAttribute(W,L);var fe=document.createElement(v);fe.setAttribute(X,h),fe.innerHTML=e.title;var pe=g+e.id,me=document.getElementById(pe);null==me&&((me=document.createElement(v)).setAttribute(X,m),me.setAttribute(q,pe)),me.innerHTML=e.description,de.appendChild(fe),de.appendChild(me),ie[0].cells[1].appendChild(de);var ge=function(e){var t=re.getOsfControl(e.id);s.AppNotificationHelper.LogNotification(t._appCorrelationId,e.sqmDWords[0],e.sqmDWords[1])},he=function(){e.sqmDWords[1]|=8,ge(e),!e.reDisplay&&le(e.id,e.displayDeactive),Oe(e.id),e.reDisplay?Ee(e):Te(e.id),e.dismissCallback&&e.dismissCallback()},ve=document.createElement(G);ve.setAttribute(z,V),ve.setAttribute("src",re.getLocalizedImageFilePath(ee)),ve.setAttribute(X,p),ve.setAttribute(q,f+e.id),ve.setAttribute(W,"0"),ve.setAttribute(R,Strings.OsfRuntime.L_InfobarIconCloseButtonAccessibleName_TXT),ve.setAttribute(T,d),ve.setAttribute(H,"handleDismiss();"),i.OUtil.attachClickHandler(ve,he),ie[0].cells[2].appendChild(ve),e.detailView=u;var ye=document.createElement(d);if(ye.setAttribute(X,c),ye.innerHTML=e.buttonTxt,ye.setAttribute(q,a+e.id),ye.setAttribute(W,L),ye.setAttribute(z,d),e.buttonCallback){ye.setAttribute(H,"handleButtonClick()"),i.OUtil.attachClickHandler(ye,(function(){if(e.sqmDWords[1]|=4,ge(e),le(e.id,u),Oe(e.id),Te(e.id),e.retryAll===o){var t=re.getOsfControl(e.id);t._retryActivate=j,re.retryAll(t._marketplaceID)}e.buttonCallback()}))}else ye.setAttribute(H,"handleDismiss()"),i.OUtil.attachClickHandler(ye,he);if(ie[2].cells[1].appendChild(ye),e.url){var be=document.createElement(d);be.setAttribute(X,c),be.innerHTML=e.urlButtonTxt?e.urlButtonTxt:Strings.OsfRuntime.L_MoreInfoButton_TXT,be.setAttribute(q,r+e.id),be.setAttribute(H,"moreInfoButtonClick()"),i.OUtil.attachClickHandler(be,(function(){e.sqmDWords[1]|=4,ge(e),e.sqmDWords[1]=1,window.open(e.url)})),be.setAttribute(W,L),be.setAttribute(z,d),ie[2].cells[1].appendChild(be)}l.appendChild(te);var _e=document.createElement(J);_e.setAttribute(X,K),_e.setAttribute(q,Z+e.id),e.displayDeactive&&(_e.style.backgroundImage=B+re.getLocalizedImageFilePath($)+")",_e.style.backgroundColor=U,_e.style.opacity=L,_e.style.filter=F,_e.style.backgroundRepeat=D,_e.style.backgroundPosition=N,_e.style.height=k),_e.appendChild(l),0!=e.div.childNodes.length?e.div.insertBefore(_e,e.div.childNodes[0]):e.div.appendChild(_e),Ie(e.id,i.AgaveHostAction.TabIn),i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderStage2End)},me=function(e){i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderStage2Start);try{ce(e.div);var t=e.description;e.title.length>100&&(e.title=e.title.substring(0,99)),e.description.length>255&&(e.description=e.description.substring(0,254));var n=Y+e.id,r=document.getElementById(n);null==r&&((r=document.createElement(J)).className=M,r.id=n),r.title=t,e.iframeNotificationUrl?r.appendChild(ve(e,r)):r.appendChild(he(e));var o=document.createElement(J);o.className=K,o.id=Z+e.id,e.displayDeactive&&(o.style.backgroundImage=B+re.getLocalizedImageFilePath($)+")",o.style.backgroundColor=U,o.style.opacity=L,o.style.filter=F,o.style.backgroundRepeat=D,o.style.backgroundPosition=N,o.style.height=k),o.appendChild(r),0!=e.div.childNodes.length?e.div.insertBefore(o,e.div.childNodes[0]):e.div.appendChild(o),Ie(e.id,i.AgaveHostAction.TabIn)}catch(e){s.RuntimeTelemetryHelper.LogExceptionTag("Failed to show infobar, error message: ",e,j,23455900)}i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderStage2End)},ge=function(e){var t="moe-trust-prompt-description-id";i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderStage2Start);try{ce(e.div);var n=function(e){function t(e,t){var n=e.insertRow(-1);n.className="moe-trust-prompt-row "+t,n.setAttribute(T,E),n.insertCell(-1).className="moe-trust-prompt-cell"}e.id;var n=Q+e.id,r=document.getElementById(n);r===j&&((r=document.createElement(w)).id=n,r.className="moe-trust-prompt-table",r.setAttribute(T,E)),t(r.createTHead(),"moe-trust-prompt-header");var o=r.createTBody();return t(o,"moe-trust-prompt-preview"),t(o,"moe-trust-prompt-description"),t(r.createTFoot(),"moe-trust-prompt-footer"),r}(e),r=n.rows,a=function(e){var t=document.createElement("p");return t.innerHTML=e.notificationType===i.NotificationType.TrustPromptContent?e.name:e.title,t.className="moe-trust-prompt-header-title",t}(e);r[0].cells[0].appendChild(a);var c=function(e){var t=document.createElement(ne);return t.src=e.icon,t.className="moe-trust-prompt-preview-img",t.setAttribute(R,e.iconTitle),t}(e),u=function(e){var t=document.createElement("p");return t.innerHTML=e.name,t.className="moe-trust-prompt-preview-title",t}(e),l=function(e){var t=document.createElement("p");return t.innerHTML=e.provider,t.className="moe-trust-prompt-preview-sub",t}(e);r[1].cells[0].appendChild(c),r[1].cells[0].appendChild(u),r[1].cells[0].appendChild(l);var f=function(e){var n=document.createElement("p");return n.innerHTML=e.description,n.className="moe-trust-prompt-description-text",n.id=t,n}(e);r[2].cells[0].appendChild(f);var p=function(){var n,r=document.createElement(d);return r.textContent=e.buttonTxt,r.className="moe-trust-prompt-button moe-trust-prompt-button-primary moe-trust-prompt-buttons-action",r.id="moe-trust-prompt-buttons-action_"+e.id,r.tabIndex=0,r.type=d,r.setAttribute("aria-describedby",t),n=e.buttonCallback?function(){if(e.sqmDWords[1]|=4,_e(e),de(e),Oe(e.id),Te(e.id),e.retryAll===o){var t=re.getOsfControl(e.id);t._retryActivate=j,re.retryAll(t._marketplaceID)}e.buttonCallback()}:function(){e.sqmDWords[1]|=8,_e(e),!e.reDisplay&&de(e),Oe(e.id),e.reDisplay?Ee(e):Te(e.id),e.dismissCallback&&e.dismissCallback()},i.OUtil.attachClickHandler(r,n),r}();if(r[3].cells[0].appendChild(p),e.url!==j){var m=function(e){var t=document.createElement(d);return t.textContent=e.urlButtonTxt||Strings.OsfRuntime.L_MoreInfoButton_TXT,t.className="moe-trust-prompt-button moe-trust-prompt-buttons-url",t.id="moe-trust-prompt-buttons-url_"+e.id,t.tabIndex=0,t.type=d,i.OUtil.attachClickHandler(t,(function(){e.sqmDWords[1]|=4,_e(e),window.open(e.url)})),t}(e);r[3].cells[0].appendChild(m)}var g=function(e){var t=document.createElement(J);t.className="moe-trust-prompt-collapse cui-ctl-iconContainer cui-img-cont-float cui-img-16by16";var n=document.createElement(ne);switch(e.clientName){case"WAC_Powerpoint":n.src=re.getLocalizedImageFilePath("per.png"),n.className="per_UpChevron_16x16x32";break;case"WAC_Word":n.src=re.getLocalizedImageFilePath("we.png"),n.className="we_UpChevron_16x16x32";break;case"WAC_Excel":n.src=re.getLocalizedImageFilePath("EwaEdit.png"),n.className="ewaboot_UpChevron16"}return n.alt=Strings.OsfRuntime.L_InfobarIconCloseButtonAccessibleName_TXT,t.appendChild(n),i.OUtil.attachClickHandler(t,(function(){var t="collapsed";e.collapsed===o?e.div.classList.remove(t):e.div.classList.add(t),e.collapsed=!e.collapsed})),t}(e);0!=e.div.childNodes.length?e.div.insertBefore(n,e.div.childNodes[0]):e.div.appendChild(n),e.div.appendChild(g),e.div.style.overflowY="auto",e.div.classList.add("moe-trust-prompt"),e.div.classList.add(e.clientName),e.div.classList.add(e.notificationType===i.NotificationType.TrustPromptContent?"content-add-in":"taskpane-add-in"),Ie(e.id,i.AgaveHostAction.TabIn)}catch(e){s.RuntimeTelemetryHelper.LogExceptionTag("Failed to show trust prompt, error message: ",e,j,38592974)}i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderStage2End)},he=function(e){var t=ye(e),n=t.rows;n[0].cells[0].appendChild(be(e));var s=document.createElement("a");s.className=y,s.tabIndex=1;var l=document.createElement(v);l.className=h,l.textContent=e.title;var f=g+e.id,p=document.getElementById(f);null==p&&((p=document.createElement(v)).className=m,p.id=f),p.textContent=e.description,s.appendChild(l),s.appendChild(p),n[0].cells[1].appendChild(s);var b=function(){Se(e)},_=Ce(e);i.OUtil.attachClickHandler(_,b),n[0].cells[2].appendChild(_),e.detailView=u;var S=document.createElement(d);if(S.className=c,S.textContent=e.buttonTxt,S.id=a+e.id,S.tabIndex=1,S.type=d,e.buttonCallback){i.OUtil.attachClickHandler(S,(function(){if(e.sqmDWords[1]|=4,_e(e),le(e.id,u),Oe(e.id),Te(e.id),e.retryAll===o){var t=re.getOsfControl(e.id);t._retryActivate=j,re.retryAll(t._marketplaceID)}e.buttonCallback()}))}else i.OUtil.attachClickHandler(S,b);if(n[2].cells[1].appendChild(S),e.url){var C=document.createElement(d);C.className=c,C.textContent=e.urlButtonTxt?e.urlButtonTxt:Strings.OsfRuntime.L_MoreInfoButton_TXT,C.id=r+e.id,i.OUtil.attachClickHandler(C,(function(){e.sqmDWords[1]|=4,_e(e),e.sqmDWords[1]=1,window.open(e.url)})),C.tabIndex=1,C.type=d,n[2].cells[1].appendChild(C)}return t},ve=function(e,t){var n="message",r=ye(e),a=r.rows,c=document.createElement("iframe");window.getComputedStyle(e.div,j);c.width=k,c.frameBorder="0",c.className=ie,c.src=e.iframeNotificationUrl,a[0].cells[1].appendChild(c);var l="moe-hovered";t.addEventListener("mouseenter",(function(){i.OUtil.addClass(t,l),c.contentWindow.postMessage(i.AgaveHostAction.MouseEnter,oe)})),t.addEventListener("mouseleave",(function(){i.OUtil.removeClass(t,l),c.contentWindow.postMessage(i.AgaveHostAction.MouseLeave,oe)})),e.detailView=u;var d=j,f=Ce(e);return i.OUtil.attachClickHandler(f,(function(){Se(e),window.removeEventListener(n,d)})),a[0].cells[2].appendChild(f),f.addEventListener("keydown",(function(e){9==e.keyCode&&e.shiftKey&&(e.preventDefault(),e.stopPropagation(),c.contentWindow.postMessage(i.AgaveHostAction.TabInShift,oe))})),e.buttonCallback&&(d=function(t){try{if(t.source==c.contentWindow){var r=JSON.parse(t.data),a=parseInt(r[i.OmexMessageKeys.MessageType]),l=parseInt(r[i.OmexMessageKeys.MessageValue]);if(a==i.OmexMessageType.ConsentResult){if(le(e.id,u),Oe(e.id),Te(e.id),e.retryAll===o&&(e.notificationType==i.NotificationType.TrustYellowBar||e.notificationType==i.NotificationType.ConsentYellowBar&&l==i.ConsentResultCode.Success)){var p=re.getOsfControl(e.id);p._retryActivate=j,re.retryAll(p._marketplaceID)}window.removeEventListener(n,d),e.buttonCallback(l)}else a==i.OmexMessageType.TabExit&&(l==i.AgaveHostAction.TabExitShift&&re._notifyHost?re._notifyHost(e.id,i.AgaveHostAction.TabExitShift):l==i.AgaveHostAction.TabExit&&(window.focus(),f.focus()))}}catch(e){s.RuntimeTelemetryHelper.LogExceptionTag("Exception in receivedMessageHandler: ",e,j,23455901)}},window.addEventListener(n,d)),r},ye=function(e){var t=document.createElement(w);t.className=P,t.setAttribute(T,E);for(var n=e.iframeNotificationUrl?1:3,r=0;r<n;r++){t.insertRow(r).setAttribute(T,E)}var o=t.rows;return o[0].insertCell(0),o[0].insertCell(1),o[0].insertCell(2),o[0].cells[1].setAttribute("rowSpan","2"),o[0].cells[0].setAttribute(X,x),o[0].cells[1].setAttribute(X,I),o[0].cells[2].setAttribute(X,A),e.iframeNotificationUrl==j&&(o[1].insertCell(0),o[1].insertCell(1),o[2].insertCell(0),o[2].insertCell(1),o[2].insertCell(2),o[2].cells[1].setAttribute(X,O)),o[0].cells[0].appendChild(be(e)),t},be=function(e){var t,n,r=document.createElement(ne);return r.src=re.getLocalizedImageFilePath(ee),e.infoType===i.InfoType.Error?(t=C,n=Strings.OsfRuntime.L_InfobarIconErrorAccessibleName_TXT):e.infoType===i.InfoType.Warning?(t=S,n=Strings.OsfRuntime.L_InfobarIconWarningAccessibleName_TXT):e.infoType===i.InfoType.Information?(t=_,n=Strings.OsfRuntime.L_InfobarIconInfoAccessibleName_TXT):(t=b,n=Strings.OsfRuntime.L_InfobarIconSecInfoAccessibleName_TXT),r.className=t,r.alt=n,r},_e=function(e){var t=re.getOsfControl(e.id);s.AppNotificationHelper.LogNotification(t._appCorrelationId,e.sqmDWords[0],e.sqmDWords[1])},Se=function(e){e.sqmDWords[1]|=8,_e(e),!e.reDisplay&&le(e.id,e.displayDeactive),Oe(e.id),e.reDisplay?Ee(e):Te(e.id),e.dismissCallback&&e.dismissCallback()},Ce=function(e){var t=document.createElement(G);return t.type=V,t.src=re.getLocalizedImageFilePath(ee),t.className=p,t.id=f+e.id,t.tabIndex=0,t.alt=Strings.OsfRuntime.L_InfobarIconCloseButtonAccessibleName_TXT,t.setAttribute(T,d),t},Oe=function(e){var t=re.getOsfControl(e);t&&(t._controlFocus=o)},Ae=function(e){var t=re.getOsfControl(e);if(t&&!Pe(e))if(t.getStatus()===i.OsfControlStatus.Activated&&t.getPageStatus()===i.OsfControlPageStatus.Ready)t.notifyAgave(i.AgaveHostAction.TabIn);else{var n="_trySetFocusInAppContent$newCallback";if(t._notifyHostIFrameOnLoaded&&t._notifyHostIFrameOnLoaded.newCallbackIdentity&&t._notifyHostIFrameOnLoaded.newCallbackIdentity===n)return;var r=function(e){return function(){if(e)try{e()}catch(e){}t.getStatus()===i.OsfControlStatus.Activated&&t.getPageStatus()===i.OsfControlPageStatus.Ready&&t.notifyAgave(i.AgaveHostAction.TabIn),t._notifyHostIFrameOnLoaded=e}}(t._notifyHostIFrameOnLoaded);r.newCallbackIdentity=n,t._notifyHostIFrameOnLoaded=r}},Ie=function(e,t){var r=re.getOsfControl(e);if(r&&r._controlFocus)if(Pe(e)){var o=ae[e][0];if(o&&o.div)if(o.iframeNotificationUrl!=j){var a=o.div.getElementsByClassName(ie)[0];a&&(a.contentWindow.postMessage(i.AgaveHostAction.TabIn,oe),re._notifyHost&&re._notifyHost(e,i.AgaveHostAction.SelectWithError))}else{var s=o.div.querySelectorAll(n);if(s&&s.length>0){var c=s[0];c instanceof HTMLElement&&(window.focus(),c.focus(),re._notifyHost&&re._notifyHost(e,i.AgaveHostAction.SelectWithError))}}}else r.notifyAgave(t)},xe=function(e,t){var r=re.getOsfControl(e);if(r&&r._controlFocus)if(Pe(e)){var o=ae[e][0];if(o&&o.div){var a=o.div.querySelectorAll(n);if(a&&a.length>0){var s=a.length>1?a[1]:a[0];s instanceof HTMLElement&&(window.focus(),s.focus(),re._notifyHost&&re._notifyHost(e,i.AgaveHostAction.SelectWithError))}}}else r._controlFocus=u,re._notifyHost(e,t)},Ee=function(e){if(e.notificationType!==i.NotificationType.TrustPromptContent&&e.notificationType!==i.NotificationType.TrustPromptTaskpane)if(null==e.detailView||e.detailView===u)e.sqmDWords[1]=0,fe(e);else{e.sqmDWords[1]=1;var t=l.HostFeatureEnabledInfo.getHostFeatureEnabledInfo();t&&t.enableSingleSignOnForAddin?me(e):pe(e)}else ge(e)},Te=function(e){if(Pe(e)){var t=ae[e][0];Ee(t)}else Ae(e)},Pe=function(e){return ae[e]&&ae[e].length>0};return{showProgress:function(e,n){try{if(i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderLoadingAnimationStart),!document.getElementById(t+n)){ae[n]=[];var r=document.createElement(J);r.setAttribute(X,K),r.setAttribute(q,t+n),r.style.backgroundColor="rgba(255, 255, 255, 0.5)",r.style.opacity=L,r.style.filter=F,r.style.height=k;var o=document.createElement(J);o.style.width=k,o.style.height=k,o.style.backgroundImage=B+re.getLocalizedImageFilePath(te)+")",o.style.backgroundRepeat=D,o.style.backgroundPosition=N,r.appendChild(o),e.appendChild(r)}i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderLoadingAnimationEnd)}catch(e){}},showNotification:function(e){e.sqmDWords=[e.errorCode,0],delete e.errorCode,null==e.highPriority&&(e.highPriority=e.infoType===i.InfoType.Error?o:u),null==e.reDisplay&&(e.reDisplay=e.infoType===i.InfoType.Error?o:u);var t=ae[e.id];void 0===t&&(t=[],ae[e.id]=t),e.highPriority===u?t.push(e):(t.splice(se,0,e),se++),(1===ae[e.id].length||e.highPriority)&&Ee(t[0])},showICon:function(e){fe(e)},removeDOMElement:function(e){ue(e)},removeProgressDiv:function(e,n){i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RemoveLoadingAnimationStart),e.ownerDocument.getElementById(t+n)&&ce(e),i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RemoveLoadingAnimationEnd)},removeIConDiv:function(e){!function(e){i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RemoveStage1Start),ue("icon_"+e),i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RemoveStage1End)}(e)},removeInfoBarDiv:function(e,t){le(e,t)},dismissMessages:function(e){!function(e){if(ae[e]){if(ae[e].length>0){var t=ae[e][0].div;ce(t)}delete ae[e]}}(e)},getHTMLEncodedString:function(e){return function(e){var t=document.createElement(J),n=document.createTextNode(e);return t.appendChild(n),t.innerHTML}(e)},purgeOsfControlNotification:function(e){var t=ae[e],n=re.getOsfControl(e);t&&t.length>0&&n&&s.AppNotificationHelper.LogNotification(e,t[0].sqmDWords[0],t[0].sqmDWords[1])},focusOnNotificationUx:function(e,t){Oe(e),Ie(e,t)},focusOnNotificationUxShiftIn:function(e,t){Oe(e),xe(e,t)},appHasNotifications:function(e){return Pe(e)}}},function(e){var t=function(){function t(){}return t.validateTokenValueForExtendedOverridesUrl=function(t){if(!new RegExp("^[A-Za-z0-9-.]{1,20}$").test(t))throw new Error(e.MsAjaxString.format("The token {0} isn't valid",t));return t},t.constructExtendedOverridesUrl=function(e,n){var r=t.validateTokenValueForExtendedOverridesUrl(n.platform),o=t.validateTokenValueForExtendedOverridesUrl(n.host),i=t.validateTokenValueForExtendedOverridesUrl(n.locale);return e=(e=(e=e.replace("{platform}",r)).replace("{host}",o)).replace("{locale}",i)},t}();e.ExtendedManifestUtility=t}(l||(l={})),function(e){var t=function(){function e(){}return e.setHostFeatureEnabledInfo=function(e){this._hostFeatureEnabledInfo=e},e.getHostFeatureEnabledInfo=function(){return this._hostFeatureEnabledInfo},e}();e.HostFeatureEnabledInfo=t}(l||(l={})),function(e){var t="OSFCache",n=function(){function e(){}return e.prototype.get=function(e){return this.openTransaction(t).then((function(n){return new Promise((function(r,o){var i=n.objectStore(t).get(e);i.onsuccess=function(e){var t=e.target.result;r(t)},i.onerror=function(e){o(e)}}))}))},e.prototype.set=function(e,n){return this.openTransaction(t).then((function(r){return new Promise((function(o,i){var a=r.objectStore(t).put(n,e);a.onsuccess=function(){o()},a.onerror=function(e){i(e)}}))}))},e.prototype.openDB=function(e){var t=window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB||window.indexedDB;return new Promise((function(n,r){var o=t.open(e);o.onupgradeneeded=function(){var t=o.result;!t.objectStoreNames.contains(e)&&t.createObjectStore(e)},o.onsuccess=function(){var e=o.result;n(e)},o.onerror=function(e){r(e)}}))},e.prototype.openTransaction=function(e){return this.openDB(e).then((function(t){return t.transaction(e,"readwrite")}))},e}(),r=function(){function e(){}return e.prototype.get=function(e){var n=localStorage.getItem(t.concat("_",e));return Promise.resolve(n)},e.prototype.set=function(e,n){return localStorage.setItem(t.concat("_",e),n),Promise.resolve()},e}(),o=function(){var e=null,t="The browser does not support Web Storage";function o(){this.indexedDB=window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB||window.indexedDB}return o.get=function(n){var r=this.getOrCreateOsfCache();return r?r.get(n):(s.RuntimeTelemetryHelper.LogCommonMessageTag(t,e,0),Promise.resolve(e))},o.set=function(n,r){var o=this.getOrCreateOsfCache();return o?o.set(n,r):(s.RuntimeTelemetryHelper.LogCommonMessageTag(t,e,0),Promise.resolve(e))},o.getOrCreateOsfCache=function(){var t="undefined";return o.instance==e&&(typeof indexedDB!=t?o.instance=new n:typeof localStorage!=t&&(o.instance=new r)),o.instance},o}();e.OsfCache=o}(l||(l={})),i.OUtil.setNamespace("AppSpecificSetup",i),i.ContextActivationManager=function(e){var t="0",n="osfControl for the given ID doesn't exist.",r=null,a=!0,c=!1,u=this;if(i.OUtil.validateParamObject(e,{appName:{type:Number,mayBeNull:c},appVersion:{type:String,mayBeNull:c},clientMode:{type:Number,mayBeNull:c},appUILocale:{type:String,mayBeNull:c},dataLocale:{type:String,mayBeNull:c},osfOmexBaseUrl:{type:String,mayBeNull:a},devCatalogUrl:{type:String,mayBeNull:a},oneDriveCatalogBaseApiUrl:{type:String,mayBeNull:a},sdxCdnUrl:{type:String,mayBeNull:a},sdxDmsUrl:{type:String,mayBeNull:a},spBaseUrl:{type:String,mayBeNull:a},docUrl:{type:String,mayBeNull:a},hostControl:{type:Object,mayBeNull:a},pageBaseUrl:{type:String,mayBeNull:a},lcid:{type:String,mayBeNull:a},formFactor:{type:String,mayBeNull:a},controlStatusChanged:{type:Object,mayBeNull:a},notifyHost:{type:Object,mayBeNull:a},allowExternalMarketplace:{type:Boolean,mayBeNull:a},localizedScriptsUrl:{type:String,mayBeNull:a},localizedImagesUrl:{type:String,mayBeNull:a},localizedStylesUrl:{type:String,mayBeNull:a},localizedResourcesUrl:{type:String,mayBeNull:a},trustAgaves:{type:Boolean,mayBeNull:a},enableAddinCommands:{type:Boolean,mayBeNull:a},enableBlackForestRedirect:{type:Boolean,mayBeNull:a},enableMyOrg:{type:Boolean,mayBeNull:a},enableMyApps:{type:Boolean,mayBeNull:a},enableDevCatalog:{type:Boolean,mayBeNull:a},enableOneDriveCatalog:{type:Boolean,mayBeNull:a},enablePrivateCatalog:{type:Boolean,mayBeNull:a},enableTaskpaneUpgradeToAppCommand:{type:Boolean,mayBeNull:a},enableUploadFileDevCatalog:{type:Boolean,mayBeNull:a},enableV1RedirectApis:{type:Boolean,mayBeNull:a},omexForceAnonymous:{type:Boolean,mayBeNull:a},userNameHashCode:{type:Number,mayBeNull:a},hostFullVersion:{type:String,mayBeNull:a},envCode:{type:String,mayBeNull:a},showSignOutFromPrivateCatalogMessage:{type:Boolean,mayBeNull:a},enableSingleSignOnForAddin:{type:Boolean,mayBeNull:a},firstPartySingleSignOnWhitelist:{type:String,mayBeNull:a},enableServiceDeliveredExperience:{type:Boolean,mayBeNull:a},hideAppsExtensionUrl:{type:String,mayBeNull:a},enableInsertDialogAccessibilityFix:{type:Boolean,mayBeNull:a},disableLogging:{type:Boolean,mayBeNull:a},enableDisplayBlockedMinorError:{type:Boolean,mayBeNull:a},enableFirstPartySSO:{type:Boolean,mayBeNull:a},disableAppsForOfficeThirdParty:{type:Boolean,mayBeNull:a},wacSessionId:{type:String,mayBeNull:a},enableFirstPartySDXErrorMessages:{type:Boolean,mayBeNull:a},isHostDocumentDomain:{type:Boolean,mayBeNull:a},enableRichApiCellEditDelay:{type:Boolean,mayBeNull:a},wopiHostOriginFromPostMessage:{type:String,mayBeNull:a},wopiHostOriginFromWacPropBag:{type:String,mayBeNull:a},"wacIsEmbedded ":{type:Boolean,mayBeNull:a},"accessibilityAllowFocusAddinTaskpane ":{type:Boolean,mayBeNull:a},disableMicrophonePermission:{type:Boolean,mayBeNull:a},agaveAddinUploadEnabled:{type:Boolean,mayBeNull:a},addinEnforceHttpsIsEnabled:{type:Boolean,mayBeNull:a},featureGateFlag:{type:Number,mayBeNull:a},isReactRibbonEnabled:{type:Boolean,mayBeNull:a}},r),u._osfOmexBaseUrl=e.osfOmexBaseUrl,u._devCatalogUrl=e.devCatalogUrl,u._sdxCdnUrl=e.sdxCdnUrl,u._sdxDmsUrl=e.sdxDmsUrl,u._firstPartyManifestCDNUrl=e.firstPartyManifestCDNUrl,u._oneDriveCatalogBaseApiUrl=e.oneDriveCatalogBaseApiUrl,u._spBaseUrl=e.spBaseUrl,u._myOrgCatalogUrl=r,u._enableAddinCommands=e.enableAddinCommands||c,u._enableBlackForestRedirect=e.enableBlackForestRedirect||c,u._enableInsertDialogAccessibilityFix=e.enableInsertDialogAccessibilityFix||c,u._enableFirstPartySDXErrorMessages=e.enableFirstPartySDXErrorMessages||c,u._enableMyOrg=e.enableMyOrg||c,u._enableMyApps=e.enableMyApps||c,u._enableDevCatalog=e.enableDevCatalog||c,u._enableOneDriveCatalog=e.enableOneDriveCatalog||c,u._enablePrivateCatalog=e.enablePrivateCatalog||c,u._showSignOutFromPrivateCatalogMessage=e.showSignOutFromPrivateCatalogMessage||c,u._enableTaskpaneUpgradeToAppCommand=e.enableTaskpaneUpgradeToAppCommand||c,u._enableUploadFileDevCatalog=e.enableUploadFileDevCatalog||c,u._enableV1RedirectApis=e.enableV1RedirectApis||c,u._appName=e.appName,u._appVersion=e.appVersion,u._clientMode=e.clientMode,u._appUILocale=e.appUILocale,u._dataLocale=e.dataLocale,u._docUrl=e.docUrl,u._hostControl=e.hostControl,u._formFactor=e.formFactor||i.FormFactor.Default,u._pageBaseUrl=e.pageBaseUrl,u._lcid=e.lcid,u._controlStatusChanged=e.controlStatusChanged,u._notifyHost=e.notifyHost||function(){},u._allowExternalMarketplace=e.allowExternalMarketplace,u._localizedScriptsUrl=e.localizedScriptsUrl,u._localizedImagesUrl=e.localizedImagesUrl,u._localizedStylesUrl=e.localizedStylesUrl,u._localizedResourcesUrl=e.localizedResourcesUrl,u._autoTrusted=e.trustAgaves,u._omexForceAnonymous=e.omexForceAnonymous||c,u._userNameHashCode=e.userNameHashCode||0,u._hostFullVersion=e.hostFullVersion,u._wacHostEnvironment=e.envCode,u._enableSingleSignOnForAddin=e.enableSingleSignOnForAddin||c,u._enableFirstPartySSO=e.enableFirstPartySSO||c,u._enableServiceDeliveredExperience=e.enableServiceDeliveredExperience||a,u._hideAppsExtensionUrl=u._osfOmexBaseUrl+e.hideAppsExtensionUrl,u._disableLogging=e.disableLogging||c,u._enableDisplayBlockedMinorError=e.enableDisplayBlockedMinorError||c,u._disableAppsForOfficeThirdParty=e.disableAppsForOfficeThirdParty||c,u._isHostDocumentDomain=e.isHostDocumentDomain||c,u._enableRichApiCellEditDelay=e.enableRichApiCellEditDelay||c,u._loggableUserId=e.loggableUserId,u._sessionStartInfoJson=e.sessionStartInfoJson,u._firstPartySingleSignOnWhitelist=e.firstPartySingleSignOnWhitelist,u._wopiHostOriginFromPostMessage=e.wopiHostOriginFromPostMessage,u._wopiHostOriginFromWacPropBag=e.wopiHostOriginFromWacPropBag,u._wacIsEmbedded=e.wacIsEmbedded,u._enableWopiHostCheck=e.isHostFrameTrustCheckEnabledForAddIns||c,u._enableUpnCheck=e.isUpnCheckEnabled||c,u._wacUpn=e.wacUpn,u._accessibilityAllowFocusAddinTaskpane=e.accessibilityAllowFocusAddinTaskpane,u._disableMicrophonePermission=e.disableMicrophonePermission||c,u._oAuthManager=r,u._agaveAddinUploadEnabled=e.agaveAddinUploadEnabled||c,u._isHostFrameTrusted=e.isHostFrameTrusted||i.HostFrameTrustState.NotImplemented,u._hostFeatureGateFlag=e.hostFeatureGateFlag||i.HostFeatureGateFlags.None,u._isReactRibbonEnabled=e.isReactRibbonEnabled||c,u._enableSetAppContextInIframeName=u._hostFeatureGateFlag&i.HostFeatureGateFlags.EnableSetAppContextInIFrameName,u._enable3rdPartySetAppContextInIframeName=u._hostFeatureGateFlag&i.HostFeatureGateFlags.Enable3rdPartySetAppContextInIFrameName,u._enableExperimentationSdxNewBundle=e.enableExperimentationSdxNewBundle,u._appSettings=e.appSettings||{},u._flightingTreatmentVariables=e.flightingTreatmentVariables||{},u._hostAllowedSdxEmbedding=e.hostAllowedSdxEmbedding||a,u._enableWopiHostCheck||(u._hostAllowedSdxEmbedding=a),l.HostFeatureEnabledInfo.setHostFeatureEnabledInfo(e),u._pageBaseUrl&&"/"!==u._pageBaseUrl.charAt(u._pageBaseUrl.length-1)&&(u._pageBaseUrl=u._pageBaseUrl+"/"),u._localizedResourcesUrl&&"/"!==u._localizedResourcesUrl.charAt(u._localizedResourcesUrl.length-1)&&(u._localizedResourcesUrl=u._localizedResourcesUrl+"/"),u._clientId=i.OUtil.getUniqueId(),u._cachedOsfControls={},u._iframeAttributeBag={},u._serviceEndPoint=r,u._serviceEndPointInternal=r,u._internalConversationId=r,u._iframeProxies={},u._iframeProxyCount=0,u._iframeNamePrefix="__officeExtensionProxy",u._webUrl=r,u._wsa=r,u._insertDialogDiv=r,u._hasPreloadedOfficeJs=c,u._contextMgrCorrelationId=e.wacSessionId||i.OUtil.Guid.generateNewGuid(),s.RuntimeTelemetryHelper.LogCommonMessageTag("_contextMgrCorrelationId :"+u._contextMgrCorrelationId,r,20194265),s.RuntimeTelemetryHelper.LogCommonMessageTag("ContextActivationManager Constructor isHostFrameTrusted param:"+e.isHostFrameTrusted,u._contextMgrCorrelationId,591697925),u._hostType=r,u._hostPlatform=r,u._hostSpecificFileVersion=r,u._requirementsChecker=new i.RequirementsChecker,u._onClickInstallOsfControl=r,u._osfOmexBaseUrl){var d,f=u._osfOmexBaseUrl.indexOf(i.Constants.ProtocolSeparator);d=f>=0?u._osfOmexBaseUrl.substr(f):i.Constants.ProtocolSeparator+u._osfOmexBaseUrl;var p=i.Constants.Https+d,m=i.Constants.Https+d;i.OUtil.getQueryStringParamValue(window.location.search,i.Constants.OmexForceAnonymousParamName).toLowerCase()==i.Constants.OmexForceAnonymousParamValue.toLowerCase()?(u._omexAuthNStatus=i.OmexAuthNStatus.Anonymous,u._omexForceAnonymous=a):u._omexAuthNStatus=i.OmexAuthNStatus.NotAttempted,u._omexGatedWSProxy={proxyUrl:p+i.Constants.OmexGatedServiceExtension,proxyName:"__omexExtensionGatedProxy",isReady:c,clientEndPoint:r,pendingCallbacks:[]},u._omexWSProxy={proxyUrl:m+i.Constants.OmexUnGatedServiceExtension,proxyName:"__omexExtensionProxy",isReady:c,clientEndPoint:r,pendingCallbacks:[]},u._omexAnonymousWSProxy={proxyUrl:p+i.Constants.OmexAnonymousServiceExtension,proxyName:"__omexExtensionAnonymousProxy",isReady:c,clientEndPoint:r,pendingCallbacks:[]},u._omexBillingMarket=r,u._omexEndPointBaseUrl=m}e.addinEnforceHttpsIsEnabled&&i.OUtil.pushFlight(i.FlightNames.AddinEnforceHttps),e.appSettings&&"true"===e.appSettings.AddinCheckReceiverOriginIsEnabled&&i.OUtil.pushFlight(i.FlightNames.CheckReceiverOrigin),u._isFromWacAutomation=function(){if(void 0!==this._isFromWacAutomation&&this._isFromWacAutomation!==r)return this._isFromWacAutomation;try{for(var e=window,t=void 0;e!==t;){if(!e.location||!e.location.search)return c;if(e.location.search.toLowerCase().indexOf("automation=1")>=0)return a;t=e,e=e.parent}}catch(e){return c}return c}(),i.OsfManifestManager._setUILocale(u._appUILocale);var g=u;if(g.getContextForEmbeddingPage=function(){var e=0;if(g._hostSpecificFileVersion&&-1!=g._hostSpecificFileVersion.indexOf(".")){var t=g._hostSpecificFileVersion.split("."),n=t[1];isNaN(n)||(e=parseInt(t[1]))}var r=g._requirementsChecker._getSupportedSet();return{appName:g._appName,appVersion:g._appVersion,appUILocal:g._appUILocale,dataLocale:g._dataLocale,docUrl:g._docUrl||window.location.href,clientMode:g._clientMode,minorVersion:e,requirements:r}},u._enableServiceDeliveredExperience)var h=function(e){var t=e&&e.contextId?g.getOsfControl(e.contextId):r;switch(e.id){case i.MessageIDs.FetchBundleUrl:if(!t._agaveEndPoint){var n=t._conversationId+i.SharedConstants.NotificationConversationIdSuffix;t._agaveEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(n,t._frame.contentWindow,t._iframeUrl)}if(t._bundleUrl){var a={id:i.MessageIDs.LoadReactBundle,bundleUrl:t._bundleUrl};t.sendMessageToSdx(a)}break;case i.MessageIDs.LoadBundleSuccess:t._pageStatus=i.OsfControlPageStatus.Ready,t._contextActivationMgr._ErrorUXHelper&&t._contextActivationMgr._ErrorUXHelper.removeProgressDiv(t._div,t._id);break;case i.MessageIDs.LoadBundleError:break;default:o.msAjaxDebug.trace("MessageID: "+e.id+" onMessageFromSdx got wrong message.")}};var v=function(e){if(e.strUrl){var t=i.OUtil.parseUrl(e.strUrl);if(t&&("http:"==t.protocol||"https:"==t.protocol))return void window.open(e.strUrl,e.strWindowName,e.strWindowFeatures)}s.RuntimeTelemetryHelper.LogCommonMessageTag("Silent fail for window.open.",this._contextMgrCorrelationId,592570305)},y=function(e,t){e.hasOwnProperty("fromInsertDialog")&&!e.fromInsertDialog||g._insertDialogDiv!=r&&2==g._insertDialogDiv.childNodes.length&&g._insertDialogDiv.removeChild(g._insertDialogDiv.lastChild);var n,a=i.OUtil.Guid.generateNewGuid(),s=new l.InsertDialogTelemetryContext(a);e.storeType==i.StoreTypeEnum.MarketPlace?n={storeType:i.StoreType.OMEX,storeLocator:g._osfOmexBaseUrl}:e.storeType==i.StoreTypeEnum.Catalog?n={storeType:i.StoreType.SPCatalog,storeLocator:g._myOrgCatalogUrl}:e.storeType==i.StoreTypeEnum.OneDrive&&(n={storeType:i.StoreType.OneDrive,storeLocator:g._oneDriveCatalogBaseApiUrl});var u=e.refresh,d={assetId:"",contentMarket:"",anonymous:c,clientEndPoint:r,clearCache:u,clearKilledApps:c,referenceInUse:n,hostType:g._hostType};if(e&&e.storeType==i.StoreTypeEnum.MarketPlace){d.clientVersion=g._getClientVersionForOmex(),d.clientVersion&&(d.clientName=g._getClientNameForOmex(),d.appVersion=g._getAppVersionForOmex());(p=l.CatalogFactory.resolve(i.StoreType.OMEX)).getEntitlementAsync(c,s,Function.createDelegate(g,(function(e){if(e.status==l.DataServiceResultCode.Succeeded&&e.value){for(var n,o=e.value,a=o.length,c={},d=[],f=0;f<a;f++)c[(n=o[f]).contentMarket]?c[n.contentMarket].push(n.assetId):c[n.contentMarket]=[n.assetId];u&&I(o),0===a&&t({errorCode:i.InvokeResultCode.S_OK});var m=0,h=function(e,n){if(e.status==l.DataServiceResultCode.Succeeded&&e.value&&e.value.length&&e.value.length>0)for(var r=e.value,o=g.getRequirementsChecker(),s=0;s<r.length;s++){if(o.isEntitlementFromOmexSupported(r[s])){var c=[];c.push(r[s].name),c.push(r[s].assetId),c.push(r[s].description),c.push(i.OUtil.getTargetType(r[s].appSubType)),c.push(i.OUtil.normalizeAppVersion(r[s].version)),c.push(r[s].assetId),c.push(i.StoreType.OMEX),c.push(parseInt(r[s].defaultWidth)),c.push(parseInt(r[s].defaultHeight)),c.push(r[s].iconUrl),c.push(r[s].provider),c.push(n),c.push(i.StoreType.OMEX),c.push(r[s].webApplicationId),d.push(c)}m++}if(m===a){var u={value:d,errorCode:i.InvokeResultCode.S_OK};t(u)}},v=function(e,t){p.getAppDetails(e,t,s,(function(e){Function.createDelegate(g,h)(e,t)}),u)};for(var y in c)v(c[y],y)}else{var b={value:r,errorCode:i.InvokeResultCode.E_USER_NOT_SIGNED_IN};t(b)}})),u)}else if(e&&e.storeType==i.StoreTypeEnum.Catalog){var f=l.CatalogFactory.resolve(i.StoreType.SPCatalog);f.myOrgCatalogUrl=g._myOrgCatalogUrl;f.getEntitlementAsync(c,s,Function.createDelegate(g,(function(e){var o;if(i.OUtil.writeProfilerMark(i.OsfOfficeExtensionManagerPerfMarker.GetEntitlementEnd),e.status==l.DataServiceResultCode.Succeeded&&e.value){for(var a,s=e.value,c=s.length,u=[],d=0,f=g.getRequirementsChecker(),p=0;p<c;p++)if(a=s[p],f.isEntitlementFromCorpCatalogSupported(a)){var m=[];m.push(a.Title),m.push(a.OfficeExtensionID),m.push(a.OfficeExtensionDescription),m.push(i.OfficeAppType[a.OEType]),m.push(i.OUtil.normalizeAppVersion(a.OfficeExtensionVersion)),m.push(a.OfficeExtensionID),m.push(i.StoreType.SPCatalog),m.push(parseInt(a.OfficeExtensionDefaultWidth.toString())),m.push(parseInt(a.OfficeExtensionDefaultHeight.toString())),m.push(a.OfficeExtensionIcon),m.push(a.OEProviderName),m.push(n.storeLocator),m.push(i.StoreType.SPCatalog),u.push(m),d++}o=d>0?{value:u,errorCode:i.InvokeResultCode.S_OK}:{value:r,errorCode:i.InvokeResultCode.E_CATALOG_NO_APPS}}else o=n.storeLocator?{value:r,errorCode:i.InvokeResultCode.E_GENERIC_ERROR}:{value:r,errorCode:i.InvokeResultCode.E_CATALOG_NO_APPS};t(o)})),u)}else if(e&&e.storeType==i.StoreTypeEnum.OneDrive){i.OsfManifestManager.getOneDriveEntitlementsAsync(d,(function(e){var n;e.statusCode===i.ProxyCallStatusCode.Succeeded&&e.value&&(n={value:e.value.entitlements,errorCode:i.InvokeResultCode.S_OK},t(n))}))}else if(e&&e.storeType==i.StoreTypeEnum.PrivateCatalog){var p;(p=l.CatalogFactory.resolve(i.StoreType.PrivateCatalog)).getEntitlementAsync(c,s,Function.createDelegate(g,(function(e){if(e.status!=l.DataServiceResultCode.Unauthenticated)if(e.status===l.DataServiceResultCode.Succeeded&&e.value){var n=e.value;if(0!==n.length){var o;o=n.map((function(e){return{ProductId:e.assetId,AddInState:e.addInState,Version:e.appVersion}}));var a=[];p.getAppDetails(o,"",s,Function.createDelegate(g,(function(e){if(e.status===l.DataServiceResultCode.Succeeded&&e.value&&e.value.length&&0!==e.value.length){for(var n=e.value,o=g.getRequirementsChecker(),s=0;s<n.length;s++)if(o.isEntitlementFromOmexSupported(n[s])){var c=[];c.push(n[s].name),c.push(n[s].assetId),c.push(n[s].description),c.push(i.OUtil.getTargetType(n[s].appSubType)),c.push(i.OUtil.normalizeAppVersion(n[s].version)),c.push(n[s].assetId),c.push(i.StoreType.PrivateCatalog),c.push(parseInt(n[s].defaultWidth)),c.push(parseInt(n[s].defaultHeight)),c.push(n[s].iconUrl),c.push(n[s].provider),c.push(i.StoreType.PrivateCatalog),c.push(i.StoreType.PrivateCatalog),a.push(c)}t({value:a,errorCode:i.InvokeResultCode.S_OK})}else t({value:r,errorCode:i.InvokeResultCode.E_CATALOG_REQUEST_FAILED})})),u)}else t({errorCode:i.InvokeResultCode.E_CATALOG_NO_APPS})}else t({value:r,errorCode:i.InvokeResultCode.E_CATALOG_REQUEST_FAILED});else t({value:r,errorCode:i.InvokeResultCode.E_USER_NOT_SIGNED_IN})})),u)}else o.msAjaxDebug.trace("Unknown store type.")};u._onClickInstallOsfControl=function(e){if(g._enableUploadFileDevCatalog){o.msAjaxDebug.trace("onClickInstallOsfControl!");try{i.OUtil.validateParamObject(e,{manifest:{type:String,mayBeNull:c}},r);var n=new i.Manifest.Manifest(e.manifest,g.getAppUILocale()),u=n.getMarketplaceID(),d=n.getMarketplaceVersion();if(l.CatalogFactory.resolve(i.StoreType.UploadFileDevCatalog).validateAndCacheNewManifest(u,d,e.manifest,n)){var f={id:u,targetType:n.getTarget(),appVersion:d,currentStoreType:i.StoreType.UploadFileDevCatalog,storeId:"developer",assetId:u,assetStoreId:i.StoreType.UploadFileDevCatalog,width:parseInt(n.getDefaultWidth()||t),height:parseInt(n.getDefaultHeight()||t),isAddinCommands:n._isAddinCommandsManifest(i.getManifestHostType(g._hostType))};i.OUtil.validateParamObject(f,{id:{type:String,mayBeNull:c},targetType:{type:Number,mayBeNull:c},appVersion:{type:String,mayBeNull:c},width:{type:Number,mayBeNull:a},height:{type:Number,mayBeNull:a}},r),s.UploadFileDevCatalogUsageHelper.LogUploadFileDevCatalogUsageAction(this._appCorrelationId,f.currentStoreType,f.assetId,f.appVersion,f.targetType,f.isAddinCommands,f.width,f.height),g._notifyHost(t,i.AgaveHostAction.InsertAgave,f)}else g._notifyHost(t,i.AgaveHostAction.NotifyHostError,r)}catch(e){var p="Invalid manifest from addincommands dev catalog.";return l.WACUtils.logExceptionToBrowserConsole(p,e),s.RuntimeTelemetryHelper.LogExceptionTag(p,e,this._appCorrelationId,19203548),void g._notifyHost(t,i.AgaveHostAction.NotifyHostError,r)}}};var b=function(e){o.msAjaxDebug.trace("onClickRefreshfAddinCommands!"),g._notifyHost(t,i.AgaveHostAction.RefreshAddinCommands,e)},_=function(e){var t=i.OUtil.Guid.generateNewGuid(),n=new l.InsertDialogTelemetryContext(t),o=l.CatalogFactory.resolve(i.StoreType.OMEX),a=new l.PreCacher(g.getRequirementsChecker()),s={assetId:e.assetId,storeType:i.StoreType.OMEX,storeId:e.storeId,appVersion:"",targetType:r};o.activateAsync(s,a,n)},S=function(e,t){if(g._enableSingleSignOnForAddin&&e.webApplicationId)O(e,t);else{var n={assetId:e.id,clientVersion:g._getClientVersionForOmex(),clientName:g._getClientNameForOmex(),clientEndPoint:g._omexGatedWSProxy.clientEndPoint},r=g._insertDialogDiv,o={errorCode:i.InvokeResultCode.E_OEM_REMOVED_FAILED,forceRefreshEntitlements:c},u=i.OUtil.Guid.generateNewGuid(),d=new l.InsertDialogTelemetryContext(u);l.CatalogFactory.resolve(i.StoreType.OMEX).removeAsync([n.assetId],d,(function(u){var d=0;if(u.status==l.DataServiceResultCode.Succeeded&&u.value&&u.value.removedApps&&u.value.removedApps.length>0){for(var f=u.value.removedApps,p=i.InvokeResultCode.E_OEM_REMOVED_FAILED,m=0;m<f.length;m++)if(f[m].assetId==n.assetId){f[m].result==i.OmexRemoveAppStatus.Success&&(p=i.InvokeResultCode.S_OK);break}p==i.InvokeResultCode.S_OK&&(d=g.untrustOsfControls(e),C(n.assetId)),o.errorCode=p}var h=!document.documentElement.contains(r);s.AppManagementMenuHelper.LogAppManagementMenuAction(n.assetId,i.AppManagementAction.Remove,d,h,c,o.errorCode),o.forceRefreshEntitlements=a,t(o)}))}},C=function(e){var n={solutionId:e};g._appName==i.AppName.ExcelWebApp&&g._notifyHost(t,i.AgaveHostAction.UninstallCustomFunctions,n)},O=function(e,n){var r=g._hideAppsExtensionUrl+"&"+i.OmexPageParameterKeys.AppName+"="+i.getModernAppVerCode(g._appName)+"&"+i.OmexPageParameterKeys.AssetId+"="+e.id+"&"+i.OmexPageParameterKeys.AppCorrelationId+"="+g._contextMgrCorrelationId,o=document.createElement("iframe");o.setAttribute("id","serviceExtensionIframe"),o.setAttribute("src",r),o.setAttribute("scrolling","auto"),o.setAttribute("border",t),o.setAttribute("width",t),o.setAttribute("height",t),o.setAttribute("style","position: absolute; left: -100px; top:0px;"),document.body.appendChild(o);var u=g._insertDialogDiv,l=function(t){if(t.source==o.contentWindow){var r={errorCode:i.InvokeResultCode.E_OEM_REMOVED_FAILED,forceRefreshEntitlements:c};document.body.removeChild(o),window.removeEventListener("message",l);var d=0,f=JSON.parse(t.data),p=parseInt(f[i.OmexRemoveAddinMessageKeys.RemoveAddinResultCode]),m=i.InvokeResultCode.E_OEM_REMOVED_FAILED;if(p===i.OmexRemoveAddinResultCode.Success){for(var h=f[i.OmexRemoveAddinMessageKeys.RemoveAddinResultValue],v=0;v<h.length;v++)if(h[v]==e.id){m=i.InvokeResultCode.S_OK;break}m==i.InvokeResultCode.S_OK&&(d=g.untrustOsfControls(e),A(e.id),C(e.id)),r.errorCode=m}var y=!document.documentElement.contains(u);s.AppManagementMenuHelper.LogAppManagementMenuAction(e.id,i.AppManagementAction.Remove,d,y,c,r.errorCode),r.forceRefreshEntitlements=a,n(r)}};window.addEventListener("message",l)},A=function(e){var t=".*",n=[];n.push(new RegExp(i.OUtil.formatString(l.WACUtils.CacheConstants.EntitlementsKey,t,t),"i")),n.push(new RegExp(i.OUtil.formatString(l.WACUtils.CacheConstants.AuthenticatedAppInstallInfoCacheKey,t,e,t,t),"i")),l.WACUtils.removeMatchesFromLocalStorage(n)},I=function(e){for(var t,n=[],r=e.length,o=0;o<r;o++){t=e[o];var s=i.OUtil.formatString(l.WACUtils.CacheConstants.AppStateCacheKey,l.WACUtils.CacheConstants.GatedCacheKeyPrefix,t.contentMarket,t.assetId),c=i.OUtil.formatString(l.WACUtils.CacheConstants.AppInstallInfoKey,l.WACUtils.CacheConstants.AnonymousCacheKeyPrefix,t.assetId,t.contentMarket),u=i.OUtil.formatString(l.WACUtils.CacheConstants.AppDetailKey,l.WACUtils.CacheConstants.UngatedCacheKeyPrefix,t.assetId),d=i.OUtil.formatString(l.WACUtils.CacheConstants.ActivatedCacheKey,t.assetId.toLowerCase(),i.StoreType.OMEX,t.contentMarket),f=i.OUtil.formatString("{0}.{1}.{2}",t.assetId,t.storeId,t.contentMarket);n[s]=a,n[c]=a,n[u]=a,n[d]=a,n[f]=a}for(var p=i.OUtil.getLocalStorage(),m=p.getKeysWithPrefix("__OSF_"),g=(o=0,m.length);o<g;o++){var h=m[o];if(0==h.indexOf(l.WACUtils.CacheConstants.GatedCacheKeyPrefix+l.WACUtils.CacheConstants.AppState)||0==h.indexOf(l.WACUtils.CacheConstants.AnonymousCacheKeyPrefix+l.WACUtils.CacheConstants.AppInstallInfo)||0==h.indexOf(l.WACUtils.CacheConstants.UngatedCacheKeyPrefix+l.WACUtils.CacheConstants.AppDetails)||0==h.indexOf(l.WACUtils.CacheConstants.ActivatedCacheKeyPrefix))n[h]!=a&&p.removeItem(h);else if(0==h.indexOf(l.WACUtils.CacheConstants.GatedCacheKeyPrefix+l.WACUtils.CacheConstants.AppinstallAuthenticated)){var v=h.replace(l.WACUtils.CacheConstants.GatedCacheKeyPrefix+l.WACUtils.CacheConstants.AppinstallAuthenticated,"");n[v=v.substring(v.indexOf(".")+1)]!=a&&p.removeItem(h)}}};if(u._serviceEndPoint=Microsoft.Office.Common.XdmCommunicationManager.createServiceEndPoint(u._clientId),u._serviceEndPoint._onHandleRequestError=function(e,t){var n,o,a;e&&(n=e._data)&&((o="string"==typeof(o="object"==typeof n?n[0]:n)?o:r)&&(a=g.getOsfControl(o))&&(a._pageStatus="Failed origin check"===t?i.OsfControlPageStatus.FailedOriginCheck:"Access Denied"===t?i.OsfControlPageStatus.FailedPermissionCheck:i.OsfControlPageStatus.FailedHandleRequest,s.RuntimeTelemetryHelper.LogExceptionTag(t,r,a.getCorrelationId(),19203549)))},u._serviceEndPoint.registerMethod("ContextActivationManager_getAppContextAsync",(function(e,u){var l="string"==typeof e?e:"object"==typeof e&&e.length>0?e[0]:r;(!l||!u)&&s.RuntimeTelemetryHelper.LogExceptionTag("Parameter validation error in getAppContextAsync.",r,r,19203545);var d,f=g.getOsfControl(l);if(!f)throw o.msAjaxDebug.trace(n),s.RuntimeTelemetryHelper.LogExceptionTag("Cannot get osfControl with given ID.",r,r,19203546),o.msAjaxError.argument("contextId");if(f._sdxTelemetryContext.getAppContextStart=performance.now(),f._iframeOnGetAppContextDelegate&&f._iframeOnGetAppContextDelegate(),s.AppLoadTimeHelper.OfficeJSLoaded(f._telemetryContext),g._enableSetAppContextInIframeName)d=f.getAppContext();else{var p=f.getEToken(),m=0;if(g._hostSpecificFileVersion&&-1!=g._hostSpecificFileVersion.indexOf(".")){var h=g._hostSpecificFileVersion.split("."),v=h[1];isNaN(v)||(m=parseInt(h[1]))}var y=g._requirementsChecker._getSupportedSet();(d=new i.OfficeAppContext(f.getMarketplaceID(),g._appName,g._appVersion,g._appUILocale,g._dataLocale,g._docUrl||window.location.href,g._clientMode,f.getSettings(),f.getReason(),f.getOsfControlType(),p,f._appCorrelationId,f.getID(),c,a,m,y,f.getHostCustomMessage(),g._hostFullVersion||i.Constants.FileVersion,window.innerHeight,window.innerWidth,f.getManifest()?f.getManifest().getDefaultDisplayName():r,f._appDomains,void 0,f.getFeatureGates(),void 0,f._initialDisplayMode))._wacHostEnvironment=g._wacHostEnvironment||t,d._isFromWacAutomation=!!g._isFromWacAutomation,d._addInSourceLocationSubdomainAllowedIsEnabled=a,d._addInSourceUrl=f._agavePageUrl}u(d),f._pageStatus=i.OsfControlPageStatus.Ready,f._pageIsReadyTimerExpired&&s.RuntimeTelemetryHelper.LogExceptionTag("App attempted to retrieve context after app activation error has occured.",r,f.getCorrelationId(),19203547),f._contextActivationMgr._ErrorUXHelper&&f._contextActivationMgr._ErrorUXHelper.removeProgressDiv(f._div,f._id),f.ensureAgaveEndPoint(),f._focusOnIframeWhenLoaded&&f._frame.contentWindow.focus(),s.AppLoadTimeHelper.ActivationEnd(f._telemetryContext),f._sdxTelemetryContext.getAppContextEnd=performance.now(),f._timer&&(window.clearTimeout(f._timer),f._timer=r),f._iframeIsLoaded&&f._notifyHostIFrameOnLoaded()}),Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPoint.registerMethod("ContextActivationManager_notifyHost",(function(e){e&&2==e.length||!(e&&3==e.length&&(e[1]===i.AgaveHostAction.UpdateTargetUrl||e[1]===i.AgaveHostAction.SendTelemetryEvent||e[1]===i.AgaveHostAction.SendMessage||e[1]===i.AgaveHostAction.LaunchExtensionComponent||e[1]===i.AgaveHostAction.StopExtensionComponent||e[1]===i.AgaveHostAction.RestartExtensionComponent||e[1]===i.AgaveHostAction.EnableTaskPaneHeaderButton||e[1]===i.AgaveHostAction.DisableTaskPaneHeaderButton||e[1]===i.AgaveHostAction.RefreshRibbonGallery))&&o.msAjaxDebug.trace("ContextActivationManager_notifyHost params is wrong.");var t=e[0],a=e[1],s=g.getOsfControl(t);if(s)if(a===i.AgaveHostAction.TabExitShift||a===i.AgaveHostAction.ExitNoFocusableShift)g._ErrorUXHelper.focusOnNotificationUxShiftIn(t,a);else if(a===i.AgaveHostAction.UpdateTargetUrl){var c=e[2];s.checkAppDomains(c)&&s.updateAgaveEndPointTargetUrl(c)}else if(a===i.AgaveHostAction.SendTelemetryEvent){var u=e[2];s._contextActivationMgr._notifyHost(t,a,u)}else if(a===i.AgaveHostAction.LaunchExtensionComponent){var l=e[2];s._contextActivationMgr._notifyHost(t,a,l)}else if(a===i.AgaveHostAction.RestartExtensionComponent){var d=e[2];if(d.InstanceToken){var f=s._contextActivationMgr._cachedOsfControls[d.InstanceToken];if(f)f.refresh();else if(d.LaunchProperties&&d.LaunchProperties.OptionalProperties){var p=d.Id.Id,m=d.LaunchProperties.OptionalProperties.SourceLocationOverrideResourceId;s._contextActivationMgr.refreshOsfControl(p,m)}}}else if(a===i.AgaveHostAction.StopExtensionComponent){var h=e[2];s._contextActivationMgr._notifyHost(t,a,h)}else if(a==i.AgaveHostAction.SendMessage){for(var v in s._contextActivationMgr._cachedOsfControls)if(v!=s.getID()){var y=s._contextActivationMgr._cachedOsfControls[v];if(y.getStoreLocator()==s.getStoreLocator()&&y.getStoreType()==s.getStoreType()){var b=e[2];y.getOwnerAddinAssetId()!=r&&y.getOwnerAddinAssetId()==s.getOwnerAddinAssetId()?y.notifyAgave(i.AgaveHostAction.SendMessage,b):y.getMarketplaceID()==s.getMarketplaceID()&&y.notifyAgave(i.AgaveHostAction.SendMessage,b)}}}else if(a==i.AgaveHostAction.EnableTaskPaneHeaderButton){var _=e[2];s._contextActivationMgr._notifyHost(t,a,_)}else if(a==i.AgaveHostAction.RefreshRibbonGallery){var S=e[2];s._contextActivationMgr._notifyHost(t,a,S)}else s._contextActivationMgr._notifyHost?s._contextActivationMgr._notifyHost(t,a):o.msAjaxDebug.trace("No notifyHost provided by the host.");else o.msAjaxDebug.trace(n)}),Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPoint.registerMethod("ContextActivationManager_openWindowInHost",v,Microsoft.Office.Common.InvokeType.async,c),u._enableServiceDeliveredExperience&&u._serviceEndPoint.registerMethod("Office_sendMessageToHost",h,Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPointInternal=Microsoft.Office.Common.XdmCommunicationManager.createServiceEndPoint(u._clientId+i.Constants.EndPointInternalSuffix),u._serviceEndPointInternal.registerMethod("ContextActivationManager_getEntitlementsForInsertDialog",y,Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPointInternal.registerMethod("ContextActivationManager_invokeSignIn",(function(e){if(e&&e.storeType!=i.StoreTypeEnum.PrivateCatalog){var n=window.location.href,o=g._osfOmexBaseUrl+i.Constants.SignInRedirectUrl+encodeURIComponent(n);window.location.assign(o)}else l.PrivateCatalogService.authenticationProxy.getSignInUrl((function(e){window.top.location.replace(e)}),(function(){g._notifyHost(t,i.AgaveHostAction.NotifyHostError,r)}))}),Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPointInternal.registerMethod("ContextActivationManager_invokeSignOut",(function(e){e&&e.storeType==i.StoreTypeEnum.PrivateCatalog&&l.PrivateCatalogService.SignOutUser(),b(e,r)}),Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPointInternal.registerMethod("ContextActivationManager_invokeWindowOpen",(function(e){if(e.pageUrl){var t={strUrl:e.pageUrl,strWindowName:r,strWindowFeatures:r};v(t)}}),Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPointInternal.registerMethod("ContextActivationManager_onClickInsertOsfControl",(function(e){o.msAjaxDebug.trace("onClickInsertOsfControl!"),g._notifyHost(t,i.AgaveHostAction.InsertAgave,e)}),Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPointInternal.registerMethod("ContextActivationManager_onClickInstallOsfControl",u._onClickInstallOsfControl,Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPointInternal.registerMethod("ContextActivationManager_onClickRefreshAddinCommands",b,Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPointInternal.registerMethod("ContextActivationManager_onClickCancelDialog",(function(){o.msAjaxDebug.trace("onClickCancelDialog!"),g._notifyHost(t,i.AgaveHostAction.CancelDialog),g._internalConversationId&&(g._serviceEndPointInternal.unregisterConversation(g._internalConversationId),g._internalConversationId=r)}),Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPointInternal.registerMethod("ContextActivationManager_removeAppForInsertDialog",S,Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPointInternal.registerMethod("ContextActivationManager_logTelemetryDataForInsertDialog",(function(e){switch(e.datapointName){case i.DataPointNames.AppManagementMenu:i.OUtil.validateParamObject(e,{assetId:{type:String,mayBeNull:c},operationMetadata:{type:Number,mayBeNull:c},hrStatus:{type:Number,mayBeNull:c}},r),s.AppManagementMenuHelper.LogAppManagementMenuAction(e.assetId,e.operationMetadata,0,c,c,e.hrStatus);break;case i.DataPointNames.InsertionDialogSession:i.OUtil.validateParamObject(e,{assetId:{type:String,mayBeNull:c},totalSessionTime:{type:Number,mayBeNull:c},trustPageSessionTime:{type:Number,mayBeNull:c},appInserted:{type:Boolean,mayBeNull:c},lastActiveTab:{type:Number,mayBeNull:c},lastActiveTabCount:{type:Number,mayBeNull:c}},r),s.InsertionDialogSessionHelper.LogInsertionDialogSession(e.assetId,e.totalSessionTime,e.trustPageSessionTime,e.appInserted,e.lastActiveTab,e.lastActiveTabCount);break;case i.DataPointNames.UploadFileDevCatelog:i.OUtil.validateParamObject(e,{operationMetadata:{type:Number,mayBeNull:c},hrStatus:{type:Number,mayBeNull:c}},r),s.UploadFileDevCatelogHelper.LogUploadFileDevCatelogAction(this._appCorrelationId,e.operationMetadata,0,c,c,e.hrStatus);break;case i.DataPointNames.UploadFileDevCatalogUsage:i.OUtil.validateParamObject(e,{currentStoreType:{type:String,mayBeNull:c},id:{type:String,mayBeNull:a},appVersion:{type:String,mayBeNull:a},appTargetType:{type:Number,mayBeNull:c},isAppCommand:{type:String,mayBeNull:c},appSizeWidth:{type:Number,mayBeNull:a},appSizeHeight:{type:Number,mayBeNull:a}},r),s.UploadFileDevCatalogUsageHelper.LogUploadFileDevCatalogUsageAction(this._appCorrelationId,e.currentStoreType,e.Id,e.appVersion,e.appTargetType,e.isAppCommand,e.appSizeWidth,e.appSizeHeight)}}),Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPointInternal.registerMethod("ContextActivationManager_getOmexData",_,Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPointInternal.registerMethod("ContextActivationManager_removeAppCommandsAddin",(function(e){var n=g.getOsfControl(e.id);n?n._isAddinCommands((function(n){n&&g._notifyHost(t,i.AgaveHostAction.RemoveAppCommandsAddin,{assetId:e.id})})):o.msAjaxDebug.trace("osfControl for the given ID doesn't exist:"+e.id)}),Microsoft.Office.Common.InvokeType.async,c),i.AppSpecificSetup._setupFacade(u._hostControl,u,u._serviceEndPoint,u._serviceEndPointInternal),e.hostType=u._hostType,e.spBaseUrl=u._spBaseUrl,l.CatalogFactory.setHostContext(e),u._localeStringLoadingPendingCallbacks=[],u._localizedScriptsUrl&&"null/"!=u._localizedScriptsUrl){u._loadLocaleString(Function.createDelegate(u,(function(){this._ErrorUXHelper=new i._ErrorUXHelper(this)})))}u.queryEntitlementDetails=function(e){y(e,e.callbackFunc)},u._getOmexData=function(e){_(e)},u._removeAppForInsertDialog=function(e){S(e,e.callbackFunc)}},i.ContextActivationManager.prototype={insertOsfControl:function(e){var t=!0,n=!1,r=this;if(i.OUtil.validateParamObject(e,{div:{type:Object,mayBeNull:n},id:{type:String,mayBeNull:n},marketplaceID:{type:String,mayBeNull:n},marketplaceVersion:{type:String,mayBeNull:n},store:{type:String,mayBeNull:n},storeType:{type:String,mayBeNull:n},alternateReference:{type:Object,mayBeNull:t},settings:{type:Object,mayBeNull:t},reason:{type:String,mayBeNull:t},osfControlType:{type:Number,mayBeNull:t},snapshotUrl:{type:String,mayBeNull:t},preactivationCallback:{type:Object,mayBeNull:t},virtualOsfControlActivationCallback:{type:Object,mayBeNull:t},isvirtualOsfControl:{type:Boolean,mayBeNull:t},isDialog:{type:Boolean,mayBeNull:t},hostCustomMessage:{type:String,mayBeNull:t},isForUILessAction:{type:Boolean,mayBeNull:t},ownerAddinAssetId:{type:String,mayBeNull:t},ownerAddinStoreType:{type:String,mayBeNull:t},sourceLocationOverrideUrl:{type:String,mayBeNull:t},focusOnIframeWhenLoaded:{type:Boolean,mayBeNull:t},featureGates:{type:Object,mayBeNull:t},activationStart:{type:Number,mayBeNull:t},hostInfoFlags:{type:Number,mayBeNull:t},sharedRuntimeId:{type:String,mayBeNull:t},initialDisplayMode:{type:Number,mayBeNull:t}},null),!r._disableAppsForOfficeThirdParty||e.storeType.toLowerCase()===i.StoreType.FirstParty.toLowerCase()){var o={div:e.div,id:e.id,marketplaceID:e.marketplaceID,marketplaceVersion:e.marketplaceVersion,store:e.store,storeType:e.storeType,alternateReference:e.alternateReference,settings:e.settings,reason:e.reason,osfControlType:e.osfControlType,snapshotUrl:e.snapshotUrl,contextActivationMgr:r,preactivationCallback:e.preactivationCallback,virtualOsfControlActivationCallback:e.virtualOsfControlActivationCallback,isvirtualOsfControl:e.isvirtualOsfControl,isDialog:e.isDialog,hostCustomMessage:e.hostCustomMessage,isForUILessAction:e.isForUILessAction,ownerAddinAssetId:e.ownerAddinAssetId,sourceLocationOverrideResourceId:e.sourceLocationOverrideResourceId,sourceLocationOverrideUrl:e.sourceLocationOverrideUrl,ownerAddinStoreType:e.ownerAddinStoreType,focusOnIframeWhenLoaded:e.focusOnIframeWhenLoaded,featureGates:e.featureGates,activationStart:e.activationStart,hostInfoFlags:e.hostInfoFlags,sharedRuntimeId:e.sharedRuntimeId,initialDisplayMode:e.initialDisplayMode},a=r.getSQMAgaveUsage(o.storeType,o.osfControlType,o.reason,e.marketplaceID),c=new i.OsfControl(o);c._sqmDWords[0]=a[0],c._sqmDWords[1]=a[1],c._contextActivationMgr._ErrorUXHelper&&c._contextActivationMgr._ErrorUXHelper.showProgress(c._div,c._id);return r._loadLocaleString(Function.createDelegate(r,(function(){c.activate({isInsertOsfControl:t}),s.RuntimeTelemetryHelper.LogCommonMessageTag("OsfControl activation lifecycle: OsfControl active got called for controlId: "+c._id,this._contextMgrCorrelationId,594356321)}))),c}},insertDialogControl:function(e){var t=!1;i.OUtil.validateParamObject(e,{div:{type:Object,mayBeNull:t},id:{type:String,mayBeNull:t},dialogUrl:{type:String,mayBeNull:t},marketplaceID:{type:String,mayBeNull:t},marketplaceVersion:{type:String,mayBeNull:t},appDomains:{type:Array,mayBeNull:t},store:{type:String,mayBeNull:t},storeType:{type:String,mayBeNull:t},agaveName:{type:String,mayBeNull:!0}},null);var n={div:e.div,id:e.id,marketplaceID:e.marketplaceID,marketplaceVersion:e.marketplaceVersion,store:e.store,storeType:e.storeType,isDialog:!0,contextActivationMgr:this};new i.OsfControl(n).createIframeForDialogControl(e.agaveName,e.dialogUrl,e.appDomains)},insertBlankControlWithErrorUX:function(e,t){var n=!1,r=this;i.OUtil.validateParamObject(e,{div:{type:Object,mayBeNull:n},id:{type:String,mayBeNull:n},marketplaceID:{type:String,mayBeNull:n},marketplaceVersion:{type:String,mayBeNull:n},store:{type:String,mayBeNull:n},osfControlType:{type:Number,mayBeNull:!0},storeType:{type:String,mayBeNull:n}},null);var o={div:e.div,id:e.id,marketplaceID:e.marketplaceID,marketplaceVersion:e.marketplaceVersion,store:e.store,storeType:e.storeType,osfControlType:e.osfControlType,contextActivationMgr:r,isvirtualOsfControl:n},a=new i.OsfControl(o);a._contextActivationMgr.registerOsfControl(a);var s=function(e,t){var r,o="",i="",a="",s=n;e.status===l.DataServiceResultCode.Succeeded&&e.value&&(o=(r=e.value).getDefaultDisplayName(),i=r.getProviderName(),a=r.getDefaultIconUrl(),s=r.isSSOAddin()),t(o,i,a,s)},c=l.OmexUtils.getOmexEndPointPageUrl(r.getOsfOmexBaseUrl(),e.marketplaceID,e.store),u=l.CatalogFactory.resolve(e.storeType.toLowerCase());if(null!=u){var d={assetId:e.marketplaceID,appVersion:e.marketplaceVersion,storeType:e.storeType,storeId:e.store,targetType:null},f=i.OmexClientNames[r._appName];u.getAndCacheManifest(d,r._storeLocator,new l.AddinCommandsTelemetryContext(a.getCorrelationId()),(function(n){s(n,(function(n,r,o,i){a._showTrustError(f,n,r,o,e.storeType,t,c,i)}))}))}},purgeDialogControl:function(e){var t=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1}]);if(t)throw t;var n=this._cachedOsfControls[e];void 0!==n&&(n._conversationId&&this._getServiceEndPoint().unregisterConversation(n._conversationId),this.unregisterOsfControl(n))},dispose:function(){var e=this;e._serviceEndPoint&&(e._serviceEndPoint.dispose(),Microsoft.Office.Common.XdmCommunicationManager.deleteServiceEndPoint(e._clientId),e._serviceEndPoint=null),e._serviceEndPointInternal&&(e._serviceEndPointInternal.dispose(),Microsoft.Office.Common.XdmCommunicationManager.deleteServiceEndPoint(e._clientId+i.Constants.EndPointInternalSuffix),e._serviceEndPointInternal=null)},setLocalizedUrl:function(e,t,n){var r=this,o=Function._validateParams(arguments,[{name:"scriptUrl",type:String,mayBeNull:!1},{name:"imageUrl",type:String,mayBeNull:!1},{name:"styleUrl",type:String,mayBeNull:!1}]);if(o)throw o;if(r._localizedScriptsUrl=e,r._localizedImagesUrl=t,r._localizedStylesUrl=n,r._localizedScriptsUrl&&"null/"!=r._localizedScriptsUrl){var a=function(){this._ErrorUXHelper||(this._ErrorUXHelper=new i._ErrorUXHelper(this))};r._loadLocaleString(Function.createDelegate(r,a))}},getOsfControlStatus:function(e){var t=this._cachedOsfControls[e];return t?t.getStatus():i.OsfControlStatus.InvalidOsfControl},hostCheckReadyHandler:function(e,t){null!=t&&(this._isHostFrameTrusted=t),s.RuntimeTelemetryHelper.LogCommonMessageTag("Host frame check set :"+JSON.stringify(t),this._contextMgrCorrelationId,595354008)},activateOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1}]);if(t)throw t;var n=this._cachedOsfControls[e];void 0!==n&&n.activate()},deActivateOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1}]);if(t)throw t;var n=this._cachedOsfControls[e];void 0!==n&&n.deActivate()},purgeOsfControl:function(e,t){var n=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1},{name:"purgeManifest",type:Boolean,mayBeNull:!1}]);if(n)throw n;var r=this._cachedOsfControls[e];void 0!==r&&(s.RuntimeTelemetryHelper.LogCommonMessageTag("OsfControl activation lifecycle: purgeOsfControl for controlId: "+e,this._contextMgrCorrelationId,594356320),r.purge(t))},purgeOsfControlNotifications:function(){for(var e in this._cachedOsfControls)this._ErrorUXHelper.purgeOsfControlNotification(e)},untrustOsfControls:function(e){var t=this,n=0,r=function(e){return function(){e.activate({hasConsent:!0})}},o=i.OUtil.formatString(i.Constants.ActivatedCacheKey,e.id.toLowerCase(),e.currentStoreType,e.storeId);for(var a in t._deleteCachedFlag(o),t._cachedOsfControls){var s=t._cachedOsfControls[a];if(s._marketplaceID.toLowerCase()==e.id.toLowerCase()){t._ErrorUXHelper.purgeOsfControlNotification(s._id),s.deActivate();var c=l.OmexUtils.getOmexEndPointPageUrl(t.getOsfOmexBaseUrl(),s._marketplaceID,e.storeId),u=i.OmexClientNames[t._appName];s._showTrustError(u,e.displayName,e.providerName,e.iconUrl,e.currentStoreType,r(s),c),n++}}return n},retryAll:function(e){var t=this;for(var n in t._cachedOsfControls){var r=t._cachedOsfControls[n];r._marketplaceID.toLowerCase()==e.toLowerCase()&&r._retryActivate&&(t._ErrorUXHelper.purgeOsfControlNotification(r._id),t._ErrorUXHelper.removeInfoBarDiv(n,!1),r._retryActivate(),r._retryActivate=null)}},getOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1}]);if(t)throw t;return this._cachedOsfControls[e]},getOsfControls:function(){var e=[];for(var t in this._cachedOsfControls)e.push(this._cachedOsfControls[t]);return e},getOsfOmexBaseUrl:function(){return this._osfOmexBaseUrl},getAppName:function(){return this._appName},getClientMode:function(){return this._clientMode},getClientId:function(){return this._clientId},getFormFactor:function(){return this._formFactor},getDocUrl:function(){return this._docUrl},getAppUILocale:function(){return this._appUILocale},getDataLocale:function(){return this._dataLocale},getPageBaseUrl:function(){return this._pageBaseUrl},getLcid:function(){return this._lcid},isExternalMarketplaceAllowed:function(){return this._allowExternalMarketplace},isStoreDisabled:function(e){this._loadLocaleString(Function.createDelegate(this,(function(){var t=l.CatalogFactory.resolve(i.StoreType.OMEX),n=i.OUtil.Guid.generateNewGuid(),r=new l.InsertDialogTelemetryContext(n);if(t instanceof l.OmexCatalog)t.isStoreDisabled(r,e);else{e({value:!1,status:200})}})))},getLocalizedScriptsUrl:function(){return this._localizedScriptsUrl?this._localizedScriptsUrl:""},getLocalizedImagesUrl:function(){return this._localizedImagesUrl?this._localizedImagesUrl:""},getLocalizedStylesUrl:function(){return this._localizedStylesUrl?this._localizedStylesUrl:""},raiseOsfControlStatusChange:function(e){this._controlStatusChanged&&this._controlStatusChanged(e)},registerOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"osfControl",type:Object,mayBeNull:!1}]);if(t)throw t;this._cachedOsfControls[e.getID()]=e},unregisterOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"osfControl",type:Object,mayBeNull:!1}]);if(t)throw t;delete this._cachedOsfControls[e.getID()]},setIframeAttributeBag:function(e){this._iframeAttributeBag=e},displayNotification:function(e){var t=null,n=!0,r=!1,o=this;i.OUtil.validateParamObject(e,{infoType:{type:Number,mayBeNull:r},id:{type:String,mayBeNull:r},title:{type:String,mayBeNull:r},description:{type:String,mayBeNull:r},url:{type:String,mayBeNull:n},icon:{type:String,mayBeNull:n},buttonTxt:{type:String,mayBeNull:n},buttonCallback:{type:Function,mayBeNull:n},dismissCallback:{type:Function,mayBeNull:n},"displayDeactive ":{type:Boolean,mayBeNull:n},highPriority:{type:Boolean,mayBeNull:n},detailView:{type:Boolean,mayBeNull:n},reDisplay:{type:Boolean,mayBeNull:n},logAsError:{type:Boolean,mayBeNull:n},errorCode:{type:Number,mayBeNull:n},retryAll:{type:Boolean,mayBeNull:n},iframeNotificationUrl:{type:String,mayBeNull:n},notificationType:{type:Number,mayBeNull:n}},t),e.errorCode||(e.errorCode=0);var a=o._cachedOsfControls[e.id];if(a)if(a._isvirtualOsfControl){if(e.errorCode==i.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED||e.errorCode==i.ErrorStatusCodes.E_OEM_EXTENSION_KILLED)return void o.purgeOsfControl(e.id,n);if(null==e.highPriority&&(e.highPriority=e.infoType===i.InfoType.Error?n:r),e.highPriority===r)a._notificationParams.push(e);else{for(var c=a._notificationParams,u=0;u<c.length;u++)if(!c[u].highPriority){c.splice(u,0,e),c=t;break}c!=t&&c.push(e)}!a._isvirtualOsfControlCallbackInvoked&&a.ensureToGetVirtualOsfControlManifest((function(e){a.invokeVirtualOsfControlActivationCallback(e)})),!a._isManifestProcessedForCustomFunctions&&a.ensureToGetVirtualOsfControlManifest((function(e){a.processManifestForCustomFunctions(e)}))}else{if(e.logAsError&&(s.AppLoadTimeHelper.SetErrorResult(a._telemetryContext,e.errorCode),o._notifyHostError)){var l={errorCode:e.errorCode};o._notifyHostError(e.id,i.AgaveHostAction.NotifyHostError,l)}(e.displayDeactive||e.iframeNotificationUrl!=t)&&(e.detailView=n),e.div=a._div,o._ErrorUXHelper.showNotification(e)}},dismissMessages:function(e){this._ErrorUXHelper&&this._ErrorUXHelper.dismissMessages(e)},notifyAgave:function(e,t){var n=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1},{name:"actionId",type:Number,mayBeNull:!1}]);if(n)throw n;var r=this._cachedOsfControls[e];void 0!==r&&(t===i.AgaveHostAction.CtrlF6In||t===i.AgaveHostAction.TabIn||t===i.AgaveHostAction.Select?this._ErrorUXHelper.focusOnNotificationUx(e,t):t===i.AgaveHostAction.TabInShift&&r._pageStatus!==i.OsfControlPageStatus.Ready?this._ErrorUXHelper.focusOnNotificationUxShiftIn(e,t):r.notifyAgave(t))},setWSA:function(e){var t=this;t._wsa=e,t._wsa&&(t._wsa.createStreamUnobfuscated(i.SQMDataPoints.DATAID_APPSFOROFFICEUSAGE,i.BWsaStreamTypes.Static,2,i.BWsaConfig.defaultMaxStreamRows),t._wsa.createStreamUnobfuscated(i.SQMDataPoints.DATAID_APPSFOROFFICENOTIFICATIONS,i.BWsaStreamTypes.Static,4,i.BWsaConfig.defaultMaxStreamRows))},getWSA:function(){return this._wsa},getSQMAgaveUsage:function(e,t,n,r){var o,a;switch(e.toLowerCase()){case i.StoreType.OMEX:o=0;break;case i.StoreType.SPCatalog:o=1;break;case i.StoreType.FileSystem:o=2;break;case i.StoreType.Registry:o=3;break;case i.StoreType.Exchange:o=4;break;case i.StoreType.SPApp:o=5;break;case i.StoreType.FirstParty:o=6;break;case i.StoreType.Sdx:o=7;break;case i.StoreType.InMemory:o=8;break;case i.StoreType.OneDrive:o=9;break;case i.StoreType.PrivateCatalog:o=10;break;case i.StoreType.HardCodedPreinstall:o=11;break;case i.StoreType.UploadFileDevCatalog:o=12;break;default:o=15}switch(t){case i.OsfControlType.DocumentLevel:a=1;break;case i.OsfControlType.ContainerLevel:a=0;break;default:a=2}var s=7;if(n&&n.toLowerCase)switch(n.toLowerCase()){case Microsoft.Office.WebExtension.InitializationReason.Inserted.toLowerCase():s=0;break;case Microsoft.Office.WebExtension.InitializationReason.DocumentOpened.toLowerCase():s=1}var c=0;0!==r.toLowerCase().indexOf("wa")&&0!==r.toLowerCase().indexOf("fa")||(c=r&&r.length>2?parseInt(r.substring(2),10):0,isNaN(c)&&(c=0));return[s<<8|a<<4|o,c]},isMyOrgReady:function(e){var t=this;if(t._enableMyOrg)if(t._spBaseUrl&&t._iframeProxies&&t._iframeProxies[t._spBaseUrl]&&t._iframeProxies[t._spBaseUrl].clientEndPoint)e({isReady:!0,clientEndPoint:t._iframeProxies[t._spBaseUrl].clientEndPoint});else{t._createSharePointIFrameProxy(t._spBaseUrl,(function(t){e(t?{isReady:!0,clientEndPoint:t}:{isReady:!1})}))}else e({isReady:!1})},openInputUrlDialog:function(e){var t="style",n=this,r=document.createElement("p");r.setAttribute("id","title-p"),n._enableInsertDialogAccessibilityFix?"ltr"==document.documentElement.getAttribute("dir")?r.setAttribute(t,"padding: 26px 0px 10px 26px;"):r.setAttribute(t,"padding: 26px 26px 10px 0px;"):r.setAttribute(t,"margin: 26px 0px 10px 26px;"),r.textContent="DevCatalog server Url is configured in settings.xml - Enter manifest file name only (AppId.xml):",e.appendChild(r);var o=document.createElement("div"),a=document.createElement("input");a.setAttribute("type","url"),a.setAttribute("id","url-input"),a.setAttribute("data-lpignore","true"),n._enableInsertDialogAccessibilityFix?("ltr"==document.documentElement.getAttribute("dir")?a.setAttribute(t,"margin-left: 26px; height: 18px; width: calc(100% - 141px); vertical-align: middle;"):a.setAttribute(t,"margin-right: 26px; height: 18px; width: calc(100% - 141px); vertical-align: middle;"),o.appendChild(a)):(a.setAttribute("size","75"),a.setAttribute(t,"margin-left: 26px; height: 18px; vertical-align: middle;"),e.appendChild(a));var c=n,u=function(e){var t=new i.Manifest.Manifest(e,c.getAppUILocale());!i.OsfManifestManager.hasManifest(t.getMarketplaceID(),t.getMarketplaceVersion())&&i.OsfManifestManager.cacheManifest(t.getMarketplaceID(),t.getMarketplaceVersion(),t);var n={id:t.getMarketplaceID(),targetType:t.getTarget(),appVersion:t.getMarketplaceVersion(),currentStoreType:i.StoreType.Registry,storeId:"developer",assetId:t.getMarketplaceID(),assetStoreId:i.StoreType.Registry,width:t.getDefaultWidth()||0,height:t.getDefaultHeight()||0,isAddinCommands:t._isAddinCommandsManifest(i.getManifestHostType(c._hostType))};s.UploadFileDevCatalogUsageHelper.LogUploadFileDevCatalogUsageAction(this._appCorrelationId,n.currentStoreType,n.id,n.appVersion,n.targetType,n.isAddinCommands,n.width,n.height),c._notifyHost("0",i.AgaveHostAction.InsertAgave,n)},l=function(e){alert("Error when requesting manifest file: "+e)},d=document.createElement("input");d.setAttribute("type","button"),d.setAttribute("id","devcat-insert-button"),d.setAttribute("value","Insert"),d.setAttribute("class","WACButton WACDialogButtonNormal"),i.OUtil.addEventListener(d,"click",(function(){i.OUtil.xhrGet(c._devCatalogUrl+"/"+a.value,u,l)})),n._enableInsertDialogAccessibilityFix?(o.appendChild(d),e.appendChild(o)):e.appendChild(d)},launchInsertDialog:function(e,t,n){var r=null,o="100%";0!=e.childNodes.length&&e.removeChild(e.childNodes.item(0));var a,c=i.OUtil.Guid.generateNewGuid(),u=new l.InsertDialogTelemetryContext(c);if(this._enableDevCatalog){(a=document.createElement("div")).style.width=o,a.style.height="80%",e.appendChild(a);var d=document.createElement("div");d.style.width=o,d.style.height="20%",e.appendChild(d),this.openInputUrlDialog(d)}else a=e;var f=this;f._insertDialogDiv=a;var p=document.createElement("div");p.style.width=o,p.style.height=o,p.style.backgroundImage="url("+f.getLocalizedImageFilePath("progress.gif")+")",p.style.backgroundRepeat="no-repeat",p.style.backgroundPosition="center",a.appendChild(p);!function(e,t){if(f._enableMyOrg)try{i.OUtil.validateParamObject(e,{webUrl:{type:String,mayBeNull:!1}},t);f.isMyOrgReady((function(n){n.isReady?(e.clientEndPoint=n.clientEndPoint,l.CatalogFactory.resolve(i.StoreType.SPCatalog).getSPCatalogUrl(u,(function(n){t({statusCode:n.status,value:n.value,context:e})}))):t({statusCode:i.InvokeResultCode.E_GENERIC_ERROR,value:r,context:e})}))}catch(n){return s.RuntimeTelemetryHelper.LogExceptionTag("Error when getting corporate catalog url:",n,this._appCorrelationId,34719254),void t({statusCode:i.InvokeResultCode.E_GENERIC_ERROR,value:r,context:e})}else t({statusCode:i.InvokeResultCode.E_CATALOG_NO_APPS,value:r,context:e})}({webUrl:f._spBaseUrl},(function(e){var c=document.createElement("iframe");c.setAttribute("id","InsertDialog"),c.setAttribute("src","about:blank"),c.setAttribute("width",o),c.setAttribute("height",o),c.setAttribute("marginHeight","0"),c.setAttribute("marginWidth","0"),c.setAttribute("frameBorder","0"),c.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin ms-allow-popups allow-popups"),"undefined"!=typeof Strings&&Strings&&Strings.OsfRuntime&&c.setAttribute("title",Strings.OsfRuntime.L_InsertionDialogTile_TXT);var u=r,l=[];f.isStoreDisabled((function(o){var d='"}',p='], "url":"',m=",",g='{ "IsUploadFileDevCatalogEnabled":'+f._enableUploadFileDevCatalog+m+'"isStoreDisabled":'+o.value+m+'"showSignOutFromPrivateCatalogMessage":'+f._showSignOutFromPrivateCatalogMessage+m+'"enableInsertDialogAccessibilityFix":'+f._enableInsertDialogAccessibilityFix+m+'"isBlackForestRedirectEnabled":'+f._enableBlackForestRedirect+m+'"isHostDocumentDomain":'+f._isHostDocumentDomain+m+'"agaveAddinUploadEnabled":'+f._agaveAddinUploadEnabled+" }";if(f.isExternalMarketplaceAllowed()){var h='{ "provValues":[0,0,0,'+(f._enableMyApps?i.InvokeResultCode.S_OK.toString():i.InvokeResultCode.S_HIDE_PROVIDER.toString())+p+f._osfOmexBaseUrl+'", "client":"'+f._getClientNameForOmex()+'", "'+i.OmexPageParameterKeys.AuthType+'":'+f._getAuthTypeForHideAppsExtensionUrl()+"}";l.push('"myApp":'+h),s.RuntimeTelemetryHelper.LogCommonMessageTag("isExternalMarketplaceAllowed is true, myApp tab show firstly.",f._contextMgrCorrelationId,20194266)}if(e&&e.value!=r){if(f._enableMyOrg){f._myOrgCatalogUrl=e.value;var v='{ "provValues":[1,1,0,'+e.statusCode+p+e.value+d;l.push('"myOrg":'+v)}if(f._enableOneDriveCatalog&&-1!=document.cookie.indexOf("OneDriveCatalog=true")){f._myOneDriveCatalogUrl=e.value;var y='{ "provValues":[9,9,0,0], "url":"'+e.value+d;l.push('"myOneDrive":'+y)}}if(f._enablePrivateCatalog){var b='{"provValues":[10,10,0,0], "client":"'+f._getClientNameForOmex()+d;l.push('"privateCatalog":'+b)}l.length>0&&(u="{"+l.join(", ")+"}"),f._internalConversationId&&f._serviceEndPointInternal.unregisterConversation(f._internalConversationId);var _=f.getClientId()+"_"+f.getDocUrl(),S=i.OUtil.getFrameName(_),C=i.OUtil.generateConversationId();f._internalConversationId=i.OUtil.generateConversationId(),c.setAttribute("name",S);var O=r;n!=r&&(O='{ "navigationMode":'+n.navigationMode+', "navigationModeParameter": "'+n.assetId+'", "category":"'+n.category+d);var A=window.location.origin,I="",x=[C,encodeURIComponent(A),f._appVersion,i.getAppVerCode(f._appName),f.getLcid(),i.Constants.FileVersion,encodeURIComponent(u),t,encodeURIComponent(g),encodeURIComponent(O),f._contextMgrCorrelationId];I=f._localizedResourcesUrl?f._localizedResourcesUrl+"WefGallery.htm?b="+i.Constants.FileVersion:f._pageBaseUrl+f.getLcid()+"/WefGallery.htm?b="+i.Constants.FileVersion;var E=i.OUtil.addXdmInfoAsHash(I,x.join("|"));E=i.OUtil.addFlightsAsHash(E,JSON.stringify(i.Flights)),f._serviceEndPointInternal.registerConversation(C,E),c.setAttribute("src",E),f._insertDialogDiv?(0!=a.childNodes.length&&a.removeChild(a.childNodes.item(0)),a.appendChild(c)):(a.insertBefore(c,a.firstChild),f._insertDialogDiv=a)}))})),f._preloadOfficeJs()},activateAgavesBlockedBySandboxNotSupport:function(){for(var e in this._cachedOsfControls){var t=this._cachedOsfControls[e];t._status===i.OsfControlStatus.NotSandBoxSupported&&t.activate()}},setRequirementsChecker:function(e){this._requirementsChecker=e},getRequirementsChecker:function(){return this._requirementsChecker},appHasNotifications:function(e){return!!this._ErrorUXHelper&&this._ErrorUXHelper.appHasNotifications(e)},refreshOsfControl:function(e,t){var n=this;for(var r in n._cachedOsfControls)if(n._cachedOsfControls[r]&&e==n._cachedOsfControls[r]._marketplaceID&&t==n._cachedOsfControls[r]._sourceLocationOverrideResourceId){n._cachedOsfControls[r].refresh();break}},_doesUrlHaveSupportedProtocol:function(e){var t=!1;e&&(t=null!=decodeURIComponent(e).match(/^https?:\/\/.+$/gi));return t},_loadLocaleString:function(e){var t=this;if("undefined"!=typeof Strings&&Strings&&Strings.OsfRuntime){for(var n=t._localeStringLoadingPendingCallbacks.length,r=0;r<n;r++){t._localeStringLoadingPendingCallbacks.shift()()}e()}else{t._localeStringLoadingPendingCallbacks.push(e);var o=t._localeStringLoadingPendingCallbacks;if(1===o.length){t._loadStringScript((function(){for(var e=o.length,t=0;t<e;t++){var n=o.shift();"function"==typeof n&&n()}}))}}},_loadStringScript:function(e){var t=this,n=this.getLocalizedScriptsUrl();n+=i.Constants.StringResourceFile;var r=0,o=function(){var a=null;if("undefined"!=typeof Strings&&Strings&&Strings.OsfRuntime){if(r>0){c=i.OUtil.formatString("osfruntime_strings loaded after {0} retries.",r);s.RuntimeTelemetryHelper.LogExceptionTag(c,a,a,20306077)}e()}else{if(++r<3)return void setTimeout((function(){i.OUtil.loadScript(n,o)}),750*r);t._localeStringLoadingPendingCallbacks.length=0;var c=i.OUtil.formatString("The locale, {0}, provided by the host app is not supported. Url: {1}",t.getLcid(),n);s.RuntimeTelemetryHelper.LogExceptionTag(c,a,a,20306076)}};i.OUtil.loadScript(n,o)},_getServiceEndPoint:function(){return this._serviceEndPoint},_getOmexEndPointPageUrl:function(e,t){return i.OUtil.formatString("{0}/{1}/downloads/{2}.aspx",this._omexEndPointBaseUrl,t,e)},_getManifestAndTargetByConversationId:function(e){for(var t in this._cachedOsfControls){var n=this._cachedOsfControls[t];if(e===n._getConversationId()){var r=n.getStoreType()==i.StoreType.FirstParty?"":n.getMarketplaceVersion();return{manifest:n.getManifest()||i.OsfManifestManager.getCachedManifest(n.getMarketplaceID()),version:r,target:n.getOsfControlType()}}}return null},_createSharePointIFrameProxy:function(e,t){var n=null,r=this;if(r._doesUrlHaveSupportedProtocol(e)){var o=e.length;"/"===e.charAt(o-1)&&(e=e.substr(0,o-1));var a=r._iframeProxies[e];if(a)a.isReady?t(a.clientEndPoint):a.pendingCallbacks.push(t);else{var c=i.OUtil.generateConversationId(),u=document.createElement("iframe");r._iframeProxyCount=r._iframeProxyCount+1;var l=r._iframeNamePrefix+r._iframeProxyCount;u.setAttribute("id",l),u.setAttribute("name",l);var d=e+"/_layouts/15/OfficeExtensionManager.aspx?"+c,f=window.location.origin;d=i.OUtil.addXdmInfoAsHash(d,c+"|"+l+"|"+f),d=i.OUtil.addSerializerVersionAsHash(d,i.SerializerVersion.Browser),d=i.OUtil.addFlightsAsHash(d,JSON.stringify(i.XdmFlights)),i.OUtil.checkFlight(i.FlightNames.CheckReceiverOrigin)&&(d=i.OUtil.addFlightsAsHash(d,JSON.stringify(i.Flights))),u.setAttribute("scrolling","auto"),u.setAttribute("border","0"),u.setAttribute("width","0"),u.setAttribute("height","0"),u.setAttribute("style","position: absolute; left: -100px; top:0px;");var p=r,m=function(t,r){var o,a=p._iframeProxies[e];if(a&&0===t&&r.status?(a.isReady=!0,o=a.clientEndPoint):(delete p._iframeProxies[e],Microsoft.Office.Common.XdmCommunicationManager.getClientEndPoint(c)?(Microsoft.Office.Common.XdmCommunicationManager.deleteClientEndPoint(c),i.OUtil.removeEventListener(u,"load",g),u.parentNode.removeChild(u)):s.RuntimeTelemetryHelper.LogExceptionTag("Unexpected error occured with SharePoint proxy.",n,n,19203550),o=n),a)for(var l=a.pendingCallbacks.length,d=0;d<l;d++){a.pendingCallbacks.shift()(o)}},g=function(){p._iframeProxies[e]&&(p._iframeProxies[e].clientEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(c,u.contentWindow,e),p._iframeProxies[e].clientEndPoint.invoke("OEM_isProxyReady",m,{__timeout__:2e3}))};document.body.appendChild(u),i.OUtil.addEventListener(u,"load",g),u.setAttribute("src",d),r._iframeProxies[e]={clientEndPoint:n,isReady:!1,pendingCallbacks:[t]}}}else t(n)},_getClientVersionForOmex:function(){if(this._appVersion){var e=this._appVersion.split("."),t=parseInt(e[0],10),n=parseInt(e[1],10)||0;if(!(t<=15&&n<=0)){var r=i.Constants.FileVersion.split(".");return t+"."+n+"."+r[2]+"."+r[3]}}},_getClientNameForOmex:function(){return i.OmexClientNames[this._appName]},_getAppVersionForOmex:function(){return i.OmexAppVersions[this._appName]},_setCachedFlag:function(e){var t=i.OUtil.getLocalStorage();t&&t.setItem(e,"true")},_getCachedFlag:function(e){var t=i.OUtil.getLocalStorage();if(t)return!!t.getItem(e)},_deleteCachedFlag:function(e){var t=i.OUtil.getLocalStorage();t&&t.removeItem(e)},_preloadOfficeJs:function(){var e=this;if(!e._hasPreloadedOfficeJs){var t=document.createElement("script");t.src=i.OUtil.formatString("{0}?locale={1}&host={2}&version={3}",i.Constants.PreloadOfficeJsUrl,e._appUILocale,e._appName,e._hostSpecificFileVersion),t.type="text/javascript",t.id=i.Constants.PreloadOfficeJsId,t.onerror=function(){s.RuntimeTelemetryHelper.LogExceptionTag("Failed to connect to preload service.",null,null,19203551)},document.getElementsByTagName("head")[0].appendChild(t),e._hasPreloadedOfficeJs=!0}},_getAuthTypeForHideAppsExtensionUrl:function(){var e=i.OUtil.getQueryStringParamValue(this._hideAppsExtensionUrl,i.OmexPageParameterKeys.AuthType);return e||i.AuthType.Anonymous},isAddinCommandsAsync:function(e,t){var n=null,r=!1;i.OUtil.validateParamObject(e,{marketplaceId:{type:String,mayBeNull:r},marketplaceVersion:{type:String,mayBeNull:r},storeType:{type:String,mayBeNull:r},storeId:{type:String,mayBeNull:r},targetData:{type:Object,mayBeNull:r},clearCache:{type:Boolean,mayBeNull:!0}},n);var o=e.storeType.toLowerCase(),a={contextActivationMgr:n,referenceInUse:n},c=e.clearCache||r;try{a.referenceInUse={id:e.marketplaceId,version:e.marketplaceVersion,storeType:e.storeType,storeLocator:e.storeId},a.contextActivationMgr=this;var u=function(o){o!=n&&o.statusCode==l.DataServiceResultCode.Succeeded&&o.value!=n?t(!0,o.value._isAddinCommandsManifest(i.getManifestHostType(a.contextActivationMgr._hostType)),e):t(r,r,e)};if(i.StoreType.OMEX===o||i.StoreType.UploadFileDevCatalog===o||i.StoreType.SPCatalog===o||i.StoreType.PrivateCatalog===o){var d=l.CatalogFactory.resolve(o),f={assetId:a.referenceInUse.id,storeType:o,storeId:a.referenceInUse.storeLocator,appVersion:a.referenceInUse.version,targetType:n},p=i.OUtil.Guid.generateNewGuid(),m=new l.AddinCommandsTelemetryContext(p);d.getAndCacheManifest(f,f.storeId,m,(function(e){u({statusCode:e.status,value:e.value})}),c)}else t(!0,r,e)}catch(o){s.RuntimeTelemetryHelper.LogExceptionTag("Error for checking is addincommands or not",o,n,19203552),t(r,r,e)}},setOAuthManager:function(e){this._oAuthManager=e},getManifestInvaildErrorString:function(){return Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message},getUserNameHashCode:function(){return this._userNameHashCode},ownerAddinControlRecreated:function(e,t){for(var n in this._cachedOsfControls){var r=this._cachedOsfControls[n];r._ownerAddinAssetId&&r._ownerAddinStoreType&&r._ownerAddinAssetId==e&&r._ownerAddinStoreType==t&&r.setOwnerAddinControlRecreated(!0)}}};var l,d,f=function(){function e(){}return e.hashString=function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t|=0}return t},e.stringToHash=function(t){var n=e.hashString(t),r=n.toString();return r=n<0?"1"+r.substring(1):"0"+r},e.startsWith=function(e,t){return 0==e.indexOf(t)},e.isFileUrl=function(t){return e.startsWith(t.toLowerCase(),"file:")},e.removeHttpPrefix=function(t){var n="";return e.startsWith(t.toLowerCase(),e.httpsPrefix)?n=e.httpsPrefix:e.startsWith(t.toLowerCase(),e.httpPrefix)&&(n=e.httpPrefix),t.slice(n.length)},e.getUrlDomain=function(t){var n=e.removeHttpPrefix(t);return n=(n=n.split("/")[0]).split(":")[0]},e.isIp4Address=function(e){return/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(e)},e.filter=function(t){if(e.isFileUrl(t))return"file://"+(r=e.stringToHash(t));var n=e.getUrlDomain(t);if(e.isIp4Address(n)){var r=e.stringToHash(t);return e.startsWith(n,"10.")?"IP10Range_"+r:e.startsWith(n,"192.")?"IP192Range_"+r:e.startsWith(n,"127.")?"IP127Range_"+r:"IPOther_"+r}return n.split(".").slice(-2).join(".")},e.httpPrefix="http://",e.httpsPrefix="https://",e}();i.OsfControl=function(e){var t=null,n=!0,r=!1,o=this;i.OUtil.validateParamObject(e,{div:{type:Object,mayBeNull:r},contextActivationMgr:{type:Object,mayBeNull:r},id:{type:String,mayBeNull:r},marketplaceID:{type:String,mayBeNull:r},marketplaceVersion:{type:String,mayBeNull:r},store:{type:String,mayBeNull:r},storeType:{type:String,mayBeNull:r},alternateReference:{type:Object,mayBeNull:n},settings:{type:Object,mayBeNull:n},reason:{type:String,mayBeNull:n},osfControlType:{type:Number,mayBeNull:n},snapshotUrl:{type:String,mayBeNull:n},preactivationCallback:{type:Object,mayBeNull:n},virtualOsfControlActivationCallback:{type:Object,mayBeNull:n},isvirtualOsfControl:{type:Boolean,mayBeNull:n},isDialog:{type:Boolean,mayBeNull:n},hostCustomMessage:{type:String,mayBeNull:n},isForUILessAction:{type:Boolean,mayBeNull:n},ownerAddinAssetId:{type:String,mayBeNull:n},sourceLocationOverrideResourceId:{type:String,mayBeNull:n},sourceLocationOverrideUrl:{type:String,mayBeNull:n},ownerAddinStoreType:{type:String,mayBeNull:n},focusOnIframeWhenLoaded:{type:Boolean,mayBeNull:n},featureGates:{type:Object,mayBeNull:n},hostInfoFlags:{type:Number,mayBeNull:n},sharedRuntimeId:{type:String,mayBeNull:n},initialDisplayMode:{type:Number,mayBeNull:n}},t),o._div=e.div,o._sourceLocationOverrideResourceId=e.sourceLocationOverrideResourceId,o._sourceLocationOverrideUrl=e.sourceLocationOverrideUrl,o._contextActivationMgr=e.contextActivationMgr,o._id=e.id,o._storeType=e.storeType.toLowerCase(),o._storeLocator=e.store,o._marketplaceID=e.marketplaceID,o._marketplaceVersion=e.marketplaceVersion,o._alternateReference=e.alternateReference,o._settings=e.settings||{},o._reason=null==e.reason?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:e.reason,o._osfControlType=null==e.osfControlType?i.OsfControlType.DocumentLevel:e.osfControlType,o._snapshotUrl=e.snapshotUrl,o._status=i.OsfControlStatus.NotActivated,o._iframeIsLoaded=r,o._iframeLoadedNotified=r,o._notificationParams=[],o._iframeUrl=t,o._permission=t,o._conversationId=t,o._manifestUrl=t,o._pageStatus=i.OsfControlPageStatus.NotStarted,o._pageIsReadyTimerExpired=r,o._timer=t,o._retryLoadingNum=2,o._frame=t,o._agaveEndPoint=t,o._etoken="",o._sqmDWords=[0,0],o._preactivationCallback=e.preactivationCallback,o._telemetryContext={},o._controlFocus=r,o._agavePageUrl=t,o._agaveWindowName=t,o._manifest=t,o._virtualOsfControlActivationCallback=e.virtualOsfControlActivationCallback,o._isvirtualOsfControl=null==e.isvirtualOsfControl?r:e.isvirtualOsfControl,o._isvirtualOsfControlCallbackInvoked=r,o._isManifestProcessedForCustomFunctions=r,o._isDialog=null==e.isDialog?r:e.isDialog,o._hostCustomMessage=e.hostCustomMessage,o._isUpgrading=r,o._isUpgradingFailed=r,o._focusOnIframeWhenLoaded=null==e.focusOnIframeWhenLoaded?r:e.focusOnIframeWhenLoaded,o._featureGates=e.featureGates||{},o._hostInfoFlags="number"==typeof e.hostInfoFlags?e.hostInfoFlags:0,o._sharedRuntimeId=null==e.sharedRuntimeId?t:e.sharedRuntimeId,o._initialDisplayMode=null==e.initialDisplayMode?0:e.initialDisplayMode,o._appContextIsSetToIframeName=r,o._sdxTelemetryContext={},o._contextActivationMgr._enableServiceDeliveredExperience&&(o._bundleUrl=t,o._sdxIframeTemplateUrl="https://osf-agave/rtm/sdx/index.html"),o._isUILessAddInCommands=!!e.isForUILessAction,o._ownerAddinAssetId=e.ownerAddinAssetId?e.ownerAddinAssetId:t,o._ownerAddinStoreType=e.ownerAddinStoreType?e.ownerAddinStoreType:t,i.OUtil.isiOS()&&(o._div.style.webkitOverflowScrolling="touch",o._div.style.overflow="auto"),o._appCorrelationId=o._contextActivationMgr._contextMgrCorrelationId||i.OUtil.Guid.generateNewGuid(),o._iframeOnLoadDelegate=Function.createDelegate(o,o._iframeOnLoad),o._retryActivate=t,o._onKeyDownEventDelegate=Function.createDelegate(o,o._onKeydownEvent),o._ownerAddinControlRecreated=r},i.OsfControl.prototype={activate:function(e){var t=null,n=this,r=n;try{var o,a="",c="";if(n._contextActivationMgr._wopiHostOriginFromPostMessage){var u=document.createElement("a");u.href=n._contextActivationMgr._wopiHostOriginFromPostMessage,a=u.protocol+"//"+f.filter(u.hostname),a=""==u.port?a:a+":"+u.port}if(n._contextActivationMgr._wopiHostOriginFromWacPropBag){var l=document.createElement("a");l.href=n._contextActivationMgr._wopiHostOriginFromWacPropBag,c=l.protocol+"//"+f.filter(l.hostname),c=""==l.port?c:c+":"+l.port}o=a==c;var d=window.top==window.parent;if("undefined"!=typeof JSON){var p={},m={};try{p=JSON.parse(n._contextActivationMgr._sessionStartInfoJson),m.wacHost=p.Host,m.wacHostDatacenterHint=p.HostDatacenterHint,m.wacApplicationMode=p.ApplicationMode,m.wacIsAnonymousUser=p.IsAnonymousUser}catch(e){}m.isWopiTopMatch=d,m.isWopiHostPostOriginMatch=o,m.correlationId=n._contextActivationMgr._contextMgrCorrelationId,m.hostType=n._contextActivationMgr._hostType,m.hostPlatform=n._contextActivationMgr._hostPlatform,m.storeType=n._storeType,m.assetId=n._marketplaceID,m.wacIsEmbedded=n._contextActivationMgr._wacIsEmbedded,m.urlFromPostMessage=a,m.urlFromWacPropBag=c,s.RuntimeTelemetryHelper.LogCommonMessageTag("WAC host check :"+JSON.stringify(m),n._contextActivationMgr._contextMgrCorrelationId,42779916)}}catch(e){s.RuntimeTelemetryHelper.LogExceptionTag("WAC host check exception",e,n.getCorrelationId(),42779917)}if(n._status!==i.OsfControlStatus.Activated)if(n._contextActivationMgr.registerOsfControl(n),i.OUtil.addEventListener(n._div,"keydown",n._onKeyDownEventDelegate),(e=e||{}).hostType=n._contextActivationMgr._hostType,e.osfControl=e.osfControl||n,e.referenceInUse=e.referenceInUse||{id:n._marketplaceID,version:n._marketplaceVersion,storeType:n._storeType,storeLocator:n._storeLocator},e.correlationId=e.osfControl._appCorrelationId,e.isInsertOsfControl=!!e.isInsertOsfControl&&e.isInsertOsfControl,1==e.isInsertOsfControl){if(!n._contextActivationMgr._hostAllowedSdxEmbedding||n._checkWopiHost(n._contextActivationMgr._enableWopiHostCheck))return void n.invokePreactivationCompletedCallback();n._contextActivationMgr._enableMyOrg&&n._contextActivationMgr._spBaseUrl!=t&&n._contextActivationMgr._wacUpn==t&&s.RuntimeTelemetryHelper.LogCommonMessageTag("WAC UPN in Sharepoint is null, assetID:"+n._marketplaceID,n._contextActivationMgr._contextMgrCorrelationId,592852928),n._contextActivationMgr._enableUpnCheck&&n._contextActivationMgr._enableMyOrg&&n._contextActivationMgr._spBaseUrl!=t?n.checkUpnInSPO(n._contextActivationMgr._wacUpn,(function(n){n?r.activateInternal(e):(r._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_UntrustedHost_Error_ERR,t,t,t,t,t,t,i.ErrorStatusCodes.WAC_WopiHostCheckStatusNotTrusted),r.invokePreactivationCompletedCallback())})):n.activateInternal(e)}else n.activateInternal(e);else n.invokePreactivationCompletedCallback()},activateInternal:function(e){var t=!0,n=null,r=this,o=r;try{if(!r._doesBrowserSupportRequiredFeatures())return r._contextActivationMgr._enableFirstPartySDXErrorMessages&&r.isFirstParty()?r._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveUnsupportedBroswer_ERR_FirstParty,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(r,r._refresh),n,n,n,t,i.ErrorStatusCodes.E_BROWSER_VERSION):r._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveUnsupportedBroswer_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(r,r._refresh),n,n,n,t,i.ErrorStatusCodes.E_BROWSER_VERSION),void r.invokePreactivationCompletedCallback();var a=document.createElement("iframe"),c="sandbox"in a;a=n;var u=!1,d=i.OUtil.getLocalStorage();if(d&&(u=d.getItem(i.Constants.IgnoreSandBoxSupport)),r._contextActivationMgr._autoTrusted&&!c&&!u)return r._contextActivationMgr._ErrorUXHelper.removeProgressDiv(r._div,r._id),r._status=i.OsfControlStatus.NotSandBoxSupported,r._contextActivationMgr._enableFirstPartySDXErrorMessages&&r.isFirstParty()?r._contextActivationMgr.displayNotification({id:r._id,infoType:i.InfoType.Warning,title:Strings.OsfRuntime.L_AppsDisabled_WRN_FirstParty,description:Strings.OsfRuntime.L_NotSandBoxSupported_ERR_FirstParty,icon:n,buttonTxt:Strings.OsfRuntime.L_EnableAppsButton_TXT_FirstParty,buttonCallback:Function.createCallback(r._activateAgavesBlockedBySandboxNotSupport,r._contextActivationMgr),url:i.Constants.IEUpgradeUrl,urlButtonTxt:Strings.OsfRuntime.L_UpgradeBrowserButton_TXT,dismissCallback:n,reDisplay:t,displayDeactive:t,errorCode:i.ErrorStatusCodes.WAC_HTML5IframeSandboxNotSupport,highPriority:t}):r._contextActivationMgr.displayNotification({id:r._id,infoType:i.InfoType.Warning,title:Strings.OsfRuntime.L_AppsDisabled_WRN,description:Strings.OsfRuntime.L_NotSandBoxSupported_ERR,icon:n,buttonTxt:Strings.OsfRuntime.L_EnableAppsButton_TXT,buttonCallback:Function.createCallback(r._activateAgavesBlockedBySandboxNotSupport,r._contextActivationMgr),url:i.Constants.IEUpgradeUrl,urlButtonTxt:Strings.OsfRuntime.L_UpgradeBrowserButton_TXT,dismissCallback:n,reDisplay:t,displayDeactive:t,errorCode:i.ErrorStatusCodes.WAC_HTML5IframeSandboxNotSupport,highPriority:t}),void r.invokePreactivationCompletedCallback();r.startActivate();var f=r,p=e.referenceInUse;if(p.storeType===i.StoreType.OMEX||p.storeType===i.StoreType.UploadFileDevCatalog||p.storeType===i.StoreType.SPCatalog||p.storeType===i.StoreType.PrivateCatalog||p.storeType===i.StoreType.FirstParty||p.storeType===i.StoreType.Sdx){var m=new l.OsfControlLoader(r,e.hasConsent),g=new l.ActivationTelemetryContext(r.getCorrelationId(),r._telemetryContext,r._sqmDWords[0],r._sqmDWords[1],r._id);if(p.storeType===i.StoreType.Sdx){if(p.id.toLowerCase()===i.SdxAssetIds.ExperimentationSdx){var h=r._contextActivationMgr._flightingTreatmentVariables["Microsoft.Office.OEP.FA000000059.SourceLocationOverrideResourceId"];h!=n&&(r._sourceLocationOverrideResourceId=h),r._sdxTelemetryContext.sourceLocationOverrideResourceId=r._sourceLocationOverrideResourceId}l.SDXCatalog.activateAsync({assetId:p.id,storeId:p.storeLocator,appVersion:p.version,storeType:p.storeType,targetType:""},m,g,r._contextActivationMgr.getRequirementsChecker(),{clientId:r._contextActivationMgr._loggableUserId,sessionStartInfoJson:r._contextActivationMgr._sessionStartInfoJson},r._sdxTelemetryContext)}else{var v=e.noTargetType||e.osfControl.getOsfControlType()===i.OsfControlTarget.TaskPane?n:e.osfControl.getOsfControlType();l.CatalogFactory.resolve(p.storeType).activateAsync({assetId:p.id,storeId:p.storeLocator,appVersion:p.version,storeType:p.storeType,targetType:p.storeType===i.StoreType.SPCatalog?v:""},m,g)}return void r.invokePreactivationCompletedCallback()}if("1B4CD97F-DBFE-4C1A-B4C4-FC163B4F9693"===p.id&&s.RuntimeTelemetryHelper.LogCommonMessageTag("ONO_Onboarding_CorrelationId :"+r.getCorrelationId(),n,23381916),s.AppLoadTimeHelper.ActivationStart(r._telemetryContext,r._sqmDWords[0],r._sqmDWords[1],r.getCorrelationId(),r._id,i.ActivationTypes.V2Enabled),s.AppLoadTimeHelper.ServerCallStart(r._telemetryContext),p.storeType===i.StoreType.Exchange||p.storeType===i.StoreType.InMemory)i.OsfManifestManager.getManifestAsync(e,(function(e){e.statusCode===i.ProxyCallStatusCode.Succeeded&&e.value&&!o._etoken&&(o._etoken=e.value.getInMemoryEToken()||""),o._onGetManifestCompleted(e)}));else if(p.storeType===i.StoreType.Registry&&r._contextActivationMgr._enableDevCatalog||p.storeType===i.StoreType.HardCodedPreinstall)if(e.osfControl.getReason()==Microsoft.Office.WebExtension.InitializationReason.DocumentOpened||p.storeType===i.StoreType.Registry&&r._contextActivationMgr._enableDevCatalog&&!i.OsfManifestManager.hasManifestForControl(e)){i.OUtil.xhrGet(r._contextActivationMgr._devCatalogUrl+"/"+p.id+".xml",(function(t){var r=new i.Manifest.Manifest(t,f._contextActivationMgr.getAppUILocale());if(e.osfControl!=n&&e.osfControl._sharedRuntimeId!=n&&e.osfControl._sharedRuntimeId.length>0){var o=i.OsfManifestManager.getSharedRuntimeManifestCacheKey(e.osfControl._marketplaceID,e.osfControl._sharedRuntimeId);!i.OsfManifestManager.hasManifest(o,e.osfControl._marketplaceVersion)&&i.OsfManifestManager.cacheManifest(o,e.osfControl._marketplaceVersion,r)}!i.OsfManifestManager.hasManifest(r.getMarketplaceID(),r.getMarketplaceVersion())&&i.OsfManifestManager.cacheManifest(r.getMarketplaceID(),r.getMarketplaceVersion(),r),i.OsfManifestManager.getManifestAsync(e,Function.createDelegate(f,f._onGetManifestCompleted))}),(function(e){alert("Error when requesting manifest file: "+e)}))}else{if(e.osfControl!=n&&e.osfControl._sharedRuntimeId!=n&&e.osfControl._sharedRuntimeId.length>0){var y=i.OsfManifestManager.getSharedRuntimeManifestCacheKey(e.osfControl._marketplaceID,e.osfControl._sharedRuntimeId);if(!i.OsfManifestManager.hasManifest(y,e.osfControl._marketplaceVersion)){var b=i.OsfManifestManager.getCachedManifest(e.osfControl._marketplaceID,e.osfControl._marketplaceVersion);i.OsfManifestManager.cacheManifest(y,e.osfControl._marketplaceVersion,b)}}i.OsfManifestManager.getManifestAsync(e,Function.createDelegate(r,r._onGetManifestCompleted))}else if(p.storeType===i.StoreType.OneDrive&&r._contextActivationMgr._enableOneDriveCatalog){var _=function(t){var n=new i.Manifest.Manifest(t,f._contextActivationMgr.getAppUILocale());i.OsfManifestManager.cacheManifest(p.id,n.getMarketplaceVersion(),n),i.OsfManifestManager.getManifestAsync(e,Function.createDelegate(f,f._onGetManifestCompleted))},S=function(){f._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(f,f._refresh),n,n,n,n,i.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)},C=window.location.protocol+"//"+window.location.host;i.OneDriveOAuth.setHostCallbackUri(C);var O=r._contextActivationMgr._oneDriveCatalogBaseApiUrl+"/root:/Manifests/"+p.id+":/content?access_token=";i.OneDriveOAuth.getAccessToken((function(e){O+=e,i.OUtil.xhrGet(O,_,S)}),(function(){f._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(f,f._refresh),n,n,n,n,i.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)}))}else p.storeType===i.StoreType.SPApp?(s.AppLoadTimeHelper.EntitlementCheckStart(r._telemetryContext),e.baseUrl=r._contextActivationMgr.getPageBaseUrl(),e.pageUrl=r._contextActivationMgr._docUrl,e.webUrl=r._contextActivationMgr._webUrl,e.appWebUrl=r._contextActivationMgr._webUrl,i.OsfManifestManager.getSPAppEntitlementsAsync(e,Function.createDelegate(r,r._onGetEntitlementsCompleted))):p.storeType===i.StoreType.FileSystem||p.storeType===i.StoreType.Registry||p.storeType===i.StoreType.HardCodedPreinstall?r._showActivationWarning(i.OsfControlStatus.UnsupportedStore,Strings.OsfRuntime.L_AgaveUnsupportedStoreType_ERR,n,n,n,n,i.ErrorStatusCodes.WAC_AgaveUnsupportedStoreType):p.storeType===i.StoreType.OneDrive?r._showActivationWarning(i.OsfControlStatus.UnsupportedStore,Strings.OsfRuntime.L_AgaveUnsupportedStoreType_ERR,n,n,n,n,i.ErrorStatusCodes.WAC_AgaveUnsupportedStoreType):r._showActivationError(i.OsfControlStatus.UnknownStore,Strings.OsfRuntime.L_AgaveUnknownStoreType_ERR,n,n,n,n,n,n,i.ErrorStatusCodes.E_MANIFEST_REFERENCE_INVALID)}catch(e){var A="Error getting app data.";l.WACUtils.logExceptionToBrowserConsole(A,e),s.RuntimeTelemetryHelper.LogExceptionTag(A,e,r.getCorrelationId(),18420419),r._contextActivationMgr._enableFirstPartySDXErrorMessages&&r.isFirstParty()?r._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR_FirstParty,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(r,r._refresh),n,n,n,n,i.ErrorStatusCodes.WAC_AgaveOsfControlActivationError):r._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(r,r._refresh),n,n,n,n,i.ErrorStatusCodes.WAC_AgaveOsfControlActivationError)}r.invokePreactivationCompletedCallback()},createIframeForDialogControl:function(e,t,n){for(var r=this;r._div.childNodes.length>0;)r._div.removeChild(r._div.childNodes.item(0));var o=r._createIframeForControl(e);r._iframeUrl=t,r._appDomains=n,r._setIframeAttribute(o,t),r._div.appendChild(o),r._contextActivationMgr.registerOsfControl(r)},deActivate:function(){var e=null,t=this;try{if(i.OUtil.writeProfilerMark(i.OsfControlActivationPerfMarker.DeactivationStart),t._contextActivationMgr.dismissMessages(t._id),t._retryActivate=e,t._status!==i.OsfControlStatus.NotActivated){for(t._agaveEndPoint&&(Microsoft.Office.Common.XdmCommunicationManager.deleteClientEndPoint(t._agaveEndPoint._conversationId),t._agaveEndPoint=e),t._frame&&(i.OUtil.removeEventListener(t._frame,"load",t._iframeOnLoadDelegate),t._frame=e),t._timer&&(window.clearTimeout(t._timer),t._timer=e);t._div.childNodes.length>0;)t._div.removeChild(t._div.childNodes.item(0));t._status=i.OsfControlStatus.NotActivated,t._conversationId&&t._contextActivationMgr._getServiceEndPoint().unregisterConversation(t._conversationId),t._contextActivationMgr.raiseOsfControlStatusChange(t)}t._controlFocus=!1,i.OUtil.removeEventListener(t._div,"keydown",t._onKeyDownEventDelegate),t._iframeIsLoaded=!1,t._iframeLoadedNotified=!1,i.OUtil.writeProfilerMark(i.OsfControlActivationPerfMarker.DeactivationEnd)}catch(e){var n="Deactivate failed.";l.WACUtils.logExceptionToBrowserConsole(n,e),s.RuntimeTelemetryHelper.LogExceptionTag(n,e,t.getCorrelationId(),18420420)}},startActivate:function(){var e=this;for(e._controlFocus=!0,e._pageStatus=i.OsfControlPageStatus.Loading,e._sdxTelemetryContext={activationStart:performance.now(),performanceTimestampOrigin:Date.now()-performance.now(),osfControlId:e._id},i.OUtil.writeProfilerMark(i.OsfControlActivationPerfMarker.ActivationStart),e._frame&&(i.OUtil.removeEventListener(e._frame,"load",e._iframeOnLoadDelegate),e._frame=null);e._div.childNodes.length>0;)e._div.removeChild(e._div.childNodes.item(0));e._contextActivationMgr._ErrorUXHelper.showProgress(e._div,e._id)},refresh:function(){this._refresh()},_restartActivate:function(){this.deActivate(),this.startActivate(),this.invokePreactivationCompletedCallback()},purge:function(e){var t=this,n=Function._validateParams(arguments,[{name:"purgeManifest",type:Boolean,mayBeNull:!1}]);if(n)throw n;try{t._contextActivationMgr._ErrorUXHelper.purgeOsfControlNotification(t._id),t.deActivate(),e&&i.OsfManifestManager.purgeManifest(t._marketplaceID,t._marketplaceVersion),t._contextActivationMgr.unregisterOsfControl(t)}catch(e){var r="Purge failed.";l.WACUtils.logExceptionToBrowserConsole(r,e),s.RuntimeTelemetryHelper.LogExceptionTag(r,e,t.getCorrelationId(),18420421)}},invokeVirtualOsfControlActivationCallback:function(e){var t=this;try{t._virtualOsfControlActivationCallback&&(t._virtualOsfControlActivationCallback(t,e),t._isvirtualOsfControlCallbackInvoked=!0)}catch(e){var n="invokeVirtualOsfControlActivationCallback failed.";l.WACUtils.logExceptionToBrowserConsole(n,e),s.RuntimeTelemetryHelper.LogExceptionTag(n,e,t.getCorrelationId(),36496280)}},ensureToGetVirtualOsfControlManifest:function(e){var t=null,n=this,r=n;if(n._manifest)e(n._manifest);else{var o={assetId:n._marketplaceID,appVersion:n._marketplaceVersion,storeType:n._storeType,storeId:n._storeLocator,targetType:t},a=function(n){var o=t;n.status===l.DataServiceResultCode.Succeeded&&n.value?o=n.value:r._status=i.OsfControlStatus.ActivationFailed,e(o)},s=l.CatalogFactory.resolve(o.storeType);s!=t?s.getAndCacheManifest(o,n._storeLocator,new l.AddinCommandsTelemetryContext(n.getCorrelationId()),a):(alert("AddinCommands is not supported in "+o.storeType+" store."),a({status:l.DataServiceResultCode.Failed,value:t}))}},checkUpnInSPO:function(e,t){var n="wacUpn is null.",r=null,o=this,a=function(e){var n=!0;l.WACUtils.logExceptionToBrowserConsole("Check UPN result: "+e.value,r),e.status===l.DataServiceResultCode.Succeeded?n=e.value:s.RuntimeTelemetryHelper.LogCommonMessageTag("Upn Check failed.",o._contextActivationMgr._contextMgrCorrelationId,592852899),t(n)},c=l.CatalogFactory.resolve(i.StoreType.SPCatalog);c!=r&&e!=r?c.isUpnMatchAsync(e,new l.SimpleTelemetryContext,a):(e==r&&(l.WACUtils.logExceptionToBrowserConsole(n,r),s.RuntimeTelemetryHelper.LogCommonMessageTag(n,this._contextActivationMgr._contextMgrCorrelationId,592852898)),a({status:l.DataServiceResultCode.Failed,value:!1}))},invokePreactivationCompletedCallback:function(){this._preactivationCallback&&this._preactivationCallback()},getMarketplaceID:function(){return this._marketplaceID},getMarketplaceVersion:function(){return this._marketplaceVersion},getContainingDiv:function(){return this._div},getID:function(){return this._id},getSettings:function(){return this._settings},setSettings:function(e){this._settings=e},getReason:function(){return this._reason},getManifest:function(){return this._manifest},getOsfControlType:function(){return this._osfControlType},getSharedRuntimeId:function(){return this._sharedRuntimeId},getSnapshotUrl:function(){return this._snapshotUrl},getStoreType:function(){return this._storeType},isFirstParty:function(){return this._storeType&&(this._storeType===i.StoreType.FirstParty||this._storeType===i.StoreType.Sdx)},hostInfoFlags:function(){return this._hostInfoFlags},updateAgaveEndPointTargetUrl:function(e){var t=this;t._contextActivationMgr._enableSetAppContextInIframeName&&t.ensureAgaveEndPoint(),t._agaveEndPoint&&(t._agaveEndPoint._targetUrl=e)},getStoreLocator:function(){return this._storeLocator},getHostCustomMessage:function(){return this._hostCustomMessage},getProperty:function(e){var t=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1}]);if(t)throw t;return this._settings[e]},addProperty:function(e,t){var n=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1},{name:"value",type:String,mayBeNull:!1}]);if(n)throw n;this._settings[e]=t},removeProperty:function(e){var t=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1}]);if(t)throw t;delete this._settings[e]},getStatus:function(){return this._status},getPageStatus:function(){return this._pageStatus},checkAppDomains:function(e){var t=Microsoft.Office.Common.XdmCommunicationManager.checkUrlWithAppDomains(this._appDomains,e);return t||this.isTargetSubdomainOfSourceLocation(e)},isTargetSubdomainOfSourceLocation:function(e){return Microsoft.Office.Common.XdmCommunicationManager.isTargetSubdomainOfSourceLocation(this._agavePageUrl,e)},getNotificationParams:function(){return this._notificationParams},removeFirstNotification:function(){this._notificationParams.shift()},getIframeUrl:function(){return this._iframeUrl},getPermission:function(){return this._permission},getTrustNoPrompt:function(){return!1},getEToken:function(){return this._etoken},getCorrelationId:function(){return this._appCorrelationId},getAgavePageUrl:function(){return this._agavePageUrl},getAgaveWindowName:function(){return this._agaveWindowName},notifyAgave:function(e,t){this._agaveEndPoint&&this._agaveEndPoint.invoke("Office_notifyAgave",null,[e,t])},sendMessageToSdx:function(e,t){this._agaveEndPoint&&this._agaveEndPoint.invoke("Office_sendMessageToSdx",t,e)},isUILessAddInCommands:function(){return this._isUILessAddInCommands},getOwnerAddinAssetId:function(){return this._ownerAddinAssetId},getOwnerAddinStoreType:function(){return this._ownerAddinStoreType},getFeatureGates:function(){return this._featureGates},getOwnerAddinControlRecreated:function(){return this._ownerAddinControlRecreated},setOwnerAddinControlRecreated:function(e){this._ownerAddinControlRecreated=e},_onKeydownEvent:function(e){var t="input, button, a",n=this;if(e.preventDefault=e.preventDefault||function(){e.returnValue=!1},117==e.keyCode&&(e.ctrlKey||e.metaKey)){e.preventDefault(),e.stopPropagation();var r=i.AgaveHostAction.CtrlF6Exit;e.shiftKey&&(r=i.AgaveHostAction.CtrlF6ExitShift),n._contextActivationMgr._notifyHost(n._id,r)}else if(9==e.keyCode){e.preventDefault(),e.stopPropagation();var o=n._div.querySelectorAll(t);if(0==o.length)return;i.OUtil.focusToNextTabbable(o,e.target||e.srcElement,e.shiftKey)||(e.shiftKey?n._contextActivationMgr._notifyHost(n._id,i.AgaveHostAction.TabExitShift):n._agaveEndPoint?n.notifyAgave(i.AgaveHostAction.TabIn):n._contextActivationMgr._notifyHost(n._id,i.AgaveHostAction.TabExit))}else if(27==e.keyCode)e.preventDefault(),n._contextActivationMgr._notifyHost(n._id,i.AgaveHostAction.EscExit);else if(113==e.keyCode)e.preventDefault(),n._contextActivationMgr._notifyHost(n._id,i.AgaveHostAction.F2Exit);else if(13==e.keyCode||32==e.keyCode)for(var a=n._div.querySelectorAll(t),s=0;s<a.length;s++){var c=e.target||e.srcElement;if(a[s]===c)return e.preventDefault(),e.stopPropagation(),void c.click()}else e.preventDefault(),e.stopPropagation()},_onGetEntitlementsCompleted:function(e){var t=null,n=this;if(e.statusCode===i.ProxyCallStatusCode.Succeeded&&e.value){s.AppLoadTimeHelper.EntitlementCheckEnd(n._telemetryContext);for(var r,o=e.context.referenceInUse,a=e.value.entitlements,c=a.length,u=t,l=0;l<c;l++)(r=a[l]).OfficeExtensionID&&o.id&&r.OfficeExtensionID.toLowerCase()===o.id.toLowerCase()&&(u&&!n._lessThan(u.OfficeExtensionVersion,r.OfficeExtensionVersion)||(u=r));(r=u)?r.OfficeExtensionKillbit?n._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveDisabledByAdmin_ERR,t,t,t,t,t,t,i.ErrorStatusCodes.E_OEM_EXTENSION_KILLED):(e.context.manifestUrl=r.EncodedAbsUrl,e.context.appInstanceId=r.AppInstanceID,e.context.productId=r.ProductID,e.context.appInstanceId?i.OsfManifestManager.getAppInstanceInfoByIdAsync(e.context,Function.createDelegate(n,n._onGetAppInstanceInfoByIdCompleted)):i.OsfManifestManager.getManifestAsync(e.context,Function.createDelegate(n,n._onGetManifestCompleted))):n._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveNotExist_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createCallback((function(e){e.osfControl._refresh(e)}),{clearCache:!0,referenceInUse:e.context.referenceInUse,osfControl:e.context.osfControl}),t,t,t,t,i.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST)}else n._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(n,n._refresh),t,t,t,t,i.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)},_onGetAppInstanceInfoByIdCompleted:function(e){var t=null,n=this;if(e.statusCode===i.ProxyCallStatusCode.Succeeded&&e.value){var r=e.value,o=e.context;r.AppWebFullUrl&&(o.appWebUrl=r.AppWebFullUrl),o.clientId=r.AppPrincipalId,o.remoteAppUrl=r.RemoteAppUrl,o.appWebUrl&&o.productId?i.OsfManifestManager.getSPTokenByProductIdAsync(o,Function.createDelegate(n,n._onGetSPTokenByProductIdCompleted)):i.OsfManifestManager.getManifestAsync(o,Function.createDelegate(n,n._onGetManifestCompleted))}else n._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(n,n._refresh),t,t,t,t,i.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)},_onGetSPTokenByProductIdCompleted:function(e){e.statusCode===i.ProxyCallStatusCode.Succeeded&&e.value&&(this._etoken=e.value),i.OsfManifestManager.getManifestAsync(e.context,Function.createDelegate(this,this._onGetManifestCompleted))},_retryActivation:function(){var e=this;e._retryLoadingNum--,e._pageStatus===i.OsfControlPageStatus.Ready||e._retryLoadingNum<=0?(e._contextActivationMgr._ErrorUXHelper.removeProgressDiv(e._div,e._id),e._retryLoadingNum=2):e._refresh()},_iframeOnLoad:function(){var e=this,t=e;e._iframeIsLoaded=!0,e._appContextIsSetToIframeName&&t._contextActivationMgr._ErrorUXHelper&&(t._contextActivationMgr._ErrorUXHelper.removeProgressDiv(t._div,t._id),t._pageStatus=i.OsfControlPageStatus.Ready,t._focusOnIframeWhenLoaded&&t._frame&&t._frame.contentWindow&&t._frame.contentWindow.focus(),t.ensureAgaveEndPoint()),s.AppLoadTimeHelper.PageLoaded(e._telemetryContext);t._pageStatus!==i.OsfControlPageStatus.Ready?t._timer=window.setTimeout((function(){!function(e){var t=null;if(e){if(e._contextActivationMgr._ErrorUXHelper&&(i.OUtil.writeProfilerMark(i.OsfControlActivationPerfMarker.SelectionTimeout),e._contextActivationMgr._ErrorUXHelper.removeProgressDiv(e._div,e._id)),e._pageStatus!==i.OsfControlPageStatus.Ready){if(2===e._retryLoadingNum){var n=i.ErrorStatusCodes.WAC_AgaveActivationError;switch(e._pageStatus){case i.OsfControlPageStatus.FailedOriginCheck:n=i.ErrorStatusCodes.WAC_AgaveOriginCheckError;break;case i.OsfControlPageStatus.FailedPermissionCheck:n=i.ErrorStatusCodes.WAC_AgavePermissionCheckError;break;case i.OsfControlPageStatus.FailedHandleRequest:n=i.ErrorStatusCodes.WAC_AgaveHostHandleRequestError}if(e._contextActivationMgr._enableFirstPartySDXErrorMessages&&e.isFirstParty()){var r="Timeout loading contents in iframe. Error: "+n;e._storeType.toLowerCase()==i.StoreType.FirstParty.toLowerCase()?l.FirstPartyCatalog.LogFirstPartyCatalogMonitoringError(r,e._marketplaceID):e._storeType.toLowerCase()==i.StoreType.Sdx.toLowerCase()&&l.SDXCatalog.LogSDXCatalogMonitoringError(r,e._marketplaceID),e._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveActivationError_ERR_FirstParty,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(e,e._retryActivation),t,t,t,t,n)}else e._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveActivationError_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(e,e._retryActivation),t,t,t,t,n)}else if(1===e._retryLoadingNum)if(e._contextActivationMgr._enableFirstPartySDXErrorMessages&&e.isFirstParty()){r="User retry failed to load contents in iframe.";e._storeType.toLowerCase()==i.StoreType.FirstParty.toLowerCase()?l.FirstPartyCatalog.LogFirstPartyCatalogMonitoringError(r,e._marketplaceID):e._storeType.toLowerCase()==i.StoreType.Sdx.toLowerCase()&&l.SDXCatalog.LogSDXCatalogMonitoringError(r,e._marketplaceID),e._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_ActivateAttempLoading_ERR_FirstParty,Strings.OsfRuntime.L_ActivateButton_TXT,Function.createDelegate(e,e._retryActivation),t,t,t,t,i.ErrorStatusCodes.WAC_ActivateAttempLoading)}else e._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_ActivateAttempLoading_ERR,Strings.OsfRuntime.L_ActivateButton_TXT,Function.createDelegate(e,e._retryActivation),t,t,t,t,i.ErrorStatusCodes.WAC_ActivateAttempLoading)}else e._notifyHostIFrameOnLoaded();e._timer&&(window.clearTimeout(e._timer),e._timer=t),e._pageIsReadyTimerExpired=!0}}(t)}),5e3*t._retryLoadingNum+1):t._notifyHostIFrameOnLoaded()},_checkWopiHost:function(e){var t=null,n=this,r=!1,o=n;if(e)if(o._contextActivationMgr._isHostFrameTrusted===i.HostFrameTrustState.NotTrusted||o._contextActivationMgr._isHostFrameTrusted===i.HostFrameTrustState.NotImplemented)o._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_UntrustedHost_Error_ERR,t,t,t,t,t,t,i.ErrorStatusCodes.WAC_WopiHostCheckStatusNotTrusted),r=!0;else if(n._contextActivationMgr._isHostFrameTrusted===i.HostFrameTrustState.NotReady){i.ErrorStatusCodes.WAC_WopiHostCheckStatusNotReady;o._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_UnknownHost_Error_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(o,o._refresh),t,t,t,t,i.ErrorStatusCodes.WAC_WopiHostCheckStatusNotReady),r=!0}return s.RuntimeTelemetryHelper.LogCommonMessageTag("CheckWopiHost IsHostFrameTrusted Value:"+n._contextActivationMgr._isHostFrameTrusted,n._contextActivationMgr._contextMgrCorrelationId,595354007),r},_isOsfControlInEmbeddingMode:function(e){var t=!1;try{t=null!=e.getContainingDiv().parentNode.parentNode.id.match(/^(m_excelEmbedRenderer_|ewaSynd).+$/gi)}catch(e){l.WACUtils.logExceptionToBrowserConsole("_isOsfControlInEmbeddingMode error.",e)}return t},_createIframeAndActivateOsfControl:function(e){var t=this;s.RuntimeTelemetryHelper.LogCommonMessageTag("IFrame Created"+t._iframeUrl,t._contextActivationMgr._contextMgrCorrelationId,594356319);var n=t._createIframeForControl(e);t._activate(n,t._iframeUrl)},_createIframeForControl:function(e){var t,n=this,r=document.createElement("iframe");for(var o in r.setAttribute("id",n._id),r.setAttribute("width","100%"),r.setAttribute("height","100%"),r.setAttribute("frameborder","0"),r.setAttribute("allowfullscreen","true"),t=n._contextActivationMgr._enableFirstPartySDXErrorMessages&&n.isFirstParty()?e:Strings.OsfRuntime.L_IframeTitle_TXT+" "+e,r.setAttribute("title",t),r.style.msUserSelect="element",n._setSandboxAttribute(r),n._contextActivationMgr._iframeAttributeBag)r.setAttribute(o,n._contextActivationMgr._iframeAttributeBag[o]);return n._frame=r,r},_setSandboxAttribute:function(e){e.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-popups-to-escape-sandbox allow-modals allow-downloads");var t="geolocation;camera";this._contextActivationMgr._disableMicrophonePermission||(t+=";microphone"),this._contextActivationMgr._accessibilityAllowFocusAddinTaskpane&&(t+=";focus-without-user-activation *"),e.setAttribute("allow",t)},_onGetManifestCompleted:function(e){var t=null,n=this;if(e.statusCode===i.ProxyCallStatusCode.Succeeded&&e.value){s.AppLoadTimeHelper.ManifestRequestEnd(n._telemetryContext),s.AppLoadTimeHelper.ServerCallEnd(n._telemetryContext);var r=e.value,o=e.context,a=o.referenceInUse,c=a.storeType,u=r.getDefaultDisplayName();if(n._manifest=r,o.manifestCached&&!o.retried){var d=r.getMarketplaceVersion();if(n._lessThan(d,a.version)&&c===i.StoreType.SPApp)return void n._refresh({clearCache:!0,referenceInUse:a,osfControl:o.osfControl,retried:!0})}if(!1===r.requirementsSupported||void 0===r.requirementsSupported&&!n._contextActivationMgr.getRequirementsChecker().isManifestSupported(r)){r.requirementsSupported=!1;var f,p;return f=Strings.OsfRuntime.L_AgaveManifestRequirementsError_ERR||Strings.OsfRuntime.L_AgaveManifestError_ERR,p=i.ErrorStatusCodes.WAC_AgaveRequirementsError,void n._showActivationError(i.OsfControlStatus.ActivationFailed,f,t,t,null,t,t,!0,p)}if(r.requirementsSupported=!0,n._iframeUrl=r.getDefaultSourceLocation(n._contextActivationMgr.getFormFactor()),n._iframeUrl&&n.updateUrlsForSdx(),n._permission=r.getPermission(),n._appDomains=r.getAppDomains(),c===i.StoreType.SPApp&&n._iframeUrl&&(o.clientId&&(n._iframeUrl=n._iframeUrl.replace(/~clientid/gi,o.clientId)),o.appWebUrl&&(n._iframeUrl=n._iframeUrl.replace(/~appweburl/gi,o.appWebUrl)),o.remoteAppUrl&&(n._iframeUrl=n._iframeUrl.replace(/~remoteappurl/gi,o.remoteAppUrl))),!n._contextActivationMgr._doesUrlHaveSupportedProtocol(n._iframeUrl))return void n._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveManifestError_ERR,t,t,t,t,t,t,i.ErrorStatusCodes.E_MANIFEST_INVALID_VALUE_FORMAT);n.processManifestForCustomFunctions(r),r.getExtendedOverridesUrl()&&n.downloadExtendedOverride(r),n._isvirtualOsfControl?!o.showNewerVersion&&n.invokeVirtualOsfControlActivationCallback(r):n._createIframeAndActivateOsfControl(u)}else s.RuntimeTelemetryHelper.LogExceptionTag("GetManifest failed:"+l.WACUtils.serializeObjectToString(e),t,t,18420422),n._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(n,n._refresh),t,t,t,t,i.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)},downloadExtendedOverride:function(e){var t=this,n=t;try{var r={platform:t._contextActivationMgr._hostPlatform,host:t._contextActivationMgr._hostType,locale:t._contextActivationMgr._appUILocale},o=l.ExtendedManifestUtility.constructExtendedOverridesUrl(e.getExtendedOverridesUrl(),r)}catch(e){return void s.RuntimeTelemetryHelper.LogExceptionTag("Failed to construct extendedOverridesUrl",e,t.getCorrelationId(),592221731)}!l.OsfExtendedManifestCache.wasExtendedManifestAlreadyFetched(e._id)&&i.OUtil.xhrGet(o,(function(e){if(null==e)s.RuntimeTelemetryHelper.LogExceptionTag("Invalid extended manifest",null,n.getCorrelationId(),592312417);else{var t=l.ManifestUtil.constructAddInId(n._marketplaceID,n._marketplaceVersion,n._storeType,n._storeLocator);l.OsfExtendedManifestCache.set(t,e)}}),(function(e){s.RuntimeTelemetryHelper.LogExceptionTag("Failed to download extended manifest",e,n.getCorrelationId(),592312418)}))},isCustomFunctionSandbox:function(){var e=this;if("object"==typeof e._settings&&"number"==typeof e._settings.length)for(var t=0;t<e._settings.length;t++)if("object"==typeof e._settings[t]&&"number"==typeof e._settings[t].length&&"string"==typeof e._settings[t][0]&&"string"==typeof e._settings[t][1]&&"customfunctionaddinid"==e._settings[t][0].toLowerCase())return!0;return!1},processManifestForCustomFunctions:function(e){var t=this,n=t;if((!t._isManifestProcessedForCustomFunctions||t._isUpgrading)&&(t._isManifestProcessedForCustomFunctions=!0,(t.getReason()===Microsoft.Office.WebExtension.InitializationReason.Inserted||t.getReason()===Microsoft.Office.WebExtension.InitializationReason.DocumentOpened)&&e.containsCustomFunctionsForAppHost(t._contextActivationMgr._hostType))){var r=i.getManifestHostType(t._contextActivationMgr._hostType),a=t._contextActivationMgr.getFormFactor(),s=new l.Parser.ParsingContext(r,a,null,e),c=new l.Parser.AddinCommandsManifestParser(r,a),u={assetId:t._marketplaceID,appVersion:t._marketplaceVersion,storeType:t._storeType,storeId:t._storeLocator,targetType:null},d={setErrorMessageForAddin:function(e,t){o.msAjaxDebug.trace("Error parsing app manifest: "+t)}},f=c.parseExtensions(u,e,d);if("object"==typeof f.ExtensionPoints&&"number"==typeof f.ExtensionPoints.length)for(var p=e.isXLLCompatible(),m=0;m<f.ExtensionPoints.length;m++)if("CustomFunctions"===f.ExtensionPoints[m].type){var g=f.ExtensionPoints[m],h=function(){var t={osfControl:n,locale:n._getCustomFunctionsLocale(e),invariantNamespace:n._getCustomFunctionsInvariantNamespace(s,g.namespaceResId),namespace:s.resources.ShortStrings[g.namespaceResId],metadataUrl:s.resources.Urls[g.metadataResId],title:e.getDefaultDisplayName(),isXllCompatible:p,manifest:e._xmlProcessor.getNodeXml(e._xmlProcessor.getDocumentElement())};n._contextActivationMgr._notifyHost(n._id,i.AgaveHostAction.InstallCustomFunctions,t)};t.isCustomFunctionSandbox()?(t._iframeUrl=s.resources.Urls[g.pageResId],t._isUpgrading&&h()):h();break}}},setIsUpgrading:function(e){this._isUpgrading=e},getIsUpgrading:function(){return this._isUpgrading},setUpgradingFailed:function(e){this._isUpgradingFailed=e},getUpgradingFailed:function(){return this._isUpgradingFailed},updateUrlsForSdx:function(e){var t=this;if(t.isFirstParty()){var n=".js",r=t._iframeUrl.substr(t._iframeUrl.length-n.length,n.length).toLowerCase()===n,o=/^(?:[a-z]+:)?\/\//i.test(t._iframeUrl);if(r||!o){var i,a=r?"index.html":t._iframeUrl;if(null!==e){var s=e.lastIndexOf("/");-1!==s&&(i=e.substr(0,s)+"/"+a)}r&&(t._bundleUrl=t._iframeUrl),t._iframeUrl=null!=i?i:t._sdxIframeTemplateUrl}}},updateUrlsForSdxBundle:function(e){var t=this;if(t._contextActivationMgr._enableServiceDeliveredExperience){var n=".js";t._iframeUrl.substr(t._iframeUrl.length-n.length,n.length).toLowerCase()===n&&(t._bundleUrl=t._iframeUrl,t._iframeUrl=null!=e?e:t._sdxIframeTemplateUrl)}},_getCustomFunctionsLocale:function(e){return e._UILocale?e._UILocale.toLocaleLowerCase():e._defaultLocale?e._defaultLocale.toLocaleLowerCase():""},_getCustomFunctionsInvariantNamespace:function(e,t){var n=e.manifest._xmlProcessor.selectSingleNode("o:OfficeApp"),r=e.selectSingleNode(n,["ov:VersionOverrides","ov:Resources","bt:ShortStrings","bt:String [@id = '"+t+"']"]);return r?r.getAttribute("DefaultValue"):null},_lessThan:function(e,t){return i.OsfManifestManager.versionLessThan(e,t)},_showTrustError:function(e,t,n,r,o,a,s,c){var u=null,l=this,d=i.OUtil.formatString(Strings.OsfRuntime.L_AgaveName_INFO,t||"");d=l._contextActivationMgr._ErrorUXHelper.getHTMLEncodedString(d);var f=i.OUtil.formatString(Strings.OsfRuntime.L_AgaveProvider_INFO,n||"");f=l._contextActivationMgr._ErrorUXHelper.getHTMLEncodedString(f),c=null==c?!!l.getManifest()&&l.getManifest().isSSOAddin():c;var p=Strings.OsfRuntime.L_AgaveNewAppTitle_TXT,m=Strings.OsfRuntime.L_AgaveTrustAddIn_INFO,g=Strings.OsfRuntime.L_TrustButton_TXT,h=l._osfControlType===i.OsfControlType.DocumentLevel?i.NotificationType.TrustPromptContent:i.NotificationType.TrustPromptTaskpane;l._retryActivate=a,l._contextActivationMgr.displayNotification({id:l._id,infoType:i.InfoType.SecurityInfo,clientName:e,name:t||u,provider:n,title:p,description:m,icon:r||u,buttonTxt:g,buttonCallback:a,url:s||u,dismissCallback:u,reDisplay:!0,displayDeactive:!0,logAsError:!0,retryAll:!0,errorCode:i.ErrorStatusCodes.E_TRUSTCENTER_MOE_UNACTIVATED,iframeNotificationUrl:null,notificationType:h})},_showActivationError:function(e,t,n,r,o,a,s,c,u){var l=!0,d=null,f=this;if(f._status=e,f._contextActivationMgr._enableFirstPartySDXErrorMessages&&f.isFirstParty())var p={id:f._id,infoType:i.InfoType.Error,status:e,title:s||Strings.OsfRuntime.L_AgaveErrorTile_TXT_FirstParty,description:t,icon:d,buttonTxt:n||Strings.OsfRuntime.L_OkButton_TXT,buttonCallback:r||d,url:o||d,dismissCallback:a||d,reDisplay:!a&&l,displayDeactive:l,detailView:!!c&&l,logAsError:l,errorCode:u||0};else p={id:f._id,infoType:i.InfoType.Error,status:e,title:s||Strings.OsfRuntime.L_AgaveErrorTile_TXT,description:t,icon:d,buttonTxt:n||Strings.OsfRuntime.L_OkButton_TXT,buttonCallback:r||d,url:o||d,dismissCallback:a||d,reDisplay:!a&&l,displayDeactive:l,detailView:!!c&&l,logAsError:l,errorCode:u||0};f._contextActivationMgr.displayNotification(p),f._contextActivationMgr.raiseOsfControlStatusChange(f)},_showActivationWarning:function(e,t,n,r,o,a,s){var c=!0,u=null,l=this;if(l._status=e,l._contextActivationMgr._enableFirstPartySDXErrorMessages&&l.isFirstParty())var d={id:l._id,infoType:i.InfoType.Warning,status:e,title:Strings.OsfRuntime.L_AgaveWarningTitle_TXT_FirstParty,description:t,icon:u,buttonTxt:n||Strings.OsfRuntime.L_OkButton_TXT,buttonCallback:r||u,url:o||u,dismissCallback:a||u,reDisplay:!a&&c,displayDeactive:c,logAsError:c,errorCode:s||0};else d={id:l._id,infoType:i.InfoType.Warning,status:e,title:Strings.OsfRuntime.L_AgaveWarningTitle_TXT,description:t,icon:u,buttonTxt:n||Strings.OsfRuntime.L_OkButton_TXT,buttonCallback:r||u,url:o||u,dismissCallback:a||u,reDisplay:!a&&c,displayDeactive:c,logAsError:c,errorCode:s||0};l._contextActivationMgr.displayNotification(d),l._contextActivationMgr.raiseOsfControlStatusChange(l)},_refresh:function(e){this.deActivate(),this.activate(e)},_activateAgavesBlockedBySandboxNotSupport:function(e){e.activateAgavesBlockedBySandboxNotSupport();var t=i.OUtil.getLocalStorage();t&&t.setItem(i.Constants.IgnoreSandBoxSupport,"true")},_setCachedFlag:function(e){this._contextActivationMgr._setCachedFlag(e)},_getCachedFlag:function(e){return this._contextActivationMgr._getCachedFlag(e)},_deleteCachedFlag:function(e){this._contextActivationMgr._deleteCachedFlag(e)},_notifyHostIFrameOnLoaded:function(){var e=this;e._contextActivationMgr._changeGateOnPageReadyFix?e._contextActivationMgr._notifyHost&&!e._iframeLoadedNotified&&(e._contextActivationMgr._notifyHost(e._id,i.AgaveHostAction.PageIsReady),e._iframeLoadedNotified=!0):e._contextActivationMgr._notifyHost&&e._contextActivationMgr._notifyHost(e._id,i.AgaveHostAction.PageIsReady)},_addETokenAsQueryParameter:function(e){var t=document.createElement("a");t.href=e;var n=this.getEToken(),r=i.Constants.ETokenParameterName+"="+encodeURIComponent(i.OUtil.encodeBase64(n)),o=t.search.length>1?t.search.substr(1)+"&":"";t.search=o+r;var a=t.href;return t=null,a},_activate:function(e,t){var n="OsfControlId",r=!0,o=this,a=o;if(s.AppLoadTimeHelper.PageStart(o._telemetryContext),o._storeType===i.StoreType.Sdx){var c=performance.now(),u=!1,d=!1,f=!1,p=function(){f||(f=r,s.RuntimeTelemetryHelper.LogCommonMessageTag("SDX Activation Duration = "+(performance.now()-a._sdxTelemetryContext.activationStart)+".",null,42271587),l.SDXCatalog.recordActivationActivity(r,a._sdxTelemetryContext),a._marketplaceID.toLowerCase()===i.SdxAssetIds.ExperimentationSdx&&setTimeout((function(){return a.deActivate()}),6e4))};o._iframeOnLoadDelegate=Function.createDelegate(o,(function(){var e=this;e._sdxTelemetryContext.iframeOnLoadReceived=performance.now(),u||(u=r,l.SDXCatalog.recordActivity("PageLoad",c,r,[{name:n,string:e._id},{name:"AssetId",string:e._marketplaceID}]),(d||e._contextActivationMgr._enableSetAppContextInIframeName)&&p()),e._iframeOnLoad.apply(e,arguments)})),o._iframeOnGetAppContextDelegate=function(){d||(d=r,l.SDXCatalog.recordActivity("OfficeJsReady",c,r,[{name:n,string:a._id},{name:"AssetId",string:a._marketplaceID}]),u&&p())}}o._setIframeAttribute(e,t),o._pageIsReadyTimerExpired=!1,i.OUtil.addEventListener(e,"load",o._iframeOnLoadDelegate),o._div.appendChild(e),o._status=i.OsfControlStatus.Activated,i.OUtil.writeProfilerMark(i.OsfControlActivationPerfMarker.ActivationEnd),o._contextActivationMgr.raiseOsfControlStatusChange(o),s.AppLoadTimeHelper.OfficeJSStartToLoad(o._telemetryContext)},_setIframeAttribute:function(e,t){var n=this;n._storeType!==i.StoreType.Sdx&&(t=n._addETokenAsQueryParameter(t)),n._marketplaceID.toLowerCase()===i.SdxAssetIds.Ideas&&(t=l.SDXCatalog.AddWacSettingParametersToIframeUrl(t,{WordEditorIdeasNewBundleOfficeJsIsEnabled:n._contextActivationMgr._appSettings.WordEditorIdeasNewBundleOfficeJsIsEnabled}));var r=n._contextActivationMgr.getClientId()+"_"+n._contextActivationMgr.getDocUrl()+"_"+n._id,o=i.OUtil.getFrameName(r);n._conversationId=i.OUtil.generateConversationId();var a=[n._contextActivationMgr._hostType,n._contextActivationMgr._hostPlatform,n._contextActivationMgr._hostSpecificFileVersion,n._contextActivationMgr._appUILocale,n.getCorrelationId(),n._isDialog?"isDialog":null,n._contextActivationMgr._disableLogging?"disableLogging":null,n._hostInfoFlags].join("|"),c=t,u=window.location.origin;if(void 0===u||u&&"null"===u){var d=i.OUtil.parseUrl(window.location.href);u=d.protocol+"//"+d.hostname+(d.port?":"+d.port:"")}var f=n._conversationId+"|"+n._id+"|"+(u.indexOf("$")>=0?encodeURIComponent(u):u),p={};if(p[i.WindowNameItemKeys.BaseFrameName]=o,p[i.WindowNameItemKeys.HostInfo]=a,p[i.WindowNameItemKeys.XdmInfo]=f,p[i.WindowNameItemKeys.SerializerVersion]=i.SerializerVersion.Browser,p[i.WindowNameItemKeys.Flights]=JSON.stringify(i.Flights),n._marketplaceID.toLowerCase()===i.SdxAssetIds.ExperimentationSdx&&n.addProperty("sdxTelemetryContext",JSON.stringify(n._sdxTelemetryContext)),n._contextActivationMgr._enableSetAppContextInIframeName&&(n._contextActivationMgr._enable3rdPartySetAppContextInIframeName||n.isFirstParty())){var m=n.getAppContext(),g=JSON.stringify(m).length;s.RuntimeTelemetryHelper.LogCommonMessageTag("AppContext length is: "+g,n.getCorrelationId(),593896220),g<i.MaxAppContextLength?(p[i.WindowNameItemKeys.AppContext]=m,n._appContextIsSetToIframeName=!0):s.RuntimeTelemetryHelper.LogCommonMessageTag("We got a huge appContext exceeding maximum",n.getCorrelationId(),593896219)}i.OUtil.checkFlight(i.FlightNames.CheckReceiverOrigin)&&(p[i.WindowNameItemKeys.Flights]=JSON.stringify(i.Flights));var h=i.OUtil.getLocalStorage();if(h){var v="CustomFunctionsRuntimeLogging",y=h.getItem(v);y&&(p[v]=y)}n._contextActivationMgr._getServiceEndPoint().registerConversation(n._conversationId,c,n._appDomains),e.setAttribute("src",c),n._sdxTelemetryContext.iframeUrl=c,n._agaveWindowName=l.WACUtils.serializeObjectToString(p),e.setAttribute("name",n._agaveWindowName),i.OUtil.addClass(e,"AddinIframe"),n._agavePageUrl=c},getAppContext:function(){var e=this,t=e.getEToken(),n=0;if(e._contextActivationMgr._hostSpecificFileVersion&&-1!=e._contextActivationMgr._hostSpecificFileVersion.indexOf(".")){var r=e._contextActivationMgr._hostSpecificFileVersion.split("."),o=r[1];isNaN(o)||(n=parseInt(r[1]))}var a=e._contextActivationMgr._requirementsChecker._getSupportedSet(),s=new i.OfficeAppContext(e.getMarketplaceID(),e._contextActivationMgr._appName,e._contextActivationMgr._appVersion,e._contextActivationMgr._appUILocale,e._contextActivationMgr._dataLocale,e._contextActivationMgr._docUrl||window.location.href,e._contextActivationMgr._clientMode,e.getSettings(),e.getReason(),e.getOsfControlType(),t,e._appCorrelationId,e.getID(),!1,!0,n,a,e.getHostCustomMessage(),e._contextActivationMgr._hostFullVersion||i.Constants.FileVersion,window.innerHeight,window.innerWidth,e.getManifest()?e.getManifest().getDefaultDisplayName():null,e._appDomains,void 0,e.getFeatureGates(),void 0,e._initialDisplayMode);return s._wacHostEnvironment=e._contextActivationMgr._wacHostEnvironment||"0",s._isFromWacAutomation=!!e._contextActivationMgr._isFromWacAutomation,s._addInSourceLocationSubdomainAllowedIsEnabled=!0,s._addInSourceUrl=e._agavePageUrl,s},ensureAgaveEndPoint:function(){var e=this;if(!e._agaveEndPoint){var t=e._conversationId+i.SharedConstants.NotificationConversationIdSuffix;e._agaveEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(t,e._frame.contentWindow,e._iframeUrl)}},_getConversationId:function(){return this._conversationId},_doesBrowserSupportRequiredFeatures:function(){var e=!1;if(Object.defineProperty)try{Object.defineProperty({},"myTestProperty",{get:function(){return this.desc},set:function(e){this.desc=e}}),e=!0}catch(e){}return e},_isAddinCommands:function(e){var t=this;if(t._isvirtualOsfControl)e(!0);else if(t._contextActivationMgr._enableAddinCommands&&t._contextActivationMgr._enableTaskpaneUpgradeToAppCommand&&null!=t._virtualOsfControlActivationCallback){var n={marketplaceId:t._marketplaceID,marketplaceVersion:t._marketplaceVersion,storeType:t._storeType,storeId:t._storeLocator,targetData:{}};t._contextActivationMgr.isAddinCommandsAsync(n,(function(t,n){e(n)}))}else e(!1)}},function(e){var t=function(){function t(){}return t.getAll=function(){var n=[],r=[];return e.OsfCache.get(t.c_osfExtendedManifestIdsCacheKey).then((function(t){return t?(JSON.parse(t).forEach((function(t){r.push(e.OsfCache.get(t).then((function(e){if(e){var r={addinId:t,extendedManifest:JSON.parse(e)};n.push(r)}})))})),Promise.all(r)):null})).then((function(){return n}))},t.get=function(t){var n=t.toLowerCase();return e.OsfCache.get(t).then((function(e){return e?{addinId:n,extendedManifest:JSON.parse(e)}:null}))},t.set=function(n,r){var o=this,i=n.toLowerCase(),a=JSON.stringify(JSON.parse(r)),s=[];return e.OsfCache.get(t.c_osfExtendedManifestIdsCacheKey).then((function(e){return e?(s=JSON.parse(e)).indexOf(n)<0?(s.push(i),o.setExtendedManifestHelper(s,i,a,!1)):o.setExtendedManifestHelper(s,i,a,!0):(s.push(i),o.setExtendedManifestHelper(s,i,a,!1))}))},t.wasExtendedManifestAlreadyFetched=function(e){return t.s_fetchedExtendedManifestIdsInMemory&&t.s_fetchedExtendedManifestIdsInMemory.indexOf(e)>=0},t.onChanged=function(e){t.s_onCacheChangedCallbacks.push(e)},t.setExtendedManifestHelper=function(n,r,o,i){return i?e.OsfCache.get(r).then((function(n){if(o!=n)return e.OsfCache.set(r,o).then((function(){t.processCallbacks()}))})):e.OsfCache.set(r,o).then((function(){return t.s_fetchedExtendedManifestIdsInMemory.push(r),e.OsfCache.set(t.c_osfExtendedManifestIdsCacheKey,JSON.stringify(n)).then((function(){t.processCallbacks()}))}))},t.processCallbacks=function(){t.s_onCacheChangedCallbacks.forEach((function(e){e()}))},t.c_osfExtendedManifestIdsCacheKey="OsfExtendedManifestIds",t.s_fetchedExtendedManifestIdsInMemory=[],t.s_onCacheChangedCallbacks=[],t}();e.OsfExtendedManifestCache=t,t.onChanged((function(){e.ActionMetadataManager.init()}))}(l||(l={})),i.OUtil.setNamespace("Manifest",i),i.Manifest.HostApp=function(e){this._appName=e,this._minVersion=null},i.Manifest.HostApp.prototype={getAppName:function(){return this._appName},getMinVersion:function(){return this._minVersion},_setMinVersion:function(e){this._minVersion=e}},i.Manifest.ExtensionSettings=function(){this._sourceLocations={},this._defaultHeight=null,this._defaultWidth=null},i.Manifest.ExtensionSettings.prototype={getDefaultHeight:function(){return this._defaultHeight},getDefaultWidth:function(){return this._defaultWidth},getSourceLocations:function(){return this._sourceLocations},_addSourceLocation:function(e,t){this._sourceLocations[e.toLocaleLowerCase()]=t},_setDefaultWidth:function(e){this._defaultWidth=e},_setDefaultHeight:function(e){this._defaultHeight=e}},i.Manifest.WebAppInfoAuthorization=function(){this._resource=null,this._scopes=null},i.Manifest.WebAppInfoAuthorization.prototype={getResource:function(){return this._resource},getScopes:function(){return this._scopes}},i.Manifest.EquivalentAddins=function(){this._equivalentAddins=[]},i.Manifest.EquivalentAddins.prototype={isXLLCompatible:function(){for(var e=0;e<this._equivalentAddins.length;e++)if(this._equivalentAddins[e].isXLLCompatible())return!0;return!1},add:function(e){this._equivalentAddins.push(e)},getEquivalentAddins:function(){return this._equivalentAddins}},i.Manifest.EquivalentAddin=function(){this._progId=null,this._fileName=null,this._type=null},i.Manifest.EquivalentAddin.prototype={getProgId:function(){return this._progId},getFileName:function(){return this._fileName},getType:function(){return this._type},isXLLCompatible:function(){return"XLL"==this._type},isComAddin:function(){return"COM"==this._type}},function(e){e[e.Short=0]="Short",e[e.Long=1]="Long"}(d||(d={})),i.Manifest.Runtimes=function(){this._runtimes=[]},i.Manifest.Runtimes.prototype={getSharedRuntime:function(e){var t=null,n=this;if(e==t||n._runtimes==t)return t;for(var r=0;r<n._runtimes.length;r++)if(n._runtimes[r]!=t&&n._runtimes[r].Resid===e)return n._runtimes[r];return t},add:function(e){if(null!=e&&null!=this._runtimes){if(null!=this.getSharedRuntime(e.Resid))throw o.msAjaxError.argument("Manifest parser failure: cannot have same Resid for different runtime.");this._runtimes.push(e)}},getRuntimes:function(){return this._runtimes}},i.Manifest.Runtime=function(){this.Resid=null,this.LifeTime=d.Short},i.Manifest.Manifest=function(e,t){var n=null,r="ov:VersionOverrides",a="VersionOverrides",s="xsi:type",c="o:OfficeApp",u="1.1",f=this;if(f._UILocale=t||"en-us","string"==typeof e){var p;f._displayNames={},f._descriptions={},f._iconUrls={},f._extensionSettings={},f._highResolutionIconUrls={},f._versionOverrides={},f._ribbonExtensionControls={},f._xmlProcessor=new i.XmlProcessor(e,i.ManifestNamespaces[u]),f._xmlProcessor.selectSingleNode(c)?(p=function(){var e=this,t=e._xmlProcessor.selectSingleNode("o:Hosts",g);e._hosts=e._parseHosts(t),t&&(e._hostsXml=t.xml||t.outerHTML);t=e._xmlProcessor.selectSingleNode("o:Requirements",g),e._requirements=e._parseRequirements(t),t&&(e._requirementsXml=t.xml||t.outerHTML);(t=e._xmlProcessor.selectSingleNode("o:HighResolutionIconUrl",g))&&e._parseLocaleAwareSettings(t,Function.createDelegate(e,e._addHighResolutionIconUrl))},f._manifestSchemaVersion=i.ManifestSchemaVersion[u]):(f._xmlProcessor=new i.XmlProcessor(e,i.ManifestNamespaces["1.0"]),p=function(){var e=this,t=e._xmlProcessor.selectSingleNode("o:Capabilities",g),n=e._xmlProcessor.selectNodes("o:Capability",t);e._capabilities=e._parseCapabilities(n)},f._manifestSchemaVersion=i.ManifestSchemaVersion["1.0"]);var m=f._xmlProcessor.getDocumentElement();f._target=i.OUtil.parseEnum(m.getAttribute(s),i.OfficeAppType);var g=f._xmlProcessor.selectSingleNode(c);if(m=f._xmlProcessor.selectSingleNode("o:Id",g),f._id=f._xmlProcessor.getNodeValue(m),!new RegExp("^[a-f0-9]{8}(-[a-f0-9]{4}){3}-[a-f0-9]{12}$","i").test(f._id))throw o.msAjaxError.argument("Manifest");if(m=f._xmlProcessor.selectSingleNode("o:Version",g),f._version=f._xmlProcessor.getNodeValue(m),m=f._xmlProcessor.selectSingleNode("o:ProviderName",g),f._providerName=f._xmlProcessor.getNodeValue(m),m=f._xmlProcessor.selectSingleNode("o:IdIssuer",g),f._idIssuer=f._parseIdIssuer(m),(m=f._xmlProcessor.selectSingleNode("o:AlternateId",g))&&(f._alternateId=f._xmlProcessor.getNodeValue(m)),m=f._xmlProcessor.selectSingleNode("o:DefaultLocale",g),f._defaultLocale=f._xmlProcessor.getNodeValue(m),m=f._xmlProcessor.selectSingleNode("o:DisplayName",g),f._parseLocaleAwareSettings(m,Function.createDelegate(f,f._addDisplayName)),m=f._xmlProcessor.selectSingleNode("o:Description",g),f._parseLocaleAwareSettings(m,Function.createDelegate(f,f._addDescription)),m=f._xmlProcessor.selectSingleNode("o:AppDomains",g),f._appDomains=f._parseAppDomains(m),(m=f._xmlProcessor.selectSingleNode("o:IconUrl",g))&&f._parseLocaleAwareSettings(m,Function.createDelegate(f,f._addIconUrl)),(m=f._xmlProcessor.selectSingleNode("o:Signature",g))&&(f._signature=f._xmlProcessor.getNodeValue(m)),f._parseExtensionSettings(),m=f._xmlProcessor.selectSingleNode("o:Permissions",g),f._permissions=f._parsePermission(m),f._allowSnapshot=!0,(m=f._xmlProcessor.selectSingleNode("o:AllowSnapshot",g))&&(f._allowSnapshot=f._parseBooleanNode(m)),f._manifestSchemaVersion===i.ManifestSchemaVersion[u]){var h="ov:";if(f._target==i.OfficeAppType.ContentApp&&(h="c:"),m=f._xmlProcessor.selectSingleNode(h+a,g)){var v=f._xmlProcessor.selectSingleNode(h+"WebApplicationInfo",m);if(v){var y=f._xmlProcessor.selectSingleNode(h+"Resource",v);f._webApplicationResource=f._xmlProcessor.getNodeValue(y);var b=f._xmlProcessor.selectSingleNode(h+"Id",v);f._webApplicationId=f._xmlProcessor.getNodeValue(b);var _=f._xmlProcessor.selectSingleNode(h+"MsaId",v);f._webApplicationMsaId=_?f._xmlProcessor.getNodeValue(_):f._webApplicationId;var S=f._xmlProcessor.selectSingleNode(h+"Scopes",v);f._webApplicationScopes=f._parseWebApplicationScopes(S,h),f._webApplicationAuthorizations=f._parseWebAppInfoAuthorizations(v,h)}}}if(f._manifestSchemaVersion===i.ManifestSchemaVersion[u]&&f._target==i.OfficeAppType.TaskPaneApp){h="ov:";if(m=f._xmlProcessor.selectSingleNode(h+a,g)){var C=f._xmlProcessor.selectSingleNode(h+"EquivalentAddins",m);f._equivalentAddins=f._parseEquivalentAddins(C,h)}}if(f._manifestSchemaVersion===i.ManifestSchemaVersion[u])(O=f._xmlProcessor.selectSingleNode(r,g))&&(f._manifestSourceLocationOverrides=f._parseSourceLocationOverrides(O));if(f._manifestSchemaVersion===i.ManifestSchemaVersion[u]&&f._target==i.OfficeAppType.TaskPaneApp){var O,A=f._xmlProcessor.selectSingleNode("o:ExtendedOverridesUrl",g);if(A!=n&&(f._extendedOverridesUrl=A.getAttribute("DefaultValue")),(O=f._xmlProcessor.selectSingleNode(r,g))!==n){var I=f._xmlProcessor.selectSingleNode("ov:Hosts",O);if(I!==n){var x=f._xmlProcessor.selectNodes("ov:Host",I);if(x!==n)for(var E=x.length,T=0;T<E;T++){var P=x[T].getAttribute(s);if("Workbook"===P||"Presentation"===P){f._versionOverrides[P]={};var w=f._xmlProcessor.selectSingleNode("ov:Runtimes",x[T]);if(w)f._versionOverrides[P]._runtimes=f._parseRuntimes(w);else{var M=new i.Manifest.Runtime;M.Resid="OEP.SharedRuntime.Url",M.LifeTime=d.Long;var R=new i.Manifest.Runtimes;R.add(M),f._versionOverrides[P]._runtimes=R}var j=new l.Parser.AddinCommandsManifestParser(P,"DesktopFormFactor"),k=new l.Parser.AddinCommandsManifestParser(P,"AllFormFactors"),N={setErrorMessageForAddin:function(e){o.msAjaxDebug.trace("Error parsing app manifest: "+e)}},D={assetId:f._id,appVersion:f._version,storeType:n,storeId:n,targetType:n},F=j.parseExtensions(D,f,N),L=k.parseExtensions(D,f,N);f._versionOverrides[P]._addinCommandsExtensionPoints=F.ExtensionPoints,f._versionOverrides[P]._functionFileResid=F.functionFileResid,f._versionOverrides[P]._customFunctionExtensionPoint=L.ExtensionPoints[0],f._versionOverrides[P]._showTaskpaneControls=f._retrieveAppCommandShowTaskpaneControls(P),f._validateShowTaskpaneSharedRuntime(P),f._generateRibbonExtensionControlMap(P)}}}}}p.apply(f)}else e(f)},i.Manifest.Manifest.prototype={getSourceLocationOverrideByResourceId:function(e){return e&&this._manifestSourceLocationOverrides?this._manifestSourceLocationOverrides[e]:null},getManifestSchemaVersion:function(){return this._manifestSchemaVersion},getMarketplaceID:function(){return this._id},getMarketplaceVersion:function(){return this._version},getDefaultLocale:function(){return this._defaultLocale},getProviderName:function(){return this._providerName},getIdIssuer:function(){return this._idIssuer},getAlternateId:function(){return this._alternateId},getSignature:function(){return this._signature},getCapabilities:function(){return this._capabilities},getDisplayName:function(e){return this._displayNames[e.toLocaleLowerCase()]},getDefaultDisplayName:function(){return this._getDefaultValue(this._displayNames)},getDescription:function(e){return this._descriptions[e]},getDefaultDescription:function(){return this._getDefaultValue(this._descriptions)},getIconUrl:function(e){return this._iconUrls[e]},getDefaultIconUrl:function(){return this._getDefaultValue(this._iconUrls)},getSourceLocation:function(e,t){return this._getExtensionSetting(t).getSourceLocations()[e.toLocaleLowerCase()]},getDefaultSourceLocation:function(e){var t=this._getExtensionSetting(e).getSourceLocations();return this._getDefaultValue(t)},getDefaultWidth:function(e){return this._getExtensionSetting(e).getDefaultWidth()},getDefaultHeight:function(e){return this._getExtensionSetting(e).getDefaultHeight()},getTarget:function(){return this._target},getOmexTargetCode:function(){switch(this._target){case i.OfficeAppType.ContentApp:return 2;case i.OfficeAppType.TaskPaneApp:return 1;case i.OfficeAppType.MailApp:return 3;default:return 0}},getPermission:function(){return this._permissions},hasPermission:function(e){return(this._permissions&e)===e},getHosts:function(){return this._hosts},getHostsXml:function(){return this._hostsXml},getRequirements:function(){return this._requirements},getRequirementsXml:function(){return this._requirementsXml},getHighResolutionIconUrl:function(e){return this._highResolutionIconUrls[e]},getDefaultHighResolutionIconUrl:function(){return this._getDefaultValue(this._highResolutionIconUrls)},getAppDomains:function(){return this._appDomains},getInMemoryEToken:function(){return this._inMemoryEToken},isAllowSnapshot:function(){return this._allowSnapshot},addManifestUrl:function(e){var t=l.WACUtils.getDomainForUrl(e);-1===this._appDomains.indexOf(t)&&this._appDomains.push(t)},getWebApplicationResource:function(){return this._webApplicationResource},getWebApplicationId:function(){return this._webApplicationId},getWebApplicationMsaId:function(){return this._webApplicationMsaId},getWebApplicationScopes:function(){return this._webApplicationScopes},getWebApplicationAuthorizations:function(){return this._webApplicationAuthorizations},getEquivalentAddins:function(){return this._equivalentAddins?this._equivalentAddins.getEquivalentAddins():[]},isXLLCompatible:function(){return!!this._equivalentAddins&&this._equivalentAddins.isXLLCompatible()},isSSOAddin:function(){return!!this._webApplicationResource&&!!this._webApplicationId},containsAddinCommands:function(e){var t=this._getCurrentHostTypeNode(e);if(null!==t&&null!=this._xmlProcessor.selectSingleNode("ov:DesktopFormFactor",t))return!0;return!1},getRibbonExtensionControlMap:function(){return this._ribbonExtensionControls},getExtendedOverridesUrl:function(){return this._extendedOverridesUrl},containsCustomFunctions:function(e){var t=this._getCurrentHostTypeNode(e);if(null!==t){var n=this._xmlProcessor.selectSingleNode("ov:AllFormFactors",t);if(null!==n){var r=this._xmlProcessor.selectNodes("ov:ExtensionPoint",n);if(null!==r)for(var o=r.length,i=0;i<o;i++){if("CustomFunctions"===r[i].getAttribute("xsi:type"))return!0}}}return!1},containsCustomFunctionsForAppHost:function(e){var t=i.getManifestHostType(e);return e!=i.HostType.Outlook&&this.containsCustomFunctions(t)},getSharedRuntimeForCustomFunctions:function(e){var t=null;if(e==t||this._versionOverrides==t)return t;var n=this._versionOverrides[e];return n==t||n._customFunctionExtensionPoint==t||n._runtimes==t?t:n._runtimes.getSharedRuntime(n._customFunctionExtensionPoint.pageResId)},getSharedRuntimeForTaskpane:function(e,t){var n=null;if(e==n||t==n||this._versionOverrides==n)return n;var r=this._versionOverrides[e];if(r==n||r._showTaskpaneControls==n||r._runtimes==n)return n;var o=n;return this._iterateAppCommandShowTaskpaneControls(r._showTaskpaneControls,(function(e){return e!=n&&e.action!=n&&((e.action.taskpaneId===t||e.id===t)&&(o=e.action.sourceLocationResid,!0))})),o==n?n:r._runtimes.getSharedRuntime(o)},getSharedRuntimeForAppCmdsExecuteFunction:function(e){var t=null;if(e==t||this._versionOverrides==t)return t;var n=this._versionOverrides[e];return n==t||n._runtimes==t?t:n._runtimes.getSharedRuntime(n._functionFileResid)},getSharedRuntimeId:function(e,t,n){var r=t?this.getSharedRuntimeForAppCmdsExecuteFunction(e):this.getSharedRuntimeForTaskpane(e,n);return null!==r?r.Resid:null},sharedRuntimeHasShortLifeTime:function(e,t){var n=null;if(e===n||t===n||this._versionOverrides===n)return!1;var r=this._versionOverrides[e];if(r===n||r._runtimes===n)return!1;var o=r._runtimes.getSharedRuntime(t);return o!==n&&o.LifeTime===d.Short},_iterateAppCommandShowTaskpaneControls:function(e,t){if(null!=e&&null!=t)for(var n=0;n<e.length&&!t(e[n]);n++);},_generateRibbonExtensionControlMap:function(e){var t=null,n=this;if(e==t||n._versionOverrides==t)return t;var r=n._versionOverrides[e];if(r!=t&&r._addinCommandsExtensionPoints!=t)for(var o=r._addinCommandsExtensionPoints.length,i=0;i<o;i++){var a=r._addinCommandsExtensionPoints[i];if("PrimaryCommandSurface"===a.type&&a.tabs)for(var s=0;s<a.tabs.length;s++){var c=a.tabs[s];n._ribbonExtensionControls[c.id]=c,n._addRibbonControlsToMap(c)}}},_addRibbonControlsToMap:function(e){if(e&&e.children)for(var t=0;t<e.children.length;t++){var n=e.children[t];!n||n instanceof l.Parser.MenuControl||(this._ribbonExtensionControls[n.id]=n),this._addRibbonControlsToMap(n)}},_retrieveAppCommandShowTaskpaneControls:function(e){var t=null,n=this;if(e==t||n._versionOverrides==t)return t;var r=n._versionOverrides[e],o=[];if(r!=t&&r._addinCommandsExtensionPoints!=t)for(var i=r._addinCommandsExtensionPoints.length,a=0;a<i;a++){var s=r._addinCommandsExtensionPoints[a];if(s!=t)if("PrimaryCommandSurface"===s.type){if(s.tabs==t)continue;for(var c=0;c<s.tabs.length;c++){var u=s.tabs[c];if(u!=t&&u.children!=t)for(var l=0;l<u.children.length;l++){var d=u.children[l];d!=t&&d.children!=t&&n._getShowTaskpaneControlsFromControlsParent(d,o)}}}else if("ContextMenu"===s.type){if(s.children==t)continue;var f=s.children[0];if(f==t||f.children==t)continue;n._getShowTaskpaneControlsFromControlsParent(f,o)}}return o},_getShowTaskpaneControlsFromControlsParent:function(e,t){var n="ShowTaskpane",r=null;if(e!=r&&e.children!=r&&t!=r)for(var o=0;o<e.children.length;o++){var i=e.children[o];if(i!=r)if("Button"===i.controlType)i.action!=r&&i.actionType===n&&t.push(i);else{if(i.children==r)continue;for(var a=0;a<i.children.length;a++){var s=i.children[a];s!=r&&s.action!=r&&s.actionType===n&&t.push(s)}}}},_validateShowTaskpaneSharedRuntime:function(e){var t=null;if(e!=t&&this._versionOverrides!=t){var n=this._versionOverrides[e];if(n!=t&&n._runtimes!=t&&n._showTaskpaneControls!=t){var r=[];this._iterateAppCommandShowTaskpaneControls(n._showTaskpaneControls,(function(e){var i="Manifest parser failure: resid and taskpaneid not correct";if(e==t||e.action==t)return!1;var a=n._runtimes.getSharedRuntime(e.action.sourceLocationResid),s=t;if(a==t||a.LifeTime!=d.Long){if(e.action.taskpaneId==t)return!1}else s=a.Resid;for(var c=[e.action.taskpaneId,s],u=!0,l=0;l<r.length;l++){if(r[l][0]==c[0]&&r[l][1]==c[1]){if(c[0]==t)throw o.msAjaxError.argument(i);u=!1;break}if(r[l][1]==c[1]&&r[l][1]!=t||r[l][0]==c[0]&&r[l][0]!=t)throw u=!1,o.msAjaxError.argument(i)}return u&&r.push(c),!1}))}}},_getDefaultValue:function(e){var t,n=this;if(n._UILocale&&(t=e[n._UILocale]||e[n._UILocale.toLocaleLowerCase()]||void 0),!t&&n._defaultLocale&&(t=e[n._defaultLocale]||e[n._defaultLocale.toLocaleLowerCase()]||void 0),!t){var r;for(var o in e){r=o;break}t=e[r]}return t},_getExtensionSetting:function(e){var t,n=this;if(void 0!==n._extensionSettings[e])t=n._extensionSettings[e];else for(var r in n._extensionSettings){t=n._extensionSettings[r];break}return t},_addDisplayName:function(e,t){this._displayNames[e.toLocaleLowerCase()]=t},_addDescription:function(e,t){this._descriptions[e]=t},_addIconUrl:function(e,t){this._iconUrls[e]=t},_parseLocaleAwareSettings:function(e,t){if(!e)throw o.msAjaxError.argument("Manifest");var n=e.getAttribute("DefaultValue");t(this._defaultLocale,n);var r=this._xmlProcessor.selectNodes("o:Override",e);if(r)for(var i=r.length,a=0;a<i;a++){var s=r[a];t(s.getAttribute("Locale"),s.getAttribute("Value"))}},_parseBooleanNode:function(e){if(e){var t=this._xmlProcessor.getNodeValue(e).toLowerCase();return"true"===t||"1"===t}return!1},_parseIdIssuer:function(e){if(e){var t=this._xmlProcessor.getNodeValue(e);return i.OUtil.parseEnum(t,i.ManifestIdIssuer)}return i.ManifestIdIssuer.Custom},_parseCapabilities:function(e){for(var t,n=[],r=0;r<e.length;r++){t=e[r].getAttribute("Name"),t=i.OUtil.parseEnum(t,i.Capability),n.push(t)}return n},_parsePermission:function(e){if(!e)throw o.msAjaxError.argument("Manifest");var t=this._xmlProcessor.getNodeValue(e);return i.OUtil.parseEnum(t,i.OsfControlPermission)},_parseExtensionSettings:function(){var e,t,n,r=this,a=r;for(var s in i.FormFactor){var c=r._xmlProcessor.selectSingleNode("o:OfficeApp");if(t=r._xmlProcessor.selectSingleNode("o:"+i.FormFactor[s],c)){e=new i.Manifest.ExtensionSettings,n=r._xmlProcessor.selectSingleNode("o:SourceLocation",t);r._parseLocaleAwareSettings(n,(function(t,n){e._addSourceLocation(t,n),a.addManifestUrl(n)})),(n=r._xmlProcessor.selectSingleNode("o:RequestedWidth",t))&&e._setDefaultWidth(r._xmlProcessor.getNodeValue(n)),(n=r._xmlProcessor.selectSingleNode("o:RequestedHeight",t))&&e._setDefaultHeight(r._xmlProcessor.getNodeValue(n)),r._extensionSettings[s]=e}}if(!e)throw o.msAjaxError.argument("Manifest")},_parseHosts:function(e){var t=[];if(e)for(var n=this._xmlProcessor.selectNodes("o:Host",e),r=0;r<n.length;r++)t.push(n[r].getAttribute("Name"));return t},_parseWebApplicationScopes:function(e,t){var n=[];if(e)for(var r=this._xmlProcessor.selectNodes(t+"Scope",e),o=0;o<r.length;o++)n.push(this._xmlProcessor.getNodeValue(r[o]));return n},_parseWebAppInfoAuthorizations:function(e,t){var n=this,r=[],o=n._xmlProcessor.selectSingleNode(t+"Authorizations",e);if(o){var a=n._xmlProcessor.selectNodes(t+"Authorization",o);if(a)for(var s=0;s<a.length;s++){var c=a[s],u=new i.Manifest.WebAppInfoAuthorization,l=n._xmlProcessor.selectSingleNode(t+"Resource",c);l&&(u._resource=n._xmlProcessor.getNodeValue(l));var d=n._xmlProcessor.selectSingleNode(t+"Scopes",c);if(d){var f=n._xmlProcessor.selectNodes(t+"Scope",d);if(f){for(var p=[],m=0;m<f.length;m++){var g=f[m];p.push(n._xmlProcessor.getNodeValue(g))}u._scopes=p}}r.push(u)}}return r},_parseRequirements:function(e){var t=this,n={sets:[],methods:[]};if(e){var r=t._xmlProcessor.selectSingleNode("o:Sets",e);n.sets=t._parseSets(r);var o=t._xmlProcessor.selectSingleNode("o:Methods",e);n.methods=t._parseMethods(o)}return n},_parseSets:function(e){var t=[];if(e)for(var n=e.getAttribute("DefaultMinVersion"),r=this._xmlProcessor.selectNodes("o:Set",e),o=0;o<r.length;o++){var i=r[o],a=i.getAttribute("MinVersion");t.push({name:i.getAttribute("Name"),version:a||n})}return t},_parseMethods:function(e){var t=[];if(e)for(var n=this._xmlProcessor.selectNodes("o:Method",e),r=0;r<n.length;r++)t.push(n[r].getAttribute("Name"));return t},_parseSourceLocationOverrides:function(e){var t={};if(e){var n=this._xmlProcessor.selectSingleNode("ov:Resources",e);if(n){var r=this._xmlProcessor.selectSingleNode("bt:Urls",n);if(r){var o=this._xmlProcessor.selectNodes("bt:Url",r);if(o)for(var i=0;i<o.length;i++){var a=o[i],s=a.getAttribute("id"),c=a.getAttribute("DefaultValue");s&&c&&(t[s]=c)}}}}return t},_parseAppDomains:function(e){var t=[];if(e)for(var n=this._xmlProcessor.selectNodes("o:AppDomain",e),r=0;r<n.length;r++){var o=l.WACUtils.getDomainForUrl(this._xmlProcessor.getNodeValue(n[r]));-1===t.indexOf(o)&&t.push(o)}return t},_parseRuntimes:function(e){var t=null;if(e==t)return t;var n=new i.Manifest.Runtimes,r=this._xmlProcessor.selectNodes("ov:Runtime",e);if(r==t)return t;for(var o=0;o<r.length;o++){var a=this._parseRuntime(r[o]);n.add(a)}return n},_parseRuntime:function(e){if(null==e)return null;var t=new i.Manifest.Runtime;return t.Resid=e.getAttribute("resid"),"long"===e.getAttribute("lifetime")?t.LifeTime=d.Long:t.LifeTime=d.Short,t},_parseEquivalentAddins:function(e,t){var n=new i.Manifest.EquivalentAddins;if(e)for(var r=this._xmlProcessor.selectNodes(t+"EquivalentAddin",e),o=0;o<r.length;o++){var a=this._parseEquivalentAddin(r[o],t);n.add(a)}return n},_parseEquivalentAddin:function(e,t){var n=this,r=new i.Manifest.EquivalentAddin;if(e){var a=n._xmlProcessor.selectSingleNode(t+"ProgId",e);a&&(r._progId=n._xmlProcessor.getNodeValue(a));var s=n._xmlProcessor.selectSingleNode(t+"FileName",e);s&&(r._fileName=n._xmlProcessor.getNodeValue(s));var c=n._xmlProcessor.selectSingleNode(t+"Type",e);if(!c)throw o.msAjaxError.argument("Manifest");var u=""+n._xmlProcessor.getNodeValue(c);r._type=u.toUpperCase()}return r},_addHighResolutionIconUrl:function(e,t){this._highResolutionIconUrls[e]=t},_isAddinCommandsManifest:function(e){return this.containsAddinCommands(e)||this.containsCustomFunctions(e)},_getCurrentHostTypeNode:function(e){var t=null,n=this,r=n._xmlProcessor.selectSingleNode("o:OfficeApp");if(r!==t&&n.getManifestSchemaVersion()===i.ManifestSchemaVersion[1.1]){var o=n._xmlProcessor.selectSingleNode("ov:VersionOverrides",r);if(o!==t){var a=n._xmlProcessor.selectSingleNode("ov:Hosts",o);if(a!==t){var s=n._xmlProcessor.selectNodes("ov:Host",a);if(s!==t)for(var c=s.length,u=0;u<c;u++){if(s[u].getAttribute("xsi:type")===e)return s[u]}}}}return t}},i.OsfManifestManager=function(){var e="undefined",t="marketplaceVersion",n="marketplaceID",r=!0,o=null,a=!1,c={},u="en-us",d={};function f(e,t){return e+"_"+t}return{getManifestAsync:function(e,t){i.OUtil.validateParamObject(e,{osfControl:{type:Object,mayBeNull:a},referenceInUse:{type:Object,mayBeNull:a}},t);var n=e.referenceInUse,u=n.id,d=f(u,n.version);e.hostType==i.HostType.PowerPoint&&d in c||e.osfControl==o||e.osfControl._sharedRuntimeId==o||!(e.osfControl._sharedRuntimeId.length>0)||(d=f(u=i.OsfManifestManager.getSharedRuntimeManifestCacheKey(n.id,e.osfControl._sharedRuntimeId),n.version));var p=c[d];if(e.manifestCached=a,p)e.manifestCached=r,t({statusCode:i.ProxyCallStatusCode.Succeeded,value:p,context:e});else if(e.clientEndPoint&&e.manifestUrl){s.AppLoadTimeHelper.ManifestRequestStart(e.osfControl._telemetryContext);var m={manifestUrl:e.manifestUrl,id:n.id,version:n.version,clearCache:e.clearCache||a};this._invokeProxyMethodAsync(e,"OEM_getManifestAsync",(function(e){var a;if(e.statusCode===i.ProxyCallStatusCode.Succeeded&&e.value)try{var c;a=e.context.osfControl,"string"==typeof e.value?(e.context.manifestCached=r,c=e.value):(e.context.manifestCached=e.value.cached,c=e.value.manifest),s.AppLoadTimeHelper.SetManifestDataCachedFlag(a._telemetryContext,e.value.cached),e.value=new i.Manifest.Manifest(c,a._contextActivationMgr.getAppUILocale()),i.OsfManifestManager.cacheManifest(n.id,n.version,e.value)}catch(t){var u;e.value=o,a&&(u=a._appCorrelationId);var d="Invalid manifest in getManifestAsync.";l.WACUtils.logExceptionToBrowserConsole(d,t),s.RuntimeTelemetryHelper.LogExceptionTag(d,t,u,18420423)}else s.RuntimeTelemetryHelper.LogExceptionTag("getManifestAsync failed:"+l.WACUtils.serializeObjectToString(e),o,o,18420424);t(e)}),m)}else t({statusCode:i.ProxyCallStatusCode.Failed,value:o,context:e})},getAppInstanceInfoByIdAsync:function(e,t){i.OUtil.validateParamObject(e,{webUrl:{type:String,mayBeNull:a},appInstanceId:{type:String,mayBeNull:a},clientEndPoint:{type:Object,mayBeNull:a}},t);var n={webUrl:e.webUrl,appInstanceId:e.appInstanceId,clearCache:e.clearCache||a};this._invokeProxyMethodAsync(e,"OEM_getSPAppInstanceInfoByIdAsync",t,n)},getSPTokenByProductIdAsync:function(e,t){i.OUtil.validateParamObject(e,{appWebUrl:{type:String,mayBeNull:a},productId:{type:String,mayBeNull:a}},t);var n=this;e.osfControl._contextActivationMgr._createSharePointIFrameProxy(e.appWebUrl,(function(r){if(r){var s={webUrl:e.appWebUrl,productId:e.productId,clearCache:e.clearCache||a,clientEndPoint:r};n._invokeProxyMethodAsync(e,"OEM_getSPTokenByProductIdAsync",t,s)}else t({statusCode:i.ProxyCallStatusCode.ProxyNotReady,value:o,context:e})}))},getSPAppEntitlementsAsync:function(e,t){var n="/";if(i.OUtil.validateParamObject(e,{osfControl:{type:Object,mayBeNull:a},referenceInUse:{type:Object,mayBeNull:a},baseUrl:{type:String,mayBeNull:a},pageUrl:{type:String,mayBeNull:a},webUrl:{type:String,mayBeNull:r}},t),e.webUrl)this.getCorporateCatalogEntitlementsAsync(e,t);else{var s=document.createElement("a");s.href=e.pageUrl;var c=s.pathname,u=c.split(n),l=u.length-1,d=s.href.substring(0,s.href.length-c.length);d&&d.charAt(d.length-1)!==n&&(d+=n);for(var f=[d],p=0;p<l;p++)u[p]&&(d=d+u[p]+n,f.push(d));s=o;var m=this,g=e.osfControl._contextActivationMgr,h=f.pop(),v=function(e){if(e.statusCode===i.ProxyCallStatusCode.Succeeded){var r=e.value;r&&r.charAt(r.length-1)!==n&&(r+=n),g._webUrl=r,e.context.webUrl=r,e.context.appWebUrl=r,m.getCorporateCatalogEntitlementsAsync(e.context,t)}else t(e)},y=function(n){if(n){e.clientEndPoint=n;var r={pageUrl:e.pageUrl,baseUrl:h,clearCache:e.clearCache||a};m._invokeProxyMethodAsync(e,"OEM_getSPAppWebUrlFromPageUrlAsync",v,r)}else f.length>0?(h=f.pop(),g._createSharePointIFrameProxy(h,y)):t({statusCode:i.ProxyCallStatusCode.Failed,value:o,context:e})};g._createSharePointIFrameProxy(h,y)}},getOneDriveEntitlementsAsync:function(e,t){var n="Content-Type",r=e.referenceInUse.storeLocator,o=e.referenceInUse.storeLocator+"/root:/Manifests",a=i.OneDriveOAuth.getAccessTokenFromCookie(),s="?access_token="+a,c=o+s,u=new XMLHttpRequest,l=new XMLHttpRequest;u.onreadystatechange=function(){if(4==u.readyState&&200==u.status){var t=JSON.parse(u.response).id,r=e.referenceInUse.storeLocator+"/items/"+t+"/children"+s;l.open("GET",r),l.setRequestHeader(n,"json"),l.send()}};var d=[],f=0,p=0,m=function(){f==p&&t({statusCode:i.ProxyCallStatusCode.Succeeded,value:{entitlements:d},context:e})},g=function(e,t){p++;var n=t;try{var r=new i.Manifest.Manifest(e.responseText),o=[];o.push(r.getDefaultDisplayName()),o.push(n),o.push(r.getDefaultDescription()),o.push(r.getTarget()),o.push(r.getMarketplaceVersion()),o.push(n),o.push(i.StoreType.OneDrive),o.push(r.getDefaultWidth()||0),o.push(r.getDefaultHeight()||0),o.push(r.getDefaultIconUrl()),o.push(r.getProviderName()),o.push(r.getDefaultLocale()),o.push(i.StoreType.OneDrive),d.push(o)}catch(e){}m()},h=function(){p++,m()};l.onreadystatechange=function(){if(4==l.readyState&&200==l.status){for(var e=JSON.parse(l.responseText),t=0;t<e.value.length;t++)if(".xml"==e.value[t].name.substr(e.value[t].name.length-4).toLowerCase()){var n=r+"/root:/Manifests/"+e.value[t].name+":/content?access_token="+a;i.OUtil.xhrGetFull(n,e.value[t].name,g,h),f++}m()}},u.open("GET",c),u.setRequestHeader(n,"json"),u.send()},getCorporateCatalogEntitlementsAsync:function(e,t){i.OUtil.validateParamObject(e,{osfControl:{type:Object,mayBeNull:a},referenceInUse:{type:Object,mayBeNull:a},webUrl:{type:String,mayBeNull:a}},t),s.AppLoadTimeHelper.AuthenticationStart(e.osfControl._telemetryContext);var n=this,c=0,u=function(l){if(l){s.AppLoadTimeHelper.AuthenticationEnd(e.osfControl._telemetryContext),e.clientEndPoint=l;var d={webUrl:e.webUrl,applicationName:i.HostCapability[e.hostType],officeExtentionTarget:e.noTargetType||e.osfControl.getOsfControlType()===i.OsfControlTarget.TaskPane?o:e.osfControl.getOsfControlType(),clearCache:e.clearCache||a,supportedManifestVersions:{"1.0":r,1.1:r}};n._invokeProxyMethodAsync(e,"OEM_getEntitlementSummaryAsync",t,d)}else c<i.Constants.AuthenticatedConnectMaxTries?(c++,setTimeout((function(){e.osfControl._contextActivationMgr._createSharePointIFrameProxy(e.webUrl,u)}),500)):t({statusCode:i.ProxyCallStatusCode.ProxyNotReady,value:o,context:e})};e.osfControl._contextActivationMgr._createSharePointIFrameProxy(e.webUrl,u)},_invokeProxyMethodAsync:function(e,t,n,r){var a,c=[r.clientEndPoint?r.clientEndPoint._targetUrl:e.clientEndPoint._targetUrl,t];for(var u in r)("string"===(a=typeof r[u])||"number"===a||"boolean"===a)&&c.push(r[u]);var f=c.join("."),p=d,m={onCompleted:n,context:e,methodName:t},g=p[f];if(g)g.push(m);else{p[f]=[m];var h=e.clientEndPoint;r.clientEndPoint&&(h=r.clientEndPoint,delete r.clientEndPoint),e.referenceInUse&&e.referenceInUse.storeType===i.StoreType.OMEX&&(r.officeVersion=i.Constants.ThreePartsFileVersion),h.invoke(t,(function(e,t){var n=o,r=i.ProxyCallStatusCode.Failed;0===e&&t.status&&(n=t.result,r=i.ProxyCallStatusCode.Succeeded);var a=p[f];delete p[f];for(var c=a.length,u=0;u<c;u++){var d,m=a.shift();try{m.context&&m.context.osfControl&&(d=m.context.osfControl._appCorrelationId),t&&t.failureInfo&&s.RuntimeTelemetryHelper.LogProxyFailure(d,m.methodName,t.failureInfo),m.onCompleted({statusCode:r,value:n,context:m.context})}catch(e){var g="_invokeProxyMethodAsync failed.";l.WACUtils.logExceptionToBrowserConsole(g,e),s.RuntimeTelemetryHelper.LogExceptionTag(g,e,d,18420425)}}}),r)}},removeOmexCacheAsync:function(e,t){i.OUtil.validateParamObject(e,{osfControl:{type:Object,mayBeNull:a},referenceInUse:{type:Object,mayBeNull:a},clientEndPoint:{type:Object,mayBeNull:a}},t);var n=e.referenceInUse,r={applicationName:e.hostType,assetID:n.id,officeExtentionTarget:e.osfControl.getOsfControlType(),clearEntitlement:e.clearEntitlement||a,clearToken:e.clearToken||a,clearAppState:e.clearAppState||a,clearManifest:e.clearManifest||a,appVersion:e.appVersion};e.anonymous?r.contentMarket=n.storeLocator:(r.assetContentMarket=e.osfControl._omexEntitlement.contentMarket,r.userContentMarket=n.storeLocator),this._invokeProxyMethodAsync(e,"OMEX_removeCacheAsync",t,r)},purgeManifest:function(r,o){var i=Function._validateParams(arguments,[{name:n,type:String,mayBeNull:a},{name:t,type:String,mayBeNull:a}]);if(i)throw i;var s=f(r,o);typeof c[s]!=e&&delete c[s]},cacheManifestFromXml:function(e,r,o,s){var c=Function._validateParams(arguments,[{name:n,type:String,mayBeNull:a},{name:t,type:String,mayBeNull:a},{name:"manifestXml",type:String,mayBeNull:a},{name:"uiLocale",type:String,mayBeNull:a}]);if(c)throw c;this.cacheManifest(e,r,new i.Manifest.Manifest(o,s))},cacheManifest:function(e,r,o){var i=Function._validateParams(arguments,[{name:n,type:String,mayBeNull:a},{name:t,type:String,mayBeNull:a},{name:"manifest",type:Object,mayBeNull:a}]);if(i)throw i;var s=f(e,r);o._UILocale=o._UILocale||u,c[s]=o},hasManifest:function(o,i){var s=Function._validateParams(arguments,[{name:n,type:String,mayBeNull:a},{name:t,type:String,mayBeNull:a}]);if(s)throw s;var u=f(o,i);return typeof c[u]!=e?r:a},hasManifestForControl:function(e){return i.OUtil.validateParamObject(e,{referenceInUse:{type:Object,mayBeNull:a}},o),this.hasManifest(e.referenceInUse.id,e.referenceInUse.version)},getCachedManifest:function(e,r){var o=Function._validateParams(arguments,[{name:n,type:String,mayBeNull:a},{name:t,type:String,mayBeNull:a}]);if(o)throw o;var i=f(e,r);return c[i]},getSharedRuntimeManifestCacheKey:function(e,t){var r=Function._validateParams(arguments,[{name:n,type:String,mayBeNull:a},{name:"sharedRuntimeId",type:String,mayBeNull:a}]);if(r)throw r;return e+t},versionLessThan:function(e,t){for(var n,r,o=e.split("."),i=t.split("."),s=Math.min(o.length,i.length),c=0;c<s;c++)try{if((n=parseFloat(o[c]))!=(r=parseFloat(i[c])))return n<r}catch(e){}if(o.length>=i.length)return a;s=i.length;var u=0;for(c=o.length;c<s;c++){try{r=parseFloat(i[c])}catch(e){r=0}u+=r}return u>0},_setUILocale:function(e){u=e}}}(),i.ManifestSchemaVersion={"1.0":"1.0",1.1:"1.1"},i.ManifestNamespaces={"1.0":'xmlns="http://schemas.microsoft.com/office/appforoffice/1.0" xmlns:o="http://schemas.microsoft.com/office/appforoffice/1.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"',1.1:'xmlns="http://schemas.microsoft.com/office/appforoffice/1.1" xmlns:o="http://schemas.microsoft.com/office/appforoffice/1.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0" xmlns:ov="http://schemas.microsoft.com/office/taskpaneappversionoverrides" xmlns:c="http://schemas.microsoft.com/office/contentappversionoverrides"'},i.OsfNavigationMode={DefaultMode:0,CategoryMode:1,TrustPageMode:2,QueryResultMode:3},i.RequirementsChecker=function(e,t,n,r,o){var i=this;i.setCapabilities(e),i.setHosts(t),i.setRequirements(n),i.setSupportedControlTargets(r),i.setSupportedOmexAppVersions(o),i.setFilteringEnabled(!1)},i.RequirementsChecker.prototype={defaultMinMaxVersion:"1.1",isManifestSupported:function(e){if(!this.isFilteringEnabled())return!0;if(!e)return!1;switch(e.getManifestSchemaVersion()||i.ManifestSchemaVersion["1.0"]){case i.ManifestSchemaVersion["1.0"]:return this._checkManifest1_0(e);case i.ManifestSchemaVersion[1.1]:return this._checkManifest1_1(e);default:return!1}},isEntitlementFromOmexSupported:function(e){var t,n=this;if(!n.isFilteringEnabled())return!0;if(!e)return!1;switch(e.appSubType){case"1":t=i.OsfControlTarget.TaskPane;break;case"2":t=i.OsfControlTarget.InContent;break;case"3":t=i.OsfControlTarget.Contextual;break;case"4":t=i.OsfControlTarget.TaskPane;break;default:return!1}if(!n._checkControlTarget(t))return!1;if(!e.requirements&&!e.hosts)return!e.hasOwnProperty("appVersions")||void 0===e.appVersions||n._checkOmexAppVersions(e.appVersions);var r,o,a,s,c=new i.Manifest.Manifest((function(){}));return e.requirements&&(c._xmlProcessor=new i.XmlProcessor(e.requirements,i.ManifestNamespaces[1.1]),o=c._xmlProcessor.getDocumentElement()),r=c._parseRequirements(o),e.hosts&&(c._xmlProcessor=new i.XmlProcessor(e.hosts,i.ManifestNamespaces[1.1]),s=c._xmlProcessor.getDocumentElement()),a=c._parseHosts(s),n._checkHosts(a)&&n._checkSets(r.sets)&&n._checkMethods(r.methods)},isEntitlementFromCorpCatalogSupported:function(e){var t=this;if(!t.isFilteringEnabled())return!0;if(!e)return!1;var n=i.OfficeAppType[e.OEType];if(!t._checkControlTarget(n))return!1;var r,o,a,s,c,u=new i.Manifest.Manifest((function(){}));e.OfficeExtensionCapabilitiesXML&&(u._xmlProcessor=new i.XmlProcessor(e.OfficeExtensionCapabilitiesXML,i.ManifestNamespaces[1.1]),s=u._xmlProcessor.getDocumentElement(),o=(c=u._parseRequirements(s)).sets,a=c.methods,r=u._parseHosts(s));return t._checkHosts(r)&&t._checkSets(o)&&t._checkMethods(a)},setCapabilities:function(e){this._supportedCapabilities=this._scalarArrayToObject(e)},setHosts:function(e){this._supportedHosts=this._scalarArrayToObject(e)},setRequirements:function(e){var t=this;t._supportedSets=e&&t._arrayToSetsObject(e.sets)||{},t._supportedMethods=e&&t._scalarArrayToObject(e.methods)||{}},setSupportedControlTargets:function(e){this._supportedControlTargets=this._scalarArrayToObject(e)},setSupportedOmexAppVersions:function(e){this._supportedOmexAppVersions=e&&e.slice?e.slice(0):[]},setFilteringEnabled:function(e){this._filteringEnabled=!!e},isFilteringEnabled:function(){return this._filteringEnabled},_checkManifest1_0:function(e){return this._checkCapabilities(e.getCapabilities())},_checkCapabilities:function(e){if(!e||0===e.length)return!0;for(var t=0;t<e.length;t++)if(this._supportedCapabilities[e[t]])return!0;return!1},_checkManifest1_1:function(e){var t=e.getRequirements()||{};return this._checkHosts(e.getHosts())&&this._checkSets(t.sets)&&this._checkMethods(t.methods)},_checkHosts:function(e){if(!e||0===e.length)return!0;for(var t=0;t<e.length;t++)if(this._supportedHosts[e[t]])return!0;return!1},_checkSets:function(e){var t=this;if(!e||0===e.length)return!0;for(var n=0;n<e.length;n++){var r=e[n],o=t._supportedSets[r.name.toLowerCase()];if(!o)return!1;if(r.version&&(t._compareVersionStrings(o.minVersion||t.defaultMinMaxVersion,r.version)>0||t._compareVersionStrings(o.maxVersion||t.defaultMinMaxVersion,r.version)<0))return!1}return!0},_checkMethods:function(e){if(!e||0===e.length)return!0;for(var t=0;t<e.length;t++)if(!this._supportedMethods[e[t]])return!1;return!0},_checkControlTarget:function(e){return null!=e&&this._supportedControlTargets[e]},_checkOmexAppVersions:function(e){if(!e)return!1;for(var t=0;t<this._supportedOmexAppVersions.length;t++)if(e.indexOf(this._supportedOmexAppVersions[t])>=0)return!0;return!1},_scalarArrayToObject:function(e){var t={};if(e&&e.length)for(var n=0;n<e.length;n++)null!=e[n]&&(t[e[n]]=!0);return t},_arrayToSetsObject:function(e){var t={};if(e&&e.length)for(var n=0;n<e.length;n++){var r=e[n];r&&null!=r.name&&(t[r.name.toLowerCase()]=r)}return t},_getSupportedSet:function(){for(var e={},t=Object.getOwnPropertyNames(this._supportedSets),n=0;n<t.length;n++){var r=this._supportedSets[t[n]];e[r.name.toLowerCase()]=r.maxVersion||this.defaultMinMaxVersion}return"undefined"!=typeof JSON?JSON.stringify(e):e},_getSupportedSetAsDmsCapabilities:function(){var e=this;return Object.getOwnPropertyNames(this._supportedSets).map((function(t){var n=e._supportedSets[t];return{Name:n.name.toLowerCase(),Version:n.maxVersion||e.defaultMinMaxVersion}}))},_compareVersionStrings:function(e,t){e=e.split("."),t=t.split(".");for(var n=Math.max(e.length,t.length),r=0;r<n;r++){var o=parseInt(e[r],10)||0,i=parseInt(t[r],10)||0;if(o!==i)return o-i}return 0}},l.appSpecificCheckOrigin=function(e,t,n,r){try{return!(!(t&&t.source&&t.source.location&&t.source.location.pathname)||t.source.location.pathname.indexOf("projection.aspx")<0)&&r(e,n)}catch(e){return!1}},window.OfficeExt=l},8469:function(e,t){e.exports={am:"am-et",ar:"ar-sa",bg:"bg-bg","bn-in":"bn-in",ca:"ca-es",cs:"cs-cz",cy:"cy-gb",da:"da-dk",de:"de-de",el:"el-gr",en:"en-us",es:"es-es","es-mx":"es-mx",et:"et-ee",eu:"eu-es",fa:"fa-ir",fi:"fi-fi",fil:"fil-ph",fr:"fr-fr","fr-ca":"fr-ca",gl:"gl-es",gu:"gu-in",he:"he-il",hi:"hi-in",hr:"hr-hr",hu:"hu-hu",id:"id-id",is:"is-is",it:"it-it",ja:"ja-jp",kk:"kk-kz",kn:"kn-in",ko:"ko-kr","lo-la":"lo-la",lt:"lt-lt",lv:"lv-lv",ml:"ml-in",mr:"mr-in",ms:"ms-my",nl:"nl-nl","nn-no":"nn-no",no:"nb-no",pl:"pl-pl",pt:"pt-br","pt-pt":"pt-pt",ro:"ro-ro",ru:"ru-ru",sk:"sk-sk",sl:"sl-si",sr:"sr-latn-rs","sr-cyrl":"sr-cyrl-rs",sv:"sv-se",sw:"sw-ke",ta:"ta-in",te:"te-in",th:"th-th",tr:"tr-tr",uk:"uk-ua",ur:"ur-pk",vi:"vi-vn","zh-hans":"zh-cn","zh-hant":"zh-tw"}},8470:function(e,t,n){var r=n(8471),o=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},8471:function(e,t,n){t=e.exports=n(115)(!1);var r=n(1411)(n(8472));t.push([e.i,"._3mhPR1XTv-25tdKsbXrR95.ms-Panel{top:48px}._3mhPR1XTv-25tdKsbXrR95.ms-Panel .ms-Panel-contentInner{top:40px;position:absolute;overflow:visible}._3mhPR1XTv-25tdKsbXrR95.ms-Panel .ms-Panel-contentInner .ms-Panel-content{height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;position:relative;min-height:400px;overflow:visible}html[dir] ._3mhPR1XTv-25tdKsbXrR95.ms-Panel .ms-Panel-contentInner .ms-Panel-content{padding-bottom:0}html[dir=ltr] ._3mhPR1XTv-25tdKsbXrR95.ms-Panel .ms-Panel-contentInner .ms-Panel-content,html[dir=rtl] ._3mhPR1XTv-25tdKsbXrR95.ms-Panel .ms-Panel-contentInner .ms-Panel-content{padding-left:0;padding-right:0}._3mhPR1XTv-25tdKsbXrR95.ms-Panel .ms-Panel-main{width:955px!important}html[dir=ltr] ._3mhPR1XTv-25tdKsbXrR95.ms-Panel .ms-Panel-main{right:0!important;left:auto!important}html[dir=rtl] ._3mhPR1XTv-25tdKsbXrR95.ms-Panel .ms-Panel-main{left:0!important;right:auto!important}._2IDzPQHBsw5KT3CSo3T99y{display:-webkit-box;display:-ms-flexbox;display:flex;height:calc(100vh - 80px);width:960px;overflow:hidden}._3Xw5QeaxPNy626kZ_avN_b{position:absolute;top:6px;z-index:1000;cursor:pointer}html[dir] ._3Xw5QeaxPNy626kZ_avN_b{background:none}html[dir=ltr] ._3Xw5QeaxPNy626kZ_avN_b{left:901px}html[dir=rtl] ._3Xw5QeaxPNy626kZ_avN_b{right:901px}.fm3HSVWLq7Ufa6UsA9Ia3{height:100%;width:100%}html[dir] .fm3HSVWLq7Ufa6UsA9Ia3{background:url("+r+");background-repeat:no-repeat;background-position:50%;padding-top:17px}.KD3KxCCkMSejIJaTn41EQ{top:11px;z-index:1;position:absolute;cursor:pointer}html[dir=ltr] .KD3KxCCkMSejIJaTn41EQ{right:73px}html[dir=rtl] .KD3KxCCkMSejIJaTn41EQ{left:73px}._2HflJSd-IP_2TEdM2l5TZL{height:100%;width:100%}html[dir] ._2HflJSd-IP_2TEdM2l5TZL{background:url("+r+");background-repeat:no-repeat;background-position:50%}._1hahf_PvaHVm9Vp1wotjvF{top:-29px;z-index:1;position:absolute;cursor:pointer}html[dir=ltr] ._1hahf_PvaHVm9Vp1wotjvF{right:73px}html[dir=rtl] ._1hahf_PvaHVm9Vp1wotjvF{left:73px}",""]),t.locals={inClientStorePanelContainer:"_3mhPR1XTv-25tdKsbXrR95",container:"_2IDzPQHBsw5KT3CSo3T99y",closeButton:"_3Xw5QeaxPNy626kZ_avN_b",inClientStoreIFrameCenter:"fm3HSVWLq7Ufa6UsA9Ia3",FeedbackCommandBarCenter:"KD3KxCCkMSejIJaTn41EQ",inClientStoreIFrame:"_2HflJSd-IP_2TEdM2l5TZL",FeedbackCommandBar:"_1hahf_PvaHVm9Vp1wotjvF"}},8472:function(e,t,n){e.exports=n.p+"../resources/images/progress-e4ba8e5c7eb8b6080aadb62c29bbf737.gif"},8473:function(e,t,n){var r=n(8474),o=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},8474:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,"._37Fda6WfJOJiiR3vms2f3i{display:-webkit-box;display:-ms-flexbox;display:flex;display:-webkit-flex;max-width:510px}html[dir] ._37Fda6WfJOJiiR3vms2f3i{margin:30px}",""]),t.locals={divContainer:"_37Fda6WfJOJiiR3vms2f3i"}},8475:function(e){e.exports=JSON.parse('{"b":"sZa","l":"tZa","c":"uZa","d":"vZa","e":"wZa","f":"xZa","g":"yZa","k":"zZa","h":"AZa","i":"BZa","j":"CZa","m":"DZa","n":"EZa","o":"FZa","a":"GZa"}')},8476:function(e,t,n){var r=n(8477),o=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},8477:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,'._35FjC3WF9MoHaA96_nmkPF{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--purple:var(--fallback-purple);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary)}html[dir] ._35FjC3WF9MoHaA96_nmkPF{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white)}._35FjC3WF9MoHaA96_nmkPF .ms-Callout-main{overflow:hidden!important}._3aJfygwIsiE-a6ugF_-9MK{height:32px!important;color:inherit}html[dir] ._3aJfygwIsiE-a6ugF_-9MK{background-color:transparent}._3aJfygwIsiE-a6ugF_-9MK .ms-Button{height:32px}._3aJfygwIsiE-a6ugF_-9MK .is-expanded .ms-CommandBarItem-overflow,.y5HTBMEC0Ik6LA3LsA_Vo .ms-Button-label{color:"[theme:themePrimary, default:#0078D4]"!important}._1C_kN6v-4J2Nrr5ST9WGLl{color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}html[dir] ._1C_kN6v-4J2Nrr5ST9WGLl{padding:8px}html[dir=ltr] ._1C_kN6v-4J2Nrr5ST9WGLl{float:left}html[dir=rtl] ._1C_kN6v-4J2Nrr5ST9WGLl{float:right}._36RJ_gVN4jNeoXS0xazZtY{height:16px;width:0}html[dir] ._36RJ_gVN4jNeoXS0xazZtY{padding:0 0 0 0;margin:8px 0;border-color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"!important}html[dir=ltr] ._36RJ_gVN4jNeoXS0xazZtY{border-right-width:1px;border-right-style:solid;float:left}html[dir=rtl] ._36RJ_gVN4jNeoXS0xazZtY{border-left-width:1px;border-left-style:solid;float:right}._1RmIbFX5laaq5a6G3fX_ZE{width:570px;max-height:450px;min-height:32px}html[dir] ._1RmIbFX5laaq5a6G3fX_ZE{border-top-style:solid;border-top-width:1px;border-top-color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}',""]),t.locals={divContainer:"_35FjC3WF9MoHaA96_nmkPF",contextualBar:"_3aJfygwIsiE-a6ugF_-9MK",selected:"y5HTBMEC0Ik6LA3LsA_Vo",appIcon:"_1C_kN6v-4J2Nrr5ST9WGLl",divider:"_36RJ_gVN4jNeoXS0xazZtY",contextualAddinFrame:"_1RmIbFX5laaq5a6G3fX_ZE"}},8478:function(e){e.exports=JSON.parse('{"a":"rZa"}')},8479:function(e,t,n){var r=n(8480),o=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},8480:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,"._3kAp1tVu6pGq9lEQgNBLTj{display:none}._1c_RfP_c6TXoIGXiDm5VDY{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--purple:var(--fallback-purple);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);max-width:none!important}html[dir] ._1c_RfP_c6TXoIGXiDm5VDY{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white)}",""]),t.locals={divContainer:"_3kAp1tVu6pGq9lEQgNBLTj",dialogContainer:"_1c_RfP_c6TXoIGXiDm5VDY"}},8481:function(e){e.exports=JSON.parse('{"a":"NZa"}')},8482:function(e){e.exports=JSON.parse('{"d":"IZa","e":"JZa","a":"KZa","b":"LZa","c":"MZa"}')},8483:function(e,t,n){var r=n(8484),o=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},8484:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,'._35Uxh-lNCy7AIVxAkLQnf{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--purple:var(--fallback-purple);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);height:100%;width:100%}html[dir] ._35Uxh-lNCy7AIVxAkLQnf{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white)}._2fBIui4X7VzMUeMlgn0aAJ{position:relative;top:25%}html[dir] ._2fBIui4X7VzMUeMlgn0aAJ{text-align:center}._2O6_TNrH7pVtosTqq1iHX0{display:inline-block;font-size:80px;line-height:1;color:"[theme:themePrimary, default:#0078D4]"}html[dir] ._2O6_TNrH7pVtosTqq1iHX0{text-align:center}._1hrmefbBRxJBgKb0Fz4kj6{display:block;max-width:70%}html[dir] ._1hrmefbBRxJBgKb0Fz4kj6{margin:auto}.t085jF8UewCxzoVIxg3MF{font-size:17px;font-weight:300;color:"[theme:neutralPrimary, default:#333333]"}html[dir] .t085jF8UewCxzoVIxg3MF{padding-top:25px}._3CjShi0HyNf1-sMSa13b4o{font-size:12px;font-weight:400;color:"[theme:neutralSecondary, default:#666666]"}html[dir] ._3CjShi0HyNf1-sMSa13b4o{padding-top:10px}',""]),t.locals={errorContainer:"_35Uxh-lNCy7AIVxAkLQnf",errorContent:"_2fBIui4X7VzMUeMlgn0aAJ",errorIcon:"_2O6_TNrH7pVtosTqq1iHX0",errorTextCommon:"_1hrmefbBRxJBgKb0Fz4kj6",errorTextTitle:"t085jF8UewCxzoVIxg3MF",errorTextDescription:"_3CjShi0HyNf1-sMSa13b4o"}},8485:function(e){e.exports=JSON.parse('{"a":"HZa"}')},8486:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,'._2LyIY1IT_FLcj7nlu42I5I{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--purple:var(--fallback-purple);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:70px}html[dir] ._2LyIY1IT_FLcj7nlu42I5I{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white);padding:0 22px;padding-top:10px}._2F5ZiV8NB3K3qoiCs8805O{height:60px}html[dir] ._2F5ZiV8NB3K3qoiCs8805O{padding:0 32px;padding-top:10px}html[dir=ltr] ._2F5ZiV8NB3K3qoiCs8805O{padding-right:36px}html[dir=rtl] ._2F5ZiV8NB3K3qoiCs8805O{padding-left:36px}._3qSJ1BvxuTyayDzbR1sZHx{position:static}html[dir=ltr] ._3qSJ1BvxuTyayDzbR1sZHx{margin-right:-10px;right:0}html[dir=rtl] ._3qSJ1BvxuTyayDzbR1sZHx{margin-left:-10px;left:0}._1TN9YpVgiQGSwrH412Bdgx{font-size:32px;color:"[theme:neutralSecondary, default:#666666]";width:32px;height:32px;min-width:32px}html[dir] ._1TN9YpVgiQGSwrH412Bdgx{border:0;padding:0}html[dir=ltr] ._1TN9YpVgiQGSwrH412Bdgx{float:left}html[dir=rtl] ._1TN9YpVgiQGSwrH412Bdgx{float:right}.B85HD7JJkDxOZ255cVew6{color:"[theme:neutralTertiary, default:#a6a6a6]"}._1IsbQs17q9hMPNRjzbH3Y4{font-size:21px;font-weight:100;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;color:"[theme:neutralPrimary, default:#333333]";overflow:hidden;white-space:nowrap;text-overflow:ellipsis}html[dir=ltr] ._1IsbQs17q9hMPNRjzbH3Y4{float:left;margin-left:8px}html[dir=rtl] ._1IsbQs17q9hMPNRjzbH3Y4{float:right;margin-right:8px}.aE5GasCrbxr6WFaLuRHdA{text-overflow:ellipsis;overflow:hidden}.aE5GasCrbxr6WFaLuRHdA,.D_t_F2iR_J5JIVwSvJzKO{white-space:nowrap}._12oaZ7uLdngB73OnarBfW-{color:"[theme:neutralPrimary, default:#333333]"}',""]),t.locals={addinPaneHeader:"_2LyIY1IT_FLcj7nlu42I5I",addinPaneHeaderCalendar:"_2F5ZiV8NB3K3qoiCs8805O",closeButton:"_3qSJ1BvxuTyayDzbR1sZHx",addinPaneIcon:"_1TN9YpVgiQGSwrH412Bdgx",fallbackIcon:"B85HD7JJkDxOZ255cVew6",addinPaneLabelText:"_1IsbQs17q9hMPNRjzbH3Y4",ellipsis:"aE5GasCrbxr6WFaLuRHdA",rightButtons:"D_t_F2iR_J5JIVwSvJzKO",persistIcon:"_12oaZ7uLdngB73OnarBfW-"}},8487:function(e,t,n){var r=n(8488),o=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},8488:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,"._1k5ke6nDxpeUR8lrcSeiY5 .ms-Panel-content{height:calc(100vh - 50px);overflow-y:hidden}html[dir] ._1k5ke6nDxpeUR8lrcSeiY5 .ms-Panel-content{padding:0}html[dir] ._1k5ke6nDxpeUR8lrcSeiY5 .ms-Panel-commands{margin-top:0}._1k5ke6nDxpeUR8lrcSeiY5 .ms-Panel-main{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--purple:var(--fallback-purple);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);top:48px;height:calc(100% - 48px);width:320px!important}html[dir] ._1k5ke6nDxpeUR8lrcSeiY5 .ms-Panel-main{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white)}html[dir=ltr] ._1k5ke6nDxpeUR8lrcSeiY5 .ms-Panel-main{left:calc(100vw - 322px)!important}html[dir=rtl] ._1k5ke6nDxpeUR8lrcSeiY5 .ms-Panel-main{right:calc(100vw - 322px)!important}.isShyHeaderMode._1k5ke6nDxpeUR8lrcSeiY5 .ms-Panel-main{top:8px;height:calc(100% - 8px)}.isShyHeaderMode._1k5ke6nDxpeUR8lrcSeiY5 .ms-Panel-content{height:calc(100vh - 10px)}._8Iga8mKVcPGOaQygACFwN .ms-Panel-main{top:0;height:100%}._1k5ke6nDxpeUR8lrcSeiY5 .ms-Panel-contentInner{height:100%}._1k5ke6nDxpeUR8lrcSeiY5{height:100%;overflow-y:hidden}",""]),t.locals={taskPane:"_1k5ke6nDxpeUR8lrcSeiY5",taskPaneNoHeader:"_8Iga8mKVcPGOaQygACFwN"}},8489:function(e,t,n){var r=n(8490),o=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},8490:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,".C1qPgTlqf9Y7t0ml3EHcF{display:none}._1fUNAcJOHwVFh9BqSDLXu2{width:100%;height:calc(100% - 80px)}.G2EwK-c9YGqvxnB1GHcDM{height:calc(100% - 70px)}.P6cxIKyPIAjWQFeaZzdcd{display:block;top:0;width:100%;height:100%;-webkit-box-sizing:border-box;box-sizing:border-box}.P6cxIKyPIAjWQFeaZzdcd iframe{max-height:100%}.wdOcR00mWtKSYE12x1mhd{display:none}",""]),t.locals={divContainer:"C1qPgTlqf9Y7t0ml3EHcF",extensionContainer:"_1fUNAcJOHwVFh9BqSDLXu2",extensionContainerCalendar:"G2EwK-c9YGqvxnB1GHcDM",extensionHost:"P6cxIKyPIAjWQFeaZzdcd",hide:"wdOcR00mWtKSYE12x1mhd"}},8491:function(e,t,n){var r=n(8492),o=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},8492:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,".hILIH9i-q7hXQGEpldvA2{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--purple:var(--fallback-purple);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);max-width:none}html[dir] .hILIH9i-q7hXQGEpldvA2{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white)}._3wbeT-LKN3ClVrBC37qMHu{height:190px}._3PKPHkrVd4hnglpDBfYb3-{width:550px;height:400px}._3mgLsubAj-SyqGrLV6-bnx{display:none!important}",""]),t.locals={dialogContainer:"hILIH9i-q7hXQGEpldvA2",uiLessContainer:"_3wbeT-LKN3ClVrBC37qMHu",consentContainer:"_3PKPHkrVd4hnglpDBfYb3-",hiddenContainer:"_3mgLsubAj-SyqGrLV6-bnx"}},8493:function(e){e.exports=JSON.parse('{"b":"pZa","a":"qZa"}')},8494:function(e,t,n){var r=n(8495),o=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},8495:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,"._3YILU6DQcy9_FzoKf8XVYT{width:100%;height:100%}",""]),t.locals={uiLessContainer:"_3YILU6DQcy9_FzoKf8XVYT"}},8496:function(e,t,n){var r=n(8497),o=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},8497:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,".ms-ContextualMenu-icon ._1KiZKEg8-nD4NulHDjAhzX{position:relative;top:-8px}",""]),t.locals={fallbackIcon:"_1KiZKEg8-nD4NulHDjAhzX"}},8498:function(e){e.exports=JSON.parse('{"a":"dZa"}')},8499:function(e){e.exports=JSON.parse('{"a":"RZa"}')},895:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(0),o=n(1),i=n(583),a=n(252),s=n(83),c=n(277),u=n(106),l=n(356),d=n(163),f=function(e){function t(n){var r=e.call(this,n)||this;return r._root=o.createRef(),r._firstBumper=o.createRef(),r._lastBumper=o.createRef(),r._hasFocus=!1,r._onRootFocus=function(e){r.props.onFocus&&r.props.onFocus(e),r._hasFocus=!0},r._onRootBlur=function(e){r.props.onBlur&&r.props.onBlur(e);var t=e.relatedTarget;null===e.relatedTarget&&(t=r._getDocument().activeElement),Object(a.a)(r._root.current,t)||(r._hasFocus=!1)},r._onFirstBumperFocus=function(){r._onBumperFocus(!0)},r._onLastBumperFocus=function(){r._onBumperFocus(!1)},r._onBumperFocus=function(e){if(!r.props.disabled){var t=e===r._hasFocus?r._lastBumper.current:r._firstBumper.current;if(r._root.current){var n=e===r._hasFocus?Object(s.i)(r._root.current,t,!0,!1):Object(s.f)(r._root.current,t,!0,!1);n&&(r._isBumper(n)?r.focus():n.focus())}}},r._onFocusCapture=function(e){r.props.onFocusCapture&&r.props.onFocusCapture(e),e.target===e.currentTarget||r._isBumper(e.target)||(r._previouslyFocusedElementInTrapZone=e.target)},r._forceFocusInTrap=function(e){if(!r.props.disabled&&t._focusStack.length&&r===t._focusStack[t._focusStack.length-1]){var n=r._getDocument().activeElement;Object(a.a)(r._root.current,n)||(r.focus(),r._hasFocus=!0,e.preventDefault(),e.stopPropagation())}},r._forceClickInTrap=function(e){if(!r.props.disabled&&t._focusStack.length&&r===t._focusStack[t._focusStack.length-1]){var n=e.target;n&&!Object(a.a)(r._root.current,n)&&(r.focus(),r._hasFocus=!0,e.preventDefault(),e.stopPropagation())}},Object(c.a)(r),r}return Object(r.__extends)(t,e),t.prototype.componentDidMount=function(){this._bringFocusIntoZone(),this._updateEventHandlers(this.props),!this.props.disabled&&this._root.current&&this.props.enableAriaHiddenSiblings&&(this._unmodalize=Object(i.a)(this._root.current))},t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=e.elementToFocusOnDismiss;t&&this._previouslyFocusedElementOutsideTrapZone!==t&&(this._previouslyFocusedElementOutsideTrapZone=t),this._updateEventHandlers(e)},t.prototype.componentDidUpdate=function(e){var t=void 0===e.forceFocusInsideTrap||e.forceFocusInsideTrap,n=void 0===this.props.forceFocusInsideTrap||this.props.forceFocusInsideTrap,r=void 0!==e.disabled&&e.disabled,o=void 0!==this.props.disabled&&this.props.disabled;!t&&n||r&&!o?(this._bringFocusIntoZone(),!this._unmodalize&&this._root.current&&this.props.enableAriaHiddenSiblings&&(this._unmodalize=Object(i.a)(this._root.current))):(t&&!n||!r&&o)&&(this._returnFocusToInitiator(),this._unmodalize&&this._unmodalize())},t.prototype.componentWillUnmount=function(){this.props.disabled&&!this.props.forceFocusInsideTrap&&Object(a.a)(this._root.current,this._getDocument().activeElement)||this._returnFocusToInitiator(),this._disposeClickHandler&&(this._disposeClickHandler(),this._disposeClickHandler=void 0),this._disposeFocusHandler&&(this._disposeFocusHandler(),this._disposeFocusHandler=void 0),this._unmodalize&&this._unmodalize(),delete this._previouslyFocusedElementInTrapZone,delete this._previouslyFocusedElementOutsideTrapZone},t.prototype.render=function(){var e=this.props,t=e.className,n=e.disabled,i=void 0!==n&&n,a=e.ariaLabelledBy,s=Object(u.j)(this.props,u.h),c={style:{pointerEvents:"none",position:"fixed"},tabIndex:i?-1:0,"data-is-visible":!0};return o.createElement("div",Object(r.__assign)({},s,{className:t,ref:this._root,"aria-labelledby":a,onFocusCapture:this._onFocusCapture,onFocus:this._onRootFocus,onBlur:this._onRootBlur}),o.createElement("div",Object(r.__assign)({},c,{ref:this._firstBumper,onFocus:this._onFirstBumperFocus})),this.props.children,o.createElement("div",Object(r.__assign)({},c,{ref:this._lastBumper,onFocus:this._onLastBumperFocus})))},t.prototype.focus=function(){var e=this.props,t=e.focusPreviouslyFocusedInnerElement,n=e.firstFocusableSelector;if(t&&this._previouslyFocusedElementInTrapZone&&Object(a.a)(this._root.current,this._previouslyFocusedElementInTrapZone))this._focusAsync(this._previouslyFocusedElementInTrapZone);else{var r="string"==typeof n?n:n&&n(),o=null;this._root.current&&(r&&(o=this._root.current.querySelector("."+r)),o||(o=Object(s.j)(this._root.current,this._root.current.firstChild,!1,!1,!1,!0))),o&&this._focusAsync(o)}},t.prototype._focusAsync=function(e){this._isBumper(e)||Object(s.b)(e)},t.prototype._bringFocusIntoZone=function(){var e=this.props,n=e.elementToFocusOnDismiss,r=e.disabled,o=void 0!==r&&r,i=e.disableFirstFocus,s=void 0!==i&&i;o||(t._focusStack.push(this),this._previouslyFocusedElementOutsideTrapZone=n||this._getDocument().activeElement,s||Object(a.a)(this._root.current,this._previouslyFocusedElementOutsideTrapZone)||this.focus())},t.prototype._returnFocusToInitiator=function(){var e=this,n=this.props.ignoreExternalFocusing;t._focusStack=t._focusStack.filter((function(t){return e!==t}));var r=this._getDocument(),o=r.activeElement;n||!this._previouslyFocusedElementOutsideTrapZone||"function"!=typeof this._previouslyFocusedElementOutsideTrapZone.focus||!Object(a.a)(this._root.current,o)&&o!==r.body||this._focusAsync(this._previouslyFocusedElementOutsideTrapZone)},t.prototype._updateEventHandlers=function(e){var t=e.isClickableOutsideFocusTrap,n=void 0!==t&&t,r=e.forceFocusInsideTrap,o=void 0===r||r;o&&!this._disposeFocusHandler?this._disposeFocusHandler=Object(l.a)(window,"focus",this._forceFocusInTrap,!0):!o&&this._disposeFocusHandler&&(this._disposeFocusHandler(),this._disposeFocusHandler=void 0),n||this._disposeClickHandler?n&&this._disposeClickHandler&&(this._disposeClickHandler(),this._disposeClickHandler=void 0):this._disposeClickHandler=Object(l.a)(window,"click",this._forceClickInTrap,!0)},t.prototype._isBumper=function(e){return e===this._firstBumper.current||e===this._lastBumper.current},t.prototype._getDocument=function(){return Object(d.a)(this._root.current)},t._focusStack=[],t}(o.Component)},896:function(e,t,n){"use strict";var r=n(378),o=n(566),i=n(14),a={root:"ms-Overlay",rootDark:"ms-Overlay--dark"};n.d(t,"a",(function(){return s}));var s=Object(r.a)(o.a,(function(e){var t,n=e.className,r=e.theme,o=e.isNone,s=e.isDark,c=r.palette,u=Object(i.getGlobalClassNames)(a,r);return{root:[u.root,r.fonts.medium,{backgroundColor:c.whiteTranslucent40,top:0,right:0,bottom:0,left:0,position:"absolute",selectors:(t={},t[i.HighContrastSelector]={border:"1px solid WindowText",opacity:0},t)},o&&{visibility:"hidden"},s&&[u.rootDark,{backgroundColor:c.blackTranslucent40}],n]}}),void 0,{scope:"Overlay"})},898:function(e,t,n){"use strict";var r=n(378),o=n(569),i=n(14),a={root:"ms-TooltipHost",ariaPlaceholder:"ms-TooltipHost-aria-placeholder"};n.d(t,"a",(function(){return s}));var s=Object(r.a)(o.a,(function(e){var t=e.className,n=e.theme;return{root:[Object(i.getGlobalClassNames)(a,n).root,{display:"inline"},t]}}),void 0,{scope:"TooltipHost"})},899:function(e,t,n){"use strict";var r=n(378),o=n(574),i=n(14),a={root:"ms-Dialog"};n.d(t,"a",(function(){return s}));var s=Object(r.a)(o.a,(function(e){var t,n=e.className,r=e.containerClassName,o=e.dialogDefaultMinWidth,s=void 0===o?"288px":o,c=e.dialogDefaultMaxWidth,u=void 0===c?"340px":c,l=e.hidden,d=e.theme;return{root:[Object(i.getGlobalClassNames)(a,d).root,d.fonts.medium,n],main:[{width:s,outline:"3px solid transparent",selectors:(t={},t["@media (min-width: "+i.ScreenWidthMinMedium+"px)"]={width:"auto",maxWidth:u,minWidth:s},t)},!l&&{display:"flex"},r]}}),void 0,{scope:"Dialog"})},9017:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1077),o=n(3700),i=n(1235);function a(e,t,n,i){return new Promise((function(a,c){var u=!1;try{var l=Object(r.i)([{name:t,url:n}]);Object(o.a)(l,e,{isInline:i,isHiddenInline:!0,shouldShare:!1},(function(e){u||(u=!0,a(e.Id))}),s,(function(e){u||(u=!0,c({errorType:"UploadError"}))}))}catch(e){c({errorType:"UploadError"})}}))}var s=function(e,t,n){Object(i.v)(e,t,n)}},9018:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1077),o=n(3700);function i(e,t,n,i){return new Promise((function(a,s){var c=!1,u=Object(r.h)([t],[n]);Object(o.a)(u,e,{isInline:i,isHiddenInline:!1,shouldShare:!1},(function(e){c||(c=!0,a(e.Id))}),null,(function(e){c||(c=!0,s({errorType:"UploadError"}))}))}))}},905:function(e,t,n){"use strict";var r=n(378),o=n(580),i=n(339),a=n(14),s=n(245),c={root:"ms-Spinner",circle:"ms-Spinner-circle",label:"ms-Spinner-label"},u=Object(s.c)((function(){return Object(a.keyframes)({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}})}));n.d(t,"a",(function(){return l}));var l=Object(r.a)(o.a,(function(e){var t,n=e.theme,r=e.size,o=e.className,s=e.labelPosition,l=n.palette,d=Object(a.getGlobalClassNames)(c,n);return{root:[d.root,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},"top"===s&&{flexDirection:"column-reverse"},"right"===s&&{flexDirection:"row"},"left"===s&&{flexDirection:"row-reverse"},o],circle:[d.circle,{boxSizing:"border-box",borderRadius:"50%",border:"1.5px solid "+l.themeLight,borderTopColor:l.themePrimary,animationName:u(),animationDuration:"1.3s",animationIterationCount:"infinite",animationTimingFunction:"cubic-bezier(.53,.21,.29,.67)",selectors:(t={},t[a.HighContrastSelector]={borderTopColor:"Highlight"},t)},r===i.a.xSmall&&["ms-Spinner--xSmall",{width:12,height:12}],r===i.a.small&&["ms-Spinner--small",{width:16,height:16}],r===i.a.medium&&["ms-Spinner--medium",{width:20,height:20}],r===i.a.large&&["ms-Spinner--large",{width:28,height:28}]],label:[d.label,n.fonts.small,{color:l.themePrimary,margin:"8px 0 0",textAlign:"center"},"top"===s&&{margin:"0 0 8px"},"right"===s&&{margin:"0 0 0 8px"},"left"===s&&{margin:"0 8px 0 0"}],screenReaderText:a.hiddenContentStyle}}),void 0,{scope:"Spinner"})},908:function(e,t,n){"use strict";var r,o=n(378),i=n(0),a=n(1),s=n(579),c=n(709),u=n(896),l=n(707),d=n(253),f=n(319),p=n(282),m=n(312),g=n(249),h=n(277),v=n(357),y=n(267),b=n(236),_=n(106),S=n(252),C=n(895),O=n(268),A=Object(d.a)(),I="Panel";!function(e){e[e.closed=0]="closed",e[e.animatingOpen=1]="animatingOpen",e[e.open=2]="open",e[e.animatingClosed=3]="animatingClosed"}(r||(r={}));var x,E,T,P,w,M=function(e){function t(t){var n=e.call(this,t)||this;n._panel=a.createRef(),n._animationCallback=null,n._hasCustomNavigation=!(!n.props.onRenderNavigation&&!n.props.onRenderNavigationContent),n.dismiss=function(e){n.props.onDismiss&&n.props.onDismiss(e),(!e||e&&!e.defaultPrevented)&&n.close()},n._allowScrollOnPanel=function(e){e?n._allowTouchBodyScroll?Object(f.b)(e,n._events):Object(f.c)(e,n._events):n._events.off(n._scrollableContent),n._scrollableContent=e},n._onRenderNavigation=function(e){if(!n.props.onRenderNavigationContent&&!n.props.onRenderNavigation&&!n.props.hasCloseButton)return null;var t=n.props.onRenderNavigationContent,r=void 0===t?n._onRenderNavigationContent:t;return a.createElement("div",{className:n._classNames.navigation},r(e,n._onRenderNavigationContent))},n._onRenderNavigationContent=function(e){var t,r=e.closeButtonAriaLabel,o=e.hasCloseButton,i=e.onRenderHeader,c=void 0===i?n._onRenderHeader:i;if(o){var u=null===(t=n._classNames.subComponentStyles)||void 0===t?void 0:t.closeButton();return a.createElement(a.Fragment,null,!n._hasCustomNavigation&&c(n.props,n._onRenderHeader,n._headerTextId),a.createElement(s.a,{styles:u,className:n._classNames.closeButton,onClick:n._onPanelClick,ariaLabel:r,title:r,"data-is-visible":!0,iconProps:{iconName:"Cancel"}}))}return null},n._onRenderHeader=function(e,t,r){var o=e.headerText,s=e.headerTextProps,c=void 0===s?{}:s;return o?a.createElement("div",{className:n._classNames.header},a.createElement("div",Object(i.__assign)({id:r,role:"heading","aria-level":1},c,{className:Object(p.css)(n._classNames.headerText,c.className)}),o)):null},n._onRenderBody=function(e){return a.createElement("div",{className:n._classNames.content},e.children)},n._onRenderFooter=function(e){var t=n.props.onRenderFooterContent,r=void 0===t?null:t;return r?a.createElement("div",{className:n._classNames.footer},a.createElement("div",{className:n._classNames.footerInner},r())):null},n._animateTo=function(e){e===r.open&&n.props.onOpen&&n.props.onOpen(),n._animationCallback=n._async.setTimeout((function(){n.setState({visibility:e}),n._onTransitionComplete()}),200)},n._clearExistingAnimationTimer=function(){null!==n._animationCallback&&n._async.clearTimeout(n._animationCallback)},n._onPanelClick=function(e){n.dismiss(e)},n._onTransitionComplete=function(){n._updateFooterPosition(),n.state.visibility===r.open&&n.props.onOpened&&n.props.onOpened(),n.state.visibility===r.closed&&n.props.onDismissed&&n.props.onDismissed()};var o=n.props.allowTouchBodyScroll,c=void 0!==o&&o;return n._allowTouchBodyScroll=c,n._async=new m.a(n),n._events=new g.a(n),Object(h.a)(n),Object(v.a)(I,t,{ignoreExternalFocusing:"focusTrapZoneProps",forceFocusInsideTrap:"focusTrapZoneProps",firstFocusableSelector:"focusTrapZoneProps"}),n.state={isFooterSticky:!1,visibility:r.closed,id:Object(y.a)("Panel")},n}return Object(i.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){return void 0===e.isOpen?null:!e.isOpen||t.visibility!==r.closed&&t.visibility!==r.animatingClosed?e.isOpen||t.visibility!==r.open&&t.visibility!==r.animatingOpen?null:{visibility:r.animatingClosed}:{visibility:r.animatingOpen}},t.prototype.componentDidMount=function(){this._events.on(window,"resize",this._updateFooterPosition),this._shouldListenForOuterClick(this.props)&&this._events.on(document.body,"mousedown",this._dismissOnOuterClick,!0),this.props.isOpen&&this.setState({visibility:r.animatingOpen})},t.prototype.componentDidUpdate=function(e,t){var n=this._shouldListenForOuterClick(this.props),o=this._shouldListenForOuterClick(e);this.state.visibility!==t.visibility&&(this._clearExistingAnimationTimer(),this.state.visibility===r.animatingOpen?this._animateTo(r.open):this.state.visibility===r.animatingClosed&&this._animateTo(r.closed)),n&&!o?this._events.on(document.body,"mousedown",this._dismissOnOuterClick,!0):!n&&o&&this._events.off(document.body,"mousedown",this._dismissOnOuterClick,!0)},t.prototype.componentWillUnmount=function(){this._async.dispose(),this._events.dispose()},t.prototype.render=function(){var e=this.props,t=e.className,n=void 0===t?"":t,o=e.elementToFocusOnDismiss,s=e.firstFocusableSelector,d=e.focusTrapZoneProps,f=e.forceFocusInsideTrap,p=e.hasCloseButton,m=e.headerText,g=e.headerClassName,h=void 0===g?"":g,v=e.ignoreExternalFocusing,y=e.isBlocking,S=e.isFooterAtBottom,I=e.isLightDismiss,x=e.isHiddenOnDismiss,E=e.layerProps,T=e.overlayProps,P=e.type,w=e.styles,M=e.theme,R=e.customWidth,j=e.onLightDismissClick,k=void 0===j?this._onPanelClick:j,N=e.onRenderNavigation,D=void 0===N?this._onRenderNavigation:N,F=e.onRenderHeader,L=void 0===F?this._onRenderHeader:F,U=e.onRenderBody,B=void 0===U?this._onRenderBody:U,H=e.onRenderFooter,W=void 0===H?this._onRenderFooter:H,V=this.state,z=V.isFooterSticky,G=V.visibility,q=V.id,K=P===O.a.smallFixedNear||P===O.a.customNear,X=Object(b.a)(M)?K:!K,J=P===O.a.custom||P===O.a.customNear?{width:R}:{},Q=Object(_.j)(this.props,_.h),Z=this.isActive,Y=G===r.animatingClosed||G===r.animatingOpen;if(this._headerTextId=m&&q+"-headerText",!Z&&!Y&&!x)return null;this._classNames=A(w,{theme:M,className:n,focusTrapZoneClassName:d?d.className:void 0,hasCloseButton:p,headerClassName:h,isAnimating:Y,isFooterSticky:z,isFooterAtBottom:S,isOnRightSide:X,isOpen:Z,isHiddenOnDismiss:x,type:P,hasCustomNavigation:this._hasCustomNavigation});var $,ee=this._classNames,te=this._allowTouchBodyScroll;return y&&Z&&($=a.createElement(u.a,Object(i.__assign)({className:ee.overlay,isDarkThemed:!1,onClick:I?k:void 0,allowTouchBodyScroll:te},T))),a.createElement(c.a,Object(i.__assign)({},E),a.createElement(l.a,{role:"dialog","aria-modal":"true",ariaLabelledBy:this._headerTextId?this._headerTextId:void 0,onDismiss:this.dismiss,className:ee.hiddenPanel},a.createElement("div",Object(i.__assign)({"aria-hidden":!Z&&Y},Q,{ref:this._panel,className:ee.root}),$,a.createElement(C.a,Object(i.__assign)({ignoreExternalFocusing:v,forceFocusInsideTrap:!(!y||x&&!Z)&&f,firstFocusableSelector:s,isClickableOutsideFocusTrap:!0},d,{className:ee.main,style:J,elementToFocusOnDismiss:o}),a.createElement("div",{className:ee.commands,"data-is-visible":!0},D(this.props,this._onRenderNavigation)),a.createElement("div",{className:ee.contentInner},(this._hasCustomNavigation||!p)&&L(this.props,this._onRenderHeader,this._headerTextId),a.createElement("div",{ref:this._allowScrollOnPanel,className:ee.scrollableContent,"data-is-scrollable":!0},B(this.props,this._onRenderBody)),W(this.props,this._onRenderFooter))))))},t.prototype.open=function(){void 0===this.props.isOpen&&(this.isActive||this.setState({visibility:r.animatingOpen}))},t.prototype.close=function(){void 0===this.props.isOpen&&this.isActive&&this.setState({visibility:r.animatingClosed})},Object.defineProperty(t.prototype,"isActive",{get:function(){return this.state.visibility===r.open||this.state.visibility===r.animatingOpen},enumerable:!0,configurable:!0}),t.prototype._shouldListenForOuterClick=function(e){return!!e.isBlocking&&!!e.isOpen},t.prototype._updateFooterPosition=function(){var e=this._scrollableContent;if(e){var t=e.clientHeight,n=e.scrollHeight;this.setState({isFooterSticky:t<n})}},t.prototype._dismissOnOuterClick=function(e){var t=this._panel.current;this.isActive&&t&&!e.defaultPrevented&&(Object(S.a)(t,e.target)||(this.props.onOuterClick?(this.props.onOuterClick(),e.preventDefault()):this.dismiss()))},t.defaultProps={isHiddenOnDismiss:!1,isOpen:void 0,isBlocking:!0,hasCloseButton:!0,type:O.a.smallFixedFar},t}(a.Component),R=n(14),j={root:"ms-Panel",main:"ms-Panel-main",commands:"ms-Panel-commands",contentInner:"ms-Panel-contentInner",scrollableContent:"ms-Panel-scrollableContent",navigation:"ms-Panel-navigation",closeButton:"ms-Panel-closeButton ms-PanelAction-close",header:"ms-Panel-header",headerText:"ms-Panel-headerText",content:"ms-Panel-content",footer:"ms-Panel-footer",footerInner:"ms-Panel-footerInner",isOpen:"is-open",hasCloseButton:"ms-Panel--hasCloseButton",smallFluid:"ms-Panel--smFluid",smallFixedNear:"ms-Panel--smLeft",smallFixedFar:"ms-Panel--sm",medium:"ms-Panel--md",large:"ms-Panel--lg",largeFixed:"ms-Panel--fixed",extraLarge:"ms-Panel--xl",custom:"ms-Panel--custom",customNear:"ms-Panel--customLeft"},k="100%",N="auto",D=272,F=340,L=592,U=644,B=940,H="auto",W=0,V=48,z=428,G=176,q=((x={})["@media (min-width: "+R.ScreenWidthMinMedium+"px)"]={width:F},x),K=((E={})["@media (min-width: "+R.ScreenWidthMinLarge+"px)"]={width:L},E["@media (min-width: "+R.ScreenWidthMinXLarge+"px)"]={width:U},E),X=((T={})["@media (min-width: "+R.ScreenWidthMinUhfMobile+"px)"]={left:V,width:N},T["@media (min-width: "+R.ScreenWidthMinXXLarge+"px)"]={left:z},T),J=((P={})["@media (min-width: "+R.ScreenWidthMinXXLarge+"px)"]={left:H,width:B},P),Q=((w={})["@media (min-width: "+R.ScreenWidthMinXXLarge+"px)"]={left:G},w),Z=function(e){var t;switch(e){case O.a.smallFixedFar:t=Object(i.__assign)({},q);break;case O.a.medium:t=Object(i.__assign)(Object(i.__assign)({},q),K);break;case O.a.large:t=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},q),K),X);break;case O.a.largeFixed:t=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},q),K),X),J);break;case O.a.extraLarge:t=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},q),K),X),Q)}return t},Y={paddingLeft:"24px",paddingRight:"24px"};n.d(t,"a",(function(){return $}));var $=Object(o.a)(M,(function(e){var t,n=e.className,r=e.focusTrapZoneClassName,o=e.hasCloseButton,a=e.headerClassName,s=e.isAnimating,c=e.isFooterSticky,u=e.isFooterAtBottom,l=e.isOnRightSide,d=e.isOpen,f=e.isHiddenOnDismiss,p=e.hasCustomNavigation,m=e.theme,g=e.type,h=void 0===g?O.a.smallFixedFar:g,v=m.effects,y=m.fonts,b=m.semanticColors,_=Object(R.getGlobalClassNames)(j,m),S=h===O.a.custom||h===O.a.customNear;return{root:[_.root,m.fonts.medium,d&&_.isOpen,o&&_.hasCloseButton,{pointerEvents:"none",position:"absolute",top:0,left:0,right:0,bottom:0},S&&l&&_.custom,S&&!l&&_.customNear,n],overlay:[{pointerEvents:"auto",cursor:"pointer"},d&&s&&R.AnimationClassNames.fadeIn100,!d&&s&&R.AnimationClassNames.fadeOut100],hiddenPanel:[!d&&!s&&f&&{visibility:"hidden"}],main:[_.main,{backgroundColor:b.bodyBackground,boxShadow:v.elevation64,pointerEvents:"auto",position:"absolute",display:"flex",flexDirection:"column",overflowX:"hidden",overflowY:"auto",WebkitOverflowScrolling:"touch",bottom:0,top:0,left:H,right:W,width:k,selectors:Object(i.__assign)((t={},t[R.HighContrastSelector]={borderLeft:"3px solid "+b.variantBorder,borderRight:"3px solid "+b.variantBorder},t),Z(h))},h===O.a.smallFluid&&{left:W},h===O.a.smallFixedNear&&{left:W,right:H,width:D},h===O.a.customNear&&{right:"auto",left:0},S&&{maxWidth:"100vw"},d&&s&&!l&&R.AnimationClassNames.slideRightIn40,d&&s&&l&&R.AnimationClassNames.slideLeftIn40,!d&&s&&!l&&R.AnimationClassNames.slideLeftOut40,!d&&s&&l&&R.AnimationClassNames.slideRightOut40,r],commands:[_.commands,{marginTop:18},p&&{marginTop:"inherit"}],navigation:[_.navigation,{display:"flex",justifyContent:"flex-end"},p&&{height:"44px"}],contentInner:[_.contentInner,{display:"flex",flexDirection:"column",flexGrow:1,overflowY:"hidden"}],header:[_.header,Y,{alignSelf:"flex-start"},o&&!p&&{flexGrow:1},p&&{flexShrink:0}],headerText:[_.headerText,y.xLarge,{color:b.bodyText,lineHeight:"27px",overflowWrap:"break-word",wordWrap:"break-word",wordBreak:"break-word",hyphens:"auto"},a],scrollableContent:[_.scrollableContent,{overflowY:"auto"},u&&{flexGrow:1}],content:[_.content,Y,{paddingBottom:20}],footer:[_.footer,{flexShrink:0,borderTop:"1px solid transparent",transition:"opacity "+R.AnimationVariables.durationValue3+" "+R.AnimationVariables.easeFunction2},c&&{background:b.bodyBackground,borderTopColor:b.variantBorder}],footerInner:[_.footerInner,Y,{paddingBottom:16,paddingTop:16}],subComponentStyles:{closeButton:{root:[_.closeButton,{marginRight:14,color:m.palette.neutralSecondary,fontSize:R.IconFontSizes.large},p&&{marginRight:0,height:"auto",width:"44px"}],rootHovered:{color:m.palette.neutralPrimary}}}}}),void 0,{scope:"Panel"})},9111:function(e,t,n){"use strict";var r=n(2195),o=n(4);t.a=Object(o.mutatorAction)("showBccWell",(function(e){e.bccRecipientWell||(e.bccRecipientWell=Object(r.a)(e.toRecipientWell.findPeopleFeedbackManager,[]))}))},9113:function(e,t,n){"use strict";var r=n(283);t.a=Object(r.action)("updateSubject")((function(e,t){e.subject=t,e.isDirty=!0}))},9114:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.mutatorAction)("updateSubjectSelectionRange",(function(e,t,n){e.selectionStart=t,e.selectionEnd=n}))},947:function(e,t,n){"use strict";var r=n(1286),o=n(1551),i=n(971),a=n(283),s=n(1016),c=Object(a.action)("createFocusedOtherDropViewState")((function(){i.a.focusedOtherDropViewState=Object(s.a)()}));function u(){return i.a.focusedOtherDropViewState||c(),i.a.focusedOtherDropViewState}var l,d=n(1826);n(1882);!function(e){e[e.None=0]="None",e[e.Previous=1]="Previous",e[e.Next=2]="Next"}(l||(l={}));var f=l,p=n(1552),m=n(1857);function g(e){var t=e.isInVirtualSelectAllMode,n=e.virtualSelectAllExclusionList,r=e.selectedRowKeys,o=e.rowKeys,i=e.totalRowsInView,a=e.tableQuery,s=e.isInCheckedMode;return t?0===n.length:(o.length==i||1==a.type)&&(s&&r.size==o.length)}var h=n(1574);function v(e){var t=i.a.tableViews.get(e);switch(null==t?void 0:t.tableQuery.type){case 2:return t.serverFolderId;case 0:return t.tableQuery.folderId;default:return null}}var y=n(1158);function b(){var e=Object(y.a)();return!!e&&1===e.tableQuery.type}var _=n(2464),S=n(2465),C=n(9),O=n(948),A=n(2466),I=n(2467),x=n(1883),E=n(1884),T=n(1109),P=n(1670),w=n(950);function M(e,t,n,r){var o=t.tableQuery,i=t.virtualSelectAllExclusionList,a=t.totalRowsInView;if(e){if(Object(T.e)()&&Object(w.a)("inbox")===o.folderId){var s=Object(P.a)(r);return Object(C.c)(Object(C.b)(E.a),s.displayText)}if(-1!==n)return 0===n?Object(C.b)(_.a):Object(C.b)(I.a);if(1==o.type)return Object(C.b)(S.a);if(pe(t))return Object(C.c)(Object(C.b)(A.a),pe(t));var c=O.d.folderTable.get(o.folderId);return Object(C.c)(Object(C.b)(A.a),Object(O.j)(c))}if($(t)){var u=a-i.length;return Object(ee.a)(t)?Object(C.c)(Object(C.b)(E.d),u):Object(C.c)(Object(C.b)(x.c),u)}return Object(C.b)(S.a)}function R(e){switch(e.tableQuery.type){case 0:case 2:return e.tableQuery.sortBy;default:throw new Error("getSortByForTable: Table Query type should be either of type group, or mail folder")}}function j(e){if(!e)return null;switch(e.tableQuery.type){case 0:case 2:case 1:return e.tableQuery.viewFilter;default:throw new Error("Table Query should be either of type search, mail folder or group")}}function k(e){return e&&"Unread"==j(e)}var N=n(27),D=n(953),F=n(973),L=["drafts","junkemail","recoverableitemsdeletions"];function U(e){var t,n;if(e){var r=Object(O.o)().get(e);if(r&&(-1!=L.indexOf(Object(F.a)(e))||r.treeType===D.c||r.treeType===D.j)||Object(O.G)(e))return 1}return(null===(n=null===(t=Object(N.a)())||void 0===t?void 0:t.UserOptions)||void 0===n?void 0:n.GlobalListViewTypeReact)||0}var B=n(1885),H=n(7);function W(e,t){var n=Object(q.a)(e,t),r=null;return me(i.a.tableViews.get(t).tableQuery.folderId)?r=Object(H.ub)(i.a.inboxPausedDateTime):n&&new Date(n.lastModifiedTimeStamp).toISOString(),{conversationId:n.id,conversationLastSyncTimeStamp:r}}var V=n(79);function z(e,t){switch(t){case 0:case 1:return e.InstanceKey;default:return V.g.warn("listViewType:"+t+" not supported"),null}}var G=n(1245),q=n(1148),K=n(1400),X=n(1886);function J(e,t){for(var n=[],r=0;r<e.length;r++){var o=t.rowIdToRowKeyMap.get(e[r]);o&&Array.prototype.push.apply(n,o)}return n}var Q=n(1593),Z=n(1887);function Y(e){var t;switch(e){case 0:t="Conversation";break;case 1:t="Message";break;default:t="Unknown"}return t}function $(e){var t=e.isInVirtualSelectAllMode,n=e.virtualSelectAllExclusionList;return t&&n.length>0}var ee=n(1829);function te(e){return e.folderId===Object(w.a)(D.b)||e.folderId===Object(w.a)(D.g)}var ne=n(1177),re=n(0);function oe(e,t,n){var o=[];return t.forEach((function(t){var i=r.getItemIds(t,n);"Flagged"==e.FlagStatus?o.push(i[0]):o.push.apply(o,Object(re.__spread)(i))})),o}function ie(e,t,n){return!Object(ae.a)(e)&&(t&&n)}var ae=n(1595),se=n(1830),ce=n(1368),ue=n(1573);function le(){return!Object(y.a)().isInCheckedMode&&i.a.expandedConversationViewState.selectedNodeIds.length>0}function de(e){var t=i.a.tableViews.get(e),n=Object(p.a)(t),r=t.tableQuery,o=t.selectedRowKeys,a=g(t);if(a||$(t))return M(a,t,n,Object(m.a)(e));var s=le()?i.a.expandedConversationViewState.selectedNodeIds.length:o.size;return 1==r.listViewType||le()?0===s?Object(C.b)(x.a):1===s?Object(C.b)(x.b):Object(C.c)(Object(C.b)(x.c),s):0===s?Object(C.b)(E.b):1===s?Object(C.b)(E.c):Object(C.c)(Object(C.b)(E.d),s)}function fe(e,t){return e?-1!==Object(p.a)(e)||0!==Object(m.a)(e.id)||"All"!==t&&"UserCategory"!==t:null}function pe(e){return 0===e.tableQuery.type&&"UserCategory"===e.tableQuery.viewFilter?e.tableQuery.categoryName:null}function me(e){return i.a.inboxPausedDateTime&&e&&"inbox"===Object(F.a)(e)}var ge=n(1888);n(1635);function he(e){return"persona"===e||"privatedistributionlist"===e||"category"===e}function ve(e,t){e.currentRowOperation=t,Promise.resolve().then((function(){e.currentRowOperation=0}))}n.d(t,"m",(function(){return u})),n.d(t,"o",(function(){return d.a})),n.d(t,"F",(function(){return i.b})),n.d(t,"T",(function(){return i.a})),n.d(t,"d",(function(){return f})),n.d(t,"l",(function(){return p.a})),n.d(t,"p",(function(){return m.a})),n.d(t,"q",(function(){return g})),n.d(t,"i",(function(){return h.a})),n.d(t,"j",(function(){return h.b})),n.d(t,"n",(function(){return v})),n.d(t,"s",(function(){return b})),n.d(t,"B",(function(){return M})),n.d(t,"C",(function(){return y.a})),n.d(t,"E",(function(){return R})),n.d(t,"K",(function(){return j})),n.d(t,"X",(function(){return k})),n.d(t,"w",(function(){return U})),n.d(t,"k",(function(){return B.a})),n.d(t,"h",(function(){return W})),n.d(t,"z",(function(){return z})),n.d(t,"I",(function(){return G.a})),n.d(t,"G",(function(){return q.a})),n.d(t,"H",(function(){return K.a})),n.d(t,"y",(function(){return X.a})),n.d(t,"A",(function(){return J})),n.d(t,"R",(function(){return Q.a})),n.d(t,"g",(function(){return Z.a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"x",(function(){return Y})),n.d(t,"Q",(function(){return $})),n.d(t,"L",(function(){return ee.a})),n.d(t,"M",(function(){return te})),n.d(t,"t",(function(){return ne.b})),n.d(t,"r",(function(){return ne.a})),n.d(t,"u",(function(){return oe})),n.d(t,"W",(function(){return ie})),n.d(t,"f",(function(){return ae.a})),n.d(t,"e",(function(){return se.a})),n.d(t,"D",(function(){return ce.a})),n.d(t,"U",(function(){return ue.a})),n.d(t,"v",(function(){return de})),n.d(t,"S",(function(){return le})),n.d(t,"O",(function(){return fe})),n.d(t,"J",(function(){return pe})),n.d(t,"P",(function(){return me})),n.d(t,"a",(function(){return ge.a})),n.d(t,"N",(function(){return he})),n.d(t,"V",(function(){return ve}))},948:function(e,t,n){"use strict";var r=n(108),o=n(976),i=n(4),a=n(1209),s=n(987),c=(Object(i.mutator)(a.a,(function(e){var t=e.folderTreeId,n=e.userIdentity,r=e.loadingState;Object(s.a)(n).get(t).loadingState=r})),n(0)),u=Object(i.action)("PERSONA_SEARCH_FOLDERS_LOADED",(function(e,t){return{existingFolders:e,personaOrPdlFavorites:t}})),l=n(985),d=(Object(i.mutator)(u,(function(e){e.existingFolders.forEach((function(t){if(t){var n=t.FolderId.Id,r=e.personaOrPdlFavorites.filter((function(e){return e.searchFolderId===n}));if(1===r.length){var o=r[0].displayName,i=Object(c.__assign)(Object(c.__assign)({},t),{DisplayName:o});Object(l.a)().set(t.FolderId.Id,i)}}}))})),n(974)),f=n(431),p=n(283);function m(e,t){t.forEach((function(t){e.folderTable.delete(t)}))}var g=Object(p.action)("removeFolderFromParentFolder")((function(e,t){if(t.ParentFolderId){var n=e.folderTable.get(t.ParentFolderId.Id).childFolderIds;n.splice(n.indexOf(t.FolderId.Id),1)}}));function h(e,t,n){for(var r=t.folderTable.get(n).childFolderIds,o=!1,i=Z(e).toLowerCase(),a=0;a<r.length&&!o;a++){Z(t.folderTable.get(r[a])).toLowerCase()>i&&(r.splice(a,0,e.FolderId.Id),o=!0)}o||r.push(e.FolderId.Id)}var v=Object(p.action)("moveFolderToParentFolder")((function(e,t,n){h(t,e,n),t.ParentFolderId=Object(f.a)({Id:n}),t.treeType=Object(d.e)(n,e)})),y=n(1348),b=n(993);Object(i.mutator)(b.a,(function(e){var t,n,r,o,i,a,s;t=e.folderStore,n=e.folder,r=e.parentFolderId,o=e.displayName,i=Object(y.a)(r),a=Object(l.a)().get(r).treeType,s=Object(c.__assign)({DisplayName:o,ParentFolderId:i,childFolderIds:[],FolderClass:"IPF.Note",distinguishedFolderId:void 0,UnreadCount:0,TotalCount:0,treeType:a},n),t.folderTable.set(n.FolderId.Id,s),h(s,t,i.Id)}));var _=n(953),S=n(103),C=Object(i.action)("REMOVE_FOLDERTREE_DATA",(function(e,t){return{folderTreeId:e,userIdentity:t}})),O=n(1025),A=Object(i.mutatorAction)("setFolderTreeData",(function(e,t,n,r,o,i){void 0===r&&(r=!1),void 0===o&&(o=0);var a={id:e,rootFolder:t,loadingState:n,hasMoreData:r,currentLoadedIndex:o};Object(s.a)(i).set(e,a)}));Object(i.orchestrator)(b.f,(function(){var e={DistinguishedFolderId:_.d,DisplayName:Object(S.i)().SessionSettings.ArchiveDisplayName};A(_.d,e,O.a.Uninitialized)})),Object(i.mutator)(C,(function(e){Object(s.a)(e.userIdentity).delete(e.folderTreeId)}));var I=n(1323),x=function(e){return Object(I.c)(e,"0x7018")},E=n(9),T=n(1210),P=n(1961),w=n(24);Object(i.orchestrator)(T.a,(function(e){var t=e.rootFolder,n=e.treeType,r=e.principalSMTPAddress,o=e.displayName,i=e.folderTreeIdentifier,a=e.userIdentity;if(M(t,n,r,o),A(i,Object(l.a)().get(t.ParentFolder.FolderId.Id),O.a.Loaded,!t.IncludesLastItemInRange,t.IndexedPagingOffset,a),n===_.h)for(var s=0;s<t.Folders.length;s++){var c=t.Folders[s],u=c.FolderId.Id,d=c.DistinguishedFolderId;Object(E.f)(d)||Object(S.a)(d,u)}}));Object(i.orchestrator)(P.b,(function(e){var t=e.rootFolder,n=e.treeType,r=e.principalSMTPAddress;M(t,n,r)}));var M=Object(i.mutatorAction)("updateFolderTable",(function(e,t,n,r){var i=e.ParentFolder,a=function(e,t){return t===_.j?null:e.DistinguishedFolderId}(i,t),s={},c=s[i.FolderId.Id]=R(i,a,t,n);r&&(c.DisplayName=r);for(var u=[],d=0;d<e.Folders.length;d++){var f=e.Folders[d],p=f.FolderId.Id,m=f.DistinguishedFolderId;j(m,f)&&(s[p]=R(f,m,t,n),u.push(p))}u.forEach((function(e){var t=s[e],n=s[t.ParentFolderId.Id]||Object(l.a)().get(t.ParentFolderId.Id);n&&!t.isHidden&&n.childFolderIds.push(e)})),0==Object(l.a)().size?Object(o.a)().folderTable=new w.ObservableMap(s):Object.keys(s).forEach((function(e){Object(l.a)().set(e,s[e])}))}));function R(e,t,n,r){return Object(l.a)().has(e.FolderId.Id)?Object(l.a)().get(e.FolderId.Id):Object(c.__assign)({childFolderIds:[],distinguishedFolderId:t,UnreadCount:e.UnreadCount,TotalCount:e.TotalCount,isHidden:Object(I.d)(e),remoteFolderDisplayName:x(e),sourceWellKnownFolderType:Object(I.e)(e),treeType:n,principalSMTPAddress:r},e)}function j(e,t){var n=!!Object(S.i)().SegmentationSettings.JunkEMail;if("junkemail"===e&&!n)return!1;var r=!!Object(S.i)().SegmentationSettings.StickyNotes;return!("notes"===e&&!r)&&("clutter"!==e||0!==t.TotalCount)}var k=n(950);function N(e,t,n){var r;if(r="string"==typeof n?e.folderTable.get(n):e.folderTable.get(Object(k.a)(n)))for(var o=r.childFolderIds,i=t.toLowerCase(),a=0;a<o.length;a++){var s=o[a],c=e.folderTable.get(s);if(c&&c.DisplayName.toLowerCase()==i)return!0}return!1}function D(e,t){var n=[e];return t.folderTable.get(e).childFolderIds.forEach((function(e){Array.prototype.push.apply(n,D(e,t))})),n}function F(e){var t=Object(l.a)().get(e);return!!t.childFolderIds&&t.childFolderIds.filter((function(e){var t=Object(l.a)().get(e);return Object(d.g)(t)})).length>0}function L(e,t){return function e(t,n,r){var o=[];if(0===n){var i=e(t,n+1,r);o.push.apply(o,Object(c.__spread)(i))}else t.forEach((function(t){var i=Object(l.a)().get(t);if(Object(d.g)(i)&&(o.push(Object(c.__assign)(Object(c.__assign)({},i),{depth:n})),F(t)&&r(t))){var a=e(i.childFolderIds,n+1,r);o.push.apply(o,Object(c.__spread)(a))}}));return o}(e,0,t)}var U,B={folderTable:new w.ObservableMap,mailboxFolderTreeData:new w.ObservableMap};var H=function(e,t){B.folderTable.set(e.FolderId.Id,e),e.ParentFolderId&&B.folderTable.get(e.ParentFolderId.Id).childFolderIds.push(e.FolderId.Id),e.distinguishedFolderId&&(U[e.distinguishedFolderId]=e.FolderId.Id)};H=Object(p.action)("addFolderToStore-TestMethod")(H);var W=Object(i.action)("INITIALIZE_SHARED_FOLDERS"),V=n(1340),z=n(1184),G=n(1183),q=n(1349);n(1035);function K(e){var t=Object(s.a)(),n=t&&t.get(e);return null==n?void 0:n.hasMoreData}var X=n(1350),J=n(1185),Q=n(27);function Z(e){return e?Object(Q.a)().SessionSettings.IsShadowMailbox&&e.remoteFolderDisplayName?e.remoteFolderDisplayName:e.DisplayName:""}var Y=n(297),$=n(1908),ee=n(254),te=n(1396);var ne=Object(i.mutatorAction)("setMailboxFolderTreeData",(function(e,t){Object(o.a)().mailboxFolderTreeData.set(e,t)}));function re(e){return Object(c.__awaiter)(this,void 0,void 0,(function(){var t,n,r,o;return Object(c.__generator)(this,(function(i){switch(i.label){case 0:if(t=Object(S.c)(),Object(s.b)(t)||ne(t,function(){var e;return{folderTreeTable:new w.ObservableMap((e={},e[_.i]={id:_.i,rootFolder:{DistinguishedFolderId:_.i,DisplayName:_.i},loadingState:O.a.Uninitialized},e)),sharedFolderUserEmails:[]}}()),(n=Object(q.a)(_.i,t))==O.a.Loading||n==O.a.Loaded&&!e)return[2];if(Object(a.a)(_.i,O.a.Loading,t),r=Object(te.d)())return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),o=Object(X.a)(_.i),[4,Object($.b)(Object(Y.a)({Id:_.i}),o,t)];case 2:return r=i.sent(),[3,4];case 3:return i.sent(),Object(a.a)(_.i,O.a.ErrorLoading,t),[2];case 4:return r&&r.RootFolder&&r.RootFolder.Folders&&r.RootFolder.ParentFolder?(Object(T.a)(r.RootFolder,_.i,_.h,t,Object(Q.a)().SessionSettings.UserDisplayName,_.i,t),function(){var e,t,n=null===(e=Object(l.a)().get(Object(k.a)("inbox")))||void 0===e?void 0:e.childFolderIds.length,r=null===(t=Object(l.a)().get(Object(k.a)("msgfolderroot")))||void 0===t?void 0:t.TotalCount;Object(ee.o)("TnS_LoadFolders",[n,r]);var o=Object(l.a)().get(Object(k.a)("notes"));if(o){var i=o.TotalCount,a=o.ChildFolderCount;Object(ee.o)("Notes_LoadFolders",{noteCount:i,childFolderCount:a})}}(),[2]):(Object(a.a)(_.i,O.a.ErrorLoading,t),[2])}}))}))}var oe=n(1081),ie=Object(p.select)({folderTable:function(){return o.b.folderTable}})((function(e,t){return Object(oe.c)(e,"msgfolderroot",t)}));function ae(e){return Object(oe.a)(o.b.folderTable.get(e),"msgfolderroot")}n(1219);var se=n(1357);n.d(t,"K",(function(){return ue})),n.d(t,"L",(function(){return le})),n.d(t,"O",(function(){return de})),n.d(t,"P",(function(){return fe})),n.d(t,"I",(function(){return pe})),n.d(t,"M",(function(){return me})),n.d(t,"N",(function(){return ge})),n.d(t,"J",(function(){return he})),n.d(t,"y",(function(){return o.a})),n.d(t,"f",(function(){return N})),n.d(t,"g",(function(){return D})),n.d(t,"k",(function(){return L})),n.d(t,"z",(function(){return F})),n.d(t,"a",(function(){return O.a})),n.d(t,"T",(function(){return u})),n.d(t,"e",(function(){return m})),n.d(t,"U",(function(){return g})),n.d(t,"Q",(function(){return v})),n.d(t,"c",(function(){return b.a})),n.d(t,"A",(function(){return b.f})),n.d(t,"n",(function(){return b.e})),n.d(t,"m",(function(){return b.d})),n.d(t,"ab",(function(){return b.k})),n.d(t,"Z",(function(){return b.i})),n.d(t,"R",(function(){return b.g})),n.d(t,"B",(function(){return W})),n.d(t,"V",(function(){return C})),n.d(t,"S",(function(){return T.a})),n.d(t,"X",(function(){return a.a})),n.d(t,"i",(function(){return V.a})),n.d(t,"h",(function(){return z.a})),n.d(t,"v",(function(){return G.a})),n.d(t,"o",(function(){return l.a})),n.d(t,"r",(function(){return q.a})),n.d(t,"q",(function(){return K})),n.d(t,"p",(function(){return X.a})),n.d(t,"x",(function(){return J.a})),n.d(t,"j",(function(){return Z})),n.d(t,"W",(function(){return A})),n.d(t,"w",(function(){return re})),n.d(t,"F",(function(){return ie})),n.d(t,"E",(function(){return ae})),n.d(t,"H",(function(){return oe.c})),n.d(t,"D",(function(){return oe.a})),n.d(t,"Y",(function(){return d.g})),n.d(t,"l",(function(){return d.b})),n.d(t,"t",(function(){return d.d})),n.d(t,"C",(function(){return d.f})),n.d(t,"b",(function(){return d.a})),n.d(t,"s",(function(){return d.c})),n.d(t,"G",(function(){return se.b})),n.d(t,"u",(function(){return s.b}));t.d=o.b;var ce=new r.c((function(){return n.e(288).then(n.bind(null,15054))})),ue=new r.b(ce,(function(e){return e.getArchiveFolders})),le=new r.b(ce,(function(e){return e.getFolderPermissions})),de=new r.b(ce,(function(e){return e.updateFolderPermissions})),fe=new r.b(ce,(function(e){return e.updateFolderPermissionsInStore})),pe=new r.b(ce,(function(e){return e.arePermissionArraysEqual})),me=(new r.b(ce,(function(e){return e.arePermissionsEqual})),new r.b(ce,(function(e){return e.getSharedFolders}))),ge=new r.a(ce,(function(e){return e.updateFolder})),he=new r.a(ce,(function(e){return e.createNewFolder}))},953:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"i",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"k",(function(){return u})),n.d(t,"j",(function(){return l})),n.d(t,"h",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"e",(function(){return p}));var r="archivemsgfolderroot",o="msgfolderroot",i="archivedeleteditems",a="deleteditems",s="archiverecoverableitemsdeletions",c="recoverableitemsdeletions",u="msgfolderroot",l="sharedFolderTree",d="primaryFolderTree",f="archiveFolderTree",p="favorites"},956:function(e,t,n){"use strict";var r=n(108),o=n(317),i=n(285),a=n(318);function s(e,t){return void 0===t&&(t="OWA.UserOptions"),Object(a.a)(t,e.map((function(e){return Object(o.a)({DictionaryKey:Object(i.a)({Type:"String",Value:[e.propertyName]}),DictionaryValue:Object(i.a)({Type:e.propertyType,Value:Array.isArray(e.propertyValue)?e.propertyValue:[e.propertyValue]})})})))}var c=n(0);function u(e){return Object(c.__assign)({__type:"SetMailboxMessageConfigurationRequest:#Exchange"},e)}var l=n(25);var d=n(246);function f(e){return void 0===(t=u({Header:Object(d.a)(),Options:(r=e,Object(c.__assign)({__type:"MailboxMessageConfigurationOptions:#Exchange"},r))}))||t.__type||(t=u(t)),Object(l.a)("SetMailboxMessageConfiguration",t,n);var t,n,r}function p(e,t){return null===e?t:e}var m=n(4),g=n(103),h=n(316),v=Object(m.mutatorAction)("updateSessionSettings",(function(e){h(Object(g.i)().SessionSettings,e)})),y=n(316),b=Object(m.mutatorAction)("updateUserOptions",(function(e){y(Object(g.i)().UserOptions,e)}));function _(e){var t=A(e);return!!t&&t.reduce((function(e,t){return e||t.fullOptionFormSettings.isDirty()}),!1)}function S(e){var t=A(e);return t&&t.reduce((function(e,t){return e&&!!t.fullOptionFormSettings.hideSaveDiscard&&t.fullOptionFormSettings.hideSaveDiscard()}),!0)}function C(e){var t=A(e);return!t||t.filter((function(e){return e.fullOptionFormSettings.isDirty()})).reduce((function(e,t){return e&&!!t.fullOptionFormSettings.disableSave&&t.fullOptionFormSettings.disableSave()}),!0)}function O(e,t,n,o,i){var a=new r.b(t,n),s=o&&i?new r.b(o,i):null;return Object(c.__assign)(Object(c.__assign)({},e),{tryImportFullOptionFormSettingsSync:function(){return a.tryImportForRender()},tryImportQuickOptionSettingsSync:s?function(){return s.tryImportForRender()}:void 0})}function A(e){var t=e.options.map((function(e){return function(e){return"fullOptionFormSettings"in e}(e)?e:Object(c.__assign)(Object(c.__assign)({},e),{fullOptionFormSettings:e.tryImportFullOptionFormSettingsSync()})}));return t.some((function(e){return!e.fullOptionFormSettings}))?null:t}var I=n(1537);n.d(t,"g",(function(){return E})),n.d(t,"a",(function(){return T})),n.d(t,"l",(function(){return s})),n.d(t,"h",(function(){return f})),n.d(t,"c",(function(){return p})),n.d(t,"k",(function(){return v})),n.d(t,"m",(function(){return b})),n.d(t,"f",(function(){return _})),n.d(t,"e",(function(){return S})),n.d(t,"i",(function(){return C})),n.d(t,"b",(function(){return O})),n.d(t,"j",(function(){return A})),n.d(t,"d",(function(){return I.a}));var x=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(439)]).then(n.bind(null,15281))})),E=new r.a(x,(function(e){return e.confirmOptionNavigation})),T=Object(r.d)(x,(function(e){return e.OptionsEditor}))},960:function(e,t,n){"use strict";var r=n(108),o=n(1232),i=n(988),a=n(4),s=[i.a.SurfaceActions];Object(a.orchestrator)(o.a,(function(e){var t=e.defaultOptions;s.forEach((function(e){t[e]&&Object(i.f)(Number(e),t[e])}))}));var c=n(1017);n.d(t,"e",(function(){return l})),n.d(t,"h",(function(){return d})),n.d(t,"f",(function(){return f})),n.d(t,"g",(function(){return p})),n.d(t,"c",(function(){return c.a})),n.d(t,"d",(function(){return i.d})),n.d(t,"b",(function(){return i.b})),n.d(t,"a",(function(){return i.a}));var u=new r.c((function(){return n.e(440).then(n.bind(null,15122))})),l=new r.a(u,(function(e){return e.createOrUpdateOptionsForFeature})),d=new r.a(u,(function(e){return e.updateAddinPinStatus})),f=new r.b(u,(function(e){return e.getServerOptionsForFeature})),p=new r.a(u,(function(e){return e.loadOptions}))},9625:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(1401),o=n(1579),i=function(e){return function(t,n){Object(r.a)(e,t,n)}},a=function(e){return function(t){Object(o.a)(e,t)}},s=function(e){return function(){return e.infoBarIds}}},963:function(e,t,n){"use strict";var r=n(108),o=n(965),i=n(1669),a=n(1386),s=n(1291),c="ChronologicalNewestOnBottom";function u(e,t){return e[t==c?0:e.length-1]}var l=n(114),d=n(2233),f=n(431),p=n(1737),m=n(2234),g=n(553),h=n(2235),v=n(246),y=n(950),b=["journal","outbox","syncissues"];function _(e){return"ChronologicalNewestOnBottom"==e?"DateOrderAscending":"DateOrderDescending"}function S(e){var t=[];return e||b.forEach((function(e){var n=Object(y.a)(e);n&&t.push(Object(f.a)({Id:n}))})),t}function C(e,t,n,r,o,i,a,s){void 0===a&&(a="Default");var c=Object(d.a)({ConversationId:Object(g.a)(e)});c.SyncState=i?"":n;var u=function(e,t,n,r,o,i){return Object(m.a)({Conversations:[e],ItemShape:t,ShapeName:"ItemPart",SortOrder:_(n),MaxItemsToReturn:r,Action:o,FoldersToIgnore:S(i),ReturnSubmittedItems:!0})}(c,t,o,r,a,function(e){var t=e.mailboxInfo;return t&&t.type==l.a.GroupMailbox}(e)),f=Object(v.a)();return f.RequestServerVersion="V2017_08_18",Object(h.a)(Object(p.a)({Header:f,Body:u}),s).then((function(e){return e.Body.ResponseMessages.Items[0]}))}var O=n(484),A=n(964),I=n(1421);function x(e){return Object(s.a)([e],Object(O.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(A.a)({FieldURI:"TailoredXpEntities"}),Object(A.a)({FieldURI:"TailoredXpCalendarEventIds"}),Object(A.a)({FieldURI:"TailoredXpEntitiesStatus"}),Object(A.a)({FieldURI:"EntityNamesMap"})]}),"ItemTailoredXpData","Exchange2013").then((function(e){return function(e){if(Object(I.a)(e[0])){var t=e[0].Items[0];return{TailoredXpEntities:t.TailoredXpEntities,TailoredXpCalendarEventIds:t.TailoredXpCalendarEventIds,TailoredXpEntitiesStatus:t.TailoredXpEntitiesStatus,EntityNamesMap:t.EntityNamesMap}}return{}}(e)}))}function E(e){return o.a.items.get(e)}var T=n(27);function P(e){var t=o.a.conversations.get(e);if(t){var n=Object(T.a)().UserOptions.ConversationSortOrderReact;return t.conversationNodeIds.length>0&&!t.loadingState.hasLoadFailed&&t.conversationSortOrder==n}return!1}var w=n(1367),M=n(948),R=n(283),j=Object(R.select)({folderTable:function(){return M.d.folderTable}})((function(e,t){var n=t.folderTable.get(e);return!!n&&Object(M.Y)(n)})),k=n(953);function N(e,t){var n=M.d.folderTable.get(e);return!!n&&(Object(M.H)(n,k.d,t)||n.DistinguishedFolderId===k.b)}function D(e){return N(e)||function(e){var t=M.d.folderTable.get(e);return t&&t.distinguishedFolderId===k.d}(e)}var F=Object(R.select)({folderTable:function(){return M.d.folderTable}})((function(e,t,n){return Object(M.H)(e,t,n)})),L=n(1594),U=n(1259);function B(e){return e&&(Object(U.a)(e,k.g)||Object(U.a)(e,k.b))}function H(e){return e&&(F(e,k.f)||F(e,k.a))}var W=n(1513);function V(e,t){try{return z(e,t)}catch(e){return null}}function z(e,t){if(!e||!t)return null;var n=Object(M.o)().get(e).PermissionSet.Permissions.filter((function(e){return e.UserId.PrimarySmtpAddress===t}));return null==n?void 0:n[0]}var G=n(295),q="OneOff",K="Unknown";function X(e,t,n){return!Object(G.a)()&&(n==q||n==K)&&(null==e?void 0:e.indexOf(t))<0}var J=n(4),Q=Object(J.mutatorAction)("setIsDraftQueuedForSubmission",(function(e,t){var n=Object(o.b)().items.get(null==e?void 0:e.Id);n&&(n.isDraftQueuedForSubmission=t)})),Z=n(76),Y=n(296);function $(e){Object(Z.h)("rp-omeRevocation")&&e.AdditionalProperties.push(Object(Y.a)({PropertyName:"x-ms-exchange-organization-ome-messagestate",DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"}))}n.d(t,"u",(function(){return te})),n.d(t,"w",(function(){return o.a})),n.d(t,"i",(function(){return o.b})),n.d(t,"a",(function(){return i.a})),n.d(t,"b",(function(){return a.a})),n.d(t,"g",(function(){return s.a})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return C})),n.d(t,"v",(function(){return x})),n.d(t,"x",(function(){return E})),n.d(t,"s",(function(){return P})),n.d(t,"d",(function(){return w.a})),n.d(t,"t",(function(){return j})),n.d(t,"o",(function(){return N})),n.d(t,"n",(function(){return D})),n.d(t,"p",(function(){return F})),n.d(t,"l",(function(){return L.a})),n.d(t,"m",(function(){return B})),n.d(t,"r",(function(){return H})),n.d(t,"h",(function(){return W.a})),n.d(t,"j",(function(){return V})),n.d(t,"k",(function(){return z})),n.d(t,"q",(function(){return X})),n.d(t,"y",(function(){return Q})),n.d(t,"c",(function(){return $}));var ee=new r.c((function(){return n.e(653).then(n.bind(null,15328))})),te=new r.a(ee,(function(e){return e.setTriageActionAnnouncement}))},964:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"PropertyUri:#Exchange"},e)}},965:function(e,t,n){"use strict";n.d(t,"b",(function(){return a}));var r=n(24),o=n(4),i={conversationNodes:new r.ObservableMap({}),conversations:new r.ObservableMap({}),items:new r.ObservableMap({}),searchFolderDisplayName:null,typeOfItemBeingDragged:null,triageAnnouncement:{message:null,politenessSetting:"off"}},a=Object(o.createStore)("mail",i),s=a();t.a=s},966:function(e,t,n){"use strict";var r=n(972),o=n(1361),i=n(9);function a(e){var t;return e>=1073741824?(e/=1073741824,t=Object(i.b)(o.b)):e>=1048576?(e/=1048576,t=Object(i.b)(o.d)):e>=1024?(e/=1024,t=Object(i.b)(o.c)):t=Object(i.b)(o.a),Object(i.c)(t,Math.round(e))}var s,c=n(1091),u=n(76),l=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function d(e){if(!Object(u.h)("doc-attachment-documentThumbnail"))return!1;var t=Object(r.a)(e);return!!t&&l.indexOf(t.toLowerCase())>=0}function f(e){switch(e){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return s.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return s.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return s.PowerPoint;default:return null}}!function(e){e[e.Word=0]="Word",e[e.Excel=1]="Excel",e[e.PowerPoint=2]="PowerPoint"}(s||(s={}));var p=n(1011);n.d(t,"b",(function(){return r.a})),n.d(t,"c",(function(){return r.b})),n.d(t,"d",(function(){return r.c})),n.d(t,"i",(function(){return a})),n.d(t,"g",(function(){return c.a})),n.d(t,"h",(function(){return d})),n.d(t,"f",(function(){return f})),n.d(t,"e",(function(){return p.b})),n.d(t,"a",(function(){return s}))},967:function(e,t,n){"use strict";var r,o,i;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i})),function(e){e[e.tiny=0]="tiny",e[e.extraExtraSmall=1]="extraExtraSmall",e[e.extraSmall=2]="extraSmall",e[e.small=3]="small",e[e.regular=4]="regular",e[e.large=5]="large",e[e.extraLarge=6]="extraLarge",e[e.size8=17]="size8",e[e.size10=9]="size10",e[e.size16=8]="size16",e[e.size24=10]="size24",e[e.size28=7]="size28",e[e.size32=11]="size32",e[e.size40=12]="size40",e[e.size48=13]="size48",e[e.size56=16]="size56",e[e.size72=14]="size72",e[e.size100=15]="size100",e[e.size120=18]="size120"}(r||(r={})),function(e){e[e.none=0]="none",e[e.offline=1]="offline",e[e.online=2]="online",e[e.away=3]="away",e[e.dnd=4]="dnd",e[e.blocked=5]="blocked",e[e.busy=6]="busy"}(o||(o={})),function(e){e[e.lightBlue=0]="lightBlue",e[e.blue=1]="blue",e[e.darkBlue=2]="darkBlue",e[e.teal=3]="teal",e[e.lightGreen=4]="lightGreen",e[e.green=5]="green",e[e.darkGreen=6]="darkGreen",e[e.lightPink=7]="lightPink",e[e.pink=8]="pink",e[e.magenta=9]="magenta",e[e.purple=10]="purple",e[e.black=11]="black",e[e.orange=12]="orange",e[e.red=13]="red",e[e.darkRed=14]="darkRed",e[e.transparent=15]="transparent",e[e.violet=16]="violet",e[e.lightRed=17]="lightRed",e[e.gold=18]="gold",e[e.burgundy=19]="burgundy",e[e.warmGray=20]="warmGray",e[e.coolGray=21]="coolGray",e[e.gray=22]="gray",e[e.cyan=23]="cyan",e[e.rust=24]="rust"}(i||(i={}))},969:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"c",(function(){return u}));var r,o,i,a=n(967);!function(e){e.size8="20px",e.size10="20px",e.size16="16px",e.size24="24px",e.size28="28px",e.size32="32px",e.size40="40px",e.size48="48px",e.size56="56px",e.size72="72px",e.size100="100px",e.size120="120px"}(o||(o={})),function(e){e.size6="6px",e.size8="8px",e.size12="12px",e.size16="16px",e.size20="20px",e.size28="28px",e.size32="32px",e.border="2px"}(i||(i={}));var s=function(e){return{isSize8:e===a.c.size8,isSize10:e===a.c.size10||e===a.c.tiny,isSize16:e===a.c.size16,isSize24:e===a.c.size24||e===a.c.extraExtraSmall,isSize28:e===a.c.size28||e===a.c.extraSmall,isSize32:e===a.c.size32,isSize40:e===a.c.size40||e===a.c.small,isSize48:e===a.c.size48||e===a.c.regular,isSize56:e===a.c.size56,isSize72:e===a.c.size72||e===a.c.large,isSize100:e===a.c.size100||e===a.c.extraLarge,isSize120:e===a.c.size120}},c=((r={})[a.c.tiny]=10,r[a.c.extraExtraSmall]=24,r[a.c.extraSmall]=28,r[a.c.small]=40,r[a.c.regular]=48,r[a.c.large]=72,r[a.c.extraLarge]=100,r[a.c.size8]=8,r[a.c.size10]=10,r[a.c.size16]=16,r[a.c.size24]=24,r[a.c.size28]=28,r[a.c.size32]=32,r[a.c.size40]=40,r[a.c.size48]=48,r[a.c.size56]=56,r[a.c.size72]=72,r[a.c.size100]=100,r[a.c.size120]=120,r),u=function(e){return{isAvailable:e===a.b.online,isAway:e===a.b.away,isBlocked:e===a.b.blocked,isBusy:e===a.b.busy,isDoNotDisturb:e===a.b.dnd,isOffline:e===a.b.offline}}},971:function(e,t,n){"use strict";n.d(t,"b",(function(){return a}));var r=n(24),o=n(4),i={conversationItems:new r.ObservableMap({}),itemContextMenuState:null,selectedTableViewId:null,tableViewConversationRelations:new r.ObservableMap({}),tableViewItemRelations:new r.ObservableMap({}),tableViews:new r.ObservableMap({}),attachmentViewStates:new r.ObservableMap({}),expandedConversationViewState:{expandedRowKey:null,focusedNodeId:null,selectedNodeIds:[],allNodeIds:[],shouldBeExpanded:!1,busStopStateMap:new r.ObservableMap({})},rowAttachmentPreviewWellViews:new r.ObservableMap({}),focusedOtherDropViewState:null,couponPeekPreviews:new r.ObservableMap({}),rowInfoForVLV:new r.ObservableMap({}),meetingMessageItems:new r.ObservableMap({}),offsetHeight:0,scrollTop:0,inboxPausedDateTime:null,inboxPausedLength:null,txpActionButtonData:new r.ObservableMap({})},a=Object(o.createStore)("listview",i),s=a();t.a=s},972:function(e,t,n){"use strict";function r(e){if(!e)return null;var t=e.lastIndexOf(".");return t>0?e.substr(t).toLowerCase():null}function o(e){var t=r(e);return t?t.replace(".",""):null}function i(e){var t;return(null===(t=o(e))||void 0===t?void 0:t.substring(0,4))||""}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i}))},973:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(48);function o(e){if(!e)throw new Error("Input parameter to folderIdToName must not be null.");return r.a.defaultFolderIdToNameMap.get(e)||"none"}},974:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return m})),n.d(t,"g",(function(){return g})),n.d(t,"b",(function(){return h})),n.d(t,"d",(function(){return v})),n.d(t,"f",(function(){return y})),n.d(t,"e",(function(){return b}));var r=n(27),o=n(950),i=n(973),a=n(976),s=n(1183),c=n(985),u=n(1184),l=n(76),d=n(1185),f=n(295),p=["journal","outbox","syncissues"];function m(){var e=Object(f.a)()?["inbox","junkemail","drafts","sentitems","scheduled","deleteditems","archive"]:["inbox","drafts","sentitems","scheduled","deleteditems","junkemail","archive"];return Object(l.h)("notes-folder-view")&&e.push("notes"),e}function g(e){if(!function(e){return e&&"Folder:#Exchange"==e.__type}(e))return!1;if(e.isHidden||p.indexOf(Object(i.a)(e.FolderId.Id))>=0)return!1;var t=Object(r.a)();return"notes"==Object(i.a)(e.FolderId.Id)?t.SegmentationSettings.StickyNotes&&Object(l.h)("cal-stickyNotesFolder"):!("junkemail"==Object(i.a)(e.FolderId.Id)&&!t.SegmentationSettings.JunkEMail)}function h(e){var t=Object(c.a)(),n=Object(o.a)(e);return t.get(n)}function v(e,t){if("sharedFolder"===e&&!t)throw new Error("To get all the shared folders you must pass principalSMTPAddress");var n,r=[];switch(e){case"archive":n=Object(u.a)();break;case"sharedFolder":n=Object(d.a)(t);break;default:n=Object(s.a)()}var o=m();"primary"==e&&n.DistinguishedFolderId==Object(s.a)().DistinguishedFolderId&&o.forEach((function(e){var t=h(e);t&&g(t)&&t.ParentFolderId.Id===n.FolderId.Id&&r.push(t.FolderId.Id)}));for(var c=function(e){var t=[];(null==e?void 0:e.childFolderIds)&&e.childFolderIds.map((function(e){var n=a.b.folderTable.get(e);n&&g(n)&&t.push(n.FolderId.Id)}));return t}(n),l=0;l<c.length;l++)-1==o.indexOf(Object(i.a)(c[l]))&&r.push(c[l]);return r}function y(e,t){var n=Object(c.a)().get(e);return!(!n||n.treeType!==t)}function b(e,t){var n=null,r=t.folderTable.get(e);return r&&(n=r.treeType),n}},976:function(e,t,n){"use strict";n.d(t,"b",(function(){return a}));var r=n(4),o=n(24),i=Object(r.createStore)("folderStore",{folderTable:new o.ObservableMap,mailboxFolderTreeData:new o.ObservableMap}),a=i();t.a=i},977:function(e,t,n){"use strict";var r=Array.isArray;t.a=r},979:function(e,t,n){"use strict";var r,o=n(1138),i=n(480).a["__core-js_shared__"],a=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";var s=function(e){return!!a&&a in e},c=n(429),u=n(1167),l=/^\[object .+?Constructor\]$/,d=Function.prototype,f=Object.prototype,p=d.toString,m=f.hasOwnProperty,g=RegExp("^"+p.call(m).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var h=function(e){return!(!Object(c.a)(e)||s(e))&&(Object(o.a)(e)?g:l).test(Object(u.a)(e))};var v=function(e,t){return null==e?void 0:e[t]};t.a=function(e,t){var n=v(e,t);return h(n)?n:void 0}},980:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem",e[e.CloudSuggestion=6]="CloudSuggestion",e[e.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",e[e.Inline=8]="Inline",e[e.Smime=9]="Smime",e[e.FilesHub=10]="FilesHub",e[e.GroupFilesHub=11]="GroupFilesHub",e[e.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",e[e.Unknown=13]="Unknown",e[e.ContextualSuggestion=14]="ContextualSuggestion",e[e.ConsumerGroupFilesHub=15]="ConsumerGroupFilesHub",e[e.SmartDoc=16]="SmartDoc"}(r||(r={}))},985:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(976);function o(){return Object(r.a)().folderTable}},987:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(976),o=n(103);function i(e){return a(e).folderTreeTable}function a(e){return e||(e=Object(o.c)()),Object(r.a)().mailboxFolderTreeData.get(e)}},989:function(e,t,n){"use strict";n.d(t,"b",(function(){return s}));var r=n(108),o=n(1078);n.d(t,"a",(function(){return o.a}));var i=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(214)]).then(n.bind(null,1837))})),a=new r.b(i,(function(e){return e.confirmAction}));function s(e,t,n,r){return a.import().then((function(o){return o(e,t,n,r)}))}},991:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1126);function o(e){return Object(r.a)().attachments.get(e.Id)}},993:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"f",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"j",(function(){return l})),n.d(t,"k",(function(){return d})),n.d(t,"i",(function(){return f})),n.d(t,"a",(function(){return p})),n.d(t,"g",(function(){return m}));var r=n(4),o=Object(r.action)("GET_ARCHIVE_FOLDERS",(function(e,t){return{source:e,isLoadingMore:t}})),i=Object(r.action)("INITIALIZE_ARCHIVE_FOLDER_TREE_FROM_SESSIONDATA"),a=Object(r.action)("GET_FOLDER_PERMISSIONS",(function(e){return{folderId:e}})),s=Object(r.action)("GET_FOLDER_PERMISSIONS_SUCCESS"),c=Object(r.action)("GET_FOLDER_PERMISSIONS_FAILED"),u=Object(r.action)("UPDATE_FOLDER_PERMISSIONS",(function(e,t){return{folderId:e,permissions:t}})),l=Object(r.action)("UPDATE_FOLDER_PERMISSIONS_IN_STORE",(function(e,t){return{folderId:e,permissions:t}})),d=Object(r.action)("UPDATE_FOLDER_PERMISSIONS_SUCCESS"),f=Object(r.action)("UPDATE_FOLDER_PERMISSIONS_FAILED"),p=Object(r.action)("ADD_NEW_FOLDER_TO_STORE",(function(e,t,n,r){return{folderStore:e,folder:t,parentFolderId:n,displayName:r}})),m=Object(r.action)("ON_CREATE_NEW_FOLDER_INBOX_RULES_RESPONSE",(function(e,t,n,r){return{folderStore:e,folder:t,parentFolderId:n,displayName:r}}))},994:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return c}));var r=n(1075);function o(e,t){if(null==e&&null!=t||null!=e&&null==t)return!1;if(null==e&&null==t)return!0;if(0==e.length&&0==t.length)return!0;if(e.length!=t.length)return!1;for(var n=0;n<e.length;){if(!i(e[n],t[n]))return!1;n++}return!0}function i(e,t){return!(!e&&t||e&&!t)&&(e.Id===t.Id||Object(r.a)(e.PostalAddress)&&Object(r.a)(t.PostalAddress)&&e.PostalAddress.LocationUri.toLowerCase()===t.PostalAddress.LocationUri.toLowerCase())}function a(e,t){return e&&Object(r.a)(t.PostalAddress)?s(e,t.PostalAddress.LocationUri):c(e,t.Id)}function s(e,t){return!!(t&&e&&e.some((function(e){return Object(r.a)(e.PostalAddress)&&e.PostalAddress.LocationUri.toLowerCase()===t.toLowerCase()})))}function c(e,t){return e&&e.some((function(e){return e.Id===t}))}},9964:function(e,t,n){"use strict";var r,o=n(235);!function(e){e[e.String=0]="String",e[e.Boolean=1]="Boolean",e[e.Int64=2]="Int64",e[e.Double=3]="Double"}(r||(r={})),n.d(t,"a",(function(){return l}));var i=/\./g,a=".",s="Data",c="zC",u=0;function l(e,t,n){var r,a,s={name:(r=e.eventName,r.toLowerCase().replace(i,"_")),properties:{}};if(!e.telemetryProperties||!e.telemetryProperties.ariaTenantToken)throw new Error("Unable to find ariaTenantToken for namespace.");return s.properties["Event.Sequence"]={value:++u,type:o.AWTPropertyType.Int64},s.properties["Event.Name"]=e.eventName,s.properties["Event.Source"]="OTelJS",a=n?new Date(n):new Date,s.properties["Event.Time"]={value:a,type:o.AWTPropertyType.Date},e.eventContract&&(s.properties["Event.Contract"]=e.eventContract.name,d(s,e.eventContract.dataFields,!1)),d(s,t,!1),d(s,e.dataFields,!0),s}function d(e,t,n){t&&t.forEach((function(t){var r=["","",t.name],o=r[0],i=r[1],u=r[2],l=t.name.indexOf(a);l>0&&t.name.substr(0,l)===c&&(o=t.name.substring(0,l+1),u=t.name.substring(l+1)),n&&(i=s+a);var d=o+i+u;e.properties[d]={value:t.value,type:f(t.dataType)}}))}function f(e){switch(e){case r.String:return o.AWTPropertyType.String;case r.Boolean:return o.AWTPropertyType.Boolean;case r.Int64:return o.AWTPropertyType.Int64;case r.Double:return o.AWTPropertyType.Double;default:throw new Error(e)}}}}]);
//# sourceMappingURL=owa.Addins.js.map
self.scriptsLoaded['owa.Addins.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.Addins.js'] = (new Date()).getTime();