self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.LinkPreview.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[363],{1318:function(e,t,n){"use strict";function r(e){var t=e&&(e.commonAncestorContainer||e),n=t&&(t.ownerDocument||("[object HTMLDocument]"==Object.prototype.toString.apply(t)?t:null));return n&&(n.defaultView||window)}Object.defineProperty(t,"__esModule",{value:!0}),t.getTargetWindow=r,t.default=function(e,t){var n=r(e),i=n&&n[t],o=window,a=o&&o[t];return a&&e instanceof a||i&&e instanceof i}},15308:function(e,t,n){"use strict";n.r(t);var r=n(4396),i=n(5872);var o=n(4397),a=n(8998),l=n(8999),u=n(7861),c=n(1416),d=n(27),s=n(42),f=n(1),h=n(244),m=n(79),p=n(579),v=n(7863),g=Object(s.a)((function(e){var t=function(t){m.g.info("Dismiss Video Player"),t.stopPropagation(),e.onClose()};return f.createElement("div",{className:v.videoPlayerBackground,onClick:t},f.createElement("div",{className:v.videoContainer,onClick:y},f.createElement(p.a,{className:v.closeButtonIcon,iconProps:{iconName:"ChromeClose"},onClick:t}),f.createElement("div",{ref:function(t){if(t){t.innerHTML=e.videoPlayerHtml;var n=t.querySelectorAll("iframe");n&&1===n.length&&(n[0].setAttribute("width","800px"),n[0].setAttribute("height","530px"))}}})))})),b=null;function y(e){e.stopPropagation()}var E=n(5514),w=n(961),P=n(7267),C=700,x="[id^="+o.g+"]",k="[id^="+o.p+"]",_=function(){function e(){var e=this;this.onResize=function(){var t=e.editor&&e.editor.getScrollContainer();t&&(t.clientWidth<C?e.setPreviewSize(u.a.Compact):e.setPreviewSize(u.a.Standard))},this.linkPreviewObjects=[],this.featureEnabled=Object(d.a)().UserOptions.LinkPreviewEnabled}return e.prototype.getName=function(){return"LinkPreview"},e.prototype.initialize=function(e){this.editor=e,c.a.importAndExecute(this.onResize),this.onResize()},e.prototype.dispose=function(){this.linkPreviewObjects=null,this.editor=null,c.c.importAndExecute(this.onResize)},e.prototype.onPluginEvent=function(e){var t,n,a,u,c=this;if(this.featureEnabled)if(16===e.eventType&&e.entity.type==o.k){var d=e.entity,s=d.contentNode,m=d.id,p=s.querySelector(x),v=s.querySelector(k),y=s.querySelector("[id^=LPBorder]");switch(e.operation){case 0:y&&Object(l.a)(y).then((function(e){c.editor&&e&&(c.linkPreviewObjects.push(e),function(e){Object(r.b)(e),e.hasOwnProperty("videoPlayer")&&Object(i.a)(e)}(e))}));break;case 1:var w=null===(t=e.rawEvent)||void 0===t?void 0:t.target;if(p==w||(null==p?void 0:p.contains(w)))null===(n=e.rawEvent)||void 0===n||n.stopPropagation(),(C=this.editor.queryElements("#"+this.getAnchorIdFromEntityId(m))[0])&&(C.id=o.s+m),this.onLinkPreviewRemoved(y);else if(v==w||(null==v?void 0:v.contains(w))){null===(a=e.rawEvent)||void 0===a||a.stopPropagation();var P=this.linkPreviewObjects.filter((function(e){return e.border==y}))[0];(null==P?void 0:P.videoPlayer)&&(u=P.videoPlayer,b||((b=document.createElement("div")).id="BingVideoPlayer",document.body.appendChild(b)),h.render(f.createElement(f.StrictMode,null,f.createElement(g,{videoPlayerHtml:u,onClose:function(){h.unmountComponentAtNode(b)}})),b))}break;case 4:case 5:this.editor.addUndoSnapshot((function(){c.editor.deleteNode(s),e.rawEvent&&(e.rawEvent.preventDefault(),e.rawEvent.stopPropagation())}));break;case 8:null==p||p.parentNode.removeChild(p),null==v||v.parentNode.removeChild(v)}}else if(6===e.eventType){if("AutoLink"===e.source&&e.data&&Object(E.a)(e.data)){var C=e.data;this.generateLinkPreviewBelowAnchor(C)}}else if(9===e.eventType){var _=e.fragment;if((null==_?void 0:_.childNodes)&&1==_.childNodes.length){var I=_.firstElementChild;if(Object(E.a)(I)){C=I;this.generateLinkPreviewBelowAnchor(C)}}}},e.prototype.onLinkPreviewRemoved=function(e){this.editor.contains(e)&&(this.moveCursorBelowElement(e),this.editor.deleteNode(e),this.linkPreviewObjects=this.linkPreviewObjects.filter((function(t){return t.border!=e})))},e.prototype.isImageLink=function(e){var t=e.href;return!!t&&!!t.match(".(bmp|gif|jpe?g|png)$")},e.prototype.onImageLoadedIntoEditor=function(e){var t=e.target;t&&(t.onload=null,t.onerror=null)},e.prototype.onImageError=function(e){var t=e.target;t&&(t.onload=null,t.onerror=null,null!=t.parentNode&&t.parentNode.removeChild(t))},e.prototype.generateLinkPreviewBelowAnchor=function(e){var t=this;this.isImageLink(e)?this.tryInsertImageIntoEditor(e):Object(a.a)(e,!0).then((function(n){n&&t.editor&&(Object(u.b)(n,t.previewSize),t.insertLinkPreviewElementIntoEditor(n.border,e,!0))}))},e.prototype.tryInsertImageIntoEditor=function(e){if(this.editor){var t=this.editor.getDocument().createElement("img");t.onload=this.onImageLoadedIntoEditor,t.onerror=this.onImageError,t.style.maxWidth="100%",t.src=e.href,this.insertLinkPreviewElementIntoEditor(t,e,!1)}},e.prototype.insertLinkPreviewElementIntoEditor=function(e,t,n){var r=this;this.editor.addUndoSnapshot((function(){var i=Object(P.insertEntity)(r.editor,o.k,e,!0,n,new w.Position(t,-1));t.id=r.getAnchorIdFromEntityId(i.id)}),"LinkPreview")},e.prototype.getAnchorIdFromEntityId=function(e){return o.c+e},e.prototype.setPreviewSize=function(e){var t=this;e!=this.previewSize&&(this.previewSize=e,this.linkPreviewObjects&&this.linkPreviewObjects.forEach((function(e){Object(u.b)(e,t.previewSize)})))},e.prototype.moveCursorBelowElement=function(e){this.editor.select(e,-3)},e}();t.default=_},15368:function(e,t,n){"use strict";n.r(t);var r=n(5872);function i(e){e.hasOwnProperty("videoPlayer")&&Object(r.a)(e)}n.d(t,"addInteractiveElementsForReadingPane",(function(){return i}))},1800:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1318);t.default=function(e){return r.default(e,"HTMLElement")}},1946:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return d}));var r=n(108),i=new r.c((function(){return n.e(537).then(n.bind(null,3111))})),o=new r.b(i,(function(e){return e.extractFileUrlFromOfficeSharePointLink})),a=new r.b(i,(function(e){return e.isLinkPrefixedWithBaseUrl})),l=new r.b(i,(function(e){return e.isSharePointLink})),u=new r.b(i,(function(e){return e.isSharePointServiceGeneratedLink})),c=new r.b(i,(function(e){return e.isOfficeSharePointLink})),d=new r.b(i,(function(e){return e.getParsedQueryStringFromUrl}))},3448:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5397),i=/_\d{1,8}$/,o="_Entity",a="_EType_",l="_EId_",u="_EReadonly_";function c(e){return r.default(e).map((function(e){return e.id}))}t.serializeEntityInfo=function(e,t,n,r,d){void 0===d&&(d=c(e));var s=function(e,t){for(var n=i.exec(e),r=n?e.substr(0,e.length-n[0].length):e,o="",a=n&&parseInt(n[1])||0;;a++)if(o=r+"_"+a,t.indexOf(o)<0){t.push(o);break}return o}(r||t,d);return o+" "+a+t+" "+l+s+" "+u+(n?"1":"0")},t.deserialzeEntityInfo=function(e){var t,n=!1,r="",i=!1;return e&&e.split(" ").forEach((function(e){e==o?n=!0:0==e.indexOf(a)?t=e.substr(a.length):0==e.indexOf(l)?r=e.substr(l.length):0==e.indexOf(u)&&(i="1"==e.substr(u.length))})),n&&t?{type:t,id:r,isReadonly:i}:null},t.getAllEntityIds=c,t.getEntitySelector=function(e,t){return"."+o+(e?"."+a+e:"")+(t?"."+l+t:"")}},3449:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(3448);t.default=function(e){var t=i.deserialzeEntityInfo(e.className);return t?r({contentNode:e},t):null}},3823:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3448);t.default=function(e,t){return t&&e.getElementAtCursor(r.getEntitySelector(),t)||null}},4396:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return s}));var r,i=n(8994),o=n(9),a=n(4397),l=n(14),u=n(8995),c=n(479);function d(e,t){var n,r=window.btoa(t.url);r=(r=(r=r.replace(new RegExp("\\+","g"),"-")).replace(new RegExp("/","g"),":")).replace(new RegExp("=","g"),"."),t.border=document.createElement("div"),t.border.id=a.d+"_"+e+r,t.border.className=a.d+a.u(),(n=t.border).style.width="100%",n.style.marginTop="16px",n.style.marginBottom="16px",n.style.position="relative",n.style.maxWidth="800px",n.style.minWidth="424px"}function s(e){e.closeButtonContainer=document.createElement("div"),e.closeButtonContainer.id=a.t(e.border.className,a.g),e.closeButtonContainer.className=u.closeButtonContainer,e.closeButtonContainer.tabIndex=0,e.closeButtonContainer.title=Object(o.b)(i.a),e.closeButtonContainer.setAttribute("role","button");var t=document.createElement("span");t.id=a.t(e.border.className,a.h),t.className=c(u.icon,Object(l.getIconClassName)("Cancel")),e.closeButtonContainer.appendChild(t),e.border.appendChild(e.closeButtonContainer)}!function(e){e[e.WebpagePreview=0]="WebpagePreview",e[e.VideoPreview=1]="VideoPreview"}(r||(r={}))},4397:function(e,t,n){"use strict";n.d(t,"s",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"f",(function(){return a})),n.d(t,"e",(function(){return l})),n.d(t,"i",(function(){return u})),n.d(t,"m",(function(){return c})),n.d(t,"l",(function(){return d})),n.d(t,"n",(function(){return s})),n.d(t,"q",(function(){return f})),n.d(t,"r",(function(){return h})),n.d(t,"o",(function(){return m})),n.d(t,"j",(function(){return p})),n.d(t,"h",(function(){return v})),n.d(t,"g",(function(){return g})),n.d(t,"p",(function(){return b})),n.d(t,"a",(function(){return y})),n.d(t,"b",(function(){return E})),n.d(t,"k",(function(){return w})),n.d(t,"u",(function(){return P})),n.d(t,"t",(function(){return C}));var r="LPNoLP",i="LPlnk",o="LPBorder",a="GT",l="BVT",u="LPContainer",c="LPImageContainer",d="LPImageAnchor",s="LPThumbnailImageId",f="LPTitle",h="LPUrlAnchor",m="LPMetadata",p="LPDescription",v="LPCloseButton",g="LPCloseButtonContainer",b="LPPlayButton",y="BingRTPLinkPreview:#Exchange",E="BingVideoLinkPreview:#Exchange",w="OWALinkPreview";function P(){return Math.floor(1e5+9e5*Math.random()).toString()}function C(e,t){return t+((n=e)&&n.slice(-6));var n}},4696:function(e,t,n){"use strict";n.r(t);var r=n(8998);n.d(t,"createLinkPreview",(function(){return r.a}));var i=n(8999);n.d(t,"rehydrateLinkPreview",(function(){return i.a}))},5376:function(e,t,n){"use strict";n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return v})),n.d(t,"d",(function(){return g})),n.d(t,"a",(function(){return y}));var r=n(0),i=n(4396),o=n(4397),a=n(7861),l=n(213),u=n(79),c=160,d=240,s=d/c,f=160,h=106,m=160;function p(e,t,n){var r={type:i.a.WebpagePreview,description:e.Description,title:e.Title,url:e.Url,thumbnailImageUrl:e.ImageUrl,anchor:t};return Object(i.c)(o.f,r),y(r,n),r}function v(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,a,l,u,c,d,s,f;return Object(r.__generator)(this,(function(r){return e.style.position="relative",t=b(e,o.i),n=b(e,o.m),a=b(e,o.l),l=b(e,o.n),u=b(e,o.q),c=b(e,o.r),d=b(e,o.o),s=b(e,o.j),(f={border:e,type:i.a.WebpagePreview,description:s?s.innerHTML:null,title:c?c.innerText:null,url:c?c.href:null,thumbnailImageUrl:l?l.src:null,table:t,thumbnailImageContainer:n,thumbnailImageAnchor:a,thumbnailImageElement:l,titleContainer:u,titleUrlAnchor:c,metadataContainer:d,descriptionContainer:s}).thumbnailImageContainer&&(f.thumbnailImageContainer.style.position="relative"),[2,Promise.resolve(f)]}))}))}function g(e,t){var n;(null===(n=e.thumbnailImageElement)||void 0===n?void 0:n.naturalWidth)&&E(e.thumbnailImageElement,e.thumbnailImageContainer,t)}function b(e,t){var n=e.querySelectorAll("[id^="+t+"]");return n&&n.length>0?n[0]:null}function y(e,t){!function(e){e.table=document.createElement("table"),e.table.id=o.t(e.border.className,o.i),e.table.setAttribute("role","presentation"),e.border.appendChild(e.table)}(e);var n=document.createElement("tr");if(n.vAlign="top",n.style.borderSpacing="0px",e.table.appendChild(n),function(e,t){e.style.padding="12px",e.style.width="100%",e.style.borderWidth="1px",e.style.borderStyle="solid",e.style.borderColor="#c8c8c8",e.style.borderRadius="2px",t&&(e.style.paddingRight="36px")}(e.table,t),e.thumbnailImageUrl){var r=document.createElement("td");n.appendChild(r),function(e,t,n){t.thumbnailImageContainer=document.createElement("div"),t.thumbnailImageContainer.id=o.t(t.border.className,o.m),r=t.thumbnailImageContainer,r.style.position="relative",r.style.marginRight="12px",r.style.height="160px",r.style.overflow="hidden",t.thumbnailImageAnchor=document.createElement("a"),w(t.thumbnailImageAnchor,n),t.thumbnailImageAnchor.id=o.t(t.border.className,o.l),t.thumbnailImageAnchor.href=t.url,t.thumbnailImageElement=document.createElement("img"),t.thumbnailImageElement.id=o.t(t.border.className,o.n),t.thumbnailImageElement.alt="",function(e,t,n,r){t.complete&&0!==t.naturalWidth?E(t,n,r):(t.style.display="none",t.src=e,E(t,n,a.a.Default),t.onload=function(e){E(e.target,n,r),t.style.display="block"},t.onerror=function(e){u.g.warn("Error loading image for link preview")})}(t.thumbnailImageUrl,t.thumbnailImageElement,t.thumbnailImageContainer,a.a.Standard),t.thumbnailImageAnchor.appendChild(t.thumbnailImageElement),t.thumbnailImageContainer.appendChild(t.thumbnailImageAnchor),e.appendChild(t.thumbnailImageContainer);var r}(r,e,t)}var i=document.createElement("td");i.style.width="100%",e.title&&function(e,t,n){t.titleContainer=document.createElement("div"),t.titleContainer.id=o.t(t.border.className,o.q),i=t.titleContainer,i.style.fontSize="21px",i.style.fontWeight="300",i.style.marginRight="40px",i.style.fontFamily='"wf_segoe-ui_light","Segoe UI Light","Segoe WP Light","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif',i.style.marginBottom="12px",i.style.marginRight="8px",t.titleUrlAnchor=document.createElement("a"),w(t.titleUrlAnchor,n),t.titleUrlAnchor.id=o.t(t.border.className,o.r),t.titleUrlAnchor.href=t.url,t.titleUrlAnchor.text=t.title,r=t.titleUrlAnchor,r.style.textDecoration="none",r.style.color=Object(l.h)().themePrimary,t.titleContainer.appendChild(t.titleUrlAnchor),e.appendChild(t.titleContainer);var r;var i}(i,e,t),e.description&&function(e,t){t.descriptionContainer=document.createElement("div"),t.descriptionContainer.textContent=t.description,t.descriptionContainer.id=o.t(t.border.className,o.j),n=t.descriptionContainer,n.style.fontSize="14px",n.style.maxHeight="100px",n.style.color="#666666",n.style.fontFamily='"wf_segoe-ui_normal","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif',n.style.marginBottom="12px",n.style.marginRight="8px",n.style.overflow="hidden",e.appendChild(t.descriptionContainer);var n}(i,e),function(e,t){t.metadataContainer=document.createElement("div"),t.metadataContainer.textContent=t.titleUrlAnchor.hostname,t.metadataContainer.id=o.t(t.border.className,o.o),n=t.metadataContainer,n.style.fontSize="14px",n.style.fontWeight="400",n.style.color="#a6a6a6",n.style.fontFamily='"wf_segoe-ui_normal","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif',e.appendChild(t.metadataContainer);var n}(i,e),n.appendChild(i)}function E(e,t,n){if(n!==a.a.Default){var r,i,o,l;switch(n){case a.a.Standard:i=d,r=c;break;case a.a.Compact:i=m,r=h}var u=e.naturalWidth>0&&e.naturalHeight>0?e.naturalWidth/e.naturalHeight:s;e.naturalWidth==e.naturalHeight?(l=r,o=r):e.naturalWidth>e.naturalHeight?(l=i,o=i/u,t.style.width=i+"px",t.style.height=o+"px"):(l=r*u,o=r,t.style.width=i+"px",t.style.height=o+"px"),e.width=l,e.height=o}else e.height=f}function w(e,t){t&&(e.onmouseenter=function(){e.removeAttribute("title")}),e.target="_blank"}},5397:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3449),i=n(3448);t.default=function(e,t,n){var o=i.getEntitySelector(t,n);return e.queryElements(o).map((function(e){return r.default(e)})).filter((function(e){return!!e}))}},5398:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3449);t.default=function(e,t,n,i){var o=t&&r.default(t);o&&(0==n&&o.isReadonly&&(t.contentEditable="false"),e.triggerPluginEvent(16,{operation:n,rawEvent:i,entity:o}))}},5514:function(e,t,n){"use strict";var r=n(1318),i=n.n(r);function o(e){return i()(e,"HTMLAnchorElement")}function a(e){return i()(e,"HTMLImageElement")}var l=n(1800),u=n.n(l);n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return u.a}))},5872:function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return h})),n.d(t,"a",(function(){return m})),n.d(t,"d",(function(){return p}));var r=n(0),i=n(4396),o=n(4397),a=n(5376),l=n(7862),u=n(14),c=n(7863),d=n(479),s="rehydrate";function f(e,t,n){var r={type:i.a.VideoPreview,description:e.Description,title:e.Title,url:e.Url,thumbnailImageUrl:e.ImageUrl,anchor:t,videoUrl:e.Url,videoPlayer:e.EmbeddedHtml,motionThumbnail:e.MotionThumbnailUrl};return Object(i.c)(o.e,r),Object(a.a)(r,n),r}function h(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(a.c)(e)];case 1:return(t=n.sent()).type=i.a.VideoPreview,t.videoUrl=t.url,t.videoPlayer=null,t.motionThumbnail=null,t.playVideoButtonContainer=null,t.thumbnailImageContainer&&(t.thumbnailImageContainer.style.position="relative"),[2,Object(l.a)(t.videoUrl,s).then((function(e){var n;return(null===(n=e.LinkPreview)||void 0===n?void 0:n.__type)==o.b&&(t.videoPlayer=e.LinkPreview.EmbeddedHtml),t}))]}}))}))}function m(e){var t=document.createElement("span");t.className=d([c.playButtonIcon,Object(u.getIconClassName)("Play")]),e.playVideoButtonContainer=document.createElement("div"),e.playVideoButtonContainer.id=o.t(e.border.className,o.p),e.playVideoButtonContainer.className=c.playButtonContainer,e.playVideoButtonContainer.appendChild(t),e.thumbnailImageContainer.appendChild(e.playVideoButtonContainer)}function p(e,t){Object(a.d)(e,t)}},7267:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(7268))},7268:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7269);t.EntityPlugin=r.default;var i=n(7271);t.insertEntity=i.default;var o=n(3449);t.getEntityFromElement=o.default;var a=n(5397);t.getEntities=a.default;var l=n(3823);t.getEntityElement=l.default},7269:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3823),i=n(3449),o=n(5398),a=n(961),l=n(1560),u=n(3448),c=n(7270),d=function(){function e(){var e=this;this.handleContextMenuEvent=function(t){var n=t.target,i=r.default(e.editor,n);i&&(t.preventDefault(),o.default(e.editor,i,2,t))},this.handleCutEvent=function(t){e.editor.getSelectionRange().collapsed||e.checkRemoveEntityForRange(t)}}return e.prototype.getName=function(){return"Entity"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.disposer=this.editor.addDomEventHandler({contextmenu:this.handleContextMenuEvent,cut:this.handleCutEvent}),this.knownEntityElements=[],[c.ClickOnEntityFeature,c.EscapeFromEntityFeature,c.EnterBeforeReadonlyEntityFeature,c.BackspaceAfterEntityFeature,c.DeleteBeforeEntityFeature].forEach((function(e){return t.editor.addContentEditFeature(e)}))},e.prototype.dispose=function(){this.disposer(),this.disposer=null,this.editor=null,this.knownEntityElements=null},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 4:this.handleMouseDownEvent(e.rawEvent);break;case 5:this.handleMouseUpEvent(e.rawEvent);break;case 0:this.handleKeyDownEvent(e.rawEvent);break;case 9:this.handleBeforePasteEvent(e.fragment);break;case 6:this.handleContentChangedEvent("SetContent"==e.source);break;case 10:this.handleContentChangedEvent(!0);break;case 8:this.handleExtractContentWithDomEvent(e.clonedRoot)}},e.prototype.handleMouseDownEvent=function(e){var t=e.target,n=e.pageX,i=e.pageY,o=r.default(this.editor,t);o&&!o.isContentEditable&&(e.preventDefault(),this.clickingPoint={pageX:n,pageY:i})},e.prototype.handleMouseUpEvent=function(e){var t,n=e.target,i=e.pageX,a=e.pageY;this.clickingPoint&&this.clickingPoint.pageX==i&&this.clickingPoint.pageY==a&&(t=r.default(this.editor,n))&&(e.preventDefault(),o.default(this.editor,t,1,e),s(this.editor)),this.clickingPoint=null},e.prototype.handleKeyDownEvent=function(e){(l.isCharacterValue(e)||8==e.which||46==e.which)&&(this.editor.getSelectionRange().collapsed||this.checkRemoveEntityForRange(e))},e.prototype.handleBeforePasteEvent=function(e){var t=this;this.editor.getSelectionRange().collapsed||this.checkRemoveEntityForRange(null);var n=a.toArray(e.querySelectorAll(u.getEntitySelector()));if(n.length>0){var r=u.getAllEntityIds(this.editor);n.forEach((function(e){var n=i.default(e);n&&(e.className=u.serializeEntityInfo(t.editor,n.type,n.isReadonly,n.id,r))}))}},e.prototype.handleContentChangedEvent=function(e){var t=this;this.knownEntityElements=e?[]:this.knownEntityElements.filter((function(e){return t.editor.contains(e)})),this.editor.queryElements(u.getEntitySelector(),(function(e){t.knownEntityElements.indexOf(e)<0&&(t.knownEntityElements.push(e),o.default(t.editor,e,0))}))},e.prototype.handleExtractContentWithDomEvent=function(e){var t=this;a.toArray(e.querySelectorAll(u.getEntitySelector())).forEach((function(e){e.removeAttribute("contentEditable"),o.default(t.editor,e,8)}))},e.prototype.checkRemoveEntityForRange=function(e){var t=this,n=[],r=u.getEntitySelector();if(this.editor.queryElements(r,1,(function(r){r.isContentEditable?n.push(r):o.default(t.editor,r,6,e)})),n.length>0){var i=this.editor.queryElements(r,2);n.forEach((function(n){var r=i.indexOf(n)>=0;o.default(t.editor,n,r?6:7,e)}))}},e}();t.default=d;var s=a.Browser.isIE?function(e){e.runAsync((function(){var t=e.getCustomData("ENTITY_IE_FOCUS_BUTTON",(function(){var t=e.getDocument().createElement("button");return t.style.overflow="hidden",t.style.position="fixed",t.style.width="0",t.style.height="0",t.style.left="0",t.style.top="-1000px",t.onblur=function(){t.style.display="none"},e.insertNode(t,{position:4}),t}));t.style.display="";var n=e.getDocument().createRange();n.setStart(t,0);try{window.getSelection().removeAllRanges(),window.getSelection().addRange(n)}catch(e){}}))}:function(){}},7270:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3823),i=n(5398),o=n(1560),a=n(961);function l(e,t){return o.cacheGetEventData(e,"READONLY_ENTITY_ELEMENT",(function(){var n=r.default(t,e.rawEvent.target);return n&&!n.isContentEditable?n:null}))}function u(e,t,n,i,l){return o.cacheGetEventData(e,"NEIGHBOR_ENTITY_ELEMENT_"+n+"_"+i+"_"+!!l,(function(){var e=t.getSelectionRange();if(i&&!e.collapsed)return null;var o=a.Position.getEnd(e),u=!n&&(3!=o.node.nodeType||0==o.offset),c=null;if(n&&(3!=o.node.nodeType||o.isAtEnd)||u){var d=t.getBodyTraverser(o.node),s=u?d.getPreviousInlineElement():d.getNextInlineElement(),f=s&&s.getContainerNode();if(l){var h=t.getBlockElementAtNode(o.node);h&&h.contains(f)||(f=null)}c=r.default(t,f)}return c}))}t.ClickOnEntityFeature={keys:[13],shouldHandleEvent:l,handleEvent:function(e,t){var n=l(e,t);i.default(t,n,1,e.rawEvent)}},t.EscapeFromEntityFeature={keys:[27],shouldHandleEvent:l,handleEvent:function(e,t){var n=l(e,t);i.default(t,n,3,e.rawEvent)}},t.EnterBeforeReadonlyEntityFeature={keys:[13],shouldHandleEvent:function(e,t){return u(e,t,!0,!1,!0)},handleEvent:function(e,t){var n;e.rawEvent.preventDefault();var r=t.getSelectionRange(),i=a.Position.getEnd(r).normalize().node,o=t.getDocument().createElement("BR");i.parentNode.insertBefore(o,i.nextSibling);var l,u=t.getBlockElementAtNode(i);u&&(l=u.collapseToSingleElement(),null===(n=o.parentNode)||void 0===n||n.removeChild(o)),t.getSelectionRange().deleteContents(),l.nextSibling&&t.select(l.nextSibling,0)}},t.BackspaceAfterEntityFeature={keys:[8],shouldHandleEvent:function(e,t){return u(e,t,!1,!0)},handleEvent:function(e,t){var n=u(e,t,!1,!0);i.default(t,n,5,e.rawEvent)}},t.DeleteBeforeEntityFeature={keys:[46],shouldHandleEvent:function(e,t){return u(e,t,!0,!0)},handleEvent:function(e,t){var n=u(e,t,!0,!0);i.default(t,n,4,e.rawEvent)}}},7271:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3823),i=n(3449),o=n(961),a=n(3448);t.default=function(e,t,n,l,u,c){var d,s=o.wrap(n,l?"DIV":"SPAN");if(s.className=a.serializeEntityInfo(e,t,u),!l&&u&&(s.style.display="inline-block"),c){d=e.getSelectionRange();var f=c.normalize().node,h=r.default(e,f);h&&(c=new o.Position(h,-3)),e.select(c)}if(e.insertNode(s,{updateCursor:!1,insertOnNewLine:l,replaceSelection:!0,position:3}),l){var m=e.getDocument().createElement("BR");s.parentNode.insertBefore(m,s.nextSibling)}d?e.select(d):l||e.select(s,-3);var p=i.default(s);return e.triggerContentChangedEvent("InsertEntity",p),p}},7693:function(e,t,n){"use strict";var r=n(25),i=n(0);function o(e,t){var n;return void 0===e.getLinkPreviewRequest||e.getLinkPreviewRequest.__type||(e.getLinkPreviewRequest=(n=e.getLinkPreviewRequest,Object(i.__assign)({__type:"GetLinkPreviewRequest:#Exchange"},n))),Object(r.a)("GetLinkPreview",e,t)}n.d(t,"a",(function(){return o}))},7861:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return l}));var r,i=n(4396),o=n(5872),a=n(5376);function l(e,t){if(e)switch(e.type){case i.a.WebpagePreview:return Object(a.d)(e,t);case i.a.VideoPreview:return Object(o.d)(e,t)}}!function(e){e[e.Standard=0]="Standard",e[e.Compact=1]="Compact",e[e.Default=2]="Default"}(r||(r={}))},7862:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),i=n(7693);function o(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){return n=function(e,t){return{Url:e,Id:t}}(e,t),[2,Object(i.a)({getLinkPreviewRequest:n})]}))}))}},7863:function(e,t,n){var r=n(8997),i=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},8994:function(e){e.exports=JSON.parse('{"a":"qab"}')},8995:function(e,t,n){var r=n(8996),i=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},8996:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,'._2G1t7TsffMpTdsxcutbAaz{position:absolute;width:32px;height:32px;top:4px;cursor:pointer;pointer-events:all}html[dir] ._2G1t7TsffMpTdsxcutbAaz{text-align:center}html[dir=ltr] ._2G1t7TsffMpTdsxcutbAaz{right:4px}html[dir=rtl] ._2G1t7TsffMpTdsxcutbAaz{left:4px}._2G1t7TsffMpTdsxcutbAaz:hover ._17cZVF34hdKub7ce2cOnAW{color:"[theme:neutralPrimary, default:#333333]"}._17cZVF34hdKub7ce2cOnAW{font-size:17px;font-weight:300;color:"[theme:neutralSecondary, default:#666666]";position:relative;display:block;line-height:32px;pointer-events:none}html[dir] ._17cZVF34hdKub7ce2cOnAW{margin:auto}',""]),t.locals={closeButtonContainer:"_2G1t7TsffMpTdsxcutbAaz",icon:"_17cZVF34hdKub7ce2cOnAW"}},8997:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,'.A2S5YFyxbb6bJVzndk8Nx{position:relative;display:block;color:"[theme:white, default:#ffffff]";line-height:30px;font-size:24px;pointer-events:none}html[dir] .A2S5YFyxbb6bJVzndk8Nx{margin:auto;text-align:center}.A2S5YFyxbb6bJVzndk8Nx:hover{color:"[theme:neutralSecondary, default:#666666]"}.jmB2bBZZdRmb2Uqcoc-VE{position:absolute;top:0;bottom:0;width:30px;height:30px;cursor:pointer}html[dir] .jmB2bBZZdRmb2Uqcoc-VE{margin:auto;border-radius:50%;border-color:"[theme:white, default:#ffffff]";border-width:2px;border-style:solid}html[dir=ltr] .jmB2bBZZdRmb2Uqcoc-VE,html[dir=rtl] .jmB2bBZZdRmb2Uqcoc-VE{right:0;left:0}.jmB2bBZZdRmb2Uqcoc-VE:hover{color:"[theme:neutralSecondary, default:#666666]"}html[dir] .jmB2bBZZdRmb2Uqcoc-VE:hover{background-color:"[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]"}._23lC86I4ZY7S0mZ0vxfEjR{position:absolute;top:0;width:100%;height:100%}html[dir] ._23lC86I4ZY7S0mZ0vxfEjR{background-color:"[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]"}html[dir=ltr] ._23lC86I4ZY7S0mZ0vxfEjR{left:0}html[dir=rtl] ._23lC86I4ZY7S0mZ0vxfEjR{right:0}._2WkuJE1WDGpXPnmMF6N5Om{position:absolute;top:0;bottom:0;width:800px;height:530px}html[dir] ._2WkuJE1WDGpXPnmMF6N5Om{margin:auto;background-color:"[theme:black, default:#000000]"}html[dir=ltr] ._2WkuJE1WDGpXPnmMF6N5Om,html[dir=rtl] ._2WkuJE1WDGpXPnmMF6N5Om{right:0;left:0}._10gfNYx87CSaS0i-Aas05b{position:absolute;top:10px;color:"[theme:neutralQuaternary, default:#d0d0d0]"}html[dir=ltr] ._10gfNYx87CSaS0i-Aas05b{right:10px}html[dir=rtl] ._10gfNYx87CSaS0i-Aas05b{left:10px}._10gfNYx87CSaS0i-Aas05b:hover{color:"[theme:neutralTertiary, default:#a6a6a6]"}',""]),t.locals={playButtonIcon:"A2S5YFyxbb6bJVzndk8Nx",playButtonContainer:"jmB2bBZZdRmb2Uqcoc-VE",videoPlayerBackground:"_23lC86I4ZY7S0mZ0vxfEjR",videoContainer:"_2WkuJE1WDGpXPnmMF6N5Om",closeButtonIcon:"_10gfNYx87CSaS0i-Aas05b"}},8998:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(0),i=n(4397),o=n(5376),a=n(5872),l=n(7862),u=n(79),c=n(1946);function d(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,d;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=null,0!==e.id.indexOf(i.c)&&0!==e.id.indexOf(i.s)?[3,1]:[3,4];case 1:return[4,c.e.import()];case 2:return r.sent()(e.href)?[2,n]:(e.id&&e.id.length>0?e.id=i.c+e.id:e.id=i.c+i.u(),[4,Object(l.a)(e.href,e.id)]);case 3:(d=r.sent())?n=function(e,t,n){if(e.Error)u.g.info("GetLinkPreview returned error response: "+e.Error);else if(!e.IsDisabled)return function(e,t,n){if(e)switch(e.__type){case i.a:return Object(o.b)(e,t,n);case i.b:return Object(a.b)(e,t,n)}return null}(e.LinkPreview,t,n);return null}(d,e,t):u.d("No response for getLinkPreview request with id: "+e.id),r.label=4;case 4:return[2,n]}}))}))}},8999:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(0),i=n(4397),o=n(5376),a=n(5872);function l(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){if(0===e.id.indexOf(i.d))switch(n=e.id,r=n.split("_"),r&&r.length>1&&0===r[1].indexOf(i.f)?i.f:0===r[1].indexOf(i.e)?i.e:null){case i.f:return[2,Object(o.c)(e)];case i.e:return[2,Object(a.c)(e)]}var n,r;return[2,Promise.reject("div did not match a known link preview type")]}))}))}}}]);
//# sourceMappingURL=owa.LinkPreview.js.map
self.scriptsLoaded['owa.LinkPreview.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.LinkPreview.js'] = (new Date()).getTime();