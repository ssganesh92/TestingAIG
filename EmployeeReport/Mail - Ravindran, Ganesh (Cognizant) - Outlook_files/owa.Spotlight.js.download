self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.Spotlight.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[553],{1020:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"TargetFolderId:#Exchange"},e)}},1072:function(e,t,n){"use strict";var r;!function(e){e[e.Auto=0]="Auto",e[e.Init=1]="Init",e[e.LeftNavResizeExpand=2]="LeftNavResizeExpand",e[e.ToggleExpand=3]="ToggleExpand",e[e.ToggleCollapse=4]="ToggleCollapse",e[e.WindowResize=5]="WindowResize",e[e.ToggleFolderPane=6]="ToggleFolderPane",e[e.DateRangeTypeChange=7]="DateRangeTypeChange"}(r||(r={}));var i=r,o=n(4),u=Object(o.createStore)("OwaLayout",{browserWidthBucket:null});function a(){var e=u().browserWidthBucket;return e||void 0}var c=Object(o.mutatorAction)("setBrowserWidthBucket",(function(e){u().browserWidthBucket=e})),s=n(2);var d=Object(o.action)("onAvailableWidthBucketChanged",(function(e,t){return{availableWidthBucket:e,source:t}})),l=!1;function f(e){window.addEventListener("resize",b),l=e,m(i.Init)}function b(){m(i.WindowResize)}function m(e){var t,n,r,o=(t=e!=i.Init,n=l,r=Object(s.h)(t),n&&(r>1900?r-=305:r>990&&(r-=165)),r>=1600?1600:r>=1400?1599:r>=1366?1399:r>=1301?1365:r>=1239?1300:r>=1200?1238:r>=1080?1199:r>=1e3?1079:r>=919?999:r>=900?918:r>=866?899:r>=769?865:r>=692?768:r>=686?691:r>=580?685:r>=555?579:r>=542?554:r>=500?541:r>=419?499:418);u().browserWidthBucket!=o&&(c(o),o<=418?v():O(),d(o,e))}function v(){var e;(null===(e=window.document)||void 0===e?void 0:e.body)&&(document.body.style.overflowX="auto")}function O(){var e;(null===(e=window.document)||void 0===e?void 0:e.body)&&(document.body.style.overflow="hidden")}var h=n(49);function p(){return g()}function g(){return Object(h.k)()||Object(h.d)()}n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"f",(function(){return f})),n.d(t,"b",(function(){return v})),n.d(t,"e",(function(){return O})),n.d(t,"d",(function(){return p})),n.d(t,"g",(function(){return g})),n.d(t,"h",(function(){return d}))},1082:function(e,t,n){"use strict";var r=n(108),i=n(947);function o(){return u(Object(i.C)())}function u(e){return e&&2==e.tableQuery.type?e.tableQuery.folderId:null}function a(){var e=Object(i.C)();return e&&2==e.tableQuery.type}function c(e){return!!e&&(2==e.type||s(e))}function s(e){return!(!e||1!=e.type)&&"Group"==e.searchScope.kind}function d(e){return 2==e.type?e.folderId:s(e)?e.searchScope.groupId:null}function l(){var e=Object(i.C)();return e&&c(e.tableQuery)}n.d(t,"g",(function(){return b})),n.d(t,"h",(function(){return m})),n.d(t,"m",(function(){return v})),n.d(t,"l",(function(){return O})),n.d(t,"j",(function(){return h})),n.d(t,"i",(function(){return p})),n.d(t,"k",(function(){return g})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return u})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"f",(function(){return l}));var f=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(446)]).then(n.bind(null,15205))})),b=new r.b(f,(function(e){return e.getGroupDisplayName})),m=new r.b(f,(function(e){return e.getGroupDisplayNameFromTableView})),v=new r.b(f,(function(e){return e.isPrivateUnjoinedGroup})),O=new r.b(f,(function(e){return e.isJoinedGroup})),h=new r.b(f,(function(e){return e.getRetentionPolicyTagsForGroup})),p=new r.b(f,(function(e){return e.getRetentionPolicyTagListForGroupTableQuery})),g=new r.b(f,(function(e){return e.isGroupOwner}))},1093:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return s}));var r=n(108),i=n(1397);n.d(t,"a",(function(){return i.a}));var o=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(427)]).then(n.bind(null,2801))})),u=Object(r.d)(o,(function(e){return e.NotificationBarHost})),a=new r.a(o,(function(e){return e.showNotification})),c=new r.a(o,(function(e){return e.dismissNotification})),s=new r.b(o,(function(e){return e.clearNotificationBar}))},1112:function(e,t,n){"use strict";var r=n(1474),i=n(947);function o(){return Object(r.a)(Object(i.C)())}n.d(t,"b",(function(){return r.a})),n.d(t,"c",(function(){return r.c})),n.d(t,"a",(function(){return o}))},1149:function(e,t,n){"use strict";function r(e,t){var n=Math.pow(2,32);if(e>=n||t>=n){var r=e%n,i=t%n;return(((e-=r)/n&(t-=i)/n)>>>0)*n+((r&i)>>>0)}return(e&t)>>>0}n.d(t,"a",(function(){return r}))},11657:function(e,t,n){var r=n(11658),i=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},11658:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,'._3Gl1nIFWKInsb7wonvfXhi,._1oAgFr6qHig5bL-H2LObcz{color:"[theme:white, default:#ffffff]"!important}',""]),t.locals={buttonLinkClassName:"_3Gl1nIFWKInsb7wonvfXhi",ribbonMessage:"_1oAgFr6qHig5bL-H2LObcz"}},1186:function(e,t,n){"use strict";n.d(t,"r",(function(){return d})),n.d(t,"u",(function(){return l})),n.d(t,"e",(function(){return f})),n.d(t,"p",(function(){return b})),n.d(t,"i",(function(){return m})),n.d(t,"o",(function(){return v})),n.d(t,"b",(function(){return O})),n.d(t,"m",(function(){return h})),n.d(t,"f",(function(){return p})),n.d(t,"q",(function(){return g})),n.d(t,"t",(function(){return j})),n.d(t,"s",(function(){return I})),n.d(t,"g",(function(){return w})),n.d(t,"j",(function(){return S})),n.d(t,"k",(function(){return y})),n.d(t,"n",(function(){return C})),n.d(t,"d",(function(){return T})),n.d(t,"c",(function(){return _})),n.d(t,"h",(function(){return k})),n.d(t,"l",(function(){return E})),n.d(t,"a",(function(){return A}));var r=n(0),i=n(123),o=n(947),u=n(963),a=n(4),c=n(1166),s=n(27),d=Object(a.action)("SINGLE_SELECT_ROW",(function(e,t,n,r){return Object(i.c)(x(r,e,t),{tableView:e,rowKey:t,isUserNavigation:n,mailListItemSelectionSource:r})})),l=Object(a.action)("TOGGLE_SELECT_ROW",(function(e,t,n,r){return Object(i.c)(x(r,e,t),{tableView:e,rowKey:t,isUserNavigation:n,mailListItemSelectionSource:r})})),f=Object(a.action)("ON_AFTER_SELECTION_CHANGED",(function(e,t,n,r,i){return{rowKey:e,tableView:t,mailListItemSelectionSource:n,listViewType:r,sxsId:i}})),b=Object(a.action)("SET_SELECTION_ON_ROW",(function(e,t,n){return{rowKey:e,tableViewId:t,shouldSelect:n}})),m=Object(a.action)("RESET_LIST_VIEW_EXPANSION_VIEW_STATE"),v=Object(a.action)("SET_LIST_VIEW_EXPANSION_LOADING_STATE",(function(e){return{shouldBeExpanded:e}})),O=Object(a.action)("ITEM_PART_SELECTED",(function(e,t,n,r,i){return{nodeId:e,itemId:t,allNodeIds:n,tableView:r,mailListItemSelectionSource:i}})),h=Object(a.action)("SELECT_NEXT_ITEM_PART",(function(e,t){return{rowKey:e,tableView:t}})),p=Object(a.action)("ON_ITEM_PART_CONTEXT_MENU",(function(e,t,n){return{contextMenuAnchor:e,nodeId:t,tableViewId:n}})),g=Object(a.action)("SINGLE_SELECT_ITEM_PART",(function(e,t,n,r){return{rowKey:e,nodeIdToSelect:t,allNodeIds:n,tableViewId:r}})),j=Object(a.action)("TOGGLE_SELECT_ITEM_PART",(function(e){return{nodeId:e}})),I=Object(a.action)("TOGGLE_SELECT_ALL_ROWS",(function(e){return{tableView:e}})),w=Object(a.action)("RANGE_SELECT_ROW",(function(e,t,n,r){return{tableView:e,targetRowKey:t,mailListItemSelectionSource:n,isCtrlOrCmdKeyDown:r}})),S=Object(a.action)("RESET_SELECTION",(function(e,t){return{tableView:e,mailListItemSelectionSource:t}})),y=Object(a.action)("RESET_SELECTION",(function(e){return{tableView:e}})),C=Object(a.action)("SELECT_ROW_IN_DIRECTION",(function(e,t,n){return Object(i.c)(x(n,e,void 0,t),{tableView:e,selectionDirection:t,mailListItemSelectionSource:n})})),T=Object(a.action)("KEYBOARD_MULTI_SELECT_ROW",(function(e,t,n,r){return{tableView:e,mailListItemSelectionSource:t,selectionDirection:n,isCtrlOrCmdKeyDown:r}})),_=Object(a.action)("KEYBOARD_COLLAPSE_CONVERSATION",(function(e){return{rowKey:e}})),k=Object(a.action)("RESET_BUS_STOP_STATE_MAP"),E=Object(a.action)("SELECT_NEW_ITEM_UPON_ROW_REMOVAL",(function(e,t,n){return{tableView:e,lastSelectedRowIndex:t,lastSelectedRowWasPinned:n}})),A=Object(a.action)("INIT_TABLE_SELECTION_ON_LOAD",(function(e){return{tableView:e}}));function x(e,t,n,i){return{name:function(e,t,n,i){return!(function(e){return e===u.b.MailListItemRichPreview||e===u.b.KeyboardShiftEnter||e===u.b.MailListItemBodyDoubleClick}(e)||Object(c.r)()&&!function(e){var t;return e===u.b.KeyboardEnter||e===u.b.MailListItemBody||e===u.b.RouteHandler||e===u.b.CommandBarArrows||e===u.b.ImmersiveReadingPaneDelete&&"ReturnToView"!==(null===(t=Object(s.a)().UserOptions)||void 0===t?void 0:t.NextSelection)}(e)||function(e,t,n,i){if(Object(c.r)())return!1;if(e===u.b.KeyboardUpDown){var a=t.rowKeys.indexOf(t.selectionAnchorRowKey);if(-1!==a&&1===t.selectedRowKeys.size){var s=t.rowKeys.indexOf(Object(r.__spread)(t.selectedRowKeys.keys())[0]);return i===o.d.Next?s===a+1||s===t.rowKeys.length-1&&a===t.rowKeys.length-1:s===a-1||0===s&&0===a}return!1}return n&&t.selectedRowKeys.has(n)&&1===t.selectedRowKeys.size}(e,t,n,i))}(e,t,n,i)?"SelectMailItem":"SelectMailItemNonCritical",options:{timeout:9e4}}}},1260:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(315);function i(e){return{headers:Object(r.f)(e,"GroupMailbox")}}},1275:function(e,t,n){"use strict";n.d(t,"j",(function(){return r})),n.d(t,"l",(function(){return i})),n.d(t,"z",(function(){return o})),n.d(t,"x",(function(){return u})),n.d(t,"a",(function(){return a})),n.d(t,"r",(function(){return c})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return b})),n.d(t,"i",(function(){return m})),n.d(t,"e",(function(){return v})),n.d(t,"m",(function(){return O})),n.d(t,"d",(function(){return h})),n.d(t,"k",(function(){return p})),n.d(t,"w",(function(){return g})),n.d(t,"p",(function(){return j})),n.d(t,"y",(function(){return I})),n.d(t,"q",(function(){return w})),n.d(t,"u",(function(){return S})),n.d(t,"v",(function(){return y})),n.d(t,"n",(function(){return C})),n.d(t,"s",(function(){return T})),n.d(t,"t",(function(){return _})),n.d(t,"o",(function(){return k}));var r="multipart/signed",i="application/pkcs7-mime",o="application/x-pkcs7-mime",u=".p7m",a="CLSID:56023A83-B4FC-413B-9285-6BB1DAD977A2",c="CLASSID",s="4",d="0800",l=57,f=78,b=16,m=11,v="IPM.Note.SMIME.MultipartSigned",O="smime-",h="image",p="OwaToSmime",g="SmimeToOwa",j="en-US",I=["Culture","CodePage","AttachmentSizeLimit","UseKeyIdentifier","AllowUserChoiceOfSigningCertificate","IncludeCertificateChainWithoutRootCertificate","IncludeCertificateChainAndRootCertificate","EncryptTemporaryBuffers","SignedEmailCertificateInclusion","IncludeSmimeCapabilitiesInMessage","CopyRecipientHeaders","OnlyUseSmartCard","EncryptionAlgorithms","SigningAlgorithms","AlwaysEncrypt","AlwaysSign","TripleWrapSignedEncryptedMail","BccEncryptedEmailForking"],w="https://outlook-1.cdn.office.net/owasmime/20.20.514.1/owasmime.msi",S="OwaSmimeEdgeExtension.appxbundle",y="https://outlook-1.cdn.office.net/owasmime/20.20.514.1/OwaSmimeEdgeExtension.appxbundle",C="https://outlook-1.cdn.office.net/owasmime/20.20.514.1/SmimeOutlookWebChrome.msi",T="https://outlook-1.cdn.office.net/owasmime/20.20.514.1/SmimeOutlookWebChrome.msi",_="https://microsoftedge.microsoft.com/addons/detail/gamjhjfeblghkihfjdpmbpajhlpmobbp",k="chrome-extension://maafgiompdekodanheihhgilkjchcakm/Options.html"},1319:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1260),i=n(114),o={};function u(e){var t=e.toLocaleLowerCase();if(!o[t]){var n={type:i.a.GroupMailbox,userIdentity:Object(i.e)().userIdentity,mailboxSmtpAddress:e,routingKey:Object(i.c)()+e,requestOptions:Object(r.a)(e)};o[t]=n}return o[t]}},1331:function(e,t,n){"use strict";var r={};n.r(r),n.d(r,"add",(function(){return s})),n.d(r,"remove",(function(){return d})),n.d(r,"removeAll",(function(){return l})),n.d(r,"getCount",(function(){return f})),n.d(r,"getTombstonedReasons",(function(){return b})),n.d(r,"clearMapForFolder",(function(){return m})),n.d(r,"removeRowsFromTombstone",(function(){return v}));var i=n(0),o=n(4),u=Object(o.createStore)("tombstone",{folderTombstoneMap:{}}),a=(u(),n(254)),c=n(283),s=Object(c.action)("tombstoneOperations.add")((function(e,t,n){var r=u().folderTombstoneMap;t in r||(r[t]={});var i=r[t];e.forEach((function(e){var t=i[e];t?3!=n?t.indexOf(3)>-1||-1==t.indexOf(n)&&t.push(n):i[e]=[3]:i[e]=[n]}))})),d=Object(c.action)("tombstoneOperations.remove")((function(e,t,n){var r=u().folderTombstoneMap;if(t in r){var i=r[t],o=i[e],a=o?o.indexOf(n):-1;if(-1==a)throw new Error("tombstone.remove given reason does not exist when trying to remove entry from it");o.splice(a,1),0==o.length&&delete i[e],0==Object.keys(i).length&&delete r[t]}})),l=Object(c.action)("tombstoneOperations.removeAll")((function(){u().folderTombstoneMap={},Object(a.p)("TnS_RemoveAllFromTombstone")})),f=function(e,t){var n=u().folderTombstoneMap;if(!(e in n))return 0;var r=0,i=n[e];return Object.values(i).forEach((function(e){e==t&&r++})),r},b=function(e,t){var n=u().folderTombstoneMap;if(t in n){var r=n[t][e];if(r)return r}return[]},m=Object(c.action)("tombstoneOperations.clearMapForFolder")((function(e){var t=u().folderTombstoneMap;t[e]&&(Object(a.p)("TnS_ClearFolderMapInTombstone",[Object.keys(t[e]).length]),delete t[e])})),v=Object(c.action)("tombstoneOperations.removeRowsFromTombstone")((function(e,t){var n,r,o=u().folderTombstoneMap;if(t in o){var a=o[t];try{for(var c=Object(i.__values)(e),s=c.next();!s.done;s=c.next()){var d=s.value;d in a&&delete a[d]}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}0==Object.keys(a).length&&delete o[t]}}));t.a=r},1359:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1890);function i(e){return e&&Object(r.b)(e.ItemClass)}},1390:function(e,t,n){"use strict";var r=n(1550),i=n(76),o=n(984),u=n(581);function a(){return Object(i.h)("auth-cloudCache")&&(Object(o.b)()||Object(o.c)())&&Object(u.a)()||Object(r.a)()}n.d(t,"a",(function(){return a}))},1397:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.PrimaryActionClicked=0]="PrimaryActionClicked",e[e.SecondaryActionClicked=1]="SecondaryActionClicked",e[e.DismissClicked=2]="DismissClicked",e[e.AutoDismissed=3]="AutoDismissed",e[e.MouseLeaveAfterTimerCompleted=4]="MouseLeaveAfterTimerCompleted",e[e.NotificationBarUnmounted=5]="NotificationBarUnmounted"}(r||(r={}))},1423:function(e,t,n){"use strict";var r=n(24),i=n(4),o={folderTable:new r.ObservableMap,rootFolder:null},u=Object(i.createStore)("publicFolderFavoriteStore",o)();t.a=u},1474:function(e,t,n){"use strict";var r=n(4),i=n(114),o=n(948),u=n(953),a=n(24),c=Object(r.createStore)("mailboxInfoStore",new a.ObservableMap),s=n(27);function d(e){if(!e)return Object(i.e)();if(!c().has(e)){var t=function(e){var t,n,r=Object(o.o)(),a=r&&r.get(e);a&&a.treeType===u.j?(t=a.principalSMTPAddress,n=Object(i.c)()+a.principalSMTPAddress):(t=Object(s.a)().SessionSettings.UserEmailAddress,n=Object(i.b)());return{type:i.a.UserMailbox,userIdentity:t,mailboxSmtpAddress:t,routingKey:n,requestOptions:Object(o.i)(e)}}(e);l(e,t)}return c().get(e)}var l=Object(r.mutatorAction)("addMailboxInfoToStore",(function(e,t){c().set(e,t)})),f=n(1319),b=n(1082),m=n(2213);function v(e){return e?O(e.tableQuery):Object(i.e)()}function O(e){var t=Object(b.b)(e),n=null==e?void 0:e.folderId;return null!=t?Object(f.a)(t):h(n)}function h(e){return Object(o.G)(e)?Object(m.a)(e):d(e)}n.d(t,"a",(function(){return v})),n.d(t,"c",(function(){return O})),n.d(t,"b",(function(){return h}))},1485:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var r=1,i=16},1503:function(e,t,n){"use strict";function r(){return{isBeingDragged:!1}}n.d(t,"a",(function(){return r}))},1517:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var r=20,i=10},1535:function(e,t,n){"use strict";var r=n(108),i=n(1913),o=n(1964),u=n(1914),a=n(1777),c=n(1915),s=n(1860),d=n(1965);function l(e){var t=e;return"Single"===t.CalendarItemType&&!t.RecurrenceId}function f(e){return!!e.RecurrenceId}n.d(t,"s",(function(){return m})),n.d(t,"t",(function(){return v})),n.d(t,"w",(function(){return O})),n.d(t,"d",(function(){return h})),n.d(t,"g",(function(){return p})),n.d(t,"h",(function(){return g})),n.d(t,"b",(function(){return j})),n.d(t,"f",(function(){return I})),n.d(t,"e",(function(){return w})),n.d(t,"i",(function(){return S})),n.d(t,"j",(function(){return y})),n.d(t,"a",(function(){return C})),n.d(t,"c",(function(){return T})),n.d(t,"v",(function(){return _})),n.d(t,"u",(function(){return k})),n.d(t,"k",(function(){return i.a})),n.d(t,"x",(function(){return o.a})),n.d(t,"m",(function(){return u.a})),n.d(t,"q",(function(){return a.a})),n.d(t,"r",(function(){return c.a})),n.d(t,"l",(function(){return s.a})),n.d(t,"o",(function(){return d.a})),n.d(t,"p",(function(){return l})),n.d(t,"n",(function(){return f}));var b=new r.c((function(){return Promise.all([n.e(5),n.e(7),n.e(10),n.e(29),n.e(411)]).then(n.bind(null,14983))})),m=new r.a(b,(function(e){return e.addItemToCalendar})),v=new r.a(b,(function(e){return e.initializeMeetingRequestViewStateAction})),O=new r.a(b,(function(e){return e.removeCancelledMeetingFromCalendar})),h=Object(r.d)(b,(function(e){return e.MeetingMessageInfo})),p=(Object(r.d)(b,(function(e){return e.MeetingRequestActions})),Object(r.d)(b,(function(e){return e.MeetingCancellationAction})),Object(r.d)(b,(function(e){return e.MeetingActionButton})),Object(r.d)(b,(function(e){return e.MeetingDetailsTime})),Object(r.d)(b,(function(e){return e.MeetingDetailsLocation})),Object(r.d)(b,(function(e){return e.MeetingRequestInfo}))),g=Object(r.d)(b,(function(e){return e.MeetingRequestResponseEditor})),j=Object(r.d)(b,(function(e){return e.MeetingDetails})),I=Object(r.d)(b,(function(e){return e.MeetingRequestConflicts})),w=(Object(r.d)(b,(function(e){return e.EditEventLink})),Object(r.d)(b,(function(e){return e.MeetingMessageSummary}))),S=Object(r.d)(b,(function(e){return e.PreviewSummary})),y=Object(r.d)(b,(function(e){return e.SenderSummary})),C=Object(r.d)(b,(function(e){return e.CollapsedMeetingMessage})),T=Object(r.d)(b,(function(e){return e.MeetingIcon})),_=new r.a(b,(function(e){return e.logMeetingMessageActionForInvite})),k=new r.a(b,(function(e){return e.logMeetingMessageActionForEvent}))},1550:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(76),i=n(103);function o(){return Object(r.h)("mail-oneView")&&Object(i.t)()}},1575:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="IPM.Note.SMIME"},1656:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(315);function i(e){var t=new Headers;return Object(r.g)(e,t),{headers:t}}},1671:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1058);function i(){return Object(r.a)().showReadingPane}},1672:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),i=n(963),o=n(1802),u=n(2135),a=n(4);function c(e){var t,n,a,c;if(i.w.conversations.has(e)){var l=i.w.conversations.get(e);try{for(var f=Object(r.__values)(l.conversationNodeIds),b=f.next();!b.done;b=f.next()){var m=b.value,v=i.w.conversationNodes.get(m);if(v)try{for(var O=(a=void 0,Object(r.__values)(v.itemIds)),h=O.next();!h.done;h=O.next()){var p=h.value;Object(o.a)(p,1)}}catch(e){a={error:e}}finally{try{h&&!h.done&&(c=O.return)&&c.call(O)}finally{if(a)throw a.error}}s(m)}}catch(e){t={error:e}}finally{try{b&&!b.done&&(n=f.return)&&n.call(f)}finally{if(t)throw t.error}}d(e)}Object(u.a)()}var s=Object(a.mutatorAction)("deleteConversationNode",(function(e){i.w.conversationNodes.delete(e)})),d=Object(a.mutatorAction)("deleteConversation",(function(e){i.w.conversations.delete(e)}))},1727:function(e,t,n){"use strict";var r=n(108),i=n(1672),o=n(963),u=n(283),a=Object(u.action)("setIsPendingDeleteConversationItemParts")(Object(u.select)({conversationItemParts:function(e){return o.w.conversations.get(e)}})((function(e,t,n){var r=n.conversationItemParts;r&&(r.isPendingDelete=t)}))),c=n(1517);n.d(t,"c",(function(){return d})),n.d(t,"e",(function(){return l})),n.d(t,"d",(function(){return f})),n.d(t,"b",(function(){return i.a})),n.d(t,"f",(function(){return a})),n.d(t,"a",(function(){return c.b}));var s=new r.c((function(){return n.e(406).then(n.bind(null,15045))})),d=new r.a(s,(function(e){return e.loadAllRecipientsForItem})),l=new r.a(s,(function(e){return e.loadItem})),f=new r.a(s,(function(e){return e.loadConversation}))},1777:function(e,t,n){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.request/i)}n.d(t,"a",(function(){return r}))},1802:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("TRY_REMOVE_FROM_MAIL_STORE_ITEMS",(function(e,t){return{itemIdToRemove:e,removeItemSource:t}}))},1860:function(e,t,n){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.canceled/i)}n.d(t,"a",(function(){return r}))},1890:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c}));var r=n(1275),i=n(1575);function o(e){return e&&0===e.indexOf(r.e)}function u(e){return e&&0===e.indexOf(i.a)&&!o(e)}function a(e){return e&&0===e.indexOf(i.a)}function c(e){return e.match(/^ipm\.(appointment|schedule\.meeting(?!\.notification))/i)}},1909:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1068),i=n(1671);function o(){return Object(r.c)()&&Object(i.a)()}},1913:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("deleteMeetingMessage",(function(e,t){return{item:e,issueDeleteItemCall:t}}))},1914:function(e,t,n){"use strict";function r(e){return(null==e?void 0:e.ItemClass)&&e.ItemClass.match(/^ipm\.(appointment|schedule\.meeting(?!\.notification))/i)}n.d(t,"a",(function(){return r}))},1915:function(e,t,n){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.resp/i)}n.d(t,"a",(function(){return r}))},1921:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4),i=Object(r.action)("USERMAIL_INTERACTION",(function(e,t,n){return{interactionType:e,instrumentationContexts:t,triageContext:n}}))},1931:function(e,t,n){"use strict";var r=n(27);function i(){var e=Object(r.a)().UserOptions;return e.IsFocusedInboxFeatureSupported&&e.IsFocusedInboxEnabled}n.d(t,"a",(function(){return i}))},1932:function(e,t,n){"use strict";var r=n(4),i=n(24),o=n(948),u=n(2699),a=n(1108),c=(Object(r.mutator)(u.a,(function(e){var t=o.d.folderTable.get(e.folderId);t&&(e.isDeltaChange?(t.UnreadCount+=e.unreadCount,t.TotalCount+=e.totalCount):(t.UnreadCount=e.unreadCount,t.TotalCount=e.totalCount),t.pausedTotalCount&&Object(a.b)()===e.folderId&&(t.pausedTotalCount=t.TotalCount),t.UnreadCount=Math.max(t.UnreadCount,0),t.TotalCount=Math.max(t.TotalCount,0))})),{folderNodeViewStates:new i.ObservableMap({}),contextMenuState:null,folderTextFieldViewState:null,isDraggedOver:!1,withContextMenuFolderId:null,shouldShowMoveDialog:!1,moveToDestinationFolderId:null}),s=Object(r.createStore)("folderViewState",c)();t.a=s},1963:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2764),i=n(1932),o=n(1503),u=n(1016),a=n(947);function c(e){if(!i.a.folderNodeViewStates.has(e)){var t=a.c.getDefaultSortBy();Object(r.a)(e,{isExpanded:!1,sortColumn:t.sortColumn,sortOrder:t.sortDirection,drag:Object(o.a)(),drop:Object(u.a)()})}return i.a.folderNodeViewStates.get(e)}},1964:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("meetingMessageAddToCalendarStatusChanged",(function(e,t){return{status:e,sxsId:t}}))},1965:function(e,t,n){"use strict";function r(e){var t=e;return"RecurringMaster"===t.CalendarItemType&&!t.RecurrenceId}n.d(t,"a",(function(){return r}))},1987:function(e,t,n){"use strict";var r=n(108),i=n(947),o=n(1112),u=n(963),a=n(973),c=n(1575);var s=n(1359),d=n(283);function l(e,t){if(t.folderId&&"junkemail"==Object(a.a)(t.folderId))return!1;if(Object(s.a)(e))return!1;var n=u.w.items.get(e.ItemId.Id);return n?n.shouldShowAttachmentPreviews:!(!e.HasAttachments&&!e.HasSharepointLink)&&(v.importAndExecute(Object(o.c)(t),e.ConversationId,e.ItemId.Id),!0)}var f=Object(d.select)({listViewStore:function(){return i.T}})((function(e,t,n){var r,i,u,s=1==t.type,d=e.ConversationId,l=n.listViewStore.conversationItems.get(d.Id);if(t.folderId&&"junkemail"==Object(a.a)(t.folderId))return!1;if((null==(r=e)?void 0:r.ItemClasses)&&r.ItemClasses.length>0&&r.ItemClasses.some((function(e){return 0===e.indexOf(c.a)})))return!1;if(s){if(l)return l.shouldShowAttachmentPreviews;i=u=!!e.HasAttachments}else{if(!e.HasAttachmentPreviews&&!e.HasSharepointLink)return!1;l?(i=l.globalItemIds.length!=e.GlobalItemIds.length,u=l.shouldShowAttachmentPreviews):(i=!0,u=!0)}return i&&v.importAndExecute(Object(o.c)(t),e.ConversationId,null),u}));n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return v})),n.d(t,"c",(function(){return O})),n.d(t,"d",(function(){return h})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return l}));var b=new r.c((function(){return n.e(129).then(n.bind(null,15190))})),m=new r.a(b,(function(e){return e.getPreviews})),v=new r.a(b,(function(e){return e.add})),O=new r.a(b,(function(e){return e.getAttachmentsForConversationWell})),h=new r.a(b,(function(e){return e.removeAttachmentPreviewsForRow}))},1990:function(e,t,n){"use strict";var r=n(1724),i=n(2106),o=n(0),u=n(1539),a=n(1931),c=n(973),s=n(1109);var d=n(947);function l(e,t,n,l,f,b,m,v){var O,h=f||"All",p=m||Object(i.a)(e),g=null==l?function(e){if("inbox"!==Object(c.a)(e))return-1;if(!Object(a.a)())return-1;return 0}(e):l,j=null==v?function(e){var t,n;if("inbox"!==Object(c.a)(e))return 0;if(!Object(s.e)())return Object(a.a)()?1:0;var r=u.a.inboxPlusPivots;try{for(var i=Object(o.__values)(r),d=i.next();!d.done;d=i.next()){var l=d.value;if(l.isEnabled)return l.InboxClassificationFilter}}catch(e){t={error:e}}finally{try{d&&!d.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return 0}(e):v;switch(t){case 0:O=Object(r.f)(e,Object(d.N)(n));break;case 1:O=Object(r.i)()}return{folderId:e,focusedViewFilter:g,listViewType:t,viewFilter:h,sortBy:p,requestShapeName:O,type:0,shouldTryToUseSessionDataResponse:!0,categoryName:b,scenarioType:n,inboxClassificationFilter:j}}n.d(t,"a",(function(){return l}))},2072:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return c}));var r=n(108),i=n(1921);n.d(t,"d",(function(){return i.a}));var o=new r.c((function(){return n.e(371).then(n.bind(null,4106))})),u=new r.a(o,(function(e){return e.onKeyboardUpDown})),a=new r.a(o,(function(e){return e.onOpenEmail})),c=new r.a(o,(function(e){return e.onKeyboardToggleSelect}))},2100:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return c}));var r=n(108),i=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(266)]).then(n.bind(null,3460))})),o=(Object(r.d)(i,(function(e){return e.FeedbackForm})),Object(r.d)(i,(function(e){return e.FeedbackRibbon}))),u=Object(r.d)(i,(function(e){return e.KnownIssuesFeedbackFormHeader})),a=Object(r.d)(i,(function(e){return e.KnownIssuesFeedbackForm})),c=new r.b(i,(function(e){return e.launchFeedbackDialogWithoutRibbon}))},2103:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1058);function i(){return Object(r.a)().showListPane}},2106:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2285),i=n(947),o=n(1551),u=n(2376);function a(e){if(Object(u.a)()){var t=Object(r.c)()[e];if(t){var n=Object(o.getSupportedSortColumns)(e),a=t.SortColumn,c=t.SortOrder;if(n.includes(a))return{sortColumn:a,sortDirection:c}}}return i.c.getDefaultSortBy()}},2135:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(4),i=Object(r.action)("ON_DELETE_CONVERSATION_ITEM_PARTS_COMPLETE"),o=Object(r.action)("TOGGLE_ROW_READ_STATE_COMPLETE")},2213:function(e,t,n){"use strict";var r=n(947),i=n(948);function o(){var e=Object(r.C)();return e&&0==e.tableQuery.type&&Object(i.G)(e.tableQuery.folderId)}function u(){var e=Object(r.C)();return e&&0==e.tableQuery.type&&Object(i.G)(e.tableQuery.folderId)?e.tableQuery.folderId:null}var a=n(4),c=n(114),s=n(1656),d=n(1423),l=n(24),f=Object(a.createStore)("publicFolderUtilsStore",new l.ObservableMap),b=n(103);function m(e){if(!f().has(e)){var t=d.a.folderTable.get(e),n=null!=t.ReplicaList?t.ReplicaList[0]:Object(b.i)().SessionSettings.DefaultPublicFolderMailbox,r={type:c.a.PublicMailbox,userIdentity:Object(c.e)().userIdentity,mailboxSmtpAddress:n,routingKey:Object(c.c)()+n,requestOptions:Object(s.a)(n)};v(e,r)}return f().get(e)}var v=Object(a.mutatorAction)("addPublicFolderMailboxInfoToStore",(function(e,t){f().set(e,t)}));n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return m}))},2285:function(e,t,n){"use strict";var r=n(0),i=n(1963),o=n(297),u=n(327),a=n(329),c=n(330),s=n(317),d=n(285),l=n(328),f=n(246),b="OWA.ViewStateConfiguration",m="root",v=1e4,O=null;function h(e){var t=e.ViewStateConfiguration.FolderViewState;if(t){for(var n=[],r=0;r<t.length;r++)n.push(t[r]);O||(O=setTimeout((function(){var e,t,r,i;O=null,e=b,t={Type:"String",Value:["FolderViewState"]},r={Type:"StringArray",Value:n},i=Object(u.a)({UserConfigurationName:Object(l.a)({Name:e,BaseFolderId:Object(o.a)({Id:m})}),Dictionary:[Object(s.a)({DictionaryKey:Object(d.a)(t),DictionaryValue:Object(d.a)(r)})]}),Object(a.a)({Header:Object(f.a)(),Body:Object(c.a)({UserConfiguration:i})}).then((function(e){return e.Body.ResponseMessages.Items[0]}))}),v))}}var p=n(947),g=n(27),j=n(283),I=n(948),w=n(2412),S=n(973),y=n(963);function C(e){var t=Object(S.a)(e);return Object(w.a)(e)||Object(I.G)(e)?k.DateViewOnly:"drafts"==t||"junkemail"==t||"outbox"==t||"notes"==t?k.DateViewOnly:"deleteditems"==t||Object(y.m)(e)?k.DateView:k.ConversationView}function T(e){return"inbox"!=Object(S.a)(e)||Object(w.a)(e)?_.SearchRefinerScopeCurrentFolder:_.SearchRefinerScopeAll}var _,k,E=n(1166);function A(e){return JSON.parse(e,(function(e,t){return"SortOrder"!==e||1!==t&&0!==t?t:1===t?p.c.DESCENDING_SORT_DIR:p.c.ASCENDING_SORT_DIR}))}function x(){for(var e=Object(g.a)().ViewStateConfiguration.FolderViewState||[],t={},n=0;n<e.length;n++){var r=A(e[n]);t[r.FolderId.Id]=r}return t}function R(e){return JSON.stringify(e,(function(e,t){return"SortOrder"!==e||t!==p.c.DESCENDING_SORT_DIR&&t!==p.c.ASCENDING_SORT_DIR?t:t===p.c.DESCENDING_SORT_DIR?1:0}))}n.d(t,"b",(function(){return _})),n.d(t,"a",(function(){return k})),n.d(t,"c",(function(){return x})),n.d(t,"d",(function(){return M})),function(e){e[e.SearchRefinerScopeAll=0]="SearchRefinerScopeAll",e[e.SearchRefinerScopePrimaryMailbox=1]="SearchRefinerScopePrimaryMailbox",e[e.SearchRefinerScopeCurrentFolder=2]="SearchRefinerScopeCurrentFolder",e[e.SearchRefinerScopeCurrentFolderAndSubfolders=3]="SearchRefinerScopeCurrentFolderAndSubfolders"}(_||(_={})),function(e){e[e.ConversationView=1]="ConversationView",e[e.DateView=2]="DateView",e[e.DateViewOnly=3]="DateViewOnly",e[e.ItemGroupView=4]="ItemGroupView",e[e.BundledView=5]="BundledView"}(k||(k={}));var M=Object(j.action)("updateFolderViewState")((function(e){for(var t=Object(g.a)().ViewStateConfiguration.FolderViewState||[],n=!1,o=Object(i.a)(e),u=null,a=-1,c=0;c<t.length;c++){var s=A(t[c]);if(s.FolderId.Id===e){u=s,a=c;break}}var d=function(e,t,n){var i=n.sortOrder,o=n.sortColumn,u=n.isExpanded;if(t)return Object(r.__assign)(Object(r.__assign)({},t),{SortOrder:i,SortColumn:o,IsExpanded:u});var a=I.d.folderTable.get(e);return a?{FolderId:a.FolderId,View:C(a.FolderId.Id),Width:E.a,SortOrder:i,SortColumn:o,IsExpanded:u,ReadingPanePosition:Object(g.a)().UserOptions.GlobalReadingPanePositionReact,SearchScope:T(a.FolderId.Id)}:null}(e,u,o);d&&(-1!==a?(n=u!==d)&&(t[a]=R(d)):(n=!0,t.push(R(d))),n&&h(Object(g.a)()))}))},2304:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("REMOVE_ROWS_FROM_LISTVIEW_STORE",(function(e,t,n,r){return void 0===r&&(r=!0),{rowKeys:e,tableView:t,actionType:n,shouldRemoveFromAllTables:r}}))},2376:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1396);function i(){var e=Object(r.a)();return e&&(e.MajorVersion>15||e.MinorVersion>20||e.MajorBuildNumber>=1807)}},2380:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c}));var r=n(59),i=n(22),o=n(103),u=n(76);function a(){var e=Object(r.a)("targetServer"),t="DefaultAnchorMailbox"+(e?"_"+e.toLocaleLowerCase():"");return Object(r.a)(t)}function c(){var e,t,n=(e="",(t=Object(i.a)().pathname.split("/").filter((function(e){return e.length}))).length>=2&&t[1].match(/.+@.+/)&&(e=t[1]),e);if(Object(u.h)("fwk-puidBasedRouting")&&0===n.length){var r=Object(o.i)();if(null==r?void 0:r.SessionSettings){var c=r.SessionSettings.ExternalDirectoryTenantGuid,s=r.SessionSettings.UserPuid;s&&c&&(n="PUID:"+s+"@"+c)}}return 0===n.length&&(n=a()),n}},241:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,i=!1;function o(t){r--,delete e[t]}this.put=function(t,n,i,u){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==u&&"function"!=typeof u)throw new Error("Cache timeout callback must be a function");var a=e[t];a?clearTimeout(a.timeout):r++;var c={value:n,expire:i+Date.now()};return isNaN(c.expire)||(c.timeout=setTimeout(function(){o(t),u&&u(t,n)}.bind(this),i)),e[t]=c,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&o(t),n},this.clear=function(){for(var o in e)clearTimeout(e[o].timeout);r=0,e=Object.create(null),i&&(t=0,n=0)},this.get=function(o){var u=e[o];if(void 0!==u){if(isNaN(u.expire)||u.expire>=Date.now())return i&&t++,u.value;i&&n++,r--,delete e[o]}else i&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){i=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),i=Date.now(),o=n&&n.skipDuplicates;for(var u in r)if(r.hasOwnProperty(u)){if(o)if(e[u])continue;var a=r[u],c=a.expire-i;if(c<=0){this.del(u);continue}c=c>0?c:void 0,this.put(u,a.value,c)}return this.size()}}e.exports=new r,e.exports.Cache=r},2412:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(948),i=n(953);function o(e){return Object(r.C)(e,i.j)}},2699:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("UPDATE_FOLDER_COUNTS",(function(e,t,n,r){return{unreadCount:e,totalCount:t,folderId:n,isDeltaChange:r}}))},2764:function(e,t,n){"use strict";var r=n(1932),i=n(283);t.a=Object(i.action)("setFolderViewState")((function(e,t){r.a.folderNodeViewStates.set(e,t)}))},2918:function(e,t){e.exports=function(e,t){var n=e.length;if(n!==t.length)return!1;for(var r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}},3739:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2106),i=n(1990),o=n(947),u=n(1237),a=n(950);function c(e,t){var n=Object(a.a)("inbox"),c=Object(i.a)(n,Object(o.w)(n),"mail",e,null,null,Object(r.a)(n),t);return Object(u.c)(c)}},482:function(e,t,n){"use strict";var r=function(){function e(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}return e.prototype.add=function(e){this.taskList.unshift(e),this.scheduleTask()},e.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},e.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},e.prototype.scheduleTask=function(){var e=this;this.canRunMoreTasks()&&setTimeout((function(){e.tryRunTask()}),this.taskDelay)},e.prototype.tryRunTask=function(){this.canRunMoreTasks()&&this.runTask()},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e.prototype.runTask=function(){var e=this,t=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(t).then((function(){e.onTaskComplete()})).catch((function(){e.onTaskComplete()})),this.scheduleTask()},e}();n.d(t,"a",(function(){return r}))},5482:function(e,t,n){"use strict";n.r(t);var r,i=n(4),o=Object(i.action)("onCacheUpdated",(function(e,t){return{interactionType:e,triageContext:t}})),u=Object(i.action)("onSpotlightDismissedFromLV",(function(e,t,n){return{rowKey:e,tableQuery:t,isConversationView:n}})),a=Object(i.action)("onSpotlightDismissedFromLVProcessed",(function(e){return{rowKey:e}})),c=Object(i.action)("onSpotlightItemsFetched",(function(e,t){return{spotlightItems:e,isConversationView:t}})),s=n(2763);!function(e){e[e.Unknown=0]="Unknown",e[e.Weak=1]="Weak",e[e.Strong=2]="Strong"}(r||(r={}));var d,l=function(e){switch(e){case"Categorize":case"CreateRule":case"Flag":case"Like":case"MarkAsRead":case"MarkAsReadImplicit":case"MarkAsUnread":case"Snooze":return r.Weak;case"Block":case"MarkAsJunk":case"Delete":case"FlagCleared":case"FlagComplete":case"Forward":case"Ignore":case"MarkAsPhishing":case"Move":case"Pin":case"Reply":case"ReplyAll":case"ReportAbuse":case"Unpin":return r.Strong;default:return r.Unknown}},f=n(2698),b=n(947),m=n(3),v=n(0),O=n(8);!function(e){e[e.Acknowledged=0]="Acknowledged",e[e.Dismissed=1]="Dismissed"}(d||(d={}));var h=function(e,t){var n,r,i=j(e);try{for(var o=Object(v.__values)(t),u=o.next();!u.done;u=o.next()){var a=u.value;i.push(a)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}Object(O.d)(window,I(e),JSON.stringify(i))},p=function(e){var t,n,r=e.spotlightCacheType,i=e.itemId,o=e.conversationId,u=e.rowKey,a=j(r);try{for(var c=Object(v.__values)(a),s=c.next();!s.done;s=c.next()){var d=s.value;if(i&&d.itemId===i||o&&d.conversationId===o||u&&d.rowKey===u)return!0}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return!1},g=function(e,t){var n,r,i,o,u=j(e),a=[];try{for(var c=Object(v.__values)(u),s=c.next();!s.done;s=c.next()){var d=s.value,l=d.itemId,f=d.conversationId,b=d.rowKey;try{for(var m=(i=void 0,Object(v.__values)(t)),h=m.next();!h.done;h=m.next()){var p=h.value,g=p.itemId,w=p.conversationId,S=p.rowKey;if(l&&l===g||f&&f===w||b&&b===S){a.push(p);break}}}catch(e){i={error:e}}finally{try{h&&!h.done&&(o=m.return)&&o.call(m)}finally{if(i)throw i.error}}}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}Object(O.d)(window,I(e),JSON.stringify(a))},j=function(e){var t=Object(O.a)(window,I(e));return t?JSON.parse(t):[]},I=function(e){return e===d.Acknowledged?"acknowledgedSpotlightItems":"dismissedSpotlightItems"};Object(i.mutator)(c,(function(e){var t=e.spotlightItems,n=e.isConversationView,r=S(),i=t.concat(r),o=[],u=i.concat(r).filter((function(e){var t=n?e.conversationId:e.itemId;return!(o.indexOf(t)>-1)&&(o.push(t),!0)}));!function(e){g(d.Acknowledged,e),g(d.Dismissed,e)}(u),Object(s.a)().spotlightItems=u.filter((function(e){return!e.isDismissed}))})),Object(i.mutator)(a,(function(e){for(var t=e.rowKey,n=Object(s.a)().spotlightItems,r=0;r<n.length;r++){if(n[r].rowKey===t){n.splice(r,1);break}}})),Object(i.mutator)(o,(function(e){if(Object(f.a)()){var t=e.triageContext,n=void 0===t?{}:t,i=e.interactionType,o=n.itemIds,u=void 0===o?[]:o,a=n.conversationIds,c=void 0===a?[]:a,s=n.rowKeys,d=void 0===s?[]:s;if(u=u.filter((function(e){return!!e})),c=c.filter((function(e){return!!e})),d=d.filter((function(e){return!!e})),0!==u.length||0!==c.length||0!==d.length)switch(l(i)){case r.Weak:w({itemIds:u,conversationIds:c,rowKeys:d,actionCategory:r.Weak});break;case r.Strong:w({itemIds:u,conversationIds:c,rowKeys:d,actionCategory:r.Strong});break;case r.Unknown:}}}));var w=function(e){var t=e.itemIds,n=e.conversationIds,i=e.rowKeys,o=e.actionCategory,u=Object(s.a)().spotlightItems;u.map((function(e,a){(t.indexOf(e.itemId)>-1||n.indexOf(e.conversationId)>-1||i.indexOf(e.rowKey)>-1)&&(o===r.Weak?e.isAcknowledged=!0:o===r.Strong&&u.splice(a,1))}))},S=function(){var e=[],t=Object(m.a)("testSpotlight");if(t)for(var n=Object(b.C)(),r=parseInt(t),i=0;i<r;i++){var o=n.rowKeys[i],u=b.b.getItemIds(o,n)[0],a=b.b.getConversationId(o,n);o&&e.push({rowKey:o,itemId:u,conversationId:a,isAcknowledged:p({spotlightCacheType:d.Acknowledged,itemId:u,conversationId:a,rowKey:o}),isDismissed:p({spotlightCacheType:d.Dismissed,itemId:u,conversationId:a,rowKey:o}),reason:0,senderName:b.b.getLastSenderMailbox(o,n).Name,referenceId:"00000000-0000-0000-0000-000000000000"})}return e},y=Object(i.action)("onSpotlightFilterLoaded",(function(e){return{actionSource:e}})),C=Object(i.action)("onSpotlightRollupDismissed");Object(i.mutator)(C,(function(){T(),_()})),Object(i.mutator)(y,(function(){T(),_()}));var T=function(){Object(s.a)().rollupDismissed||(Object(s.a)().rollupDismissed=!0)},_=function(){Object(s.a)().spotlightItems.map((function(e){return e.isAcknowledged=!0}))};function k(e){var t,n,r=Object(s.a)().spotlightItems;try{for(var i=Object(v.__values)(r),o=i.next();!o.done;o=i.next()){var u=o.value;if(u.rowKey===e)return u}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return null}var E=n(114),A=n(2100),x=n(2304),R=n(1727),M=n(965),D=n(1237),N=n(1093),F=n(1),L=n(11657);Object(i.orchestrator)(u,(function(e){return Object(v.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r;return Object(v.__generator)(this,(function(i){switch(i.label){case 0:return t=e.rowKey,n=e.tableQuery,[4,P(t)];case 1:return r=i.sent(),N.e.importAndExecute("dismiss-spotlight-lv-notification","MailModuleNotificationBarHost","",{},(function(){var e={buttonText:"Leave feedback",categories:[{logString:"I'd completed the task",uiString:"I'd completed the task"},{logString:"The message highlighted wasn't relevant",uiString:"The message highlighted wasn't relevant"},{logString:"I've replied to this message elsewhere",uiString:"I've replied to this message elsewhere"},{logString:"I don't like this feature",uiString:"I don't like this feature"}],ghostText:"Please add any extra comments here",invokeFeedbackDialog:!0,title:"Why is this message not important?",donationText:"Send a copy of your email message",donationJson:r};return F.createElement(A.a,{feature:"Spotlight",subFeature:"Spotlight",hideNoButton:!0,noFeedbackDialogParams:{hideButton:!0},ribbonMessage:"Marked as not important",ribbonMessageClassName:L.ribbonMessage,yesFeedbackDialogParams:e,buttonLinkClassName:L.buttonLinkClassName})})),h(d.Dismissed,[{rowKey:t}]),V(t,n),a(t),[2]}}))}))}));var P=function(e){return Object(v.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r,i,o;return Object(v.__generator)(this,(function(u){switch(u.label){case 0:return(t=k(e))?(n=Object(M.b)().items.get(t.itemId))?[3,2]:(r={Id:t.itemId,mailboxInfo:Object(E.e)()},[4,R.e.importAndExecute(r,"LoadSpotlightItem")]):[2,null];case 1:n=u.sent(),u.label=2;case 2:return[2,JSON.stringify({messageBody:(null===(i=n.UniqueBody)||void 0===i?void 0:i.Value)||(null===(o=n.NormalizedBody)||void 0===o?void 0:o.Value)||"",itemId:n.ItemId.Id})]}}))}))},V=function(e,t){var n=Object(v.__assign)(Object(v.__assign)({},t),{scenarioType:"spotlight"});Object(x.a)([e],Object(D.c)(n),"Spotlight",!1)},K=n(2762),B=n(2072);Object(i.orchestrator)(B.d,(function(e){if(Object(f.a)()){var t=e.triageContext,n=void 0===t?{}:t,i=e.interactionType,u=n.itemIds,a=void 0===u?[]:u,c=n.conversationIds,s=void 0===c?[]:c,b=n.rowKeys,m=void 0===b?[]:b;if(a=a.filter((function(e){return!!e})),s=s.filter((function(e){return!!e})),m=m.filter((function(e){return!!e})),0!==a.length||0!==s.length||0!==m.length){var v=l(i)===r.Strong?d.Dismissed:d.Acknowledged;a.map((function(e){Object(K.a)({itemId:e})&&!p({spotlightCacheType:v,itemId:e})&&h(v,[{itemId:e}])})),s.map((function(e){Object(K.a)({conversationId:e})&&!p({spotlightCacheType:v,conversationId:e})&&h(v,[{conversationId:e}])})),m.map((function(e){Object(K.a)({rowKey:e})&&!p({spotlightCacheType:v,rowKey:e})&&h(v,[{rowKey:e}])})),o(i,n)}}})),Object(i.orchestrator)(C,(function(){U()})),Object(i.orchestrator)(y,(function(){U()}));var U=function(){var e=Object(s.a)().spotlightItems.map((function(e){return{itemId:e.itemId,conversationId:e.conversationId,rowKey:e.rowKey}}));h(d.Acknowledged,e)},W=n(254);function G(e,t){var n;return{Categories:e.Categories,ConversationId:e.ConversationId&&{Id:e.ConversationId.Id,ChangeKey:null},ConversationIndex:e.ConversationIndex,DateTimeReceived:e.DateTimeReceived,DateTimeSent:e.DateTimeSent,LastModifiedTime:e.DateTimeLastModified,DisplayBcc:e.DisplayBcc,DisplayCc:e.DisplayCc,DisplayTo:e.DisplayTo,Flag:e.Flag&&{FlagStatus:e.Flag.FlagStatus,CompleteDate:e.Flag.CompleteDate,DueDate:e.Flag.DueDate,StartDate:e.Flag.StartDate},From:e.From&&{Mailbox:{EmailAddress:e.From.EmailAddress.Address,Name:e.From.EmailAddress.Name,RoutingType:"SMTP"}},HasAttachments:e.HasAttachments,Hashtags:e.Hashtags,Importance:e.Importance,IsDraft:e.IsDraft,IsRead:e.IsRead,ItemClass:e.ItemClass||"IPM.Note",ItemId:{Id:e.ItemId.Id,ChangeKey:e.ItemId.ChangeKey},ParentFolderId:e.ParentFolderId&&{Id:e.ParentFolderId.Id},Preview:e.Preview,Sender:e.Sender&&{Mailbox:{EmailAddress:e.Sender.EmailAddress.Address,Name:e.Sender.EmailAddress.Name,RoutingType:"SMTP"}},Sensitivity:e.Sensitivity,Subject:e.Subject,MentionedMe:null===(n=e.MentionsPreview)||void 0===n?void 0:n.IsMentioned,InstanceKey:t}}Object(i.orchestrator)(C,(function(){Object(W.o)("Spotlight_RollupDismissed")})),Object(i.orchestrator)(y,(function(e){Object(W.o)("Spotlight_FilterLoaded",[e.actionSource])})),Object(i.orchestrator)(u,(function(e){var t=e.isConversationView,n=e.rowKey,r=e.tableQuery,i=k(n),o=i.conversationId,u=i.itemId;Object(W.o)("Spotlight_ItemDismissed",{isImportantFilter:"spotlight"===r.scenarioType,conversationId:t?o:null,itemId:t?null:u})}));var z=n(274),H=n(428),q=n(1413),Q=n(1302),J=n(982);function X(e,t,n){var r,i,o,u,a,c,s,l,f;return Object(v.__awaiter)(this,void 0,void 0,(function(){var m,O,h,g,j,I,w,S,y,C,T,_,k,E,A;return Object(v.__generator)(this,(function(x){switch(x.label){case 0:return m=[],O=[],h=Object(b.L)(t),g=[],[4,e.json()];case 1:j=x.sent(),I=(null===(u=null===(o=null===(i=null===(r=null==j?void 0:j.EntitySets)||void 0===r?void 0:r[0])||void 0===i?void 0:i.ResultSets)||void 0===o?void 0:o[0])||void 0===u?void 0:u.Results)||[],Q.k.importAndExecute(J.a.ContextualInsights,null===(a=null==j?void 0:j.Instrumentation)||void 0===a?void 0:a.TraceId,n.getData(z.a.e2eTimeElapsed),e.status);try{for(w=Object(v.__values)(I),S=w.next();!S.done;S=w.next()){if(y=S.value,C=null===(c=y.Source.ConversationId)||void 0===c?void 0:c.Id,T=null===(s=y.Source.ItemId)||void 0===s?void 0:s.Id,_=Y(h?C:T,t),h){if(g.indexOf(C)>-1)continue;g.push(C)}h||p({spotlightCacheType:d.Dismissed,itemId:T,conversationId:C,rowKey:_})||O.push(G(y.Source,_)),m.push({conversationId:C,itemId:T,rowKey:_,isAcknowledged:p({spotlightCacheType:d.Acknowledged,itemId:T,conversationId:C,rowKey:_}),isDismissed:p({spotlightCacheType:d.Dismissed,itemId:T,conversationId:C,rowKey:_}),reason:0,senderName:null===(f=null===(l=y.Source.Sender)||void 0===l?void 0:l.EmailAddress)||void 0===f?void 0:f.Name,referenceId:y.ReferenceId})}}catch(e){E={error:e}}finally{try{S&&!S.done&&(A=w.return)&&A.call(w)}finally{if(E)throw E.error}}return h||(k=Object(v.__assign)(Object(v.__assign)({},t.tableQuery),{scenarioType:"spotlight"}),Object(q.c)(Object(D.c)(k),O,O.length,"SpotlightLoad")),[2,m]}}))}))}var Y=function(e,t){var n=Object(b.A)([e],t);return n.length>0?n[0]:(Object(W.o)("No row key found for Spotlight item."),Object(H.a)())},$=n(2380),Z=n(950),ee=n(699),te=function(){return Object(v.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n;return Object(v.__generator)(this,(function(r){switch(r.label){case 0:return e=Object(v.__read)(Object(ee.getAccessTokenforResourceAsLazy)(window.location.origin),2),t=e[0],n=e[1],t?[3,2]:[4,n];case 1:t=r.sent(),r.label=2;case 2:return[2,t||""]}}))}))},ne=function(e,t,n){var r={method:"POST"};r.headers=new Headers,r.headers.set("Authorization","Bearer "+t),r.headers.set("Content-Type","application/json;charset=utf-8"),r.headers.set("X-Client-LocalTime",(new Date).toISOString()),r.headers.set("client-request-id",e);var i=Object($.b)();i&&r.headers.append("X-AnchorMailbox",i);var o={EntityRequests:[{EntityType:"Message",Context:{EntityContext:[{"@type":"Microsoft.OutlookServices.MailFolder",id:Object(Z.a)("inbox")}]}}],Scenario:{Name:"ContextualInsights"}};return r.body=JSON.stringify(o),r},re=function(e){return Object(v.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(v.__generator)(this,(function(r){switch(r.label){case 0:return[4,te()];case 1:return t=r.sent(),n=ne(Object(H.a)(),t,Object(b.L)(e)),[4,fetch("/search/api/v1/recommendations",n)];case 2:return[2,r.sent()]}}))}))},ie=n(3739);function oe(){return Object(v.__awaiter)(this,void 0,void 0,(function(){var e,t,n,r;return Object(v.__generator)(this,(function(i){switch(i.label){case 0:return e=Object(ie.a)(),t=new W.a("SpotlightService",{sessionSampleRate:20}),[4,re(e)];case 1:return n=i.sent(),t.end(),[4,X(n,e,t)];case 2:return r=i.sent(),c(r,Object(b.L)(e)),[2]}}))}))}var ue=2;function ae(e,t,n){var r=Object(s.a)().spotlightItems.map((function(e){return e.isAcknowledged?null:e.senderName})).filter((function(e){return null!==e}));return function(e,t,n,r){return!Object(s.a)().rollupDismissed&&(!(e<ue)&&(!(n!==Object(Z.a)("inbox"))&&"All"===r))}(r.length,0,t,n)?{unseenCount:r.length,senderNames:ce(r)}:null}var ce=function(e){for(var t=[],n=0;n<e.length&&t.length<=2;n++){var r=e[n];-1===t.indexOf(r)&&t.push(r)}switch(t.length){case 1:return t[0];case 2:return t[0]+", "+t[1];default:return t[0]+", "+t[1]+" + "+(t.length-2)}};function se(){return Object(s.a)().spotlightItems.filter((function(e){return!e.isAcknowledged})).length}var de=n(27),le=function(e){var t=Object(de.a)().SessionSettings,n=t.UserPuid,r=t.ExternalDirectoryTenantGuid;Q.q.importAndExecute(J.a.ContextualInsights,n,r,Object(s.a)().logicalId,null,k(e).referenceId,"EntityClicked"),Object(W.o)("Spotlight_ItemClicked")},fe=n(1724),be=n(1112),me=n(2305),ve=n(79),Oe=n(1931);function he(e,t){return Object(v.__awaiter)(this,void 0,void 0,(function(){return Object(v.__generator)(this,(function(n){return[2,pe(e,t)]}))}))}function pe(e,t){return Object(v.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(v.__generator)(this,(function(i){return n=t.tableQuery,r=Object(be.c)(n),[2,fe.k.importAndExecute(Object(b.i)(n),e,Object(me.a)(n),n.requestShapeName,r.requestOptions,Object(Oe.a)()?0:-1).then((function(t){if("Success"==t.ResponseClass){var n=t.Conversations;if(n&&n.length>0&&n[0].ConversationId.Id===e)return n[0]}return null})).catch((function(e){return ve.g.warn("[loadSpotlightConversation] "+e.message),null}))]}))}))}function ge(e){return Object(v.__awaiter)(this,void 0,void 0,(function(){var t,n,r,i,o,u,a,c;return Object(v.__generator)(this,(function(d){switch(d.label){case 0:t=Object(s.a)().spotlightItems,n=[],d.label=1;case 1:d.trys.push([1,6,7,8]),r=Object(v.__values)(t),i=r.next(),d.label=2;case 2:return i.done?[3,5]:[4,he(i.value.conversationId,e)];case 3:o=d.sent(),n.push(o),d.label=4;case 4:return i=r.next(),[3,2];case 5:return[3,8];case 6:return u=d.sent(),a={error:u},[3,8];case 7:try{i&&!i.done&&(c=r.return)&&c.call(r)}finally{if(a)throw a.error}return[7];case 8:return[2,n]}}))}))}function je(e,t,n){return Object(v.__awaiter)(this,void 0,void 0,(function(){var r;return Object(v.__generator)(this,(function(i){switch(i.label){case 0:return Object(b.L)(e)?[4,ge(e)]:[3,2];case 1:r=i.sent(),Object(q.c)(e,r,r.length),i.label=2;case 2:return t(e,!0,"200",!1),y(n),[2]}}))}))}n.d(t,"initializeSpotlight",(function(){return oe})),n.d(t,"onSpotlightDismissedFromLV",(function(){return u})),n.d(t,"onSpotlightRollupDismissed",(function(){return C})),n.d(t,"getSpotlightRollupData",(function(){return ae})),n.d(t,"getUnacknowledgedSpotlightCount",(function(){return se})),n.d(t,"logSpotlightItemClicked",(function(){return le})),n.d(t,"loadSpotlightRowsFromServer",(function(){return je}))},984:function(e,t,n){"use strict";n.d(t,"l",(function(){return c})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return b})),n.d(t,"e",(function(){return m})),n.d(t,"i",(function(){return v})),n.d(t,"h",(function(){return O})),n.d(t,"f",(function(){return h})),n.d(t,"j",(function(){return p})),n.d(t,"k",(function(){return g})),n.d(t,"g",(function(){return j}));var r,i,o=n(3),u=n(59),a=n(27),c=["ar-sa","da-dk","de-at","de-ch","de-de","el-gr","en-ar","en-at","en-au","en-br","en-ca","en-ch","en-cl","en-co","en-de","en-dk","en-fi","en-gb","en-gr","en-hk","en-ie","en-in","en-mx","en-my","en-nl","en-no","en-nz","en-pe","en-pt","en-sa","en-se","en-sg","en-th","en-tr","en-us","en-za","es-ar","es-cl","es-co","es-ec","es-es","es-mx","es-pe","es-us","es-ve","fi-fi","fr-be","fr-ca","fr-ch","fr-fr","it-it","ja-jp","ko-kr","ms-my","nb-no","nl-be","nl-nl","pt-br","pt-pt","sv-se","th-th","tr-tr","zh-cn","zh-hk","zh-sg","zh-tw"],s=["ar-ir","es-cu","ko-kp","ar-sy","en-su","uk-ua"],d={ae:"ar-ae",ar:"es-ar",at:"de-at",au:"en-au",be:"fr-be",br:"pt-br",ca:"en-ca",ch:"de-ch",cl:"es-cl",cn:"zh-cn",co:"es-co",cr:"es-cr",cu:"es-cu",de:"de-de",dk:"da-dk",do:"es-do",ec:"es-ec",eg:"ar-eg",es:"es-es",fi:"fi-fi",fr:"fr-fr",gb:"en-gb",uk:"en-gb",gr:"el-gr",gt:"es-gt",hk:"zh-hk",id:"id-id",ie:"en-ie",in:"en-in",ir:"ar-ir",it:"it-it",jp:"ja-jp",kp:"ko-kp",kr:"ko-kr",mx:"es-mx",my:"ms-my",nl:"nl-nl",no:"nb-no",nz:"en-nz",pe:"es-pe",ph:"fil-ph",pl:"pl-pl",pt:"pt-pt",ru:"ru-ru",sa:"ar-sa",se:"sv-se",sg:"en-sg",su:"en-su",th:"th-th",tr:"tr-tr",tw:"zh-tw",ua:"uk-ua",us:"en-us",ve:"es-ve",vn:"vi-vn",za:"en-za"};function l(){return Object(a.a)().SessionSettings.IsPremiumConsumerMailbox}function f(){return Object(a.a)().IsConsumerChild}function b(){return Object(a.a)().SessionSettings.IsShadowMailbox}function m(){return void 0!==i?i:i=function(){if(Object(o.d)("ormarket"))return Object(o.a)("ormarket");var e=Object(a.a)(),t=e.SessionSettings.UserCulture;if(!e.AdMarket||!/^[a-zA-z\-]*$/.test(e.AdMarket))return t?t.toLowerCase():"en-us";var n=e.AdMarket.toLowerCase();return c.indexOf(n)>-1?n:d[n.split("-")[1]]||n}()}function v(e){return null!=e?e.toUpperCase().split("-"):[]}function O(e){return v(e)[1]||"US"}function h(){return Object(u.a)("ANON")}function p(){return Object(u.a)("MUID")}function g(){return!!Object(u.a)("TOptOut")}function j(){return r||(r=Object(o.a)("anjs")||"https://acdn.adnxs.com/ast/static/0.30.1/ast.js")}}}]);
//# sourceMappingURL=owa.Spotlight.js.map
self.scriptsLoaded['owa.Spotlight.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.Spotlight.js'] = (new Date()).getTime();