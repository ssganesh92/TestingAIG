/*! Version: 1.0.0; Third Party Notices: https://lpcres.delve.office.com/lpc/versionless/tpn-202d69e0d3dcf68a426911ae158b74fce72aea4365d3feba40dc7425e70e76f2af8f85ae80f8617144ca23754d7d664501a06ec8cfca7fb586081bc8852fb348.txt */
(window.webpackJsonpLpc=window.webpackJsonpLpc||[]).push([[38],{1002:function(e,n,t){(function(n){(function(){var t,r,i,o,a,c;"undefined"!=typeof performance&&null!==performance&&performance.now?e.exports=function(){return performance.now()}:null!=n&&n.hrtime?(e.exports=function(){return(t()-a)/1e6},r=n.hrtime,o=(t=function(){var e;return 1e9*(e=r())[0]+e[1]})(),c=1e9*n.uptime(),a=o-c):Date.now?(e.exports=function(){return Date.now()-i},i=Date.now()):(e.exports=function(){return(new Date).getTime()-i},i=(new Date).getTime())}).call(this)}).call(this,t(733))},1330:function(e,n,t){"use strict";t.d(n,"c",function(){return h}),t.d(n,"d",function(){return j}),t.d(n,"b",function(){return v}),t.d(n,"a",function(){return w}),t.d(n,"e",function(){return g});var r=t(10),i=t.n(r),o=t(5),a=t.n(o),c=t(492),s=t(114),u=t(162),p=t(350),l=t(142),d=t(560),f=t(494),b=t(501),m=function(e,n,t,r){return new(t||(t=a.a))(function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function c(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(a,c)}s((r=r.apply(e,n||[])).next())})};function h(e,n){return m(this,void 0,void 0,i.a.mark(function t(){var r,o;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n.dispatch(Object(u.c)({personaLpcKey:e.lpcKey})),r=n.getState(),o=d.a.getSelectors(r).getCardTemplateFailed(e.lpcKey),t.next=5,Object(b.b)(n,e,"",o,void 0,void 0);case 5:case"end":return t.stop()}},t)}))}function j(e,n,t){var r=O(e,n),i=Object(p.b)(n);r&&i?(Object(s.j)(e,n,t),n.dispatch(Object(u.d)({personaLpcKey:e.lpcKey,isExpandedViewEnabled:!0,section:"Conversations",windowId:t.windowId,navigationStartCheckpoint:Object(c.a)(),shouldResetHistory:!1,personaCorrelationId:n.getPersonaCorrelationId(e.lpcKey)})),i.renderExpandedView(n,"Conversations")):n.dispatch(Object(u.d)({personaLpcKey:e.lpcKey,isExpandedViewEnabled:!1}))}function v(e,n,t){var r=O(e,n),i=Object(p.b)(n);r&&i?(Object(s.j)(e,n,t),n.dispatch(Object(u.b)({personaLpcKey:e.lpcKey,isExpandedViewEnabled:!0,section:"Conversations",windowId:t.windowId,navigationStartCheckpoint:Object(c.a)(),shouldResetHistory:!1,personaCorrelationId:n.getPersonaCorrelationId(e.lpcKey)})),i.renderExpandedView(n,"Conversations")):n.dispatch(Object(u.b)({personaLpcKey:e.lpcKey,isExpandedViewEnabled:!1}))}function O(e,n){var t=Object(p.b)(n);return n.settings.isImmersiveProfileEnabled&&!!t&&!Object(l.a)(e)}function w(e,n,t,r,i){t.dispatch(Object(u.a)({email:e,indexClicked:r,personaLpcKey:n})),Object(f.h)(t)(e,n,i)}function g(e,n,t,r){t.dispatch(Object(u.f)({email:e,personaLpcKey:n})),Object(f.h)(t)(e,n,r)}},906:function(e,n,t){"use strict";t.r(n),t.d(n,"EmailsBlockView",function(){return g});var r=t(39),i=t(40),o=t(73),a=t(74),c=t(75),s=t(874),u=t(1776),p=t(118),l=t(865),d=t(964),f=t(2),b=t(195),m=t(1330),h=t(48),j=t(91),v=t(550),O=t(231),w=t(547),g=function(e){function n(){var e;return Object(r.a)(this,n),(e=Object(o.a)(this,Object(a.a)(n).apply(this,arguments))).getConvertedEmails=Object(p.memoizeFunction)(function(n){return n.map(function(n){return e.getEmailFromIEmail(n)})}),e}return Object(c.a)(n,e),Object(i.a)(n,[{key:"render",value:function(){var e=this,n=this.props.persona;if(!n||Object(h.b)(n))return null;var t=this.getConvertedEmails(this.props.emails);return f.createElement(u.a,{persona:n,messageEntities:t,isLoading:this.props.isLoading,isMePersona:this.props.isMePersona,showError:this.props.hasFailed,onTitleClick:function(){return m.d(n,e.lpcAppContext,e.props.renderingContext)},onFooterClick:function(){return m.b(n,e.lpcAppContext,e.props.renderingContext)},onRetryClick:function(){return m.c(n,e.lpcAppContext)},onMessageEntityClick:function(r,i){return m.a(e.props.emails[t.indexOf(r,0)],n.lpcKey,e.lpcAppContext,i)}})}},{key:"getEmailFromIEmail",value:function(e){return{subject:e.Subject,preview:e.Preview,emailFrom:e.From,fromName:e.FromName,received:Object(s.a)((Object(O.b)(e.Received)||Object(O.a)()).date,new Date,Object(w.b)(this.lpcAppContext),this.lpcAppContext.logger),isRead:e.IsRead,hasAttachments:e.HasAttachments,isAtMentioned:e.IsAtMentioned,flagStatus:e.FlagStatus,importance:e.Importance,kind:"Email"}}}]),n}(t(171).a);var y=Object(d.a)(g,function(e){var n=e.persona,t=e.hasFailed,r=e.isLoading,i=e.emails,o=e.isMePersona;return{componentName:"EmailsBlock",identifier:n&&n.lpcKey.key||"",logProperties:{hasFailed:t,isLoading:r,emailsCount:i.length.toString(),isMePersona:o}}}),C=Object(b.b)(function(e,n){var t=Boolean(Object(v.a)(e,n.persona));if(!n.persona)return{emails:[],isLoading:!1,hasFailed:!1,isMePersona:t};var r=Object(j.d)(e,n.persona.lpcKey);return{emails:r.emails,isLoading:r.isLoading,hasFailed:r.hasError,isMePersona:t}})(Object(l.a)(y));n.default=C},964:function(e,n,t){"use strict";t.d(n,"a",function(){return s});var r=t(3),i=t.n(r),o=t(2),a=t(966),c=function(){return(c=i.a||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}).apply(this,arguments)};function s(e,n){return function(t){var r=n(t);return Object(a.a)(r),o.createElement(e,c({},t))}}},966:function(e,n,t){"use strict";t.d(n,"a",function(){return p});var r=t(3),i=t.n(r),o=t(267),a=t(2),c=t(558),s=function(){return(s=i.a||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}).apply(this,arguments)},u=t(1002);function p(e){var n=Object(c.c)(),t=Object(c.d)(),r=e.identifier,i=e.logProperties,p=t+e.componentName,l=Object(a.useRef)(null),d=Object(a.useRef)(null),f=Object(a.useRef)(null),b=Object(a.useRef)(0);Object(a.useEffect)(function(){return null===l.current&&(l.current=u()),function(){d.current||(d.current=u());var e=l.current&&d.current?d.current-l.current:void 0,t=void 0!==e&&Math.round(e).toString()||"";if(n){var r=s({component:p,duration:t,renderCount:b.current.toString()},f.current);n(p,r)}l.current=null,f.current=null,d.current=null}},[r,p]),Object(a.useEffect)(function(){Object(o.a)(i,f.current)||(b.current++,d.current=u(),f.current=i)},[p,i])}}}]);