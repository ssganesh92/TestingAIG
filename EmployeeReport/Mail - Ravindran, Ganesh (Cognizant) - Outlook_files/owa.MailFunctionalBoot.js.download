self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailFunctionalBoot.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[388],{1017:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(295),o=n(988),a=n(76);function i(){var e;return(e={})[o.a.SmartSuggestions]={smartSuggestionsEnabled:!0,browserLocationEnabled:!1},e[o.a.DiverseEmojis]={diverseEmojisSelectedSkinTone:""},e[o.a.SurfaceActions]={readSurfaceActions:["Reply","ReplyAll","Forward"].concat(Object(r.a)()?[]:["LikeUnlike"]),readSurfaceAddins:[],composeSurfaceActions:["AddAttachment","AddInlineImage","AddEmoji","ToggleDictation","ProofingOptions","QuickUse","ToggleRibbon","FluidHeroButton"],composeSurfaceAddins:[]},e[o.a.SkypeNotifications]={skypeMessageNotification:1,skypeCallingNotification:1},e[o.a.Confetti]={confettiEnabled:!0},e[o.a.ComposeAssistance]={composeAssistanceEnabled:!0},e[o.a.GdprAdsPrefs]={feature:o.a.GdprAdsPrefs,consentString:null,allowStorageAndAccess:!1,allowPersonalization:!1,allowAdSelectionDeliveryReporting:!1,allowContentSelectionDeliveryReporting:!1,allowMeasurement:!1},e[o.a.CalendarSurfaceAddins]={calendarSurfaceAddins:[]},e[o.a.ExternalImages]={externalImagesSelectedOption:0},e[o.a.EventCapture]={autoCollectionEnabled:!1},e[o.a.Translation]={translationMode:0,targetLanguage:"",excludedLanguages:[]},e[o.a.CalendarSurfaceOptions]={agendaPaneIsClosed:!1,roamingTimeZoneTeachingMomentDisplayed:!1,bannedRoamingTimeZone:null,lastKnownRoamingTimeZone:null,roamingTimeZoneNotificationsIsDisabled:!1,allDayWellHeight:0,numDaysInDayRange:1,workLifeView:3},e[o.a.AmpDeveloper]={enabled:Object(a.h)("rp-ampDefault"),allowedSender:[]},e[o.a.CalendarHelp]={calendarHelpEnabled:!1},e[o.a.LinkedInViewProfile]={dismissed:!1},e[o.a.Bohemia]={bohemiaEnabled:Object(a.h)("cmp-prague")},e[o.a.GdprAdsV2]={feature:o.a.GdprAdsV2,consentString:null,allowStorageAndAccess:!0,allowPersonalization:!0,allowAdSelectionDeliveryReporting:!0,allowContentSelectionDeliveryReporting:!0,allowMeasurement:!0,disselectedVendorId:[],selectedVendorId:[]},e[o.a.GdprAdsV3]={feature:o.a.GdprAdsV3,encodedTCString:null,allStoreAndAccessDevice:!1,allowDevelopAndImproveProduct:!1,allowPersonalisedAds:!1,allowPersonalisedAdsSelectBasicAd:!1,allowPersonalisedAdsApplyMarketResearch:!1,allowPersonalisedAdsMeasureContentPerformance:!1,allowPersonalisedAdsSelectPersonalisedAds:!1,allowPersonalisedAdsMeasureAdPerf:!1,allowPersonalisedAdsSelectPersonalisedContent:!1,allowPersonalisedAdsCreatePersonalisedContentProfile:!1,allowPersonalisedAdsCreatePersonalisedAdsProfile:!1,allowPreciseGeoDataAndIdentifyDevice:!1,allowPreciseGeoDataAndIdentifyDeviceScanDevice:!1,allowPreciseGeoDataAndIdentifyDeviceGeoData:!1,disselectedVendorId:[],selectedVendorId:[]},e[o.a.Proofing]={feature:o.a.Proofing,spellCheckEnabled:!0,grammarEnabled:!0,writingRefinementsEnabled:!0,proofingLocale:void 0,overriddenOptions:void 0},e[o.a.ActiveProxyAddress]={feature:o.a.ActiveProxyAddress,activeProxyAddresses:[]},e[o.a.OutlookSpaces]={feature:o.a.OutlookSpaces,backgroundColor:"",gestureScheme:"pointer",toolboxCollapsed:!0},e[o.a.SxS]={feature:o.a.SxS,hideReadingPane:!1},e}},1051:function(e,t,n){"use strict";var r;!function(e){e[e.Unsupported=0]="Unsupported",e[e.Image=1]="Image",e[e.MailItem=2]="MailItem",e[e.CalendarEvent=3]="CalendarEvent",e[e.Wac=4]="Wac",e[e.SuiteExtensions=5]="SuiteExtensions",e[e.Audio=6]="Audio",e[e.Text=7]="Text",e[e.NativeView=8]="NativeView",e[e.GoogleDoc=9]="GoogleDoc",e[e.PdfJs=10]="PdfJs",e[e.ItemAttachment=11]="ItemAttachment",e[e.Video=12]="Video"}(r||(r={})),t.a=r},1066:function(e,t,n){"use strict";var r,o,a;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a})),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp",e[e.Peek=5]="Peek",e[e.CalendarCard=6]="CalendarCard"}(r||(r={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity",e[e.InsightMessage=7]="InsightMessage",e[e.External=8]="External"}(o||(o={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(a||(a={}))},1074:function(e,t,n){"use strict";var r;!function(e){e[e.ChangePermissions=0]="ChangePermissions",e[e.CopyLink=1]="CopyLink",e[e.Download=2]="Download",e[e.OpenInNewTab=3]="OpenInNewTab",e[e.Preview=4]="Preview",e[e.SaveToCloud=5]="SaveToCloud",e[e.ViewInProvider=6]="ViewInProvider",e[e.ConvertClassicToCloudy=7]="ConvertClassicToCloudy",e[e.ConvertCloudyToClassic=8]="ConvertCloudyToClassic",e[e.ImportCalendarEventAttachment=9]="ImportCalendarEventAttachment",e[e.MoveAttachmentToInline=10]="MoveAttachmentToInline",e[e.RefreshLink=11]="RefreshLink",e[e.IgnoreExpiration=12]="IgnoreExpiration"}(r||(r={})),t.a=r},12233:function(e){e.exports=JSON.parse('{"a":"red"}')},1232:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),o=n(1017),a=Object(r.action)("APPLY_DEFAULT_OPTIONS_ON_LOAD_FAIL",(function(e){return void 0===e&&(e=Object(o.a)()),{defaultOptions:e}}))},1235:function(e,t,n){"use strict";n.d(t,"n",(function(){return c})),n.d(t,"q",(function(){return u})),n.d(t,"r",(function(){return s})),n.d(t,"a",(function(){return d})),n.d(t,"p",(function(){return l})),n.d(t,"f",(function(){return f})),n.d(t,"u",(function(){return b})),n.d(t,"g",(function(){return m})),n.d(t,"d",(function(){return v})),n.d(t,"e",(function(){return O})),n.d(t,"j",(function(){return p})),n.d(t,"i",(function(){return g})),n.d(t,"l",(function(){return I})),n.d(t,"k",(function(){return j})),n.d(t,"c",(function(){return h})),n.d(t,"o",(function(){return w})),n.d(t,"s",(function(){return S})),n.d(t,"b",(function(){return C})),n.d(t,"m",(function(){return P})),n.d(t,"h",(function(){return A})),n.d(t,"t",(function(){return E}));var r=n(108),o=n(1387);n.d(t,"v",(function(){return o.a}));var a=n(1388);n.d(t,"w",(function(){return a.a}));n(1051),n(1074);var i=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(139)]).then(n.bind(null,2632))})),c=new r.a(i,(function(e){return e.initializeAttachments})),u=new r.a(i,(function(e){return e.reinitializeAttachments})),s=new r.a(i,(function(e){return e.setInlineAttachmentStatus})),d=new r.a(i,(function(e){return e.addAttachmentIntoWellBeforeUpload})),l=new r.b(i,(function(e){return e.refreshSharingTipsAttachmentWell})),f=new r.b(i,(function(e){return e.createAttachmentsViaQueueManager})),b=new r.b(i,(function(e){return e.createAttachmentsFromRecentAttachments})),m=new r.a(i,(function(e){return e.deleteAttachmentViaQueueManager})),v=new r.b(i,(function(e){return e.createAttachmentFullViewStateAndStoreBackingModel})),O=new r.b(i,(function(e){return e.createAttachmentFullViewState})),p=new r.b(i,(function(e){return e.getAttachmentWellInitialValue})),g=new r.b(i,(function(e){return e.getAttachmentWellForCompose})),I=new r.b(i,(function(e){return e.getConversationAttachmentWellInitialValue})),j=(new r.b(i,(function(e){return e.getMaxClassicAttachmentsSize})),new r.b(i,(function(e){return e.getAvailableLocalAttachmentSize}))),h=new r.b(i,(function(e){return e.createAttachmentFileFromExistingMailboxAttachment})),w=new r.a(i,(function(e){return e.mergeToConversationAttachmentWell})),S=new r.a(i,(function(e){return e.sortConversationAttachmentWell})),C=new r.a(i,(function(e){return e.convertImageViewAttachmentToInlineAttachment})),P=new r.b(i,(function(e){return e.getLastCloudyAttachmentsSharingIssueForBlockOnSend})),A=new r.b(i,(function(e){return e.getAllValidAttachments})),E=new r.b(i,(function(e){return e.uploadLocalFile}))},1268:function(e,t,n){"use strict";function r(e){var t=e.AttachmentPolicy;return t.ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||t.ConditionalAccessDirectFileAccessOnPublicComputersBlocked?t.ConditionalAccessWacViewingOnPrivateComputersBlocked||t.ConditionalAccessWacViewingOnPublicComputersBlocked?[1]:[0]:[]}n.d(t,"a",(function(){return r}))},1269:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(314);function o(e){switch(e){case 0:return"ReadOnlyAccess";case 1:return"ReadOnlyPlusAttachmentsBlockedAccess";case 2:return null;default:return Object(r.a)(e)}}},1371:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"f",(function(){return i})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"h",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"e",(function(){return l})),n.d(t,"g",(function(){return f}));var r=n(254),o="WebPushSetup";function a(e){m("mailOption",e)}function i(e){m("reminderOption",e)}function c(e){m("enabled",e)}function u(e,t){m("disabled",e),m("allClients",t)}function s(e){(window.webPushOptics.enabled||window.webPushOptics.disabled)&&(m("result",e),b())}function d(){m("lightning","ignored"),b()}function l(e){m("permission",e)}function f(e){m("roaming",e)}function b(){Object(r.o)(o,window.webPushOptics,{isCore:!0}),window.webPushOptics={}}function m(e,t){window.webPushOptics[e]=t}window.webPushOptics={}},1387:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("ON_ATTACHMENT_CREATED",(function(e,t,n){return{parentItemId:e,attachmentId:t,attachment:n}}))},1388:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("ON_ATTACHMENT_DELETED",(function(e,t,n){return{parentItemId:e,attachmentId:t,attachment:n}}))},1401:function(e,t,n){"use strict";var r=n(0),o=n(1938),a=n(283),i=Object(a.action)("addInfoBarMessage")((function(e,t,n){if(e){-1==e.infoBarIds.indexOf(t)?e.infoBarIds.push(t):e.infoBarIds=Object(r.__spread)(e.infoBarIds);var a=e.infoBarHostKey;n&&(o.b[a]||(o.b[a]={}),o.b[a][t]=n)}}));t.a=i},1446:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n(1720),o=n(1268),a=n(27),i=n(1269);function c(){var e=Object(a.a)();return Object(o.a)(e)}function u(e){var t=Object(a.a)();return(e&&e.length>0&&function(e){return e.some((function(e){return!((t=e).IsInline&&!function(e){return e.__type===r.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE}(t));var t}))}(e)?Object(o.a)(t):[]).map(i.a)}},1489:function(e,t,n){"use strict";var r=n(108),o=[0,1],a=n(1891),i=n(1861),c=n(9),u=n(314),s=n(1066);function d(e){switch(e){case"ReadOnlyPlusAttachmentsBlockedAccess":return{key:"access_control_info_bar",source:s.c.Compose,rank:s.b.Error,message:Object(c.b)(i.a),messageParts:[Object(c.b)(i.a),l()],color:s.a.Red};case"ReadOnlyAccess":return{key:"access_control_info_bar_check",source:s.c.Compose,rank:s.b.Error,message:Object(c.b)(a.b),messageParts:[Object(c.b)(a.b),l()],color:s.a.Red};default:return Object(u.a)(e)}}function l(){return{text:Object(c.b)(a.a),action:function(){window.open("https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done","_blank")}}}var f=n(1446),b=n(1269),m=(n(1268),n(0)),v=n(76),O=n(27);function p(){var e=Object(O.a)();if(Object(v.h)("fwk-devTools")){if(Object(v.h)("doc-attachment-CA-readOnlyAccessIssues"))return Object(m.__assign)(Object(m.__assign)({},e),{AttachmentPolicy:Object(m.__assign)(Object(m.__assign)({},e.AttachmentPolicy),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!0,WacViewingOnPublicComputersEnabled:!0})});if(Object(v.h)("doc-attachment-CA-readOnlyPlusAttachmentsBlocked"))return Object(m.__assign)(Object(m.__assign)({},e),{AttachmentPolicy:Object(m.__assign)(Object(m.__assign)({},e.AttachmentPolicy),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!1,WacViewingOnPublicComputersEnabled:!1})})}return e}function g(){var e=p().AttachmentPolicy;return e.DirectFileAccessOnPrivateComputersEnabled&&e.DirectFileAccessOnPublicComputersEnabled?2:e.WacViewingOnPrivateComputersEnabled&&e.WacViewingOnPublicComputersEnabled?0:1}n.d(t,"g",(function(){return j})),n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return d})),n.d(t,"b",(function(){return f.a})),n.d(t,"d",(function(){return b.a})),n.d(t,"c",(function(){return g})),n.d(t,"f",(function(){return p}));var I=new r.c((function(){return n.e(1178).then(n.bind(null,14862))})),j=new r.b(I,(function(e){return e.getAccessIssuesForAttachments}))},15010:function(e,t,n){"use strict";n.r(t);var r=n(950),o=n(3117),a=n(947);function i(e){return Object(a.P)(Object(r.a)("inbox"))}var c=n(990);function u(e){var t=Object(r.a)("inbox");return Object(a.P)(t)&&!Object(c.isPersonaInFavorites)(null,e.SenderSmtpEmailAddress)}var s=n(556),d=n(9),l=n(12233);var f=n(9877),b=n(2408),m=n(76),v=n(1403),O=n(4),p=n(9174);Object(O.orchestrator)(p.a,(function(){v.f.importAndExecute("mail","attachments")}));var g=n(9172);Object(O.orchestrator)(g.a,(function(){v.f.importAndExecute("general","timeAndLanguage")}));var I=n(2441),j=n(9173),h=n(9177),w=n(3645);Object(O.orchestrator)(j.a,(function(e){I.c.importAndExecute("GetStarted",void 0,void 0,e.taskSendEmailSubject,e.taskSendEmailBody)})),Object(O.orchestrator)(w.a,(function(e){1==e.event&&Object(h.a)()}));var S=n(9175),C=n(9178),P=n(108),A=new P.c((function(){return Promise.all([n.e(63),n.e(455)]).then(n.bind(null,15161))})),E=new P.a(A,(function(e){return e.showPersonalizationCard}));Object(O.orchestrator)(S.a,(function(){E.importAndExecute(C.a)}));var R=n(6642),x=n(4757),y=new P.c((function(){return n.e(126).then(n.bind(null,15357))})),M=new P.a(y,(function(e){return e.loadSenders})),N=n(10013),T=n(2373),_=n(1775),k=n(431),L=n(1616),D=n(964),V=n(1766),U=n(246);function F(){var e=Object(_.a)({FolderShape:Object(L.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(D.a)({FieldURI:"TotalCount"}),Object(D.a)({FieldURI:"UnreadCount"})]}),Paging:null,ParentFolderIds:[Object(k.a)({Id:Object(r.a)("msgfolderroot")})],ReturnParentFolder:!0,ShapeName:null,Traversal:"Deep"});return Object(V.a)({Header:Object(U.a)(),Body:e}).then((function(e){var t,n,r;return null===(r=null===(n=null===(t=null==e?void 0:e.Body)||void 0===t?void 0:t.ResponseMessages)||void 0===n?void 0:n.Items)||void 0===r?void 0:r[0]}))}var B=n(2699),W=n(1062),K=n(79),z=n(1582),q=n(2635);function H(e){switch(e.EventType){case"Reload":case"QueryResultChanged":F().then((function(e){"Success"==(null==e?void 0:e.ResponseClass)?e.RootFolder.Folders.forEach((function(e){Object(B.a)(e.UnreadCount,e.TotalCount,e.FolderId.Id,!1)})):K.g.warn(G+"ResponseNotSuccess")})).catch((function(e){K.g.warn(G+":"+e.message)}));break;case"RowAdded":case"RowModified":var t=e;Object(B.a)(t.unreadCount,t.itemCount,t.folderId,!1),"RowAdded"===e.EventType&&q.f.importAndExecute(t.folderId,t.parentFolderId,t.displayName),z.h.import().then((function(t){t(e)}));break;default:return}}var G="UpdateFolderCountsAction:";var Y=new P.c((function(){return n.e(286).then(n.bind(null,15292))}));Object(P.f)(T.a,Y,(function(e){return e.getFolderDataOrchestrator}));var J=n(24),Q=n(965),Z=n(2244);function X(e,t){var n=function(e){var t={},n=Q.a.conversationNodes.get(e);for(;n;){if(t[n.internetMessageId]){K.d("Invalid loop found in ParentInternetMessageId pointers");break}if(Object(Z.b)(n.internetMessageId)&&(t[n.internetMessageId]=!0),Object(d.f)(n.parentInternetMessageId))break;n=Q.a.conversationNodes.get(n.parentInternetMessageId)}return t}(e);if(1===Object.keys(n).length)return function(e,t){var n=new J.ObservableMap({});return t.forEach((function(t){var r=Q.a.conversationNodes.get(t),o=t===e?a.a.CheckMark:a.a.None;n.set(r.internetMessageId,o)})),n}(e,t);for(var r=new J.ObservableMap({}),o=!1,i=!1,c=0,u=0;u<t.length;u++){var s=Q.a.conversationNodes.get(t[u]);s&&(n[s.internetMessageId]?(o?c+1===Object.keys(n).length?(r.set(s.internetMessageId,a.a.BusEnd),i=!0):r.set(s.internetMessageId,a.a.BusStop):(r.set(s.internetMessageId,a.a.BusStart),o=!0),c++):!o||i?r.set(s.internetMessageId,a.a.None):r.set(s.internetMessageId,a.a.NoStop))}return r}var $=n(1186),ee=Object(O.action)("FOCUS_ITEM_PART",(function(e,t){return{nodeId:e,mailListItemSelectionSource:t}})),te=n(971),ne=n(7890),re=n(963);function oe(){var e=te.a.expandedConversationViewState;e.expandedRowKey=null,e.focusedNodeId=null,e.selectedNodeIds=[],e.allNodeIds=[],e.shouldBeExpanded=!1,e.busStopStateMap=new J.ObservableMap({})}Object(O.mutator)($.t,(function(e){var t=e.nodeId,n=te.a.expandedConversationViewState,r=n.selectedNodeIds,o=n.allNodeIds;te.a.expandedConversationViewState.focusedNodeId=t,r.indexOf(t)>-1?r.splice(r.indexOf(t),1):r.push(t),1===r.length&&(te.a.expandedConversationViewState.busStopStateMap=X(r[0],o))})),Object(O.mutator)($.h,(function(e){te.a.expandedConversationViewState.busStopStateMap=new J.ObservableMap({})})),Object(O.mutator)(ee,(function(e){te.a.expandedConversationViewState.focusedNodeId=e.nodeId})),Object(O.mutator)($.q,(function(e){var t=e.rowKey,n=e.nodeIdToSelect,r=e.allNodeIds,o=te.a.expandedConversationViewState;o.selectedNodeIds=[n],o.busStopStateMap=X(n,r),o.expandedRowKey=t,o.focusedNodeId=n,o.allNodeIds=r})),Object(O.mutator)($.u,(function(e){e.mailListItemSelectionSource===re.b.MailListItemCheckbox&&oe()})),Object(O.mutator)($.p,(function(e){oe()})),Object(O.mutator)($.i,(function(e){oe()})),Object(O.mutator)($.k,(function(e){oe()})),Object(O.mutator)($.r,(function(e){var t=te.a.expandedConversationViewState;e.mailListItemSelectionSource==re.b.MailListItemTwisty&&t.expandedRowKey!=e.rowKey&&(t.expandedRowKey=e.rowKey,t.shouldBeExpanded=!0)})),Object(O.mutator)($.o,(function(e){te.a.expandedConversationViewState.shouldBeExpanded=e.shouldBeExpanded})),Object(O.mutator)(ne.a,(function(e){if(1===te.a.expandedConversationViewState.selectedNodeIds.length){var t=te.a.expandedConversationViewState.selectedNodeIds[0],n=re.w.conversations.get(e.conversationId).conversationNodeIds;te.a.expandedConversationViewState.busStopStateMap=X(t,n)}}));var ae,ie=n(0),ce=n(8335),ue=n(2637),se=n(1685),de=n(1068),le=n(6243);Object(O.orchestrator)($.b,(function(e){me(e.itemId,e.tableView,e.nodeId,e.allNodeIds,e.mailListItemSelectionSource)}));Object(O.orchestrator)($.e,(function(e){if(e.mailListItemSelectionSource==re.b.MailListItemTwisty){if(1==e.listViewType)throw new Error("Toggle expansion action cannot be called from message view");var t,n;Object(ce.a)(e.rowKey)?Oe():(t=e.rowKey,n=e.tableView,$.o(!1),Object(le.a)(n,!1),ve(t,n))}})),Object(O.orchestrator)($.c,(function(e){Object(ce.a)(e.rowKey)&&Oe()})),Object(O.orchestrator)($.m,(function(e){for(var t=a.b.getConversationId(e.rowKey,e.tableView),n=re.w.conversations.get(t),r=null,o=null,i=n.conversationNodeIds.indexOf(a.T.expandedConversationViewState.selectedNodeIds[0])+1;i<n.conversationNodeIds.length;i++){var c=n.conversationNodeIds[i],u=Object(Z.b)(c);if(u){o=u.ItemId.Id,r=c;break}}r?me(o,e.tableView,r,n.conversationNodeIds,re.b.RowRemoval):ve(e.rowKey,e.tableView)}));var fe=0,be=!0;function me(e,t,n,r,o){if(ae&&(clearTimeout(ae),ae=null),Object(ue.d)(t,!0,o,void 0),o!==re.b.KeyboardUpDown||Object(de.c)()){var i=a.b.getRowClientItemId(a.T.expandedConversationViewState.expandedRowKey,t);se.r.importAndExecute(null==i?void 0:i.Id,e,!0)}else{var c=Date.now(),u=c-fe;fe=c,(be||u<=500)&&(be=!1,ae=setTimeout((function(){ae=null,be=!0;var n=a.b.getRowClientItemId(a.T.expandedConversationViewState.expandedRowKey,t);se.r.importAndExecute(null==n?void 0:n.Id,e,!0)}),250))}$.q(a.T.expandedConversationViewState.expandedRowKey,n,r,t.id)}function ve(e,t){var n,r,o=a.b.getConversationId(e,t),i=re.w.conversations.get(o);try{for(var c=Object(ie.__values)(i.conversationNodeIds),u=c.next();!u.done;u=c.next()){var s=u.value,d=Object(Z.b)(s);if(d){me(d.ItemId.Id,t,s,i.conversationNodeIds,re.b.RowRemoval);break}}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}}function Oe(){$.i()}var pe=n(7237),ge=n(7296),Ie=(Object(O.orchestrator)(ge.a,(function(e){Object(pe.a)(),1===Object(a.F)().expandedConversationViewState.selectedNodeIds.length&&$.h()})),n(9025)),je=n(1368),he=(Object(O.orchestrator)(Ie.a,(function(e){if(a.T.expandedConversationViewState.expandedRowKey){var t=re.w.conversations.get(e.conversationId);$.q(a.T.expandedConversationViewState.expandedRowKey,e.conversationNodeId,t.conversationNodeIds,Object(je.a)())}})),n(7951)),we=n(4932),Se=n(6363),Ce=n(1997),Pe=Object(O.action)("FOCUS_ROW_IN_DIRECTION",(function(e,t,n){return{tableView:e,selectionDirection:t,mailListItemSelectionSource:n}}));function Ae(e,t,n){return Object(Ce.a)()?1===e&&n===a.d.Next||0===e&&n===a.d.Previous:e===t-1&&n===a.d.Next||e===t-2&&n===a.d.Previous}Object(O.orchestrator)(he.a,(function(e){var t=e.selectionDirection,n=e.tableView,r=e.mailListItemSelectionSource,o=e.shouldSelect,i=Object(ie.__read)(function(e,t){var n=a.T.expandedConversationViewState,r=n.focusedNodeId,o=n.allNodeIds;if(!r)return[null,null];var i,c,u=o.indexOf(r);e===a.d.Next?(i=o.length-1,c=1):(i=0,c=-1);var s=Object(a.G)(t.focusedRowKey,t.id).id,d=a.T.conversationItems.get(s);for(;u!==i;){if(u+=c,Object(we.a)(d.id)&&Ae(u,o.length,e))return Object(Se.a)(d.clientId),["loading",null];var l=o[u],f=Object(Z.b)(l);if(f)return[l,f]}return[null,null]}(t,n),2),c=i[0],u=i[1];"loading"!==c&&(c?o?$.b(c,u.ItemId.Id,a.T.expandedConversationViewState.allNodeIds,n,r):ee(c,r):a.T.expandedConversationViewState.expandedRowKey&&t===a.d.Previous?$.c(a.T.expandedConversationViewState.expandedRowKey):o?$.n(n,t,r):Pe(n,t,r))}));var Ee=n(9995),Re=n(5566),xe=n(5186),ye=n(5185),Me=(Object(O.orchestrator)(Pe,(function(e){var t=e.tableView,n=e.selectionDirection,r=Object(Ee.a)(t,n);if(null!==r){var o=t.rowKeys[r];Object(Re.a)(t,o),Object(ye.a)(t,o),Object(xe.a)(t,null),$.i()}})),n(7952));Object(O.orchestrator)(Me.a,(function(e){var t=e.tableView,n=e.mailListItemSelectionSource,r=a.T.expandedConversationViewState.focusedNodeId;r?$.t(r):$.u(t,t.focusedRowKey,!0,n)}));var Ne=n(1386),Te=n(7953);Object(O.orchestrator)(Te.a,(function(e){var t=e.tableView,n=e.selectedNodeIds,r=e.selectedRowKeys,o=e.mailListItemSelectionSource;if(n.length>0&&o===Ne.a.KeyboardEnter){if(1!==n.length)return;$.b(n[0],Object(Z.b)(n[0]).ItemId.Id,a.T.expandedConversationViewState.allNodeIds,t,o)}else{if(1!==r.length)return;$.r(t,r[0],!0,o)}}));var _e=n(9935),ke=n(25);var Le=n(295),De=n(2761),Ve=n(4770),Ue=n(2401),Fe=n(4176),Be=n(6578),We=n(3047),Ke=n(2476),ze=n(2035),qe=n(3905),He=n(6187),Ge=new P.c((function(){return n.e(451).then(n.bind(null,15057))})),Ye=new P.a(Ge,(function(e){return e.evaluatePlaywrightMailActions})),Je=n(27);function Qe(){var e;Object(Je.a)().IsMonitoring&&Ye.importAndExecute(),Object(f.a)(!0),Object(m.h)("fwk-mailtoProtocolHandler")&&(null===(e=null===window||void 0===window?void 0:window.navigator)||void 0===e?void 0:e.registerProtocolHandler)&&window.navigator.registerProtocolHandler("mailto",""+Object(s.m)()+Object(s.k)()+"deeplink/compose?mailtouri=%s",Object(d.b)(l.a)),Object(m.h)("tri-triagePattern")&&Object(_e.b)(),ze.b.importAndExecute({condition:Object(m.h)("fwk-devTools")||Object(m.h)("sea-contextFeedback"),task:function(){return N.b.importAndExecute()}},Ze,{condition:Object(De.a)(),task:function(){return De.e.importAndExecute()}},(function(){return Fe.a.importAndExecute()}),{condition:Object(Le.a)(),task:function(){return M.importAndExecute()}},(function(){return Be.b.importAndExecute()}),(function(){return Be.a.importAndExecute()}),{condition:Object(We.j)(),task:function(){return We.d.importAndExecute()}},(function(){return We.e.importAndExecute()}),{task:function(){return R.c.importAndExecute()},idle:!0},{condition:Object(m.h)("mc-personalization"),task:function(){Ve.b.importAndExecute()},idle:!0},{task:function(){return Ue.c.importAndExecute()},idle:!0},{condition:Object(se.f)(),task:function(){return x.a.importAndExecute()},idle:!0},{task:function(){return b.d.importAndExecute()},idle:!0},{condition:Object(Ke.e)(window),task:function(){return Ke.j.importAndExecute(window)},idle:!0},{condition:Object(m.h)("tri-mailboxCleanup"),task:function(){return qe.a.importAndExecute()},idle:!0},{condition:Object(c.isNewsEnabled)(),task:function(){return He.e.importAndExecute()}},{condition:Object(m.h)("auth-activityFeed")&&Object(m.h)("auth-activityFeedWeveSignal"),task:function(){return b.e.importAndExecute()},idle:!0}).then((function(){ze.a.importAndExecute()}))}function Ze(){var e,t;W.f.importAndExecute({subscriptionId:"HierarchyNotification",requiresExplicitSubscribe:!0,subscriptionParameters:{NotificationType:"HierarchyNotification"}},H),Object(o.g)(u),Object(o.f)(i),e={isOWALogon:!0},Object(ke.a)("ConnectedAccountsNotification",e,t)}var Xe=n(1112),$e=n(1727);Object(O.orchestrator)(o.c,(function(e){return Object(ie.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r,o,i,c;return Object(ie.__generator)(this,(function(u){switch(u.label){case 0:return t=e.notification,Object(a.L)(Object(a.C)())?(n=Object(re.i)().conversations.get(t.conversationId),r={Id:t.conversationId,mailboxInfo:Object(Xe.a)()},n?[3,2]:[4,$e.d.importAndExecute(r,"LoadLikedConversation")]):[3,3];case 1:u.sent(),u.label=2;case 2:return et(r,t.subject),[3,6];case 3:return o=Object(re.i)().items.get(t.itemId),i={Id:t.itemId,mailboxInfo:Object(Xe.a)()},(null==o?void 0:o.NormalizedBody)?(et(i,t.subject),[3,6]):[3,4];case 4:return c={Id:t.itemId,mailboxInfo:Object(Xe.a)()},[4,$e.e.importAndExecute(c,"LoadLikedItem")];case 5:u.sent(),et(c,t.subject),u.label=6;case 6:return[2]}}))}))}));function et(e,t){se.o.importAndExecute(e,t,[],!0,null)}var tt=n(9194),nt=n(103);Object(O.orchestrator)(o.d,(function(e){var t=e.notification,n=1===Object(nt.i)().UserOptions.GlobalListViewTypeReact?t.ItemId:t.ConversationId;Object(tt.a)("inbox",n)}));n.d(t,"setupMailModulePostRender",(function(){return Qe}))},1576:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return c}));var r,o=n(4),a=Object(o.createStore)("webPushStore",{currentView:0,webPushPermission:null===(r=window.Notification)||void 0===r?void 0:r.permission})(),i=Object(o.createStore)("localWebPushUserSettingStore",{userPreferenceIdentifier:null,lastSessionDate:null,uniqueDaysSessionCount:0,enabled:null,mailEnabled:null,reminderEnabled:null,lastCheckboxUnchecked:null,promptCount:0,lastPromptDate:null})();function c(){return i}},1640:function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return d}));var r=n(1576),o=n(2309),a=n(283),i=n(1649),c=Object(a.select)({store:function(){return r.b}})((function(e){return null!=e.store&&null==e.store.enabled&&e.store.uniqueDaysSessionCount>=i.b&&e.store.lastPromptDate!=Object(o.a)().toDateString()&&e.store.promptCount<=i.a})),u=Object(a.select)({store:function(){return r.b}})((function(e){return e.store.mailEnabled||e.store.reminderEnabled})),s=Object(a.select)({store:function(){return r.b}})((function(e){return{newMail:e.store.mailEnabled,reminder:e.store.reminderEnabled}})),d=Object(a.select)({store:function(){return r.b}})((function(e){return e.store.reminderEnabled&&e.store.enabled}))},1648:function(e,t,n){"use strict";var r=n(1260),o=n(1319),a=n(4),i=Object(a.action)("EDIT_GROUP_SUCCESS",(function(e,t){return{groupSmtp:e,photoUrl:t}})),c=Object(a.action)("ADD_GROUP_MEMBER_SUCCESS",(function(e){return{groupSmtp:e}})),u=Object(a.action)("POPUP_OPENED",(function(){return{isOpen:!0}})),s=Object(a.action)("POPUP_CLOSED",(function(){return{isOpen:!1}})),d=Object(a.action)("DELETE_GROUP_SUCCESS",(function(e){return{groupSmtp:e}})),l=n(1424);n.d(t,"n",(function(){return r.a})),n.d(t,"m",(function(){return o.a})),n.d(t,"l",(function(){return i})),n.d(t,"j",(function(){return c})),n.d(t,"p",(function(){return u})),n.d(t,"o",(function(){return s})),n.d(t,"k",(function(){return d})),n.d(t,"g",(function(){return l.g})),n.d(t,"c",(function(){return l.c})),n.d(t,"d",(function(){return l.d})),n.d(t,"a",(function(){return l.a})),n.d(t,"e",(function(){return l.e})),n.d(t,"f",(function(){return l.f})),n.d(t,"i",(function(){return l.i})),n.d(t,"b",(function(){return l.b})),n.d(t,"h",(function(){return l.h}))},1649:function(e,t,n){"use strict";var r=n(1576),o=n(2309),a=n(283),i=n(8),c="WebPushUserSettings",u=5;function s(e,t){for(var n=d(e),r=-1,o=0;o<n.length;++o)if(n[o].userPreferenceIdentifier==t.userPreferenceIdentifier){r=o;break}if(r>=0)n[r]=t;else{if(r=n.length,n.length>=u){r=0;var a=new Date(n[0].lastSessionDate);for(o=1;o<n.length;++o){var s=new Date(n[o].lastSessionDate);s.getTime()<a.getTime()&&(a=s,r=o)}}n[r]=t}!function(e,t){if(t.length>0){var n=JSON.stringify(t);Object(i.d)(e,c,n)}else Object(i.c)(e,c)}(e,n)}function d(e){var t=Object(i.a)(e,c),n=new Array;try{var r=JSON.parse(t);null!=r&&(n=r)}catch(t){Object(i.c)(e,c)}return n}var l=n(1640),f=n(76);n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return m})),n.d(t,"e",(function(){return v})),n.d(t,"d",(function(){return O})),n.d(t,"g",(function(){return p})),n.d(t,"h",(function(){return g})),n.d(t,"c",(function(){return I})),n.d(t,"f",(function(){return j})),n.d(t,"i",(function(){return h}));var b=4,m=3,v=Object(a.select)({store:function(){return r.b}})(Object(a.action)("loadLocalWebPushUserSetting")((function(e,t,n){var r=function(e,t){for(var n=d(e),r=null,o=0;o<n.length;++o)if(n[o].userPreferenceIdentifier==t){r=n[o];break}return r}(e,t);if(null!=r)Object.keys(r).forEach((function(e){n.store[e]=r[e]})),h(e);else{var o=function(e,t){for(var n=d(e),r=null,o=0;o<n.length;++o)n[o].userPreferenceIdentifier<t&&(r?n[o].userPreferenceIdentifier>r.userPreferenceIdentifier&&(r=n[o]):r=n[o]);return r}(e,t);o&&(n.store.lastCheckboxUnchecked=o.lastCheckboxUnchecked,n.store.mailEnabled=o.mailEnabled,n.store.reminderEnabled=o.reminderEnabled),n.store.userPreferenceIdentifier=t,s(e,n.store)}}))),O=Object(a.select)({store:function(){return r.b}})(Object(a.action)("incrementUniqueDaysSessionCount")((function(e,t){var n=Object(o.a)().toDateString();t.store.lastSessionDate!=n&&(t.store.lastSessionDate=n,t.store.uniqueDaysSessionCount<b&&t.store.uniqueDaysSessionCount++,s(e,t.store))}))),p=Object(a.select)({store:function(){return r.b}})(Object(a.action)("resetLocalWebpushUserSetting")((function(e,t,n){n.store.userPreferenceIdentifier=t,n.store.enabled=!1,n.store.promptCount=0,n.store.lastPromptDate=null,n.store.uniqueDaysSessionCount=0,s(e,n.store)}))),g=Object(a.select)({store:function(){return r.b}})(Object(a.action)("updateLocalWebPushEnabledStatus")((function(e,t,n,r){r.store.enabled=t,r.store.userPreferenceIdentifier=n,t&&h(e),s(e,r.store)}))),I=Object(a.select)({store:function(){return r.b}})(Object(a.action)("incrementLocalWebPushPromptCount")((function(e,t){t.store.promptCount++,t.store.lastPromptDate=Object(o.a)().toDateString(),s(e,t.store)}))),j=Object(a.select)({store:function(){return r.b}})(Object(a.action)("resetLocalWebPushPromptCount")((function(e,t){t.store.promptCount=0,t.store.lastPromptDate=null,s(e,t.store)}))),h=Object(a.select)({store:function(){return r.b}})(Object(a.action)("validateAndUpdateCheckboxOptions")((function(e,t){if(t.store.enabled&&!Object(l.b)())if(t.store.lastCheckboxUnchecked){switch(t.store.lastCheckboxUnchecked){case"NewMail":t.store.mailEnabled=!0;break;case"Reminder":t.store.reminderEnabled=!0}t.store.lastCheckboxUnchecked=null}else t.store.mailEnabled=!0,t.store.reminderEnabled=!0;Object(f.h)("auth-scheduleTimerForReminderWebPush")||Object(f.h)("auth-sendReminderWebPush")||(t.store.reminderEnabled=!1,t.store.lastCheckboxUnchecked=null),s(e,t.store)})))},1720:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={attachmentTypes:{FILE_ATTACHMENT_TYPE:"FileAttachment:#Exchange",ITEM_ATTACHMENT_TYPE:"ItemAttachment:#Exchange",ITEM_ID_ATTACHMENT_TYPE:"ItemIdAttachment:#Exchange",REFERENCE_ATTACHMENT_TYPE:"ReferenceAttachment:#Exchange"}}},1778:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("saveSigningCertificate",(function(e,t){return{smimeViewState:e,signingCertRawData:t}}))},1833:function(e,t,n){"use strict";n.d(t,"m",(function(){return a})),n.d(t,"l",(function(){return i})),n.d(t,"o",(function(){return c})),n.d(t,"q",(function(){return u})),n.d(t,"p",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"e",(function(){return l})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return b})),n.d(t,"k",(function(){return m})),n.d(t,"n",(function(){return v})),n.d(t,"r",(function(){return O})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return g})),n.d(t,"j",(function(){return I})),n.d(t,"f",(function(){return j})),n.d(t,"i",(function(){return h})),n.d(t,"a",(function(){return w}));var r=n(108),o=(n(1778),new r.c((function(){return Promise.all([n.e(12),n.e(748),n.e(4),n.e(17),n.e(673)]).then(n.bind(null,3541))}))),a=new r.a(o,(function(e){return e.onSmimeItemAttachmentOpened})),i=new r.a(o,(function(e){return e.mergeSmimeDecodedMessageProperties})),c=(new r.b(o,(function(e){return e.fetchAndDecodeSmimeMessage})),new r.b(o,(function(e){return e.setSmimePropertiesInDraftMessage}))),u=new r.b(o,(function(e){return e.trySetSmimeProperties})),s=new r.b(o,(function(e){return e.tryAddSmimeProperties})),d=new r.b(o,(function(e){return e.createMailResponseBodyContent})),l=new r.b(o,(function(e){return e.downloadSmimeAttachment})),f=new r.b(o,(function(e){return e.getMergedSmimeViewState})),b=new r.b(o,(function(e){return e.getMergedSmimeViewStateForDraft})),m=new r.b(o,(function(e){return e.isSmimeItemDecoding})),v=new r.b(o,(function(e){return e.previewSmimeAttachment})),O=new r.b(o,(function(e){return e.updateSmimeAttachmentIds})),p=new r.b(o,(function(e){return e.createSmimeAttachmentsFromFiles})),g=new r.b(o,(function(e){return e.createSmimeAttachmentsViaSmimeQueueManager})),I=new r.b(o,(function(e){return e.initializeAttachmentStateForSmimeAttachments})),j=new r.b(o,(function(e){return e.getAttachmentsForSmimeResponse})),h=new r.b(o,(function(e){return e.getSmimeAttachmentsForRequest})),w=Object(r.d)(o,(function(e){return e.SignatureDetails}))},1861:function(e){e.exports=JSON.parse('{"a":"sha"}')},1891:function(e){e.exports=JSON.parse('{"a":"qha","b":"rha"}')},1921:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(4),o=Object(r.action)("USERMAIL_INTERACTION",(function(e,t,n){return{interactionType:e,instrumentationContexts:t,triageContext:n}}))},1938:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var r={};function o(e,t){var n,o=e.infoBarHostKey;return null===(n=r[o])||void 0===n?void 0:n[t]}},1967:function(e,t,n){"use strict";n.d(t,"b",(function(){return i}));var r=n(4),o=n(2269),a={installationStatus:0,isBrowserSupportActiveX:Object(o.a)(),version:""},i=Object(r.createStore)("SmimeStore",a),c=i();t.a=c},1997:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(27);function o(){var e=Object(r.a)();return"ChronologicalNewestOnBottom"==(e.UserOptions?e.UserOptions.ConversationSortOrderReact:"ChronologicalNewestOnBottom")}},2072:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return u}));var r=n(108),o=n(1921);n.d(t,"d",(function(){return o.a}));var a=new r.c((function(){return n.e(371).then(n.bind(null,4106))})),i=new r.a(a,(function(e){return e.onKeyboardUpDown})),c=new r.a(a,(function(e){return e.onOpenEmail})),u=new r.a(a,(function(e){return e.onKeyboardToggleSelect}))},2107:function(e,t,n){"use strict";n.d(t,"n",(function(){return s})),n.d(t,"m",(function(){return d})),n.d(t,"j",(function(){return l})),n.d(t,"i",(function(){return f})),n.d(t,"k",(function(){return b})),n.d(t,"f",(function(){return m})),n.d(t,"a",(function(){return v})),n.d(t,"c",(function(){return O})),n.d(t,"g",(function(){return p})),n.d(t,"d",(function(){return g})),n.d(t,"h",(function(){return I})),n.d(t,"e",(function(){return h})),n.d(t,"l",(function(){return w})),n.d(t,"b",(function(){return S}));var r=n(2602),o=n(2269),a=n(49),i=n(1275),c=n(1575),u=n(27);function s(){return Object(a.e)()||Object(a.f)()}function d(e){return function(e){if(e.length<2)return!1;var t=e[0]-parseInt(i.b),n=e[1]-parseInt(i.c);return 0==t&&n>=0}("string"==typeof e?e.split(".").map((function(e){return parseInt(e)})):[])}function l(e){var t="string"==typeof e?e.split("."):[];return t.length&&t[0]!=i.b}function f(){return Object(a.p)()&&(Object(a.i)()&&Object(a.b)()[0]==i.i&&Object(o.a)()||Object(r.a)())}function b(e){return 0!==e}function m(e){var t=[];t.push(e.UserEmailAddress),t.push(e.LogonEmailAddress),t.push(e.UserPrincipalName),t.push(e.UserLegacyExchangeDN);var n=e.UserProxyAddresses;return n&&n.length>0&&n.forEach((function(e){t.indexOf(e)>=0||t.push(e)})),t}function v(e){var t=65001;return e.UseGB18030?t=54936:e.UseISO885915&&(t=28605),t}function O(e){return{AllowUserChoiceOfSigningCertificate:e.AllowUserChoiceOfSigningCertificate,IncludeCertificateChainWithoutRootCertificate:e.IncludeCertificateChainWithoutRootCertificate,IncludeCertificateChainAndRootCertificate:e.IncludeCertificateChainAndRootCertificate,EncryptTemporaryBuffers:e.EncryptTemporaryBuffers,SignedEmailCertificateInclusion:e.SignedEmailCertificateInclusion,IncludeSmimeCapabilitiesInMessage:e.IncludeSMIMECapabilitiesInMessage,CopyRecipientHeaders:e.CopyRecipientHeaders,OnlyUseSmartCard:e.OnlyUseSmartCard,EncryptionAlgorithms:e.EncryptionAlgorithms,SigningAlgorithms:e.SigningAlgorithms}}function p(e,t){var n=Object(u.a)().SmimeAdminSettings.ClearSign;return t||e&&!n?c.a:i.e}function g(e){return btoa(unescape(encodeURIComponent(e)))}function I(e,t){var n=Object(u.a)().SmimeAdminSettings;return e&&t?n.TripleWrapSignedEncryptedMail?14:12:e?n.ClearSign?11:10:6}function j(){return(Math.floor(4026531839*Math.random())+268435456).toString(16)}function h(){return i.m+j()+j()+j()+j()}function w(e,t){return t.IsInline&&-1===e.indexOf(t.ContentId)}function S(){return i.d+j()+"@"+j()+"."+j()}},2119:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return c}));var r=n(24),o=n(4),a={clpLabels:[],learnMoreUrl:"",hasMandatoryLabel:!1,rmsTemplates:new r.ObservableMap,messageClassifications:new r.ObservableMap},i=Object(o.createStore)("protection",a),c=i()},2189:function(e,t,n){"use strict";function r(e,t){return e+"_"+(null!=t.enabledTimeInUTCMs?t.enabledTimeInUTCMs:"")}n.d(t,"a",(function(){return r}))},2244:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return l}));var r=n(0),o=n(965),a=n(1594),i=n(1108),c=n(27),u=n(1259);function s(e){var t,n,c=(null==e?void 0:e.itemIds)?e.itemIds.length:0;if(0==c)return[null,!1,!1];var s=null,d=2==Object(i.c)().type||!Object(i.b)();if(1==c){if(!(s=o.a.items.get(e.itemIds[0])))return[null,!1,!1];d=d||s.ParentFolderId&&s.ParentFolderId.Id==Object(i.b)()}else{var l=null;try{for(var f=Object(r.__values)(e.itemIds),b=f.next();!b.done;b=f.next()){var m=b.value,v=o.a.items.get(m);if(!v)return[null,!1,!1];if(v.ParentFolderId&&v.ParentFolderId.Id==Object(i.b)()){s=v,d=!0;break}Object(u.a)(v.ParentFolderId.Id,"sentitems")&&(l=v)}}catch(e){t={error:e}}finally{try{b&&!b.done&&(n=f.return)&&n.call(f)}finally{if(t)throw t.error}}s||(s=l||o.a.items.get(e.itemIds[0]))}return[s,d,Object(a.a)(s.ParentFolderId.Id)]}function d(e,t,n){var r=Object(c.a)().UserOptions.HideDeletedItems;return e&&!((e.IsDraft||r)&&t&&!n)}function l(e){var t=o.a.conversationNodes.get(e),n=Object(r.__read)(s(t),3),a=n[0],i=n[1];return d(a,n[2],i)?a:null}},2269:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(49);function o(){if(Object(r.i)())try{return new ActiveXObject("htmlfile"),!0}catch(e){return!1}return!1}},2273:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(76),o=n(49),a=n(27),i=n(1026),c=function(e){return!(!Object(r.h)("fwk-webPushNotification")&&!Object(r.h)("fwk-webPushNotificationV2"))&&(!(!e.navigator||null==e.navigator.serviceWorker||null==e.PushManager)&&((Object(o.e)()||Object(o.h)()||Object(r.h)("fwk-webPushNotificationExtended")&&(Object(o.f)()||Object(o.j)()))&&!Object(a.a)().SessionSettings.IsUserCultureRightToLeft&&(1==Object(i.b)()||2==Object(i.b)())))}},2309:function(e,t,n){"use strict";function r(){return new Date}n.d(t,"a",(function(){return r}))},2377:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1967);function o(){var e=Object(r.b)();return 9==e.installationStatus||6==e.installationStatus}},2417:function(e,t,n){"use strict";n.d(t,"b",(function(){return a}));var r=n(3254),o=n(2770);function a(e){return Math.min(Math.floor(e/2),24)}t.a={RPPerfLoadConversationReadingPane:{name:"RPPerfLoadConversationReadingPane"},RPPerfLoadItemReadingPane:{name:"RPPerfLoadItemReadingPane"},RPCountExpCollQuotedText:{name:"RPCountExpCollQuotedText",customData:function(e,t,n){return[n?1:0,!e.isExpanded]}},RPCountExpCollItemPart:{name:"RPCountExpCollItemPart",customData:function(e,t,n){return[t||n?e.isExpanded?"EC":"CE":e==Object(r.b)()?"SC":e.isExpanded?"ES":"CS",t]}},RPCountLoadMore:{name:"RPCountLoadMore"},RPCountExpCollItemsRollUp:{name:"RPCountExpCollItemsRollUp",customData:function(e,t){return[a(Object(o.a)(e)),t]}},RPCountExpCollAllItemParts:{name:"RPCountExpCollAllItemParts",customData:function(e,t,n){return[t,n]}},PrintItem:{name:"PrintItem",actionSource:function(e,t){return t}},ReplyByMeeting:{name:"ReplyByMeeting",actionSource:function(e,t,n,r){return r}}}},2418:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(108),o=new r.c((function(){return Promise.all([n.e(749),n.e(674)]).then(n.bind(null,4752))})),a=new r.b(o,(function(e){return e.SmimeAdapter}))},2476:function(e,t,n){"use strict";var r=n(1371);n.d(t,"m",(function(){return r.b})),n.d(t,"l",(function(){return r.a})),n.d(t,"p",(function(){return r.h})),n.d(t,"n",(function(){return r.d})),n.d(t,"o",(function(){return r.f}));var o=n(2189);n.d(t,"b",(function(){return o.a}));var a=n(1576);n.d(t,"a",(function(){return a.a}));var i=n(1649);n.d(t,"k",(function(){return i.e})),n.d(t,"q",(function(){return i.i}));var c=n(1640);n.d(t,"c",(function(){return c.b})),n.d(t,"d",(function(){return c.c}));var u=n(2273);n.d(t,"e",(function(){return u.a}));var s=n(1180);n.d(t,"j",(function(){return s.f})),n.d(t,"i",(function(){return s.e})),n.d(t,"h",(function(){return s.d})),n.d(t,"g",(function(){return s.c})),n.d(t,"f",(function(){return s.b}))},2602:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(49),o=n(1275);function a(){return Object(r.e)()&&Object(r.n)([o.f])||Object(r.g)()&&Object(r.n)([o.h])||Object(r.f)()&&Object(r.n)([o.g])}},2660:function(e,t,n){"use strict";t.a=function(e){var t;return null===(t=null==e?void 0:e.Smime)||void 0===t?void 0:t.isDecoded}},2661:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Item=0]="Item",e[e.Oof=1]="Oof",e[e.FossilizedText=2]="FossilizedText",e[e.GlobalReply=3]="GlobalReply",e[e.SeeMore=4]="SeeMore"}(r||(r={}))},2770:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return c}));var r=n(965);function o(e){return(null==e?void 0:e.conversationNodeIdsInCollapsedItemsRollUp)&&e.conversationNodeIdsInCollapsedItemsRollUp.length>0}function a(e){var t=r.a.conversations.get(e.conversationId.Id);return o(e)||(null==t?void 0:t.canLoadMore)}function i(e,t){return(null==e?void 0:e.conversationNodeIdsInCollapsedItemsRollUp)&&t&&e.conversationNodeIdsInCollapsedItemsRollUp.includes(t.conversationNodeId)}function c(e){if(!o(e))return 0;var t=e.conversationNodeIdsInCollapsedItemsRollUp,n=e.itemPartsMap,r=t.length;return t.forEach((function(e){var t=n.get(e);t.oofRollUpViewState.oofReplyNodeIds&&(r+=t.oofRollUpViewState.oofReplyNodeIds.length)})),r}},2771:function(e,t,n){"use strict";function r(e,t){return{infoBarIds:t||[],infoBarHostKey:e||"0"}}n.d(t,"a",(function(){return r}))},2772:function(e,t,n){"use strict";function r(e,t,n,r){var a=o(e,t,n,r);return a?a.Value:null}function o(e,t,n,r){if(!e||!e.ExtendedProperty)return null;for(var o=0;o<e.ExtendedProperty.length;o++){var a=e.ExtendedProperty[o],i=null,c=null,u=null;if((null==a?void 0:a.ExtendedFieldURI)&&(i=a.ExtendedFieldURI.PropertyTag,c=a.ExtendedFieldURI.PropertyName,u=a.ExtendedFieldURI.PropertyId),t&&i==t)return a;if(n&&c==n)return a;if(r&&u==r)return a}return null}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}))},2839:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"f",(function(){return i})),n.d(t,"d",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"e",(function(){return s})),n.d(t,"g",(function(){return d})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return f}));var r=n(108),o=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(482)]).then(n.bind(null,5135))})),a=new r.a(o,(function(e){return e.loadCLPUserLabels})),i=new r.b(o,(function(e){return e.showJustificationModal})),c=new r.a(o,(function(e){return e.loadItemCLPInfo})),u=new r.b(o,(function(e){return e.updateItemCLPInfo})),s=new r.b(o,(function(e){return e.logReadCLPLabel})),d=new r.b(o,(function(e){return e.triggerCLPAutoLabeling})),l=Object(r.d)(o,(function(e){return e.CLPSubjectHeaderLabel})),f=Object(r.d)(o,(function(e){return e.CLPMandatoryLabelModal}))},3101:function(e,t,n){"use strict";var r=n(76),o=n(2119),a=n(295);t.a=function(){var e=o.b.clpLabels;return Object(r.h)("cmp-clp")&&e.length>0&&e.some((function(e){return e.isLabelEnabled}))&&!Object(a.a)()}},3103:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.TXP=0]="TXP",e[e.CalendarCard=1]="CalendarCard",e[e.MeetingPoll=2]="MeetingPoll",e[e.Voting=3]="Voting",e[e.Reschedule=4]="Reschedule",e[e.Yammer=5]="Yammer"}(r||(r={}))},3141:function(e,t,n){"use strict";t.a=function(e,t){void 0===t&&(t=!0);var n=t?23:24;return e>=n?n:e}},3227:function(e,t,n){"use strict";var r=n(0),o=n(2303),a=n(3584),i=n(3367),c=n(2417),u=n(4039),s=n(3368),d=n(4040),l=n(4041),f=n(3585),b=n(123),m=n(76),v=n(2771),O=n(4042),p=n(1108),g=n(2839),I=n(4630),j=n(2772),h=n(950),w="x-ms-exchange-organization-ome-messagestate";function S(e){if(!Object(m.h)("rp-omeRevocation")||(null==e?void 0:e.ParentFolderId)&&e.ParentFolderId.Id!==Object(h.a)("sentitems"))return null;var t=Object(j.a)(e,null,w);return Object(I.a)(t)}var C=n(1727),P=n(965),A=n(1833),E=n(2418),R=n(1967),x=n(3503),y=n(2377),M=n(4593),N=n(3586),T=function(e){var t;return(null===(t=null==e?void 0:e.Smime)||void 0===t?void 0:t.ErrorState)||0},_=n(3740),k=n(2660),L=n(1359),D=n(79),V=n(254),U=function(e,t){D.g.info("S/MIME: processing S/MIME message. isSmimeAdapterAlreadyUsable: "+Object(y.a)());var n=new V.a("RPProcessSmimeItem",{isCore:!0});return A.q.import().then((function(t){return t(e)})).then((function(){K(e,n,t)})).catch((function(){K(e,n,t)}))};function F(e,t,n,i,c,s){if(e.itemId==t.Id){var b=(null==t?void 0:t.Id)&&Object(P.b)().items.get(t.Id);e.itemViewState=function(e,t){return Object(r.__assign)(Object(r.__assign)({},Object(v.a)(e.Id,Object(u.a)())),{itemId:e.Id,isContextMenuShown:!1,isConversationItemPart:!1,attachmentWell:null,meetingRequestViewState:null,loadingState:{isLoading:!1,hasLoadFailed:!1},actionableMessageCardInItemViewState:{showBodyWithMessageCard:!1,showCardLoading:!0},undoDarkMode:!1,isLoadingFullBody:!1,smartPillViewState:{smartPillBlockVisible:!1},hideSmartReplyFeedbackDialog:!0,ampViewState:Object(O.a)(t),hasMeetingPoll:Object(l.a)(t),omeMessageState:S(t)})}(t,b),e.loadingState.isLoading=!1,e.loadingState.hasLoadFailed=!b,e.instrumentationContext=n,b&&(i.addCustomData(Object(d.b)(b,s,c)),g.h.import().then((function(e){e(b)})),Object(f.d)(b)?e.isUnsupportedItem=!0:(Object(a.a)(e.itemViewState,!1,{item:b}),Object(o.a)(e,b)))}}var B=function(e,t,n,r){return r?r(e):C.e.importAndExecute(e,n?"LoadItemPreviewPane":"LoadItemReadingPane",t,Object(y.a)())},W=function(e,t,n,r,o){var a;return Object(L.a)(n)?E.a.import().then((function(){return Object(y.a)()&&Object(M.a)(n)?(a=!0,B(e,t,r,o)):n})).then((function(){return U(e,a)})):Promise.resolve()};function K(e,t,n){var r=Object(P.b)().items.get(null==e?void 0:e.Id);t.addCustomData({smimeInstallationStatus:R.a.installationStatus,smimeType:Object(_.a)(r),numAttachments:z(r),wasReloaded:n}),Object(k.a)(r)?t.end():t.endWithError("ClientError",new Error(T(r).toString()))}function z(e){var t;return null===(t=null==e?void 0:e.Attachments)||void 0===t?void 0:t.length}t.a=Object(b.d)("loadItemReadingPane",c.a.RPPerfLoadItemReadingPane)((function(e,t,n,r,o,a){var u=function(e,t){return{itemId:e.Id,itemViewState:null,isPrint:t,loadingState:{isLoading:!0,hasLoadFailed:!1},currentSelectedFolderId:Object(p.b)(),isUnsupportedItem:!1,instrumentationContext:null,extendedCardViewState:null}}(e,r);Object(s.c)(),Object(i.a)(u),n&&n(u);var d=Object(V.q)((function(e){return e.eventName==c.a.RPPerfLoadItemReadingPane.name})),l=Object(P.b)().items.get(e.Id);!Object(m.h)("ring-dogfood")||r||o||Object(V.o)("RPMailStoreItemsCount",{count:Object(P.b)().items.size});var f=Object(M.a)(l),b=Object(L.a)(l);return b&&l.Smime&&!Object(k.a)(l)&&(l.Smime.ErrorState=0),l&&(l.NormalizedBody&&!f||Object(N.a)(l))?b&&!Object(k.a)(l)?(new V.a("RPProcessSmimeItem").addCustomData({wasItemReloaded:!1}),U(e,!1).then((function(){var n,a;return null===(a=null===(n=null==t?void 0:t.dp)||void 0===n?void 0:n.addCheckpoint)||void 0===a||a.call(n,"LIRP_SMIME"),F(u,e,t,d,r,o)}))):(F(u,e,t,d,r,o),Promise.resolve()):new Promise((function(e){return b&&f&&!Object(x.a)()?E.a.import().then(e):e()})).then((function(){var n,i;return null===(i=null===(n=null==t?void 0:t.dp)||void 0===n?void 0:n.addCheckpoint)||void 0===i||i.call(n,"LIRP_THEN"),function(e,t,n,r,o,a,i){return B(t,r,a,i).then((function(e){var o,c;return null===(c=null===(o=null==n?void 0:n.dp)||void 0===o?void 0:o.addCheckpoint)||void 0===c||c.call(o,"LI_THEN"),W(t,r,e,a,i)})).then((function(){var i,c;return null===(c=null===(i=null==n?void 0:n.dp)||void 0===i?void 0:i.addCheckpoint)||void 0===c||c.call(i,"LI_SMIME_THEN"),F(e,t,n,r,o,a)})).catch((function(t){return e.loadingState.isLoading=!1,e.loadingState.hasLoadFailed=!0,Promise.reject(t)}))}(u,e,t,d,r,o,a)}))}))},3254:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return s}));var r=n(2661),o=n(1193),a=n(283),i=Object(a.select)({conversationReadingPaneState:function(){return Object(o.a)()}})((function(e){var t;return(null===(t=e.conversationReadingPaneState)||void 0===t?void 0:t.focusedItemPart)?e.conversationReadingPaneState.focusedItemPart.itemPart:null})),c=Object(a.select)({conversationReadingPaneState:function(){return Object(o.a)()}})((function(e){var t;return(null===(t=e.conversationReadingPaneState)||void 0===t?void 0:t.focusedItemPart)?e.conversationReadingPaneState.focusedItemPart.focusedItemArea:null})),u=Object(a.select)({conversationReadingPaneState:function(){return Object(o.a)()}})((function(e){var t;return(null===(t=e.conversationReadingPaneState)||void 0===t?void 0:t.initiallySelectedItemPart)?e.conversationReadingPaneState.initiallySelectedItemPart.itemPart:null})),s=Object(a.select)({conversationReadingPaneState:function(){return Object(o.a)()}})((function(e,t){var n=i(t),o=c(t);return n==e&&o==r.a.Item}))},3255:function(e,t,n){"use strict";var r,o;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),function(e){e[e.None=0]="None",e[e.Revocable=1]="Revocable",e[e.Expirable=2]="Expirable"}(r||(r={})),function(e){e[e.None=0]="None",e[e.SuccessOrNoChange=1]="SuccessOrNoChange",e[e.FailedOrMessageNotFound=2]="FailedOrMessageNotFound",e[e.PartialFailed=3]="PartialFailed"}(o||(o={}))},3367:function(e,t,n){"use strict";var r=n(3368),o=n(1088),a=n(76),i=n(283);t.a=Object(i.action)("setItemReadingPaneViewState")((function(e){Object(a.h)("rp-persistedReadingPaneTabs")?Object(r.a)(e):o.a.itemReadingPaneViewState=e}))},3368:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return d}));var r=n(1088),o=n(4),a=n(76),i=n(1085),c=n(2104),u=Object(o.mutatorAction)("addLoadedItemReadingPaneViewState",(function(e){if(Object(a.h)("rp-persistedReadingPaneTabs")){var t=e.itemId,n=Object(r.b)().loadedItemReadingPaneViewStates;n.has(t)||n.set(t,e)}})),s=Object(o.mutatorAction)("releaseOrphanedLoadedItemViewStates",(function(){if(Object(a.h)("rp-persistedReadingPaneTabs")){var e=Object(r.b)().loadedItemReadingPaneViewStates;e.forEach((function(t,n){Object(i.m)(n)||n==Object(c.a)()||e.delete(n)}))}})),d=Object(o.mutatorAction)("releaseLoadedItemViewState",(function(e){Object(a.h)("rp-persistedReadingPaneTabs")&&Object(r.b)().loadedItemReadingPaneViewStates.delete(e)}))},348:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(376),o=n(4),a=n(423),i=n(3),c={state:r.a.NotStarted,isPopoutV2:Object(i.a)(a.a)==a.b},u=Object(o.createStore)("popoutChild",c);u()},3503:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1967),o=n(2107);function a(){var e=Object(r.b)();return Object(o.k)(e.installationStatus)}},3584:function(e,t,n){"use strict";var r=n(0),o=n(4136),a=n(965),i=n(1535),c=n(283);t.a=Object(c.select)({item:function(e){return a.a.items.get(e.itemId)}})(Object(c.action)("initializeExtendedStateForItemViewState")((function(e,t,n){return void 0===t&&(t=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(o.a)(e,n.item,t)];case 1:return r.sent(),n.item&&Object(i.q)(n.item.ItemClass)&&i.t.importAndExecute(e),[2]}}))}))})))},3585:function(e,t,n){"use strict";n.d(t,"d",(function(){return m})),n.d(t,"c",(function(){return v})),n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return p}));var r=n(948),o=n(965),a=n(950),i="IPM.Appointment",c="IPM.Contact",u="IPM.DistList",s="IPM.Task",d="calendar",l="contacts",f="tasks",b="inbox";function m(e){return e&&(g(e.ItemClass)||I(e.ItemClass)||j(e.ItemClass)||h(e.ItemClass))}function v(e){var t=o.a.conversations.get(e),n=o.a.conversationNodes.get(t&&t.conversationNodeIds[0]);if(n){var r=n.itemIds[0];if(m(o.a.items.get(r)))return r}return null}function O(e){var t=o.a.items.get(e);return g(t.ItemClass)?Object(a.a)(d):I(t.ItemClass)||j(t.ItemClass)?Object(a.a)(l):h(t.ItemClass)?Object(a.a)(f):Object(a.a)(b)}function p(e){var t="",n=r.d.folderTable.get(e);return n&&(t=Object(r.j)(n)),t}function g(e){return 0==e.indexOf(i)}function I(e){return 0==e.indexOf(c)}function j(e){return 0==e.indexOf(u)}function h(e){return 0==e.indexOf(s)}},3586:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1275);function o(e){return(null==e?void 0:e.ItemId)&&0===e.ItemId.Id.indexOf(r.m)}},3645:function(e,t,n){"use strict";var r=n(4),o=Object(r.action)("OnComposeLifecycleEvent",(function(e,t){return{viewState:e,event:t}}));t.a=o},3702:function(e,t,n){"use strict";var r=n(0),o=n(6169),a=n(2417),i=n(4039),c=n(5893),u=n(1088),s=n(4040),d=n(4041),l=n(4705),f=n(6357),b=n(24),m=n(254),v=n(123),O=n(76),p=n(2771),g=n(4042),I=n(971),j=n(965);function h(e){var t=I.a.conversationItems.get(e);if(t){var n=function(e){var t,n,o,a,i={unreadItemCount:0,totalItemCount:0},c=j.a.conversations.get(e);try{for(var u=Object(r.__values)(c.conversationNodeIds),s=u.next();!s.done;s=u.next()){var d=s.value,l=j.a.conversationNodes.get(d);if(!l){i.totalItemCount=0;break}i.totalItemCount+=l.itemIds.length;try{for(var f=(o=void 0,Object(r.__values)(l.itemIds)),b=f.next();!b.done;b=f.next()){var m=b.value,v=j.a.items.get(m);if(!v){i.totalItemCount=0;break}i.unreadItemCount+=v.IsRead?0:1}}catch(e){o={error:e}}finally{try{b&&!b.done&&(a=f.return)&&a.call(f)}finally{if(o)throw o.error}}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}return i}(e);return t.globalItemIds.length!=n.totalItemCount||t.globalUnreadCount!=n.unreadItemCount}return!1}var w=n(1108),S=n(963),C=n(1727),P=n(283),A=n(2244);n.d(t,"a",(function(){return R}));var E=[];var R=Object(P.select)({conversationNodes:function(){return S.w.conversationNodes}})((function(e,t,n){var o;if(!t||!t.Id)return[null,null];var a=n.conversationNodes.get(t.Id),c=(o=Object(r.__read)(Object(A.a)(a),3))[0],u=o[1],s=o[2];if(!Object(A.c)(c,s,u))return[null,null];var l={isExpanded:!1,loadingState:{isLoading:!1,hasLoadFailed:!1}},b=function(e,t,n){return!e.IsRead&&t||e.IsDraft&&!n}(c,u,s),m={mailboxInfo:t.mailboxInfo,Id:c.ItemId.Id};return[Object(r.__assign)(Object(r.__assign)({},Object(p.a)(m.Id,Object(i.a)())),{conversationNodeId:t.Id,itemId:m.Id,isConversationItemPart:!0,isExpanded:b,isLocal:u,isDeleted:s,isContextMenuShown:!1,attachmentWell:null,quotedBodyViewState:l,isFossilizedTextExpanded:b,hideSmartReplyFeedbackDialog:!0,meetingRequestViewState:null,loadingState:{isLoading:!1,hasLoadFailed:!1},actionableMessageCardInItemViewState:{showBodyWithMessageCard:!1,showCardLoading:!0},undoDarkMode:!1,isLoadingFullBody:!1,oofRollUpViewState:Object(f.b)(c.ItemClass),isInRollUp:!1,smartPillViewState:{smartPillBlockVisible:!1},ampViewState:Object(g.a)(c),hasMeetingPoll:Object(d.a)(c),omeMessageState:null}),c]}));t.b=Object(P.select)({readingPaneStore:function(){return u.a},conversationNodes:function(){return S.w.conversationNodes},conversations:function(){return S.d}})(Object(v.d)("loadConversationReadingPane",a.a.RPPerfLoadConversationReadingPane)((function(e,t,n,r,i,u){var d,f=Promise.resolve(),v=function(e,t,n,r,o){return{conversationId:e,conversationSubject:t,conversationCategories:n,initiallySelectedItemPart:null,itemIdToScrollTo:o,itemPartsMap:new b.ObservableMap({}),loadingState:{isLoading:!0,hasLoadFailed:!1},currentSelectedFolderId:Object(w.b)(),unsupportedItemId:null,instrumentationContext:r,attachmentWell:null,calendarInlineComposeViewState:null,focusedItemPart:null,conversationNodeIdsInCollapsedItemsRollUp:[],nodeIdBundledWithSeeMoreMessages:null,extendedCardViewState:null}}(e,n,r,t,i);Object(O.h)("rp-persistedReadingPaneTabs")||(u.readingPaneStore.conversationReadingPaneViewState=v);var p=Object(S.s)(e.Id),g=Object(m.q)((function(e){return e.eventName==a.a.RPPerfLoadConversationReadingPane.name}));if(Object(O.h)("ring-dogfood")){var I=!1;E.includes(e.Id)?I=!0:E.push(e.Id),Object(m.o)("RPCacheStatus",{hasValidConversationCache:p,hasOpened:I,OpenedCount:E.length})}return Object(c.c)(),p&&(d="Valid",u.conversations.getAndTouch(e.Id),Object(l.a)(e.Id)||(Object(c.a)(v),Object(o.a)(e.Id))),p&&!h(e.Id)||(Object(c.a)(v),d=p?"Stale":"Not",f=C.d.importAndExecute(e,"LoadConversationReadingPane",g)),f.then((function(){var n,r;null===(r=null===(n=null==t?void 0:t.dp)||void 0===n?void 0:n.addCheckpoint)||void 0===r||r.call(n,"LCRP_POST"),g&&g.addCustomData(Object(s.a)(e.Id,d))}))})))},3741:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(960),o=n(76),a=n(295);function i(){var e=Object(r.d)(r.a.AmpDeveloper);return Object(a.a)()&&Object(o.h)("rp-amp")&&e.enabled}},376:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.NotStarted=0]="NotStarted",e[e.Loading=1]="Loading",e[e.Ready=2]="Ready"}(r||(r={}))},3821:function(e,t,n){"use strict";function r(e,t){return(null==e?void 0:e.extendedCardViewState)&&e.extendedCardViewState.cardType==t}function o(e){var t;return null===(t=null==e?void 0:e.extendedCardViewState)||void 0===t?void 0:t.coverOriginalContent}function a(e,t){return r(e,t)?e.extendedCardViewState.cardViewState:null}n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a}))},4039:function(e,t,n){"use strict";function r(){return["unsubscribeInfoBar","safetyBar","infoImportance","infoSensitivity","infoFlagStatus","irmInfoBar","infoMessageSubmitted","agendaMailFeedback","unauthenticatedSender","infoDelegate","infoMeetingAttendeeDoNotForward","infoSMIME","infoSmimeDecodeError","infoSmimeSigned","infoItemPartLoadFailure","infoLastUserAction","infoReadReceiptRequested","translateInfoBar","infoResend","infoPolicyTag","infoMessageApprovalAndVoting","nudged","nudgeFeedback","infoMessageClassification","infoCLPLabel","infoRevocation","externalMessage"]}n.d(t,"a",(function(){return r}))},4040:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return b}));var r=n(1997),o=n(1193),a=n(965),i=n(3141),c=n(1535),u=n(27),s=n(1359),d="Meeting",l="Message";function f(e,t){var n=0,u=0,s=0,d=0,l=0,f=Object(o.a)(e);if(f){var b=f.itemPartsMap;b.forEach((function(e){e.isExpanded&&d++;var t=a.a.items.get(e.itemId);t&&(t.IsRead||n++,t.IsDraft&&u++,Object(c.m)(t)&&s++)})),l=b.size}return{owa_1:v(),owa_2:Object(r.a)(),owa_3:Object(i.a)(l),owa_4:Object(i.a)(d),owa_5:Object(i.a)(n),owa_6:Object(i.a)(s),owa_7:Object(i.a)(u),owa_8:t}}function b(e,t,n){return{owa_1:v(),owa_2:m(e),owa_3:t,owa_4:n,owa_5:Object(s.a)(e)}}function m(e){return Object(c.m)(e)?d:l}function v(){return Object(u.a)().UserOptions.GlobalReadingPanePositionReact}},4041:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9),o=n(76),a="findtime/vote?getrequesturl=";function i(e){if(!Object(o.h)("cal-mf-meetingPollCard")||!e)return!1;var t=null;return e.UniqueBody?t=e.UniqueBody.Value:e.NormalizedBody&&(t=e.NormalizedBody.Value),!Object(r.f)(t)&&t.indexOf(a)>-1}},4042:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(4763);function o(e){return{preferAmp:!0,ampAvailability:Object(r.a)(e)}}},4043:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.None="none",e.AmpDisabled="ampDisabled",e.MessageUnsafe="messageUnsafe",e.SenderNotAllowed="sendNotAllowed",e.BrowserNotSupported="browserNotSupported",e.AmpNotValidated="ampNotValidated",e.AmpValidationFailed="ampValidationFailed",e.AmpValidated="ampValidated"}(r||(r={}))},4136:function(e,t,n){"use strict";var r=n(0),o=n(1489),a=n(1235),i=n(2416),c=n(2660),u=n(1359),s=n(283),d=n(1193),l=n(965),f=n(4202);function b(e,t){var n,r=l.a.items.get(t);if(r){var o=r.InternetMessageId,a=null===(n=Object(d.a)(e))||void 0===n?void 0:n.itemPartsMap.get(o);return a?a.attachmentWell:null}return null}var m=n(1401);t.a=Object(s.action)("initializeAttachmentsForItem")((function(e,t,n){return void 0===n&&(n=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){var s,d;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return!t||Object(u.a)(t)&&!function(e,t){if(!Object(i.a)(t))return!0;if(!e.isConversationItemPart&&Object(c.a)(t))return!0;return!1}(e,t)||!t.Attachments?[2]:e.attachmentWell?[3,2]:[4,a.j.import()];case 1:s=r.sent(),e.attachmentWell=s(!0,!1,""),r.label=2;case 2:return f.a.register(b),n?[4,a.q.importAndExecute(t.Attachments,t.MailboxInfo,e.attachmentWell,!0)]:[3,4];case 3:return r.sent(),[3,6];case 4:return[4,a.n.importAndExecute(t.Attachments,t.MailboxInfo,e.attachmentWell,!0,!1,null,null,!!t.RightsManagementLicenseData,Object(u.a)(t))];case 5:r.sent(),r.label=6;case 6:return[4,o.g.import()];case 7:return d=r.sent(),d(t.Attachments).forEach((function(t){return Object(m.a)(e,t)})),[2]}}))}))}))},4176:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(108),o=new r.c((function(){return n.e(616).then(n.bind(null,6512))})),a=new r.a(o,(function(e){return e.loadWorkloadScenarioSettings}))},4202:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(79),o=null,a={register:function(e){o=e},available:function(){return!!o},run:function(e,t){return o?o(e,t):(r.d("getAttachmentWellViewStateByItemIdHelper is not registered."),null)}}},423:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a}));var r="popoutv2",o="1",a="_owa_projection_root"},448:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return c}));var r,o=2,a=[window.location.origin];function i(e,t,n){var r={version:o,type:t,serializedData:JSON.stringify(n)};e.postMessage(JSON.stringify(r),"*")}function c(e){if(a.indexOf(e.origin)>=0){var t=void 0;try{t=JSON.parse(e.data)}catch(e){return null}if(t&&o==t.version)return t}return null}!function(e){e[e.Unknown=0]="Unknown",e[e.PopoutReady=1]="PopoutReady",e[e.SetData=2]="SetData",e[e.CloseWindow=3]="CloseWindow"}(r||(r={}))},4593:function(e,t,n){"use strict";var r=n(2416),o=n(2660),a=n(1359),i=n(3503),c=n(2377),u=function(){return!!Object(i.a)()&&!Object(c.a)()};t.a=function(e){return!Object(o.a)(e)&&!u()&&Object(a.a)(e)&&!Object(r.a)(e)}},4628:function(e,t,n){"use strict";function r(e){var t;return(null===(t=e.From)||void 0===t?void 0:t.Mailbox)?e.From.Mailbox.EmailAddress:null}n.d(t,"a",(function(){return r}))},4629:function(e,t,n){"use strict";var r=n(4),o=Object(r.createStore)("ampstore",{allowedSenders:[]});t.a=o()},4630:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3255),o=n(7);function a(e){if(e){var t={permissions:r.b.None,revoked:!1,expired:!1,revocationDate:null,revokedBy:null,responseState:r.a.None};try{var n=JSON.parse(e);if(1==n.Permissions&&(t.permissions=r.b.Revocable),2==n.Permissions&&(t.permissions=r.b.Expirable),t.revoked=n.IsRevoked,t.expired=n.IsExpired,n.RevocationDate){var a=Object(o.Rb)("UTC",n.RevocationDate);t.revocationDate=new Date(Object(o.Ab)(a))}t.revokedBy=n.RevokedBy}catch(e){return null}return t}return null}},4705:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1088),o=n(76);function a(e){return!(!Object(o.h)("rp-persistedReadingPaneTabs")||!e)&&Object(r.b)().loadedConversationReadingPaneViewStates.has(e)}},4763:function(e,t,n){"use strict";var r=n(9);var o=n(4628),a=n(3741),i=n(60),c=n(4043),u=n(4629),s=n(960);function d(e){if(!function(e){return e&&!Object(r.f)(e.AmpHtmlBody)}(e))return c.a.None;if(!Object(a.a)())return c.a.AmpDisabled;if(!function(e){return e&&!e.BlockStatus&&(!e.MessageSafety||!e.MessageSafety.MessageSafetyLevel||e.MessageSafety.MessageSafetyLevel<=2)}(e))return c.a.MessageUnsafe;var t=Object(o.a)(e);return null==t||!function(e){var t=Object(s.d)(s.a.AmpDeveloper);return t.enabled&&t.allowedSender.some((function(t){return l(t,e)}))}(t)&&!function(e){return u.a.allowedSenders&&u.a.allowedSenders.some((function(t){return l(t,e)}))}(t)?c.a.SenderNotAllowed:Object(i.e)()||Object(i.g)()?c.a.BrowserNotSupported:c.a.AmpNotValidated}function l(e,t){return e.toLowerCase()==t.toLowerCase()}n.d(t,"a",(function(){return d}))},4770:function(e,t,n){"use strict";var r=n(108),o=n(5408);function a(e){var t;return null===(t=o.a.usageSuggestions)||void 0===t?void 0:t.get(e)}n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return a}));var i=new r.c((function(){return n.e(454).then(n.bind(null,15102))})),c=new r.a(i,(function(e){return e.initializePersonalizationSuggestions})),u=new r.a(i,(function(e){return e.postPersonalizationSuggestionFeedback})),s=new r.a(i,(function(e){return e.postPersonalizationUsageSignals}))},4801:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1567);function o(e){e?Object(r.r)(e,"Route"):Object(r.p)("Route")}},483:function(e,t,n){"use strict";var r=n(108),o=n(584),a=n(487),i=n(42),c=n(1),u=n(486),s=n(348),d=n(76),l=n(376),f=n(905),b=n(715),m=Object(i.a)((function(e){c.useEffect((function(){Object(d.h)("rp-popoutsDebug")||v()}),[]);return c.createElement("div",{className:b.view},Object(s.a)().state==l.a.Loading?c.createElement("span",null,c.createElement(f.a,null),e.loadingString):c.createElement("button",{onClick:v},"Get Data"))}));function v(){Object(u.a)()}var O=n(114);function p(e,t,n,r){var o="";if(r)o="readimid/",o+=encodeURIComponent(btoa(r));else{if(o=n?"readconv/":"read/",e&&e.type==O.a.GroupMailbox){o+="group/";var a=e.mailboxSmtpAddress.split("@");o+=a[1]+"/"+a[0]+"/"}o+=encodeURIComponent(n||t)}return o}n.d(t,"g",(function(){return I})),n.d(t,"c",(function(){return o.a})),n.d(t,"h",(function(){return a.a})),n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return l.a})),n.d(t,"f",(function(){return s.a})),n.d(t,"d",(function(){return u.b})),n.d(t,"e",(function(){return p}));var g=new r.c((function(){return n.e(474).then(n.bind(null,15071))})),I=new r.b(g,(function(e){return e.bootPopout}))},486:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return l}));var r,o=n(0),a=n(487),i=n(448),c=n(376),u=n(348),s=!1;function d(){Object(a.a)(c.a.Loading),r?r():s=!0}function l(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return s?[3,2]:[4,new Promise((function(e){r=function(){e()}}))];case 1:t.sent(),t.label=2;case 2:return[2,Object(u.a)().isPopoutV2?new Promise((function(t,n){var r=function(n){var o=Object(i.b)(n);if(o&&o.type==i.a.SetData){window.removeEventListener("message",r);var a=void 0;try{a=e?e(o.serializedData):JSON.parse(o.serializedData)}catch(e){}t(a)}};window.addEventListener("message",r);try{var o=window.opener;Object(i.c)(o,i.a.PopoutReady,null)}catch(e){t(null)}})):Promise.resolve(null)]}}))}))}},487:function(e,t,n){"use strict";var r=n(348),o=n(4);t.a=Object(o.mutatorAction)("setPopoutChildState",(function(e){Object(r.a)().state=e}))},4932:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(965);function o(e){var t=r.a.conversations.get(e);return null==t?void 0:t.canLoadMore}},5391:function(e,t,n){"use strict";var r=n(2417),o=n(123);t.a=Object(o.d)("expandCollapsedItemsRollUp",r.a.RPCountExpCollItemsRollUp)((function(e,t){void 0===t&&(t=!1),e.conversationNodeIdsInCollapsedItemsRollUp=[]}))},5408:function(e,t,n){"use strict";var r=n(24),o=n(4),a={usageSuggestions:new r.ObservableMap},i=Object(o.createStore)("personalization",a)();t.a=i},584:function(e,t,n){"use strict";var r=n(0),o=n(49),a=600,i=800,c=8,u=25,s={location:!1,menubar:!1,resizable:!0,scrollbars:!1,status:!1,toolbar:!1},d=-1;function l(e,t){try{t=function(e){var t=u*(1+(d=(d+1)%c)),n={left:window.screenX+t,top:window.screenY+t,height:Math.max(25*Math.pow(window.innerHeight,.5),a),width:Math.max(8*Math.pow(window.innerWidth,2/3),i)};return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},s),n),e)}(t);var n=window.open(e,"_blank",function(e){return Object.getOwnPropertyNames(e).map((function(t){return t+"="+("boolean"==typeof(n=e[t])?n?"1":"0":n?String(n):void 0);var n})).join(",")}(t));return(Object(o.e)()||Object(o.f)())&&n.moveTo(t.left,t.top),n}catch(e){return null}}var f=n(2),b=n(556),m=n(423),v="version";var O=n(123),p=n(483);t.a=Object(O.d)("addPopoutV2",{name:"PopoutAddPopout",customData:function(e,t,n,r,o,a){return[(t||"").split("/")[0],a]}})((function(e,t,n,r,a,i,c){var u=function(e){var t=null,n=void 0,r=null;return e&&(!function(e){return void 0!==e.deeplinkData||!!e.projectionTabId}(e)?n=e:(n=e.deeplinkData,(Object(o.e)()||Object(o.h)()||Object(o.f)())&&(t=e.projectionTabId||null),r=e.projectionTargetWindow)),{deeplinkCallback:void 0===n?function(){return Promise.resolve(null)}:"function"==typeof n?n:function(){return Promise.resolve(n)},projectionTabId:t,projectionTargetWindow:r}}(n),s=u.deeplinkCallback,d=u.projectionTabId,O=u.projectionTargetWindow,g=d?"about:blank":function(e,t,n,r){var o;void 0===r&&(r={});var a=((o={})[v]=Object(f.j)(),o[m.a]=m.b,o);return Object.keys(r).map((function(e){a[e]=r[e]})),Object(b.q)(e,t,n,a)}(e,t,a,c),I=O||l(g,r);I&&p.g.import().then((function(t){return t(e,I,d,s)}))}))},5890:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("initializeExtendedCardForConversationReadingPane",(function(e,t){return{conversationViewState:e,loadedItemParts:t}}))},5891:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("tryInitializeShouldShowCLPLabel",(function(e){return{conversationViewState:e}}))},5892:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(6356);function o(e,t){var n=t?t.Value:"",o=Object(r.a)(e);return o||n}},5893:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return d}));var r=n(1088),o=n(4),a=n(76),i=n(1085),c=n(2104),u=Object(o.mutatorAction)("addLoadedConversationReadingPaneViewState",(function(e){if(Object(a.h)("rp-persistedReadingPaneTabs")){var t=e.conversationId.Id,n=Object(r.b)().loadedConversationReadingPaneViewStates;n.has(t)||n.set(t,e)}})),s=Object(o.mutatorAction)("releaseOrphanedLoadedConversationViewStates",(function(){if(Object(a.h)("rp-persistedReadingPaneTabs")){var e=Object(r.b)().loadedConversationReadingPaneViewStates;e.forEach((function(t,n){Object(i.m)(n)||n==Object(c.a)()||e.delete(n)}))}})),d=Object(o.mutatorAction)("releaseLoadedConversationViewState",(function(e){Object(a.h)("rp-persistedReadingPaneTabs")&&Object(r.b)().loadedConversationReadingPaneViewStates.delete(e)}))},5916:function(e){e.exports=JSON.parse('{"e":"Xna","a":"Yna","k":"_na","l":"$na","p":"boa","m":"coa","j":"doa","h":"eoa","o":"foa","n":"goa","g":"hoa","i":"ioa","f":"joa","d":"koa","b":"loa","c":"moa"}')},6169:function(e,t,n){"use strict";var r=n(0),o=n(6518),a=n(5890),i=n(3584),c=n(3702),u=n(2417),s=n(2770),d=n(1997),l=n(254),f=n(283),b=n(965),m=n(1535),v=n(3821),O=n(3103),p=5,g=3,I=Object(f.action)("markConversationCollapsedItemsRollUp")((function(e,t,n){Object(v.b)(e,O.a.CalendarCard)?function(e,t){for(var n=t.length,r=[],o=Object(d.a)()?0:n-1,a=Object(d.a)()?1:-1,i=o;i<=n-1&&i>=0&&!t[i].isExpanded;i+=a)j(t[i])&&r.push(t[i].conversationNodeId);r.length>1&&(e.conversationNodeIdsInCollapsedItemsRollUp=r)}(e,t):function(e,t,n){var r=t.length;if(r<p)return;var o=[],a=Object(d.a)()?1:r-2,i=Object(d.a)()?1:-1;n&&(a-=i);for(var c=a;c<=r-1&&c>=0&&!t[c].isExpanded;c+=i)o.push(t[c].conversationNodeId);if(o.length>=g){if(o.pop(),e.conversationNodeIdsInCollapsedItemsRollUp=o,!n){var f=Object(d.a)()?0:r-1;e.nodeIdBundledWithSeeMoreMessages=t[f].conversationNodeId}Object(l.o)("RPCountRenderCollItemsRollUp",[Object(u.b)(Object(s.a)(e))])}}(e,t,n)}));function j(e){var t=b.a.items.get(e.itemId);return!(!t||!Object(m.m)(t))&&t.IsOutOfDate}var h=n(6354),w=n(5891),S=n(2661),C=n(1193),P=n(5892),A=n(947);var E=n(9);var R=n(3585),x=n(1516),y=n(3101),M=n(2244);function N(e,t,n,o){var u=[],s=t.itemPartsMap,d=t.itemIdToScrollTo,l=null;if(e.conversationNodeIds){e.conversationNodeIds.forEach((function(n){var o=Object(r.__read)(Object(c.a)(t.conversationId.Id,{mailboxInfo:e.conversationId.mailboxInfo,Id:n}),1)[0];o&&s.set(n,o)})),Object(y.a)()&&Object(w.a)(t),Object(h.a)(s,n,e.conversationNodeIds,!1);var f=!1;e.conversationNodeIds.forEach((function(e){var t=s.get(e);if(t&&!t.isInRollUp){u.push(t);var n=o.get(t.itemId);(function(e){var t=Object(A.C)();if(null==t?void 0:t.highlightTerms){var n=Object(P.a)(e.RightsManagementLicenseData,e.UniqueBody),r=document.createElement("div");return r.innerHTML=n,t.highlightTerms.some((function(e){return r.innerText.toLowerCase().indexOf(e)>=0}))}return!1})(n)&&(t.isExpanded=!0),f=f||t.isExpanded&&!n.IsDraft}}));var p="ChronologicalNewestOnBottom"==e.conversationSortOrder;if(function(e,t,n,r){var o=n.length;if(0!=o&&!t){for(var a=null,i=e?o-1:0,c=i,u=e?-1:1,s=function(e){var t=r.get(e);return Object(M.a)(t)[1]};c>=0&&c<o;){var d=n[c],l=d.oofRollUpViewState.oofReplyNodeIds.some(s);if(!d.isExpanded&&(d.isLocal||l)){a=d;break}c+=u}a||(a=n[i]),a.isExpanded=!0,a.isFossilizedTextExpanded=!0}}(p,f,u,n),l=function(e,t){for(var n=e.length,r=0;r<n;r++){var o=e[r],a=o.itemId;if(t){if(a==t)return o.isExpanded=!0,{itemPart:o,focusedItemArea:S.a.Item}}else{if(o.isExpanded)return{itemPart:o,focusedItemArea:S.a.Item};if(o.oofRollUpViewState.isOofRollUpExpanded)return{itemPart:o,focusedItemArea:S.a.Oof}}}return null}(u,d),u.forEach((function(e){e.isExpanded&&Object(i.a)(e)})),Object(a.a)(t,u),Object(v.b)(t,O.a.CalendarCard)&&function(e){var t,n=e.length;if(0!=n)for(var r=0;r<n;r++){var o=e[r],a=o?o.itemId:null,i=b.a.items.get(a),c=Object(A.C)();if(i&&Object(m.m)(i)&&(null==c||!c.highlightTerms))if(i.IsRead||i.IsOutOfDate)o.isExpanded=!1,o.isFossilizedTextExpanded=!1;else if(Object(m.q)(i.ItemClass)){var u=i;"NewMeetingRequest"==u.MeetingRequestType&&!Object(E.f)(u.Preview)||(null===(t=u.ChangeHighlights)||void 0===t?void 0:t.HasBodyChanged)?o.isExpanded=!0:(o.isExpanded=!1,o.isFossilizedTextExpanded=!1)}else!Object(m.r)(i.ItemClass)&&!Object(m.l)(i.ItemClass)||Object(E.f)(i.Preview)?(o.isExpanded=!1,o.isFossilizedTextExpanded=!1):o.isExpanded=!0}}(u),u.length){var g=p?0:e.conversationNodeIds.length-1,j=e.conversationNodeIds[g],C=s.has(j);e.canLoadMore&&(t.nodeIdBundledWithSeeMoreMessages=j),Object(x.a)(t.conversationId.Id)||I(t,u,e.canLoadMore&&!C)}}return l}t.a=Object(f.select)({loadedConversation:function(e){return b.a.conversations.get(e)},conversationNodes:function(){return b.a.conversationNodes},conversationReadingPaneState:function(e){return Object(C.a)(e)},items:function(){return b.a.items}})(Object(f.action)("firstLoadConversationReadingPane")((function(e,t){if(t.conversationReadingPaneState.conversationId.Id==e){var n=t.conversationReadingPaneState;if(n.loadingState.isLoading=!1,n.loadingState.hasLoadFailed=t.loadedConversation.loadingState.hasLoadFailed,!n.loadingState.hasLoadFailed){var r=Object(R.c)(e);if(n.unsupportedItemId=r,!r){var a=N(t.loadedConversation,n,t.conversationNodes,t.items);n.initiallySelectedItemPart=n.focusedItemPart=a,Object(o.a)(n)}}}})))},6354:function(e,t,n){"use strict";var r=n(6355),o=n(283);t.a=Object(o.action)("tryAddOofNodesInRollUp")((function(e,t,n,o){o&&e.forEach((function(e){e.oofRollUpViewState.oofReplyNodeIds=[]})),n.forEach((function(n){var o=e.get(n);if(o&&o.oofRollUpViewState.isOofItem){o.isInRollUp=!1;var a=Object(r.a)(n,e,t);a&&!a.isInRollUp&&(o.isInRollUp=!0,a.oofRollUpViewState.oofReplyNodeIds.push(n))}}))}))},6355:function(e,t,n){"use strict";function r(e,t,n){var r=n.get(e);return r?t.get(r.parentInternetMessageId):null}n.d(t,"a",(function(){return r}))},6356:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(7238),o=n(9);function a(e){var t;if((null==e?void 0:e.RightsManagedMessageDecryptionStatus)&&0!=e.RightsManagedMessageDecryptionStatus)switch(e.RightsManagedMessageDecryptionStatus){case-2147160052:case-2147160012:case-2147160011:t=Object(o.c)(Object(o.b)(r.d),i());break;case-2147160010:t=Object(o.b)(r.a);break;case-2147168507:t=Object(o.c)(Object(o.b)(r.l),i());break;case-2147160014:t=Object(o.b)(r.j);break;case-2147160054:case-2147160055:t=Object(o.b)(r.h);break;case-2147160064:case-2147160013:t=Object(o.b)(r.g);break;case-2147160051:t=Object(o.b)(r.c);break;case-2147160060:t=Object(o.b)(r.k);break;case-2147160009:default:t=Object(o.c)(Object(o.b)(r.i),e.RightsManagedMessageDecryptionStatus)}return t}function i(){var e=Object(o.c)('<a href="{0}" target="_blank">{1}</a>',Object(o.b)(r.f),Object(o.b)(r.e));return Object(o.c)(Object(o.b)(r.b),e)}},6357:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var r=/ipm.note.rules.ooftemplate.microsoft/i;function o(e){return{isOofItem:r.test(e),oofReplyNodeIds:[],isOofRollUpExpanded:!1}}},6363:function(e,t,n){"use strict";var r=n(5391),o=n(2417),a=n(1193),i=n(2770),c=n(254),u=n(123),s=n(1727),d=n(965),l=n(3141),f=n(283);t.a=Object(u.d)("loadMore",o.a.RPCountLoadMore)(Object(f.select)({conversations:function(){return d.a.conversations},conversationReadingPaneViewState:function(e){return Object(a.a)(e.Id)}})((function(e,t){if(e&&t.conversations.has(e.Id)){var n=t.conversations.get(e.Id);n.isLoadMoreInProgress=!0,n.maxItemsToReturn=n.maxItemsToReturn+s.a,n.syncState="";var o=Object(c.q)();return o&&o.addCustomData([(a=n.maxItemsToReturn,u=Math.ceil((a-20)/10),Object(l.a)(u))]),Object(i.b)(t.conversationReadingPaneViewState)&&Object(r.a)(t.conversationReadingPaneViewState,!0),s.d.importAndExecute(e,"LoadMore")}var a,u;return Promise.resolve()})))},6384:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(1186),o=n(947),a=n(1158),i=n(1386);function c(e){var t=Object(a.a)(),n=Object(o.A)([e],t)[0];t.rowKeys.includes(n)&&Object(r.r)(t,n,!0,i.a.RouteHandler)}},6518:function(e,t,n){"use strict";var r=n(0),o=n(4136),a=n(965);function i(e,t){if(e.itemPartsMap.size<=1)return!1;if(function(e){if(!e)return!1;var t=a.a.conversations.get(e.conversationId.Id);return null==t?void 0:t.canLoadMore}(e))return!0;for(var n=Object(r.__spread)(e.itemPartsMap.keys()),o=0;o<n.length;o++){var i=e.itemPartsMap.get(n[o]);if(i){var c=t.get(i.itemId);if(c&&c.Attachments)return!0}}return!1}var c=n(1997),u=n(1235),s=n(1987),d=n(283);t.a=Object(d.action)("initializeAttachmentsForConversationWell")(Object(d.select)({mailStoreItems:function(){return a.a.items}})((function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a,d,l,f,b,m,v,O;return Object(r.__generator)(this,(function(p){switch(p.label){case 0:return i(e,t.mailStoreItems)?e.attachmentWell?[3,4]:[4,s.c.importAndExecute(e.conversationId)]:[3,11];case 1:return n=r.__read.apply(void 0,[p.sent(),3]),a=n[0],d=n[1],l=n[2],[4,u.l.import()];case 2:return f=p.sent(),e.attachmentWell=f(d,l),[4,u.n.importAndExecute(a,e.conversationId.mailboxInfo,e.attachmentWell,!0,!1)];case 3:p.sent(),p.label=4;case 4:b=Object(r.__spread)(e.itemPartsMap.keys()),m=0,p.label=5;case 5:return m<b.length?(v=e.itemPartsMap.get(b[m]))&&(O=t.mailStoreItems.get(v.itemId))?[4,Object(o.a)(v,O,!1)]:[3,8]:[3,9];case 6:return p.sent(),[4,u.o.importAndExecute(v.attachmentWell,e.attachmentWell,Object(r.__assign)(Object(r.__assign)({},O.ItemId),{mailboxInfo:O.MailboxInfo}),O.DateTimeReceived)];case 7:p.sent(),p.label=8;case 8:return m++,[3,5];case 9:return[4,u.s.importAndExecute(e.attachmentWell,Object(c.a)())];case 10:p.sent(),p.label=11;case 11:return[2]}}))}))})))},6578:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(108),o=new r.c((function(){return Promise.all([n.e(0),n.e(705),n.e(355)]).then(n.bind(null,8159))})),a=new r.a(o,(function(e){return e.subscribeToBulkActionNotification})),i=new r.a(o,(function(e){return e.findBulkActionItemAction}))},715:function(e,t,n){var r=n(716),o=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)o.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},716:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,"._3k2DZQclSrOtYR-5XBK9RP{width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}",""]),t.locals={view:"_3k2DZQclSrOtYR-5XBK9RP"}},7237:function(e,t,n){"use strict";var r=n(0),o=n(3702),a=n(3227),i=n(3367),c=n(1292),u=n(1130),s=n(1962),d=n(283),l=n(947);t.a=Object(d.select)({composeViewState:function(){return u.a.viewStates.get(u.a.primaryComposeId)},conversationItems:function(){return l.T.conversationItems}})(Object(d.action)("reloadReadingPane")((function(e){var t,n,u=Object(l.C)(),d=u?Object(r.__spread)(u.selectedRowKeys.keys()):[];if(1==d.length){var f=l.b.getRowClientItemId(d[0],u),b=Object(s.a)(d,u)[0];switch(u.tableQuery.listViewType){case 0:var m=e.conversationItems.get(f.Id);(null===(t=e.composeViewState)||void 0===t?void 0:t.isInlineCompose)?c.r.importAndExecute(e.composeViewState).then((function(){Object(o.b)(f,b,m.subject)})):Object(o.b)(f,b,m.subject);break;case 1:(null===(n=e.composeViewState)||void 0===n?void 0:n.isInlineCompose)?c.r.importAndExecute(e.composeViewState).then((function(){Object(a.a)(f,b,i.a)})):Object(a.a)(f,b,i.a)}}})))},7238:function(e){e.exports=JSON.parse('{"d":"Irb","a":"Jrb","l":"Krb","j":"Lrb","h":"Mrb","g":"Nrb","c":"Orb","k":"Prb","i":"Qrb","f":"Rrb","e":"Srb","b":"Trb"}')},7296:function(e,t,n){"use strict";var r=n(4),o=Object(r.action)("ON_CONVERSATION_OPTION_SAVED");t.a=o},7890:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("UPDATE_LOADED_CONVERSATION_READING_PANE",(function(e,t){return{conversationId:e,nodeIdCollectionChanged:t}}))},7951:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("ON_KEYBOARD_UP_DOWN",(function(e,t,n,r){return{selectionDirection:e,tableView:t,mailListItemSelectionSource:n,shouldSelect:r}}))},7952:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("ON_KEYBOARD_TOGGLE_SELECT",(function(e,t){return{tableView:e,mailListItemSelectionSource:t}}))},7953:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("ON_KEYBOARD_UP_DOWN",(function(e,t,n,r){return{tableView:e,selectedNodeIds:t,selectedRowKeys:n,mailListItemSelectionSource:r}}))},9025:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("ON_ITEM_PART_SELECTED",(function(e,t){return{conversationNodeId:e,conversationId:t}}))},9172:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(4),o=Object(r.action)("CONFIRM_TIMEZONE")},9173:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(4),o=n(5916),a=n(9),i=n(27),c=Object(r.action)("SEND_AN_EMAIL",(function(){return{taskSendEmailSubject:Object(a.c)(Object(a.b)(o.o),Object(i.a)().SessionSettings.UserEmailAddress),taskSendEmailBody:Object(a.c)(Object(a.b)(o.n),Object(i.a)().SessionSettings.UserEmailAddress)}}))},9174:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(4),o=Object(r.action)("ADD_STORAGE_ACCOUNT")},9175:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(4),o=Object(r.action)("SHOW_PERSONALIZATION_MODAL")},9177:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(4),o=Object(r.action)("COMPLETE_SEND_AN_EMAIL")},9178:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(4),o=Object(r.action)("COMPLETE_PERSONALIZATION")},9194:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4801),o=n(6384);function a(e,t){Object(r.a)(e),Object(o.a)(t)}},960:function(e,t,n){"use strict";var r=n(108),o=n(1232),a=n(988),i=n(4),c=[a.a.SurfaceActions];Object(i.orchestrator)(o.a,(function(e){var t=e.defaultOptions;c.forEach((function(e){t[e]&&Object(a.f)(Number(e),t[e])}))}));var u=n(1017);n.d(t,"e",(function(){return d})),n.d(t,"h",(function(){return l})),n.d(t,"f",(function(){return f})),n.d(t,"g",(function(){return b})),n.d(t,"c",(function(){return u.a})),n.d(t,"d",(function(){return a.d})),n.d(t,"b",(function(){return a.b})),n.d(t,"a",(function(){return a.a}));var s=new r.c((function(){return n.e(440).then(n.bind(null,15122))})),d=new r.a(s,(function(e){return e.createOrUpdateOptionsForFeature})),l=new r.a(s,(function(e){return e.updateAddinPinStatus})),f=new r.b(s,(function(e){return e.getServerOptionsForFeature})),b=new r.a(s,(function(e){return e.loadOptions}))},9935:function(e,t,n){"use strict";var r=n(108),o=n(2072),a=n(3498),i=n(947);function c(e,t,n,r){if(1!=e.length)return{rowKeys:e};var o=e[0];return{uniqueSenders:i.b.getUniqueSenders(o,t),lastSenderMailbox:i.b.getLastSenderMailbox(o,t),folderId:r,rowKeys:[o]}}n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var u=new r.c((function(){return Promise.all([n.e(45),n.e(594)]).then(n.bind(null,15101))}));function s(){Object(r.f)(o.d,u,(function(e){return e.postTriagePatternsOrchestrator})),Object(r.f)(o.d,u,(function(e){return e.showSuggestionOnTriageAction})),Object(r.f)(a.a,u,(function(e){return e.postTriagePatternsOnSearch}))}}}]);
//# sourceMappingURL=owa.MailFunctionalBoot.js.map
self.scriptsLoaded['owa.MailFunctionalBoot.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailFunctionalBoot.js'] = (new Date()).getTime();