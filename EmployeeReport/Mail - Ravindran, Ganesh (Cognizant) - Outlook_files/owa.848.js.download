self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.848.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[848],{1023:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return p}));var s=n(1147),a=n(1003),i=n(967),r=n(314),o=n(5),c="email",u="personId",l="UA",h="size",d="/service.svc/s/GetPersonaPhoto";function f(e,t,n,i){if(Object(a.a)()&&e)return Object(s.a)(e,n);var r=Object(o.a)().baseUrl,f="";return e&&(f=m(f,c,e&&e.toLowerCase())),t&&(f=m(f,u,t)),f=m(f,l,"0"),f=m(f,h,i?"HR96x96":"HR64x64"),""+r+d+"?"+f}function p(e,t,n){return Object(a.a)()?Object(s.a)(e,t):"https://cid-"+e+".users.storage.live.com/users/0x"+e+"/myprofile/expressionprofile/profilephoto:"+function(e){switch(e){case i.c.tiny:case i.c.extraExtraSmall:case i.c.extraSmall:case i.c.small:case i.c.regular:case i.c.large:case i.c.size10:case i.c.size8:case i.c.size16:case i.c.size24:case i.c.size28:case i.c.size32:return"UserTileStatic,UserTileSmall";case i.c.extraLarge:case i.c.size40:case i.c.size48:case i.c.size56:case i.c.size72:case i.c.size100:case i.c.size120:return"UserTileMedium,UserTileStatic,UserTileSmall";default:return Object(r.a)(e)}}(n)+"/MeControlMediumUserTile?ck=1&ex=24&fofoff=1"}function m(e,t,n){n&&(n=encodeURIComponent(n));var s=t+"="+n;return e&&(s=e+"&"+s),s}},1147:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var s=n(9),a="/profile/v1.0/{0}/{1}/image/$value";function i(e,t){var n=e.indexOf("@")>-1,i="GroupMailbox"==t?"groups":"users";return Object(s.c)(a,i,n?e:"cid:"+e)}},1497:function(e,t,n){"use strict";function s(e,t,n,s,a,i){return{emailAddress:n,hexConsumerIdForUser:t,personaId:s,name:e,personaBlob:{blobUrl:null,isPendingFetch:!1,hasFetchFailed:!1},size:a,mailboxType:i}}n.d(t,"a",(function(){return s}))},1809:function(e,t,n){"use strict";n.r(t);var s=n(1023),a=n(283);function i(e,t){e.isPendingFetch=!1,document.body.removeChild(t)}var r=Object(a.action)("onConsumerPhotoLoad")((function(e,t,n){t.hasFetchFailed=n.width<5||n.height<5,t.blobUrl=t.hasFetchFailed?null:e,i(t,n)})),o=Object(a.action)("onConsumerPhotoError")((function(e,t){e.hasFetchFailed=!0,i(e,t)}));var c=n(4017),u=n(1497),l=n(957),h=n(1176),d=n(1003),f=n(1033),p=Object(a.select)({personaViewStates:function(){return l.a.viewStates}})(Object(a.action)("getPersonaPhoto")((function(e,t,n,a,i,l,p,m){var b=Object(h.a)(t,n,a,l,e);m.personaViewStates.has(b)||m.personaViewStates.set(b,Object(u.a)(e,i||Object(f.a)(t),t,n,a,l));var k=m.personaViewStates.get(b);!Object(d.a)()&&k.hexConsumerIdForUser?function(e){var t=e.personaBlob;if(!t.isPendingFetch&&!t.hasFetchFailed){var n=Object(s.b)(e.hexConsumerIdForUser,e.mailboxType,e.size),a=document.createElement("img");a.src=n,a.onload=function(){return r(n,t,a)},a.onerror=function(){return o(t,a)},a.style.visibility="hidden",document.body.appendChild(a)}}(k):c.a.add({name:e,emailAddress:t,personaId:n,size:a,mailboxType:l,skipLoadingPhoto:p})})));n.d(t,"getPersonaPhoto",(function(){return p}))},4017:function(e,t,n){"use strict";var s=n(482),a=n(108),i=new a.c((function(){return Promise.all([n.e(4),n.e(472)]).then(n.bind(null,14859))})),r=new a.a(i,(function(e){return e.downloadPersonaPhoto})),o=n(957),c=n(1176),u=new s.a(3,(function(e){var t=Object(c.a)(e.emailAddress,e.personaId,e.size,e.mailboxType,e.name),n=o.a.viewStates.get(t);return r.importAndExecute(n,!1,e.skipLoadingPhoto)}),500);t.a=u},482:function(e,t,n){"use strict";var s=function(){function e(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}return e.prototype.add=function(e){this.taskList.unshift(e),this.scheduleTask()},e.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},e.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},e.prototype.scheduleTask=function(){var e=this;this.canRunMoreTasks()&&setTimeout((function(){e.tryRunTask()}),this.taskDelay)},e.prototype.tryRunTask=function(){this.canRunMoreTasks()&&this.runTask()},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e.prototype.runTask=function(){var e=this,t=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(t).then((function(){e.onTaskComplete()})).catch((function(){e.onTaskComplete()})),this.scheduleTask()},e}();n.d(t,"a",(function(){return s}))}}]);
//# sourceMappingURL=owa.848.js.map
self.scriptsLoaded['owa.848.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.848.js'] = (new Date()).getTime();