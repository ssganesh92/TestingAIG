self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.RetentionPolicies.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[516],{10594:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(4),c=Object(i.action)("ON_ARCHIVE_TAG_FOR_FOLDER_CHANGED",(function(e,t,n){return{folder:e,tagValue:t,actionSource:n}})),a=Object(i.action)("ON_DELETE_TAG_FOR_FOLDER_CHANGED",(function(e,t,n){return{folder:e,tagValue:t,actionSource:n}})),o=Object(i.action)("ON_ARCHIVE_TAG_FOR_FOLDER_UPDATE_SUCCESS",(function(e,t){return{folder:e,archiveTag:t}})),s=Object(i.action)("ON_DELETE_TAG_FOR_FOLDER_UPDATE_SUCCESS",(function(e,t){return{folder:e,deleteTag:t}})),u=Object(i.action)("ON_RETENTION_TAG_FOR_ITEMS_UPDATE_SUCCESS",(function(e,t,n){return{tag:e,isArchiveTag:t,itemIds:n}})),l=Object(i.action)("ON_RETENTION_TAG_FOR_ITEMS_CHANGED",(function(e,t,n,r,i){return{isArchiveTag:e,tagValue:t,itemIds:n,actionSource:r,mailboxInfo:i}})),d=Object(i.action)("ON_RETENTION_TAG_FOR_CONVERSATIONS_CHANGED",(function(e,t,n,r,i,c,a){return{isArchiveTag:e,tagValue:t,folderId:n,conversationActionContexts:r,itemIds:i,actionSource:c,mailboxInfo:a}})),f=n(948),v=n(3073);var b=n(964),h=n(4084),g="ArchivePolicyParentRow",p="DeletePolicyParentRow",_="FolderArchiveTag";function O(e,t,n){var i,c={Path:Object(b.a)({FieldURI:t}),Folder:n?t===_?Object(h.a)({ArchiveTag:n}):Object(h.a)({PolicyTag:n}):null},a=[n?Object(v.a)(c):(i=c,Object(r.__assign)({__type:"DeleteFolderField:#Exchange"},i))];return f.N.importAndExecute(e,a)}var y=n(79),I=n(254);function T(e){var t=e.isArchiveTag,n=e.actionSource,r=e.responseClass;Object(I.o)("TnS_RetentionPolicySelected",[t,n,r])}function j(e){var t=e.folder,n=e.retentionId,r=e.inheritSubMenuIdentifier,i=r===g?t.ArchiveTag:t.PolicyTag;return!!i&&n!=i.Value||!i&&n!=r}Object(i.orchestrator)(c,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i,c,a,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(t=e.folder,n=e.tagValue,i=e.actionSource,!j({folder:t,retentionId:n,inheritSubMenuIdentifier:g}))return[2];r.label=1;case 1:return r.trys.push([1,3,,4]),c=n===g?null:{Value:n,IsExplicit:!0},[4,O(t.DistinguishedFolderId||t.FolderId.Id,_,c)];case 2:return"Success"===(a=r.sent()).ResponseClass&&o(t,c),T({isArchiveTag:!0,actionSource:i,responseClass:a.ResponseClass}),[3,4];case 3:return s=r.sent(),y.d("Error while updating folder archive tag"+s),[3,4];case 4:return[2]}}))}))})),Object(i.orchestrator)(a,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i,c,a,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(t=e.folder,n=e.tagValue,i=e.actionSource,!j({folder:t,retentionId:n,inheritSubMenuIdentifier:p}))return[2];r.label=1;case 1:return r.trys.push([1,3,,4]),c=n===p?null:{Value:n,IsExplicit:!0},[4,O(t.DistinguishedFolderId||t.FolderId.Id,"FolderPolicyTag",c)];case 2:return"Success"===(a=r.sent()).ResponseClass&&s(t,c),T({isArchiveTag:!1,actionSource:i,responseClass:a.ResponseClass}),[3,4];case 3:return o=r.sent(),y.d("Error while updating folder delete tag"+o),[3,4];case 4:return[2]}}))}))}));var C=n(1569),m=n(553),A=n(2342),P=n(2379),S=n(246),R=n(1920),E=n(1691),k=n(2037),N=n(1653);function x(e,t,n,i){var c=function(e,t,n){var i,c=t?"ItemArchiveTag":"ItemPolicyTag",a=t?"ArchiveTag":"PolicyTag",o=[n?Object(E.a)({Path:Object(b.a)({FieldURI:c}),Item:Object(R.a)((i={},i[a]=n,i))}):Object(k.a)({Path:Object(b.a)({FieldURI:c})})],s=[];return e.forEach((function(e){return s.push(Object(C.a)({Updates:o,ItemId:Object(m.a)({Id:e})}))})),Object(P.a)(Object(r.__assign)({ItemChanges:s,ConflictResolution:"AlwaysOverwrite",MessageDisposition:"SaveOnly",SuppressReadReceipts:!1,ClientSupportsIrm:!0,SendCalendarInvitationsOrCancellations:"SendToNone"},Object(N.a)()))}(e,t,n);return Object(A.a)({Header:Object(S.a)(),Body:c},i).then((function(e){return e.Body.ResponseMessages.Items[0]}))}Object(i.orchestrator)(l,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i,c,a,o,s,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t=e.isArchiveTag,n=e.tagValue,i=e.itemIds,c=e.actionSource,a=e.mailboxInfo,[4,x(i,t,o=n===g||n===p?null:{Value:n,IsExplicit:!0},a.requestOptions)];case 1:return"Success"==(s=r.sent()).ResponseClass&&u(o,t,i),T({isArchiveTag:t,actionSource:c,responseClass:s.ResponseClass}),[3,3];case 2:return l=r.sent(),y.d("Error while updating item retention tag "+l),[3,3];case 3:return[2]}}))}))}));var F=n(3277),w=n(3278),D=n(1020),M=n(297),V=n(431),L=n(3294),H=n(950);function U(e,t,n,r,i){var c=function(e,t,n,r){var i=e.map((function(e){return function(e,t,n,r){var i=Object(w.a)({Action:"SetRetentionPolicy",ConversationId:Object(m.a)({Id:e.conversationId}),RetentionPolicyType:n});t&&(i.RetentionPolicyTagId=t);if(r){var c=Object(D.a)({BaseFolderId:(a=r,Object(H.a)(a)?Object(M.a)({Id:a}):Object(V.a)({Id:a}))});i.ContextFolderId=c}var a;return i}(e,t,n,r)}));return Object(F.a)({ConversationActions:i,ReturnMovedItemIds:!1})}(e,t,n,r);return Object(L.a)(c)}Object(i.orchestrator)(d,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i,c,a,o,s,l,d,f;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t=e.isArchiveTag,n=e.tagValue,i=e.folderId,c=e.conversationActionContexts,a=e.itemIds,o=e.actionSource,s=e.mailboxInfo,[4,U(c,(l=n===g||n===p)?null:n,t?1:0,i,s.requestOptions)];case 1:return"Success"==(d=r.sent()).ResponseClass&&u(l?null:{Value:n,IsExplicit:!0},t,a),T({isArchiveTag:t,actionSource:o,responseClass:d.ResponseClass}),[3,3];case 2:return f=r.sent(),y.d("Error while updating conversation retention tag"+f),[3,3];case 3:return[2]}}))}))}));Object(i.mutator)(o,(function(e){var t=e.folder,n=e.archiveTag;t.ArchiveTag=n})),Object(i.mutator)(s,(function(e){var t=e.folder,n=e.deleteTag;t.PolicyTag=n}));var G=n(963);Object(i.mutator)(u,(function(e){var t=e.itemIds,n=e.tag,r=e.isArchiveTag;t.forEach((function(e){var t=G.w.items.get(e);t&&(r?t.ArchiveTag=n:t.PolicyTag=n)}))}));var q=n(1082),B=n(947),J=n(953);var Q=n(11800),z=n(9),X=n(233),K=n(9128);function Z(e){var t=e.retentionId,n=e.displayName,r=e.isChecked,i=e.subMenuProps;return{key:t,text:n,data:t,onClick:e.onClickCallback,checked:r,itemProps:r?{styles:{label:K.checkedItem}}:null,iconProps:r?{iconName:"CheckMark",className:K.checkmark}:null,subMenuProps:i}}var $=n(11802);function W(e){var t=e.retentionId,n=e.retentionPolicyTags,r=e.folderType,i=e.isArchive,c=e.isChecked,a=e.onClickCallback,o=function(e,t){return 12==e?t?Object(z.b)($.a):Object(z.b)($.b):Object(z.b)($.c)}(r,i);return Z({retentionId:t,displayName:17!=r?function(e){var t=e.retentionPolicyTags,n=e.folderType,r=e.isArchive,i=e.defaultName;return t.reduce((function(e,t){return t.Type===n&&t.IsArchive==r?t.DisplayName:e}),i)}({retentionPolicyTags:n,folderType:r,isArchive:i,defaultName:o}):o,isChecked:c,subMenuProps:null,onClickCallback:a})}var Y=n(9128);function ee(e,t,n,r,i){var c=!1;return(12==r?[]:e.map((function(e){var r=e.RetentionId===n;return r&&(c=!0),Z({retentionId:e.RetentionId,displayName:e.DisplayName,isChecked:t&&r,subMenuProps:null,onClickCallback:i})}))).concat(W({retentionId:g,retentionPolicyTags:e,folderType:r,isArchive:!0,isChecked:t&&!c,onClickCallback:i}))}var te=n(11803);var ne=n(9128);function re(e,t,n,r,i,c){var a=!1;return(17!=r||"archive"===i?[]:function(e){var t={},n=e.filter((function(e){return null==e.ParentLabelIdentity||e.ParentLabelIdentity.length<=0})).reduce((function(e,n){var r={parentPolicyTag:n,childrenPolicyTags:[]};return e.push(r),t[n.RetentionId]=r,e}),[]);return e.filter((function(e){return null!=e.ParentLabelIdentity&&e.ParentLabelIdentity.length>0&&e.ParentLabelIdentity in t})).forEach((function(e){t[e.ParentLabelIdentity].childrenPolicyTags.push(e)})),n}(e).map((function(e){var r=function(e,t,n,r){var i=e.parentPolicyTag,c=e.childrenPolicyTags,a=i.RetentionId===n;if(null==c||0==c.length)return{item:Z({retentionId:i.RetentionId,displayName:i.DisplayName,isChecked:t&&a,subMenuProps:null,onClickCallback:r}),policyFound:a};var o=!1,s=c.map((function(e){var i=e.RetentionId===n;return i&&(o=!0),Z({retentionId:e.RetentionId,displayName:e.DisplayName,isChecked:t&&i,subMenuProps:null,onClickCallback:r})}));return{item:Z({retentionId:i.RetentionId,displayName:i.DisplayName,isChecked:t&&a,subMenuProps:{items:s},onClickCallback:null}),policyFound:o}}(e,t,n,c);return r.policyFound&&(a=!0),r.item}))).concat(W({retentionId:p,retentionPolicyTags:e,folderType:r,isArchive:!1,isChecked:t&&!a,onClickCallback:c}))}function ie(e){var t=e.retentionPolicyTagList,n=e.showTagSelection,i=e.selectedArchiveTag,c=e.selectedDeleteTag,a=e.treeType,o=e.distinguishedFolderId,s=e.hasArchive,u=e.onArchivePolicyClickedCallback,l=e.onDeletePolicyClickedCallback,d=[],f=s&&a!=J.c,v=function(e){switch(e){case"msgfolderroot":case"archivemsgfolderroot":return 12;case"deleteditems":case"archivedeleteditems":return 3;case"recoverableitemsdeletions":case"archiverecoverableitemsdeletions":return 18;case"calendar":return 1;case"contacts":return 2;case"conversationhistory":return 16;case"drafts":return 4;case"inbox":return 5;case"junkemail":return 6;case"journal":return 7;case"notes":return 8;case"outbox":return 9;case"sentitems":return 10;case"syncissues":return 15;case"tasks":return 11;case"none":default:return 17}}(o),b=t.filter((function(e){return e.IsVisible&&e.IsArchive})).sort(ce),h=t.filter((function(e){return e.IsVisible&&!e.IsArchive})).sort(ce);return f&&d.push.apply(d,Object(r.__spread)(function(e,t,n,r,i){var c=(null==n?void 0:n.IsExplicit)?n.Value:null;return[{key:"archiveSection",className:Y.sectionHeader,itemType:X.a.Section,sectionProps:{bottomDivider:!0,title:Object(z.b)(Q.a),items:ee(e,t,c,r,i)}}]}(b,n,i,v,u))),d.push.apply(d,Object(r.__spread)(function(e,t,n,r,i,c){var a=(null==n?void 0:n.IsExplicit)?n.Value:null;return[{key:"deleteSection",className:ne.sectionHeader,itemType:X.a.Section,sectionProps:{title:Object(z.b)(te.a),items:re(e,t,a,r,i,c)}}]}(h,n,c,v,o,l))),{items:d}}function ce(e,t){return e.RetentionPeriod&&t.RetentionPeriod?e.RetentionPeriod-t.RetentionPeriod:t.RetentionPeriod?1:-1}var ae=n(27),oe=n(1353);var se=n(1112);function ue(e,t,n){var i=B.T.tableViews.get(e);if(!i)return null;var c=function(e){if(e&&Object(q.e)(e.tableQuery)){var t=q.i.tryImportForRender();return t?t(e.tableQuery):[]}return Object(ae.a)().RetentionPolicyTags}(i);if(!c||!c.length)return null;var a=function(e){var t,n;if(e&&Object(q.e)(e.tableQuery))t=null,n="groups";else{var r=Object(oe.h)(e),i=r&&Object(f.o)().get(r);if(!i)return null;t=i.DistinguishedFolderId||i.FolderId.Id,n=i.treeType}return{folderId:t,treeType:n}}(i);if(!a)return null;var o,s,u,l=Object(r.__spread)(i.selectedRowKeys.keys());return n?(o=n.ArchiveTag,s=n.PolicyTag,u=!0):(o=1==l.length?B.b.getArchiveTag(l[0],i):null,s=1==l.length?B.b.getPolicyTag(l[0],i):null,u=1==l.length),ie({retentionPolicyTagList:c,showTagSelection:u,selectedArchiveTag:o,selectedDeleteTag:s,treeType:a.treeType,distinguishedFolderId:"none",hasArchive:le(i),onArchivePolicyClickedCallback:de({isArchivePolicyClicked:!0,tableView:i,selectedTag:o,folderId:a.folderId,clientItem:n,actionSource:t}),onDeletePolicyClickedCallback:de({isArchivePolicyClicked:!1,tableView:i,selectedTag:s,folderId:a.folderId,clientItem:n,actionSource:t})})}function le(e){return(!e||!Object(q.e)(e.tableQuery))&&!!Object(ae.a)().SessionSettings.HasArchive}function de(e){var t=e.isArchivePolicyClicked,n=e.tableView,i=e.selectedTag,c=e.folderId,a=e.clientItem,o=e.actionSource;return function(e,s){if(function(e){var t=e.retentionTag,n=e.retentionId,r=e.inheritSubMenuIdentifier;return!!t&&n!=t.Value||!t&&n!=r}({retentionTag:i,retentionId:s.data,inheritSubMenuIdentifier:t?g:p})){var u="RPCSAOverflow"==o||1===n.tableQuery.listViewType,f=Object(r.__spread)(n.selectedRowKeys.keys()),v=Object(se.b)(n);if(u){var b="RPCSAOverflow"==o?[a.ItemId.Id]:f.map((function(e){return Object(B.H)(e,n.id).clientId.Id}));l(t,s.data,b,o,v)}else{var h=f.map((function(e){return Object(B.h)(e,n.id)}));b=f.reduce((function(e,t){var i=Object(B.G)(t,n.id);return i&&e.push.apply(e,Object(r.__spread)(i.itemIds)),e}),[]);d(t,s.data,c,h,b,o,v)}}}}var fe=n(3901),ve=n(295);function be(e){if(Object(ve.a)())return null;var t=Object(ae.a)(),n=t.RetentionPolicyTags;return n&&0!==n.length?{key:"AssignPolicy",name:Object(z.b)(fe.a),disabled:!1,subMenuProps:ie(Object(r.__assign)(Object(r.__assign)({},e),{showTagSelection:!0,retentionPolicyTagList:n,hasArchive:!!t.SessionSettings.HasArchive}))}:null}n.d(t,"getAssignPolicyPropertiesForMailContextMenu",(function(){return ue})),n.d(t,"onArchiveTagForFolderChanged",(function(){return c})),n.d(t,"onDeleteTagForFolderChanged",(function(){return a})),n.d(t,"getRetentionPolicyMenuItem",(function(){return be}))},11800:function(e){e.exports=JSON.parse('{"a":"b_c"}')},11801:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,"._2Ij1xLT_HLp88M37zkVcqx{font-weight:600}html[dir] ._23f4dMU1_LGLt4GgPo3Lk9 .ms-ContextualMenu-header{padding:0 4px}._2XmjPcdNPHzJnErHgc7pg8{font-weight:700}",""]),t.locals={checkedItem:"_2Ij1xLT_HLp88M37zkVcqx",sectionHeader:"_23f4dMU1_LGLt4GgPo3Lk9",checkmark:"_2XmjPcdNPHzJnErHgc7pg8"}},11802:function(e){e.exports=JSON.parse('{"a":"c_c","b":"d_c","c":"e_c"}')},11803:function(e){e.exports=JSON.parse('{"a":"a_c"}')},1569:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ItemChange:#Exchange"},e)}},1653:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(27);function i(){var e=Object(r.a)().PolicySettings;return e?{OutboundCharset:e.OutboundCharset,UseGB18030:e.UseGB18030,UseISO885915:e.UseISO885915}:{OutboundCharset:"AutoDetect"}}},1691:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"SetItemField:#Exchange"},e)}},1920:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"Message:#Exchange"},e)}},2037:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"DeleteItemField:#Exchange"},e)}},2342:function(e,t,n){"use strict";var r=n(25),i=n(0);function c(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.__assign)({__type:"UpdateItemJsonRequest:#Exchange"},n)),Object(r.a)("UpdateItem",e,t)}n.d(t,"a",(function(){return c}))},2379:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"UpdateItemRequest:#Exchange"},e)}},3073:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"SetFolderField:#Exchange"},e)}},3277:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ApplyConversationActionRequest:#Exchange"},e)}},3278:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ConversationAction:#Exchange"},e)}},3294:function(e,t,n){"use strict";var r=n(0),i=n(420),c=n(25);function a(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"ApplyConversationActionJsonRequest:#Exchange"},n)),Object(c.a)("ApplyConversationAction",e,t)}function o(e,t,n){if(void 0===t&&(t=Object(i.b)()),!e||!e.ConversationActions||0===e.ConversationActions.length)throw new Error("ApplyConversationAction requestBody is invalid!");n=n||{};var c=Object(r.__assign)({},n),o=c.headers?new Headers(c.headers):new Headers;return o.set("X-OWA-ActionSource","ApplyConversationAction_"+e.ConversationActions[0].Action),c.headers=o,a({Header:t,Body:e},c).then((function(e){return e.Body.ResponseMessages.Items[0]})).catch((function(e){return Promise.reject(e)}))}n.d(t,"a",(function(){return o}))},4084:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"Folder:#Exchange"},e)}},420:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));var r=n(273),i=n(303),c=n(302),a=n(296);function o(e){return Object(r.a)({RequestServerVersion:"Exchange2015",TimeZoneContext:Object(i.a)({TimeZoneDefinition:Object(c.a)({Id:null!=e?e:"Pacific Standard Time"})})})}function s(e,t,n){return Object(a.a)({PropertySetId:e,PropertyName:t,PropertyType:n})}},9128:function(e,t,n){var r=n(11801),i=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var c=0;c<r.length;c++)i.loadStyles(r[c][1],!1);r.locals&&(e.exports=r.locals)}}]);
//# sourceMappingURL=owa.RetentionPolicies.js.map
self.scriptsLoaded['owa.RetentionPolicies.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.RetentionPolicies.js'] = (new Date()).getTime();