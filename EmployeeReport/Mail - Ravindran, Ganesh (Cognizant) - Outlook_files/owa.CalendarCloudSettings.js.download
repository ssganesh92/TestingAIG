self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.CalendarCloudSettings.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[171],{1086:function(e,n,t){"use strict";t.d(n,"a",(function(){return o})),t.d(n,"b",(function(){return a}));var r=t(4),i=t(24),o=Object(r.createStore)("lightningState",{unseenItems:new i.ObservableMap,lightedCount:0,lastShownId:null}),a=o()},1207:function(e,n,t){"use strict";var r=t(0),i=t(42),o=t(1255),a=t(1),u=t.n(a);function c(e,n){var t=function(n,t){return u.a.createElement(l,Object(r.__assign)({},n),u.a.createElement(e,Object(r.__assign)({},n)))};return t.displayName=e.displayName,n?u.a.forwardRef(t):t}var l=Object(i.a)((function(e){var n=e.lid,t=e.when,r=e.series,i=e.children;return u.a.useEffect((function(){return Object(o.b)(n,t,r),function(){o.c.importAndExecute(n)}}),[]),i&&d(n)?u.a.createElement(u.a.Fragment,null,i):null}));function s(e,n){o.c.importAndExecute(e,n)}function d(e){if(o.d.unseenItems){var n=o.d.unseenItems.get(e);if(null==n?void 0:n.visible)return!0}return!1}t.d(n,"c",(function(){return c})),t.d(n,"a",(function(){return l})),t.d(n,"d",(function(){return s})),t.d(n,"e",(function(){return d})),t.d(n,"b",(function(){return o.a}))},1255:function(e,n,t){"use strict";var r=t(108),i=t(1086),o=t(79),a=t(0),u=t(3),c=t(24),l=t(4),s=Object(l.mutatorAction)("initializeLightning",(function(e){var n,t;if(o.g.info("initialize lightning store"),Object(i.a)().lastShownId=null,Object(i.a)().lightedCount=0,Object(i.a)().unseenItems=new c.ObservableMap,e)try{for(var r=Object(a.__values)(e),u=r.next();!u.done;u=r.next()){var l=u.value;Object(i.a)().unseenItems.set(l.identity,l)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(t=r.return)&&t.call(r)}finally{if(n)throw n.error}}}));var d=t(287),f="ows/v1.0/lightning/items/unseen";function b(){return o.g.info("initialize lightning from server"),Object(d.b)(f).then((function(e){var n=e.map(v);s(n)}))}function v(e){return e.category?{identity:e.id,visible:!1,category:e.category}:{identity:e,visible:!1}}var g,O=t(27),h=t(76),m="lightning",j="UnseenLightening";function E(){var e,n,t;if(!g){var r=Object(u.a)(m);if(r)g=function(e){o.g.info("initialize lightning from override query parameter");var n=e.split(",").map((function(e){return{identity:e,visible:!1}}));return s(n),Promise.resolve()}(r);else{var i=Object(O.a)().PrimeSettings;if(Object(h.h)("lightning-initFromSD")&&i&&i.Items)try{for(var c=Object(a.__values)(i.Items),l=c.next();!l.done;l=c.next()){var d=l.value;if(d.Id===j&&d.Value){t=d.Value,o.g.info("initialize lightning from session data"),s(t.map((function(e){return{identity:e.id,visible:!1,category:e.category}}))),g=Promise.resolve();break}}}catch(n){e={error:n}}finally{try{l&&!l.done&&(n=c.return)&&n.call(c)}finally{if(e)throw e.error}}g||(g=b())}}return g}var p=t(1855),y=Object(l.action)("lightup",(function(e){return{id:e}})),S=y;Object(l.mutator)(y,(function(e){o.g.info("lightup - id:"+e.id),Object(i.a)().lastShownId=e.id,Object(i.a)().lightedCount++;var n=Object(i.a)().unseenItems.get(e.id);n&&(n.visible=!0)})),Object(l.orchestrator)(y,(function(e){Object(p.a)("LIGHTUP",e.id)}));var C,I=t(556);function w(e,n){(o.g.info("lightupOrReject - id:"+e+", recurrenceCount:"+n+", lightedCount:"+Object(i.a)().lightedCount+", lastShown:"+Object(i.a)().lastShownId),Object(I.v)())?o.g.info("lightning is disabled for deeplink"):Object(i.a)().unseenItems.has(e)&&(!Object(i.a)().lastShownId||function(e,n){var t=!1,r=Object(i.a)().lastShownId;if(r&&n&&!function(){var e=Object(i.a)(),n=e.lastShownId,t=e.unseenItems;return n&&t.has(n)&&t.get(n).visible}()){var o=n.indexOf(r),a=n.indexOf(e);o>=0&&o+1==a&&(t=!0)}return t}(e,n)||function(e){var n=Object(i.a)().unseenItems.get(e);return!!n&&n.category==C.UIFeatureDiscovery}(e))&&S(e)}function R(e,n,t){o.g.info("beginLightning - id:"+e),n((function(){E().then((function(){return w(e,t)})).catch((function(n){o.g.warn("something is wrong, lightning id:"+e+", reason:"+n)}))}))}!function(e){e.None="0",e.UpSell="1",e.FeatureDiscovery="2",e.TeachingMoment="3",e.UITeachingMoment="4",e.UIFeatureDiscovery="5",e.UIUpSell="6",e.JITNewUser="7",e.Compliance="8",e.SatCoreMetric="9",e.UpSellExperiment="10"}(C||(C={}));var B=t(1266);t.d(n,"c",(function(){return U})),t.d(n,"d",(function(){return i.b})),t.d(n,"b",(function(){return R})),t.d(n,"a",(function(){return B.a}));var F=new r.c((function(){return t.e(360).then(t.bind(null,15282))})),U=new r.a(F,(function(e){return e.endLightningImp}))},1266:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e.UserVoiceSatisfactionFirstRun="0",e.UserVoiceSatisfactionSecondRun="1",e.ConsumerRefreshFRE="2",e.AnimatedConsumerRefreshFRE="3",e.AnimatedConsumerRefreshFRE2="4",e.SettingPanelFirstRunCallout="5",e.SettingIconFirstRunCallout="6",e.AddStorageAccountCallout="7",e.PremiumDomainConnectModal="8",e.WhatsNewFlexPane="10",e.FocusOtherOff="12",e.TargetedAdsGdprPrompt="13",e.WebPushPromotion="14",e.MailGraduatedNewFeatureCarousel="15",e.EdgePromotion="20",e.ActionableMessageTeachingUiTeachingBubblePolicy="21",e.GetStartedFlexPane="22",e.CalendarSurvey="23",e.EnterpriseOptInFRE="24",e.MiniUserSurveyV1="25",e.TodoCalendarFRE="26",e.TodoMailFRE="27",e.GroupFilesHubFRE="28",e.AddCloudCacheAccountCallout="29",e.NewConsumerRecruitmentCampaign="30",e.InboxPlusFRE="31",e.BusinessCutoverCarousel="32",e.SuiteNps="33",e.InboxPlusEasyOn="34",e.InboxRulesFromDL="35",e.GdprAdsV2="36",e.TimePanelCombinedDndFRE="47",e.UaeEduPrivacyNotification="48",e.OutlookSpacesFRE="49",e.TodoFlaggedEmailList="50",e.DynamicLayoutFolderPaneCollapse="51",e.EdgeUpsell="56",e.OutlookSpacesCapturedPaneFRE="57",e.ProofingTeachingFreeUserFRE="58",e.ProofingTeachingPremiumUserFRE="59",e.OutlookSpacesNotePaneFRE="60",e.OutlookSpacesTasksPaneFRE="61",e.OutlookSpacesGoalsPaneFRE="62",e.DefaultOnlineMeetingSetting="63",e.QuickUseFRE="64",e.GdprAdsV3="65",e.SpeedyMeetingsEndEarlySetting="66",e.InboxPlusEasyOff="67"}(r||(r={}))},15041:function(e,n,t){"use strict";t.r(n);var r,i,o,a,u=t(647),c=t(310),l=t(4),s=(Object(l.mutator)(u.e,(function(e){Object(c.a)().shouldEventsEndEarly=e.shouldEventsEndEarly})),Object(l.mutator)(u.c,(function(e){Object(c.a)().endShortEventsBy=e.endShortEventsBy})),Object(l.mutator)(u.b,(function(e){Object(c.a)().endLongEventsBy=e.endLongEventsBy})),Object(l.mutator)(u.a,(function(e){Object(c.a)().enableOnlineMeetingsByDefault=e.enableOnlineMeetingsByDefault})),Object(l.mutator)(u.d,(function(e){Object(c.a)().isOnlineMeetingsByDefaultSynced=e.isOnlineMeetingsByDefaultSynced})),t(0)),d=Object(l.action)("initCalendarCloudSettings"),f=Object(l.action)("saveCalendarCloudSettings",(function(e){return{calendarCloudSettings:e}})),b="/ows/beta/OutlookCloudSettings/settings/";!function(e){e.ShouldEventsEndEarly="Should_Event_End_Early",e.EndShortEventsBy="End_Short_meetings_by",e.EndLongEventsBy="End_long_meetings_by",e.EnableOnlineMeetingsByDefault="onlinemeetings_enabledbydefault"}(r||(r={})),function(e){e.Bool="Bool",e.Int="Int"}(i||(i={})),function(e){e.Global="global",e.Account="account"}(o||(o={})),function(e){e.RoamingSetting="roamingsetting"}(a||(a={}));var v=t(287);function g(){var e,n=Object.values(r).join(),t=(e=n,""+b+o.Global+"?settingname="+e);return Object(v.b)(t).then((function(e){return e?(e.forEach((function(e){if(e.name&&e.value)switch(e.name.toLowerCase()){case r.ShouldEventsEndEarly.toLowerCase():n="true"===e.value.toLowerCase();break;case r.EndShortEventsBy.toLowerCase():t=+e.value;break;case r.EndLongEventsBy.toLowerCase():i=+e.value;break;case r.EnableOnlineMeetingsByDefault.toLowerCase():o="true"===e.value.toLowerCase()}})),null==n&&null==t&&null==i&&null==o?null:{shouldEventsEndEarly:n,endShortEventsBy:t,endLongEventsBy:i,enableOnlineMeetingsByDefault:o}):null;var n,t,i,o}))}var O=t(616),h=t(76),m=t(1255),j=t(1207);function E(e){e()}var p=t(615);function y(e){e()}var S=t(662);function C(e){var n=function(e){var n=[];null!=e.shouldEventsEndEarly&&n.push({name:r.ShouldEventsEndEarly,value:e.shouldEventsEndEarly,type:i.Bool,scope:o.Global});null!=e.endShortEventsBy&&n.push({name:r.EndShortEventsBy,value:e.endShortEventsBy,type:i.Int,scope:o.Global});null!=e.endLongEventsBy&&n.push({name:r.EndLongEventsBy,value:e.endLongEventsBy,type:i.Int,scope:o.Global});null!=e.enableOnlineMeetingsByDefault&&n.push({name:r.EnableOnlineMeetingsByDefault,value:e.enableOnlineMeetingsByDefault,type:i.Bool,scope:o.Global});return n.length>0?n:null}(e);return n?Object(v.c)(b+o.Global,n,void 0,!0):null}Object(l.orchestrator)(d,(function(){return Object(s.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:return(t=Object(c.a)())&&null!=t.shouldEventsEndEarly&&null!=t.endShortEventsBy&&null!=t.endLongEventsBy&&null!=t.enableOnlineMeetingsByDefault?[2]:[4,g()];case 1:return(e=n.sent())?(Object(u.g)(e),Object(u.d)(e.enableOnlineMeetingsByDefault),Object(S.a)()&&Object(u.f)(),Object(h.h)("cal-mf-enableDefaultOnlineMeetingSetting")&&!Object(O.a)()&&Object(m.b)(j.b.DefaultOnlineMeetingSetting,E),Object(h.h)("cal-mf-shouldEventsEndEarlySetting")&&Object(h.h)("cal-mf-shouldEventsEndEarlyFREDialog")&&!Object(p.a)()&&Object(m.b)(j.b.SpeedyMeetingsEndEarlySetting,y),[2]):[2]}var t}))}))})),Object(l.orchestrator)(u.g,(function(e){var n=e.calendarCloudSettings;null!=n.shouldEventsEndEarly&&Object(u.e)(n.shouldEventsEndEarly),null!=n.endShortEventsBy&&Object(u.c)(n.endShortEventsBy),null!=n.endLongEventsBy&&Object(u.b)(n.endLongEventsBy),null!=n.enableOnlineMeetingsByDefault&&Object(u.a)(n.enableOnlineMeetingsByDefault)})),Object(l.orchestrator)(f,(function(e){return Object(s.__awaiter)(void 0,void 0,void 0,(function(){var n;return Object(s.__generator)(this,(function(t){switch(t.label){case 0:return(n=e.calendarCloudSettings)?(Object(u.g)(n),[4,C(n)]):[2];case 1:return t.sent(),[2]}}))}))}));var I=t(254),w=t(103);Object(l.orchestrator)(u.f,(function(){var e={enableOnlineMeetingsByDefault:Object(w.d)()};f(e),Object(u.d)(!0),Object(I.o)("SyncOnlineMeetingsOCSWithMailboxConfig")})),t.d(n,"initCalendarCloudSettings",(function(){return d})),t.d(n,"saveCalendarCloudSettings",(function(){return f}))},1855:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(123),i=t(1266);function o(e,n){Object.keys(i.a).some((function(t){return i.a[t]==n&&(Object(r.h)(e,{key:t,id:n},{isCore:!0}),!0)}))}},418:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var r=t(22),i=t(20),o=t(98);function a(e){var n=Object(r.a)(),t=Object(o.a)()+Object(i.a)("/owa")+"/",a=n.search&&n.search.length>0;t+=a?n.search:"?";for(var u=Object.keys(e),c=a,l=0;l<u.length;l++)c?t+="&":c=!0,t+=u[l]+"="+e[u[l]];return t}},556:function(e,n,t){"use strict";var r=t(440),i=(t(581),t(20)),o=t(62);function a(e){return Object(o.a)(e,[o.b])}var u=t(26),c=t(67);function l(e){return Object(u.b)(Object(u.c)(Object(u.a)(Object(c.a)()||"",e)))}var s,d,f,b=t(418);function v(e,n){var t=-1!==e.indexOf("?");return(e+=t?"&":"?")+Object.keys(n).map((function(e,t){return encodeURIComponent(e)+"="+encodeURIComponent(n[e])})).join("&")}function g(){return s||(s=Object(i.a)("/calendar")+"/"),s}function O(){return d||(d=Object(i.a)("/mail")+"/"),d}function h(){return f||(f=Object(i.a)("/files")+"/"),f}var m,j,E,p=t(595);function y(e){return m&&j===e||(j=e,m=e?Object(i.a)("/people/group/owner")+"/":Object(i.a)("/people/group/member")+"/"),m}function S(){return E||(E=Object(i.a)("/people/group/deleted")+"/"),E}var C=t(27);function I(){var e=Object(C.a)().UserOptions;return(null==e?void 0:e.ReactOptinSettings)&&e.ReactOptinSettings.CalendarEnabled||!1}function w(e){if(I())return g()+"deeplink/compose/"+encodeURIComponent(e);var n={viewmodel:"IComposeCalendarItemViewModelFactory",ItemID:encodeURIComponent(e),ispopout:"1"};return Object(b.a)(n)}function R(e){return window.location.origin+g()+"showPeek/item/"+encodeURIComponent(e)}function B(e){if(I())return g()+"item/"+encodeURIComponent(e);var n={viewmodel:"ICalendarItemDetailsViewModelFactory",ItemID:encodeURIComponent(e),ispopout:"1"};return Object(b.a)(n)}var F=t(0),U=t(288),M=t(577),D=t(22),_=t(58),P=Object(M.a)().split("/").slice(1).join("/")+"deeplink/",k=["hostApp","isanonymous","cspoff","frameName","opxInstanceId"];function L(e,n,t,r){var i=Object(D.a)().search;if(t&&((r=r||{}).minus=""),r){var o=Object(_.parse)((i||"").substr(1));Object.keys(o).forEach((function(e){k.includes(e)&&delete o[e]})),Object.keys(r).forEach((function(e){return o[e]=r[e]})),i="?"+function(e){return Object.entries(e).map((function(e){var n=Object(F.__read)(e,2),t=n[0],r=n[1];return r?encodeURIComponent(t)+"="+encodeURIComponent(r):encodeURIComponent(t)})).join("&")}(o)}var a={pathname:"/"+e+"/"+P+n,search:i};return U.format(a)}var x,T=t(146),A="https://to-do.microsoft.com";function G(){var e,n,t=Object(C.a)(),r=t.UserOptions,i=null===(e=t.SessionSettings)||void 0===e?void 0:e.UserPrincipalName,o=A;return(null===(n=null==r?void 0:r.ReactOptinSettings)||void 0===n?void 0:n.TasksRedirectUrl)&&(o=r.ReactOptinSettings.TasksRedirectUrl,i&&(o=v(r.ReactOptinSettings.TasksRedirectUrl,{auth_upn:i}))),o}function N(){return x||(x=Object(i.a)("/spaces")+"/"),x}var V=t(98);t.d(n,"j",(function(){return r.a})),t.d(n,"s",(function(){return i.a})),t.d(n,"f",(function(){return a})),t.d(n,"l",(function(){return l})),t.d(n,"w",(function(){return u.a})),t.d(n,"a",(function(){return u.b})),t.d(n,"o",(function(){return b.a})),t.d(n,"u",(function(){return v})),t.d(n,"e",(function(){return g})),t.d(n,"k",(function(){return O})),t.d(n,"g",(function(){return h})),t.d(n,"p",(function(){return p.a})),t.d(n,"i",(function(){return y})),t.d(n,"h",(function(){return S})),t.d(n,"b",(function(){return w})),t.d(n,"c",(function(){return R})),t.d(n,"d",(function(){return B})),t.d(n,"q",(function(){return L})),t.d(n,"v",(function(){return T.a})),t.d(n,"t",(function(){return G})),t.d(n,"n",(function(){return N})),t.d(n,"m",(function(){return V.a})),t.d(n,"r",(function(){return c.a}))},581:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(22),i=t(67);function o(){var e,n=null===(e=Object(r.a)())||void 0===e?void 0:e.pathname;if(n){var t=n.split("/"+Object(i.a)()+"/")[1];if(t){var o=t.split("/")[0];if(o&&!isNaN(parseInt(o)))return!0}}return!1}},595:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r,i=t(20);function o(){return r||(r=Object(i.a)("/people")+"/"),r}}}]);
//# sourceMappingURL=owa.CalendarCloudSettings.js.map
self.scriptsLoaded['owa.CalendarCloudSettings.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.CalendarCloudSettings.js'] = (new Date()).getTime();