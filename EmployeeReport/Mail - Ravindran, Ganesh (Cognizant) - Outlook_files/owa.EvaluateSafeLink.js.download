self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.EvaluateSafeLink.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[252],{1946:function(e,n,t){"use strict";t.d(n,"a",(function(){return u})),t.d(n,"c",(function(){return a})),t.d(n,"e",(function(){return c})),t.d(n,"f",(function(){return o})),t.d(n,"d",(function(){return s})),t.d(n,"b",(function(){return f}));var r=t(108),i=new r.c((function(){return t.e(537).then(t.bind(null,3111))})),u=new r.b(i,(function(e){return e.extractFileUrlFromOfficeSharePointLink})),a=new r.b(i,(function(e){return e.isLinkPrefixedWithBaseUrl})),c=new r.b(i,(function(e){return e.isSharePointLink})),o=new r.b(i,(function(e){return e.isSharePointServiceGeneratedLink})),s=new r.b(i,(function(e){return e.isOfficeSharePointLink})),f=new r.b(i,(function(e){return e.getParsedQueryStringFromUrl}))},4129:function(e,n,t){"use strict";t.r(n);var r=t(0),i=t(25);function u(e,n){var t;return void 0===e||e.__type||(t=e,e=Object(r.__assign)({__type:"EvaluateSafeLinkRequest:#Exchange"},t)),Object(i.a)("EvaluateSafeLink",e,n)}var a=t(79);function c(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,t;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(!e)return[2,null];if(!(e.length>0))return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,u({SafeLinkUrls:e})];case 2:return(null==(n=r.sent())?void 0:n.Results)?[2,n.Results]:[3,4];case 3:return t=r.sent(),a.g.warn("evaluateSafeLinkService failed with error: "+t),[3,4];case 4:return[2,e.map((function(){return null}))]}}))}))}var o,s=[],f=new Map;function l(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,t;return Object(r.__generator)(this,(function(r){return e&&e.length?f.has(e)?[2,f.get(e)]:(null==(n=s.filter((function(n){return n.url===e})))?void 0:n.length)>0?[2,n[0].promise]:((t={url:e,promise:null,resolve:null}).promise=new Promise((function(e){t.resolve=e})),s.push(t),o&&clearTimeout(o),o=setTimeout(v,1e3),[2,t.promise]):[2,null]}))}))}function h(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,Promise.all(e.map((function(e){return l(e)})))];case 1:return[2,n.sent()]}}))}))}function v(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return s.length>0?(e=s.splice(0,s.length),[4,c(e.map((function(e){return e.url})))]):[3,2];case 1:n.sent().map((function(n,t){var r=e[t],i=r.url,u=r.resolve;f.set(i,n),u(n)})),n.label=2;case 2:return[2]}}))}))}var d=t(1946),b=t(1328);function w(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,d.e.import()];case 1:return n.sent()(e.href)?[2,!1]:[2,e.hasAttribute(b.b)&&e.hasAttribute(b.d)]}}))}))}t.d(n,"evaluateSafeLink",(function(){return l})),t.d(n,"evaluateSafeLinks",(function(){return h})),t.d(n,"isSafeLink",(function(){return w}))}}]);
//# sourceMappingURL=owa.EvaluateSafeLink.js.map
self.scriptsLoaded['owa.EvaluateSafeLink.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.EvaluateSafeLink.js'] = (new Date()).getTime();