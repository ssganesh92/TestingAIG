self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.15.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[15],{1560:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(5687);t.Keys=o.Keys;var r=n(5688);t.Editor=r.default;var i=n(4266);t.Undo=i.default;var a=n(4260);t.EditPlugin=a.default;var s=n(4264);t.MouseUpPlugin=s.default;var c=n(4259);t.DOMEventPlugin=c.default;var u=n(4265);t.TypeInContainerPlugin=u.default;var l=n(4261);t.FirefoxTypeAfterLink=l.default;var d=n(4257);t.CopyPlugin=d.default;var p=n(3621);t.cacheGetEventData=p.default;var h=n(4263);t.clearEventDataCache=h.default;var f=n(4262);t.cacheGetContentSearcher=f.cacheGetContentSearcher,t.clearContentSearcherCache=f.clearContentSearcherCache;var v=n(5702);t.cacheGetElementAtCursor=v.default;var g=n(4268);t.isModifierKey=g.default;var y=n(4267);t.isCharacterValue=y.default;var m=n(3620);t.isCtrlOrMetaPressed=m.default},3620:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(961).Browser.isMac?function(e){return e.metaKey}:function(e){return e.ctrlKey};t.default=o},3621:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var o=e&&e.eventDataCache&&e.eventDataCache.hasOwnProperty(t)?e.eventDataCache[t]:n();return e&&(e.eventDataCache=e.eventDataCache||{},e.eventDataCache[t]=o),o}},4257:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4258),r=function(){function e(){var e=this;this.onExtract=function(t){return function(n){if(e.editor&&e.editor.isDarkMode()){var r=e.editor.getSelectionRange();if(r&&!r.collapsed){var i=n,a=e.editor.getSelectionRange().cloneContents(),s=e.editor.getDocument().createElement("div");s.contentEditable="true",s.appendChild(a),o.default(s),i.clipboardData.setData("text/html",s.innerHTML),i.clipboardData.setData("text/plain",s.innerText),t&&e.editor.getSelectionRange().deleteContents(),n.preventDefault()}}}}}return e.prototype.getName=function(){return"Copy"},e.prototype.initialize=function(e){this.editor=e,this.eventDisposer=e.addDomEventHandler({copy:this.onExtract(!1),cut:this.onExtract(!0)})},e.prototype.dispose=function(){this.eventDisposer(),this.eventDisposer=null,this.editor=null},e}();t.default=r},4258:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(961);function r(e){return e&&"undefined"!=e&&"null"!=e}t.default=function(e){var t=e.getElementsByTagName("*");o.toArray(t).forEach((function(e){var t=e;t.dataset&&(t.style.color=r(t.dataset.ogsc)?t.dataset.ogsc:"",t.style.backgroundColor=r(t.dataset.ogsb)?t.dataset.ogsb:"",r(t.dataset.ogac)?t.setAttribute("color",t.dataset.ogac):t.removeAttribute("color"),r(t.dataset.ogab)?t.setAttribute("bgcolor",t.dataset.ogab):t.removeAttribute("bgcolor"),t.dataset.ogsc&&delete t.dataset.ogsc,t.dataset.ogsb&&delete t.dataset.ogsb,t.dataset.ogac&&delete t.dataset.ogac,t.dataset.ogab&&delete t.dataset.ogab)}))}},4259:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(961),r=function(){function e(e){var t=this;this.disableRestoreSelectionOnFocus=e,this.inIme=!1,this.onNativeEvent=function(e){t.editor.runAsync((function(){t.editor.addUndoSnapshot((function(){}),"cut"==e.type?"Cut":"Drop")}))},this.onFocus=function(){if(t.disableRestoreSelectionOnFocus){if(t.cachedPosition&&t.cachedFormatState){var e=t.editor.getSelectionRange();e.collapsed&&o.Position.getStart(e).normalize().equalTo(t.cachedPosition)?t.restorePendingFormatState():t.clear()}}else t.editor.restoreSavedRange()},this.onBlur=function(){t.editor.saveSelectionRange()},this.onScroll=function(e){t.editor.triggerPluginEvent(15,{rawEvent:e,scrollContainer:t.editor.getScrollContainer()})}}return e.prototype.getName=function(){return"DOMEvent"},e.prototype.initialize=function(e){var t,n=this;this.editor=e,this.disposer=e.addDomEventHandler(((t={compositionstart:function(){return n.inIme=!0},compositionend:function(t){n.inIme=!1,e.triggerPluginEvent(3,{rawEvent:t})},drop:this.onNativeEvent,cut:this.onNativeEvent,focus:this.onFocus})[o.Browser.isIEOrEdge?"beforedeactivate":"blur"]=this.onBlur,t)),this.editor.getScrollContainer().addEventListener("scroll",this.onScroll)},e.prototype.dispose=function(){this.editor.getScrollContainer().removeEventListener("scroll",this.onScroll),this.disposer(),this.disposer=null,this.editor=null,this.clear()},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 13:this.cachedPosition=this.getCurrentPosition(),this.cachedFormatState=e.formatState;break;case 0:case 4:case 6:this.cachedPosition&&!this.cachedPosition.equalTo(this.getCurrentPosition())&&this.clear()}},e.prototype.restorePendingFormatState=function(){var e=this;if(this.cachedFormatState){var t=o.getPendableFormatState(this.editor.getDocument());Object.keys(o.PendableFormatCommandMap).forEach((function(n){e.cachedFormatState[n]!=t[n]&&e.editor.getDocument().execCommand(o.PendableFormatCommandMap[n],!1,null)})),this.cachedPosition=this.getCurrentPosition()}},e.prototype.isInIME=function(){return this.inIme},e.prototype.clear=function(){this.cachedPosition=null,this.cachedFormatState=null},e.prototype.getCurrentPosition=function(){var e=this.editor.getSelectionRange();return e&&o.Position.getStart(e).normalize()},e}();t.default=r},4260:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(3620),r=function(){function e(){this.featureMap={},this.autoCompleteSnapshot=null,this.autoCompleteChangeSource=null}return e.prototype.getName=function(){return"Edit"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.addFeature({keys:[8],shouldHandleEvent:function(){return null!==t.autoCompleteSnapshot},handleEvent:function(e,n){e.rawEvent.preventDefault(),n.setContent(t.autoCompleteSnapshot,!1)}})},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){var t=!1,n=this.findFeature(e);switch(e.eventType){case 6:t=this.autoCompleteChangeSource!=e.source;break;case 4:case 0:t=!0}n&&n.handleEvent(e,this.editor),t&&(this.autoCompleteSnapshot=null,this.autoCompleteChangeSource=null)},e.prototype.addFeature=function(e){var t=this;e.keys.forEach((function(n){var o=t.featureMap[n]||[];o.push(e),t.featureMap[n]=o}))},e.prototype.performAutoComplete=function(e,t){var n=this;this.editor.addUndoSnapshot((function(o,r,i){var a=e();return n.autoCompleteSnapshot=i,n.autoCompleteChangeSource=t,a}),t)},e.prototype.findFeature=function(e){var t,n=this,r=!1,i=!1;if(0==e.eventType){var a=e.rawEvent;i=o.default(a),r=i||a.altKey,t=this.featureMap[a.which]}else 6==e.eventType&&(t=this.featureMap[2048]);return t&&t.filter((function(t){return(t.allowFunctionKeys||!r)&&t.shouldHandleEvent(e,n.editor,i)}))[0]},e}();t.default=r},4261:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(961),r=n(4262),i=function(){function e(){}return e.prototype.getName=function(){return"FirefoxTypeAfterLink"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){if(o.Browser.isFirefox&&1==e.eventType||9==e.eventType){var t=this.editor.getSelectionRange();if(t&&t.collapsed&&this.editor.getElementAtCursor("A[href]")){var n=r.cacheGetContentSearcher(e,this.editor).getInlineElementBefore();n instanceof o.LinkInlineElement&&this.editor.select(new o.Position(n.getContainerNode(),-3))}}},e}();t.default=i},4262:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(3621),r=n(4263),i="CONTENTSEARCHER";t.cacheGetContentSearcher=function(e,t){return o.default(e,i,(function(){return t.getContentSearcherOfCursor()}))},t.clearContentSearcherCache=function(e){r.default(e,i)}},4263:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e&&e.eventDataCache&&e.eventDataCache.hasOwnProperty(t)&&delete e.eventDataCache[t]}},4264:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){var e=this;this.onMouseUp=function(t){e.editor&&(e.removeMouseUpEventListener(),e.editor.triggerPluginEvent(5,{rawEvent:t}))}}return e.prototype.getName=function(){return"MouseUp"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.removeMouseUpEventListener(),this.editor=null},e.prototype.onPluginEvent=function(e){4!=e.eventType||this.mouseUpEventListerAdded||(this.editor.getDocument().addEventListener("mouseup",this.onMouseUp,!0),this.mouseUpEventListerAdded=!0)},e.prototype.removeMouseUpEventListener=function(){this.mouseUpEventListerAdded&&(this.mouseUpEventListerAdded=!1,this.editor.getDocument().removeEventListener("mouseup",this.onMouseUp,!0))},e}();t.default=o},4265:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(961),r=function(){function e(){}return e.prototype.getName=function(){return"TypeInContainer"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){1==e.eventType&&this.onKeyPress(e)},e.prototype.ensureTypeInElement=function(e,t){var n,r=e.normalize(),i=this.editor.getBlockElementAtNode(r.node);if(i){n=i.collapseToSingleElement();var a=o.isNodeEmpty(n)||t&&this.wasNodeJustCreatedByKeyboardEvent(t,n);n=n&&a?n:null}else n=o.fromHtml(o.Browser.isEdge?"<div><span><br></span></div>":"<div><br></div>",this.editor.getDocument())[0],this.editor.insertNode(n,{position:1,updateCursor:!1,replaceSelection:!1,insertOnNewLine:!1}),r=new o.Position(n.firstChild,0);return n&&o.applyFormat(n,this.editor.getDefaultFormat(),this.editor.isDarkMode()),r},e.prototype.onKeyPress=function(e){var t=this,n=this.editor.getSelectionRange();n&&!this.editor.contains(o.findClosestElementAncestor(n.startContainer))&&(n.collapsed?this.tryNormalizeTyping(e,n):n.collapsed||this.editor.runAsync((function(){t.tryNormalizeTyping(e)})))},e.prototype.tryNormalizeTyping=function(e,t){var n=this.ensureTypeInElement(o.Position.getStart(t||this.editor.getSelectionRange()),e);this.editor.select(n)},e.prototype.wasNodeJustCreatedByKeyboardEvent=function(e,t){return o.isNode(e.rawEvent.target)&&e.rawEvent.target.contains(t)&&e.rawEvent.key===t.innerText},e}();t.default=r},4266:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(3620),r=n(5691),i=function(){function e(e,t){void 0===t&&(t=1e7),this.preserveSnapshots=e,this.maxBufferSize=t}return e.prototype.getName=function(){return"Undo"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null,this.preserveSnapshots||this.clear()},e.prototype.onPluginEvent=function(e){if(!this.editor.isInIME())switch(e.eventType){case 10:this.preserveSnapshots&&(this.canUndo()||this.canRedo())||this.addUndoSnapshot();break;case 0:this.onKeyDown(e.rawEvent);break;case 1:this.onKeyPress(e.rawEvent);break;case 3:this.clearRedoForInput(),this.addUndoSnapshot();break;case 6:this.isRestoring||this.clearRedoForInput()}},e.prototype.clear=function(){this.undoSnapshots=null,this.hasNewContent=!1},e.prototype.undo=function(){this.hasNewContent&&this.addUndoSnapshot(),this.restoreSnapshot(-1)},e.prototype.redo=function(){this.restoreSnapshot(1)},e.prototype.canUndo=function(){return this.hasNewContent||this.getSnapshotsManager().canMove(-1)},e.prototype.canRedo=function(){return this.getSnapshotsManager().canMove(1)},e.prototype.addUndoSnapshot=function(){var e=this.editor.getContent(!1,!0);return this.getSnapshotsManager().addSnapshot(e),this.hasNewContent=!1,e},e.prototype.getSnapshotsManager=function(){return this.undoSnapshots||(this.undoSnapshots=new r.default(this.maxBufferSize)),this.undoSnapshots},e.prototype.restoreSnapshot=function(e){var t=this.getSnapshotsManager().move(e);if(null!=t)try{this.isRestoring=!0,this.editor.setContent(t)}finally{this.isRestoring=!1}},e.prototype.onKeyDown=function(e){if(8==e.which||46==e.which){var t=this.editor.getSelectionRange();!t||t.collapsed&&this.lastKeyPress==e.which&&!o.default(e)||this.addUndoSnapshot(),this.hasNewContent=!0,this.lastKeyPress=e.which}else e.which>=33&&e.which<=40&&(this.hasNewContent&&this.addUndoSnapshot(),this.lastKeyPress=0)},e.prototype.onKeyPress=function(e){if(!e.metaKey){var t=this.editor.getSelectionRange();t&&!t.collapsed||32==e.which&&32!=this.lastKeyPress||13==e.which?(this.addUndoSnapshot(),13==e.which&&(this.hasNewContent=!0)):this.clearRedoForInput(),this.lastKeyPress=e.which}},e.prototype.clearRedoForInput=function(){this.getSnapshotsManager().clearRedo(),this.lastKeyPress=0,this.hasNewContent=!0},e}();t.default=i},4267:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4268);t.default=function(e){return!o.default(e)&&e.key&&1==e.key.length}},4268:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="Control",r="Alt",i="Meta";t.default=function(e){var t=e.ctrlKey||e.key===o,n=e.altKey||e.key===r,a=e.metaKey||e.key===i;return t||n||a}},4269:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(961),r={backgroundColors:{darkModeColor:"rgb(51,51,51)",lightModeColor:"rgb(255,255,255)"},textColors:{darkModeColor:"rgb(255,255,255)",lightModeColor:"rgb(0,0,0)"}};t.calculateDefaultFormat=function(e,t,n){if(n&&(t.backgroundColors||(t.backgroundColors=r.backgroundColors),t.textColors||(t.textColors=r.textColors)),t&&0===Object.keys(t).length)return{};var i=(t=t||{}).fontFamily,a=t.fontSize,s=t.textColor,c=t.textColors,u=t.backgroundColor,l=t.backgroundColors,d=t.bold,p=t.italic,h=t.underline,f=i&&a&&(s||c)?null:o.getComputedStyles(e);return{fontFamily:i||f[0],fontSize:a||f[1],get textColor(){return c?n?c.darkModeColor:c.lightModeColor:s||f[2]},textColors:c,get backgroundColor(){return l?n?l.darkModeColor:l.lightModeColor:u||""},backgroundColors:l,bold:d,italic:p,underline:h}}},4270:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(961);t.hasFocus=function(e){var t=e.document.activeElement;return t&&o.contains(e.contentDiv,t,!0)}},5687:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.NULL=0]="NULL",e[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.ENTER=13]="ENTER",e[e.ESCAPE=27]="ESCAPE",e[e.SPACE=32]="SPACE",e[e.LEFT=37]="LEFT",e[e.UP=38]="UP",e[e.RIGHT=39]="RIGHT",e[e.DOWN=40]="DOWN",e[e.DELETE=46]="DELETE",e[e.B=66]="B",e[e.I=73]="I",e[e.U=85]="U",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.COMMA=188]="COMMA",e[e.PERIOD=190]="PERIOD",e[e.FORWARDSLASH=191]="FORWARDSLASH",e[e.Ctrl=256]="Ctrl",e[e.Meta=512]="Meta",e[e.Shift=1024]="Shift",e[e.CONTENTCHANGED=2048]="CONTENTCHANGED",e[e.MOUSEDOWN=4096]="MOUSEDOWN"}(t.Keys||(t.Keys={}))},5688:function(e,t,n){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r=n(5689),i=n(5690),a=n(5700),s=n(4258),c=n(4269),u=n(5701),l=n(961),d=function(){function e(e,t){var n=this;if(void 0===t&&(t={}),"DIV"!=l.getTagOfNode(e))throw new Error("contentDiv must be an HTML DIV element");if(this.core=i.default(e,t),this.enableExperimentFeatures=t.enableExperimentFeatures,this.core.plugins.forEach((function(e){return e.initialize(n)})),this.setContent(t.initialContent||e.innerHTML||"",!1),this.eventDisposers=a.default(this.core),t.additionalEditFeatures&&t.additionalEditFeatures.forEach((function(e){return n.addContentEditFeature(e)})),!t.omitContentEditableAttributeChanges&&!e.isContentEditable){e.setAttribute("contenteditable","true");var o=e.style;o.userSelect=o.msUserSelect=o.webkitUserSelect="text",this.contenteditableChanged=!0}r.default(this.core.document),this.triggerPluginEvent(10,{},!0),this.core.corePlugins.typeInContainer.ensureTypeInElement(this.getFocusedPosition()||new l.Position(e,0))}return e.prototype.dispose=function(){this.triggerPluginEvent(11,{},!0),this.core.plugins.forEach((function(e){return e.dispose()})),this.eventDisposers.forEach((function(e){return e()})),this.eventDisposers=null;for(var e=0,t=Object.keys(this.core.customData);e<t.length;e++){var n=t[e],o=this.core.customData[n];o&&o.disposer&&o.disposer(o.value),delete this.core.customData[n]}if(this.contenteditableChanged){var r=this.core.contentDiv.style;r.userSelect=r.msUserSelect=r.webkitUserSelect="",this.core.contentDiv.removeAttribute("contenteditable")}this.core=null},e.prototype.isDisposed=function(){return!this.core},e.prototype.insertNode=function(e,t){var n=this.getDarkModeOptions(),o=this.isDarkMode()?u.convertContentToDarkMode(e,n&&n.onExternalContentTransform?n.onExternalContentTransform:void 0):null,r=!!e&&this.core.api.insertNode(this.core,e,t);return r&&o&&o(),r},e.prototype.deleteNode=function(e){return!(!e||!this.contains(e))&&(e.parentNode.removeChild(e),!0)},e.prototype.replaceNode=function(e,t){return!!(e&&t&&this.contains(e))&&(e.parentNode.replaceChild(t,e),!0)},e.prototype.getInlineElementAtNode=function(e){return l.getInlineElementAtNode(this.core.contentDiv,e)},e.prototype.getBlockElementAtNode=function(e){return l.getBlockElementAtNode(this.core.contentDiv,e)},e.prototype.contains=function(e){return l.contains(this.core.contentDiv,e)},e.prototype.queryElements=function(e,t,n){void 0===t&&(t=0);var o=t instanceof Function?0:t;n=t instanceof Function?t:n;var r=0==o?null:this.getSelectionRange();return l.queryElements(this.core.contentDiv,e,n,o,r)},e.prototype.collapseNodes=function(e,t,n){return l.collapseNodes(this.core.contentDiv,e,t,n)},e.prototype.isEmpty=function(e){return l.isNodeEmpty(this.core.contentDiv,e)},e.prototype.getContent=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!1);var n="",o=this.core.inDarkMode;if(e||o){var r=this.core.contentDiv.cloneNode(!0),i=t&&this.getSelectionPath(),a=i&&l.createRange(r,i.start,i.end);o&&s.default(r),e?(this.triggerPluginEvent(8,{clonedRoot:r},!0),n=this.triggerPluginEvent(7,{content:r.innerHTML},!0).content):n=a?l.getHtmlWithSelectionPath(r,a):r.innerHTML}else n=l.getHtmlWithSelectionPath(this.core.contentDiv,t&&this.getSelectionRange());return n},e.prototype.getTextContent=function(){return l.getTextContent(this.core.contentDiv)},e.prototype.setContent=function(e,t){void 0===t&&(t=!0);var n=this.core.contentDiv,o=!1;if(n.innerHTML!=e){var r=l.setHtmlWithSelectionPath(n,e);this.select(r),o=!0}if(this.core.inDarkMode){var i=this.getDarkModeOptions(),a=u.convertContentToDarkMode(n,i&&i.onExternalContentTransform?i.onExternalContentTransform:void 0,!0);a&&(a(),o=!0)}t&&o&&this.triggerContentChangedEvent()},e.prototype.insertContent=function(e,t){if(e){var n=l.fromHtml(e,this.core.document);t&&t.insertOnNewLine&&n.length>1&&(n=[l.wrap(n)]);var o=this.core.document.createDocumentFragment();n.forEach((function(e){return o.appendChild(e)})),this.insertNode(o,t)}},e.prototype.getSelectionRange=function(){return this.core.api.getSelectionRange(this.core,!0)},e.prototype.getSelectionPath=function(){var e=this.getSelectionRange();return e&&l.getSelectionPath(this.core.contentDiv,e)},e.prototype.hasFocus=function(){return this.core.api.hasFocus(this.core)},e.prototype.focus=function(){this.core.api.focus(this.core)},e.prototype.select=function(e,t,n,o){var r=e?l.isRange(e)?e:Array.isArray(e.start)&&Array.isArray(e.end)?l.createRange(this.core.contentDiv,e.start,e.end):l.createRange(e,t,n,o):null;return this.contains(r)&&this.core.api.selectRange(this.core,r)},e.prototype.getSelection=function(){return this.core.document.defaultView.getSelection()},e.prototype.saveSelectionRange=function(){this.core.cachedSelectionRange=this.core.api.getSelectionRange(this.core,!1)},e.prototype.restoreSavedRange=function(){this.select(this.core.cachedSelectionRange),this.core.cachedSelectionRange=null},e.prototype.getFocusedPosition=function(){var e=this.getSelection();if(this.contains(e&&e.focusNode))return new l.Position(e.focusNode,e.focusOffset);var t=this.getSelectionRange();return t?l.Position.getStart(t):null},e.prototype.getCursorRect=function(){var e=this.getFocusedPosition();return e&&l.getPositionRect(e)},e.prototype.getElementAtCursor=function(e,t){if(!t){var n=this.getFocusedPosition();t=n&&n.node}return t&&l.findClosestElementAncestor(t,this.core.contentDiv,e)},e.prototype.isPositionAtBeginning=function(e){return l.isPositionAtBeginningOf(e,this.core.contentDiv)},e.prototype.getSelectedRegions=function(e){void 0===e&&(e=0),this.core.corePlugins.typeInContainer.ensureTypeInElement(this.getFocusedPosition()||new l.Position(this.core.contentDiv,0));var t=this.getSelectionRange();return t?l.getRegionsFromRange(this.core.contentDiv,t,e):[]},e.prototype.addDomEventHandler=function(e,t){var n=this;if(e instanceof Object){var o=Object.keys(e).map((function(t){return e[t]&&n.core.api.attachDomEvent(n.core,t,null,e[t])})).filter((function(e){return e}));return function(){return o.forEach((function(e){return e()}))}}return this.core.api.attachDomEvent(this.core,e,null,t)},e.prototype.triggerPluginEvent=function(e,t,n){var r=o({eventType:e},t);return this.core.api.triggerEvent(this.core,r,n),r},e.prototype.triggerEvent=function(e,t){void 0===t&&(t=!0),this.core.api.triggerEvent(this.core,e,t)},e.prototype.triggerContentChangedEvent=function(e,t){void 0===e&&(e="SetContent"),this.triggerPluginEvent(6,{source:e,data:t})},e.prototype.undo=function(){this.focus(),this.core.corePlugins.undo.undo()},e.prototype.redo=function(){this.focus(),this.core.corePlugins.undo.redo()},e.prototype.addUndoSnapshot=function(e,t){this.core.api.editWithUndo(this.core,e,t)},e.prototype.performAutoComplete=function(e,t){this.core.corePlugins.edit.performAutoComplete(e,t)},e.prototype.canUndo=function(){return this.core.corePlugins.undo.canUndo()},e.prototype.canRedo=function(){return this.core.corePlugins.undo.canRedo()},e.prototype.getDocument=function(){return this.core.document},e.prototype.getScrollContainer=function(){return this.core.scrollContainer},e.prototype.getCustomData=function(e,t,n){return this.core.api.getCustomData(this.core,e,t,n)},e.prototype.isInIME=function(){return this.core.corePlugins.domEvent.isInIME()},e.prototype.getDefaultFormat=function(){return this.core.defaultFormat},e.prototype.getBodyTraverser=function(e){return l.ContentTraverser.createBodyTraverser(this.core.contentDiv,e)},e.prototype.getSelectionTraverser=function(){return this.getSelectionRange()&&l.ContentTraverser.createSelectionTraverser(this.core.contentDiv,this.getSelectionRange())},e.prototype.getBlockTraverser=function(e){void 0===e&&(e=3);var t=this.getSelectionRange();return t&&l.ContentTraverser.createBlockTraverser(this.core.contentDiv,t,e)},e.prototype.getContentSearcherOfCursor=function(){var e=this.getSelectionRange();return e&&new l.PositionContentSearcher(this.core.contentDiv,l.Position.getStart(e))},e.prototype.runAsync=function(e){var t=this;(this.core.contentDiv.ownerDocument.defaultView||window).requestAnimationFrame((function(){!t.isDisposed()&&e&&e()}))},e.prototype.setEditorDomAttribute=function(e,t){null===t?this.core.contentDiv.removeAttribute(e):this.core.contentDiv.setAttribute(e,t)},e.prototype.getEditorDomAttribute=function(e){return this.core.contentDiv.getAttribute(e)},e.prototype.addContentEditFeature=function(e){this.core.corePlugins.edit.addFeature(e)},e.prototype.setDarkModeState=function(e){if(this.isDarkMode()!=e){var t=this.getContent(void 0,!0);this.core.inDarkMode=e,this.core.defaultFormat=c.calculateDefaultFormat(this.core.contentDiv,this.core.defaultFormat,this.core.inDarkMode),this.setContent(t),this.triggerPluginEvent(14,{changedToDarkMode:e})}},e.prototype.isDarkMode=function(){return this.core.inDarkMode},e.prototype.getDarkModeOptions=function(){return this.core.darkModeOptions},e.prototype.useExperimentFeatures=function(){return!!this.enableExperimentFeatures},e}();t.default=d},5689:function(e,t,n){"use strict";var o,r;Object.defineProperty(t,"__esModule",{value:!0});var i=n(961),a=i.Browser.isFirefox?((o={}).enableObjectResizing=!1,o.enableInlineTableEditing=!1,o):i.Browser.isIE?((r={}).defaultParagraphSeparator="div",r.AutoUrlDetect=!1,r):{};t.default=function(e){Object.keys(a).forEach((function(t){try{e.execCommand(t,!1,a[t])}catch(e){}}))}},5690:function(e,t,n){"use strict";var o=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),r=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,r++)o[r]=i[a];return o};Object.defineProperty(t,"__esModule",{value:!0});var r=n(4257),i=n(4259),a=n(4260),s=n(4261),c=n(4264),u=n(4265),l=n(4266),d=n(5692),p=n(961),h=n(4269),f=n(5693),v=n(5694),g=n(5695),y=n(5696),m=n(4270),E=n(5697),C=n(5698),S=n(5699);function P(e){return{attachDomEvent:(e=e||{}).attachDomEvent||d.attachDomEvent,editWithUndo:e.editWithUndo||f.editWithUndo,focus:e.focus||v.focus,getCustomData:e.getCustomData||g.getCustomData,getSelectionRange:e.getSelectionRange||y.getSelectionRange,hasFocus:e.hasFocus||m.hasFocus,insertNode:e.insertNode||E.insertNode,select:e.select||C.select,selectRange:e.selectRange||C.selectRange,triggerEvent:e.triggerEvent||S.triggerEvent}}t.default=function(e,t){var n,d={undo:t.undo||new l.default,edit:new a.default,typeInContainer:new u.default,mouseUp:new c.default,domEvent:new i.default(t.disableRestoreSelectionOnFocus),firefoxTypeAfterLink:new s.default,copyPlugin:!p.Browser.isIE&&new r.default},f=function(e,t){return o([e.typeInContainer,e.edit,e.mouseUp],t||[],[e.firefoxTypeAfterLink,e.undo,e.domEvent,e.copyPlugin]).filter((function(e){return!!e}))}(d,t.plugins),v=f.filter((function(e){return e.onPluginEvent||e.willHandleEventExclusively}));return{contentDiv:e,scrollContainer:t.scrollContainer||e,document:e.ownerDocument,defaultFormat:h.calculateDefaultFormat(e,t.defaultFormat,t.inDarkMode),corePlugins:d,currentUndoSnapshot:null,customData:(n=t.customData||{},Object.keys(n).reduce((function(e,t){return e[t]={value:n[t]},e}),{})),cachedSelectionRange:null,plugins:f,eventHandlerPlugins:v,api:P(t.coreApiOverride),defaultApi:P(),inDarkMode:t.inDarkMode,darkModeOptions:t.darkModeOptions}}},5691:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(961),r=1e7,i=function(){function e(e){void 0===e&&(e=r),this.maxSize=e,this.snapshots=o.createSnapshots(e)}return e.prototype.canMove=function(e){return o.canMoveCurrentSnapshot(this.snapshots,e)},e.prototype.move=function(e){return o.moveCurrentSnapsnot(this.snapshots,e)},e.prototype.addSnapshot=function(e){o.addSnapshot(this.snapshots,e)},e.prototype.clearRedo=function(){o.clearProceedingSnapshots(this.snapshots)},e}();t.default=i},5692:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4267);t.attachDomEvent=function(e,t,n,r){var i=function(t){var i;(("keydown"==(i=t).type||"keypress"==i.type||"keyup"==i.type)&&o.default(t)||12==n)&&t.stopPropagation(),r&&r(t),null!=n&&e.api.triggerEvent(e,{eventType:n,rawEvent:t},!1)};return e.contentDiv.addEventListener(t,i),function(){e.contentDiv.removeEventListener(t,i)}}},5693:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(961);t.editWithUndo=function(e,t,n){var r,i=null!==e.currentUndoSnapshot;i||(e.currentUndoSnapshot=e.corePlugins.undo.addUndoSnapshot());try{if(t){var a=e.api.getSelectionRange(e,!0);r=t(a&&o.Position.getStart(a).normalize(),a&&o.Position.getEnd(a).normalize(),e.currentUndoSnapshot),i||e.corePlugins.undo.addUndoSnapshot()}}finally{i||(e.currentUndoSnapshot=null)}if(t&&n){var s={eventType:6,source:n,data:r};e.api.triggerEvent(e,s,!0)}}},5694:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(961);t.focus=function(e){if(!(e.api.hasFocus(e)&&e.api.getSelectionRange(e,!1)||e.cachedSelectionRange&&e.api.selectRange(e,e.cachedSelectionRange,!0))){var t=o.getFirstLeafNode(e.contentDiv)||e.contentDiv;e.api.selectRange(e,o.createRange(t,0),!0)}e.cachedSelectionRange=null,e.api.hasFocus(e)||e.contentDiv.focus()}},5695:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCustomData=function(e,t,n,o){return(e.customData[t]=e.customData[t]||{value:n?n():void 0,disposer:o}).value}},5696:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(961);t.getSelectionRange=function(e,t){var n=null;if(!t||e.api.hasFocus(e)){var r=e.document.defaultView.getSelection();if(r&&r.rangeCount>0){var i=r.getRangeAt(0);o.contains(e.contentDiv,i)&&(n=i)}}return!n&&t&&(n=e.cachedSelectionRange),n}},5697:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(961);t.insertNode=function(e,t,n){n=n||{position:3,insertOnNewLine:!1,updateCursor:!0,replaceSelection:!0};var r=e.contentDiv;switch(n.updateCursor&&e.api.focus(e),n.position){case 0:case 1:var i,a=0==n.position,s=o.getFirstLastBlockElement(r,a);if(s){var c=a?s.getStartNode():s.getEndNode();i=n.insertOnNewLine||3==c.nodeType||o.isVoidHtmlElement(c)?c.parentNode.insertBefore(t,a?c:c.nextSibling):c.insertBefore(t,a?c.firstChild:null)}else i=r.appendChild(t);i&&n.insertOnNewLine&&!o.isBlockElement(i)&&o.wrap(i);break;case 2:var u=r.appendChild(t);u&&n.insertOnNewLine&&!o.isBlockElement(u)&&o.wrap(u);break;case 5:case 3:var l=function(e,t){var n=e.api.getSelectionRange(e,!0),o=null;return 5==t.position?(o=n,n=t.range):n&&(o=n.cloneRange()),{range:n,rangeToRestore:o}}(e,n),d=l.range,p=l.rangeToRestore;if(!d)return;n.replaceSelection&&!d.collapsed&&d.deleteContents();var h=o.Position.getStart(d),f=void 0;h=n.insertOnNewLine&&(f=o.getBlockElementAtNode(r,h.normalize().node))?new o.Position(f.getEndNode(),-3):o.adjustNodeInsertPosition(r,t,h);var v=11==t.nodeType?t.lastChild:t;(d=o.createRange(h)).insertNode(t),n.updateCursor&&v&&(p=o.createRange(new o.Position(v,-3).normalize())),e.api.selectRange(e,p);break;case 4:e.contentDiv.parentNode.insertBefore(t,r.nextSibling)}return!0}},5698:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(961),r=n(4270);t.selectRange=function(e,t,n){var i,a=!0;if(!o.contains(e.contentDiv,t)||!(i=e.document.defaultView.getSelection()))return!1;if(i.rangeCount>0)try{var s=void 0;(n||o.Browser.isEdge)&&(s=1==i.rangeCount?i.getRangeAt(0):null)&&s.startContainer==t.startContainer&&s.startOffset==t.startOffset&&s.endContainer==t.endContainer&&s.endOffset==t.endOffset?a=!1:i.removeAllRanges()}catch(e){}return a&&i.addRange(t),r.hasFocus(e)||(e.cachedSelectionRange=t),t.collapsed&&e.corePlugins.domEvent.restorePendingFormatState(),!0},t.select=function(e,t,n,r,i){var a=o.isRange(t)?t:o.createRange(t,n,r,i);return e.api.selectRange(e,a)}},5699:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.triggerEvent=function(e,t,n){!n&&e.eventHandlerPlugins.some((function(e){return function(e,t){if(t.onPluginEvent&&t.willHandleEventExclusively&&t.willHandleEventExclusively(e))return t.onPluginEvent(e),!0;return!1}(t,e)}))||e.eventHandlerPlugins.forEach((function(e){e.onPluginEvent&&e.onPluginEvent(t)}))}},5700:function(e,t,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0});var r=((o={keypress:1,keydown:0,keyup:2,mousedown:4})[n(961).Browser.isIE?"textinput":"input"]=12,o);t.default=function(e){return Object.keys(r).map((function(t){return e.api.attachDomEvent(e,t,r[t])}))}},5701:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(961);t.convertContentToDarkMode=function(e,t,n){var r=[];return o.isHTMLElement(e)?(r=Array.prototype.slice.call(e.getElementsByTagName("*")),n||r.unshift(e)):o.isDocumentFragment(e)&&(r=Array.prototype.slice.call(e.querySelectorAll("*"))),r.length>0?function(){r.forEach((function(e){t?t(e):(e.style.color=null,e.style.backgroundColor=null)}))}:null}},5702:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(3621),r="GET_ELEMENT_AT_CURSOR_";t.default=function(e,t,n){return o.default(t,r+n,(function(){return e.getElementAtCursor(n)}))}}}]);
//# sourceMappingURL=owa.15.js.map
self.scriptsLoaded['owa.15.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.15.js'] = (new Date()).getTime();