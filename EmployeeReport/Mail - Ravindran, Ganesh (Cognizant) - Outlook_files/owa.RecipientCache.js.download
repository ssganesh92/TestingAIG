self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.RecipientCache.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[501],{1030:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"IndexedPageView:#Exchange"},e)}},1092:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(27),i=n(76),c=n(2142);function a(){var e=Object(r.a)(),t=null==e?void 0:e.SessionSettings,n=null==t?void 0:t.IsExplicitLogon,a=null==t?void 0:t.IsSubstrateSearchServiceAvailable;return!(c.a.fallbackToFindPeople||!Object(i.h)("rp-3SPeopleSuggestions")||n||!a)}},1250:function(e,t,n){"use strict";var r=n(9),i=n(283),c=n(1874),a=n(1863),o=n(246),u=n(79);function s(e){var t=Object(a.a)({EntityFeedbackEntries:e});return Object(c.a)({Header:Object(o.a)(),Body:t}).then((function(e){!function(e){if(null==e?void 0:e.Body){var t=e.Body;u.g.info(Object(r.c)("addEntityFeedback Error count: {0}",t.ErrorCount)),u.g.info(Object(r.c)("addEntityFeedback error details: {0}",t.ErrorDetails))}}(e)}))}t.a=Object(i.action)("attemptToSubmitAddEntityFeedback")((function(e,t,n){e&&t&&(e.entityFeedbackEntries.push(t),(n||e.entityFeedbackEntries.length>=e.maxActionBatchSize)&&(s(e.entityFeedbackEntries),u.g.info(Object(r.c)("{0} Submitted {1} entities.",e.entityScenarioName,e.entityFeedbackEntries.length)),e.entityFeedbackEntries=[]))}))},1262:function(e,t,n){"use strict";var r=n(4),i=Object(r.createStore)("recipientcache",{recipientCache:null,allKeys:{},usedFindPeopleFallback:!1})();t.a=i},1294:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(76);function i(){return Object(r.h)("rp-peopleSuggestionsTrie")&&Object(r.h)("rp-peopleSuggestionsCacheFirst")||Object(r.h)("rp-cacheFirstPeopleTrieSize300")||Object(r.h)("rp-cacheFirstPeopleTrieSize500")||Object(r.h)("rp-cacheFirstPeopleTrieSize700")||Object(r.h)("rp-peopleTrieOnTimeoutLow")||Object(r.h)("rp-peopleTrieOnTimeoutMed")||Object(r.h)("rp-peopleTrieOnTimeoutHigh")}},1364:function(e,t,n){"use strict";var r=n(9),i=n(283),c=Object(i.action)("increaseEntrySequenceNumber")((function(e){e&&e.entrySequenceNumber++})),a=n(147),o=n(79),u=n(7);function s(e,t,n,i,s,d,l,b){if(void 0===b&&(b=Object(u.Qb)()),!e)return o.g.warn("Attempting to create entity feedback entry with invalid feedbackManager"),null;if(Object(a.b)(e.clientSessionId))return o.g.warn(Object(r.c)("{0} - Attempting to create entity feedback entry with empty client session id",e.entityScenarioName)),null;var f={ClientEventTimeUtc:Object(u.ub)(b),ClientEventTimeLocal:Object(u.rb)(b),ClientSessionId:e.clientSessionId,ClientVersion:e.clientVersion,ClientId:e.clientId,EntityType:e.entityType,EntrySequenceNumber:e.entrySequenceNumber,TransactionId:t,EventType:n,TargetEntityList:i,EntityAddSource:s,JsonPropertyBag:d,ScenarioName:l||e.entityScenarioName};return c(e),f}n.d(t,"a",(function(){return s}))},1558:function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));var r=n(108),i=new r.c((function(){return Promise.all([n.e(29),n.e(31),n.e(105)]).then(n.bind(null,2799))})),c=new r.b(i,(function(e){return e.searchCacheTrie})),a=new r.b(i,(function(e){return e.compareFeatureData})),o=new r.a(i,(function(e){return e.initializeSuggestionTrie}))},1619:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1092);function i(e){var t,n="";e&&(Object(r.a)()?(t=e).Groups&&t.Instrumentation&&(n=t.Instrumentation.TraceId):"Success"==(t=e).ResponseClass&&t.ResultSet&&(n=t.TransactionId));return n}},1704:function(e,t,n){"use strict";n.d(t,"b",(function(){return i}));var r=n(4),i=Object(r.createStore)("substratepeoplesuggestions",{sessionMaskedRecipients:[]}),c=i();t.a=c},1863:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"AddEntityFeedbackRequest:#Exchange"},e)}},1874:function(e,t,n){"use strict";var r=n(25),i=n(0);function c(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.__assign)({__type:"AddEntityFeedbackJsonRequest:#Exchange"},n)),Object(r.a)("AddEntityFeedback",e,t)}n.d(t,"a",(function(){return c}))},1916:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"FindPeopleJsonRequest:#Exchange"},e)}},2142:function(e,t,n){"use strict";var r=n(4),i=Object(r.createStore)("recipientcommon",{fallbackToFindPeople:!1})();t.a=i},2143:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1704);function i(e){return!!Object(r.b)().sessionMaskedRecipients[e]}},2144:function(e,t,n){"use strict";function r(e){var t,n;return e?(null===(t=e.EmailAddress)||void 0===t?void 0:t.EmailAddress)||(null===(n=e.PersonaId)||void 0===n?void 0:n.Id):null}n.d(t,"a",(function(){return r}))},2188:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"PersonaResponseShape:#Exchange"},e)}},2190:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"FindPeopleRequest:#Exchange"},e)}},2191:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(9),i=n(2143),c=function(e){return e?{Id:e,__type:"ItemId:#Exchange"}:void 0};function a(e,t,n){var a=e.EmailAddresses,d=e.DisplayName,l=e.Text,b=e.PDLItemId,f=e.ADObjectId,p=e.PersonaId,O=e.FeatureData,j=e.Id,v=e.ReferenceId,h=e.ImAddress,y=e.JobTitle,g=e.PeopleType,m=e.PeopleSubtype,S=e.GivenName,I=e.Alias,_=a?a[0]:void 0;if(!n&&_&&Object(i.a)(_))return null;var P={EmailAddress:_,Name:Object(r.f)(d)?l:d,MailboxType:s(m),RoutingType:o(m),ItemId:c(b)};return{DisplayName:d,ADObjectId:f,FeatureData:O,Id:j,ImAddress:h,EmailAddress:P,EmailAddresses:[P],PersonaTypeString:u(m),PersonaId:c(p),Title:y,ReferenceId:v,PeopleType:g,PeopleSubtype:m,GivenName:S,TransactionId:t,Alias:I}}function o(e){return"PersonalDistributionList"==e?"MAPIPDL":"SMTP"}function u(e){switch(e){case"PublicDistributionList":case"PersonalDistributionList":return"DistributionList";case"UnifiedGroup":return"ModernGroup";case"OrganizationUser":case"PersonalContact":case"ImplicitContact":case"OrganizationContact":return"Person";case"LinkedIn":return"LinkedIn";case"ImplicitGroup":return"ImplicitGroup";default:return"Unknown"}}function s(e){switch(e){case"PublicDistributionList":return"PublicDL";case"PersonalDistributionList":return"PrivateDL";case"UnifiedGroup":return"GroupMailbox";case"ImplicitGroup":return"RecommendedGroup";case"OrganizationUser":return"InternalMailbox";case"LinkedIn":return"LinkedIn";case"PersonalContact":case"OrganizationContact":case"ImplicitContact":case"Guest":case"Unknown":return"ExternalMailbox";default:return e}}},2272:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(25),i=n(1916);function c(e,t){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(r.a)("FindPeople",e,t)}},2481:function(e,t,n){"use strict";var r=n(9),i=n(1250),c=n(1364),a=n(7),o=n(147),u=n(79),s=n(283);t.a=Object(s.action)("transactionFailed")((function(e,t,n,s,d,l){if(void 0===l&&(l=null),null==e?void 0:e.hasSessionStarted){var b={TransactionRequestTime:Object(a.rb)(s),TransactionRequestDuration:Object(a.w)(Object(a.Qb)(),s),QueryString:Object(r.f)(t)?"":t,QueryStringLength:Object(o.b)(t)?0:t.length,ImpressionId:n};l&&Object.keys(l).forEach((function(e){b[e]=l[e]})),d&&(b.Context=d);var f=JSON.stringify(b),p=Object(c.a)(e,n,"TransactionFailed",null,0,f);Object(i.a)(e,p,!1),u.g.info(Object(r.c)("{0} TransactionComplete. Session id: {1}",e.entityScenarioName,e.clientSessionId))}}))},2775:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ContextProperty:#Exchange"},e)}},279:function(e,t,n){"use strict";var r=n(560);n.d(t,"a",(function(){return r.a}))},4062:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1294),i=["Id","ADObjectId","DisplayName","EmailAddresses","PeopleSubtype","PeopleType","PDLItemId","PersonaId","ImAddress","JobTitle"],c=i.concat(["FeatureData","GivenName","Alias"]),a=i.concat(["FeatureData"]);function o(e){return Object(r.a)()?0==e?c:a:i}},4238:function(e,t,n){"use strict";n.d(t,"a",(function(){return S})),n.d(t,"b",(function(){return E}));var r=n(0),i=n(240),c=n(419),a=n(76),o=n(428),u=n(279),s=n(287),d=n(295),l=n(4062),b=n(79),f=n(1294),p="/search/api/v1/init?",O="/search/api/v1/suggestions?",j="owa.react.compose",v=["PandaServingCompose","PandaServingComposeZeroQuery"],h="AppendFreshContactsToTopN",y="ContextAwareServing",g="20",m="5";function S(e,t,n,i,c,a,u){return Object(r.__awaiter)(this,void 0,void 0,(function(){var d,l,f,p,v;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return d=u||j,null!=t?[3,1]:[2,I(d)];case 1:return[4,_(t,n,a)];case 2:return l=r.sent(),f=function(e,t,n){return{AppName:"OWA",Scenario:{Name:n},Cvid:t||Object(o.a)(),EntityRequests:[e]}}(l,null==c?void 0:c.conversationId,d),p=s.d,v=[O+E(d,t),f,i,!1],[4,T(e,null==c?void 0:c.clientSessionId)];case 3:return[2,p.apply(void 0,v.concat([r.sent(),!0,!0,!1])).then((function(e){return e})).catch((function(e){return b.g.info(e),null}))]}}))}))}function I(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=s.b,n=[p+E(e),void 0,!0],[4,T(null)];case 1:return[2,t.apply(void 0,n.concat([r.sent(),!0,!1])).then((function(e){return Object(u.a)(e.status)?e.json():null})).catch((function(e){return e.networkError=!0,b.d(e),null}))]}}))}))}function _(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i;return Object(r.__generator)(this,(function(r){return i={Query:{QueryString:e},EntityType:"People",Provenances:P(t),Size:t?g:m},n&&n.length>0&&(i.Context=function(e){var t={};e&&(t.RecipientsTo=e.toString());return t}(n)),i.Fields=Object(l.a)(1),[2,i]}))}))}function P(e){var t=["Mailbox"];return e&&!Object(d.a)()&&t.push("Directory"),t}function E(e,t){var n={scenario:e},i=[],c=Object(f.a)();return(c||Object(a.h)("rp-cacheFirstPeopleTrieSize500cf"))&&(i.push.apply(i,Object(r.__spread)(v)),c&&Object(a.h)("rp-EnableFreshContactsForZeroQuery")&&i.push(h)),Object(a.h)("rp-contextualZeroQuery")&&""==t&&i.push(y),i.length>0&&(n.setflight=i.join(",")),Object.keys(n).map((function(e){return e+"="+n[e]})).join("&")}function T(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){return n={},t&&(n["client-session-id"]=t),e&&Object(i.n)(e)?[2,Object(c.a)(e).then((function(e){return Object.keys(e).forEach((function(t){return n[t]=e[t]})),n}))]:[2,n]}))}))}},560:function(e,t,n){"use strict";function r(e){return e>=200&&e<300}n.d(t,"a",(function(){return r}))},5708:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(428);function i(){return{maxActionBatchSize:10,entityType:1,entityScenarioName:"FindPeople_react",hasSessionStarted:!1,isSessionPaused:!1,entityFeedbackEntries:[],clientSessionId:"",clientVersion:"1.0",clientId:1,entrySequenceNumber:0,conversationId:Object(r.a)()}}},6154:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(2144),c=n(2775),a=n(1916),o=n(2190),u=n(1030),s=n(2188),d=n(964),l=n(2272),b=n(246),f=500,p="owa.react.compose";function O(){var e,t=Object(o.a)({IndexedPageItemView:Object(u.a)({BasePoint:"Beginning",Offset:0,MaxEntriesReturned:f}),PersonaShape:(e=Object(s.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(d.a)({FieldURI:"PersonaEmailAddress"}),Object(d.a)({FieldURI:"EmailAddresses"}),Object(d.a)({FieldURI:"PersonaDisplayName"}),Object(d.a)({FieldURI:"PersonaDisplayNames"}),Object(d.a)({FieldURI:"PersonaId"}),Object(d.a)({FieldURI:"PersonaType"}),Object(d.a)({FieldURI:"PersonaImAddress"}),Object(d.a)({FieldURI:"PersonaTitle"})]}),e),QuerySources:["Mailbox"],QueryString:"",SearchPeopleSuggestionIndex:!0,ShouldResolveOneOffEmailAddress:!1,Context:[Object(c.a)({Key:"AppName",Value:"OWA"}),Object(c.a)({Key:"AppScenario",Value:p})]});return Object(l.a)(Object(a.a)({Header:Object(b.a)(),Body:t})).then((function(e){return e.Body}))}var j=n(428),v=n(287),h=n(4062),y=n(4238),g=n(76),m=300,S=500,I=700;var _="/search/api/v1/suggestions?",P="owa.react.recipientcache";function E(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,T()];case 1:return e=n.sent(),t=function(e){return{AppName:"OWA",Scenario:{Name:P},Cvid:Object(j.a)(),EntityRequests:[e]}}(e),[2,Object(v.d)(_+Object(y.b)(P),t,null,!1,null,!0,void 0,!1).then((function(e){return e}),(function(e){throw new Error(e.message)}))]}}))}))}function T(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return[2,{Query:{QueryString:""},EntityType:"People",Provenances:["Mailbox"],Size:Object(g.h)("rp-cacheFirstPeopleTrieSize300")?m:Object(g.h)("rp-cacheFirstPeopleTrieSize700")?I:S,Fields:Object(h.a)(0)}]}))}))}var F=n(123),w=n(5708),A=n(2481),C=n(7),k=n(4),x=n(2142),R=Object(k.mutatorAction)("setFallbackToFindPeople",(function(e){x.a.fallbackToFindPeople=e})),D=n(2191),N=n(1619),L=n(79),z=n(1294),U=n(1558),G={Action:"Type Down"},M=Object(F.d)("tryInitializeCacheWithSource",{name:"RecipientCacheInitialization",custonData:function(e,t){return[e,t]}})((function(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var c,a,o,u,s,d;return Object(r.__generator)(this,(function(l){switch(l.label){case 0:c=Object(C.Qb)(),a="",l.label=1;case 1:switch(l.trys.push([1,7,,8]),o=void 0,e){case 0:return[3,2];case 1:return[3,4]}return[3,6];case 2:return[4,E()];case 3:return u=l.sent(),o=function(e){var t,n,i,c=[];if(e&&e.Groups){var a=null===(i=e.Instrumentation)||void 0===i?void 0:i.TraceId;try{for(var o=Object(r.__values)(e.Groups),u=o.next();!u.done;u=o.next()){var s=u.value;if("People"===s.Type){c=s.Suggestions.map((function(e){return Object(D.a)(e,a)}));break}}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}}else L.g.warn("Response groups should not be null");return c}(u),a=Object(N.a)(u),[3,6];case 4:return[4,O()];case 5:return s=l.sent(),o=s.ResultSet,a=Object(N.a)(s),[3,6];case 6:return t&&R(!0),function(e,t,n,r){e&&e.length>0&&(e.forEach((function(e){var n=Object(i.a)(e);n&&(t.store.allKeys[n]=!0)})),t.store.recipientCache=e,Object(z.a)()&&0==n&&!r&&U.b.importAndExecute(e))}(o,n,e,t),[3,8];case 7:return d=l.sent(),L.g.warn(d.message),function(e,t){Object(A.a)(Object(w.a)(),"",t,e,G)}(c,a),[3,8];case 8:return[2]}}))}))}));var Q=n(1262),q=n(1092),B=n(283),V=Object(B.action)("initializeCache")(Object(B.select)({store:function(){return Q.a}})((function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return e.store.recipientCache?[2]:(t=Object(q.a)(),[4,M(t?0:1,!1,e)]);case 1:return n.sent(),!t||e.store.recipientCache?[3,3]:[4,M(1,!0,e)];case 2:n.sent(),n.label=3;case 3:return e.store.recipientCache||(e.store.recipientCache=[]),[2]}}))}))})));n.d(t,"initializeCache",(function(){return V}))},964:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"PropertyUri:#Exchange"},e)}}}]);
//# sourceMappingURL=owa.RecipientCache.js.map
self.scriptsLoaded['owa.RecipientCache.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.RecipientCache.js'] = (new Date()).getTime();