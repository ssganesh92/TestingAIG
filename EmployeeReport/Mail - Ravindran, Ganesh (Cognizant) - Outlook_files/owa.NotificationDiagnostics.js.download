self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.NotificationDiagnostics.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[429],{10602:function(t,n,e){"use strict";e.r(n);var i=e(0),r=e(1062),a=e(76);function o(){return new Date(Date.now()).toLocaleTimeString()}function c(t,n,e){t.push(n),t.length>e&&t.splice(0,1)}var s,u=e(283),d=Object(u.action)("addChannelDatapoint")((function(t,n){c(n.datapoints,{message:t,timestamp:o()},1e3)})),f=e(2033),l="Channel",b=!1;function p(t){!function(){Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,e;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return b?[3,3]:(b=!0,s={name:l,datapoints:[]},[4,f.f.import()]);case 1:return t=i.sent(),[4,f.g.import()];case 2:n=i.sent(),e=t(),n(s),s=e.loggers.get(l),i.label=3;case 3:return[2]}}))}))}(),d(t,s)}var g=e(948);function v(t){var n="";if(t){var e=g.d.folderTable.get(t);e&&(n=e.DisplayName)}return n}function h(t){var n="";return t.Conversation?n=t.Conversation.ConversationTopic:t.Item&&(n=t.Item.Subject),n}var m,w=Object(u.action)("addNotificationDatapoint")((function(t,n){var e=t,i=t;c(n.datapoints,{id:t.id,type:t.EventType,folder:v(e.FolderId||i.folderId),subject:h(e),timestamp:o()},1e3)})),j="Notifications",D=!1;function O(t){!function(){Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,e;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return D?[3,3]:(D=!0,m={name:j,datapoints:[]},[4,f.f.import()]);case 1:return t=i.sent(),[4,f.g.import()];case 2:n=i.sent(),e=t(),n(m),m=e.loggers.get(j),i.label=3;case 3:return[2]}}))}))}(),w(t,m)}var _,S=Object(u.action)("addSubscriptionDatapoint")((function(t,n){var e;n.datapoints.push({id:t.subscriptionId,type:(null===(e=t.subscriptionParameters)||void 0===e?void 0:e.NotificationType)?t.subscriptionParameters.NotificationType:"",folder:t.subscriptionParameters?v(t.subscriptionParameters.FolderId):"",status:"Uninitialized",handlers:1,retries:0,error:""})})),I=Object(u.action)("disconnectSubscriptionDatapoint")((function(t,n){for(var e=n.datapoints,i=0;i<e.length;i++)if(e[i].id===t){e[i].status="Disconnected";break}})),T=Object(u.action)("setSubscriptionDatapointStatus")((function(t,n,e,i,r,a){for(var o=a.datapoints,c=0;c<o.length;c++)if(o[c].id===t)switch(o[c].handlers=e,o[c].retries=i,r&&(o[c].error=r),n){case 0:o[c].status="Uninitialized";break;case 3:o[c].status="Connected";break;case 2:o[c].status="Pending";break;case 1:o[c].status="Disconnected"}})),C="Subscriptions",P=!1;function N(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,e;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return P?[3,3]:(P=!0,_={name:C,datapoints:[]},[4,f.f.import()]);case 1:return t=i.sent(),[4,f.g.import()];case 2:n=i.sent(),e=t(),n(_),_=e.loggers.get(C),i.label=3;case 3:return[2]}}))}))}function y(t){N(),S(t,_)}function z(t,n,e){N(),T(t.subscriptionId,n.status,n.refs.length,n.retries,e,_)}function k(t){N(),I(t.subscriptionId,_)}var E=e(79);function U(t){E.g.warn(t)}function F(t){E.d(t)}function L(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(i.__generator)(this,(function(e){switch(e.label){case 0:return Object(a.h)("fwk-devTools")?[4,r.c.import()]:[3,2];case 1:t=e.sent(),(n=t()).on(r.a.ChannelData,p),n.on(r.a.NotificationData,O),n.on(r.a.SubscriptionAdded,y),n.on(r.a.SubscriptionRemoved,k),n.on(r.a.SubscriptionUpdated,z),n.on(r.a.TraceWarn,U),n.on(r.a.TraceError,F),e.label=2;case 2:return[2]}}))}))}e.d(n,"initializeNotificationDiagnostics",(function(){return L}))},2033:function(t,n,e){"use strict";var i=e(108),r=e(0),a=e(4),o=function(t,n,e){var i=null;return{init:function(o){var c;if(null!==i)throw new Error("Diagnostics store "+t+" was initialized multiple times");return i=Object(a.createStore)(t,n),e(i()),Object(r.__assign)(Object(r.__assign)({},o),((c={})[t]=i,c))},getIfInitialized:function(){return i?i():null}}};e.d(n,"c",(function(){return s})),e.d(n,"g",(function(){return u})),e.d(n,"f",(function(){return d})),e.d(n,"h",(function(){return f})),e.d(n,"a",(function(){return l})),e.d(n,"b",(function(){return b})),e.d(n,"d",(function(){return p})),e.d(n,"e",(function(){return o}));var c=new i.c((function(){return Promise.all([e.e(0),e.e(1),e.e(2),e.e(3),e.e(235)]).then(e.bind(null,15034))})),s=Object(i.d)(c,(function(t){return t.DiagnosticsPanel})),u=new i.a(c,(function(t){return t.registerDiagnostics})),d=(new i.b(c,(function(t){return t.setSelectedPivot})),new i.b(c,(function(t){return t.getDiagnosticsLogState}))),f=new i.b(c,(function(t){return t.initializeDefaultDiagnostics})),l=Object(i.d)(c,(function(t){return t.DiagnosticsHost})),b=Object(i.d)(c,(function(t){return t.DiagnosticsInspector})),p=Object(i.d)(c,(function(t){return t.TwoColumnInspector}))}}]);
//# sourceMappingURL=owa.NotificationDiagnostics.js.map
self.scriptsLoaded['owa.NotificationDiagnostics.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.NotificationDiagnostics.js'] = (new Date()).getTime();