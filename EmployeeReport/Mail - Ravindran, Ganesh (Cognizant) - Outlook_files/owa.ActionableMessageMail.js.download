self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.ActionableMessageMail.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[111],{10395:function(e,t,n){"use strict";var r;!function(e){e[e.LoadStart=0]="LoadStart",e[e.AutoInvokeActionStart=1]="AutoInvokeActionStart",e[e.AutoInvokeActionEnd=2]="AutoInvokeActionEnd",e[e.CardRenderStart=3]="CardRenderStart",e[e.CardRenderEnd=4]="CardRenderEnd",e[e.ThemeLoadTotalStart=5]="ThemeLoadTotalStart",e[e.ThemeLoadTotalEnd=6]="ThemeLoadTotalEnd",e[e.ThemeDefinitionsLoadStart=7]="ThemeDefinitionsLoadStart",e[e.ThemeDefinitionsLoadEnd=8]="ThemeDefinitionsLoadEnd",e[e.ThemeResolveStart=9]="ThemeResolveStart",e[e.ThemeResolveEnd=10]="ThemeResolveEnd",e[e.CardCreateStart=11]="CardCreateStart",e[e.CardCreateEnd=12]="CardCreateEnd",e[e.CardLibraryRenderStart=13]="CardLibraryRenderStart",e[e.CardLibraryRenderEnd=14]="CardLibraryRenderEnd",e[e.PrepareCardStart=15]="PrepareCardStart",e[e.PrepareCardEnd=16]="PrepareCardEnd"}(r||(r={})),t.a=r},10396:function(e,t,n){var r=n(13820),a=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},1086:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(4),a=n(24),i=Object(r.createStore)("lightningState",{unseenItems:new a.ObservableMap,lightedCount:0,lastShownId:null}),o=i()},1207:function(e,t,n){"use strict";var r=n(0),a=n(42),i=n(1255),o=n(1),s=n.n(o);function c(e,t){var n=function(t,n){return s.a.createElement(d,Object(r.__assign)({},t),s.a.createElement(e,Object(r.__assign)({},t)))};return n.displayName=e.displayName,t?s.a.forwardRef(n):n}var d=Object(a.a)((function(e){var t=e.lid,n=e.when,r=e.series,a=e.children;return s.a.useEffect((function(){return Object(i.b)(t,n,r),function(){i.c.importAndExecute(t)}}),[]),a&&l(t)?s.a.createElement(s.a.Fragment,null,a):null}));function u(e,t){i.c.importAndExecute(e,t)}function l(e){if(i.d.unseenItems){var t=i.d.unseenItems.get(e);if(null==t?void 0:t.visible)return!0}return!1}n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return d})),n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return l})),n.d(t,"b",(function(){return i.a}))},1217:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1),a={};function i(e){var t;null===(t=a[e.type])||void 0===t||t.forEach((function(t){return t(e)}))}function o(e){var t;return a[e]=null!==(t=a[e])&&void 0!==t?t:new Map}function s(e,t,n){var a=r.useRef();r.useEffect((function(){return function(e,t,n){var r=o(e);0===r.size&&window.addEventListener(e,i),r.set(t,n)}(e,a,t),function(){return function(e,t){var n=o(e);n.delete(t),0===n.size&&window.removeEventListener(e,i)}(e,a)}}),n)}},1255:function(e,t,n){"use strict";var r=n(108),a=n(1086),i=n(79),o=n(0),s=n(3),c=n(24),d=n(4),u=Object(d.mutatorAction)("initializeLightning",(function(e){var t,n;if(i.g.info("initialize lightning store"),Object(a.a)().lastShownId=null,Object(a.a)().lightedCount=0,Object(a.a)().unseenItems=new c.ObservableMap,e)try{for(var r=Object(o.__values)(e),s=r.next();!s.done;s=r.next()){var d=s.value;Object(a.a)().unseenItems.set(d.identity,d)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}}));var l=n(287),g="ows/v1.0/lightning/items/unseen";function f(){return i.g.info("initialize lightning from server"),Object(l.b)(g).then((function(e){var t=e.map(b);u(t)}))}function b(e){return e.category?{identity:e.id,visible:!1,category:e.category}:{identity:e,visible:!1}}var p,h=n(27),m=n(76),v="lightning",C="UnseenLightening";function O(){var e,t,n;if(!p){var r=Object(s.a)(v);if(r)p=function(e){i.g.info("initialize lightning from override query parameter");var t=e.split(",").map((function(e){return{identity:e,visible:!1}}));return u(t),Promise.resolve()}(r);else{var a=Object(h.a)().PrimeSettings;if(Object(m.h)("lightning-initFromSD")&&a&&a.Items)try{for(var c=Object(o.__values)(a.Items),d=c.next();!d.done;d=c.next()){var l=d.value;if(l.Id===C&&l.Value){n=l.Value,i.g.info("initialize lightning from session data"),u(n.map((function(e){return{identity:e.id,visible:!1,category:e.category}}))),p=Promise.resolve();break}}}catch(t){e={error:t}}finally{try{d&&!d.done&&(t=c.return)&&t.call(c)}finally{if(e)throw e.error}}p||(p=f())}}return p}var y=n(1855),A=Object(d.action)("lightup",(function(e){return{id:e}})),I=A;Object(d.mutator)(A,(function(e){i.g.info("lightup - id:"+e.id),Object(a.a)().lastShownId=e.id,Object(a.a)().lightedCount++;var t=Object(a.a)().unseenItems.get(e.id);t&&(t.visible=!0)})),Object(d.orchestrator)(A,(function(e){Object(y.a)("LIGHTUP",e.id)}));var j,M=n(556);function S(e,t){(i.g.info("lightupOrReject - id:"+e+", recurrenceCount:"+t+", lightedCount:"+Object(a.a)().lightedCount+", lastShown:"+Object(a.a)().lastShownId),Object(M.v)())?i.g.info("lightning is disabled for deeplink"):Object(a.a)().unseenItems.has(e)&&(!Object(a.a)().lastShownId||function(e,t){var n=!1,r=Object(a.a)().lastShownId;if(r&&t&&!function(){var e=Object(a.a)(),t=e.lastShownId,n=e.unseenItems;return t&&n.has(t)&&n.get(t).visible}()){var i=t.indexOf(r),o=t.indexOf(e);i>=0&&i+1==o&&(n=!0)}return n}(e,t)||function(e){var t=Object(a.a)().unseenItems.get(e);return!!t&&t.category==j.UIFeatureDiscovery}(e))&&I(e)}function x(e,t,n){i.g.info("beginLightning - id:"+e),t((function(){O().then((function(){return S(e,n)})).catch((function(t){i.g.warn("something is wrong, lightning id:"+e+", reason:"+t)}))}))}!function(e){e.None="0",e.UpSell="1",e.FeatureDiscovery="2",e.TeachingMoment="3",e.UITeachingMoment="4",e.UIFeatureDiscovery="5",e.UIUpSell="6",e.JITNewUser="7",e.Compliance="8",e.SatCoreMetric="9",e.UpSellExperiment="10"}(j||(j={}));var w=n(1266);n.d(t,"c",(function(){return k})),n.d(t,"d",(function(){return a.b})),n.d(t,"b",(function(){return x})),n.d(t,"a",(function(){return w.a}));var T=new r.c((function(){return n.e(360).then(n.bind(null,15282))})),k=new r.a(T,(function(e){return e.endLightningImp}))},1266:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.UserVoiceSatisfactionFirstRun="0",e.UserVoiceSatisfactionSecondRun="1",e.ConsumerRefreshFRE="2",e.AnimatedConsumerRefreshFRE="3",e.AnimatedConsumerRefreshFRE2="4",e.SettingPanelFirstRunCallout="5",e.SettingIconFirstRunCallout="6",e.AddStorageAccountCallout="7",e.PremiumDomainConnectModal="8",e.WhatsNewFlexPane="10",e.FocusOtherOff="12",e.TargetedAdsGdprPrompt="13",e.WebPushPromotion="14",e.MailGraduatedNewFeatureCarousel="15",e.EdgePromotion="20",e.ActionableMessageTeachingUiTeachingBubblePolicy="21",e.GetStartedFlexPane="22",e.CalendarSurvey="23",e.EnterpriseOptInFRE="24",e.MiniUserSurveyV1="25",e.TodoCalendarFRE="26",e.TodoMailFRE="27",e.GroupFilesHubFRE="28",e.AddCloudCacheAccountCallout="29",e.NewConsumerRecruitmentCampaign="30",e.InboxPlusFRE="31",e.BusinessCutoverCarousel="32",e.SuiteNps="33",e.InboxPlusEasyOn="34",e.InboxRulesFromDL="35",e.GdprAdsV2="36",e.TimePanelCombinedDndFRE="47",e.UaeEduPrivacyNotification="48",e.OutlookSpacesFRE="49",e.TodoFlaggedEmailList="50",e.DynamicLayoutFolderPaneCollapse="51",e.EdgeUpsell="56",e.OutlookSpacesCapturedPaneFRE="57",e.ProofingTeachingFreeUserFRE="58",e.ProofingTeachingPremiumUserFRE="59",e.OutlookSpacesNotePaneFRE="60",e.OutlookSpacesTasksPaneFRE="61",e.OutlookSpacesGoalsPaneFRE="62",e.DefaultOnlineMeetingSetting="63",e.QuickUseFRE="64",e.GdprAdsV3="65",e.SpeedyMeetingsEndEarlySetting="66",e.InboxPlusEasyOff="67"}(r||(r={}))},13813:function(e){e.exports=JSON.parse('{"a":"n7c"}')},13814:function(e){e.exports=JSON.parse('{"a":"s7c","b":"t7c","c":"u7c","d":"v7c"}')},13815:function(e){e.exports=JSON.parse('{"b":"x7c","a":"y7c","c":"z7c"}')},13816:function(e){e.exports=JSON.parse('{"a":"w7c"}')},13817:function(e){e.exports=JSON.parse('{"d":"o7c","c":"p7c","a":"q7c","b":"r7c"}')},13818:function(e,t,n){var r=n(13819),a=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},13819:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,'._2pRM5MH2wQSL6KJYv7DZjH{width:calc(100% - 25px);position:absolute;height:calc(100% - 64px)}html[dir=ltr] ._2pRM5MH2wQSL6KJYv7DZjH{margin-left:-20px;margin-right:-35px}html[dir=rtl] ._2pRM5MH2wQSL6KJYv7DZjH{margin-right:-20px;margin-left:-35px}._36_sivvBA_3QDLOOHcFq0k{width:100%;height:100%}html[dir] ._36_sivvBA_3QDLOOHcFq0k{border-width:0}._3CW7BF2coKNui2HaKAh3Zw{font-size:21px;font-weight:100;font-weight:300;color:"[theme:neutralPrimary, default:#333333]"}',""]),t.locals={opayFlexPaneContainer:"_2pRM5MH2wQSL6KJYv7DZjH",opayAppIFrameStyle:"_36_sivvBA_3QDLOOHcFq0k",flexPaneHeader:"_3CW7BF2coKNui2HaKAh3Zw"}},13820:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,"html[dir] ._3uEvU5UAdRqP1z24N4hRkz{margin-top:12px}html[dir=ltr] ._3uEvU5UAdRqP1z24N4hRkz{margin-left:52px}html[dir=rtl] ._3uEvU5UAdRqP1z24N4hRkz{margin-right:52px}.cmC6MemIKYrJJ77Z_ZD4n{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}._3FcySUHYRo6OeOulzvvAzX{-ms-flex-item-align:center;align-self:center;height:16px;line-height:16px}html[dir] ._3FcySUHYRo6OeOulzvvAzX{margin-top:8px}._3FcySUHYRo6OeOulzvvAzX ._36SOH4LiYsn62sG0PC93OB{font-size:8px}",""]),t.locals={container:"_3uEvU5UAdRqP1z24N4hRkz",cardArea:"cmC6MemIKYrJJ77Z_ZD4n",bodyToggleButton:"_3FcySUHYRo6OeOulzvvAzX",icon:"_36SOH4LiYsn62sG0PC93OB"}},14975:function(e,t,n){"use strict";n.r(t);var r,a=n(5146),i=n(79),o=n(0),s=n(1562),c=function(e){function t(t){var n=e.call(this)||this;return n.preserveBody=t,n}return Object(o.__extends)(t,e),t.prototype.internalPrepareForExecution=function(t){var n=this.body;e.prototype.internalPrepareForExecution.call(this,t),this.preserveBody&&(this.body=n)},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary},t}(s.HttpAction),d=n(13813),u="Action.Http",l="HttpPOST",g="Action.Submit";!function(e){e.None="none",e.ConnnectorMessage="connectorMessage",e.ExplicitMessageCard="explicitMessageCard",e.RecommendationCard="recommendationCard",e.AddInRecommendationCard="addInRecommendationCard",e.CardHighlight="cardHighlight",e.AdaptiveCard="adaptiveCard",e.ListViewExtractedAction="listViewExtractedAction"}(r||(r={}));var f=n(65),b=n(2),p=n(27),h="WAC_Outlook_React";function m(e,t,n,a,i,s){var c,d=0,u=Object(p.a)(),l=u.UserOptions.MailboxTimeZoneOffset;l&&l.length>0&&l[0].OffsetRanges&&l[0].OffsetRanges.length>0&&(d=l[0].OffsetRanges[0].Offset,c=l[0].TimeZoneId);var g=u.SessionSettings.UserCulture,m={clientType:h,eventName:e,culture:g,uiCulture:g,mailboxType:n?"Group":"User",correlationVector:i||Object(f.b)(),clientVersion:Object(b.j)(),externalDirectoryUserGuid:u.SessionSettings.ExternalDirectoryUserGuid,externalDirectoryTenantGuid:u.SessionSettings.ExternalDirectoryTenantGuid,timeZone:{type:"Windows",id:c,offsetInMinutes:d},originator:t.card.originator,providerAccountUniqueId:t.providerAccountUniqueId,messageType:t.isAdaptiveCard?r.AdaptiveCard.toString():r.ExplicitMessageCard.toString(),messageCardExtensionContext:t.messageCardExtensionContext,messageCardContext:t.card.messageCardContext,genericInfo:s};if(a){var v=function(e,t){var n={};e&&(n.senderAddress=e.senderAddress,n.isGroupEscalationMessage=e.isGroupEscalationMessage,t?(n.threadId=e.conversationId,n.conversationId=n.conversationId,n.postId=e.itemId,n.messageId=n.itemId):(n.messageId=e.itemId,n.conversationId=e.conversationId));return n}(a,n);m=Object(o.__assign)(Object(o.__assign)({},m),v)}return m}var v,C,O=n(4);!function(e){e[e.UnResolved=0]="UnResolved",e[e.InProgress=1]="InProgress",e[e.Resolved=2]="Resolved"}(v||(v={})),function(e){e[e.Empty=0]="Empty",e[e.Success=1]="Success",e[e.Error=2]="Error"}(C||(C={}));var y={cache:{data:null,state:C.Empty,time:null},requestState:v.UnResolved},A=Object(O.createStore)("amClientConfigurationStore",y)(),I=function(){var e,t,n=null;return(null===(t=null===(e=A.cache.data)||void 0===e?void 0:e.clientTimeouts)||void 0===t?void 0:t.default)&&(n=A.cache.data.clientTimeouts.default),n},j=n(254),M=n(114),S=n(2807),x=n(9),w=n(9638),T=n(9639),k=n(35),D="30d2f5e2-6e6f-43b0-a2bd-c9d87a5cd6fd",E="Action.",R=function(e,t,n,r,a){var i=e["@id"]?e["@id"]:e.id,c={"@type":"HttpPOST",name:e.title,target:e.url,body:e.body,"@id":i,hideCardOnInvoke:e.hideCardOnInvoke,isPrimaryAction:!!e.isPrimary&&e.isPrimary};e.headers&&e.headers.length>0&&(c.headers=e.headers);var d=Object(p.a)(),l=[];if(t)for(var g=0;g<t.length;g++){var f=t[g],b=new s.ValidationResults;if(f.internalValidateProperties(b),b.failures.length>0)return Promise.resolve({success:!1,displayMessage:b.failures[0].errors[0].message});if(f){var h=void 0;h=f instanceof s.DateInput?{id:f.id,value:f.value,usertimezone:d.UserOptions.TimeZone}:{id:f.id,value:f.value},l.push(h)}}var v,C={type:u,url:e.url,body:e.body,method:e.method,id:e.id?e.id:D,headers:e.headers},O=d.SessionSettings.UserCulture,y=m(_(e,a),n,r.mailboxInfo.type===M.a.GroupMailbox,r);return y.actionId=i,y.actionType=e.getJsonTypeName(),n.isAdaptiveCard?v={httpAction:C,inputParameters:l,connectorSenderGuid:n.connectorSenderGuid,SmtpAddressesSerialized:n.smtpAddressesSerialized,adaptiveCardSignature:n.cardSignature,providerAccountUniqueId:n.providerAccountUniqueId,clientTelemetry:y,adaptiveCardHash:n.cardHash,senderAddress:r.senderAddress}:(c=Object(o.__assign)(Object(o.__assign)({},e.originalJsonPayload),c),v={inputParameters:l,connectorSenderGuid:n.connectorSenderGuid,potentialAction:JSON.stringify(c),SmtpAddressesSerialized:n.smtpAddressesSerialized,messageCardSignature:n.cardSignature,providerAccountUniqueId:n.providerAccountUniqueId,clientTelemetry:y,tenantObjectId:d.SessionSettings.ExternalDirectoryTenantGuid,messageCardHash:n.cardHash,senderAddress:r.senderAddress,culture:O,uiCulture:O}),F(P(r,O,n.isAdaptiveCard),JSON.stringify(v),"HttpAction",null,H(n),a)},_=function(e,t){return t?"AutoInvokeActionClicked":e.parent&&"InlineAdaptiveCard"===e.parent.constructor.name?"ActionCardHttpPostActionClicked":"SingleClickHttpPostActionClicked"},P=function(e,t,n){var r=e.mailboxInfo.type===M.a.UserMailbox?"userid":e.mailboxInfo.mailboxSmtpAddress,a=e.odataItemId,i=e.odataConversationId;switch(e.mailboxInfo.type){case M.a.UserMailbox:return n?Object(x.c)("/actions/{0}/messages/{1}/adaptiveCard/executeAction?culture={2}",r,a,t):Object(x.c)("/actions/{0}/messages/{1}/executeAction?culture={2}",r,a,t);case M.a.GroupMailbox:case M.a.TeamsMailbox:return n?Object(x.c)("/actions/{0}/threads/{1}/posts/{2}/adaptiveCard/executeAction?culture={3}",r,i,a,t):Object(x.c)("/actions/{0}/threads/{1}/posts/{2}/executeAction?culture={3}",r,i,a,t);case M.a.PublicMailbox:case M.a.SharedMailbox:return null}},F=function(e,t,n,r,a,s){return void 0===s&&(s=!1),Object(o.__awaiter)(void 0,void 0,void 0,(function(){var c,u,l,g;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:c=r||Object(f.b)(),u={correlationVector:c,cardCorrelationId:a,requestType:n},o.label=1;case 1:return o.trys.push([1,5,,6]),[4,Object(S.a)()];case 2:return(l=o.sent())?[3,4]:(i.g.warn("[ActionableMessageDebug] makePostRequest: Unable to get the client Auth token possibly AAD token"),[4,Object(S.b)()]);case 3:l=o.sent(),o.label=4;case 4:if(!l)throw new Error("Token is empty: "+l);return[3,6];case 5:return g=o.sent(),i.g.warn("[ActionableMessageDebug] makePostRequest: Error while getting token, error: "+g),Object(j.m)("ActionableMessageConnectorsPostRequestErrorGettingToken",void 0,void 0,g,u,{isCore:!0}),[2,{success:!1,displayMessage:Object(x.b)(d.a)}];case 6:return[4,N(e,l,t,s,c,u)];case 7:return[2,o.sent()]}}))}))},N=function(e,t,n,r,a,i){return new Promise((function(o){var s=new XMLHttpRequest;s.onreadystatechange=function(){4===s.readyState&&o(L(200===s.status,s.responseText))},s.ontimeout=function(){o({success:!1,displayMessage:Object(x.b)(d.a)}),Object(j.m)("ActionableMessageConnectorsPostRequestTimeout",void 0,void 0,void 0,i,{isCore:!0})},s.open("POST",e,!0),s.timeout=function(e){var t=e?6e3:1e4,n=I();return e&&(null==n?void 0:n.AutoInvokedActionTimeoutInMsec)?t=n.AutoInvokedActionTimeoutInMsec:!e&&(null==n?void 0:n.HttpActionTimeoutInMsec)&&(t=n.HttpActionTimeoutInMsec),t}(r),s.setRequestHeader("MS-CV",a),s.setRequestHeader("X-OWA-CANARY",Object(k.a)()),s.setRequestHeader("Authorization","Bearer "+t),s.send(n)}))},L=function(e,t){try{var n=JSON.parse(t),r=!!e&&U(n.status);return{success:r,displayMessage:n.displayMessage?n.displayMessage:r?Object(x.b)(T.a):Object(x.b)(w.a),performedAt:n.performedAt,newCardPayload:n.refreshCardSerialized,newCardSignature:n.refreshCardSignature,removeCard:n.removeCard,showOriginalCard:n.showOriginalCard,hideCard:n.hideCard}}catch(e){return{success:!1,displayMessage:Object(x.b)(w.a)}}},U=function(e){return e&&"completed"===e.toLowerCase()},H=function(e){try{return e.card.messageCardContext.correlationId}catch(e){return""}};var z=n(7);function B(e){return 0===Object.keys(e).length}function q(e){var t=[],n=e.previousCardCheckpoints&&!B(e.previousCardCheckpoints)?e.previousCardCheckpoints:e.currentCardCheckpoints,r=null;e.previousCardCheckpoints&&!B(e.previousCardCheckpoints)&&(r=e.currentCardCheckpoints);var a=Object(z.w)(n.cardCreateEnd,n.cardCreateStart);t.ICPT=a;var i=Object(z.w)(n.cardRenderEnd,n.cardRenderStart);t.ICRT=i;var o=Object(z.w)(n.themeLoadTotalEnd,n.themeLoadTotalStart);t.ICTT=o;var s=n.totalFetchTime;t.ICFT=s;var c=Object(z.w)(n.cardLibraryRenderEnd,n.cardLibraryRenderStart);t.ICHT=c;var d=Object(z.w)(n.prepareCardEnd,n.prepareCardStart);if(t.IPPT=d,r){var u=Object(z.w)(r.cardCreateEnd,r.cardCreateStart);t.FCPT=u;var l=Object(z.w)(r.cardRenderEnd,r.cardRenderStart);t.FCRT=l;var g=Object(z.w)(r.themeLoadTotalEnd,r.themeLoadTotalStart);if(t.FCTT=g,r.totalFetchTime){var f=r.totalFetchTime;t.FCFT=f}var b=Object(z.w)(r.cardLibraryRenderEnd,r.cardLibraryRenderStart);t.FCHT=b;var p=Object(z.w)(r.prepareCardEnd,r.prepareCardStart);t.FPPT=p}if(e.autoInvokeActionStart&&e.autoInvokeActionEnd){var h=Object(z.w)(e.autoInvokeActionEnd,e.autoInvokeActionStart);t.AIT=h}var m=Object(z.w)(r?r.cardRenderEnd:n.cardRenderEnd,e.loadStart);return t.TCRT=m,function(e){var t="[";return Object.keys(e).forEach((function(n,r){0!==r&&(t+=", "),t+='"'+n+'": "'+e[n]+'"'})),t+="]"}(t)}var G="/actions/{0}/clientTelemetry/",W="mailboxId";function J(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function(){var n;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:return n=t?Object(x.c)(G,t):Object(x.c)(G,W),[4,F(n,JSON.stringify(e),"Telemetry",e.correlationVector)];case 1:return r.sent(),[2]}}))}))}function V(e){var t=new c(!0);return t.method="POST",t.body=e.body,t.title=e.name,t.originalJsonPayload=e,e.headers&&e.headers.length>0&&(t.headers=[],e.headers.forEach((function(e){t.headers.push(new s.HttpHeader(e.name,e.value))}))),t.url=e.target,t["@id"]=e["@id"],t.hideCardOnInvoke=e.hideCardOnInvoke,t}var Y=n(76),K=n(295);var Z=n(8),Q=function(){return!!Object(Z.b)(window)&&!!Object(Z.a)(window,"ActionableMessages.ClientConfiguration")},X=function(){return A.cache.state!==C.Empty},$=function(){var e=Date.now()-A.cache.time;return A.cache.state===C.Success&&e>=432e6||A.cache.state===C.Error&&e>=864e5},ee=Object(O.mutatorAction)("updateRequestState",(function(e){A.requestState=e})),te=function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n,r;return Object(o.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,6,,7]),e="/actions/v1.0/"+Object(M.d)()+"/clientConfigs/WAC_Outlook_React?clientVersion="+Object(b.j)()+"&clientColorScheme=default&$expand=providerConfigs",[4,Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return Object(o.__generator)(this,(function(n){switch(n.label){case 0:return e=new Headers,[4,Object(S.a)()];case 1:return t=n.sent(),e.set("Authorization",function(e){return"Bearer "+e}(t)),e.set("MS-CV",Object(f.b)()),[2,e]}}))}))];case 1:return t=a.sent(),n=new Request(e,{method:"GET",headers:t}),[4,fetch(n)];case 2:return(r=a.sent()).ok?[4,r.json()]:[3,4];case 3:return[2,a.sent()];case 4:throw r;case 5:return[3,7];case 6:throw a.sent();case 7:return[2]}}))}))},ne=Object(O.mutatorAction)("setClientConfiguration",(function(e){A.cache=e})),re=function(e,t){return{data:e,state:t,time:Date.now()}},ae=Object(O.action)("loadClientConfiguration");Object(O.orchestrator)(ae,(function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return Object(o.__generator)(this,(function(n){switch(n.label){case 0:ee(v.InProgress),e=null,n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,te()];case 2:return t=n.sent(),e=re(t,C.Success),[3,5];case 3:return n.sent(),e=re(null,C.Error),[3,5];case 4:return ne(e),function(e){if(Object(Z.b)(window))try{Object(Z.d)(window,"ActionableMessages.ClientConfiguration",JSON.stringify(e))}catch(e){i.g.info("[ActionableMessageDebug] owa-actionable-message-connectors loadClientConfiguration setClientConfigurationInLocalStorage Exception on setItem|JSON.stringify "+e.toString())}}(e),ee(v.Resolved),[7];case 5:return[2]}}))}))}));var ie=ae,oe=function(){A.requestState!==v.InProgress&&ie()},se=function(){return Q()?JSON.parse(Object(Z.a)(window,"ActionableMessages.ClientConfiguration")):null},ce=function(){return A.cache.state},de=function(){return X()?($()&&oe(),ce()===C.Success):Q()?(ne(se()),ee(v.Resolved),$()&&oe(),ce()===C.Success):(oe(),!1)},ue=function(){return A.cache},le=function(){var e,t,n=!1;if(de()){var r=ue();(null===(t=null===(e=null==r?void 0:r.data)||void 0===e?void 0:e.organizationConfigs)||void 0===t?void 0:t.SmtpActionableMessagesEnabled)&&(n=!0)}return n},ge=function(e,t){var n,r,a=!1;try{for(var i=Object(o.__values)(e),s=i.next();!s.done;s=i.next()){if(s.value.originator===t){a=!0;break}}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},fe=function(e,t){var n,r,a=!1;if(de()){var i=ue();!t&&(null===(n=null==i?void 0:i.data)||void 0===n?void 0:n.providerConfigs)?a=ge(i.data.providerConfigs,e):t&&(null===(r=null==i?void 0:i.data)||void 0===r?void 0:r.providerConfigsDarkMode)&&(a=ge(i.data.providerConfigsDarkMode,e))}return a},be="data:",pe="blob:";function he(e,t){var n=e.querySelectorAll('img:not([src^="cid:"])');if(n)for(var r=0;r<n.length;r++)0!==n[r].src.indexOf(be)&&0!==n[r].src.indexOf(pe)&&me(n[r],t.mailboxSmtpAddress)}function me(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function(){var n;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Object(S.b)()];case 1:return r.sent(),e.src="/actions/"+t+"/th?u="+encodeURIComponent(e.src),[3,3];case 2:return n=r.sent(),i.g.warn("[ActionableMessageDebug] fixSrcForExternalImage: Error setting src value. Exception: "+n.message),[3,3];case 3:return[2]}}))}))}var ve="20000101001",Ce=window.location.origin+"/actions/theme";function Oe(e){return void 0===e&&(e="default"),Object(o.__awaiter)(this,void 0,void 0,(function(){var t,n,r,a,i,s;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return[4,Object(S.b)()];case 1:t=o.sent(),n=function(e,t){var n={},r=Object(b.j)()?Object(b.j)():ve;return r=r.replace(/[^\d]/g,""),n.method="GET",n.headers=new Headers,n.headers.set("X-ClientType","owa"),n.headers.set("X-ClientVersion","16."+r.substr(0,4)+"."+r.substr(4,4)+"."+r.substr(8)),n.headers.set("X-ClientColorScheme",t),n.headers.set("Authorization","Bearer "+e),n}(t,e),r=void 0,o.label=2;case 2:return o.trys.push([2,7,,8]),[4,fetch(Ce,n)];case 3:return(a=o.sent())&&200==a.status?(i=ye,[4,a.text()]):[3,5];case 4:return[2,i.apply(void 0,[o.sent()])];case 5:r=a?a.status+"-"+a.statusText:"No response",o.label=6;case 6:return[3,8];case 7:return s=o.sent(),r=s.message,[3,8];case 8:throw r}}))}))}function ye(e){var t={};try{var n=JSON.parse(e).connectors;Object.keys(n).forEach((function(e){var r={themeConfigUrl:n[e],hostConfig:null,stylesheetUrl:null,isResolved:!1};t[e]=r}))}catch(e){i.g.warn("[ActionableMessageDebug] downloadThemeDefinition: error parsing response: "+e)}return t}var Ae={logTelemetry:function(e){var t,n=e.mailboxInfo,r=e.eventName,a=e.cardDetails,o=e.messageContext,s=e.correlationVector,c=e.elementDetails,d=e.actionContext,u=e.perfCheckpoints,l=n.type===M.a.GroupMailbox;if(u)try{t=q(u)}catch(e){i.g.warn("[ActionableMessageDebug] logTelemetry: exception when calculating genericInfo datapoint: "+e.message)}var g=m(r,a,l,o,s,t);return g.connectorSenderGuid=a.connectorSenderGuid,d&&(g.actionContext=d),c&&0===c.type.indexOf(E)&&(g.actionId=c.id?c.id:D,g.actionType=c.type),Object(j.o)("AdaptiveCardLogger-"+r,{CorrelationVector:s}),J(g,l?n.mailboxSmtpAddress:null),i.g.info("[logTelemetry] Log telemetry triggered"),g.correlationVector}},Ie={registerActions:function(){s.AdaptiveCard.actionTypeRegistry.unregisterType(g),s.AdaptiveCard.actionTypeRegistry.registerType(u,(function(){return new c(!1)}))},executeAction:function(e,t,n,r,a,o,s){return e instanceof c&&(R(e,n,t,a,s).then((function(e){i.g.info("[ActionableMessageDebug] onExecuteAction: executeHttpAction response: "+e),r(e)})),!0)},parseLegacyMessageCardAction:function(e,t){switch(e["@type"]){case"HttpPOST":return V(e)}return null},processAutoInvokeAction:function(e,t){if(e.type===u||e["@type"]===l){var n=void 0;return t.isAdaptiveCard?((n=new c(!1)).parse(e),n.hideCardOnInvoke=e.hideCardOnInvoke):n=V(e),n}return null},registerHostCapabilities:function(e){Object(Y.h)("rp-actionableMessages-aad-token")&&!Object(K.a)()&&(e.AADAuthentication="*")}},je="CardLinkInteraction";function Me(e,t,n,r){i.g.info("[logAdaptiveCardLinkInteraction] Log event captured for link interaction on an adaptive card");var o=Object(a.e)(n);n.card&&o?Ae.logTelemetry({mailboxInfo:t,cardDetails:n,eventName:je+"_"+o,messageContext:r}):i.g.warn("[ActionableMessageDebug] logAdaptiveCardLinkInteraction: Cannot log link interaction - message card context is undefined")}var Se="00000000-0000-0000-0000-000000000000",xe="Highlight_";function we(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t,n,r,s,c,d,u,l,g;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:try{t=JSON.parse(e)}catch(t){throw new Error("[ActionableMessageCard] parseCardProperty: unable to parse card data: "+e)}return n={connectorSenderGuid:t.ConnectorSenderGuid?t.ConnectorSenderGuid:Se,smtpAddressesSerialized:t.SmtpAddressesSerialized,providerAccountUniqueId:t.ProviderAccountUniqueId,messageCardExtensionContext:t.MessageCardExtensionContext},r=[],t.AdaptiveCardSerialized?(c=(s=r).push,[4,a.f.import().then((function(e){return e(n,t.AdaptiveCardSerialized,t.AdaptiveCardSignature,!0)}))]):[3,2];case 1:return c.apply(s,[o.sent()]),[3,5];case 2:return t.MessageCardSerialized?(u=(d=r).push,[4,a.f.import().then((function(e){return e(n,t.MessageCardSerialized,t.MessageCardSignature,!1)}))]):[3,4];case 3:return u.apply(d,[o.sent()]),[3,5];case 4:return i.g.info("[ActionableMessageCard] parseCardProperty: No serialized card present"),[2,[]];case 5:return g=(l=r).concat,[4,Te(t,n)];case 6:return[2,g.apply(l,[o.sent()])]}}))}))}function Te(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function(){var n,r=this;return Object(o.__generator)(this,(function(s){switch(s.label){case 0:return n=[],[4,Promise.all(Object.keys(e).map((function(s){return Object(o.__awaiter)(r,void 0,void 0,(function(){var r,c,d,u;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:if(!e.hasOwnProperty(s)||0!==s.indexOf(xe))return[3,4];r=e[s],o.label=1;case 1:return o.trys.push([1,3,,4]),c=JSON.parse(r),[4,a.f.import().then((function(e){return e(t,c.card,null)}))];case 2:return(d=o.sent()).isContextual=!0,d.key=c.id,d.highlightTerm=c.text,n.push(d),[3,4];case 3:return u=o.sent(),i.g.warn("[ActionableMessageDebug] RenderCard: unable to render hightlight card: "+u.message),[3,4];case 4:return[2]}}))}))})))];case 1:return s.sent(),[2,n]}}))}))}var ke=n(1291),De=n(1421),Ee=n(2772),Re=n(484),_e=n(420),Pe="IOpenTypedFacet.Com.Microsoft.Graph.MessageCard",Fe="E550B918-9859-47B9-8095-97E4E72F1926";function Ne(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t,n,r,a,s;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,4,,5]),t=Object(Re.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(_e.a)(Fe,Pe,"String")]}),[4,Object(ke.a)([e.ItemId.Id],t,null)];case 1:return n=o.sent(),Object(De.a)(n[0])?(r=n[0],a=r.Items[0],(s=Object(Ee.a)(a,null,Pe))?[4,we(s)]:[3,3]):[3,3];case 2:return[2,o.sent()];case 3:return[3,5];case 4:return o.sent(),[3,5];case 5:return i.g.info("[loadCardDetailsForItem] extendedProperty could not be retrieved"),[2,null]}}))}))}function Le(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return e.adaptiveCardDetails?[2,e.adaptiveCardDetails]:[4,Ne(e)];case 1:return[2,t.sent()||[]]}}))}))}var Ue=n(42),He=Object(O.mutatorAction)("addCardDetailsOnItem",(function(e,t){e.adaptiveCardDetails&&e.adaptiveCardDetails.length>0?i.g.info("[ActionableMessageDebug] addCardDetailsOnItem - item already has a card details"+e.adaptiveCardDetails):e.adaptiveCardDetails=t})),ze=Object(O.mutatorAction)("updateCardDetailsOnItem",(function(e,t){e.adaptiveCardDetails=t})),Be=Object(O.mutatorAction)("SET_SHOW_BODY_WITH_MESSAGE_CARD",(function(e,t){e?e.showBodyWithMessageCard=t:i.g.warn("[ActionableMessageDebug] setShowBodyWithMessageCard: viewState undefined")})),qe=Object(O.action)("showCardLoading",(function(e,t){return{viewState:e,showCardLoading:t}})),Ge=(Object(O.mutator)(qe,(function(e){e.viewState.showCardLoading=e.showCardLoading})),n(1623)),We=n(966),Je=n(9215),Ve=/url\("(.*)"\)/g,Ye=new Je.a(5,5e3),Ke=function(e,t,n){var r=e.querySelectorAll('img[src^="cid:"]');if(r)for(var a=0;a<r.length;a++)Ze(r[a],t,n);var i=e.querySelectorAll("div[style*='background-image: url(\"cid:']");if(i)for(a=0;a<i.length;a++)Xe(i[a],t,n)},Ze=function(e,t,n){if(e.src&&0===e.src.indexOf("cid:")){e.classList.add("ac-hidden");var r=$e(e.src,t,n);if(r){e.onload=function(t){e.classList.remove("ac-hidden"),Ye.processNextRequest()},e.onerror=function(t){e.classList.remove("ac-hidden"),Ye.processNextRequest()},Ye.registerCallback((function(t){t||(e.src=r)}))}}},Qe=function(){Ye.clearQueue()},Xe=function(e,t,n){var r=e.style.backgroundImage,a=Ve.exec(r);if(a&&a.length>1&&a[1]){var i=$e(a[1],t,n);i&&(e.style.backgroundImage=Object(x.c)('url("{0}")',i))}},$e=function(e,t,n){if(!t.Attachments)return null;for(var r,a=et(e.substring("cid:".length)),s=0;s<t.Attachments.length;s++){var c=t.Attachments[s];if(a===et(c.Name)||a===et(c.ContentId)){r=c.AttachmentId;break}}if(!r)return i.g.warn("[ActionableMessageDebug] fixSrcForImage: attachment id not found for cid: "+a),null;var d=Object(Ge.b)(Object(o.__assign)(Object(o.__assign)({},r),{mailboxInfo:n}),1);return d||(i.g.warn("[ActionableMessageDebug] fixSrcForImage: could not create attachment url for image with cid: "+a+" and attachment id: "+r),null)},et=function(e){if(Object(We.g)(e)){var t=Object(We.b)(e);return e.substring(0,e.length-t.length)}return e},tt=n(7939),nt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.getJsonTypeName=function(){return"DisplayAppointmentForm"},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.itemId=t.itemId,this.isPrimary=t.isPrimary},t}(s.Action),rt="Action.InvokeAddInCommand",at="Action.DisplayReplyAllForm",it="Action.DisplayAppointmentForm",ot="Action.DisplayMessageForm",st="Action.StartBotConversation",ct=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.getJsonTypeName=function(){return ot},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.itemId=t.itemId,this.isPrimary=t.isPrimary},t}(s.Action),dt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.getJsonTypeName=function(){return"DisplayReplyAllForm"},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary},t}(s.Action),ut=function(e){function t(){var t=e.call(this)||this;return t.addinId="",t.desktopCommandId="",t.initializationContext="",t}return Object(o.__extends)(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary,this.addinId=t.addInId?t.addInId:t.addinid,this.desktopCommandId=t.desktopCommandId?t.desktopCommandId:t.desktopcommandid,this.initializationContext=t.initializationContext?JSON.stringify(t.initializationContext):JSON.stringify(t.initializationcontext)},t.prototype.getJsonTypeName=function(){return rt},t}(s.Action),lt=function(e){function t(){var t=e.call(this)||this;return t.botId="",t.initialMessage="",t.botName="",t}return Object(o.__extends)(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary,this.botId=t.botId,this.botName=t.botName,this.initialMessage=t.initialMessage},t.prototype.getJsonTypeName=function(){return st},t}(s.Action),gt=n(1049),ft=n(1097),bt=n(9618),pt=n(1292),ht=n(3261),mt=n(6526),vt=n(961),Ct="MessageCardInvokeAddinCommandClicked",Ot="DisplayAppointmentFormClicked",yt="DisplayMessageFormClicked",At="actionContext";var It={registerActions:function(){s.AdaptiveCard.actionTypeRegistry.registerType(rt,(function(){return new ut})),s.AdaptiveCard.actionTypeRegistry.registerType(at,(function(){return new dt})),s.AdaptiveCard.actionTypeRegistry.registerType(it,(function(){return new nt})),s.AdaptiveCard.actionTypeRegistry.registerType(ot,(function(){return new ct})),Object(Y.h)("mc-botConversation")&&s.AdaptiveCard.actionTypeRegistry.registerType(st,(function(){return new lt}))},executeAction:function(e,t,n,r,a,o,c){var d={id:e.id,type:e.getJsonTypeName()},u={mailboxInfo:a.mailboxInfo,cardDetails:t,elementDetails:d,messageContext:a,actionContext:e[At],eventName:void 0};if(e instanceof dt){i.g.info("[ActionableMessageDebug] onExecuteAction: reply all with: "+e.title);var l=vt.HtmlSanitizer.sanitizeHtml(e.title);pt.o.importAndExecute({referenceItemId:{Id:a.itemId,mailboxInfo:a.mailboxInfo},isReplyAll:!0,useFullCompose:!1,actionSource:"Link",instrumentationContexts:null,conversationId:a.conversationId,body:l})}else if(e instanceof nt){i.g.info("[ActionableMessageDebug] onExecuteAction: display appointment form for itemId: "+e.itemId),u.eventName=Ot,o.logTelemetry(u);var g="/calendar/item/"+encodeURIComponent(e.itemId);window.open(g,"_blank")}else if(e instanceof ct)i.g.info("[AdaptiveCard] DisplayMessageFormAction executed"),u.eventName=yt,o.logTelemetry(u),Object(ht.a)(e.itemId);else if(e instanceof ut){i.g.info("[AdaptiveCard] InvokeAddinCommandAction executed"),u.eventName=Ct,o.logTelemetry(u);var f=e,b=Object(gt.o)(a.itemId);gt.w.import().then((function(e){e(b,f.addinId.toLowerCase(),f.desktopCommandId,ft.a.MessageRead,f.initializationContext)}))}else if(e instanceof lt){var p=e,h=p.botId,m=p.botName,v=function(e){if(null==e?void 0:e.$data)return e.$data;return}(t.card);i.g.info("[ActionableMessageDebug] StartBotConversation executed with message: "+h),bt.a.import().then((function(e){return e(a.mailboxInfo,{friendlyBotName:m,botId:h,botData:v,connectorSenderGuid:t.connectorSenderGuid,smtpAddressSerialized:t.smtpAddressesSerialized},"help")})),o.logTelemetry(u)}else{if(!(e instanceof s.OpenUrlAction))return!1;if("mailto:"===(g=new URL(e.url)).protocol.toLowerCase()){var C=Object(mt.a)(g.href).composeInitProps;pt.m.importAndExecute(C,2)}}return!0},parseLegacyMessageCardAction:function(e,t){switch(e["@type"].toLowerCase()){case"displayreplyallform":return n=e,(r=new dt).title=n.name,r.htmlBody=n.htmlBody,r;case"invokeaddincommand":return function(e){var t=new ut;return t.title=e.name,t.addinId=e.addInId,t.desktopCommandId=e.desktopCommandId,t.initializationContext=JSON.stringify(e.initializationContext),t}(e)}var n,r;return null},processAutoInvokeAction:function(e,t){if(Object(Y.h)("mc-botConversation")&&e.type===st){var n=new lt;return n.parse(e),n}return null},registerHostCapabilities:null},jt=n(13814),Mt=n(13815),St=n(13816),xt=n(341);var wt,Tt=n(1),kt=n(13817),Dt=n(4277),Et=n(100),Rt=n(1207),_t=n(2846),Pt="ActionableMessageTeachingUI",Ft=""+Pt,Nt={CLICK:Ft+"_BtnClicked",GOTITCUSTOM:Ft+"_GotItClicked",LEARN:Ft+"_LearnMoreClicked",TRIGGERED:Ft+"_Triggered",DISMISSED:{BTNSCT:Ft+"_DismisByAction",UNMNT:Ft+"_DismissByUnmount"},SCOPE:{MOUNTED:Ft+"_Mounted",UNMNTED:Ft+"_Unmounted"},DISABLED:Ft+"_FlightDisabled",RENDERED:Ft+"_Rendered"},Lt={Transaction:"https://support.office.com/en-us/article/pay-bills-and-invoices-in-outlook-using-microsoft-pay-1196e7e6-c096-44f1-a18a-9df3af832a48"};function Ut(e,t){Object(j.o)(e,t),J(Object(o.__assign)({eventName:e,clientVersion:t.owaVersion,clientType:"WAC_Outlook_React"},t),null)}function Ht(e){if(e)try{i.g.info("[ActionableMessageTeachingUI] Corelation telemetry trace function called"),function(e){wt=wt||{correlationVector:"",adaptiveCardCorrelationId:"",owaVersion:"",messageId:"",lightningAction:"",tuiType:""},Object(_t.a)(wt,e)}(e)}catch(e){i.g.warn("[ActionableMessageDebug] teachingUITrace: Failed complete the logging of the telemetry - "+e.message)}return wt&&(wt.correlationVector=wt?Object(f.b)():void 0),wt}var zt=Object(Rt.c)(Object(Ue.a)((function(e){e=Object(o.__assign)({hasSmallIcon:!0,hasSmallHeadline:!0,hasCloseIcon:!0,isWide:!0},e);var t=Object(o.__read)(Tt.useState(!0),2),n=t[0],r=t[1];Tt.useEffect((function(){return i.g.info("[ActionableMessageTeachingUI:TeachingBubble] Teaching Bubble DidMount"),Ut("TeachingBubble_"+Nt.SCOPE.MOUNTED,Ht()),function(){i.g.info("[ActionableMessageTeachingUI:TeachingBubble] Teaching Bubble WillUnmountMount"),Ut("TeachingBubble_"+Nt.SCOPE.UNMNTED,Ht())}}),[]);var a=function(t){void 0===t&&(t="Primary"),"Secondary"==t?(i.g.info("[ActionableMessageTeachingUI:TeachingBubble] teacing bubble dismissed by user interaction"),Ut("TeachingBubble_"+Nt.CLICK,Ht({lightningAction:t}))):(i.g.info("[ActionableMessageTeachingUI:TeachingBubble] teaching bubble passively dismissed"),Ut("TeachingBubble_"+Nt.DISMISSED.UNMNT,Ht({lightningAction:t}))),Object(Rt.d)(e.lid,t),r(!1)};return n&&(i.g.info("[ActionableMessageTeachingUI:TeachingBubble] Using TeachingBubble for ActionableMessageTeachingUI"),Ut("TeachingBubble_"+Nt.RENDERED,Ht())),n&&Tt.createElement(Dt.a,Object(o.__assign)({calloutProps:{beakWidth:15,directionalHint:Et.DirectionalHint.leftCenter,minPagePadding:50},targetElement:e.target(),primaryButtonProps:Object(o.__assign)(Object(o.__assign)({},e.gotItBtn),{onClick:function(){Ut("TeachingBubble_"+Nt.GOTITCUSTOM,Ht({lightningAction:"Secondary"})),a("Secondary")}}),secondaryButtonProps:Object(o.__assign)(Object(o.__assign)({},e.learnMoreBtn),{onClick:function(){Ut("TeachingBubble_"+Nt.LEARN,Ht({lightningAction:"Secondary"})),window.open(e.learnMoreBtnUri,"_blank"),a("Secondary")}}),onDismiss:function(){return e.onClose||a("Primary")}},e,{target:void 0}),e.bodyText)}))),Bt=n(2243),qt=(n(288),Object(Ue.a)((function(e){Tt.useEffect((function(){var t;t={adaptiveCardCorrelationId:e.acCorrelationId,messageId:e.messageId,tuiType:e.actionType},Ft=Pt+"_",Ht({adaptiveCardCorrelationId:t.adaptiveCardCorrelationId,messageId:t.messageId,owaVersion:Object(b.j)(),lightningAction:"",tuiType:t.tuiType})}),[]);var t;return"Transaction"==e.actionType&&Tt.createElement(zt,{target:e.target,when:function(e){Ut(Nt.TRIGGERED,Ht()),e()},gotItBtn:(t="TeachingBubble",{buttonType:Bt.a.primary,children:Object(x.b)(kt.a),onClick:t}),learnMoreBtn:Gt("TeachingBubble"),learnMoreBtnUri:Lt[e.actionType]||void 0,headline:Object(x.b)(kt.d),bodyText:Object(x.b)(kt.c),hasSmallHeadline:!0,lid:Rt.b.ActionableMessageTeachingUiTeachingBubblePolicy})})));function Gt(e){return{buttonType:Bt.a.normal,children:Object(x.b)(kt.b),onClick:e}}var Wt=n(6419),Jt=n(7416),Vt=(Object(O.mutator)(Jt.a,(function(e){Wt.a.cards.set(e.cardId,{autoInvokeActionAlreadyRan:!1})})),Object(O.mutator)(Jt.b,(function(e){Wt.a.cards.delete(e.cardId)})),Object(O.mutator)(Jt.c,(function(e){var t=Wt.a.cards.get(e.cardId);t?t.autoInvokeActionAlreadyRan=e.autoInvokeActionAlreadyRan:i.g.warn("[ActionableMessageDebug] setAutoInvokeActionAlreadyRanMutator: card is undefined for cardId "+e.cardId)})),n(108)),Yt={XeroOpay:"Transaction"};function Kt(e){var t,n,r,a=void 0;if(i.g.info("[getCardTypeFromCardDetails] Fetching the card type"),null===(t=e.card)||void 0===t?void 0:t.messageCardContext){var o=e.card.messageCardContext;n=o.oamAppName,(r=Yt[n])||i.g.warn("[ActionableMessageDebug] getCardType: Unable to fetch cardType for OamAppName "+n),a=r||"Unknown"}else i.g.warn("[ActionableMessageDebug] getCardTypeFromCardDetails: Cannot extract the context of an invalid CardDetails object");return a}var Zt=n(10395);var Qt=function(){function e(e,t,n,r){this.perfCheckpoints={currentCardCheckpoints:{},previousCardCheckpoints:{}},this.telemetryProvider=e,this.mailboxInfo=t,this.messageContext=n,this.perfData=r}return e.prototype.stampPerfCheckpoint=function(e,t){!function(e,t,n){var r=n||Object(z.Rb)();switch(t){case Zt.a.LoadStart:e.loadStart=r;break;case Zt.a.AutoInvokeActionStart:e.autoInvokeActionStart=r;break;case Zt.a.AutoInvokeActionEnd:e.autoInvokeActionEnd=r;break;case Zt.a.CardRenderStart:e.currentCardCheckpoints.cardRenderStart=r;break;case Zt.a.CardRenderEnd:e.currentCardCheckpoints.cardRenderEnd=r;break;case Zt.a.ThemeLoadTotalStart:e.currentCardCheckpoints.themeLoadTotalStart=r;break;case Zt.a.ThemeLoadTotalEnd:e.currentCardCheckpoints.themeLoadTotalEnd=r;break;case Zt.a.ThemeDefinitionsLoadStart:e.currentCardCheckpoints.themeDefinitionsLoadStart=r;break;case Zt.a.ThemeDefinitionsLoadEnd:e.currentCardCheckpoints.themeDefinitionsLoadEnd=r;break;case Zt.a.ThemeResolveStart:e.currentCardCheckpoints.themeResolveStart=r;break;case Zt.a.ThemeResolveEnd:e.currentCardCheckpoints.themeResolveEnd=r;break;case Zt.a.CardCreateStart:e.currentCardCheckpoints.cardCreateStart=r;break;case Zt.a.CardCreateEnd:e.currentCardCheckpoints.cardCreateEnd=r;break;case Zt.a.CardLibraryRenderStart:e.currentCardCheckpoints.cardLibraryRenderStart=r;break;case Zt.a.CardLibraryRenderEnd:e.currentCardCheckpoints.cardLibraryRenderEnd=r;break;case Zt.a.PrepareCardStart:e.currentCardCheckpoints.prepareCardStart=r;break;case Zt.a.PrepareCardEnd:e.currentCardCheckpoints.prepareCardEnd=r;break;default:i.g.info("Actionable Message Card: markPerfCheckpointMutator called with unespected PerfMarker")}}(this.perfCheckpoints,e,t)},e.prototype.logTelemetryProvider=function(e,t,n,r,a){var i=this.getTelemetryDetailsForEvent(e,t,n,r,a);this.telemetryProvider.logTelemetry(i)},e.prototype.setTotalFetchTimeForCard=function(){this.perfCheckpoints&&this.perfCheckpoints.currentCardCheckpoints&&(this.perfCheckpoints.currentCardCheckpoints.totalFetchTime=Object(z.w)(this.perfData.fetchEndTime,this.perfData.fetchStartTime))},e.prototype.getTelemetryDetailsForEvent=function(e,t,n,r,a){return{mailboxInfo:this.mailboxInfo,messageContext:this.messageContext,cardDetails:e,eventName:t,actionContext:n,elementDetails:r,correlationVector:a,perfCheckpoints:this.perfCheckpoints}},e.prototype.updatePerfCheckpointsBeforeUpdatingAutoInvokeResponse=function(){this.perfCheckpoints&&(this.perfCheckpoints.previousCardCheckpoints=this.perfCheckpoints.currentCardCheckpoints,this.perfCheckpoints.currentCardCheckpoints={})},e}();n(428);var Xt=new Vt.c((function(){return Promise.all([n.e(6),n.e(8),n.e(21),n.e(681),n.e(110)]).then(n.bind(null,15003))})),$t=Object(Vt.d)(Xt,(function(e){return e.ActionableMessageCardWrapper})),en=(new Vt.b(Xt,(function(e){return e.parseCardFromStringOrObject})),"TransactionCardDisabled"),tn="messageCardContext";function nn(e,t,n,r,i){var o=e.card;if(o&&o.hasOwnProperty(tn)){if(!o.messageCardContext)return!1;var s=Object(a.e)(e)===a.b.XeroOpay&&n;return s&&i.logTelemetry({mailboxInfo:t,messageContext:r,eventName:en,cardDetails:e}),s}return!1}var rn="Action.Transaction",an=n(1622),on=n(165),sn=n(13818),cn={PPE:"https://interactive-ppe.outlook.com/ux/app",PROD:"https://interactive.outlook.com/ux/app",DEV:"https://opay-dev-wc-svc.cloudapp.net/ux/app"},dn=function(e){function t(){var t=e.call(this)||this;return t.environment="prod",t.triggerContext=null,t.intent="",t.merchantId="",t.displayId="",t}return Object(o.__extends)(t,e),t.prototype.getJsonTypeName=function(){return rn},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary,t.initializationContext?(this.intent=t.initializationContext.intent,this.merchantId=t.initializationContext.merchantId,this.displayId=t.initializationContext.displayId,this.productContext=t.initializationContext.productContext,this.environment=t.initializationContext.environment):(this.intent=t.intent,this.merchantId=t.merchantId,this.displayId=t.displayId,this.productContext=t.productContext,this.environment=t.environment),this.triggerContext={MerchantId:this.merchantId,DisplayId:this.displayId,CorrelationId:Object(f.b)(),Culture:Object(p.a)().SessionSettings.UserCulture,Market:Object(an.g)(),Environment:this.environment},on.set("DefaultAnchorMailbox",on.get("DefaultAnchorMailbox"),{path:"/actions/"}),Object(Y.h)("ring-dogfood")&&on.set("DefaultAnchorMailbox",on.get("DefaultAnchorMailbox"),{path:"/opay/"})},t.prototype.execute=function(){e.prototype.execute.call(this),this.triggerContext.CorrelationId=Object(f.b)()},t.prototype.getIFrameElement=function(){var e=Object(Y.h)("rp-opay-modelb-endpoint")?window.location.origin+"/opay":this.getSvcEndpoint(),t=encodeURIComponent(JSON.stringify(this.productContext)),n=e+"/?triggerContext="+encodeURIComponent(JSON.stringify(this.triggerContext))+"&productContext="+t;return Tt.createElement("div",{className:sn.opayFlexPaneContainer},Tt.createElement("iframe",{id:"opay_iframe",className:sn.opayAppIFrameStyle,src:n}))},t.prototype.getSvcEndpoint=function(){return this.environment?0===this.environment.indexOf("dev")?cn.DEV:"ppe"===this.environment.toLowerCase()?cn.PPE:cn.PROD:cn.PROD},t}(s.Action),un={shouldShowModalFlexPane:!1,modalFlexPaneContent:void 0},ln=Object(O.createStore)("OPayPanel",un)(),gn=Object(O.mutatorAction)("SHOW_OPAY_PANEL",(function(e){ln.shouldShowModalFlexPane=!0,ln.modalFlexPaneContent=e})),fn="TransactionActionEvent",bn="actionContext";var pn={registerActions:function(){s.AdaptiveCard.actionTypeRegistry.registerType(rn,(function(){return new dn}))},executeAction:function(e,t,n,r,a,o,s){if(!(e instanceof dn))return!1;i.g.info("[ActionableMessageDebug] Transaction executed");var c=e,d={id:c.id,type:c.getJsonTypeName()};return o.logTelemetry({mailboxInfo:a.mailboxInfo,cardDetails:t,elementDetails:d,eventName:fn,actionContext:e[bn],messageContext:a,correlationVector:c.triggerContext.CorrelationId}),gn(c.getIFrameElement()),!0},parseLegacyMessageCardAction:function(e,t){switch(e["@type"]){case"Transaction":return n=e,(r=new dn).parse(n),r.title=n.name,r}var n,r;return null},registerHostCapabilities:function(e){e.Transaction="*",e["Transaction.MSA"]="*"}},hn=n(2488),mn=n(908),vn=n(268),Cn=n(1217),On=Object(O.mutatorAction)("HIDE_OPAY_PANEL",(function(){ln.shouldShowModalFlexPane=!1,ln.modalFlexPaneContent=void 0})),yn=Object(Ue.a)((function(e){return Object(Cn.a)("message",(function(t){var n=t.origin.toLowerCase();if(Object.keys(cn).some((function(e){return 0!==cn[e].indexOf(n)}))){var r=null;try{r=JSON.parse(t.data)}catch(e){i.g.warn("Unable to parse post message data: "+t.data)}if(r){var a=r.action;if(a)switch(a){case"close":On();break;case"token":Object(S.a)().then((function(t){var r=document.querySelector("#opay_iframe");r&&r.contentWindow.postMessage(JSON.stringify({action:"token",token:t,messageContext:{messageId:e.odataItemId,smtpAddressesSerialized:e.smtpAddressesSerialized},result:"Success"}),n)})).catch((function(){window.postMessage(JSON.stringify({action:"token",result:"Failed"}),n)}))}}}})),Tt.createElement(mn.a,{key:"modalFlexPane",onDismiss:function(){On()},isOpen:ln.shouldShowModalFlexPane,type:vn.a.smallFixedFar,closeButtonAriaLabel:Object(x.b)(hn.a)},ln.modalFlexPaneContent)})),An=n(1769),In="62242e1d-c39a-4f8a-a66e-1d39c0a336b0";function jn(e){return!Object(Y.h)(An.b)&&e===In}var Mn={ComponentDidMount:"11",ComponentWillUnMount:"12",ComponentDidUpdate:"13",FetchInProgress:"14",CardDetailsPresent:"15",FetchInitiated:"16",NotUpdatingCardDetailsAsItAlreadyPresent:"17",FetchSuccess:"18",CardId:"19",ItemId:"110",FetchError:"111",FetchException:"112",RenderCard:"113",NoCard:"114",ShowMessage:"115",UpdateOnItem:"116",UpdateLoadingState:"117",FinishLoading:"118",Render:"119"},Sn=n(10396),xn=Object(Ue.a)((function(e){var t,n,r=this,a=e.actionableMessageLoggingHandler;Tt.useEffect((function(){return a.log(Mn.ComponentDidMount),i.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper mount"),function(){Qe(),a.log(Mn.ComponentWillUnMount),i.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper unmount")}}),[]),Tt.useEffect((function(){a.log(Mn.ComponentDidUpdate),i.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper update"),C()})),Tt.useEffect((function(){return l.current=setTimeout((function(){i.g.info("[ActionableMessageDebug] ActionableMessageContent card load timed out"),Object(j.o)("actionableMessageContentLoadTimeout"),g.current=!0,k(!0)}),4e3),function(){return clearTimeout(l.current)}}),[]);var s=Tt.useRef(Object(tt.a)(e.item)),c=Tt.useRef({loadStartTime:Object(z.Rb)()}),d=Tt.useRef([]),u=Tt.useRef(),l=Tt.useRef(),g=Tt.useRef(),f=Object(o.__read)(Tt.useState(!1),2),b=f[0],p=f[1],h=Object(o.__read)(Tt.useState(null),2),m=h[0],v=h[1],C=function(){return Object(o.__awaiter)(r,void 0,void 0,(function(){var t,n,r,s,d,l,g,f,b;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:if(u.current)return a.log(Mn.FetchInProgress),i.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties fetch already in process. Aborting this attempt"),[2];if(t=e.item,c.current.fetchStartTime=Object(z.Rb)(),(n=t.adaptiveCardDetails)&&n.length>0)return a.log(Mn.CardDetailsPresent+":"+(null===(g=n[0].cardId)||void 0===g?void 0:g.slice(0,8))),i.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties already had cardDetails on the item. cardId: "+n[0].cardId),c.current.fetchEndTime=Object(z.Rb)(),[2];r=new j.a("MCActionableCardGetProperty"),o.label=1;case 1:return o.trys.push([1,3,4,5]),u.current=!0,a.log(Mn.FetchInitiated),i.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties fetching cardDetails from the server"),[4,Le(t)];case 2:return s=o.sent(),(d=t.adaptiveCardDetails)&&d.length>0?(a.log(Mn.NotUpdatingCardDetailsAsItAlreadyPresent+":"+(null===(f=d[0].cardId)||void 0===f?void 0:f.slice(0,8))),i.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties not updating the details as its already present"+s[0].cardId)):s&&s.length>0?(r.end(),c.current.fetchEndTime=Object(z.Rb)(),a.log(Mn.FetchSuccess),a.log(Mn.CardId+":"+(null===(b=s[0].cardId)||void 0===b?void 0:b.slice(0,8))),i.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties got card details from the server. cardId: "+s[0].cardId),He(t,s)):(a.log(Mn.FetchError),i.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties error getting card details from the server"),k(!0),r.endWithError("ServerError")),[3,5];case 3:return l=o.sent(),a.log(Mn.FetchException),i.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties error getting card details from the server"),i.g.warn("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties: exception during getCardDetails: "+l.message),k(!0),r.endWithError("ClientError"),[3,5];case 4:return u.current=!1,[7];case 5:return[2]}}))}))},O=function(e){return e.filter((function(e){return!e.isContextual}))},y=function(t){var n,r=O(t),o={onUndo:function(){return t=e.darkModeContentHandler,n=e.undoDarkMode,void(t&&n&&(i.g.info("ActionableMessageMailWrapper: applyDarkModeHandlerToCardElement: undoing dark mode"),t.undoHandler(d.current),d.current=[]));var t,n},onApply:function(t){return function(t){var n=e.undoDarkMode,r=e.darkModeContentHandler;if(t&&r&&!n)if(i.g.info("ActionableMessageMailWrapper: applyDarkModeHandlerToCardElement: applying dark mode to card elements"),r.cssSelector){r.handler(t),d.current.push(t);var a=t.querySelectorAll(r.cssSelector);if(a)for(var o=0;o<a.length;o++){var s=a.item(o);r.handler(s),d.current.push(s)}}else i.g.info("ActionableMessageCard: applyDarkModeHandlerToCardElement: no cssSelector specified by DarkMode handler")}(t)}},u=new Qt(Ae,e.item.MailboxInfo,s.current,c.current);return r&&1===r.length&&function(t){var n,r=!0,a=null===(n=null==t?void 0:t.card)||void 0===n?void 0:n.originator;return a||(a=null==t?void 0:t.connectorSenderGuid),a&&(r=!fe(a,e.isDarkMode)),r}(r[0])?(a.log(Mn.RenderCard+":"+(null===(n=r[0].cardId)||void 0===n?void 0:n.slice(0,8))),i.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper renderCardFromDetails. cardId: "+r[0].cardId),Tt.createElement("div",{className:Sn.container},Tt.createElement($t,{key:r[0].cardId,cardDetails:r[0],showMessageBodyCallback:A,contentHandlerUndoMode:e.undoDarkMode,actionProviders:[It,Ie,pn],adjustCardElementBeforeRenderCallback:S,onCardRendered:w,downloadThemeCallback:Oe,onCardDetailsUpdated:I,actionableMessageContentHandler:o,actionableMessageCardStrings:{cardDefinitionsStrings:{format:x.c,actionInProgressMessage:Object(x.b)(jt.a),defaultPlaceholderTextInput:Object(x.b)(jt.b),warningMessageForInvalidInput:Object(x.b)(jt.c),warningMessageForMissingRequiredInput:Object(x.b)(jt.d),warningMessageForInputNumberNotNumeric:Object(x.b)(Mt.c),warningMessageForInputNumberLessThanMax:Object(x.b)(Mt.a),warningMessageForInputNumberMoreThanMin:Object(x.b)(Mt.b),warningMessageForRequiredField:Object(x.b)(St.a)},dateStrings:Object(xt.a)()},telemetryHandler:u,loggingHandler:a}))):(a.log(Mn.NoCard),i.g.info("Did not find expected number of cards on the message"),A(!0),Tt.createElement("div",null))},A=function(t){a.log(Mn.ShowMessage),i.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper setShowMessageBody: "+t),Be(e.viewState,t),t&&qe(e.viewState,!1),k(t)},I=function(t){a.log(Mn.UpdateOnItem),i.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper updateCardOnItem"),ze(e.item,t)},M=function(){var t=e.item.adaptiveCardDetails;if(t&&t.length>0){var n=t[0].card.messageCardContext;return n?{acCorrelationId:n.correlationId,actionType:Kt(t[0]),messageId:e.item.ItemId.Id,target:function(){return m}}:{acCorrelationId:"",actionType:void 0,messageId:null,target:function(){return m}}}return null},S=function(t){i.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper fixInlineImages"),he(t,e.item.MailboxInfo),Ke(t,e.item,e.item.MailboxInfo)},w=function(t){a.log(Mn.UpdateLoadingState),i.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper  onCardRendered. Updating loading state"),m!==t&&(p(!0),v(t),k(!1)),e.viewState.showCardLoading&&qe(e.viewState,!1)},T=function(e){return(null==e?void 0:e.actionType)&&null!=e.target?(i.g.info("[ActionableMessageCard] TeachingUI triggered"),Tt.createElement(qt,Object(o.__assign)({},e))):null},k=function(t){a.log(Mn.FinishLoading),i.g.info("[ActionableMessageDebug] Finish Loading - forceShowMessageBody:"+t),l.current&&(clearTimeout(l.current),l.current=null);var n=e.viewState;qe(n,!1),t&&Be(n,!0)},D=e.item.adaptiveCardDetails;a.log(Mn.Render),a.log(Mn.CardId+":"+((null==D?void 0:D[0])?null===(n=null===(t=D[0])||void 0===t?void 0:t.cardId)||void 0===n?void 0:n.slice(0,8):" ")),i.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper render. itemId: "+e.item.ItemId.Id+". CardDetails: "+((null==D?void 0:D[0])?D[0].cardId:"undefined"));var E=D&&D.length>0,R=E&&jn(D[0].connectorSenderGuid);return E?R||0!==function(t){var n=O(t);return n=n.filter((function(t){return nn(t,e.item.MailboxInfo,Object(Y.h)("rp-acDisableTransactionCard"),s.current,Ae)}))}(D).length?(k(!0),null):function(e){return g.current&&k(!0),!g.current&&Tt.createElement(Tt.Fragment,null,Tt.createElement("div",{className:Sn.cardArea},y(e)),Tt.createElement(yn,{odataItemId:s.current.odataItemId,smtpAddressesSerialized:e[0].smtpAddressesSerialized}),b&&T(e?M():null))}(D):null})),wn=n(10396),Tn=Object(Ue.a)((function(e){var t,n,r=this,s=e.actionableMessageLoggingHandler;Tt.useEffect((function(){return s.log(Mn.ComponentDidMount),i.g.info("[ActionableMessageDebug] ActionableMessageContent mount"),function(){Qe(),s.log(Mn.ComponentWillUnMount),i.g.info("[ActionableMessageDebug] ActionableMessageContent unmount")}}),[]),Tt.useEffect((function(){s.log(Mn.ComponentDidUpdate),i.g.info("[ActionableMessageDebug] ActionableMessageContent update"),A()})),Tt.useEffect((function(){return b.current=setTimeout((function(){i.g.info("[ActionableMessageDebug] ActionableMessageContent card load timed out"),Object(j.o)("actionableMessageContentLoadTimeout"),p.current=!0,E(!0)}),4e3),function(){return clearTimeout(b.current)}}),[]);var c=Tt.useRef(Object(tt.a)(e.item)),d=Tt.useRef(Object(z.Rb)()),u=Tt.useRef(),l=Tt.useRef(),g=Tt.useRef([]),f=Tt.useRef(),b=Tt.useRef(),p=Tt.useRef(),h=Object(o.__read)(Tt.useState(!1),2),m=h[0],v=h[1],C=Object(o.__read)(Tt.useState(null),2),O=C[0],y=C[1],A=function(){return Object(o.__awaiter)(r,void 0,void 0,(function(){var t,n,r,a,c,d,g,b,p;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:if(f.current)return s.log(Mn.FetchInProgress),i.g.info("[ActionableMessageDebug] ActionableMessageContent getCardProperties fetch already in process. Aborting this attempt"),[2];if(t=e.item,u.current=Object(z.Rb)(),(n=t.adaptiveCardDetails)&&n.length>0)return s.log(Mn.CardDetailsPresent+":"+(null===(g=n[0].cardId)||void 0===g?void 0:g.slice(0,8))),i.g.info("[ActionableMessageDebug] ActionableMessageContent getCardProperties already had cardDetails on the item. cardId: "+n[0].cardId),l.current=Object(z.Rb)(),[2];r=new j.a("MCActionableCardGetProperty"),o.label=1;case 1:return o.trys.push([1,3,4,5]),f.current=!0,s.log(Mn.FetchInitiated),i.g.info("[ActionableMessageDebug] ActionableMessageContent getCardProperties fetching cardDetails from the server"),[4,Le(t)];case 2:return a=o.sent(),(c=t.adaptiveCardDetails)&&c.length>0?(s.log(Mn.NotUpdatingCardDetailsAsItAlreadyPresent+":"+(null===(b=c[0].cardId)||void 0===b?void 0:b.slice(0,8))),i.g.info("[ActionableMessageDebug] ActionableMessageContent getCardProperties not updating the details as its already present"+a[0].cardId)):a&&a.length>0?(r.end(),l.current=Object(z.Rb)(),s.log(Mn.FetchSuccess),s.log(Mn.CardId+":"+(null===(p=a[0].cardId)||void 0===p?void 0:p.slice(0,8))),i.g.info("[ActionableMessageDebug] ActionableMessageContent getCardProperties got card details from the server. cardId: "+a[0].cardId),He(t,a)):(s.log(Mn.FetchError),i.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties error getting card details from the server"),E(!0),r.endWithError("ServerError")),[3,5];case 3:return d=o.sent(),s.log(Mn.FetchException),i.g.info("[ActionableMessageDebug] ActionableMessageContent getCardProperties error getting card details from the server"),i.g.warn("[ActionableMessageDebug] ActionableMessageContent getCardProperties: exception during getCardDetails: "+d.message),E(!0),r.endWithError("ClientError"),[3,5];case 4:return f.current=!1,[7];case 5:return[2]}}))}))},I=function(e){return e.filter((function(e){return!e.isContextual}))},M=function(t){var n,r=I(t),o={onUndo:function(){return t=e.darkModeContentHandler,n=e.undoDarkMode,void(t&&n&&(i.g.info("ActionableMessageContent: applyDarkModeHandlerToCardElement: undoing dark mode"),t.undoHandler(g.current),g.current=[]));var t,n},onApply:function(t){return function(t){var n=e.undoDarkMode,r=e.darkModeContentHandler;if(t&&r&&!n)if(i.g.info("ActionableMessageCard: applyDarkModeHandlerToCardElement: applying dark mode to card elements"),r.cssSelector){r.handler(t),g.current.push(t);var a=t.querySelectorAll(r.cssSelector);if(a)for(var o=0;o<a.length;o++){var s=a.item(o);r.handler(s),g.current.push(s)}}else i.g.info("ActionableMessageCard: applyDarkModeHandlerToCardElement: no cssSelector specified by DarkMode handler")}(t)}};return r&&1===r.length&&function(t){var n,r=!0,a=null===(n=null==t?void 0:t.card)||void 0===n?void 0:n.originator;return a||(a=null==t?void 0:t.connectorSenderGuid),a&&(r=!fe(a,e.isDarkMode)),r}(r[0])?(s.log(Mn.RenderCard+":"+(null===(n=r[0].cardId)||void 0===n?void 0:n.slice(0,8))),i.g.info("[ActionableMessageDebug] ActionableMessageContent renderCardFromDetails. cardId: "+r[0].cardId),Tt.createElement("div",{className:wn.container},Tt.createElement(a.a,{key:r[0].cardId,cardDetails:r[0],mailboxInfo:e.item.MailboxInfo,messageContext:c.current,showMessageBodyCallback:S,contentHandlerUndoMode:e.undoDarkMode,actionProviders:[It,Ie,pn],telemetryProvider:Ae,loggingHandler:s,adjustCardElementBeforeRenderCallback:T,onCardRendered:k,downloadThemeCallback:Oe,onCardDetailsUpdated:x,perfData:{loadStartTime:d.current,fetchStartTime:u.current,fetchEndTime:l.current},actionableMessageContentHandler:o}))):(s.log(Mn.NoCard),i.g.info("Did not find expected number of cards on the message"),S(!0),Tt.createElement("div",null))},S=function(t){s.log(Mn.ShowMessage),i.g.info("[ActionableMessageDebug] ActionableMessageContent setShowMessageBody: "+t),Be(e.viewState,t),t&&qe(e.viewState,!1),E(t)},x=function(t){s.log(Mn.UpdateOnItem),i.g.info("[ActionableMessageDebug] ActionableMessageContent updateCardOnItem"),ze(e.item,t)},w=function(){var t=e.item.adaptiveCardDetails;if(t&&t.length>0){var n=t[0].card.messageCardContext;return n?{acCorrelationId:n.correlationId,actionType:Object(a.e)(t[0]),messageId:e.item.ItemId.Id,target:function(){return O}}:{acCorrelationId:"",actionType:void 0,messageId:null,target:function(){return O}}}return null},T=function(t){i.g.info("[ActionableMessageDebug] ActionableMessageContent fixInlineImages"),he(t,e.item.MailboxInfo),Ke(t,e.item,e.item.MailboxInfo)},k=function(t){s.log(Mn.UpdateLoadingState),i.g.info("[ActionableMessageDebug] ActionableMessageContent onCardRendered. Updating loading state"),O!==t&&(v(!0),y(t),E(!1)),e.viewState.showCardLoading&&qe(e.viewState,!1)},D=function(e){return(null==e?void 0:e.actionType)&&null!=e.target?(i.g.info("[ActionableMessageDebug] TeachingUI triggered"),Tt.createElement(qt,Object(o.__assign)({},e))):null},E=function(t){s.log(Mn.FinishLoading),i.g.info("[ActionableMessageDebug] Finish Loading - forceShowMessageBody:"+t),b.current&&(clearTimeout(b.current),b.current=null);var n=e.viewState;qe(n,!1),t&&Be(n,!0)},R=e.item.adaptiveCardDetails;s.log(Mn.Render+":"+((null==R?void 0:R[0])?null===(n=null===(t=R[0])||void 0===t?void 0:t.cardId)||void 0===n?void 0:n.slice(0,8):" ")),i.g.info("[ActionableMessageDebug] ActionableMessageContent render. itemId: "+e.item.ItemId.Id+". CardDetails: "+((null==R?void 0:R[0])?R[0].cardId:"undefined"));var _=R&&R.length>0,P=_&&jn(R[0].connectorSenderGuid);return _?P||0!==function(t){var n=I(t);return n=n.filter((function(t){return nn(t,e.item.MailboxInfo,Object(Y.h)("rp-acDisableTransactionCard"),c.current,Ae)}))}(R).length?(E(!0),null):function(e){return p.current&&E(!0),!p.current&&Tt.createElement(Tt.Fragment,null,Tt.createElement("div",{className:wn.cardArea},M(e)),Tt.createElement(yn,{odataItemId:c.current.odataItemId,smtpAddressesSerialized:e[0].smtpAddressesSerialized}),m&&D(e?w():null))}(R):null})),kn=function(e){var t=null==e?void 0:e.adaptiveCardDetails;t&&t.length>0&&t[0].cardId&&Object(a.c)(t[0].cardId)},Dn=function(e){var t=null==e?void 0:e.adaptiveCardDetails;t&&t.length>0&&t[0].cardId&&Object(Jt.b)(t[0].cardId)};n.d(t,"logAdaptiveCardLinkInteraction",(function(){return Me})),n.d(t,"getCardDetails",(function(){return Le})),n.d(t,"ActionableMessageMailWrapper",(function(){return xn})),n.d(t,"ActionableMessageContent",(function(){return Tn})),n.d(t,"doesActionableMessageEnabled",(function(){return le})),n.d(t,"cleanupCardContentStore",(function(){return kn})),n.d(t,"cleanupCardWrapperStore",(function(){return Dn}))},1622:function(e,t,n){"use strict";var r=n(984),a=["AT","BE","BG","CH","CY","CZ","DE","DK","EE","ES","FI","FR","GB","GR","HR","HU","IE","IS","IT","LI","LT","LU","LV","MT","NL","NO","PL","PT","RO","SE","SI","SK"];function i(){var e=Object(r.h)(Object(r.e)());return a.indexOf(e)>=0}var o,s={};function c(e,t){return void 0===t&&(t=!0),s[e]&&o&&-1!=o.indexOf(e)||(s[e]=new Promise((function(n,r){var a=window.document.createElement("script");a.src=e,a.type="text/javascript",t&&(a.crossOrigin="anonymous"),a.onload=function(){o?o.push(e):o=[e],n()},a.onerror=function(){r("OnError "+e)},window.document.head.appendChild(a)}))),s[e]}var d,u,l,g,f=n(76),b=n(103),p=n(27),h=["en-us","en-gb","en-ca","en-au"];function m(){if(!d){var e=Object(r.e)();d=Object(f.h)("fwk-nativeAds-bingOneClickOtherInboxOnly")&&h.indexOf(e)>-1?0:2}return d}function v(e){return C(e)?!Object(f.h)("fwk-nativeAds-honorEasyOtherOffKillSwitch")&&8&Object(p.a)().ViewStateConfiguration.FocusedInboxBitFlags||!Object(f.h)("fwk-ads-exp2-RuntimeBypass")&&("DisplayOffNativeInbox"==g||"DisplayOnNativeInbox"==g)?2:1:0}function C(e){return void 0!==u?u:(u=!1,Object(b.u)()?(l=Object(r.e)(),Object(f.h)("fwk-nativeAds-bingOneClickOtherInboxOnly")||Object(f.h)("fwk-nativeAds-prebidOneClickOtherInboxOnly")||Object(f.h)("fwk-nativeAds-appNexusOneClickOtherInboxOnly")?Object(r.b)()?u:Object(r.c)()?u:Object(r.a)()?u:r.d.indexOf(l)>-1?u:O()?u:u=!0:u):u)}function O(){return g=Object(p.a)().UserOptions.ConsumerAdsExperimentMode,!(Object(f.h)("fwk-ads-exp2-RuntimeBypass")||"DisplayOffNativeOff"!=g&&"DisplayOnNativeOff"!=g)}n.d(t,"q",(function(){return i})),n.d(t,"r",(function(){return c})),n.d(t,"e",(function(){return O})),n.d(t,"m",(function(){return C})),n.d(t,"o",(function(){return m})),n.d(t,"n",(function(){return v})),n.d(t,"a",(function(){return h})),n.d(t,"f",(function(){return r.d})),n.d(t,"g",(function(){return r.e})),n.d(t,"h",(function(){return r.f})),n.d(t,"j",(function(){return r.h})),n.d(t,"k",(function(){return r.i})),n.d(t,"l",(function(){return r.j})),n.d(t,"p",(function(){return r.k})),n.d(t,"b",(function(){return r.a})),n.d(t,"c",(function(){return r.b})),n.d(t,"d",(function(){return r.c})),n.d(t,"s",(function(){return r.l})),n.d(t,"i",(function(){return r.g}))},1769:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var r="cal-txp-invoice",a="cal-txp-serviceReservationAdaptive"},1855:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(123),a=n(1266);function i(e,t){Object.keys(a.a).some((function(n){return a.a[n]==t&&(Object(r.h)(e,{key:n,id:t},{isCore:!0}),!0)}))}},2488:function(e){e.exports=JSON.parse('{"a":"n3b"}')},292:function(e){e.exports=JSON.parse('{"k":"bCa","h":"cCa","m":"dCa","j":"eCa","l":"fCa","i":"gCa","d":"hCa","b":"iCa","f":"jCa","g":"kCa","e":"lCa","a":"mCa","c":"nCa"}')},3261:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),a=n(76),i=n(1545),o=n(960),s=n(483);function c(e,t,n,c){var d=Object(s.e)(n,e,null,t),u=Object(r.__assign)(Object(r.__assign)({},c),{includeFluidOnPopout:Object(o.d)(o.a.Bohemia).bohemiaEnabled&&Object(a.h)("cmp-prague")&&Object(i.a)()});Object(s.c)("mail",d,u,{resizable:!0})}},341:function(e,t,n){"use strict";var r=n(618),a=n(619),i=n(620),o=n(621),s=n(622),c=n(623),d=n(624),u=n(598),l=n(599),g=n(600),f=n(601),b=n(602),p=n(603),h=n(604),m=n(605),v=n(606),C=n(607),O=n(608),y=n(609),A=n(292),I=n(660),j=n(633),M=n(634),S=n(635),x=n(636),w=n(637),T=n(638),k=n(639),D=n(640),E=n(641),R=n(642),_=n(643),P=n(644),F=n(9),N=n(24),L=function(){return U.get()},U=Object(N.computed)((function(){return{months:[Object(F.b)(y.a),Object(F.b)(O.a),Object(F.b)(C.a),Object(F.b)(v.a),Object(F.b)(m.a),Object(F.b)(h.a),Object(F.b)(p.a),Object(F.b)(b.a),Object(F.b)(f.a),Object(F.b)(g.a),Object(F.b)(l.a),Object(F.b)(u.a)],shortMonths:[Object(F.b)(P.a),Object(F.b)(_.a),Object(F.b)(R.a),Object(F.b)(E.a),Object(F.b)(D.a),Object(F.b)(k.a),Object(F.b)(T.a),Object(F.b)(w.a),Object(F.b)(x.a),Object(F.b)(S.a),Object(F.b)(M.a),Object(F.b)(j.a)],days:[Object(F.b)(d.a),Object(F.b)(c.a),Object(F.b)(s.a),Object(F.b)(o.a),Object(F.b)(i.a),Object(F.b)(a.a),Object(F.b)(r.a)],shortDays:[Object(F.b)(A.d),Object(F.b)(A.b),Object(F.b)(A.f),Object(F.b)(A.g),Object(F.b)(A.e),Object(F.b)(A.a),Object(F.b)(A.c)],goToToday:Object(F.b)(I.a),prevMonthAriaLabel:Object(F.b)(A.k),nextMonthAriaLabel:Object(F.b)(A.h),prevYearAriaLabel:Object(F.b)(A.m),nextYearAriaLabel:Object(F.b)(A.j),prevYearRangeAriaLabel:Object(F.b)(A.l),nextYearRangeAriaLabel:Object(F.b)(A.i)}})),H=n(103),z=function(e,t){return e?e.tz:t||Object(H.q)()},B=n(7),q=function(e,t){return Object(B.Rb)(e,t.getFullYear(),t.getMonth(),t.getDate())};n.d(t,"a",(function(){return L})),n.d(t,"c",(function(){return z})),n.d(t,"b",(function(){return q}))},5428:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(7411),a=n(24),i=[{id:"ja7lKjj2NnQ.cwA.Krg.hfkh3ftaMUOb57AnI3gEJw-TZrkxQd1glDepIPKj6yo",tokenType:r.a.ConnectorsLTI},{id:"hXP0lB4sF4E.ihaAU12Q9puBSDe5dMnr8RITJalvWkCqiQadGVOHmIc",tokenType:r.a.AAD}],o=Object(a.computed)((function(){var e=new a.ObservableMap;return i.forEach((function(t){e.set(t.id,t)})),e}))},6419:function(e,t,n){"use strict";var r=n(24),a=n(4),i={themeStore:{loadStatus:0,themeMapping:{}},cards:new r.ObservableMap},o=Object(a.createStore)("ActionableMessageV2",i);t.a=o()},660:function(e){e.exports=JSON.parse('{"a":"aCa"}')},7411:function(e,t,n){"use strict";var r;!function(e){e.NoAuth="NoAuth",e.ConnectorsLTI="ConnectorsLTI",e.AAD="AAD"}(r||(r={})),t.a=r},7416:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o}));var r=n(4),a=Object(r.action)("addCard",(function(e){return{cardId:e}})),i=Object(r.action)("removeCard",(function(e){return{cardId:e}})),o=Object(r.action)("setAutoInvokeActionAlreadyRan",(function(e,t){return{cardId:e,autoInvokeActionAlreadyRan:t}}))},9215:function(e,t,n){"use strict";var r=n(79),a=function(){function e(e,t){var n=this;void 0===e&&(e=5),void 0===t&&(t=5e3),this.throttleCallbacks=[],this.activeRequests=0,this.processedRequests=0,this.lastProcessedRequests=0,this.watchDogTimer=null,this.clearQueue=function(){n.throttleCallbacks.length=0,n.activeRequests=0},this.maxConcurrentRequests=e,this.watchDogTimerInterval=t}return e.prototype.watchDogAction=function(){this.throttleCallbacks.length>0?this.processedRequests===this.lastProcessedRequests?(this.activeRequests=0,this.traceInfo("Watch dog is processing the queue."),this.processNextRequest()):(this.traceInfo("Watch dog is watching."),this.lastProcessedRequests=this.processedRequests):(window.clearInterval(this.watchDogTimer),this.watchDogTimer=null,this.traceInfo("Stop watch dog."))},e.prototype.traceInfo=function(e){r.g.info("ThrottleRequests:active="+this.activeRequests+";throttled="+this.throttleCallbacks.length+";processed="+this.processedRequests+";lastProcessed="+this.lastProcessedRequests+";info="+e)},e.prototype.processNextRequest=function(){(this.processedRequests++,0===this.throttleCallbacks.length)?(this.activeRequests>0&&this.activeRequests--,this.traceInfo("Queue is empty.")):(this.throttleCallbacks.shift()(!1),this.traceInfo("Process next."))},e.prototype.registerCallback=function(e){var t=this;if(null==e)throw new Error("A null callback is registered to Throttle Thumbnails queue.");this.activeRequests<this.maxConcurrentRequests?(e(!1),this.activeRequests++,this.processedRequests++,this.traceInfo("Process now.")):(e(!0),this.throttleCallbacks.push(e),this.traceInfo("Pushes to queue."),this.watchDogTimer||(this.watchDogTimer=window.setInterval((function(){t.watchDogAction()}),this.watchDogTimerInterval),this.traceInfo("Start watch dog.")))},e.prototype.unregisterCallback=function(e){var t=this.throttleCallbacks.indexOf(e);this.throttleCallbacks.splice(t,1),this.activeRequests=0,this.traceInfo("unregisterComponent:"+t)},e}();t.a=a},9618:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(108),a=(n(5428),new r.c((function(){return Promise.all([n.e(6),n.e(37),n.e(58),n.e(87),n.e(442)]).then(n.bind(null,10593))}))),i=new r.b(a,(function(e){return e.openBotConversation})),o=new r.b(a,(function(e){return e.openCortanaConversation}));new r.a(a,(function(e){return e.setEditorInterface}))},9638:function(e){e.exports=JSON.parse('{"a":"L2c"}')},9639:function(e){e.exports=JSON.parse('{"a":"l3c"}')},984:function(e,t,n){"use strict";n.d(t,"l",(function(){return c})),n.d(t,"d",(function(){return d})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return g})),n.d(t,"c",(function(){return f})),n.d(t,"e",(function(){return b})),n.d(t,"i",(function(){return p})),n.d(t,"h",(function(){return h})),n.d(t,"f",(function(){return m})),n.d(t,"j",(function(){return v})),n.d(t,"k",(function(){return C})),n.d(t,"g",(function(){return O}));var r,a,i=n(3),o=n(59),s=n(27),c=["ar-sa","da-dk","de-at","de-ch","de-de","el-gr","en-ar","en-at","en-au","en-br","en-ca","en-ch","en-cl","en-co","en-de","en-dk","en-fi","en-gb","en-gr","en-hk","en-ie","en-in","en-mx","en-my","en-nl","en-no","en-nz","en-pe","en-pt","en-sa","en-se","en-sg","en-th","en-tr","en-us","en-za","es-ar","es-cl","es-co","es-ec","es-es","es-mx","es-pe","es-us","es-ve","fi-fi","fr-be","fr-ca","fr-ch","fr-fr","it-it","ja-jp","ko-kr","ms-my","nb-no","nl-be","nl-nl","pt-br","pt-pt","sv-se","th-th","tr-tr","zh-cn","zh-hk","zh-sg","zh-tw"],d=["ar-ir","es-cu","ko-kp","ar-sy","en-su","uk-ua"],u={ae:"ar-ae",ar:"es-ar",at:"de-at",au:"en-au",be:"fr-be",br:"pt-br",ca:"en-ca",ch:"de-ch",cl:"es-cl",cn:"zh-cn",co:"es-co",cr:"es-cr",cu:"es-cu",de:"de-de",dk:"da-dk",do:"es-do",ec:"es-ec",eg:"ar-eg",es:"es-es",fi:"fi-fi",fr:"fr-fr",gb:"en-gb",uk:"en-gb",gr:"el-gr",gt:"es-gt",hk:"zh-hk",id:"id-id",ie:"en-ie",in:"en-in",ir:"ar-ir",it:"it-it",jp:"ja-jp",kp:"ko-kp",kr:"ko-kr",mx:"es-mx",my:"ms-my",nl:"nl-nl",no:"nb-no",nz:"en-nz",pe:"es-pe",ph:"fil-ph",pl:"pl-pl",pt:"pt-pt",ru:"ru-ru",sa:"ar-sa",se:"sv-se",sg:"en-sg",su:"en-su",th:"th-th",tr:"tr-tr",tw:"zh-tw",ua:"uk-ua",us:"en-us",ve:"es-ve",vn:"vi-vn",za:"en-za"};function l(){return Object(s.a)().SessionSettings.IsPremiumConsumerMailbox}function g(){return Object(s.a)().IsConsumerChild}function f(){return Object(s.a)().SessionSettings.IsShadowMailbox}function b(){return void 0!==a?a:a=function(){if(Object(i.d)("ormarket"))return Object(i.a)("ormarket");var e=Object(s.a)(),t=e.SessionSettings.UserCulture;if(!e.AdMarket||!/^[a-zA-z\-]*$/.test(e.AdMarket))return t?t.toLowerCase():"en-us";var n=e.AdMarket.toLowerCase();return c.indexOf(n)>-1?n:u[n.split("-")[1]]||n}()}function p(e){return null!=e?e.toUpperCase().split("-"):[]}function h(e){return p(e)[1]||"US"}function m(){return Object(o.a)("ANON")}function v(){return Object(o.a)("MUID")}function C(){return!!Object(o.a)("TOptOut")}function O(){return r||(r=Object(i.a)("anjs")||"https://acdn.adnxs.com/ast/static/0.30.1/ast.js")}}}]);
//# sourceMappingURL=owa.ActionableMessageMail.js.map
self.scriptsLoaded['owa.ActionableMessageMail.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.ActionableMessageMail.js'] = (new Date()).getTime();