self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.LazyBulkActionStore.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[355],{1030:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(t){return Object(r.__assign)({__type:"IndexedPageView:#Exchange"},t)}},1062:function(t,e,n){"use strict";var r=n(108),i=n(1128),o={ChannelData:"ChannelData",SubscriptionAdded:"SubscriptionAdded",SubscriptionRemoved:"SubscriptionRemoved",SubscriptionUpdated:"SubscriptionUpdated",NotificationData:"NotificationData",TraceWarn:"TraceWarn",TraceError:"TraceError"};n.d(e,"f",(function(){return u})),n.d(e,"g",(function(){return c})),n.d(e,"b",(function(){return s})),n.d(e,"e",(function(){return l})),n.d(e,"d",(function(){return d})),n.d(e,"c",(function(){return f})),n.d(e,"a",(function(){return o}));var a=new r.c((function(){return Promise.all([n.e(713),n.e(426)]).then(n.bind(null,15023))})),u=new r.a(a,(function(t){return t.subscribe})),c=new r.a(a,(function(t){return t.unsubscribe})),s=new r.b(a,(function(t){return t.getChannelId})),l=(new r.b(a,(function(t){return t.getChannelReady})),new r.a(a,(function(t){return t.setup}))),d=new r.a(a,(function(t){return t.initializeNotificationManager})),f=new r.b(a,(function(t){return t.getNotificationEmitter}));i.a},1128:function(t,e,n){"use strict";var r=function(){function t(){this.eventDictionary={}}return t.prototype.on=function(t,e,n){return(this.eventDictionary[t]||(this.eventDictionary[t]=[])).push({callback:e,callbackThis:n}),this},t.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=(this.eventDictionary[t]||[]).slice();return r.forEach((function(t){return t.callback.apply(t.callbackThis,e)})),this},t.prototype.off=function(t,e){var n=this.eventDictionary[t];if(n){var r=n.filter((function(t){return t.callback!==e}));r.length?this.eventDictionary[t]=r:delete this.eventDictionary[t]}return this},t.prototype.once=function(t,e,n){var r=this,i=function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];return r.off(t,i),e.apply(n,o)};return(this.eventDictionary[t]||(this.eventDictionary[t]=[])).push({callback:i,callbackThis:n}),this},t}();e.a=r},1220:function(t,e,n){"use strict";n.d(e,"b",(function(){return o}));var r=n(4),i={bulkActionInformationMap:new(n(24).ObservableMap)},o=Object(r.createStore)("bulkActionStore",i),a=o();e.a=a},1246:function(t,e,n){var r=n(1360),i=36e5,o=6e4,a=2,u=/[T ]/,c=/:/,s=/^(\d{2})$/,l=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],d=/^(\d{4})/,f=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],p=/^-(\d{2})$/,b=/^-?(\d{3})$/,m=/^-?(\d{2})-?(\d{2})$/,v=/^-?W(\d{2})$/,g=/^-?W(\d{2})-?(\d{1})$/,I=/^(\d{2}([.,]\d*)?)$/,A=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,h=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,k=/([Z+-].*)$/,C=/^(Z)$/,y=/^([+-])(\d{2})$/,O=/^([+-])(\d{2}):?(\d{2})$/;function _(t,e,n){e=e||0,n=n||0;var r=new Date(0);r.setUTCFullYear(t,0,4);var i=7*e+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+i),r}t.exports=function(t,e){if(r(t))return new Date(t.getTime());if("string"!=typeof t)return new Date(t);var n=(e||{}).additionalDigits;n=null==n?a:Number(n);var T=function(t){var e,n={},r=t.split(u);c.test(r[0])?(n.date=null,e=r[0]):(n.date=r[0],e=r[1]);if(e){var i=k.exec(e);i?(n.time=e.replace(i[1],""),n.timezone=i[1]):n.time=e}return n}(t),B=function(t,e){var n,r=l[e],i=f[e];if(n=d.exec(t)||i.exec(t)){var o=n[1];return{year:parseInt(o,10),restDateString:t.slice(o.length)}}if(n=s.exec(t)||r.exec(t)){var a=n[1];return{year:100*parseInt(a,10),restDateString:t.slice(a.length)}}return{year:null}}(T.date,n),j=B.year,D=function(t,e){if(null===e)return null;var n,r,i,o;if(0===t.length)return(r=new Date(0)).setUTCFullYear(e),r;if(n=p.exec(t))return r=new Date(0),i=parseInt(n[1],10)-1,r.setUTCFullYear(e,i),r;if(n=b.exec(t)){r=new Date(0);var a=parseInt(n[1],10);return r.setUTCFullYear(e,0,a),r}if(n=m.exec(t)){r=new Date(0),i=parseInt(n[1],10)-1;var u=parseInt(n[2],10);return r.setUTCFullYear(e,i,u),r}if(n=v.exec(t))return o=parseInt(n[1],10)-1,_(e,o);if(n=g.exec(t)){o=parseInt(n[1],10)-1;var c=parseInt(n[2],10)-1;return _(e,o,c)}return null}(B.restDateString,j);if(D){var w,S=D.getTime(),x=0;return T.time&&(x=function(t){var e,n,r;if(e=I.exec(t))return(n=parseFloat(e[1].replace(",",".")))%24*i;if(e=A.exec(t))return n=parseInt(e[1],10),r=parseFloat(e[2].replace(",",".")),n%24*i+r*o;if(e=h.exec(t)){n=parseInt(e[1],10),r=parseInt(e[2],10);var a=parseFloat(e[3].replace(",","."));return n%24*i+r*o+1e3*a}return null}(T.time)),T.timezone?w=function(t){var e,n;if(e=C.exec(t))return 0;if(e=y.exec(t))return n=60*parseInt(e[2],10),"+"===e[1]?-n:n;if(e=O.exec(t))return n=60*parseInt(e[2],10)+parseInt(e[3],10),"+"===e[1]?-n:n;return 0}(T.timezone):(w=new Date(S+x).getTimezoneOffset(),w=new Date(S+x+w*o).getTimezoneOffset()),new Date(S+x+w*o)}return new Date(t)}},1360:function(t,e){t.exports=function(t){return t instanceof Date}},1376:function(t,e,n){"use strict";var r,i;n.d(e,"a",(function(){return i})),function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Running=1]="Running",t[t.Cancelled=2]="Cancelled",t[t.Complete=3]="Complete",t[t.Failed=4]="Failed",t[t.Timeout=5]="Timeout",t[t.Cancelling=6]="Cancelling"}(r||(r={})),function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Running=1]="Running",t[t.Cancelled=2]="Cancelled",t[t.Complete=3]="Complete",t[t.Failed=4]="Failed",t[t.Timeout=5]="Timeout"}(i||(i={})),e.b=r},1569:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(t){return Object(r.__assign)({__type:"ItemChange:#Exchange"},t)}},1582:function(t,e,n){"use strict";var r=n(108),i=n(1220),o=n(2374),a=n(79);function u(t){var e=i.a.bulkActionInformationMap.get(t);return!!e&&(!(e.customData&&!function(t){var e;try{e=JSON.parse(t)}catch(t){return a.d("Failed to parse bulkActionInfo.customData"),!1}return null!==e&&null!==e.Scenario}(e.customData))&&!Object(o.a)(e,t))}function c(t,e){var n=i.a.bulkActionInformationMap.get(t);return u(t)&&n.state==e}function s(t){return(c(t,l.b.Uninitialized)||c(t,l.b.Running))&&u(t)}n(1937);var l=n(1376);n.d(e,"a",(function(){return f})),n.d(e,"j",(function(){return p})),n.d(e,"i",(function(){return b})),n.d(e,"k",(function(){return m})),n.d(e,"f",(function(){return v})),n.d(e,"h",(function(){return g})),n.d(e,"g",(function(){return I})),n.d(e,"c",(function(){return c})),n.d(e,"e",(function(){return u})),n.d(e,"d",(function(){return s})),n.d(e,"b",(function(){return l.b})),n.d(e,"l",(function(){return i.a}));var d=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(164)]).then(n.bind(null,8159))})),f=Object(r.d)(d,(function(t){return t.BulkActionSpinner})),p=new r.a(d,(function(t){return t.subscribeToBulkActionNotification})),b=new r.a(d,(function(t){return t.onBulkActionSubmitted})),m=new r.a(d,(function(t){return t.findBulkActionItemAction})),v=new r.a(d,(function(t){return t.onBulkActionCancel})),g=new r.a(d,(function(t){return t.onBulkActionHierarchyNotification})),I=new r.a(d,(function(t){return t.onBulkActionDismiss}))},1937:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(2600),i=n(9);function o(t,e){switch(t){case"EmptyFolder":return Object(i.c)(Object(i.b)(r.a),e);case"Sweep":return Object(i.c)(Object(i.b)(r.c),e);case"RunRuleNow":return Object(i.c)(Object(i.b)(r.b),e);default:throw new Error("Invalid bulk action scenario type")}}},2236:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(t){return Object(r.__assign)({__type:"SortResults:#Exchange"},t)}},2342:function(t,e,n){"use strict";var r=n(25),i=n(0);function o(t,e){var n;return void 0===t||t.__type||(n=t,t=Object(i.__assign)({__type:"UpdateItemJsonRequest:#Exchange"},n)),Object(r.a)("UpdateItem",t,e)}n.d(e,"a",(function(){return o}))},2374:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(2522),i=n.n(r),o=n(1376),a=n(1220);function u(t,e){var n=new Date,r=new Date(t.sendTime),u=i()(n,r),c=isNaN(u),s=u>7.5,l=Object(a.b)().bulkActionInformationMap.get(e);return!(!c&&!s)||!!l&&[o.b.Cancelled,o.b.Failed,o.b.Complete].indexOf(l.state)>-1}},2375:function(t,e,n){var r=n(1246);t.exports=function(t,e){var n=r(t),i=r(e);return n.getTime()-i.getTime()}},2379:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(t){return Object(r.__assign)({__type:"UpdateItemRequest:#Exchange"},t)}},2522:function(t,e,n){var r=n(2375),i=36e5;t.exports=function(t,e){var n=r(t,e)/i;return n>0?Math.floor(n):Math.ceil(n)}},2600:function(t){t.exports=JSON.parse('{"a":"mra","c":"nra","b":"ora"}')},426:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(347),i=n(353);function o(t,e){var n=Object(r.a)(t,(function(t){return e===t||t.hasAttribute(i.a)}));return null!==n&&n.hasAttribute(i.a)}},431:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(t){return Object(r.__assign)({__type:"FolderId:#Exchange"},t)}},484:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(t){return Object(r.__assign)({__type:"ItemResponseShape:#Exchange"},t)}},553:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(t){return Object(r.__assign)({__type:"ItemId:#Exchange"},t)}},610:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(t){return Object(r.__assign)({__type:"FindItemJsonRequest:#Exchange"},t)}},627:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(25),i=n(610);function o(t,e){return void 0===t||t.__type||(t=Object(i.a)(t)),Object(r.a)("FindItem",t,e)}},628:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(t){return Object(r.__assign)({__type:"FindItemRequest:#Exchange"},t)}},8159:function(t,e,n){"use strict";n.r(e);var r=n(1376),i=n(627),o=n(628),a=n(431),u=n(484),c=n(964),s=n(2236),l=n(246);function d(t,e,n,r){var d=function(t,e){return Object(o.a)({ParentFolderIds:[Object(a.a)({Id:t})],ItemShape:Object(u.a)({BaseShape:"IdOnly"}),ShapeName:"BulkActionItem",Traversal:"Shallow",Paging:e,FocusedViewFilter:-1,ViewFilter:"All",SortOrder:[Object(s.a)({Order:"Descending",Path:Object(c.a)({FieldURI:"ItemLastModifiedTime"})})]})}(r,n),f=Object(l.a)();return f.RequestServerVersion="V2018_01_18",Object(i.a)({Header:f,Body:d})}var f=n(27),p=n(1030),b=n(0),m=n(973),v=n(2374),g=n(1220),I=n(4),A=Object(I.mutatorAction)("setBulkActionInformation",(function(t,e){g.a.bulkActionInformationMap.set(t,e)})),h=n(1582);var k=n(79);function C(t,e){void 0===t&&(t=0),void 0===e&&(e=10);var n=Object(f.a)().SessionSettings,r=n.DefaultFolderNames.indexOf("bulkactions"),i=n.DefaultFolderIds[r];i&&d(0,0,Object(p.a)({BasePoint:"Beginning",Offset:0,MaxEntriesReturned:e}),i.Id).then((function(t){var e=t.Body.ResponseMessages.Items[0];e&&"Success"==e.ResponseClass&&e.RootFolder.Items&&function(t){var e,n;try{for(var r=Object(b.__values)(t),i=r.next();!i.done;i=r.next()){var o=i.value,a=o.BulkActionTargetFolderId.Id,u=g.a.bulkActionInformationMap.get(a);if(o.BulkActionState==h.b.Running||(null==u?void 0:u.state)==h.b.Uninitialized){var c=o.BulkActionProcessedCount/Math.max(1,o.BulkActionTotalCount),s={id:o.ItemId.Id,targetFolderName:Object(m.a)(a),sendTime:o.BulkActionSendTime,startTime:o.BulkActionStartTime,customData:o.BulkActionCustomData,class:o.BulkActionClass,state:o.BulkActionState,progress:{processedCount:o.BulkActionProcessedCount,percentComplete:c,totalCount:o.BulkActionTotalCount}};Object(v.a)(s,a)||A(a,s)}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}(e.RootFolder.Items)})).catch((function(t){k.g.warn("Unable to update BulkActionStore via findBulkActionItemAction.")}))}var y,O=n(254),_=function(t,e,n,r,i,o,a,u){return[t,e,n,r]};function T(t,e){Object(O.o)(t,_(e.id,e.targetFolderName,e.startTime,e.sendTime,e.state,e.progress.processedCount,e.progress.totalCount,e.progress.percentComplete))}var B=((y={})[0]=h.b.Uninitialized,y[5]=h.b.Timeout,y[1]=h.b.Running,y[2]=h.b.Cancelled,y[3]=h.b.Complete,y[4]=h.b.Failed,y);function j(t){var e=t.BulkActionTargetFolderId,n=function(t){var e=Object(g.b)().bulkActionInformationMap.get(t);return e?e.progress:null}(e),r=n?n.processedCount:0,i=r<t.BulkActionProcessedCount?t.BulkActionProcessedCount:r,o={class:t.BulkActionClass,customData:t.BulkActionCustomData,id:t.BulkActionId,targetFolderName:Object(m.a)(e),sendTime:t.BulkActionSendTime,startTime:t.BulkActionStartTime,state:B[t.BulkActionState],progress:{percentComplete:i/t.BulkActionTotalCount,processedCount:i,totalCount:t.BulkActionTotalCount}};Object(v.a)(o,e)||(A(e,o),T("TnS_BulkActionDatapoint",o))}var D=Object(I.mutatorAction)("setBulkActionStateAttribute",(function(t,e){var n=g.a.bulkActionInformationMap.get(t);n&&(n.state=e)})),w=n(1062);function S(t){switch(t.EventType){case"RowAdded":case"RowModified":j(t);break;case"RowDeleted":D(t.BulkActionTargetFolderId,r.b.Complete);break;case"Reload":C();break;default:k.d("BulkActionNotification should only be fired on (RowAdded, RowModified, RowDeleted, Reload)")}}function x(){w.f.importAndExecute({subscriptionId:"BulkActionNotification",requiresExplicitSubscribe:!0,subscriptionParameters:{NotificationType:"BulkActionNotification"}},S)}var F=n(7);function R(t,e,n,i){var o={id:"",targetFolderName:Object(m.a)(t),startTime:"",sendTime:Object(F.ub)(Object(F.Qb)()),class:e,customData:n?JSON.stringify(n):"",state:r.b.Uninitialized,progress:{percentComplete:0,processedCount:0,totalCount:i}};A(t,o)}var E=n(1569),N=n(553),M=n(2342),U=n(2379);function P(t,e){if(e in r.a==!1)return k.d("Invalid BulkActionState value sent to server."),null;var n=function(t,e){var n=Object(E.a)({Updates:[{__type:"SetItemField:#Exchange",Path:{__type:"ExtendedPropertyUri:#Exchange",DistinguishedPropertySetId:"Common",PropertyName:"BulkActionState",PropertyType:"Integer"},Item:{__type:"Message:#Exchange",ExtendedProperty:[{__type:"ExtendedPropertyType:#Exchange",ExtendedFieldURI:{__type:"ExtendedPropertyUri:#Exchange",DistinguishedPropertySetId:"Common",PropertyName:"BulkActionState",PropertyType:"Integer"},Value:e}]}}],ItemId:Object(N.a)({Id:t})});return Object(U.a)({ItemChanges:[n],ConflictResolution:"AlwaysOverwrite",MessageDisposition:"SaveOnly"})}(t,e.toString()),i=Object(l.a)();return i.TimeZoneContext.TimeZoneDefinition.Id="UTC",Object(M.a)({Header:i,Body:n}).then((function(t){return t.Body.ResponseMessages.Items[0]}))}function $(t){var e=g.a.bulkActionInformationMap.get(t);return D(t,r.b.Cancelling),P(e.id,r.b.Cancelled).then((function(n){return"NoError"==n.ResponseCode?(D(t,r.b.Cancelled),T("TnS_BulkActionClientCancelDatapoint",e),!0):(D(t,e.state),k.d("Empty folder could not be cancelled."),!1)}))}var z=Object(I.mutatorAction)("setBulkActionCounts",(function(t){var e=Object(g.b)().bulkActionInformationMap.get(t.folderId);if(e&&e.state==h.b.Running){var n=e.progress,r=n.totalCount-t.itemCount;n.processedCount=Math.max(n.processedCount,r||0),n.processedCount>n.totalCount&&(n.totalCount=n.processedCount),n.percentComplete=n.processedCount/Math.max(1,n.totalCount)}}));function q(t){z(t)}var J=Object(I.mutatorAction)("deleteBulkActionState",(function(t){g.a.bulkActionInformationMap.delete(t)}));function V(t){T("TnS_BulkActionDismissDatapoint",g.a.bulkActionInformationMap.get(t)),J(t)}var Y=n(1),H=n(905),W=n(339),Z=n(898),L=n(1937),Q=n(42),G=Object(Q.a)((function(t){var e=h.l.bulkActionInformationMap.get(t.folderId),n=e.customData?JSON.parse(e.customData).Scenario:e.class,r=Object(L.a)(n,t.folderName);return Y.createElement(Z.a,{content:r,calloutProps:{gapSpace:0}},Y.createElement(H.a,{size:W.a.small,title:""}))}));n.d(e,"subscribeToBulkActionNotification",(function(){return x})),n.d(e,"onBulkActionSubmitted",(function(){return R})),n.d(e,"findBulkActionItemAction",(function(){return C})),n.d(e,"onBulkActionCancel",(function(){return $})),n.d(e,"onBulkActionHierarchyNotification",(function(){return q})),n.d(e,"onBulkActionDismiss",(function(){return V})),n.d(e,"BulkActionSpinner",(function(){return G}))},964:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(t){return Object(r.__assign)({__type:"PropertyUri:#Exchange"},t)}},973:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(48);function i(t){if(!t)throw new Error("Input parameter to folderIdToName must not be null.");return r.a.defaultFolderIdToNameMap.get(t)||"none"}}}]);
//# sourceMappingURL=owa.LazyBulkActionStore.js.map
self.scriptsLoaded['owa.LazyBulkActionStore.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.LazyBulkActionStore.js'] = (new Date()).getTime();