self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.HelpCharm.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[324],{11396:function(e){e.exports=JSON.parse('{"a":"J3b"}')},1246:function(e,t,n){var r=n(1360),i=36e5,a=6e4,o=2,s=/[T ]/,u=/:/,c=/^(\d{2})$/,d=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],f=/^(\d{4})/,l=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],p=/^-(\d{2})$/,m=/^-?(\d{3})$/,b=/^-?(\d{2})-?(\d{2})$/,v=/^-?W(\d{2})$/,g=/^-?W(\d{2})-?(\d{1})$/,O=/^(\d{2}([.,]\d*)?)$/,S=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,w=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,h=/([Z+-].*)$/,I=/^(Z)$/,j=/^([+-])(\d{2})$/,_=/^([+-])(\d{2}):?(\d{2})$/;function D(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var i=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+i),r}e.exports=function(e,t){if(r(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?o:Number(n);var x=function(e){var t,n={},r=e.split(s);u.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1]);if(t){var i=h.exec(t);i?(n.time=t.replace(i[1],""),n.timezone=i[1]):n.time=t}return n}(e),T=function(e,t){var n,r=d[t],i=l[t];if(n=f.exec(e)||i.exec(e)){var a=n[1];return{year:parseInt(a,10),restDateString:e.slice(a.length)}}if(n=c.exec(e)||r.exec(e)){var o=n[1];return{year:100*parseInt(o,10),restDateString:e.slice(o.length)}}return{year:null}}(x.date,n),C=T.year,F=function(e,t){if(null===t)return null;var n,r,i,a;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(n=p.exec(e))return r=new Date(0),i=parseInt(n[1],10)-1,r.setUTCFullYear(t,i),r;if(n=m.exec(e)){r=new Date(0);var o=parseInt(n[1],10);return r.setUTCFullYear(t,0,o),r}if(n=b.exec(e)){r=new Date(0),i=parseInt(n[1],10)-1;var s=parseInt(n[2],10);return r.setUTCFullYear(t,i,s),r}if(n=v.exec(e))return a=parseInt(n[1],10)-1,D(t,a);if(n=g.exec(e)){a=parseInt(n[1],10)-1;var u=parseInt(n[2],10)-1;return D(t,a,u)}return null}(T.restDateString,C);if(F){var y,P=F.getTime(),U=0;return x.time&&(U=function(e){var t,n,r;if(t=O.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*i;if(t=S.exec(e))return n=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),n%24*i+r*a;if(t=w.exec(e)){n=parseInt(t[1],10),r=parseInt(t[2],10);var o=parseFloat(t[3].replace(",","."));return n%24*i+r*a+1e3*o}return null}(x.time)),x.timezone?y=function(e){var t,n;if(t=I.exec(e))return 0;if(t=j.exec(e))return n=60*parseInt(t[2],10),"+"===t[1]?-n:n;if(t=_.exec(e))return n=60*parseInt(t[2],10)+parseInt(t[3],10),"+"===t[1]?-n:n;return 0}(x.timezone):(y=new Date(P+U).getTimezoneOffset(),y=new Date(P+U+y*a).getTimezoneOffset()),new Date(P+U+y*a)}return new Date(e)}},1360:function(e,t){e.exports=function(e){return e instanceof Date}},279:function(e,t,n){"use strict";var r=n(560);n.d(t,"a",(function(){return r.a}))},287:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"f",(function(){return d}));var r=n(108),i=(n(481),new r.c((function(){return Promise.all([n.e(28),n.e(4),n.e(460)]).then(n.bind(null,901))}))),a=(new r.a(i,(function(e){return e.makeOwsPrimeRequest})).importAndExecute,new r.a(i,(function(e){return e.makePostRequest})).importAndExecute),o=new r.a(i,(function(e){return e.makePatchRequest})).importAndExecute,s=new r.a(i,(function(e){return e.makePutRequest})).importAndExecute,u=new r.a(i,(function(e){return e.makeGetRequest})).importAndExecute,c=new r.a(i,(function(e){return e.makeDeleteRequest})).importAndExecute,d=new r.a(i,(function(e){return e.sendOwsPrimeRequest})).importAndExecute},3224:function(e,t,n){"use strict";var r=n(0),i=n(287),a="ows/api/beta/PremiumSubscription";function o(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return[2,Object(i.d)(a,null)]}))}))}var s,u="ows/api/beta/PremiumSubscription";function c(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return s||(s=Object(i.b)(u)),[2,s]}))}))}var d="ows/api/beta/PremiumSubscription/Renew";function f(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return[2,Object(i.d)(d,null)]}))}))}var l,p="ows/api/beta/PremiumSubscription/MDollar";function m(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return l||(l=Object(i.b)(p)),[2,l]}))}))}var b="ows/api/beta/PremiumSubscription/MDollar";function v(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return[2,Object(i.d)(b,null)]}))}))}n.d(t,"e",(function(){return g})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return c})),n.d(t,"f",(function(){return f})),n.d(t,"c",(function(){return m})),n.d(t,"a",(function(){return v}));var g=9999},3705:function(e,t,n){"use strict";var r=n(25),i=n(0);function a(e,t){if(void 0!==e.datapoints)for(var n=0;n<e.datapoints.length;n++)void 0===e.datapoints[n]||e.datapoints[n].__type||(e.datapoints[n]=(a=e.datapoints[n],Object(i.__assign)({__type:"Datapoint:#Exchange"},a)));var a;return Object(r.a)("LogDatapoint",e,t)}n.d(t,"a",(function(){return a}))},428:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));var r=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function i(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function a(){return i()+i()+"-"+i()+"-"+i()+"-"+i()+"-"+i()+i()+i()}function o(e){return r.test(e)}},481:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));var r="owsserver",i="owsapi"},4864:function(e,t,n){var r=n(1246);e.exports=function(e,t){var n=r(e),i=Number(t);return n.setDate(n.getDate()+i),n}},5487:function(e,t,n){"use strict";var r,i=n(0),a=n(4864),o=n.n(a),s=n(3224),u=n(103),c=n(287),d="ows/api/v1/PremiumFlight";var f=n(4),l=Object(f.createStore)("premiumFlightStore",{flightNames:[],isInit:!1})(),p=Object(f.mutatorAction)("persistResponse",(function(e){e.flightNames&&(l.flightNames=e.flightNames),l.isInit=!0}));function m(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,a,o,s;return Object(i.__generator)(this,(function(u){switch(u.label){case 0:return l.isInit?[3,2]:[4,(r||(r=Object(c.b)(d)),r)];case 1:t=u.sent(),p(t),u.label=2;case 2:try{for(n=Object(i.__values)(l.flightNames),a=n.next();!a.done;a=n.next())if(a.value===e.toLowerCase())return[2,!0]}catch(e){o={error:e}}finally{try{a&&!a.done&&(s=n.return)&&s.call(n)}finally{if(o)throw o.error}}return[2,!1]}}))}))}var b="ows/api/v1/PremiumFlight";function v(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){return[2,Object(c.d)(b,e)]}))}))}var g=Object(f.mutatorAction)("persistFlight",(function(e){l.flightNames.push(e.toLowerCase())}));function O(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return e&&-1==l.flightNames.indexOf(e.toLowerCase())?(g(e),[4,v({flightName:e})]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}function S(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,r;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return(t=Object(u.i)()).SessionSettings.IsPremiumConsumerMailbox&&"en-US"===t.SessionSettings.UserCulture?[4,m(e)]:[3,8];case 1:return i.sent()?[2,!0]:[3,2];case 2:return[4,Object(s.d)()];case 3:return null!=(n=i.sent())?[3,5]:[4,Object(s.b)()];case 4:n=i.sent(),i.label=5;case 5:return(r=function(e){for(var t=new Date,n=0;n<e.length;n++){var r=e[n],i=new Date(r.subscriptionExpireDate);if("office"===r.brandId.toLowerCase()&&i.getFullYear()!=s.e&&!r.autoRenew&&!r.isSuppressedOfferId&&"enabled"===r.subscriptionStatus.toLowerCase()&&i>t&&o()(i,-30)<t)return!0}return!1}(n.subscriptions))?[4,O(e)]:[3,7];case 6:i.sent(),i.label=7;case 7:return[2,r];case 8:return[2,!1]}}))}))}var w=n(76),h="auth-PremiumSupportTreatment";function I(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){switch(e.label){case 0:return Object(w.h)("auth-PremiumSupportTreatment")?[4,S(h)]:[3,2];case 1:return[2,e.sent()];case 2:return[2,!1]}}))}))}var j="auth-PremiumSupportControl";function _(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){switch(e.label){case 0:return Object(w.h)("auth-PremiumSupportControl")?[4,S(j)]:[3,2];case 1:return[2,e.sent()];case 2:return[2,!1]}}))}))}n.d(t,"b",(function(){return I})),n.d(t,"a",(function(){return _}))},560:function(e,t,n){"use strict";function r(e){return e>=200&&e<300}n.d(t,"a",(function(){return r}))},6155:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(2042),a="resources/scripts/osefo.js",o="RXOWA",s={bottom:"0",left:"0",height:"100%",width:"100%",position:"absolute"},u="https://concierge.live.com",c="OsefoLoadWidget",d="OsefoDismissWidget",f="TicketCreated",l="N/A",p="MiniMavenDataPoint",m=3e4,b="Owa Mail",v="https://api.diagnostics.office.com/v1/diagnosticsession",g="OWAHelpshift",O=1048576,S=n(27),w=n(295),h=n(5487),I=n(2);function j(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t,n,i,a,o,s,u,c,d,f,p,m,b,v,g,j,_;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e=Object(S.a)(),window.performance&&((i=new Date).setTime(window.performance.timing.fetchStart),t=String(i),n=String(((new Date).getTime()-window.performance.timing.fetchStart)/6e4)),a=l,o=l,s=l,u=l,c=l,d={},f={},(p=window.performance.memory)&&(a=String(p.jsHeapSizeLimit/O|0),o=String(p.totalJSHeapSize/O|0),s=String(p.usedJSHeapSize/O|0),u=String(p.usedJSHeapSize/p.jsHeapSizeLimit),c=String(p.usedJSHeapSize%1e3!=0)),d.IsFocusedInboxEnabled=String(e.UserOptions.IsFocusedInboxEnabled),d.IsFocusedInboxCapable=String(e.UserOptions.IsFocusedInboxCapable),d.FocusedInboxServerOverride=String(e.UserOptions.FocusedInboxServerOverride),d.IsFocusedInboxFeatureSupported=String(e.UserOptions.IsFocusedInboxFeatureSupported),d.IsFocusedInboxOnAdminOverride=String(e.UserOptions.IsFocusedInboxOnAdminOverride),d.IsFocusedInboxOnAdminLastUpdateTime=e.UserOptions.IsFocusedInboxOnAdminLastUpdateTime,d.IsFocusedInboxOnLastUpdateTime=e.UserOptions.IsFocusedInboxOnLastUpdateTime,f.Name=e.SessionSettings.UserDisplayName,f.Country=e.UserOptions.TimeZone,f["Premium Consumer"]=String(e.SessionSettings.IsPremiumConsumerMailbox),f["Memory usage ratio [0,1]"]=String(u),f["Memory.IsHighPrecision"]=c,f["Memory.JSHeapSizeLimit (MB)"]=a,f["Memory.TotalJSHeapSize (MB)"]=o,f["Memory.UsedJSHeapSize (MB)"]=s,f.Platform=window.navigator.platform,f["Browser language"]=window.navigator.language,f["Cookie enabled"]=String(window.navigator.cookieEnabled),f["User agent"]=window.navigator.userAgent,f["Document.Cookie"]=document.cookie,f["Mailbox culture"]=e.SessionSettings.UserCulture,f["OWA layout"]=Object(I.e)(),f["OWA UTC Start Time"]=t,f["Session length"]=n,f["Focused Inbox settings"]=JSON.stringify(d),f.Versioning=Object(I.j)(),f.Ring=Object(I.q)(),f.UserType=Object(w.a)()?"Consumer":"Business",m=f,b="IsPremiumSupport",v=String,[4,Object(h.b)()];case 1:return m[b]=v.apply(void 0,[r.sent()]),g=f,j="IsPremiumSupportControl",_=String,[4,Object(h.a)()];case 2:return g[j]=_.apply(void 0,[r.sent()]),[2,JSON.stringify(f)]}}))}))}var _=n(79),D=n(9),x=n(3705);function T(e){var t=[e.sessionId,e.eventId,e.loadTime,e.eventData,e.isDeeplinkScenario],n={Id:p,Consumers:1,Time:new Date(Date.now()).toString(),Keys:["mmsid","mmeid","mmlt","mmed","mmidl"],Values:t};return Object(x.a)({datapoints:[n]})}var C=n(162);var F=n(279);function y(e,t){var n=e.split("-");if(n.length>1){var r=Object(S.a)();(function(e){var t=new Headers;t.append("Content-Type","application/json"),t.append("Accept","text/plain"),t.append("X-MS-SARA-API-Version","schema-v1"),t.append("Host","api.diagnostics.office.com"),t.append("SaraSessionId",e.SessionId);var n={method:"POST",credentials:"same-origin"};return n.body=JSON.stringify(e),n.headers=t,fetch(v,n)})({TenantId:r.SessionSettings.TenantGuid,TicketId:n[1],TicketTier:g,UserPuid:r.SessionSettings.UserPuid,SessionId:t}).then((function(e){if(!Object(F.a)(e.status)){var t="POST request to "+v+" failed, http error:"+e.status;throw new Error(t)}e.json().then((function(e){C.b.info(Object(D.c)("ODS SessionId {0} TicketId {1}",e.DiagnosticSessionId,e.TicketId))}))})).catch((function(e){!function(e,t,n,r){var i={Error:e,TenantId:r.SessionSettings.TenantGuid,TicketId:t,UserPuid:r.SessionSettings.UserPuid};T({sessionId:n,eventId:"ODSFailEvent",eventData:JSON.stringify(i),loadTime:"",isDeeplinkScenario:""})}(e.message,n[1],t,r)}))}}var P=n(428),U="https://support.office.com",k="InvokeFeedback",A="RequestMetadata";function M(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return e.origin!=U?[3,4]:(_.g.info("Soc post message event: "+e.data),e.data!=k?[3,1]:(i.e.importAndExecute(),[3,4]));case 1:return e.data!=A?[3,3]:[4,j()];case 2:return t=n.sent(),e.source.postMessage(t,U),[3,4];case 3:"string"==typeof e.data&&e.data.indexOf(f)>-1&&y(e.data,Object(P.a)()),n.label=4;case 4:return[2]}}))}))}var E,z,$,H,L,N,R,W=n(11396),J=n(213),q=n(288),Y=n(76);function B(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e?(E=t,L=e,z=Object(P.a)(),R=Object(S.a)(),(N=document.createElement("script")).src=Object(q.resolve)(Object(I.u)(),a),[4,X()]):[3,3];case 1:return n=r.sent(),[4,j()];case 2:i=r.sent(),N.onload=function(){var t={sessionId:z,appId:o,locale:R.SessionSettings.UserCulture,hideHeader:!0,disableTicketFlow:n,theme:G(),metadata:i},r={hostingDiv:e,baseUrl:u,clientContext:t,widgetStyle:s,widgetEventListenerCallback:V};H=window.setTimeout(Z,m),T({sessionId:z,eventId:"LaunchWidget",eventData:b,loadTime:"",isDeeplinkScenario:""}),$=(new Date).getTime(),window.Osefo.CreateWidget(r)},document.head.appendChild(N),r.label=3;case 3:return[2]}}))}))}function G(){var e=Object(J.i)(),t=e.themePrimary,n=e.themeDark;return{button:{bgColor:{onActive:t,onHover:n},borderColor:{onActive:t,onHover:n}},link:{color:{onActive:t,onHover:n}}}}function V(e){e==d?(T({sessionId:z,eventId:"OnWidgetDismissEvent",eventData:b,loadTime:"",isDeeplinkScenario:""}),E()):e==c?(window.clearTimeout(H),T({sessionId:z,eventId:"OnWidgetLoadEvent",eventData:b,loadTime:String((new Date).getTime()-$),isDeeplinkScenario:""})):e.indexOf(f)>-1&&y(e,z)}function Z(){L.innerText=Object(D.b)(W.a),T({sessionId:z,eventId:"OnWidgetLoadFailEvent",eventData:b,loadTime:String((new Date).getTime()-$),isDeeplinkScenario:""})}function X(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return Object(Y.h)("help-disableTicketFlow")?[4,Object(h.b)()]:[3,3];case 1:return e=n.sent(),[4,Object(h.a)()];case 2:return t=n.sent(),e||t?[2,!1]:[2,!0];case 3:return[2,!1]}}))}))}n.d(t,"handleSocPostMessageEvents",(function(){return M})),n.d(t,"loadMiniMavenHelpWidget",(function(){return B}))}}]);
//# sourceMappingURL=owa.HelpCharm.js.map
self.scriptsLoaded['owa.HelpCharm.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.HelpCharm.js'] = (new Date()).getTime();