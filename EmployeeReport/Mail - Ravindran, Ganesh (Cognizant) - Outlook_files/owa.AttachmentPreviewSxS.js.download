self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.AttachmentPreviewSxS.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[136],{1018:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"c",(function(){return c}));var r="POST",a="cors",i="GET",o="PUT",c="PATCH"},1020:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"TargetFolderId:#Exchange"},e)}},1062:function(e,t,n){"use strict";var r=n(108),a=n(1128),i={ChannelData:"ChannelData",SubscriptionAdded:"SubscriptionAdded",SubscriptionRemoved:"SubscriptionRemoved",SubscriptionUpdated:"SubscriptionUpdated",NotificationData:"NotificationData",TraceWarn:"TraceWarn",TraceError:"TraceError"};n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return f})),n.d(t,"a",(function(){return i}));var o=new r.c((function(){return Promise.all([n.e(713),n.e(426)]).then(n.bind(null,15023))})),c=new r.a(o,(function(e){return e.subscribe})),u=new r.a(o,(function(e){return e.unsubscribe})),s=new r.b(o,(function(e){return e.getChannelId})),d=(new r.b(o,(function(e){return e.getChannelReady})),new r.a(o,(function(e){return e.setup}))),l=new r.a(o,(function(e){return e.initializeNotificationManager})),f=new r.b(o,(function(e){return e.getNotificationEmitter}));a.a},1088:function(e,t,n){"use strict";n.d(t,"b",(function(){return s}));var r=n(0),a=n(24),i=n(76),o=n(1367),c=n(4),u={conversationReadingPaneViewState:null,loadedItemReadingPaneViewStates:new a.ObservableMap({}),loadedConversationReadingPaneViewStates:new a.ObservableMap({}),itemReadingPaneViewState:null,itemPreviewPaneViewState:null,itemPrintPaneViewState:null,deeplinkId:null,shouldShowMobileUpsellEmptyState:!1,primaryReadingPaneTabId:null,sxsId:null},s=Object(c.createStore)("readingpane",u),d=s();o.a.registerReference((function(){var e,t;return Object(i.h)("rp-persistedReadingPaneTabs")?Object(r.__spread)(d.loadedConversationReadingPaneViewStates.keys()):null===(t=null===(e=d.conversationReadingPaneViewState)||void 0===e?void 0:e.conversationId)||void 0===t?void 0:t.Id})),t.a=d},1130:function(e,t,n){"use strict";var r=n(24),a=n(4),i={viewStates:new r.ObservableMap,primaryComposeId:null,newMessageCreationInProgress:!1},o=Object(a.createStore)("compose",i),c=o();n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return o}))},1154:function(e,t,n){"use strict";var r=n(1018),a=n(1336);function i(e){var t;try{t=btoa(e)}catch(n){t=btoa(unescape(encodeURIComponent(e)))}finally{return"u!"+t.replace(/=+$/,"").replace("/","_").replace("+","-")}}n.d(t,"d",(function(){return r.d})),n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b})),n.d(t,"e",(function(){return r.e})),n.d(t,"c",(function(){return r.c})),n.d(t,"f",(function(){return a.a})),n.d(t,"g",(function(){return i}))},1193:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1088),a=n(76),i=n(2021);function o(e){return Object(a.h)("rp-persistedReadingPaneTabs")?Object(r.b)().loadedConversationReadingPaneViewStates.get(e||(Object(r.b)().sxsId?Object(r.b)().sxsId:Object(i.a)())):Object(r.b)().conversationReadingPaneViewState}},1240:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(1226);function a(e){return o(e.type)}function i(e){return o(Object(r.a)(e))}function o(e){return 1===e||3===e}},1246:function(e,t,n){var r=n(1360),a=36e5,i=6e4,o=2,c=/[T ]/,u=/:/,s=/^(\d{2})$/,d=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],l=/^(\d{4})/,f=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],b=/^-(\d{2})$/,v=/^-?(\d{3})$/,m=/^-?(\d{2})-?(\d{2})$/,h=/^-?W(\d{2})$/,p=/^-?W(\d{2})-?(\d{1})$/,w=/^(\d{2}([.,]\d*)?)$/,O=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,g=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,I=/([Z+-].*)$/,j=/^(Z)$/,S=/^([+-])(\d{2})$/,_=/^([+-])(\d{2}):?(\d{2})$/;function P(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var a=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+a),r}e.exports=function(e,t){if(r(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?o:Number(n);var y=function(e){var t,n={},r=e.split(c);u.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1]);if(t){var a=I.exec(t);a?(n.time=t.replace(a[1],""),n.timezone=a[1]):n.time=t}return n}(e),C=function(e,t){var n,r=d[t],a=f[t];if(n=l.exec(e)||a.exec(e)){var i=n[1];return{year:parseInt(i,10),restDateString:e.slice(i.length)}}if(n=s.exec(e)||r.exec(e)){var o=n[1];return{year:100*parseInt(o,10),restDateString:e.slice(o.length)}}return{year:null}}(y.date,n),T=C.year,x=function(e,t){if(null===t)return null;var n,r,a,i;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(n=b.exec(e))return r=new Date(0),a=parseInt(n[1],10)-1,r.setUTCFullYear(t,a),r;if(n=v.exec(e)){r=new Date(0);var o=parseInt(n[1],10);return r.setUTCFullYear(t,0,o),r}if(n=m.exec(e)){r=new Date(0),a=parseInt(n[1],10)-1;var c=parseInt(n[2],10);return r.setUTCFullYear(t,a,c),r}if(n=h.exec(e))return i=parseInt(n[1],10)-1,P(t,i);if(n=p.exec(e)){i=parseInt(n[1],10)-1;var u=parseInt(n[2],10)-1;return P(t,i,u)}return null}(C.restDateString,T);if(x){var A,R=x.getTime(),E=0;return y.time&&(E=function(e){var t,n,r;if(t=w.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*a;if(t=O.exec(e))return n=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),n%24*a+r*i;if(t=g.exec(e)){n=parseInt(t[1],10),r=parseInt(t[2],10);var o=parseFloat(t[3].replace(",","."));return n%24*a+r*i+1e3*o}return null}(y.time)),y.timezone?A=function(e){var t,n;if(t=j.exec(e))return 0;if(t=S.exec(e))return n=60*parseInt(t[2],10),"+"===t[1]?-n:n;if(t=_.exec(e))return n=60*parseInt(t[2],10)+parseInt(t[3],10),"+"===t[1]?-n:n;return 0}(y.timezone):(A=new Date(R+E).getTimezoneOffset(),A=new Date(R+E+A*i).getTimezoneOffset()),new Date(R+E+A*i)}return new Date(e)}},1257:function(e,t,n){"use strict";var r=n(0),a=n(1750),i=n.n(a),o=n(9),c=n(295),u=n(699),s=n(288),d=n(25);function l(e){return Object(r.__assign)({__type:"GetAccessTokenForDataProviderRequest:#Exchange"},e)}function f(e,t){return void 0===e||e.__type||(e=l(e)),Object(d.a)("GetAccessTokenforDataProvider",e,t)}function b(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,i,o,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return a=l({DataProviderType:e,ResourceUrl:t,IsGroupRequest:!1}),i=n?"getAccessTokenForDataProvider_"+n:"getAccessTokenForDataProvider",(o=new Headers).append("X-OWA-ActionName",i),[4,f(a,{headers:o,datapoint:{customData:{actionSource:n},headersCustomData:function(e){return{tokenResultDetails:e.get("x-tokenresult")}},jsonCustomData:function(e){return{tokenStatus:e.TokenResultCode.toString()}}},returnFullResponseOnSuccess:!0})];case 1:return[4,(c=r.sent()).json()];case 2:return[2,{token:r.sent(),response:c}]}}))}))}var v="onedrive_implicit.access",m="Bearer ",h=n(76),p=function(e,t,n){return Object(r.__assign)({resultCode:t,isAdalException:n,_typeSpec:"TokenRetrievalError"},e)},w=function(e){return"TokenRetrievalError"===e._typeSpec},O=[],g={},I=1,j=30,S="",_="Microsoft.IdentityModel.Clients.ActiveDirectory.AdalServiceException";function P(e){g[e]=null}function y(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,b(e,t,n)];case 1:return a=r.sent(),function(e,t,n){O=O.filter((function(e){return e!==t}));var r=n.token;if(0!==r.TokenResultCode||!r.AccessToken||""===r.AccessToken){var a="Access token request failed for token key "+e+" with response code "+r.TokenResultCode,i=n.response.headers.get("x-tokenresult"),o=null!=i&&i.indexOf(_)>0;throw p(new Error(a),r.TokenResultCode,o)}var c=g[e]||{};c[t]=r,g[e]=c}(e,t,a),[2,a.token]}}))}))}function C(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,i;return Object(r.__generator)(this,(function(r){return a=S,0===e&&n&&(i=Object(s.parse)(n),a=Object(o.c)("{0}//{1}/",i.protocol,i.hostname)),Object(h.h)("doc-attachment-testAuthFallback")?[2,""]:[2,x(e,a,t,null)]}))}))}function T(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){return[2,x(0,e,t,n)]}))}))}function x(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n||!function(e,t){var n=g[e];if(!n)return!1;var r=n[t];if(!r||!r.AccessTokenExpiry)return!1;var a=new Date(r.AccessTokenExpiry),o=i()(new Date(Date.now()),I);return null!=a&&o<a}(e,t)?[3,1]:(o=g[e],c=o[t],i()(new Date(Date.now()),j)>new Date(c.AccessTokenExpiry)&&-1===O.indexOf(t)&&(O.push(t),y(e,t,a)),[2,c.AccessToken]);case 1:return[4,y(e,t,a)];case 2:return[2,(c=r.sent()).AccessToken]}}))}))}function A(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(c.a)()&&1===e?[4,Object(u.getDelegationTokenForOwa)(v)]:[3,2];case 1:return a=r.sent(),[3,4];case 2:return[4,C(e,t,n)];case 3:a=r.sent(),r.label=4;case 4:return[2,m+a]}}))}))}n.d(t,"d",(function(){return A})),n.d(t,"c",(function(){return C})),n.d(t,"e",(function(){return T})),n.d(t,"b",(function(){return P})),n.d(t,"f",(function(){return w})),n.d(t,"a",(function(){return m}))},1272:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return u}));var r=600,a=600,i=650,o=1/2.89*100,c=420,u=420/1300*100},1292:function(e,t,n){"use strict";n.d(t,"o",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"f",(function(){return d})),n.d(t,"j",(function(){return l})),n.d(t,"m",(function(){return f})),n.d(t,"r",(function(){return b})),n.d(t,"k",(function(){return v})),n.d(t,"q",(function(){return m})),n.d(t,"n",(function(){return h})),n.d(t,"l",(function(){return p})),n.d(t,"d",(function(){return w})),n.d(t,"i",(function(){return O})),n.d(t,"p",(function(){return g})),n.d(t,"c",(function(){return I})),n.d(t,"g",(function(){return j})),n.d(t,"e",(function(){return S})),n.d(t,"s",(function(){return _}));var r=n(108),a=(n(1655),n(1693));n.d(t,"a",(function(){return a.a}));var i=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(375)]).then(n.bind(null,3219))})),o={captureBundleTime:!0},c=new r.a(i,(function(e){return e.replyToMessage}),o),u=new r.a(i,(function(e){return e.forwardMessage}),o),s=new r.a(i,(function(e){return e.closeCompose})),d=new r.a(i,(function(e){return e.discardCompose})),l=new r.a(i,(function(e){return e.loadDraftToCompose})),f=new r.a(i,(function(e){return e.openCompose})),b=new r.a(i,(function(e){return e.trySaveAndCloseCompose})),v=new r.a(i,(function(e){return e.moveComposeToTab})),m=new r.a(i,(function(e){return e.tryCreateResendDraft})),h=new r.a(i,(function(e){return e.replyToApprovalMessage})),p=new r.a(i,(function(e){return e.onEditDraftButtonClicked})),w=new r.b(i,(function(e){return e.createReply})),O=new r.b(i,(function(e){return e.getToCcRecipientsForReply})),g=new r.b(i,(function(e){return e.replyToMessageAndCreateViewState})),I=new r.b(i,(function(e){return e.createAttachments})),j=new r.b(i,(function(e){return e.extractComposePopoutData})),S=new r.b(i,(function(e){return e.didInsertLinksHaveIssuesOnBlockDialogDismiss})),_=new r.b(i,(function(e){return e.insertSignature}))},1296:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"FetchDataProviderResourceRequest:#Exchange"},e)}},1298:function(e,t,n){"use strict";var r=n(0),a=n(1894),i=n(1788),o=n(1107),c={},u=function(){function e(e,t,n){var r=this;this.estimatedTimeToCompleteInMS=e,this.updateIntervalInPercent=t,this.updatePropertyHandler=n,this.start=function(){r.currentTimePercent+=r.updateIntervalInPercent;var e=r.getActionCompletePercent();e<=r.maxPercent?(r.updatePropertyHandler(e),r.nextUpdateTimer=setTimeout(r.start,r.estimatedTimeToCompleteInMS*r.updateIntervalInPercent)):r.nextUpdateTimer=null},this.currentTimePercent=0,this.maxPercent=1-this.updateIntervalInPercent}return e.prototype.complete=function(){var e=this;this.clearUpdateTimer(),this.updatePropertyHandler(1),setTimeout((function(){return e.updatePropertyHandler(1.1)}),500)},e.prototype.abort=function(){this.clearUpdateTimer(),this.updatePropertyHandler(0)},e.prototype.clearUpdateTimer=function(){this.nextUpdateTimer&&(clearTimeout(this.nextUpdateTimer),this.nextUpdateTimer=null)},e.prototype.getActionCompletePercent=function(){return Math.sqrt(2*this.currentTimePercent-this.currentTimePercent*this.currentTimePercent)},e}();function s(e,t){var n=c[e.Id];n&&(t?n.complete():n.abort(),delete c[e.Id])}function d(e,t,n,r){var a=new u(e,t,n);c[r.Id]=a,a.start()}var l=n(2806),f=n(4);Object(f.orchestrator)(a.a,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:a=e.attachment,Object(o.a)(a,7,13),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(l.a)(null,null,e.attachment.attachmentId.Id)];case 2:return t=r.sent(),[3,4];case 3:return r.sent(),[3,4];case 4:return n=t&&"Success"===t.ResponseClass?14:15,function(e,t,n,r,a){s(e,!0),Object(i.a)(n,a),Object(o.a)(n,r,t)}(e.attachment.attachmentId,n,e.attachment,0,7),[2]}var a}))}))}));var b=n(1074),v=n(2154);function m(e){return Object(r.__assign)({__type:"ConvertLocalToRefAttachmentRequest:#Exchange"},e)}var h=n(25);function p(e,t,n,r,a){var i,o,c=function(e,t,n,r,a){return m({ewsAttachmentId:{RootItemChangeKey:t.ChangeKey,RootItemId:t.Id,Id:e},itemId:e,subscriptionId:n,channelId:r,cancellationId:a})}(e,t,n,r,a);return void 0===(i={requestObject:c}).requestObject||i.requestObject.__type||(i.requestObject=m(i.requestObject)),Object(h.a)("ConvertLocalToRefAttachment",i,o)}var w=n(254),O=n(991),g=n(1650),I=n(1062),j=n(283),S={},_=Object(j.action)("convertClassicToCloudy")((function(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,i,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return a=new w.a("AttachmentConvertClassicToCloudy"),function(e){Object(o.a)(e,5,8)}(e),i=function(t){if(y(e,t.ResultCode),C(a,e.attachmentId,t.ResultCode,t.Exception),0===t.ResultCode&&t.Response&&t.Response.ResponseMessages&&t.Response.ResponseMessages.Items&&t.Response.ResponseMessages.Items.length>0&&"NoError"===t.Response.ResponseMessages.Items[0].ResponseCode){var r=t.Response.ResponseMessages.Items[0];n(!0,r.Attachments[0])}else n(!1,null);return!0},c=function(t){y(e,1),n(!1,null),C(a,e.attachmentId,1,t)},[4,P(e.attachmentId,t,i,c)];case 1:return r.sent(),[2]}}))}))}));function P(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,o,c,u,s,d;return Object(r.__generator)(this,(function(l){switch(l.label){case 0:return[4,Object(g.a)(n)];case 1:i=r.__read.apply(void 0,[l.sent(),4]),o=i[0],c=i[1],u=i[2],s=i[3],S[e.Id]=o,l.label=2;case 2:return l.trys.push([2,4,,5]),[4,p(e.Id,t,o,s,o)];case 3:return l.sent(),[3,5];case 4:return d=l.sent(),a(d.message),I.g.importAndExecute(c,u),[3,5];case 5:return[2]}}))}))}function y(e,t){switch(t){case 0:break;case 11:Object(o.a)(e,0,0);break;default:Object(o.a)(e,0,9)}delete S[e.attachmentId.Id]}function C(e,t,n,r){var a=Object(O.a)(t);e.addCosmosOnlyData(JSON.stringify({size:a.model.Size})),e.addCustomData([n]),0===n||11===n?e.end():e.endWithError("ServerError",new Error(r))}var T={name:"CancelConvertClassicToCloudy"},x={name:"CancelConvertCloudyToClassic"};function A(e){return Object(r.__assign)({__type:"CancelConvertLocalToRefAttachmentRequest:#Exchange"},e)}function R(e){var t,n,r=function(e){return A({cancellationId:e})}(e);return void 0===(t=r)||t.__type||(t=A(t)),Object(h.a)("CancelConvertLocalToRefAttachment",t,n)}var E=n(123),D=Object(E.d)("cancelConvertClassicToCloudy",T)((function(e){var t,n=(t=e.attachmentId.Id,S[t]);if(!n)throw new Error("Failed to find the cancellationId of ConvertClassicToCloudy");Object(o.a)(e,5,10),R(n)})),k=n(1477),N=Object(j.action)("setActionCompletePercent")((function(e,t){e.actionCompletePercent=t})),M=n(2152),U=n(1789),L=(n(1751),n(1405)),W=n(1839),F=n(1069),V=n(2059),B=n(2496),G=n(2794),H=n(1240),z=Object(j.action)("updateAttachment")((function(e,t,n,a,i){Object(B.a)(e.attachmentId);var c=Object(r.__assign)(Object(r.__assign)({},a.AttachmentId),{mailboxInfo:t.mailboxInfo});if(n.AttachmentId=c,a.Name&&(n.Name=a.Name),a.Size&&(n.Size=a.Size),a.ContentType&&(n.ContentType=a.ContentType),a.__type&&(n.__type=a.__type),n.IsInline&&(n.ContentId=a.ContentId),Object(H.b)(a)){var u=n;u.AttachLongPathName=a.AttachLongPathName,u.PermissionType=a.PermissionType,u.ProviderType=a.ProviderType,u.AttachmentThumbnailUrl=a.AttachmentThumbnailUrl,u.AttachmentPreviewUrl=a.AttachmentPreviewUrl}if(Object(V.a)([{attachmentId:c,attachment:n,permissionInfo:i}],!1),e.attachmentId=c,Object(W.a)(e))Object(U.a)(e,1);else{Object(F.g)(e,!1),setTimeout((function(){N(e,1.1)}),500),Object(o.a)(e,0,0);var s=Object(O.a)(c);Object(L.a)(e,s,!1,e.strategy.supportedMenuActions),s.download.url||Object(G.a)(c,e.isReadOnly,!0)}}));function q(e){return Object(r.__assign)({__type:"ConvertRefToLocalAttachmentRequest:#Exchange"},e)}function J(e,t,n,r,a,i,o,c){var u,s,d=function(e,t,n,r,a,i,o,c){return q({ewsAttachmentId:e,emailId:t,subscriptionId:n,channelId:r,cancellationId:a,fullPathLocation:i,attachmentDataProviderId:c,PermissionLevel:o})}(e,t,n,r,a,i,o,c);return void 0===(u={requestObject:d}).requestObject||u.requestObject.__type||(u.requestObject=q(u.requestObject)),Object(h.a)("ConvertRefToLocalAttachment",u,s)}function $(e){return Z(Object(O.a)(e).model.Size)}function K(e){return 2856+.00145*e}function Y(e){return 4*Z(e)}function X(e){return 4*Z(e)}function Q(e){return 2*Z(e)}function Z(e){return Math.round(e/256)}var ee=n(2541),te={},ne=Object(f.action)("convertCloudyToClassic",(function(e,t,n,r,a,i){return{attachment:e,parentItemId:t,fullPathLocation:n,permissionLevel:r,replaceAttachmentHandler:a,source:i}})),re=ne;function ae(e,t,n,a,i,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var c,u,s,d,l,f;return Object(r.__generator)(this,(function(b){switch(b.label){case 0:return[4,Object(g.a)(i)];case 1:c=r.__read.apply(void 0,[b.sent(),4]),u=c[0],s=c[1],d=c[2],l=c[3],te[e.Id]=u,b.label=2;case 2:return b.trys.push([2,4,,5]),[4,J(e.Id,t,u,l,u,n,a)];case 3:return b.sent(),[3,5];case 4:return f=b.sent(),o(f.message),I.g.importAndExecute(s,d),[3,5];case 5:return[2]}}))}))}function ie(e,t){switch(t){case 0:break;case 11:Object(o.a)(e,0,0);break;default:Object(o.a)(e,0,12)}delete te[e.attachmentId.Id]}function oe(e,t,n,r,a){var i,o=Object(O.a)(t);e.addCosmosOnlyData(JSON.stringify({size:o.model.Size,attachmentId:null===(i=o.model.AttachmentId)||void 0===i?void 0:i.Id})),e.addCustomData([n,a]),0===n||11===n?e.end():e.endWithError("ServerError",new Error(r))}function ce(e){return Object(r.__assign)({__type:"CancelConvertRefToLocalAttachmentRequest:#Exchange"},e)}function ue(e){var t,n,r=function(e){return ce({cancellationId:e})}(e);return void 0===(t=r)||t.__type||(t=ce(t)),Object(h.a)("CancelConvertRefToLocalAttachment",t,n)}Object(f.orchestrator)(ne,(function(e){var t=e.attachment;!function(e,t,n,a,i,c){Object(r.__awaiter)(this,void 0,void 0,(function(){var u,s,d;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return u=new w.a("AttachmentConvertCloudyToClassic"),function(e){Object(o.a)(e,6,11)}(e),s=function(t){if(ie(e,t.ResultCode),oe(u,e.attachmentId,t.ResultCode,t.Exception,c),0===t.ResultCode){var n=Object(ee.a)({Name:t.Item.Name,Size:t.Item.Size,AttachmentId:t.NewAttachmentId});i(!0,n)}else i(!1,null);return!0},d=function(t){ie(e,1),i(!1,null),oe(u,e.attachmentId,1,t,c)},[4,ae(e.attachmentId,t,n,a,s,d)];case 1:return r.sent(),[2]}}))}))}(t,e.parentItemId,e.fullPathLocation,e.permissionLevel,(function(n,r){n?e.replaceAttachmentHandler(t,r,!1,!0):s(t.attachmentId,n)}),e.source),d($(t.attachmentId),.1,(function(e){N(t,e)}),t.attachmentId)}));var se=Object(f.action)("cancel_ConvertCloudyToClassic",(function(e){return Object(E.c)(x,{attachmentViewState:e})})),de=se;Object(f.orchestrator)(se,(function(e){var t,n=(t=e.attachmentViewState.attachmentId.Id,te[t]);if(!n)throw new Error("Failed to find the cancellationId of ConvertCloudyToClassic");Object(o.a)(e.attachmentViewState,6,10),ue(n)}));var le=n(1036),fe=n(1115),be=n(2030),ve=n(1448);function me(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,ve.h.import()];case 1:return n.sent()(e.model.AttachLongPathName,be.a.OneDrivePro).then((function(n){return Object(r.__awaiter)(t,void 0,void 0,(function(){var t,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n&&0===n.ResultCode?[2]:(t=Object(fe.b)(e.model,!0),[4,le.h.importAndExecute(t,e.attachmentClass,e.model,!0,e.model.ProviderType,n)]);case 1:return a=r.sent(),le.m.importAndExecute(e.id,a),Object(le.p)(e.id),[2]}}))}))})),[2]}}))}))}var he=n(76),pe=n(966);function we(e,t,n){if(e&&t===le.a.providers.ONE_DRIVE_PRO&&(Object(he.h)("doc-SxS-jsApi-ODB-Base")||Object(he.h)("doc-SxS-jsApi-ODB-BaseNoEditString")||Object(he.h)("doc-SxS-jsApi-ODB-Readonly"))){var r=n&&n.substring(n.lastIndexOf("."));switch(Object(pe.f)(r)){case pe.a.Word:return Object(he.h)("doc-SxS-jsApi-ODB-Word");case pe.a.Excel:return Object(he.h)("doc-SxS-jsApi-ODB-Excel");case pe.a.PowerPoint:return!Object(he.h)("doc-SxS-jsApi-ODB-Readonly")&&Object(he.h)("doc-SxS-jsApi-ODB-PowerPoint")}}return!1}var Oe=n(1840),ge=n(1077);function Ie(e,t,n,r,a){return void 0===n&&(n=!1),void 0===r&&(r=0),void 0===a&&(a=!1),{attachmentType:1,attachmentId:e,isInline:!0,isHiddenInline:n,placeholderId:t,status:r,fileType:ge.a.Inline,skipProcessInlineImage:a}}function je(e){return!!e.strategy.isSaveToCloudSupported&&-1===e.completedActions.indexOf(2)}var Se=n(1787);n(1927);n.d(t,"a",(function(){return b.a})),n.d(t,"h",(function(){return v.a})),n.d(t,"c",(function(){return D})),n.d(t,"e",(function(){return _})),n.d(t,"u",(function(){return k.a})),n.d(t,"w",(function(){return k.c})),n.d(t,"v",(function(){return k.b})),n.d(t,"D",(function(){return k.d})),n.d(t,"x",(function(){return N})),n.d(t,"y",(function(){return M.a})),n.d(t,"z",(function(){return U.a})),n.d(t,"A",(function(){return o.a})),n.d(t,"E",(function(){return z})),n.d(t,"r",(function(){return L.a})),n.d(t,"o",(function(){return L.b})),n.d(t,"d",(function(){return de})),n.d(t,"f",(function(){return re})),n.d(t,"m",(function(){return me})),n.d(t,"b",(function(){return we})),n.d(t,"B",(function(){return d})),n.d(t,"C",(function(){return s})),n.d(t,"k",(function(){return K})),n.d(t,"l",(function(){return X})),n.d(t,"q",(function(){return Y})),n.d(t,"j",(function(){return Q})),n.d(t,"g",(function(){return Oe.a})),n.d(t,"i",(function(){return Ie})),n.d(t,"p",(function(){return $})),n.d(t,"t",(function(){return je})),n.d(t,"s",(function(){return W.a})),n.d(t,"n",(function(){return Se.a}))},1336:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(0),a=n(254),i=n(1257),o=n(279),c=n(1296),u=n(1605),s=n(79),d=n(1018);function l(e,t,n,o,c){return Object(r.__awaiter)(this,void 0,void 0,(function(){var u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Object(i.d)(e,!1,n)];case 1:return u=r.sent(),[3,3];case 2:return r.sent(),[3,3];case 3:return u&&u.split(i.a)[1]?(Object(a.o)("fetchServiceViaDataProvider",[e]),s.g.info("fetchServiceViaDataProvider"),[4,f(t,u,o,c)]):[3,5];case 4:return[2,r.sent()];case 5:Object(a.o)("fetchServiceFailedToGetToken",[e]),r.label=6;case 6:return 0!==e?[3,8]:(Object(a.o)("fetchServiceViaOWAServer"),s.g.info("fetchServiceViaOWAServer"),[4,b(e,t,o,c)]);case 7:return[2,r.sent()];case 8:throw new Error("Fetch service has failed to retrieve client token.")}}))}))}function f(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var c,u,s;return Object(r.__generator)(this,(function(r){return c=n.datapointNamePrefix+"DataProvider",u=new a.a(c),s={Authorization:t,"Content-Type":"application/json",Accept:"application/json"},i&&Object.keys(i).forEach((function(e){s[e]=i[e]})),[2,fetch(e,{method:n.method,mode:n.mode,headers:s,body:n.body}).then((function(e){if(Object(o.a)(e.status))return u.end(),e.json();var t=new Error(c+" : Response status = "+e.status+", body = "+e.body);u.endWithError("ServerError",t);var n={datapointName:c,responseStatus:e.status,responseBody:e.body};throw JSON.stringify(n)})).then((function(e){return JSON.stringify(e)}))]}))}))}function b(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var s,l,f,b,v,m;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return s=n.datapointNamePrefix+"OWA",l=new a.a(s),f=Object(c.a)({ProviderType:e,Url:t,Method:n.method,Body:n.body?n.body:JSON.stringify({}),Headers:JSON.stringify(i),IsJsonPost:n.method===d.d}),[4,Object(u.a)(f)];case 1:if(b=r.sent(),Object(o.a)(b.Status))return l.end(),[2,b.Body];throw v=new Error(s+" : Response status = "+b.Status+", ServerTraceLog = "+b.ServerTraceLog),l.endWithError("ServerError",v),m={datapointName:s,responseStatus:b.Status,responseServerTraceLog:b.ServerTraceLog},JSON.stringify(m)}}))}))}},1337:function(e,t,n){"use strict";var r=n(240),a=n(0),i={};function o(e){return i[e]}function c(e,t){var n=i[e];i[e]=Object(a.__assign)(Object(a.__assign)({},n),t)}var u=n(103),s=n(25);var d=n(254),l=n(79),f=n(515),b=n(419),v=n(352);function m(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(a.__generator)(this,(function(r){switch(r.label){case 0:return(t={}).headers=new Headers,[4,Object(b.a)(e)];case 1:return n=r.sent(),Object(v.b)(t.headers,n),[2,t]}}))}))}var h=Object(f.b)({timeBetweenRetryInMS:function(){return 3e4}});function p(e,t){t=t<1?1:t,setInterval((function(){!function(e){Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n,i,u,f,b,v=this;return Object(a.__generator)(this,(function(p){switch(p.label){case 0:if(t=function(){return Object(a.__awaiter)(v,void 0,void 0,(function(){var t,n;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),t={},Object(r.n)(e.userIdentity)?[4,m(e.userIdentity)]:[3,2];case 1:t=a.sent(),a.label=2;case 2:return[2,(i=t,Object(s.a)("GetAttachmentDownloadToken",{},i))];case 3:throw n=a.sent(),l.g.warn("Unable to get the download token "+n),n.networkError=!0,n;case 4:return[2]}var i}))}))},null==(n=o(e.userIdentity))?void 0:n.isRefreshingDownloadToken)return[3,4];c(e.userIdentity,{isRefreshingDownloadToken:!0}),i=0,u=h((function(){return Object(a.__awaiter)(v,void 0,void 0,(function(){var n;return Object(a.__generator)(this,(function(r){switch(r.label){case 0:return i++,[4,t()];case 1:return n=r.sent(),l.g.info("update new token"),c(e.userIdentity,{downloadToken:n,isRefreshingDownloadToken:!1}),[2]}}))}))})).retriableFunc,f=new d.b("AttachmentRefreshDownloadToken"),p.label=1;case 1:return p.trys.push([1,3,,4]),[4,u()];case 2:return p.sent(),f.addCustomData([i]),f.end(),[3,4];case 3:return b=p.sent(),l.g.warn("Retry to refresh token failed: "+b),f.addCustomData([i]),f.endWithError("ServerError",b),c(e.userIdentity,{isRefreshingDownloadToken:!1}),[3,4];case 4:return[2]}}))}))}(e)}),6e4*t)}var w=n(314);function O(e){var t=Object(r.e)(null==e?void 0:e.userIdentity),n=o(null==e?void 0:e.userIdentity);if((null==n?void 0:n.downloadToken)&&(null==n?void 0:n.downloadUrlBase))return n;switch(t){case null:case"Outlook":!function(e){var t=Object(r.n)(e.userIdentity)?Object(u.j)(e.userIdentity):Object(u.i)(),n=null==t?void 0:t.ApplicationSettings;if(n){var a=n.DownloadUrlBase;c(e.userIdentity,{downloadUrlBase:a,downloadToken:n.FirstDownloadToken}),a&&p(e,n.DownloadTokenRefreshMinutes)}}(e);break;case"Google":case"ICloud":break;default:Object(w.a)(t)}var a=o(e.userIdentity);return a||(Object(d.o)("FilesUrlDataNotFound",{accountProviderType:t}),l.g.warn("Unable to get the url data")),a}function g(e){if(!e)return null;var t=O(e);return null==t?void 0:t.downloadToken}n.d(t,"b",(function(){return O})),n.d(t,"a",(function(){return g}))},13584:function(e){e.exports=JSON.parse('{"a":"Jtb"}')},1360:function(e,t){e.exports=function(e){return e instanceof Date}},1389:function(e,t,n){"use strict";var r;function a(){return[r.noPermissionToShare,r.getSharingInfoFailed,r.linkHasExpired,r.linkWillExpire,r.noPermissionToShareExternally,r.externalRecipientCSL,r.noPermissionSet,r.sharingWithLargeDL]}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),function(e){e.noPermissionToShare="WarningNoPermissionToShare",e.getSharingInfoFailed="WarningGetSharingInfoFailed",e.linkHasExpired="WarningLinksHasExpired",e.linkWillExpire="WarningLinksWillExpire",e.noPermissionToShareExternally="WarningExternalRecipientButNoPermissionToShareExternally",e.externalRecipientCSL="WarningExternalRecipientsCannotOpenCSLs",e.noPermissionSet="WarningOnlyPeopleWithExistingAccessCanAccess",e.sharingWithLargeDL="WarningNotAllMembersOfDLCanAccess"}(r||(r={}))},1394:function(e,t,n){"use strict";function r(e){var t=null;return(t=e.AttachLongPathName)||(t=e.WebUrl),t}n.d(t,"a",(function(){return r}))},1395:function(e,t,n){"use strict";n.d(t,"u",(function(){return d})),n.d(t,"g",(function(){return l})),n.d(t,"i",(function(){return f})),n.d(t,"j",(function(){return b})),n.d(t,"k",(function(){return v})),n.d(t,"l",(function(){return m})),n.d(t,"m",(function(){return h})),n.d(t,"n",(function(){return p})),n.d(t,"o",(function(){return w})),n.d(t,"p",(function(){return O})),n.d(t,"q",(function(){return g})),n.d(t,"r",(function(){return I})),n.d(t,"s",(function(){return j})),n.d(t,"t",(function(){return S})),n.d(t,"v",(function(){return _})),n.d(t,"h",(function(){return P}));var r=n(108),a=n(2433);n.d(t,"a",(function(){return a.a}));var i=n(1272);n.d(t,"b",(function(){return i.a})),n.d(t,"e",(function(){return i.d}));var o=n(1700);n.d(t,"f",(function(){return o.a}));var c=n(1721);n.d(t,"d",(function(){return c.a}));var u=n(2434);n.d(t,"c",(function(){return u.a}));var s=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(559)]).then(n.bind(null,4751))})),d=new r.b(s,(function(e){return e})),l=new r.b(s,(function(e){return e.resetPreviewPane})),f=(new r.b(s,(function(e){return e.setAudioPreviewState})),new r.b(s,(function(e){return e.setBlankPreviewState})),new r.b(s,(function(e){return e.setCustomPreviewState})),new r.b(s,(function(e){return e.setIframePreviewState}))),b=(new r.b(s,(function(e){return e.setImageGalleryItems})),new r.b(s,(function(e){return e.setImagePreviewLoaded}))),v=new r.b(s,(function(e){return e.setImagePreviewState})),m=new r.b(s,(function(e){return e.setImagePreviewStateFromImageGalleryItem})),h=(new r.b(s,(function(e){return e.setNativePdfPreviewState})),new r.b(s,(function(e){return e.setPanesSize}))),p=(new r.b(s,(function(e){return e.setPdfJsPreviewState})),new r.b(s,(function(e){return e.setPdfJsPreviewStateByData})),new r.b(s,(function(e){return e.setPreviewError}))),w=new r.b(s,(function(e){return e.setPreviewLoading})),O=new r.b(s,(function(e){return e.setRightPaneDisplayAndUpdateSize})),g=new r.b(s,(function(e){return e.setSaveStatusText})),I=new r.b(s,(function(e){return e.setTextPreviewState})),j=(new r.b(s,(function(e){return e.setVideoPreviewState})),new r.b(s,(function(e){return e.setWacPreviewState}))),S=new r.b(s,(function(e){return e.setWacReadOnly})),_=new r.b(s,(function(e){return e.updatePanesSize})),P=new r.b(s,(function(e){return e.saveHideReadingPaneOption}))},1425:function(e,t,n){"use strict";n.d(t,"g",(function(){return r})),n.d(t,"e",(function(){return a})),n.d(t,"m",(function(){return i})),n.d(t,"l",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"o",(function(){return u})),n.d(t,"f",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"i",(function(){return l})),n.d(t,"j",(function(){return f})),n.d(t,"a",(function(){return b})),n.d(t,"d",(function(){return v})),n.d(t,"n",(function(){return m})),n.d(t,"k",(function(){return h})),n.d(t,"p",(function(){return p})),n.d(t,"h",(function(){return w}));var r=100,a=1,i="PublicDL",o="PrivateDL",c="GroupMailbox",u="RecommendedGroup",s="InternalMailbox",d="ExternalMailbox",l="Mailbox",f="OneOff",b="Contact",v="ImplicitContact",m="PublicFolder",h="Other",p="Room",w="LinkedIn"},1448:function(e,t,n){"use strict";n.d(t,"h",(function(){return s})),n.d(t,"i",(function(){return d})),n.d(t,"f",(function(){return l})),n.d(t,"k",(function(){return f})),n.d(t,"m",(function(){return b})),n.d(t,"e",(function(){return v})),n.d(t,"g",(function(){return m})),n.d(t,"j",(function(){return h})),n.d(t,"l",(function(){return p}));var r=n(108),a=n(1747);n.d(t,"n",(function(){return a.a}));var i=n(1705);n.d(t,"a",(function(){return i.a}));n(1425);var o=n(1389);n.d(t,"d",(function(){return o.b})),n.d(t,"c",(function(){return o.a}));var c=n(1748);n.d(t,"b",(function(){return c.a}));var u=new r.c((function(){return Promise.all([n.e(4),n.e(17),n.e(44),n.e(541)]).then(n.bind(null,3463))})),s=new r.b(u,(function(e){return e.getSharingInformation})),d=new r.b(u,(function(e){return e.getSharingIssuesForSharingData})),l=new r.b(u,(function(e){return e.getInfoBarCreator})),f=new r.b(u,(function(e){return e.hasLargeDLRecipient})),b=new r.b(u,(function(e){return e.hasRecipientExpansionFailure})),v=new r.b(u,(function(e){return e.getGroupsAndSmallDLs})),m=new r.b(u,(function(e){return e.getInvididualRecipients})),h=new r.b(u,(function(e){return e.hasGetRecipientPermissionFailed})),p=new r.b(u,(function(e){return e.logSharingTipChangesForLinkRemoval}))},1516:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(0),a=n(1085),i=n(1005),o=n(1130),c=n(314);function u(e,t,n){var u,f;void 0===t&&(t=0);var b=function(e){switch(e){case 0:return s;case 1:return d;case 2:return l;default:return Object(c.a)(e)}}(t),v=Object(o.b)();try{for(var m=Object(r.__values)(Object(i.a)().tabs),h=m.next();!h.done;h=m.next()){var p=h.value;if(p.type==a.a.Compose&&0==p.state){var w=v.viewStates.get(p.data);if((null==w?void 0:w.isInlineCompose)&&b(w,e)&&(0==w.asyncSendState||n&&6==w.asyncSendState))return w}}}catch(e){u={error:e}}finally{try{h&&!h.done&&(f=m.return)&&f.call(m)}finally{if(u)throw u.error}}return null}function s(e,t){return e.conversationId===t}function d(e,t){return e.referenceItemId.Id===t}function l(e,t){return!1}},1534:function(e,t,n){"use strict";var r=n(314),a=n(9),i=n(35),o="/owa/",c="service.svc/s/GetFileAttachment?id={0}",u="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",s="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",d="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",l="service.svc/s/GetAttachmentThumbnail?id={0}",f="pdfprint.aspx?id={0}",b="pdfprint.aspx?id={0}&location={1}",v=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var m=n(295),h=n(49),p=n(2),w=n(20),O=n(1337),g=n(114),I=n(240);function j(e,t,n,c,s,l,f,m,h){var p;switch(void 0===s&&(s=0),void 0===l&&(l=0),void 0===f&&(f=!0),void 0===m&&(m=null),void 0===h&&(h=null),n){case 0:p=u;break;case 3:p=b;break;case 1:if(!function(e){if(!e)return!1;var t=null,n=e.lastIndexOf(".");return n>0&&(t=e.substr(n).toLowerCase()),!!t&&v.indexOf(t.toLowerCase())>=0}(m))return null;p=d;break;default:Object(r.a)(n)}var O=c?l:s;!O&&s&&(O=s);var g=Object(a.c)("{0}{1}{2}&permissionLevel={3}",o,h,Object(a.c)(p,encodeURIComponent(e.Id),encodeURIComponent(t)),O);f&&(g=g+"&X-OWA-CANARY="+Object(i.a)());return Object(w.a)(g)}function S(e,t,n,u,d){var b;switch(void 0===u&&(u=!1),void 0===d&&(d=!0),n){case 0:b=c;break;case 1:b=s;break;case 2:b=l;break;case 3:b=f;break;default:return Object(r.a)(n)}if(!Object(a.f)(b)){var v=function(e,t,n,r,c){if(void 0===c&&(c=!1),!t||!t.Id||!t.mailboxInfo)return null;var u=t.mailboxInfo.userIdentity,s=u&&Object(I.n)(u),d=t.mailboxInfo.type===g.a.GroupMailbox,l=s&&!d?Object(g.c)(t.mailboxInfo.mailboxSmtpAddress)+u:e,f=Object(O.b)(t.mailboxInfo),b=null==f?void 0:f.downloadUrlBase,v=Object(a.c)(n,encodeURIComponent(t.Id));if(!b||c&&"Firefox"===Object(h.a)().browser){var j=o+v+"&X-OWA-CANARY="+Object(i.a)();return Object(w.a)(j)}var S="{0}{1}/{2}&owa={3}&scriptVer={4}";Object(m.a)()&&(S+="&isc=1");var _=Object(a.c)(S,b,l,v,window.location.hostname,Object(p.j)()||"unofficial");return r&&(_+="&X-OWA-CANARY="+Object(i.a)(),_+="&token="+(null==f?void 0:f.downloadToken)),_}(e,t,b,d,3===n);return Object(a.c)("{0}{1}{2}",v,u?"&isDownload=true":"","&animation=true")}return null}n.d(t,"b",(function(){return j})),n.d(t,"a",(function(){return S}))},1561:function(e,t,n){"use strict";var r=n(1534);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b}));var a=n(1337);n.d(t,"c",(function(){return a.a}))},1605:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(25),a=n(1296);function i(e,t){return void 0===e||e.__type||(e=Object(a.a)(e)),Object(r.a)("FetchDataProviderResource",e,t)}},1623:function(e,t,n){"use strict";var r=n(314),a=n(114),i=n(1561),o=n(35),c=n(1394);function u(e,t,n,o,u){var s;void 0===u&&(u=!0);var d=t,l=d.AttachmentId,f=d.Name,b=d.OriginalPermissionType,v=d.PermissionType,m=Object(c.a)(t),h=(null===(s=null==e?void 0:e.mailboxInfo)||void 0===s?void 0:s.type)===a.a.GroupMailbox?e.mailboxInfo.mailboxSmtpAddress+"/":null;switch(n){case 0:case 3:return i.b(l,m,n,o,v,b,u,f,h);case 1:return t.AttachmentPreviewUrl?t.AttachmentPreviewUrl:i.b(l,m,1,o,v,b,u,f,h);case 2:return t.AttachmentThumbnailUrl;default:return Object(r.a)(n)}}function s(e,t,n,r){var a;return void 0===n&&(n=!1),void 0===r&&(r=!0),i.a(null===(a=e.mailboxInfo)||void 0===a?void 0:a.routingKey,e,t,n,r)}function d(e,t,n,r,a){void 0===a&&(a=!1);var c=n?u(e,t,1,r,!1):s(e,1,a,!1);if(n)return{url:c,init:{credentials:"include"}};var d=Object(i.c)(e.mailboxInfo),l=new Headers;return l.set("X-Token",d),l.set("X-OWA-CANARY",Object(o.a)()),{url:c,init:{headers:l}}}function l(e,t,n,r,a,i){return void 0===i&&(i=!1),r?u(e,t,n,a):s(e,n,i)}n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return d}))},1646:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(25);function a(e,t){return Object(r.a)("GetWacAttachmentInfo",e,t)}},1655:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(1130),a=n(1085),i=n(1516),o=n(79);function c(e,t,n){var c,u=Object(r.b)();if(e){switch(e.type){case a.a.SecondaryReadingPane:e.data.listViewType==n&&(c=Object(i.a)(t,n));break;case a.a.Compose:c=u.viewStates.get(e.data);break;case a.a.Primary:c=t?Object(i.a)(t,n,!0):null;break;default:c=null}return c}return o.d("There is no active tab. Something went very wrong."),null}},1685:function(e,t,n){"use strict";var r=n(108),a=n(2519),i=n(1889),o=n(1694),c=n(1911),u=n(2136),s=n(2137),d=n(2268),l=n(2303),f=n(2410),b=n(1088),v=n(76),m=n(965);function h(e,t){return!!e&&(1!==t&&!!m.a.conversations.get(e))}function p(e,t){return 2!=t&&(Object(v.h)("rp-persistedReadingPaneTabs")?b.a.loadedItemReadingPaneViewStates.has(e):b.a.itemReadingPaneViewState&&b.a.itemReadingPaneViewState.itemId==e)}var w=n(1995),O=n(1996),g=n(1858),I=n(1193);n.d(t,"k",(function(){return S})),n.d(t,"o",(function(){return _})),n.d(t,"l",(function(){return P})),n.d(t,"p",(function(){return y})),n.d(t,"r",(function(){return C})),n.d(t,"m",(function(){return T})),n.d(t,"n",(function(){return x})),n.d(t,"h",(function(){return A})),n.d(t,"i",(function(){return R})),n.d(t,"j",(function(){return E})),n.d(t,"g",(function(){return D})),n.d(t,"q",(function(){return k})),n.d(t,"d",(function(){return h})),n.d(t,"e",(function(){return p})),n.d(t,"f",(function(){return w.a})),n.d(t,"a",(function(){return O.a})),n.d(t,"s",(function(){return b.a})),n.d(t,"c",(function(){return g.a})),n.d(t,"b",(function(){return I.a}));var j=new r.c((function(){return Promise.all([n.e(7),n.e(10),n.e(19),n.e(18),n.e(498)]).then(n.bind(null,14995))})),S=new r.a(j,(function(e){return e.loadConversationReadingPane})),_=(new r.a(j,(function(e){return e.reloadReadingPane})),new r.a(j,(function(e){return e.moveReadingPaneToTab}))),P=new r.a(j,(function(e){return e.loadConversationReadingPaneForSingleMailItemSelected})),y=new r.a(j,(function(e){return e.print})),C=new r.a(j,(function(e){return e.setItemIdToScrollTo})),T=new r.a(j,(function(e){return e.loadItemReadingPane})),x=new r.a(j,(function(e){return e.loadItemReadingPaneForSingleMailItemSelected})),A=new r.a(j,(function(e){return e.expandCollapseAllItemParts}));Object(r.f)(o.a,j,(function(e){return e.deleteItemsStoreUpdateOrchestrator})),Object(r.f)(u.a,j,(function(e){return e.markConversationsAsReadStoreUpdateOrchestrator})),Object(r.f)(s.a,j,(function(e){return e.markItemsAsReadStoreUpdateOrchestrator})),Object(r.f)(c.a,j,(function(e){return e.markAllAsReadOrchestrator})),Object(r.f)(a.a,j,(function(e){return e.applyConversationFlagStateStoreUpdateOrchestrator})),Object(r.f)(i.a,j,(function(e){return e.deleteConversationStoreUpdateOrchestrator})),Object(r.f)(f.a,j,(function(e){return e.conversationReadyToLoadOrchestrator})),Object(r.f)(f.b,j,(function(e){return e.updateItemMandatoryPropertiesOrchestrator})),Object(r.f)(d.a,j,(function(e){return e.updateInternetMessageIdOrchestrator})),Object(r.f)(l.a,j,(function(e){return e.initializeExtendedCardForItemReadingPaneOrchestrator}));var R=new r.b(j,(function(e){return e.getLastestNonDraftItemId})),E=new r.b(j,(function(e){return e.isUnsupportedItem})),D=new r.a(j,(function(e){return e.clearReadingPaneStore})),k=new r.a(j,(function(e){return e.replyByMeeting}))},1693:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("conversationSendStateChanged",(function(e,t){return{viewState:e,isSendPending:t}}))},1694:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("DELETE_ITEMS_STORE_UPDATE",(function(e,t,n){return{itemContexts:e,parentFolderId:t,actionType:n}}))},1705:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.InProgress=0]="InProgress",e[e.Failed=1]="Failed",e[e.Succeeded=2]="Succeeded"}(r||(r={}))},1708:function(e,t,n){var r=n(1246);e.exports=function(e,t){var n=r(e).getTime(),a=Number(t);return new Date(n+a)}},1747:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),a=Object(r.action)("REFRESH_EXPIRATION_DATE",(function(e){return{id:e}}))},1748:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.ignore=0]="ignore",e[e.refreshExpiration=1]="refreshExpiration",e[e.changePermission=2]="changePermission",e[e.attachAsACopy=3]="attachAsACopy"}(r||(r={}))},1750:function(e,t,n){var r=n(1708),a=6e4;e.exports=function(e,t){var n=Number(t);return r(e,n*a)}},1778:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("saveSigningCertificate",(function(e,t){return{smimeViewState:e,signingCertRawData:t}}))},1789:function(e,t,n){"use strict";var r=n(283);t.a=Object(r.action)("setInlineAttachmentStatus")((function(e,t){e.status=t}))},1833:function(e,t,n){"use strict";n.d(t,"m",(function(){return i})),n.d(t,"l",(function(){return o})),n.d(t,"o",(function(){return c})),n.d(t,"q",(function(){return u})),n.d(t,"p",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"e",(function(){return l})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return b})),n.d(t,"k",(function(){return v})),n.d(t,"n",(function(){return m})),n.d(t,"r",(function(){return h})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return w})),n.d(t,"j",(function(){return O})),n.d(t,"f",(function(){return g})),n.d(t,"i",(function(){return I})),n.d(t,"a",(function(){return j}));var r=n(108),a=(n(1778),new r.c((function(){return Promise.all([n.e(12),n.e(748),n.e(4),n.e(17),n.e(673)]).then(n.bind(null,3541))}))),i=new r.a(a,(function(e){return e.onSmimeItemAttachmentOpened})),o=new r.a(a,(function(e){return e.mergeSmimeDecodedMessageProperties})),c=(new r.b(a,(function(e){return e.fetchAndDecodeSmimeMessage})),new r.b(a,(function(e){return e.setSmimePropertiesInDraftMessage}))),u=new r.b(a,(function(e){return e.trySetSmimeProperties})),s=new r.b(a,(function(e){return e.tryAddSmimeProperties})),d=new r.b(a,(function(e){return e.createMailResponseBodyContent})),l=new r.b(a,(function(e){return e.downloadSmimeAttachment})),f=new r.b(a,(function(e){return e.getMergedSmimeViewState})),b=new r.b(a,(function(e){return e.getMergedSmimeViewStateForDraft})),v=new r.b(a,(function(e){return e.isSmimeItemDecoding})),m=new r.b(a,(function(e){return e.previewSmimeAttachment})),h=new r.b(a,(function(e){return e.updateSmimeAttachmentIds})),p=new r.b(a,(function(e){return e.createSmimeAttachmentsFromFiles})),w=new r.b(a,(function(e){return e.createSmimeAttachmentsViaSmimeQueueManager})),O=new r.b(a,(function(e){return e.initializeAttachmentStateForSmimeAttachments})),g=new r.b(a,(function(e){return e.getAttachmentsForSmimeResponse})),I=new r.b(a,(function(e){return e.getSmimeAttachmentsForRequest})),j=Object(r.d)(a,(function(e){return e.SignatureDetails}))},1839:function(e,t,n){"use strict";function r(e){return 1===e.attachmentType}n.d(t,"a",(function(){return r}))},1840:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),a=n(1069),i=n(1077);function o(e,t,n,o,c,u,s){void 0===c&&(c=i.a.Unknown),void 0===u&&(u=!1),void 0===s&&(s=null);var d=Object(a.c)(e,t,o,u,c,s),l=d.strategy;return Object(r.__assign)(Object(r.__assign)({},d),{attachmentType:0,strategy:Object(r.__assign)(Object(r.__assign)({},l),{isSaveToCloudSupported:!1,isViewingInProviderSupported:!1,isOpeningInProviderSupported:!1,isOpeningByLinkSupported:!1,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!1,supportedMenuActions:[]}),shouldShowContextMenu:!1,shouldShowImageOverlay:!1,shouldShowActionsContainer:!1,ongoingAction:n?0:1,completedActions:[],actionMessage:0,actionCompletePercent:n?1.1:.01})}},1858:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1088),a=n(76),i=n(2021);function o(e){return Object(a.h)("rp-persistedReadingPaneTabs")?Object(r.b)().loadedItemReadingPaneViewStates.get(e||(Object(r.b)().sxsId?Object(r.b)().sxsId:Object(i.a)())):Object(r.b)().itemReadingPaneViewState}},1889:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("DELETE_CONVERSATION_STORE_UPDATE",(function(e,t,n){return{conversationIds:e,tableView:t,actionType:n}}))},1894:function(e,t,n){"use strict";var r=n(4),a=n(123),i=Object(r.action)("addCalendarEventsAttachment",(function(e,t){return Object(a.c)({name:"AttachmentAddCalendarEvent",customData:{addToCalendarSource:t}},{attachment:e})}));t.a=i},1911:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("MARK_ALL_AS_READ_STORE_UPDATE",(function(e,t,n){return{tableView:e,markAsRead:t,rowIdsToExclude:n}}))},1981:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.OneDrivePro=0]="OneDrivePro",e[e.OneDriveConsumer=1]="OneDriveConsumer",e[e.Dropbox=2]="Dropbox",e[e.Box=3]="Box",e[e.GDrive=5]="GDrive",e[e.OfficeOneDrivePro=31]="OfficeOneDrivePro"}(r||(r={}))},1995:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(76);function a(){return Object(r.h)("rp-linkedInViewProfile")||Object(r.h)("rp-linkedInViewProfileV1_1")}},1996:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="displaylinkedindataprebind"},2021:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1085),a=n(2104);function i(){var e=Object(r.c)();switch(e.type){case r.a.SecondaryReadingPane:return e.data.id.Id;case r.a.Primary:default:return Object(a.a)()}}},2030:function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return l}));var r=n(108),a=n(1981);n.d(t,"a",(function(){return a.a}));var i=new r.c((function(){return Promise.all([n.e(44),n.e(270)]).then(n.bind(null,4004))})),o=new r.b(i,(function(e){return e.createGetSharingInfoResponse})),c=new r.b(i,(function(e){return e.checkSharingLinkUrlDomain})),u=new r.b(i,(function(e){return e.getLinkProviderType})),s=new r.b(i,(function(e){return e.isOneDriveProRelatedLink})),d=new r.b(i,(function(e){return e.convertToAttachmentDataProviderType})),l=new r.b(i,(function(e){return e.convertToLinkProviderType}))},2104:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1088),a=n(556);function i(){var e,t;return Object(a.v)()?null===(e=Object(r.b)().deeplinkId)||void 0===e?void 0:e.id:null===(t=Object(r.b)().primaryReadingPaneTabId)||void 0===t?void 0:t.Id}},2128:function(e,t,n){"use strict";var r=n(25),a=n(0);function i(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(a.__assign)({__type:"GetAttachmentTextPreviewRequest:#Exchange"},n)),Object(r.a)("GetAttachmentTextPreview",e,t)}n.d(t,"a",(function(){return i}))},2136:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("MARK_CONVERSATIONS_AS_READ_STORE_UPDATE",(function(e,t,n,r){return{conversationIds:e,tableViewId:t,isReadValue:n,isExplicit:r}}))},2137:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("MARK_ITEMS_AS_READ_STORE_UPDATE",(function(e,t,n,r){return{itemIds:e,isReadValue:t,isExplicit:n,tableViewId:r}}))},2152:function(e,t,n){"use strict";var r=n(283);t.a=Object(r.action)("setAttachmentShouldShowContextMenu")((function(e,t){e.shouldShowContextMenu=t}))},2154:function(e,t,n){"use strict";var r=n(1405),a=n(0),i=n(1293),o=n(1051);var c=n(2715);function u(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t;return Object(a.__generator)(this,(function(n){switch(n.label){case 0:return e.strategy.previewMethod!==o.a.Wac?[3,2]:[4,Object(c.a)(e.attachmentId,!1)];case 1:9!==(t=n.sent()).Status&&6!==t.Status||(r=e.strategy).previewMethod===o.a.Wac&&(r.previewMethod=o.a.Unsupported,r.supportedOpenActions=r.supportedOpenActions.filter((function(e){return e!==i.a.Preview}))),n.label=2;case 2:return[2]}var r}))}))}var s=n(1840),d=n(1077),l=n(1298),f=n(2059),b=n(991);function v(e,t,n,a,i,o,c,v,m){void 0===c&&(c=null),void 0===m&&(m=!1),Object(f.a)([{attachmentId:e,attachment:t}],n,i);var h=Object(b.a)(e),p=Object(s.a)(e,n,a,1===h.type,d.a.Unknown,!1,c);if(Object(r.a)(p,h,!1,v,o),m){var w=h.model.ProviderType;Object(l.b)(p.isCloudy,w,h.model.Name)||u(p)}return p}n.d(t,"a",(function(){return v}))},2245:function(e,t,n){"use strict";function r(e,t){t&&e&&(e.addCustomData({httpStatusCode:t.status}),function(e,t){t&&e&&e.addCustomData({frontendServer:t.get("x-feserver"),requestId:t.get("request-id"),backendServer:t.get("x-beserver"),backendHttpStatus:t.get("x-backendhttpstatus"),serverVersion:t.get("x-owa-version")})}(e,t.headers))}function a(e){return e&&void 0!==e.fetchErrorType}function i(e,t){e.addCustomProperty("ErrorInformation",t)}function o(e,t){i(e,t?"Empty response from server":"Null response from server")}n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return o}))},2268:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("updateInternetMessageId",(function(e,t,n){return{conversationId:e,itemId:t,internetMessageId:n}}))},2303:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("initializeExtendedCardForItemReadingPane",(function(e,t){return{itemReadingPaneViewState:e,loadedItem:t}}))},241:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,a=!1;function i(t){r--,delete e[t]}this.put=function(t,n,a,o){if(void 0!==a&&("number"!=typeof a||isNaN(a)||a<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==o&&"function"!=typeof o)throw new Error("Cache timeout callback must be a function");var c=e[t];c?clearTimeout(c.timeout):r++;var u={value:n,expire:a+Date.now()};return isNaN(u.expire)||(u.timeout=setTimeout(function(){i(t),o&&o(t,n)}.bind(this),a)),e[t]=u,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&i(t),n},this.clear=function(){for(var i in e)clearTimeout(e[i].timeout);r=0,e=Object.create(null),a&&(t=0,n=0)},this.get=function(i){var o=e[i];if(void 0!==o){if(isNaN(o.expire)||o.expire>=Date.now())return a&&t++,o.value;a&&n++,r--,delete e[i]}else a&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){a=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),a=Date.now(),i=n&&n.skipDuplicates;for(var o in r)if(r.hasOwnProperty(o)){if(i)if(e[o])continue;var c=r[o],u=c.expire-a;if(u<=0){this.del(o);continue}u=u>0?u:void 0,this.put(o,c.value,u)}return this.size()}}e.exports=new r,e.exports.Cache=r},2410:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(4),a=Object(r.action)("CONVERSATION_READY_TO_LOAD",(function(e,t){return{conversationId:e,nodeIdCollectionChange:t}})),i=Object(r.action)("UPDATE_ITEM_MANDATORY_PROPERTIES",(function(e,t){return{conversationId:e,nodeIdCollectionWithItemMandatoryPropertiesChanged:t}}))},2433:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="autoHideEmail"},2434:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Default=0]="Default",e[e.NeedPassword=1]="NeedPassword",e[e.IncorrectPassword=2]="IncorrectPassword"}(r||(r={}))},2439:function(e,t,n){"use strict";var r=n(0);function a(e,t,n,a,i,o,c,u,s,d){return{folderId:null,type:1,listViewType:i,searchNumber:e,queryString:t,searchScope:n,pillSuggestions:Object(r.__spread)(a.values()),includeAttachments:o,fromDate:c,toDate:u,scenarioType:"mail",lastIndexFetched:0,searchProvider:s,viewFilter:d||"All"}}function i(e){var t=e;return 1==e.type?t.scenarioType:void 0}var o=n(953),c=n(963),u=n(950),s=n(982);function d(e){var t=e;return Object(c.o)(t.folderId)?Object(s.e)(t.searchScope,Object(s.c)({folderId:Object(u.a)(o.b),kind:"ArchiveMailbox"})):Object(s.e)(t.searchScope,Object(s.E)({folderId:Object(u.a)(o.g),kind:"PrimaryMailbox"}))}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return d}))},2496:function(e,t,n){"use strict";var r=n(1126),a=n(283);t.a=Object(a.action)("deleteAttachment")((function(e){Object(r.a)().attachments.delete(e.Id)}))},2519:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("APPLY_CONVERSATION_FLAG_STATE_STORE_UPDATE",(function(e,t,n){return{conversationIds:e,flagType:t,tableViewId:n}}))},2541:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"FileAttachment:#Exchange"},e)}},2715:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(0),a=n(254),i=n(2245),o=n(2793),c={},u={},s=[],d=0,l=2;function f(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,c;return Object(r.__generator)(this,(function(u){return o=new a.a("InitializeWacUrl"),n&&o.addCustomProperty("actionSource",n),(c=v(e,t,o))?[2,c]:[2,new Promise((function(a,c){var u={attachmentId:e,isEdit:t,actionSource:n,datapoint:o,resolve:a,reject:c};i?b(u):(s.push(u),function e(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:if(!s.length)return[2];if(d>=l)return[2];t=s.shift(),d++,n.label=1;case 1:return n.trys.push([1,,3,4]),[4,b(t)];case 2:return n.sent(),[3,4];case 3:return d--,e(),[7];case 4:return[2]}}))}))}())}))]}))}))}function b(e){var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,s,d,l,f,b,m,h,p;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(a=e.attachmentId,s=e.isEdit,d=e.actionSource,l=e.datapoint,f=e.resolve,b=e.reject,m=v(a,s,l))return f(m),[2];l.addCustomProperty("ReturnFromCache",!1),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(o.a)(a.Id,s,null,null===(t=a.mailboxInfo)||void 0===t?void 0:t.requestOptions,d)];case 2:return 0===(h=r.sent()).Status&&((s?u:c)[a.Id]={expireTime:(new Date).getTime()+36e5,value:h}),h.WacUrl||l.addCustomProperty("WacUrlIsEmpty",!0),l.addCustomProperty("WacAttachmentResponseStatus",null===(n=h.Status)||void 0===n?void 0:n.toString()),l.end(),f(h),[3,4];case 3:return p=r.sent(),Object(i.a)(p)&&Object(i.c)(l,p.response),Object(i.d)(l,p.toString()),l.endWithError("ServerError"),b(p),[3,4];case 4:return[2]}}))}))}function v(e,t,n){var r=t?u:c,a=r[e.Id];if(a){if(a.expireTime>=(new Date).getTime())return n.addCustomProperty("ReturnFromCache",!0),n.end(),a.value;delete r[e.Id]}return null}},2793:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1646);function a(e,t,n,a,i){if(i){var o="getWacAttachmentInfo"+i;(a=a||{}).headers=a.headers||new Headers,a.headers.set("X-OWA-ActionName",o)}return Object(r.a)({attachmentId:e,isEdit:t,draftId:n,appId:null},a)}},2806:function(e,t,n){"use strict";var r=n(0),a=n(431),i=n(25);function o(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"ImportCalendarEventJsonRequest:#Exchange"},n)),Object(i.a)("ImportCalendarEvent",e,t)}var c=n(1020),u=n(246),s=n(315);function d(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var d,l;return Object(r.__generator)(this,(function(f){switch(f.label){case 0:return i?[4,Object(s.e)(i)]:[3,2];case 1:l=f.sent(),d={headers:l.headers,authNeededOnUnAuthorized:l.authNeededOnUnAuthorized},f.label=2;case 2:return[2,o({Header:Object(u.a)(),Body:(b={Content:e,ImportedItemFolderId:Object(c.a)({BaseFolderId:Object(a.a)({Id:t})}),AttachmentId:n},Object(r.__assign)({__type:"ImportCalendarEventRequest:#Exchange"},b))},Object(r.__assign)({datapoint:{jsonCustomData:function(e){return{status:e.ResponseClass,numberOfEventsImported:e.NumberOfEventsImported}}}},d)).then((function(e){if(null!=e&&null!=e.Body)return e.Body;throw new Error("[importCalendarOperation failed]")}))]}var b}))}))}n.d(t,"a",(function(){return d}))},2934:function(e){e.exports=JSON.parse('{"a":"nib"}')},3527:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(0),a=n(254),i=n(1296),o=n(1605),c=n(79);function u(e,t,n,u,s){return Object(r.__awaiter)(this,void 0,void 0,(function(){var d,l,f,b,v,m,h,p,w,O,g,I,j,S;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:d=new a.a("getWacInfoForOneDriveJsApi",{isCore:!0}),u&&d.addCustomData({redeemSharingLinkIfNecessary:u}),r.label=1;case 1:return r.trys.push([1,3,,4]),l=btoa(t),f="u!"+l.replace(/^\=+|\=+$/g,"").replace("/","_").replace("+","-"),b=new RegExp(/.+?\:\/\/.+?(\/)/g).exec(t)[0],v=b+"_api/v2.0/shares/"+f+"/root?select=openWith/wac,officeBundle,@content.downloadUrl,name,size,currentUserRole&action="+(n?"Open":"View"),m=new Object,u&&(m.prefer="redeemSharingLinkIfNecessary"),h=Object(i.a)({ProviderType:e,Url:v,Headers:JSON.stringify(m)}),p=(new Date).getTime(),[4,Object(o.a)(h)];case 2:if(200===(w=r.sent()).Status&&w.Body)return O=(new Date).getTime(),(g=JSON.parse(w.Body)).fetchStartTime=p,g.responseStartTime=O,!g.openWith.wac&&s||(g.openWith.wac.fileGetUrl=g["@content.downloadUrl"],g.openWith.wac.accessTokenExpiry&&(g.openWith.wac.accessTokenExpiry=new Date(Number(g.openWith.wac.accessTokenExpiry))),!n&&g.currentUserRole&&(g.currentUserRole.readOnly=!0)),d.end(),[2,g];throw d.addCustomData({StatusCode:w.Status}),(I=w.Headers)&&(j=JSON.parse(I))&&d.addCustomData({SharePointError:j.SharePointError,SPClientServiceRequestDuration:j.SPClientServiceRequestDuration,SPRequestGuid:j.SPRequestGuid}),new Error("Result status is: "+w.Status+" or empty response body.");case 3:return S=r.sent(),d.endWithError("ServerError",S),c.g.warn("Something went wrong while calling fetchDataProviderResourceOperation: "+S),[3,4];case 4:return[2,null]}}))}))}},4214:function(e){e.exports=JSON.parse('{"a":"Tkb"}')},4406:function(e,t,n){"use strict";function r(e){switch(e){case"csv":case"ods":case"xls":case"xlsb":case"xlsm":case"xlsx":return"Excel";case"odp":case"pot":case"potm":case"potx":case"pps":case"ppsm":case"ppsx":case"ppt":case"pptm":case"pptx":return"PowerPoint";case"vsd":case"vsdm":case"vsdx":return"Visio";case"doc":case"docm":case"docx":case"dot":case"dotm":case"dotx":case"odt":case"rtf":return"Word";default:return""}}n.d(t,"a",(function(){return r}))},4934:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(5394),a=n(5899),i=n(2934),o=n(9);function c(e){switch(e){case 2:return Object(o.b)(a.d);case 3:return Object(o.b)(a.e);case 5:return Object(o.b)(a.c);case 6:return Object(o.b)(r.a);case 7:return Object(o.b)(a.g);case 4:return Object(o.b)(a.f);case 10:return Object(o.b)(a.a);case 11:return Object(o.b)(a.b);default:return Object(o.b)(i.a)}}},5094:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.SINGLE_EVENT_ICS=1]="SINGLE_EVENT_ICS",e[e.MULTIPLE_EVENT_ICS=2]="MULTIPLE_EVENT_ICS"}(r||(r={}))},5134:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(4),i=Object(a.action)("initializeReadingPaneInSxS",(function(e,t,n,r,a,i){return{readingPaneStrategy:e,previewPaneSelectionSource:t,parentItemId:n,instrumentationContext:r,sxsId:a,isProjectionPopout:i}})),o=Object(a.action)("initializeConversationReadingPaneInSxS",(function(e,t,n,r,a){return{readingPaneStrategy:e,previewPaneSelectionSource:t,parentItemId:n,instrumentationContext:r,sxsId:a}})),c=Object(a.action)("initializeItemReadingPaneInSxS",(function(e,t,n){return{readingPaneStrategy:e,instrumentationContext:t,sxsId:n}})),u=Object(a.action)("initializeReadingPaneInSxSByCopyingMailReadingPane",(function(e,t,n,r,a){return{previewPaneSelectionSource:e,parentItemId:t,instrumentationContext:n,sxsId:r,isProjectionPopout:a}})),s=n(314),d=n(1685),l=n(1137);Object(a.orchestrator)(o,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,a,i,o,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=e.readingPaneStrategy,n=e.previewPaneSelectionSource,a=e.parentItemId,i=e.instrumentationContext,o=e.sxsId,t&&t.conversationId?(c=Object(l.i)(o)).readingPaneState&&c.readingPaneState.mode===l.g.ConversationReadingPane&&c.readingPaneState.conversationId&&c.readingPaneState.conversationId.Id===t.conversationId.Id?(a&&function(e){switch(e){case l.c.MailList:case l.c.ConversationAttachmentWell:return!0;case l.c.ReadingPane:case l.c.FilesHub:case l.c.PhotoHub:case l.c.GroupFilesHub:case l.c.ConsumerGroupFilesHub:case l.c.Deeplink:case l.c.FileSuggestion:case l.c.LinkSuggestion:case l.c.ComposeDocLink:case l.c.ReadingPaneDocLink:case l.c.FolderTree:return!1;default:return Object(s.a)(e)}}(n)&&d.r.importAndExecute(t.conversationId.Id,a.Id),[2]):(Object(l.G)(t.conversationId.Id),[4,d.k.importAndExecute(t.conversationId,i,t.conversationSubject,t.conversationCategories,t.itemIdToScrollTo)]):[2];case 1:return r.sent(),Object(l.I)({mode:l.g.ConversationReadingPane,conversationId:t.conversationId,conversationCategories:t.conversationCategories,conversationSubject:t.conversationSubject},o),a&&d.r.importAndExecute(t.conversationId.Id,a.Id),[2]}}))}))})),Object(a.orchestrator)(c,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,a,i,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=e.readingPaneStrategy,n=e.instrumentationContext,a=e.sxsId,t&&t.itemId?(i=Object(l.i)(a)).readingPaneState&&i.readingPaneState.mode===l.g.ItemReadingPane&&i.readingPaneState.itemId&&i.readingPaneState.itemId.Id===t.itemId.Id?[2]:(Object(l.G)(t.itemId.Id),(o=Object(d.c)())&&o.itemId==t.itemId.Id?(Object(l.I)({mode:l.g.ItemReadingPane,itemId:t.itemId,itemReadingPaneViewState:o},a),[3,4]):[3,1]):[2];case 1:return[4,d.m.import()];case 2:return[4,r.sent()(t.itemId,n,(function(e){Object(l.I)({mode:l.g.ItemReadingPane,itemId:t.itemId,itemReadingPaneViewState:e},a)}))];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))}));var f=n(2431),b=n(1130),v=n(2439),m=n(1088),h=n(1193),p=n(1085),w=n(556),O=n(1292),g=n(7720),I=n(1516),j=n(947);Object(a.orchestrator)(u,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,a,i,u,s,d,S,_,P,y,C,T,x,A,R,E,D,k;return Object(r.__generator)(this,(function(N){switch(N.label){case 0:return e.isProjectionPopout?[2]:(t=Object(l.i)(e.sxsId)).shouldShow&&(t.readingPaneState||t.composeId)?[2]:(n=e.previewPaneSelectionSource,a=e.parentItemId,i=e.instrumentationContext,u=null===(k=j.T.tableViews.get(j.T.selectedTableViewId))||void 0===k?void 0:k.tableQuery,s=u&&(Object(j.M)(u)||Object(v.c)(u)),d=Object(p.c)(),(S=Object(g.a)())?Object(w.v)()&&window.opener?[2]:S.composeId!==b.a.primaryComposeId?[3,2]:[4,O.k.import()]:[3,5]);case 1:N.sent()(S,!0,!0),d=Object(p.c)(),N.label=2;case 2:return[4,p.j.importAndExecute(d,!1)];case 3:return N.sent(),[4,l.B.import()];case 4:return N.sent()(S.composeId,e.sxsId),[2];case 5:if(_=m.a.deeplinkId,P=Object(h.a)(),_)c({method:f.a.LoadItemReadingPane,itemId:{mailboxInfo:_.mailboxInfo,Id:_.id}},i,e.sxsId);else if(d&&d.type===p.a.SecondaryReadingPane)switch((y=d.data).listViewType){case 0:o({method:f.a.LoadConversationReadingPane,conversationId:y.id,conversationSubject:y.subject,conversationCategories:y.categories},n,a,i,e.sxsId);break;case 1:c({method:f.a.LoadItemReadingPane,itemId:y.id},i,e.sxsId)}else if(P&&Object(I.a)(P.conversationId.Id))o({method:f.a.LoadConversationReadingPane,conversationId:P.conversationId,conversationSubject:P.conversationSubject,conversationCategories:P.conversationCategories},n,a,i,e.sxsId);else if(C=Object(j.C)(),T=C&&Object(r.__spread)(C.selectedRowKeys.keys()),x=null==C?void 0:C.isInVirtualSelectAllMode,A=j.T.expandedConversationViewState.selectedNodeIds.length,1==T.length&&A<=1&&!x&&!s)switch(R=j.b.getRowClientItemId(T[0],C),C&&C.tableQuery.listViewType){case 0:E=j.b.getSubject(T[0],C),D=j.b.getCategories(T[0],C),o({method:f.a.LoadConversationReadingPane,conversationId:R,conversationSubject:E,conversationCategories:D},n,a,i,e.sxsId);break;case 1:c({method:f.a.LoadItemReadingPane,itemId:R},i,e.sxsId)}return[2]}}))}))})),Object(a.orchestrator)(i,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,a,i,s,d;return Object(r.__generator)(this,(function(r){if(t=e.readingPaneStrategy,n=e.previewPaneSelectionSource,a=e.parentItemId,i=e.instrumentationContext,s=e.sxsId,d=e.isProjectionPopout,!t)return[2];switch(t.method){case f.a.NoOp:return[2];case f.a.AlwaysHidden:return Object(l.I)(null,s),[2];case f.a.CopyMailReadingPaneContainer:return u(n,a,i,s,d),[2];case f.a.LoadConversationReadingPane:return o(t,n,a,i,s),[2];case f.a.LoadItemReadingPane:return c(t,i,s),[2];default:return[2]}return[2]}))}))}));var S=n(254),_=n(1069),P=n(1298),y=n(1036),C=n(1482),T=n(2935),x="download",A="open";function R(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(T.a)(e.AttachLongPathName),[4,Object(C.l)(n)];case 1:return a=r.sent(),[2,(null===(t=a.result)||void 0===t?void 0:t.webContentLink)&&(i=a.result.webContentLink,i.lastIndexOf(x,i.length-x.length)>-1)?E(a.result.webContentLink):null]}var i}))}))}function E(e){return e.slice(0,-x.length)+A}var D=n(1240),k=n(1115),N=n(9212),M=n(1623),U=n(3527),L=n(7958),W=n(114),F=n(76),V=n(966),B=n(4406),G=n(428),H=n(9),z=n(2934),q=n(5394),J=n(4214),$=n(963),K=n(8028),Y=n(3),X=n(1395),Q=n(79);function Z(e){switch(e){case _.b.Unsupported:return"Unsupported";case _.b.Image:return"Image";case _.b.MailItem:return"MailItem";case _.b.CalendarEvent:return"CalendarEvent";case _.b.Wac:return"Wac";case _.b.SuiteExtensions:return"SuiteExtensions";case _.b.Audio:return"Audio";case _.b.Text:return"Text";case _.b.NativeView:return"NativeView";case _.b.GoogleDoc:return"GoogleDoc";case _.b.PdfJs:return"PdfJs";case _.b.ItemAttachment:return"ItemAttachment";case _.b.Video:return"Video";default:return Object(s.a)(e)}}var ee="/owa/{0}/service.svc/s/GetAttachmentPdfPreview?id={1}";function te(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(H.c)(ee,e,encodeURIComponent(t)),[4,fetch(n,{credentials:"same-origin"})];case 1:return[2,r.sent()]}}))}))}function ne(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a,i,o,c,u,s,d,l,f;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,te(null===(t=e.mailboxInfo)||void 0===t?void 0:t.routingKey,e.Id)];case 1:return(n=r.sent()).ok?[4,n.text()]:[3,3];case 2:for(a=r.sent(),i=a.replace(/\s/gi,""),o=atob(i),c=o.length,u=new Uint8Array(new ArrayBuffer(c)),s=0;s<c;s++)u[s]=o.charCodeAt(s);return d=n.headers.get("PrintAllowed"),l=n.headers.get("CopyAllowed"),f=n.headers.get("ExportAllowed"),[2,{data:u,printAllowed:!d||"true"===d.toLowerCase(),copyAllowed:!l||"true"===l.toLowerCase(),exportAllowed:!f||"true"===f.toLowerCase()}];case 3:throw n.statusText}}))}))}var re=n(2);function ae(e,t){var n=Object(re.F)()?"OWA-PWA":"OWA-WEB",r=t?"SXS-EDIT":"SXS-VIEW",a="";switch(e){case l.c.MailList:a="ML";break;case l.c.ConversationAttachmentWell:a="CAW";break;case l.c.ReadingPane:a="RP";break;case l.c.FilesHub:a="FH";break;case l.c.PhotoHub:a="PH";break;case l.c.GroupFilesHub:a="GFH";break;case l.c.ConsumerGroupFilesHub:a="CGF";break;case l.c.Deeplink:a="DL";break;case l.c.FileSuggestion:a="FS";break;case l.c.LinkSuggestion:a="LS";break;case l.c.ComposeDocLink:a="CDL";break;case l.c.ReadingPaneDocLink:a="RPDL";break;case l.c.FolderTree:a="FT";break;default:a="UNKNOWN"}return n+"."+a+"."+r}var ie=n(2498);function oe(e){var t=new Error(e);throw t.isUserError=!0,t}function ce(e){if(null!=e&&e.isUserError)return!0;return!1}var ue=n(13584),se=n(2623),de=[".odp",".pot",".potm",".potx",".pps",".ppsm",".ppsx",".ppt",".pptm",".pptx"];function le(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,O.j.import()];case 1:return t.sent()(e.Id,3,!1),[2]}}))}))}function fe(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,a;return Object(r.__generator)(this,(function(i){switch(i.label){case 0:return t=e.mailboxInfo,n=t&&t.type==W.a.GroupMailbox?t.mailboxSmtpAddress:null,[4,O.d.import()];case 1:return[4,i.sent()(e.Id,!0,n,!1)];case 2:return a=i.sent(),[2,Object(r.__assign)(Object(r.__assign)({},a.ItemId),{mailboxInfo:e.mailboxInfo})]}}))}))}function be(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return(t=Object(I.a)(e))?[4,O.r.import()]:[3,3];case 1:return[4,n.sent()(t)];case 2:return n.sent(),[2,t.itemId];case 3:return[2,null]}}))}))}function ve(e,t,n,a,o,c,u,s,d,f,b){var h,w;return void 0===b&&(b=l.e.Mail),Object(r.__awaiter)(this,void 0,void 0,(function(){function O(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return c?[3,1]:(n=null,[3,3]);case 1:return[4,c()];case 2:n=r.sent(),r.label=3;case 3:return t=n,a=_e.info.allowDownload,te(),Oe.setImagePreviewState(je,_e.previewImage.url,t,a,!a&&!Object(k.e)().printWithoutDownloadEnabled,Ae),[4,y.k.import()];case 4:return[4,r.sent()(e.attachmentId,e.isReadOnly)];case 5:return r.sent(),te(),Oe.setImagePreviewState(je,Se(e.attachmentId).previewImage.url,t,a,!a&&!Object(k.e)().printWithoutDownloadEnabled,Ae),[2]}}))}))}function C(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return t=_e.model.ProviderType,Object(P.b)(e.isCloudy,t,_e.model.Name)&&t===y.a.providers.ONE_DRIVE_PRO?[4,x()]:[3,2];case 1:return n.sent(),[3,4];case 2:return[4,T()];case 3:n.sent(),n.label=4;case 4:return[2]}}))}))}function T(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,a,i,c,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t=!1,[4,Object(L.a)(e.attachmentId,t,l.c[o])];case 1:return n=r.sent(),_e.model.Name&&(a=_e.model.Name.lastIndexOf("."))>=0&&(i=_e.model.Name.substr(a).toLowerCase(),Ae.useHighContrastCommandBar=de.indexOf(i)>=0),te(),Oe.setWacPreviewState(je,n.wacUrl,null,n.accessToken,n.accessTokenTtl,n.additionalParameters,n.deprecatedTokenAndParameters,re.getTime(),!t,Ae),[3,3];case 2:if(c=r.sent(),null==(u=c)?void 0:u.errorMessage)throw Q.g.warn("Something went wrong while getting the attachment state: "+u),Oe.setPreviewError(je,u.errorMessage),u.error;throw c;case 3:return[2]}}))}))}function x(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t,n,a,i,c,u,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(r.trys.push([0,2,,3]),Ne.addCustomData({useJsApi:"true"}),e=_e,null==(t=Object(F.h)("doc-unwrap-safelinks")?e.originalUrl:e.openUrl))throw new Error("openUrl is null");return n=_e.model.Name,a=n&&n.substring(n.lastIndexOf(".")),d=a,i=!Object(F.h)("doc-SxS-jsApi-ODB-Readonly")&&".xls"!==d,[4,Object(U.a)(0,t,i,!0)];case 1:if(!(c=r.sent()))throw new Error("Vroom API call failed");return te(),u=Object(G.a)(),Oe.setWacPreviewState(je,c.openWith.wac.applicationUrl,{bootScriptUrl:c.openWith.wac.bootstrapperUrl,wopiSrcUrl:c.openWith.wac.wopiSrc,accessToken:c.openWith.wac.accessToken,accessTokenExpiry:c.openWith.wac.accessTokenExpiry,fileSize:_e.model.Size,fileGetUrl:c.openWith.wac.fileGetUrl,bundleInfo:c.officeBundle,fetchStartTime:c.fetchStartTime,responseStartTime:c.responseStartTime,openUrl:t,owaSessionId:u,userId:c.openWith.wac.userId,sessionOrigin:ae(o,i),clientThrottlingProtection:c.openWith.wac.clientThrottlingProtection,requestedCallThrottling:c.openWith.wac.requestedCallThrottling},null,null,null,null,re.getTime(),c.currentUserRole.readOnly,Ae),Ne.addCustomData({owaSessionId:u}),[3,3];case 2:throw s=r.sent(),Q.g.warn("Something went wrong while getting the attachment state: "+s.message),Oe.setPreviewError(je,Object(H.b)(z.a)),s;case 3:return[2]}var d}))}))}function A(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return Object(D.b)(_e.model)&&_e.model.ProviderType===y.a.providers.GDRIVE?[4,E()]:[3,2];case 1:return n.sent(),[3,3];case 2:t=Object(M.a)(e.attachmentId,_e.model,3,Object(D.b)(_e.model),e.isReadOnly),Oe.setNativePdfPreviewState(je,_e.download.url+"&isDocumentPreview=True#toolbar=0",t,"application/pdf",Ae),n.label=3;case 3:return[2]}}))}))}function E(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:e=null,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,R(_e.model)];case 2:return(t=r.sent())?(te(),Oe.setNativePdfPreviewState(je,t,null,"application/pdf",Ae),[2]):[3,4];case 3:return n=r.sent(),e=n,[3,4];case 4:throw te(),Oe.setPreviewError(je,Object(H.b)(q.a)),e||new Error("Unexpected error in handleNativeViewPreviewForGDrive")}}))}))}function W(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=_e.info.allowDownload,n=Object(k.c)(_e.model,!0),t&&n.directFileAccessEnabled&&!Ee?(Oe.setPdfJsPreviewState(je,_e.download.url+"&isDocumentPreview=True",!1,Ae),[3,3]):[3,1];case 1:return[4,ne(e.attachmentId)];case 2:a=r.sent(),te(),Oe.setPdfJsPreviewStateByData(je,a.data,!t&&!Object(k.e)().printWithoutDownloadEnabled||!a.printAllowed,a.copyAllowed,a.exportAllowed,Ae),r.label=3;case 3:return[2]}}))}))}function V(){var t;return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Object(N.a)(e.attachmentId.Id,null===(t=e.attachmentId.mailboxInfo)||void 0===t?void 0:t.requestOptions,0,l.c[o])];case 1:return n=r.sent(),te(),Oe.setTextPreviewState(je,n,Ae),[3,3];case 2:if(a=r.sent(),null==(i=a)?void 0:i.errorMessage)throw te(),Oe.setPreviewError(je,i.errorMessage),i.error;throw a;case 3:return[2]}}))}))}function ee(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t={calendarItem:null,isIcsAttachmentLoading:!0,icsCalendarEventType:K.a.UNKNOWN,attachmentId:e.attachmentId,addToCalendarStatus:1,errorMessage:null},[4,K.d.import()];case 1:return n=r.sent(),a=null,[4,n({attachmentId:e.attachmentId,size:_e.model.Size,showSizeLimitExceedsError:function(){a=Object(H.b)(ue.a)},errorCallback:function(){a=Object(H.b)(J.a)},state:t})];case 2:if(r.sent(),te(),a)throw Oe.setPreviewError(je,a),new Error(a);return ve.onShowCustomPreview(t,f),Oe.setCustomPreviewState(je,Ae),[2]}}))}))}function te(){Object(l.i)(f).pendingPreviewOperation&&Le.id===Object(l.i)(f).pendingPreviewOperation.id||oe("Preview changed before loading finished")}var re,ve,we,Oe,ge,Ie,je,Se,_e,Pe,ye,Ce,Te,xe,Ae,Re,Ee,De,ke,Ne,Me,Ue,Le,We,Fe,Ve,Be,Ge,He,ze;return Object(r.__generator)(this,(function(c){switch(c.label){case 0:return re=new Date,[4,l.E.import()];case 1:return ve=c.sent(),ie.a.available()?(we=d!=window,ie.a.run(d,we,f),[4,X.u.import()]):(ve.openSxSInANewWindow(t,e.attachmentId.Id,null),[2]);case 2:return Oe=c.sent(),ge=ve.onPreviewOperationStart,Ie=ve.onPreviewOperationFinished,je=Object(l.i)(f).viewState,[4,y.i.import()];case 3:Se=c.sent(),_e=Se(e.attachmentId),Pe=e.strategy,ye=-1!==Pe.supportedOpenActions.indexOf(_.a.Download),Ce=ye&&(null==_e?void 0:_e.download)?_e.download.url:null,Te=Pe.isSaveToCloudSupported&&Object(H.f)(_e.model.AttachmentOriginalUrl),xe=Te?1:0,Ae={downloadUrl:Ce,downloadShouldOpenNewTab:!1,fileName:_e.model.Name,useHighContrastCommandBar:!1,id:e.attachmentId,isCloudy:e.isCloudy},Re=Pe.previewMethod,Ee=!1,Pe.previewMethod!==_.b.NativeView&&Pe.previewMethod!==_.b.PdfJs||(De=$.w.items.get(t.Id))&&De.RightsManagementLicenseData&&(Re=_.b.PdfJs,Ee=!0),ke=function(e,t,n,r,a,i,o,c){var u,s,d=pe(e),f=new S.a("PreviewAttachmentInSxSE2E",{timeout:me}),b=Date.now(),v=!1;c&&(v=!!he&&he===c,he=c);var m={previewMethod:Z(t),isCloudy:n?"cloudy":"classic",isChangingFromEditing:r?"changingFromEdit":"",officeFileType:Object(B.a)(d),actionSource:l.c[a],attachmentFileType:i,isRepeat:o,downloadAllowed:!!e.download.url,fromSameReadingPane:v},h="";Object(F.h)("doc-SxS-jsApi-ODB-Base")&&(h+="doc-SxS-jsApi-ODB-Base;");Object(F.h)("doc-SxS-jsApi-ODB-BaseNoEditString")&&(h+="doc-SxS-jsApi-ODB-BaseNoEditString;");Object(F.h)("doc-SxS-jsApi-ODB-Readonly")&&(h+="doc-SxS-jsApi-ODB-Readonly;");Object(F.h)("doc-SxS-jsApi-ODB-Basecf")&&(h+="doc-SxS-jsApi-ODB-Basecf;");m.associatedFlights=h,m.hostName=window.location.hostname,Object(F.h)("doc-SxS-stickyHideEmail")&&(m.hideEmailOption=null===(u=X.u.tryImportForRender())||void 0===u?void 0:u.getHideReadingPaneOption());return f.addCustomData(m),f.addCosmosOnlyData(JSON.stringify({attachmentId:null===(s=null==e?void 0:e.id)||void 0===s?void 0:s.Id,fileType:(null==d?void 0:d.substring(0,4))||"",fileSize:e.model.Size})),Object(S.o)("PreviewAttachmentInSxSUsage",m),{perfDatapoint:f,perfDatapointCreatedTime:b}}(_e,Re,e.isCloudy,Object(l.i)(f).editState.mode!==l.b.View,o,e.fileType,ve.repeatTracker.contains(e.attachmentId.Id),!Object(l.i)(f).shouldShow&&function(){var e,t,n,a,i,o=null===(e=j.T.tableViews.get(j.T.selectedTableViewId))||void 0===e?void 0:e.tableQuery,c=o&&(Object(j.M)(o)||Object(v.c)(o)),u=Object(p.c)(),s=Object(g.a)(),d=null===(t=null==s?void 0:s.itemId)||void 0===t?void 0:t.Id;if(d)return d;var l=Object(m.b)(),f=l.conversationReadingPaneViewState,b=l.deeplinkId;if(b)return b.id;if(u&&u.type===p.a.SecondaryReadingPane){var h=u.data;return null===(n=null==h?void 0:h.id)||void 0===n?void 0:n.Id}if(f&&Object(I.a)(f.conversationId.Id))return f.conversationId.Id;var w=Object(j.C)(),O=w&&Object(r.__spread)(w.selectedRowKeys.keys()),S=null==w?void 0:w.isInVirtualSelectAllMode,_=null===(i=null===(a=j.T.expandedConversationViewState)||void 0===a?void 0:a.selectedNodeIds)||void 0===i?void 0:i.length;return 1===(null==O?void 0:O.length)&&_<=1&&!S&&!c?j.b.getRowClientItemId(O[0],w).Id:null}()),Ne=ke.perfDatapoint,Me=ke.perfDatapointCreatedTime,Ue=function(){Ne.addCustomData({autoHide:!0})},je.eventManager.on(X.a,Ue),Le={id:(new Date).getTime()+"_"+Math.floor(1e3*Math.random()),attachmentId:e.attachmentId},ge(Le,f),c.label=4;case 4:return c.trys.push([4,30,31,32]),[4,ve.canCloseSxS(f)];case 5:if(c.sent()||Ne.addCustomData({exitEditMode:"notSaved"}),te(),a&&!n||i(u,o,t,s,f,we),We=null==t?void 0:t.Id,Fe=We&&Object($.x)(We),Oe.setPreviewLoading(je,"",Ae),ve.showSxS(Object(l.i)(f).shouldShow?null:b,{previewMode:Re,attachmentId:e.attachmentId,selectionSource:o,isCloudy:e.isCloudy,saveToCloudStatus:xe,textPreviewReadMode:0},{editAllowed:Pe.allowEdit&&!(Object(Y.d)("sxsHideEdit")&&(Object(l.i)(f).shouldShow?Object(l.i)(f).customization:b)===l.e.DeepLink),itemId:t,isDraft:n},null,{itemId:We,fileId:e.attachmentId.Id,fileType:pe(_e),sender:null===(w=null===(h=(null==Fe?void 0:Fe.From)||(null==Fe?void 0:Fe.Sender))||void 0===h?void 0:h.Mailbox)||void 0===w?void 0:w.EmailAddress,startTime:(new Date).getTime()},f,d==window?1:2),Object(l.H)(null),Ve=void 0,a)return[3,25];switch(Re){case _.b.Image:return[3,6];case _.b.Wac:return[3,8];case _.b.GoogleDoc:return[3,10];case _.b.NativeView:return[3,11];case _.b.PdfJs:return[3,13];case _.b.Audio:return[3,15];case _.b.Video:return[3,16];case _.b.Text:return[3,17];case _.b.ItemAttachment:return[3,19];case _.b.CalendarEvent:return[3,20]}return[3,22];case 6:return[4,O()];case 7:return c.sent(),[3,23];case 8:return[4,C()];case 9:return c.sent(),[3,23];case 10:return Oe.setIframePreviewState(je,_e.model.AttachLongPathName,Ae),[3,23];case 11:return[4,A()];case 12:return c.sent(),[3,23];case 13:return[4,W()];case 14:return c.sent(),[3,23];case 15:return Oe.setAudioPreviewState(je,_e.download.url,Ae),[3,23];case 16:return Oe.setVideoPreviewState(je,_e.download.url,Ae),[3,23];case 17:return[4,V()];case 18:return c.sent(),[3,23];case 19:return Object(se.a)(e.attachmentId,null),Oe.setCustomPreviewState(je,Ae),[3,23];case 20:return[4,ee()];case 21:return c.sent(),[3,23];case 22:throw new Error("Unsupported preview method");case 23:return[4,ve.waitForPreviewLoadOrThrowError(f)];case 24:Ve=c.sent(),c.label=25;case 25:return te(),Ie(f),a?n?[4,l.t.import()]:[3,27]:[3,29];case 26:return c.sent()(le,f),[3,29];case 27:return[4,l.s.import()];case 28:c.sent()(le,fe,be,f),c.label=29;case 29:return Be=null==Ve?void 0:Ve.errorObject,Ge=null==Ve?void 0:Ve.loadedTime,Be&&Ne.addCustomData({errorObject:Be}),Ge?(He=Ge-Me,Ne.end(He)):Ne.end(),ve.repeatTracker.add(e.attachmentId.Id),[3,32];case 30:return ze=c.sent(),Ne.endWithError(ce(ze)?"UserError":"ServerError",ze),[3,32];case 31:return je.eventManager.off(X.a,Ue),[7];case 32:return[2]}}))}))}var me=18e4,he=null;function pe(e){return 8!==e.attachmentClass&&9!==e.attachmentClass&&Object(V.c)(e.model.Name||"")||e.model.ContentType||""}var we=n(991),Oe=n(1833);function ge(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return(t=e.viewState&&Object(we.a)(e.viewState.attachmentId))&&Object(y.e)(t.model)?[4,Oe.n.import()]:[3,2];case 1:return n.sent()(t.model,e.parentItemId),[2];case 2:return e.onBeforePreview&&e.onBeforePreview(),[4,ve(e.viewState,e.parentItemId,e.isDraft,e.isEdit,e.previewPaneSelectionSource,e.createImageGallery,{method:f.a.CopyMailReadingPaneContainer},e.instrumentationContext,e.targetWindow,e.sxsId)];case 3:return n.sent(),[2]}}))}))}var Ie=n(7409);function je(e,t,n,a,o){var c;return Object(r.__awaiter)(this,void 0,void 0,(function(){var u,s,d,b,v,m,h,p,w,O,g;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return ie.a.run(window,!1,o),u=Object(l.i)(o),[4,l.A.import()];case 1:return s=r.sent(),[4,l.z.import()];case 2:return d=r.sent(),b=null,a instanceof HTMLElement?[4,Ie.b.import()]:[3,4];case 3:return v=r.sent(),b=v(a),[3,5];case 4:b=a,r.label=5;case 5:b||(b=u.viewState),m={downloadUrl:e.downloadUrl,downloadShouldOpenNewTab:!1,useHighContrastCommandBar:!1,id:e.id},h={id:(new Date).getTime()+"_"+Math.floor(1e3*Math.random()),attachmentId:e.id},s(h,o),r.label=6;case 6:return r.trys.push([6,10,,11]),[4,l.D.import()];case 7:return p=r.sent(),[4,X.k.import()];case 8:return w=r.sent(),[4,y.i.import()];case 9:return O=r.sent(),g=null===(c=O(e.id))||void 0===c?void 0:c.info.allowDownload,u.pendingPreviewOperation&&h.id===u.pendingPreviewOperation.id||oe("Preview changed before loading finished"),i({method:f.a.CopyMailReadingPaneContainer},l.c.ReadingPane,null,null,o,!1),w(b,e.previewUrl,t,g,!g&&!Object(k.e)().printWithoutDownloadEnabled,m),p(u.shouldShow?null:l.e.Mail,{previewMode:_.b.Image,attachmentId:e.id,selectionSource:l.c.ReadingPane,isCloudy:!1,saveToCloudStatus:0,textPreviewReadMode:0},{editAllowed:!1,itemId:n,isDraft:!1},null,null,o,1),Object(l.H)(null),d(o),[3,11];case 10:return r.sent(),[3,11];case 11:return[2]}}))}))}function Se(e,t,n,a,o,c,u,s,d,f){return void 0===f&&(f=l.e.Mail),Object(r.__awaiter)(this,void 0,void 0,(function(){function b(){g.pendingPreviewOperation&&C.id===g.pendingPreviewOperation.id||oe("Preview changed before loading finished")}var v,m,h,p,w,O,g,I,j,P,y,C,T,x,A,R,E,D;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return v=s!=window,ie.a.run(s,v,d),m=e(),[4,X.u.import()];case 1:return h=r.sent(),[4,l.E.import()];case 2:p=r.sent(),w=p.onPreviewOperationStart,O=p.onPreviewOperationFinished,g=Object(l.i)(d),I=g.viewState,j={downloadUrl:null,downloadShouldOpenNewTab:!1,useHighContrastCommandBar:!1,id:null,fileName:null},P=function(e,t){var n=new S.a("PreviewLinkInSxSE2E");return n.addCustomData({previewMethod:Z(e),actionSource:l.c[t]}),n}(_.b.Wac,n),y=function(){P.addCustomData({autoHide:!0})},I.eventManager.on(X.a,y),C={id:(new Date).getTime()+"_"+Math.floor(1e3*Math.random()),attachmentId:null},w(C,d),r.label=3;case 3:return r.trys.push([3,10,11,12]),[4,p.canCloseSxS(d)];case 4:r.sent(),b(),i(a,n,t,o,d,v),h.setPreviewLoading(I,"",j),p.showSxS(g.shouldShow?null:f,{previewMode:_.b.Wac,attachmentId:null,selectionSource:n,isCloudy:!0,saveToCloudStatus:0,textPreviewReadMode:0},{editAllowed:!1,itemId:t,isDraft:!1},c,null,d,v?2:1),Object(l.H)(c,u),r.label=5;case 5:return r.trys.push([5,7,,8]),[4,m];case 6:return T=r.sent(),b(),T.jsApiInfo&&(x=Object(G.a)(),T.jsApiInfo.owaSessionId=x,A=ae(n,!0),T.jsApiInfo.sessionOrigin=A,j.fileName=T.jsApiInfo.fileName,function(e,t,n){var r=Object(V.c)(t.fileName);e.addCustomData({useJsApi:"true",officeFileType:Object(B.a)(r),owaSessionId:t.owaSessionId,extraInfo:n}),e.addCosmosOnlyData(JSON.stringify({fileType:(null==r?void 0:r.substring(0,4))||""}))}(P,T.jsApiInfo,T.extraInfo)),h.setWacPreviewState(I,T.wacUrl,T.jsApiInfo,T.accessToken,T.accessTokenTtl,T.additionalParameters,T.deprecatedTokenAndParameters,(new Date).getTime(),u,j),[3,8];case 7:throw R=r.sent(),(null==(E=R)?void 0:E.errorMessage)?(h.setPreviewError(I,E.errorMessage),E.error):(h.setPreviewError(I,R.message||""+R),R);case 8:return[4,p.waitForPreviewLoadOrThrowError(d)];case 9:return r.sent(),b(),O(d),P.end(),[3,12];case 10:return D=r.sent(),P.endWithError(ce(D)?"UserError":"ServerError",D),[3,12];case 11:return I.eventManager.off(X.a,y),[7];case 12:return[2]}}))}))}n.d(t,"previewAttachment",(function(){return ge})),n.d(t,"previewAttachmentInSxS",(function(){return ve})),n.d(t,"previewImageInSxS",(function(){return je})),n.d(t,"previewLinkInSxS",(function(){return Se}))},515:function(e,t,n){"use strict";function r(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var t=e.maximumAttempts,n=e.timeBetweenRetryInMS;return function(e){var r=0,a=!1,i=function(o,c){a?c(new Error("The function retry was cancelled")):(r++,e().then((function(e){return o(e)})).catch((function(e){t&&r>=t?c(e):setTimeout((function(){return i(o,c)}),n(r))})))};return{retriableFunc:function(){return new Promise((function(e,t){return i(e,t)}))},cancel:function(){return a=!0}}}}function a(e){return function(t){return Math.pow(2,t)*e}}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},5394:function(e){e.exports=JSON.parse('{"a":"mib"}')},5899:function(e){e.exports=JSON.parse('{"d":"oib","e":"pib","c":"qib","g":"rib","f":"sib","a":"tib","b":"uib"}')},610:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"FindItemJsonRequest:#Exchange"},e)}},627:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(25),a=n(610);function i(e,t){return void 0===e||e.__type||(e=Object(a.a)(e)),Object(r.a)("FindItem",e,t)}},628:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"FindItemRequest:#Exchange"},e)}},7409:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n(108),a=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(559)]).then(n.bind(null,9958))})),i=new r.b(a,(function(e){return e.getSxSViewStateFromElement})),o=Object(r.d)(a,(function(e){return e.SxSLayerView}));Object(r.d)(a,(function(e){return e.SxSView}))},7720:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1130),a=n(1085);function i(){var e=Object(a.c)(),t=Object(r.b)(),n=e?function(e,t){switch(e.type){case a.a.Primary:return t.primaryComposeId;case a.a.Compose:return e.data;default:return null}}(e,t):t.primaryComposeId,i=n?t.viewStates.get(n):null;return i&&!i.isInlineCompose?i:null}},7958:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(0),a=n(2934),i=n(9),o=n(4934),c=n(2715);function u(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var u,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Object(c.a)(e,t,n,!0)];case 1:return u=r.sent(),[3,3];case 2:throw s=r.sent(),{errorMessage:Object(i.b)(a.a),error:s};case 3:if(0===u.Status)return[2,{wacUrl:u.WacUrl,bootScriptUrl:u.BootScriptUrl,wopiSrcUrl:u.WopiSrcUrl,accessToken:u.AccessToken,accessTokenTtl:u.AccessTokenTtl,additionalParameters:u.AdditionalParameters,deprecatedTokenAndParameters:u.Token}];throw{errorMessage:Object(o.a)(u.Status),error:new Error("GetWacAttachmentInfo failed with status: "+u.Status)}}}))}))}},8028:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n(108),a=n(5094);n.d(t,"a",(function(){return a.a}));var i=new r.c((function(){return Promise.all([n.e(5),n.e(7),n.e(10),n.e(703),n.e(335)]).then(n.bind(null,10600))})),o=new r.b(i,(function(e){return e.addToCalendar})),c=(new r.b(i,(function(e){return e.getIcsCalendarItem})),new r.b(i,(function(e){return e.getIcsCalendarItemOrchestrator}))),u=Object(r.d)(i,(function(e){return e.IcsPreview}))},9212:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),a=n(2128),i=n(79);function o(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var c,u,s,d,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:c={error:null,errorMessage:"Something went wrong while the document preview was being created. Please try again later."},r.label=1;case 1:return r.trys.push([1,3,,4]),o&&(u="getAttachmentTextPreview"+o,(t=t||{}).headers=t.headers||new Headers,t.headers.set("X-OWA-ActionName",u)),[4,Object(a.a)({AttachmentId:e,ReadMode:n},t)];case 2:if((s=r.sent())&&0===s.Status)return[2,s.Content];switch(d=(null==s?void 0:s.Status)||1){case 2:c.errorMessage="The attachment has been moved or deleted.";break;case 3:c.errorMessage="Something went wrong while the document preview was being created. Please try again later.";break;case 1:default:c.errorMessage="Something went wrong while the document preview was being created. Please try again later."}return c.error=new Error("getAttachmentTextPreview failed with status: "+d),[3,4];case 3:return l=r.sent(),i.g.warn("getAttachmentTextPreview failed with error: "+l),c.error=l,[3,4];case 4:throw c}}))}))}},991:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1126);function a(e){return Object(r.a)().attachments.get(e.Id)}}}]);
//# sourceMappingURL=owa.AttachmentPreviewSxS.js.map
self.scriptsLoaded['owa.AttachmentPreviewSxS.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.AttachmentPreviewSxS.js'] = (new Date()).getTime();