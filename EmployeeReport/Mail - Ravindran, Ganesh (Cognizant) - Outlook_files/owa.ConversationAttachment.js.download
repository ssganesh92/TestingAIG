self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.ConversationAttachment.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[218,70],{1018:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"c",(function(){return c}));var r="POST",a="cors",o="GET",i="PUT",c="PATCH"},1053:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={FavoriteNode:"favoritenode",InboxRule:"inboxrule",LocalFile:"Files",MailFolderNode:"mailfoldernode",MailListItemPart:"maillistitempart",MailListRow:"maillistrow",MultiMailListConversationRows:"multimaillistconversationrows",MultiMailListMessageRows:"multimaillistmessagerows",ReadWriteRecipient:"recipient",Todo:"todo",Attachment:"attachment",CommandBarEditorButton:"commandbareditorbutton"}},1062:function(e,t,n){"use strict";var r=n(108),a=n(1128),o={ChannelData:"ChannelData",SubscriptionAdded:"SubscriptionAdded",SubscriptionRemoved:"SubscriptionRemoved",SubscriptionUpdated:"SubscriptionUpdated",NotificationData:"NotificationData",TraceWarn:"TraceWarn",TraceError:"TraceError"};n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return f})),n.d(t,"a",(function(){return o}));var i=new r.c((function(){return Promise.all([n.e(713),n.e(426)]).then(n.bind(null,15023))})),c=new r.a(i,(function(e){return e.subscribe})),u=new r.a(i,(function(e){return e.unsubscribe})),s=new r.b(i,(function(e){return e.getChannelId})),d=(new r.b(i,(function(e){return e.getChannelReady})),new r.a(i,(function(e){return e.setup}))),l=new r.a(i,(function(e){return e.initializeNotificationManager})),f=new r.b(i,(function(e){return e.getNotificationEmitter}));a.a},1107:function(e,t,n){"use strict";var r=n(2391),a=n(1751),o=n(2497),i=n(283);t.a=Object(i.action)("setOngoingActionAndActionMessage")((function(e,t,n){Object(r.a)(e,t),e.actionMessage=n,Object(o.a)(e)?Object(a.a)(e,!0):Object(a.a)(e,!1)}))},1152:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return f}));var r,a=n(1473),o=n(1270),i=n(966),c={};function u(e){return e in c?c[e]:(c[e]={extraSmall:Object(o.a)(e+"_16x16"),small:Object(o.a)(e+"_20x20"),medium:Object(o.a)(e+"_32x32"),large:Object(o.a)(e+"_64x64"),cdn:Object(a.a)(e+"_16x16")},c[e])}var s="generic",d=Object.freeze({".3g2":"video",".3gp":"video",".aac":"audio",".accdb":"accdb",".accdc":"accdb",".accde":"accdb",".accdr":"accdb",".accdt":"accdb",".acs":"accdb",".ai":"vector",".aiff":"audio",".ape":"audio",".apk":"exe",".application":"exe",".app":"exe",".appref-ms":"exe",".appx":"exe",".asf":"video",".aspx":"code",".asx":"video",".avi":"video",".bmp":"photo",".csv":"csv",".dib":"photo",".dgn":"vector",".doc":"docx",".docm":"docx",".docx":"docx",".dot":"dotx",".dotm":"docx",".dotx":"dotx",".email":"email",".emf":"vector",".eml":"email",".eps":"vector",".exe":"exe",".flac":"audio",".flv":"video",".gdraw":"vector",".gif":"photo",".htm":"code",".html":"code",".ical":"calendar",".icalendar":"calendar",".ico":"photo",".ics":"calendar",".indd":"vector",".indt":"vector",".ipa":"exe",".jfif":"photo",".jpe":"photo",".jpeg":"photo",".jpg":"photo",".log":"txt",".lync":s,".m1v":"video",".m4a":"audio",".mdb":"accdb",".mht":"code",".mov":"video",".mp2":"audio",".mp3":"audio",".mp4":"video",".mpa":"audio",".mpe":"video",".mpeg":"video",".mpg":"video",".mpp":"project",".mpt":"mpt",".mpv2":"video",".msg":"email",".msi":"exe",".odp":"pptx",".ods":"xlsx",".odt":"docx",".ogg":"audio",".one":"one",".onepkg":"onetoc",".onetoc":"onetoc",".onetoc2":"onetoc",".oxps":"vector",".pd":"vector",".pdf":"pdf",".plt":"vector",".png":"photo",".pot":"pptx",".potm":"pptx",".potx":"potx",".ppa":"pptx",".ppam":"pptx",".pps":"pptx",".ppsm":"pptx",".ppsx":"ppsx",".ppt":"pptx",".pptm":"pptx",".pptx":"pptx",".pro":"vector",".ps":"vector",".psd":"photo",".pub":"pblsh",".rpmsg":"rpmsg",".rtf":"txt",".sketch":"vector",".srt":"video",".svg":"vector",".svgz":"vector",".swf":"video",".tif":"photo",".tiff":"photo",".txt":"txt",".url":"link",".vcs":"calendar",".vdx":"vsdx",".vob":"video",".vsd":"vsdx",".vsdx":"vsdx",".vsl":"vsdx",".vss":"vsdx",".vssx":"vssx",".vst":"vstx",".vstx":"vstx",".wav":"audio",".wm":"audio",".wma":"audio",".wmd":"video",".wmf":"vector",".wms":"video",".wmv":"video",".wmz":"video",".wps":"docx",".wri":"docx",".xap":"exe",".xcl":"xlsx",".xd":"vector",".xla":"xlsx",".xlam":"xlsx",".xls":"xlsx",".xlsb":"xlsx",".xlsm":"xlsx",".xlsx":"xlsx",".xlt":"xlsx",".xltm":"xlsx",".xltx":"xltx",".xml":"code",".xps":"vector",".xsn":"infopath",".zip":"zip"}),l=Object.freeze({"application/vnd.google-apps.document":"gdoc","application/vnd.google-apps.spreadsheet":"gsheet","application/vnd.google-apps.presentation":"gslide","application/vnd.google-apps.form":"gform","application/onenote":"one","application/pdf":"pdf"});function f(e,t,n){if(void 0===t&&(t=!1),t)return r=r||{extraSmall:null,small:Object(o.a)("folder_20x20"),medium:Object(o.a)("folder_32x32"),large:Object(o.a)("folder_64x64"),cdn:Object(a.a)("folder_16x16")};var c=null,f=Object(i.b)(e);return f&&(c=d[f.toLowerCase()]),!c&&n&&n in l&&(c=l[n]),u(c||s)}},1154:function(e,t,n){"use strict";var r=n(1018),a=n(1336);function o(e){var t;try{t=btoa(e)}catch(n){t=btoa(unescape(encodeURIComponent(e)))}finally{return"u!"+t.replace(/=+$/,"").replace("/","_").replace("+","-")}}n.d(t,"d",(function(){return r.d})),n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b})),n.d(t,"e",(function(){return r.e})),n.d(t,"c",(function(){return r.c})),n.d(t,"f",(function(){return a.a})),n.d(t,"g",(function(){return o}))},1240:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));var r=n(1226);function a(e){return i(e.type)}function o(e){return i(Object(r.a)(e))}function i(e){return 1===e||3===e}},1257:function(e,t,n){"use strict";var r=n(0),a=n(1750),o=n.n(a),i=n(9),c=n(295),u=n(699),s=n(288),d=n(25);function l(e){return Object(r.__assign)({__type:"GetAccessTokenForDataProviderRequest:#Exchange"},e)}function f(e,t){return void 0===e||e.__type||(e=l(e)),Object(d.a)("GetAccessTokenforDataProvider",e,t)}function p(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,o,i,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return a=l({DataProviderType:e,ResourceUrl:t,IsGroupRequest:!1}),o=n?"getAccessTokenForDataProvider_"+n:"getAccessTokenForDataProvider",(i=new Headers).append("X-OWA-ActionName",o),[4,f(a,{headers:i,datapoint:{customData:{actionSource:n},headersCustomData:function(e){return{tokenResultDetails:e.get("x-tokenresult")}},jsonCustomData:function(e){return{tokenStatus:e.TokenResultCode.toString()}}},returnFullResponseOnSuccess:!0})];case 1:return[4,(c=r.sent()).json()];case 2:return[2,{token:r.sent(),response:c}]}}))}))}var m="onedrive_implicit.access",b="Bearer ",v=n(76),h=function(e,t,n){return Object(r.__assign)({resultCode:t,isAdalException:n,_typeSpec:"TokenRetrievalError"},e)},g=function(e){return"TokenRetrievalError"===e._typeSpec},O=[],j={},w=1,I=30,_="",x="Microsoft.IdentityModel.Clients.ActiveDirectory.AdalServiceException";function S(e){j[e]=null}function C(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,p(e,t,n)];case 1:return a=r.sent(),function(e,t,n){O=O.filter((function(e){return e!==t}));var r=n.token;if(0!==r.TokenResultCode||!r.AccessToken||""===r.AccessToken){var a="Access token request failed for token key "+e+" with response code "+r.TokenResultCode,o=n.response.headers.get("x-tokenresult"),i=null!=o&&o.indexOf(x)>0;throw h(new Error(a),r.TokenResultCode,i)}var c=j[e]||{};c[t]=r,j[e]=c}(e,t,a),[2,a.token]}}))}))}function y(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,o;return Object(r.__generator)(this,(function(r){return a=_,0===e&&n&&(o=Object(s.parse)(n),a=Object(i.c)("{0}//{1}/",o.protocol,o.hostname)),Object(v.h)("doc-attachment-testAuthFallback")?[2,""]:[2,P(e,a,t,null)]}))}))}function A(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){return[2,P(0,e,t,n)]}))}))}function P(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n||!function(e,t){var n=j[e];if(!n)return!1;var r=n[t];if(!r||!r.AccessTokenExpiry)return!1;var a=new Date(r.AccessTokenExpiry),i=o()(new Date(Date.now()),w);return null!=a&&i<a}(e,t)?[3,1]:(i=j[e],c=i[t],o()(new Date(Date.now()),I)>new Date(c.AccessTokenExpiry)&&-1===O.indexOf(t)&&(O.push(t),C(e,t,a)),[2,c.AccessToken]);case 1:return[4,C(e,t,a)];case 2:return[2,(c=r.sent()).AccessToken]}}))}))}function T(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(c.a)()&&1===e?[4,Object(u.getDelegationTokenForOwa)(m)]:[3,2];case 1:return a=r.sent(),[3,4];case 2:return[4,y(e,t,n)];case 3:a=r.sent(),r.label=4;case 4:return[2,b+a]}}))}))}n.d(t,"d",(function(){return T})),n.d(t,"c",(function(){return y})),n.d(t,"e",(function(){return A})),n.d(t,"b",(function(){return S})),n.d(t,"f",(function(){return g})),n.d(t,"a",(function(){return b}))},1270:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2419),a="fileType-icon";function o(e){return r[function(e){return a+"-"+e}(e)]}},1296:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"FetchDataProviderResourceRequest:#Exchange"},e)}},1298:function(e,t,n){"use strict";var r=n(0),a=n(1894),o=n(1788),i=n(1107),c={},u=function(){function e(e,t,n){var r=this;this.estimatedTimeToCompleteInMS=e,this.updateIntervalInPercent=t,this.updatePropertyHandler=n,this.start=function(){r.currentTimePercent+=r.updateIntervalInPercent;var e=r.getActionCompletePercent();e<=r.maxPercent?(r.updatePropertyHandler(e),r.nextUpdateTimer=setTimeout(r.start,r.estimatedTimeToCompleteInMS*r.updateIntervalInPercent)):r.nextUpdateTimer=null},this.currentTimePercent=0,this.maxPercent=1-this.updateIntervalInPercent}return e.prototype.complete=function(){var e=this;this.clearUpdateTimer(),this.updatePropertyHandler(1),setTimeout((function(){return e.updatePropertyHandler(1.1)}),500)},e.prototype.abort=function(){this.clearUpdateTimer(),this.updatePropertyHandler(0)},e.prototype.clearUpdateTimer=function(){this.nextUpdateTimer&&(clearTimeout(this.nextUpdateTimer),this.nextUpdateTimer=null)},e.prototype.getActionCompletePercent=function(){return Math.sqrt(2*this.currentTimePercent-this.currentTimePercent*this.currentTimePercent)},e}();function s(e,t){var n=c[e.Id];n&&(t?n.complete():n.abort(),delete c[e.Id])}function d(e,t,n,r){var a=new u(e,t,n);c[r.Id]=a,a.start()}var l=n(2806),f=n(4);Object(f.orchestrator)(a.a,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:a=e.attachment,Object(i.a)(a,7,13),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(l.a)(null,null,e.attachment.attachmentId.Id)];case 2:return t=r.sent(),[3,4];case 3:return r.sent(),[3,4];case 4:return n=t&&"Success"===t.ResponseClass?14:15,function(e,t,n,r,a){s(e,!0),Object(o.a)(n,a),Object(i.a)(n,r,t)}(e.attachment.attachmentId,n,e.attachment,0,7),[2]}var a}))}))}));var p=n(1074),m=n(2154);function b(e){return Object(r.__assign)({__type:"ConvertLocalToRefAttachmentRequest:#Exchange"},e)}var v=n(25);function h(e,t,n,r,a){var o,i,c=function(e,t,n,r,a){return b({ewsAttachmentId:{RootItemChangeKey:t.ChangeKey,RootItemId:t.Id,Id:e},itemId:e,subscriptionId:n,channelId:r,cancellationId:a})}(e,t,n,r,a);return void 0===(o={requestObject:c}).requestObject||o.requestObject.__type||(o.requestObject=b(o.requestObject)),Object(v.a)("ConvertLocalToRefAttachment",o,i)}var g=n(254),O=n(991),j=n(1650),w=n(1062),I=n(283),_={},x=Object(I.action)("convertClassicToCloudy")((function(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,o,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return a=new g.a("AttachmentConvertClassicToCloudy"),function(e){Object(i.a)(e,5,8)}(e),o=function(t){if(C(e,t.ResultCode),y(a,e.attachmentId,t.ResultCode,t.Exception),0===t.ResultCode&&t.Response&&t.Response.ResponseMessages&&t.Response.ResponseMessages.Items&&t.Response.ResponseMessages.Items.length>0&&"NoError"===t.Response.ResponseMessages.Items[0].ResponseCode){var r=t.Response.ResponseMessages.Items[0];n(!0,r.Attachments[0])}else n(!1,null);return!0},c=function(t){C(e,1),n(!1,null),y(a,e.attachmentId,1,t)},[4,S(e.attachmentId,t,o,c)];case 1:return r.sent(),[2]}}))}))}));function S(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,i,c,u,s,d;return Object(r.__generator)(this,(function(l){switch(l.label){case 0:return[4,Object(j.a)(n)];case 1:o=r.__read.apply(void 0,[l.sent(),4]),i=o[0],c=o[1],u=o[2],s=o[3],_[e.Id]=i,l.label=2;case 2:return l.trys.push([2,4,,5]),[4,h(e.Id,t,i,s,i)];case 3:return l.sent(),[3,5];case 4:return d=l.sent(),a(d.message),w.g.importAndExecute(c,u),[3,5];case 5:return[2]}}))}))}function C(e,t){switch(t){case 0:break;case 11:Object(i.a)(e,0,0);break;default:Object(i.a)(e,0,9)}delete _[e.attachmentId.Id]}function y(e,t,n,r){var a=Object(O.a)(t);e.addCosmosOnlyData(JSON.stringify({size:a.model.Size})),e.addCustomData([n]),0===n||11===n?e.end():e.endWithError("ServerError",new Error(r))}var A={name:"CancelConvertClassicToCloudy"},P={name:"CancelConvertCloudyToClassic"};function T(e){return Object(r.__assign)({__type:"CancelConvertLocalToRefAttachmentRequest:#Exchange"},e)}function E(e){var t,n,r=function(e){return T({cancellationId:e})}(e);return void 0===(t=r)||t.__type||(t=T(t)),Object(v.a)("CancelConvertLocalToRefAttachment",t,n)}var k=n(123),D=Object(k.d)("cancelConvertClassicToCloudy",A)((function(e){var t,n=(t=e.attachmentId.Id,_[t]);if(!n)throw new Error("Failed to find the cancellationId of ConvertClassicToCloudy");Object(i.a)(e,5,10),E(n)})),R=n(1477),N=Object(I.action)("setActionCompletePercent")((function(e,t){e.actionCompletePercent=t})),M=n(2152),V=n(1789),L=(n(1751),n(1405)),H=n(1839),W=n(1069),B=n(2059),z=n(2496),F=n(2794),U=n(1240),J=Object(I.action)("updateAttachment")((function(e,t,n,a,o){Object(z.a)(e.attachmentId);var c=Object(r.__assign)(Object(r.__assign)({},a.AttachmentId),{mailboxInfo:t.mailboxInfo});if(n.AttachmentId=c,a.Name&&(n.Name=a.Name),a.Size&&(n.Size=a.Size),a.ContentType&&(n.ContentType=a.ContentType),a.__type&&(n.__type=a.__type),n.IsInline&&(n.ContentId=a.ContentId),Object(U.b)(a)){var u=n;u.AttachLongPathName=a.AttachLongPathName,u.PermissionType=a.PermissionType,u.ProviderType=a.ProviderType,u.AttachmentThumbnailUrl=a.AttachmentThumbnailUrl,u.AttachmentPreviewUrl=a.AttachmentPreviewUrl}if(Object(B.a)([{attachmentId:c,attachment:n,permissionInfo:o}],!1),e.attachmentId=c,Object(H.a)(e))Object(V.a)(e,1);else{Object(W.g)(e,!1),setTimeout((function(){N(e,1.1)}),500),Object(i.a)(e,0,0);var s=Object(O.a)(c);Object(L.a)(e,s,!1,e.strategy.supportedMenuActions),s.download.url||Object(F.a)(c,e.isReadOnly,!0)}}));function X(e){return Object(r.__assign)({__type:"ConvertRefToLocalAttachmentRequest:#Exchange"},e)}function q(e,t,n,r,a,o,i,c){var u,s,d=function(e,t,n,r,a,o,i,c){return X({ewsAttachmentId:e,emailId:t,subscriptionId:n,channelId:r,cancellationId:a,fullPathLocation:o,attachmentDataProviderId:c,PermissionLevel:i})}(e,t,n,r,a,o,i,c);return void 0===(u={requestObject:d}).requestObject||u.requestObject.__type||(u.requestObject=X(u.requestObject)),Object(v.a)("ConvertRefToLocalAttachment",u,s)}function G(e){return $(Object(O.a)(e).model.Size)}function K(e){return 2856+.00145*e}function Q(e){return 4*$(e)}function Y(e){return 4*$(e)}function Z(e){return 2*$(e)}function $(e){return Math.round(e/256)}var ee=n(2541),te={},ne=Object(f.action)("convertCloudyToClassic",(function(e,t,n,r,a,o){return{attachment:e,parentItemId:t,fullPathLocation:n,permissionLevel:r,replaceAttachmentHandler:a,source:o}})),re=ne;function ae(e,t,n,a,o,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var c,u,s,d,l,f;return Object(r.__generator)(this,(function(p){switch(p.label){case 0:return[4,Object(j.a)(o)];case 1:c=r.__read.apply(void 0,[p.sent(),4]),u=c[0],s=c[1],d=c[2],l=c[3],te[e.Id]=u,p.label=2;case 2:return p.trys.push([2,4,,5]),[4,q(e.Id,t,u,l,u,n,a)];case 3:return p.sent(),[3,5];case 4:return f=p.sent(),i(f.message),w.g.importAndExecute(s,d),[3,5];case 5:return[2]}}))}))}function oe(e,t){switch(t){case 0:break;case 11:Object(i.a)(e,0,0);break;default:Object(i.a)(e,0,12)}delete te[e.attachmentId.Id]}function ie(e,t,n,r,a){var o,i=Object(O.a)(t);e.addCosmosOnlyData(JSON.stringify({size:i.model.Size,attachmentId:null===(o=i.model.AttachmentId)||void 0===o?void 0:o.Id})),e.addCustomData([n,a]),0===n||11===n?e.end():e.endWithError("ServerError",new Error(r))}function ce(e){return Object(r.__assign)({__type:"CancelConvertRefToLocalAttachmentRequest:#Exchange"},e)}function ue(e){var t,n,r=function(e){return ce({cancellationId:e})}(e);return void 0===(t=r)||t.__type||(t=ce(t)),Object(v.a)("CancelConvertRefToLocalAttachment",t,n)}Object(f.orchestrator)(ne,(function(e){var t=e.attachment;!function(e,t,n,a,o,c){Object(r.__awaiter)(this,void 0,void 0,(function(){var u,s,d;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return u=new g.a("AttachmentConvertCloudyToClassic"),function(e){Object(i.a)(e,6,11)}(e),s=function(t){if(oe(e,t.ResultCode),ie(u,e.attachmentId,t.ResultCode,t.Exception,c),0===t.ResultCode){var n=Object(ee.a)({Name:t.Item.Name,Size:t.Item.Size,AttachmentId:t.NewAttachmentId});o(!0,n)}else o(!1,null);return!0},d=function(t){oe(e,1),o(!1,null),ie(u,e.attachmentId,1,t,c)},[4,ae(e.attachmentId,t,n,a,s,d)];case 1:return r.sent(),[2]}}))}))}(t,e.parentItemId,e.fullPathLocation,e.permissionLevel,(function(n,r){n?e.replaceAttachmentHandler(t,r,!1,!0):s(t.attachmentId,n)}),e.source),d(G(t.attachmentId),.1,(function(e){N(t,e)}),t.attachmentId)}));var se=Object(f.action)("cancel_ConvertCloudyToClassic",(function(e){return Object(k.c)(P,{attachmentViewState:e})})),de=se;Object(f.orchestrator)(se,(function(e){var t,n=(t=e.attachmentViewState.attachmentId.Id,te[t]);if(!n)throw new Error("Failed to find the cancellationId of ConvertCloudyToClassic");Object(i.a)(e.attachmentViewState,6,10),ue(n)}));var le=n(1036),fe=n(1115),pe=n(2030),me=n(1448);function be(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,me.h.import()];case 1:return n.sent()(e.model.AttachLongPathName,pe.a.OneDrivePro).then((function(n){return Object(r.__awaiter)(t,void 0,void 0,(function(){var t,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n&&0===n.ResultCode?[2]:(t=Object(fe.b)(e.model,!0),[4,le.h.importAndExecute(t,e.attachmentClass,e.model,!0,e.model.ProviderType,n)]);case 1:return a=r.sent(),le.m.importAndExecute(e.id,a),Object(le.p)(e.id),[2]}}))}))})),[2]}}))}))}var ve=n(76),he=n(966);function ge(e,t,n){if(e&&t===le.a.providers.ONE_DRIVE_PRO&&(Object(ve.h)("doc-SxS-jsApi-ODB-Base")||Object(ve.h)("doc-SxS-jsApi-ODB-BaseNoEditString")||Object(ve.h)("doc-SxS-jsApi-ODB-Readonly"))){var r=n&&n.substring(n.lastIndexOf("."));switch(Object(he.f)(r)){case he.a.Word:return Object(ve.h)("doc-SxS-jsApi-ODB-Word");case he.a.Excel:return Object(ve.h)("doc-SxS-jsApi-ODB-Excel");case he.a.PowerPoint:return!Object(ve.h)("doc-SxS-jsApi-ODB-Readonly")&&Object(ve.h)("doc-SxS-jsApi-ODB-PowerPoint")}}return!1}var Oe=n(1840),je=n(1077);function we(e,t,n,r,a){return void 0===n&&(n=!1),void 0===r&&(r=0),void 0===a&&(a=!1),{attachmentType:1,attachmentId:e,isInline:!0,isHiddenInline:n,placeholderId:t,status:r,fileType:je.a.Inline,skipProcessInlineImage:a}}function Ie(e){return!!e.strategy.isSaveToCloudSupported&&-1===e.completedActions.indexOf(2)}var _e=n(1787);n(1927);n.d(t,"a",(function(){return p.a})),n.d(t,"h",(function(){return m.a})),n.d(t,"c",(function(){return D})),n.d(t,"e",(function(){return x})),n.d(t,"u",(function(){return R.a})),n.d(t,"w",(function(){return R.c})),n.d(t,"v",(function(){return R.b})),n.d(t,"D",(function(){return R.d})),n.d(t,"x",(function(){return N})),n.d(t,"y",(function(){return M.a})),n.d(t,"z",(function(){return V.a})),n.d(t,"A",(function(){return i.a})),n.d(t,"E",(function(){return J})),n.d(t,"r",(function(){return L.a})),n.d(t,"o",(function(){return L.b})),n.d(t,"d",(function(){return de})),n.d(t,"f",(function(){return re})),n.d(t,"m",(function(){return be})),n.d(t,"b",(function(){return ge})),n.d(t,"B",(function(){return d})),n.d(t,"C",(function(){return s})),n.d(t,"k",(function(){return K})),n.d(t,"l",(function(){return Y})),n.d(t,"q",(function(){return Q})),n.d(t,"j",(function(){return Z})),n.d(t,"g",(function(){return Oe.a})),n.d(t,"i",(function(){return we})),n.d(t,"p",(function(){return G})),n.d(t,"t",(function(){return Ie})),n.d(t,"s",(function(){return H.a})),n.d(t,"n",(function(){return _e.a}))},1336:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(0),a=n(254),o=n(1257),i=n(279),c=n(1296),u=n(1605),s=n(79),d=n(1018);function l(e,t,n,i,c){return Object(r.__awaiter)(this,void 0,void 0,(function(){var u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Object(o.d)(e,!1,n)];case 1:return u=r.sent(),[3,3];case 2:return r.sent(),[3,3];case 3:return u&&u.split(o.a)[1]?(Object(a.o)("fetchServiceViaDataProvider",[e]),s.g.info("fetchServiceViaDataProvider"),[4,f(t,u,i,c)]):[3,5];case 4:return[2,r.sent()];case 5:Object(a.o)("fetchServiceFailedToGetToken",[e]),r.label=6;case 6:return 0!==e?[3,8]:(Object(a.o)("fetchServiceViaOWAServer"),s.g.info("fetchServiceViaOWAServer"),[4,p(e,t,i,c)]);case 7:return[2,r.sent()];case 8:throw new Error("Fetch service has failed to retrieve client token.")}}))}))}function f(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var c,u,s;return Object(r.__generator)(this,(function(r){return c=n.datapointNamePrefix+"DataProvider",u=new a.a(c),s={Authorization:t,"Content-Type":"application/json",Accept:"application/json"},o&&Object.keys(o).forEach((function(e){s[e]=o[e]})),[2,fetch(e,{method:n.method,mode:n.mode,headers:s,body:n.body}).then((function(e){if(Object(i.a)(e.status))return u.end(),e.json();var t=new Error(c+" : Response status = "+e.status+", body = "+e.body);u.endWithError("ServerError",t);var n={datapointName:c,responseStatus:e.status,responseBody:e.body};throw JSON.stringify(n)})).then((function(e){return JSON.stringify(e)}))]}))}))}function p(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var s,l,f,p,m,b;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return s=n.datapointNamePrefix+"OWA",l=new a.a(s),f=Object(c.a)({ProviderType:e,Url:t,Method:n.method,Body:n.body?n.body:JSON.stringify({}),Headers:JSON.stringify(o),IsJsonPost:n.method===d.d}),[4,Object(u.a)(f)];case 1:if(p=r.sent(),Object(i.a)(p.Status))return l.end(),[2,p.Body];throw m=new Error(s+" : Response status = "+p.Status+", ServerTraceLog = "+p.ServerTraceLog),l.endWithError("ServerError",m),b={datapointName:s,responseStatus:p.Status,responseServerTraceLog:p.ServerTraceLog},JSON.stringify(b)}}))}))}},13752:function(e,t,n){var r=n(13753),a=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)a.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},13753:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,'._1pPFwx5rYgxcgAElMzLbAd{display:block;width:261px}html[dir] ._1pPFwx5rYgxcgAElMzLbAd._3JHQes77teu7GToIsCc_xE,html[dir] ._1pPFwx5rYgxcgAElMzLbAd:focus,html[dir] ._1pPFwx5rYgxcgAElMzLbAd:hover{background:"[theme:neutralLighter, default:#f4f4f4]"}._1pPFwx5rYgxcgAElMzLbAd._3JHQes77teu7GToIsCc_xE ._302eciisr8EpJrDSwH_Sbx,._1pPFwx5rYgxcgAElMzLbAd:hover ._302eciisr8EpJrDSwH_Sbx{width:142px}._Y2ypFk_xp-nvQtuGu_-h{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;position:relative}._3wcJ_rB4jUxKLkaKrKj_GZ{display:block}html[dir] ._3wcJ_rB4jUxKLkaKrKj_GZ{margin:6px 8px}._2Pr_qifjTGwPB6L_eo24_B{font-size:24px;color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}html[dir] ._2Pr_qifjTGwPB6L_eo24_B{background:transparent}._1Ra5rtzVEB6uogdqQiC2rx{display:block;white-space:nowrap;position:relative;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}html[dir] ._1Ra5rtzVEB6uogdqQiC2rx{padding:6px 4px}._3EsA8G8nIiVlrwi7EvfneN{font-size:14px}._3EsA8G8nIiVlrwi7EvfneN,._302eciisr8EpJrDSwH_Sbx{font-weight:400;max-width:194px}._302eciisr8EpJrDSwH_Sbx{font-size:11px}html[dir] ._302eciisr8EpJrDSwH_Sbx{padding-top:3px}._302eciisr8EpJrDSwH_Sbx .GeukVsgtTix5zrmhP2k1C{font-size:12px;font-weight:400;font-weight:600;position:relative;top:2px}html[dir=ltr] ._302eciisr8EpJrDSwH_Sbx .GeukVsgtTix5zrmhP2k1C{padding-right:4px}html[dir=rtl] ._302eciisr8EpJrDSwH_Sbx .GeukVsgtTix5zrmhP2k1C{padding-left:4px}._302eciisr8EpJrDSwH_Sbx ._1DD8d7Q5IxT7aE8KaVPUKa{color:#107c10}._302eciisr8EpJrDSwH_Sbx ._23Ys9CLV_lGJ3w0LIHTfLi{color:#e81123}._2Tuvy48k5aBpiLeRkrcceY{overflow:hidden;text-overflow:ellipsis}._2aO0rTKW0ac8YNFb8bLNnA{height:26px;width:52px;position:absolute;bottom:0;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}html[dir=ltr] ._2aO0rTKW0ac8YNFb8bLNnA{right:0}html[dir=rtl] ._2aO0rTKW0ac8YNFb8bLNnA{left:0}.CO4JS_CRPsg_js1AAXe-d{display:block;height:100%;width:26px;position:absolute;bottom:0}html[dir=ltr] .CO4JS_CRPsg_js1AAXe-d{right:0}html[dir=rtl] .CO4JS_CRPsg_js1AAXe-d{left:0}html[dir] .CO4JS_CRPsg_js1AAXe-d:focus,html[dir] .CO4JS_CRPsg_js1AAXe-d:hover{background:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}.GeukVsgtTix5zrmhP2k1C{font-size:14px}html[dir] .GeukVsgtTix5zrmhP2k1C{margin:0}.KLhaPYQ6nYXemE5yXxev7{font-size:12px;font-weight:400;line-height:30px;cursor:pointer;width:261px;-webkit-box-sizing:border-box;box-sizing:border-box;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}html[dir=ltr] .KLhaPYQ6nYXemE5yXxev7{padding:0 20px 0 54px}html[dir=rtl] .KLhaPYQ6nYXemE5yXxev7{padding:0 54px 0 20px}html[dir] .KLhaPYQ6nYXemE5yXxev7:focus,html[dir] .KLhaPYQ6nYXemE5yXxev7:hover{background:"[theme:neutralLight, default:#eaeaea]"}html[dir] ._1pk_VDuef6gt4o_QRNLHAe{margin-top:-4px}._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator-itemName{display:none}._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator,._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator .ms-ProgressIndicator-itemProgress,._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator .ms-ProgressIndicator-progressBar,._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator .ms-ProgressIndicator-progressTrack{height:4px}html[dir] ._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator,html[dir] ._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator .ms-ProgressIndicator-itemProgress,html[dir] ._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator .ms-ProgressIndicator-progressBar,html[dir] ._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator .ms-ProgressIndicator-progressTrack{padding:0}._3n11Nj1NwjIZ39AgUcDMoH{position:fixed;pointer-events:"none";z-index:1000;top:0;font-size:12px;font-weight:400}html[dir] ._3n11Nj1NwjIZ39AgUcDMoH{border-width:1px;border-style:solid;padding:0 4px;background:"[theme:neutralTertiary, default:#a6a6a6]"}html[dir=ltr] ._3n11Nj1NwjIZ39AgUcDMoH{left:0}html[dir=rtl] ._3n11Nj1NwjIZ39AgUcDMoH{right:0}',""]),t.locals={container:"_1pPFwx5rYgxcgAElMzLbAd",active:"_3JHQes77teu7GToIsCc_xE",secondLine:"_302eciisr8EpJrDSwH_Sbx",innerContainer:"_Y2ypFk_xp-nvQtuGu_-h",thumbnailDiv:"_3wcJ_rB4jUxKLkaKrKj_GZ",placeholder:"_2Pr_qifjTGwPB6L_eo24_B",infoDiv:"_1Ra5rtzVEB6uogdqQiC2rx",firstLine:"_3EsA8G8nIiVlrwi7EvfneN",icon:"GeukVsgtTix5zrmhP2k1C",success:"_1DD8d7Q5IxT7aE8KaVPUKa",failure:"_23Ys9CLV_lGJ3w0LIHTfLi",textOverFlow:"_2Tuvy48k5aBpiLeRkrcceY",actionsContainer:"_2aO0rTKW0ac8YNFb8bLNnA",menuButton:"CO4JS_CRPsg_js1AAXe-d",menuItem:"KLhaPYQ6nYXemE5yXxev7",progressIndicator:"_1pk_VDuef6gt4o_QRNLHAe",dragPreview:"_3n11Nj1NwjIZ39AgUcDMoH"}},13754:function(e,t,n){var r=n(13755),a=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)a.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},13755:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,"._3h6BOcXe5rgJt2gWiPg7WW{overflow-y:auto;overflow-x:hidden}",""]),t.locals={container:"_3h6BOcXe5rgJt2gWiPg7WW"}},13756:function(e){e.exports=JSON.parse('{"a":"I$c"}')},13757:function(e,t,n){var r=n(13758),a=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)a.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},13758:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,'._2I3DVKJX90XpSU9E0jOrPI{color:"[theme:neutralDark, default:#212121]"}html[dir] ._2I3DVKJX90XpSU9E0jOrPI{border-radius:2px;border-color:transparent}html[dir] ._2I3DVKJX90XpSU9E0jOrPI:not(:hover){background-color:transparent}._2I3DVKJX90XpSU9E0jOrPI.ms-Button{min-width:50px}html[dir] ._2I3DVKJX90XpSU9E0jOrPI.ms-Button{padding:0}html[dir=ltr] .jflLAFNOz_OPbbqzYM9gl{margin-left:2px}html[dir=rtl] .jflLAFNOz_OPbbqzYM9gl{margin-right:2px}._1kEgpc1Wh6CbzQbd6iET2p{font-size:10px}html[dir] ._1kEgpc1Wh6CbzQbd6iET2p{margin:2px 6px 0 6px}._3JXvFMglzZ7tMbYPkjKuKC{font-size:14px;font-weight:400}html[dir] ._3JXvFMglzZ7tMbYPkjKuKC{margin:0}',""]),t.locals={button:"_2I3DVKJX90XpSU9E0jOrPI",icon:"jflLAFNOz_OPbbqzYM9gl",menuIcon:"_1kEgpc1Wh6CbzQbd6iET2p",label:"_3JXvFMglzZ7tMbYPkjKuKC"}},1389:function(e,t,n){"use strict";var r;function a(){return[r.noPermissionToShare,r.getSharingInfoFailed,r.linkHasExpired,r.linkWillExpire,r.noPermissionToShareExternally,r.externalRecipientCSL,r.noPermissionSet,r.sharingWithLargeDL]}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),function(e){e.noPermissionToShare="WarningNoPermissionToShare",e.getSharingInfoFailed="WarningGetSharingInfoFailed",e.linkHasExpired="WarningLinksHasExpired",e.linkWillExpire="WarningLinksWillExpire",e.noPermissionToShareExternally="WarningExternalRecipientButNoPermissionToShareExternally",e.externalRecipientCSL="WarningExternalRecipientsCannotOpenCSLs",e.noPermissionSet="WarningOnlyPeopleWithExistingAccessCanAccess",e.sharingWithLargeDL="WarningNotAllMembersOfDLCanAccess"}(r||(r={}))},1398:function(e,t,n){"use strict";var r,a;function o(e){r=e}function i(){return r}function c(e){a=e}function u(){return a}n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return u}))},1405:function(e,t,n){"use strict";var r=n(2082),a=n(9),o=n(1788),i=n(1107);var c=n(1074),u=n(1240),s=n(1115),d=n(1036),l=n(283);n.d(t,"b",(function(){return p}));var f=null;function p(){return f||(f=Object.keys(c.a).reduce((function(e,t){var n=c.a[t];return Number.isInteger(n)&&e.push(n),e}),[])),f}t.a=Object(l.action)("initializeAttachmentFullViewState")((function(e,t,n,l,f){var m;l&&0!==l.length||(m=t.model,l=Object(d.e)(m)?function(e){return 2===Object(d.c)(e)?[c.a.Preview,c.a.Download]:[c.a.Download]}(m):p());var b=Object(s.b)(t.model,!0),v=Object(s.e)(),h=Object(u.a)(t),g=Object(r.a)(v,b,t.attachmentClass,t.model,h?t.model.ProviderType:null,t.model.AttachmentOriginalUrl,t.info.allowDownload,l,e.isReadOnly,n,f);e.strategy=g,function(e,t,n){n&&!Object(a.f)(t.model.AttachmentOriginalUrl)&&(Object(o.a)(e,2),Object(i.a)(e,0,2))}(e,t,e.strategy.isSaveToCloudSupported)}))},1425:function(e,t,n){"use strict";n.d(t,"g",(function(){return r})),n.d(t,"e",(function(){return a})),n.d(t,"m",(function(){return o})),n.d(t,"l",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"o",(function(){return u})),n.d(t,"f",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"i",(function(){return l})),n.d(t,"j",(function(){return f})),n.d(t,"a",(function(){return p})),n.d(t,"d",(function(){return m})),n.d(t,"n",(function(){return b})),n.d(t,"k",(function(){return v})),n.d(t,"p",(function(){return h})),n.d(t,"h",(function(){return g}));var r=100,a=1,o="PublicDL",i="PrivateDL",c="GroupMailbox",u="RecommendedGroup",s="InternalMailbox",d="ExternalMailbox",l="Mailbox",f="OneOff",p="Contact",m="ImplicitContact",b="PublicFolder",v="Other",h="Room",g="LinkedIn"},1448:function(e,t,n){"use strict";n.d(t,"h",(function(){return s})),n.d(t,"i",(function(){return d})),n.d(t,"f",(function(){return l})),n.d(t,"k",(function(){return f})),n.d(t,"m",(function(){return p})),n.d(t,"e",(function(){return m})),n.d(t,"g",(function(){return b})),n.d(t,"j",(function(){return v})),n.d(t,"l",(function(){return h}));var r=n(108),a=n(1747);n.d(t,"n",(function(){return a.a}));var o=n(1705);n.d(t,"a",(function(){return o.a}));n(1425);var i=n(1389);n.d(t,"d",(function(){return i.b})),n.d(t,"c",(function(){return i.a}));var c=n(1748);n.d(t,"b",(function(){return c.a}));var u=new r.c((function(){return Promise.all([n.e(4),n.e(17),n.e(44),n.e(541)]).then(n.bind(null,3463))})),s=new r.b(u,(function(e){return e.getSharingInformation})),d=new r.b(u,(function(e){return e.getSharingIssuesForSharingData})),l=new r.b(u,(function(e){return e.getInfoBarCreator})),f=new r.b(u,(function(e){return e.hasLargeDLRecipient})),p=new r.b(u,(function(e){return e.hasRecipientExpansionFailure})),m=new r.b(u,(function(e){return e.getGroupsAndSmallDLs})),b=new r.b(u,(function(e){return e.getInvididualRecipients})),v=new r.b(u,(function(e){return e.hasGetRecipientPermissionFailed})),h=new r.b(u,(function(e){return e.logSharingTipChangesForLinkRemoval}))},1463:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r,a=n(1152),o=n(1473);function i(e,t,n,i,c){if(n)return r=r||{extraSmall:Object(a.b)("generic").extraSmall,small:Object(a.b)("generic").small,medium:Object(a.b)("blockedfile").medium,large:Object(a.b)("generic").large,cdn:Object(o.a)("generic_16x16")};switch(c){case"IPM.Note":case"IPM.Note.SMIME":case"IPM.Note.SMIME.MultipartSigned":case"IPM.Schedule.Meeting.Request":case"IPM.Schedule.Meeting.Canceled":return Object(a.b)("email");case"IPM.Schedule":case"IPM.Appointment":case"IPM.OLE.CLASS.{00061055-0000-0000-C000-000000000046}":return Object(a.b)("calendar")}return i?Object(a.b)("sharedfolder"):Object(a.a)(e,!1,t)||Object(a.b)("generic")}},1473:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(76),a=1;function o(e){return Object(r.h)("doc-fileIcon-newCdn")?"https://outlook-"+(a++%2+1)+".cdn.office.net/assets/mail/file-icon/png/"+e+".png":"https://r"+(a++%4+1)+".res.outlook.com/owa/prem/images/"+e+".png"}},1476:function(e,t,n){"use strict";var r=n(0),a=n(1),o=n(283),i=Object(o.action)("setDragState")((function(e,t){e.isBeingDragged=t})),c=n(1398),u=n(1570),s=n(60),d=n(79),l=n(981);n.d(t,"a",(function(){return f}));var f=function(){function e(e){var t=this;this.props=e,this.initialPageX=0,this.initialPageY=0,this.dragHelperElement=null,this.isPotentialDrag=!1,this.isDragging=!1,this.onDragStart=function(e){e.dataTransfer.clearData(),t.isDragAllowed()?(e.stopPropagation(),t.setDragStateAndData(e),e.dataTransfer.effectAllowed="copyMove",t.onDragStartInternal(e.pageX,e.pageY),t.overrideDefaultDragPreviewImage(e.dataTransfer)):t.props.showDefaultNoDragImage&&(t.overrideDefaultNoDragImage(e.dataTransfer),e.dataTransfer.setData("text","nodrop"),e.dataTransfer.effectAllowed="none")},this.onDragEnd=function(e){if(t.isDragging){t.isDragging=!1;var n=t.props.onDragEnd,r=e?e.dataTransfer.dropEffect:null;(Object(s.e)()||Object(s.g)())&&(r=Object(c.b)()),n&&n(t.props.getDragData(),r)}t.resetDragStateAndData(),t.removeDragHelperElement()},this.onMouseDown=function(e){!u.a&&0==e.button&&t.isDragAllowed()&&(t.initialPageX=e.pageX,t.initialPageY=e.pageY,t.isPotentialDrag=!0,document.body.addEventListener("mousemove",t.onMouseMove),document.body.addEventListener("mouseup",t.onMouseUp)),t.props.onMouseDown&&t.props.onMouseDown(e)},this.refCallback=function(e){t.div=e,t.div&&t.div.addEventListener("mousedown",t.onMouseDown)},this.onMouseMove=function(e){var n=e.pageX,r=e.pageY;(Math.abs(t.initialPageX-n)>=u.b||Math.abs(t.initialPageY-r)>=u.b)&&(t.removeMouseMoveAndUpEventListeners(),t.isPotentialDrag&&(t.isPotentialDrag=!1,(Object(s.e)()||Object(s.g)())&&window.getSelection().removeAllRanges(),t.isDragAllowed()&&(t.dragHelperElement=t.getDragHelperElement(),document.body.appendChild(t.dragHelperElement))),t.dragHelperElement&&(t.dragHelperElement.addEventListener("dragstart",(function(e){t.onDragStartHelperElement(e)})),t.dragHelperElement.addEventListener("dragend",(function(e){t.onDragEnd(e)})),t.dragHelperElement.dragDrop(),setTimeout(t.onDragEnd,0)))},this.onMouseUp=function(e){t.removeMouseMoveAndUpEventListeners()},this.onDragStartHelperElement=function(e){var n=e;n.stopPropagation(),n.dataTransfer.effectAllowed="copyMove",t.setDragStateAndData(n),t.onDragStartInternal(n.pageX,n.pageY)},this.removeMouseMoveAndUpEventListeners=function(){document.body.removeEventListener("mousemove",t.onMouseMove),document.body.removeEventListener("mouseup",t.onMouseUp)},this.removeDragHelperElement=function(){if(document.body)document.body.contains(t.dragHelperElement)&&(document.body.removeChild(t.dragHelperElement),t.dragHelperElement=null);else{var e=t.dragHelperElement?t.dragHelperElement.innerHTML:"null";d.d("removeDragHelperElement: "+e)}}}return e.prototype.updateProps=function(e){this.props=e},e.prototype.onUnmount=function(){this.onDragEnd(null),u.a||this.removeMouseMoveAndUpEventListeners(),this.div.removeEventListener("mousedown",this.onMouseDown)},e.prototype.getDiv=function(){return this.div},e.prototype.onDragStartInternal=function(e,t){this.isDragging=!0;var n=this.props.onDragStart;n&&n(this.props.getDragData(),e,t)},e.prototype.setDragStateAndData=function(e){this.props.dragViewState&&i(this.props.dragViewState,!0);var t=this.props.getDragData();try{e.dataTransfer.setData(t.itemType,JSON.stringify(t))}catch(n){e.dataTransfer.setData("text",JSON.stringify(t))}Object(c.c)(t.itemType)},e.prototype.resetDragStateAndData=function(){this.props.dragViewState&&i(this.props.dragViewState,!1),Object(c.c)(null),Object(c.d)(null)},e.prototype.overrideDefaultDragPreviewImage=function(e){if(u.a){this.dragHelperElement=this.getDragHelperElement(),document.body.appendChild(this.dragHelperElement);var t=this.props.xOffset?this.props.xOffset:0,n=this.props.yOffset?this.props.yOffset:0;e.setDragImage(this.dragHelperElement,t,n)}},e.prototype.overrideDefaultNoDragImage=function(e){u.a&&(this.dragHelperElement=document.createElement("div"),this.dragHelperElement.style.display="none",document.body.appendChild(this.dragHelperElement),e.setDragImage(this.dragHelperElement,0,0))},e.prototype.getDragHelperElement=function(){var e=this.props.getDragPreview(this.props.getDragData());return e.style.top="0px",e.style.left="0px",e.style.zIndex="-1000",e.style.position="fixed",e},e.prototype.isDragAllowed=function(){return!this.props.canDrag||this.props.canDrag()},e}();t.b=a.forwardRef((function(e,t){a.useEffect((function(){return function(){n.current.onUnmount()}}),[]);var n=a.useRef(new f(e));return n.current.updateProps(e),a.useImperativeHandle(t,(function(){return{getDiv:function(){return n.current.getDiv()}}}),[]),u.a?a.createElement("div",Object(r.__assign)({draggable:!e.isDraggable||e.isDraggable()},Object(l.b)(e.ariaProps),{className:e.classNames,ref:n.current.refCallback,onDragStart:n.current.onDragStart,onDragEnd:n.current.onDragEnd}),e.children):a.createElement("div",Object(r.__assign)({className:e.classNames,ref:n.current.refCallback},Object(l.b)(e.ariaProps)),e.children)}))},1477:function(e,t,n){"use strict";var r=n(0),a=n(254),o=n(2937),i=n(991),c=n(2336),u=n(2633),s=n(76),d=n(2432),l=n(283),f=n(1927),p=n(1788),m=n(2082),b=n(1107),v=Object(l.action)("updateIsViewingInProviderSupported")((function(e,t){e.strategy.isViewingInProviderSupported=t}));n.d(t,"d",(function(){return h})),n.d(t,"c",(function(){return j})),n.d(t,"b",(function(){return w}));t.a=Object(l.action)("saveToCloud")((function(e,t,n,a,o){var i=Object(r.__read)(g(e,t,n,a,!1,o),2),c=i[0],s=i[1];Object(u.b)(e.attachmentId,null,c,s)}));function h(e,t,n,a,o,i){var c=Object(r.__read)(g(e,t,n,a,!0,i),2),s=c[0],d=c[1];Object(u.c)(e.attachmentId,s,d,o)}function g(e,t,n,r,o,i,c){var u=new a.a("AttachmentSaveToCloud");f.a.run(2,e.attachmentId,c),j(e,o);return[function(a){var o=0===a.ResultCode;return w(e,o,o?a.Item.Location:null,c),t(o),O(u,e.attachmentId,a.ResultCode,"ServerError",a.Exception,n,r,i),!0},function(a,o,c,s){w(e,!1,null,s),t(!1),O(u,e.attachmentId,o,c,a,n,r,i)}]}function O(e,t,n,r,o,u,l,f){var p=Object(i.a)(t);e.addCustomData({entryPoint:u,result:n});var m=Object(c.a)(p);e.addCosmosOnlyData(JSON.stringify({size:p.model.Size,fileType:m})),0===n?e.end():e.endWithError(r,new Error(o)),Object(s.h)("doc-attachment-sigs")&&Object(d.a)(null==l?void 0:l.Id).then((function(e){a.l.importAndExecute("SavedAttachment",{itemId:e,customProperties:{FileId:t.Id,FileType:m,Destination:"Cloud",Sender:f}})}))}function j(e,t){void 0===t&&(t=!1);var n=t?18:1;Object(b.a)(e,2,n)}function w(e,t,n,r){if(t){Object(p.a)(e,2),Object(o.a)(e.attachmentId,n),f.a.run(3,e.attachmentId,r);var a=Object(m.b)(!1,!1,n);v(e,a)}else f.a.run(4,e.attachmentId,r);Object(b.a)(e,0,t?3:4)}},15197:function(e,t,n){"use strict";n.r(t);var r=n(42),a=n(432),o=n(687),i=n(100),c=n(254),u=n(2152),s=n(4),d=Object(s.mutatorAction)("setConversationAttachmentWellVisible",(function(e,t){e.isVisible=t})),l=n(9),f=n(9340),p=n(1),m=n(0),b=n(7988),v=Object(s.mutatorAction)("updateConversationAttachmentWellMaxHeight",(function(e){e.maxHeight=(window.innerHeight||document.body.clientHeight)-200})),h=n(9973),g=n(1416),O=n(14),j=n(579),w=n(305),I=n(3481),_=n(78),x=n(1069),S=n(6660),C=n(9342),y=n(9924),A=n(9628),P=n(1036),T=n(991),E=n(3230),k=n(3911),D=n(1476),R=n(1053),N=n(76),M=n(966),V=n(1617),L=n(6417),H=n(555),W=n(1137),B=n(79),z=n(13752),F=n(308).bind(z),U=Object(r.a)((function(e){var t=p.useRef(),n=p.useRef();p.useEffect((function(){if(n.current&&(n.current=!1,e.attachmentViewState.shouldShowContextMenu)){var r=t.current.parentElement.clientHeight,a=t.current.parentElement.scrollTop,o=t.current.offsetHeight,i=t.current.offsetTop;o+i>r+a?t.current.parentElement.scrollTop=o+i-r:i<a&&(t.current.parentElement.scrollTop=i)}}));var r=function(n){var r=Object(x.e)(e.attachmentViewState.strategy);if(r!==x.a.NoAction){var a=C.d.OnClick,o=a.name,i=a.customData;Object(c.o)(o,i(r)),Object(E.c)(e.attachmentViewState,W.c.ConversationAttachmentWell,e.instrumentationContext,e.parentItemId,!1,e.onBeforePreview,e.createImageGallery,t.current.parentElement)}},a=function(){var t;null===(t=e.onFocus)||void 0===t||t.call(e,e.attachmentViewState.attachmentId.Id)},o=Object(T.a)(e.attachmentViewState.attachmentId),i=!!o&&13===o.attachmentClass&&Object(N.h)("cal-ics-preview");return p.createElement("div",{"aria-label":o.model.Name,ref:t,onFocus:a,onKeyDown:function(e){e.keyCode!==_.a.enter&&e.keyCode!==_.a.space||r()},onMouseOver:a,className:F(z.container,{active:e.attachmentViewState.shouldShowContextMenu}),tabIndex:0,"data-is-focusable":!0,onClick:r,onContextMenu:function(t){t.preventDefault(),Object(u.a)(e.attachmentViewState,n.current=!0)}},p.createElement(D.b,{canDrag:function(){return!!Object(T.a)(e.attachmentViewState.attachmentId)},getDragData:function(){var t=Object(T.a)(e.attachmentViewState.attachmentId).model,n=Object(S.a)(t);return{itemType:R.a.Attachment,attachmentFile:n}},getDragPreview:function(){var t=document.createElement("div");return t.className=z.dragPreview,t.innerText=Object(T.a)(e.attachmentViewState.attachmentId).model.Name,t},xOffset:-12,yOffset:5},p.createElement("div",{className:z.innerContainer},function(t){var n=P.o.tryImportForRender();if(null==n?void 0:n(t.model)){var r=t.model.Name,a=Object(V.e)(r),o=null,i=Object(O.getIconClassName)("Photo2");return Object(M.h)(r)&&(o=a.small,i=a.small),p.createElement("div",{className:z.thumbnailDiv},p.createElement(k.d,{attachmentViewState:e.attachmentViewState,placeHolderCSSClass:F(i,z.placeholder),fileIconCssClass:o,imageLoadErrorCSSClass:a.small,thumbnailWidth:32,thumbnailHeight:32}))}return p.createElement(k.c,{attachmentId:e.attachmentViewState.attachmentId})}(o),function(t){var n=1!==t.type&&0===e.attachmentViewState.actionMessage?{text:Object(H.a)(e.itemReceivedTime),title:null,shouldDisplaySuccessIcon:!1,shouldDisplayFailureIcon:!1}:Object(y.a)(e.attachmentViewState,t,!1);return p.createElement("div",{className:z.infoDiv},p.createElement("div",{className:F(z.firstLine,z.textOverFlow),title:t.model.Name},t.model.Name),p.createElement("div",{className:F(z.secondLine,z.textOverFlow),title:n.title},n.shouldDisplaySuccessIcon?p.createElement(w.a,{iconName:"Accept",className:F(z.icon,z.success)}):null,n.shouldDisplayFailureIcon?p.createElement(w.a,{iconName:"Cancel",className:F(z.icon,z.failure)}):null,n.text))}(o),e.attachmentViewState.strategy.showActionsMenu&&e.attachmentViewState.shouldShowActionsContainer&&p.createElement("div",{className:z.actionsContainer},p.createElement(C.a,{attachmentViewState:e.attachmentViewState,isForImageView:!1,previewState:W.a.None,shouldNotHandleOnBlur:!0,action:i?C.c.addToCalendar:C.c.download,parentItemId:e.parentItemId}),p.createElement(j.a,{"data-is-focusable":!1,className:z.menuButton,onClick:function(t){t.stopPropagation(),Object(u.a)(e.attachmentViewState,n.current=!e.attachmentViewState.shouldShowContextMenu)},title:Object(l.b)(L.a),ariaLabel:Object(l.b)(L.a),onKeyDown:X,iconProps:{iconName:e.attachmentViewState.shouldShowContextMenu?"ChevronUp":"ChevronDown",styles:{root:z.icon}}})))),Object(A.a)(e.attachmentViewState)?p.createElement("div",{className:z.progressIndicator},p.createElement(I.a,{percentComplete:e.attachmentViewState.actionCompletePercent})):null,e.attachmentViewState.shouldShowContextMenu?function(n){var r=C.e.tryImportForRender(),a=r?r(e.attachmentViewState,n,{viewState:e.attachmentViewState,previewPaneSelectionSource:W.c.ConversationAttachmentWell,parentItemId:e.parentItemId,isDraft:!1,isEdit:!1,onBeforePreview:e.onBeforePreview,createImageGallery:e.createImageGallery,instrumentationContext:e.instrumentationContext,sxsId:null,targetWindow:window},e.parentItemId,null,t.current.parentElement,null):[];return p.createElement("div",null,a.map((function(t){return p.createElement(J,{key:t.key,attachmentViewState:e.attachmentViewState,menuItem:t})})))}(o):null)})),J=Object(r.a)((function(e){var t=p.useCallback((function(t){t.stopPropagation(),e.menuItem.onClick(t,e.menuItem),Object(u.a)(e.attachmentViewState,!1)}),[e.menuItem,e.attachmentViewState]),n=p.useCallback((function(t){t.keyCode!==_.a.enter&&t.keyCode!==_.a.space||(t.stopPropagation(),e.menuItem.onClick(),Object(u.a)(e.attachmentViewState,!1))}),[e.menuItem,e.attachmentViewState]);return p.createElement("div",{tabIndex:0,"data-is-focusable":!0,className:z.menuItem,onClick:t,onKeyDown:n},e.menuItem.name)}));function X(e){e.keyCode!==_.a.enter&&e.keyCode!==_.a.space||(B.g.info("AttachmentMenuButton.keyDown enter|space"),e.stopPropagation())}var q=n(13754),G=n(308).bind(q),K=Object(r.a)((function(e){var t=this;p.useEffect((function(){return r(),g.a.importAndExecute(r),function(){g.c.importAndExecute(r)}}),[]);var n=function(t){e.viewState.docViewAttachments.forEach((function(e){Object(b.a)(e,e.attachmentId.Id===t),e.shouldShowContextMenu&&e.attachmentId.Id!==t&&Object(u.a)(e,!1)}))},r=function(){v(e.viewState)},a=function(){return Object(m.__awaiter)(t,void 0,void 0,(function(){return Object(m.__generator)(this,(function(t){return[2,Object(h.a)(e.viewState,!0)]}))}))},o=!1,i=null,c=null,s=function(){var t=null==i?void 0:i.nextElementSibling;null==t||t.focus(),n(e.viewState.docViewAttachments[0].attachmentId.Id)};return p.createElement("div",{className:G("disableTextSelection","customScrollBar",q.container),style:{maxHeight:e.viewState.maxHeight+"px"}},p.createElement("div",{ref:function(e){return i=e},tabIndex:0,onFocus:function(){if(o){var t=null==c?void 0:c.previousElementSibling;null==t||t.focus(),n(e.viewState.docViewAttachments[e.viewState.docViewAttachments.length-1].attachmentId.Id)}else o=!0,s()}}),e.viewState.docViewAttachments.map((function(t){return p.createElement(U,{key:"convoWell_"+t.attachmentId.Id,attachmentViewState:t,parentItemId:e.viewState.parentItemIdMap[t.attachmentId.Id],itemReceivedTime:e.viewState.itemReceivedTimeMap[t.attachmentId.Id],instrumentationContext:e.instrumentationContext,onBeforePreview:e.onBeforePreview,onFocus:n,createImageGallery:a})})),p.createElement("div",{ref:function(e){return c=e},tabIndex:0,onFocus:s}))})),Q=n(13756),Y=n(13757),Z=Object(r.a)((function(e){p.useEffect((function(){!n.current&&e.viewState.docViewAttachments.length>0&&(n.current=!0,Object(c.o)("ConversationAttachmentWellButtonShown"))}));var t=p.useRef(),n=p.useRef(!1),r=function(){d(e.viewState,!1),e.viewState.docViewAttachments.forEach((function(e){Object(u.a)(e,!1)}))},s=e.viewState.docViewAttachments.length;if(0===s)return null;var m,b=s+(e.canLoadMore?"+":"");return p.createElement("div",{className:e.className||""},p.createElement("div",{ref:function(e){return t.current=e}},p.createElement(a.a,{onClick:function(){e.viewState.isVisible?r():(d(e.viewState,!0),Object(c.o)("ConversationAttachmentWellButtonClicked",null,{cosmosOnlyData:JSON.stringify({numberOfAttachments:e.viewState.docViewAttachments.length})}))},text:b,className:Y.button,iconProps:{iconName:"Attach",styles:{root:Y.icon}},menuIconProps:{iconName:"ChevronDown",styles:{root:Y.menuIcon}},ariaLabel:(m=e.viewState.docViewAttachments.length,m>1?Object(l.c)(Object(l.b)(f.a),m):Object(l.c)(Object(l.b)(Q.a),m)),styles:{label:Y.label}})),e.viewState.isVisible?p.createElement(o.a,{setInitialFocus:!0,isBeakVisible:!1,target:t.current,onDismiss:r,directionalHint:i.DirectionalHint.bottomRightEdge},p.createElement(K,{viewState:e.viewState,instrumentationContext:e.instrumentationContext,onBeforePreview:r})):null)}));n.d(t,"ConversationAttachmentWellButton",(function(){return Z}))},1570:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));var r=5,a="undefined"!=typeof window&&window.hasOwnProperty("DataTransfer")&&DataTransfer.prototype.setDragImage},1605:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(25),a=n(1296);function o(e,t){return void 0===e||e.__type||(e=Object(a.a)(e)),Object(r.a)("FetchDataProviderResource",e,t)}},1617:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(108),a=n(1152);n.d(t,"e",(function(){return a.a})),n.d(t,"b",(function(){return a.b}));var o=n(1463);n.d(t,"d",(function(){return o.a}));var i=n(1270);n.d(t,"c",(function(){return i.a}));var c=new r.c((function(){return n.e(267).then(n.bind(null,2904))})),u=Object(r.d)(c,(function(e){return e.CloudIconWithOverlay}))},1646:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(25);function a(e,t){return Object(r.a)("GetWacAttachmentInfo",e,t)}},1650:function(e,t,n){"use strict";var r=n(0),a=n(428),o=n(1062);function i(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,c,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=t||Object(a.a)(),i={subscriptionId:n,requiresExplicitSubscribe:!1,subscriptionParameters:null,noSubscriptionFailureReload:!0},c=function(t){e(t)&&o.g.importAndExecute(i,c)},[4,o.f.import()];case 1:return r.sent()(i,c),[4,o.b.import()];case 2:return u=r.sent()(),[2,[n,i,c,u]]}}))}))}n.d(t,"a",(function(){return i}))},1705:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.InProgress=0]="InProgress",e[e.Failed=1]="Failed",e[e.Succeeded=2]="Succeeded"}(r||(r={}))},1747:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),a=Object(r.action)("REFRESH_EXPIRATION_DATE",(function(e){return{id:e}}))},1748:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.ignore=0]="ignore",e[e.refreshExpiration=1]="refreshExpiration",e[e.changePermission=2]="changePermission",e[e.attachAsACopy=3]="attachAsACopy"}(r||(r={}))},1751:function(e,t,n){"use strict";var r=n(283);t.a=Object(r.action)("setShouldShowImageOverlay")((function(e,t){e.shouldShowImageOverlay=t}))},1787:function(e,t,n){"use strict";n.d(t,"b",(function(){return s}));var r=n(0),a=n(314),o=n(1862),i=n(295);var c=Object(o.a)((function(e){switch(e){case 0:return t={supportViewInProvider:!1,supportConvertCloudyToClassic:!1},Object(r.__assign)(Object(r.__assign)({},t),{supportViewInProvider:!0,supportConvertCloudyToClassic:!0});case 1:return function(){var e={supportViewInProvider:!1,supportConvertCloudyToClassic:!1};return Object(r.__assign)(Object(r.__assign)({},e),{supportConvertCloudyToClassic:Object(i.a)()})}();case 3:case 2:case 6:case 5:return{supportViewInProvider:!1,supportConvertCloudyToClassic:!1};case 7:case 8:case 9:case 4:case 10:return{supportViewInProvider:!1,supportConvertCloudyToClassic:!1};default:return Object(a.a)(e)}var t})),u=c.getDataProviderInfo,s=c.getDefaultDataProviderInfo;t.a=u},1788:function(e,t,n){"use strict";var r=n(283);t.a=Object(r.action)("addCompletedAction")((function(e,t){e.completedActions.push(t)}))},1789:function(e,t,n){"use strict";var r=n(283);t.a=Object(r.action)("setInlineAttachmentStatus")((function(e,t){e.status=t}))},1839:function(e,t,n){"use strict";function r(e){return 1===e.attachmentType}n.d(t,"a",(function(){return r}))},1840:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),a=n(1069),o=n(1077);function i(e,t,n,i,c,u,s){void 0===c&&(c=o.a.Unknown),void 0===u&&(u=!1),void 0===s&&(s=null);var d=Object(a.c)(e,t,i,u,c,s),l=d.strategy;return Object(r.__assign)(Object(r.__assign)({},d),{attachmentType:0,strategy:Object(r.__assign)(Object(r.__assign)({},l),{isSaveToCloudSupported:!1,isViewingInProviderSupported:!1,isOpeningInProviderSupported:!1,isOpeningByLinkSupported:!1,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!1,supportedMenuActions:[]}),shouldShowContextMenu:!1,shouldShowImageOverlay:!1,shouldShowActionsContainer:!1,ongoingAction:n?0:1,completedActions:[],actionMessage:0,actionCompletePercent:n?1.1:.01})}},1894:function(e,t,n){"use strict";var r=n(4),a=n(123),o=Object(r.action)("addCalendarEventsAttachment",(function(e,t){return Object(a.c)({name:"AttachmentAddCalendarEvent",customData:{addToCalendarSource:t}},{attachment:e})}));t.a=o},1927:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=null,a={register:function(e){r=e},run:function(e,t,n){r&&r(e,t,n)}}},1939:function(e,t,n){"use strict";function r(e){window.open(e,"_blank")}n.d(t,"a",(function(){return r}))},1981:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.OneDrivePro=0]="OneDrivePro",e[e.OneDriveConsumer=1]="OneDriveConsumer",e[e.Dropbox=2]="Dropbox",e[e.Box=3]="Box",e[e.GDrive=5]="GDrive",e[e.OfficeOneDrivePro=31]="OfficeOneDrivePro"}(r||(r={}))},2030:function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"b",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return l}));var r=n(108),a=n(1981);n.d(t,"a",(function(){return a.a}));var o=new r.c((function(){return Promise.all([n.e(44),n.e(270)]).then(n.bind(null,4004))})),i=new r.b(o,(function(e){return e.createGetSharingInfoResponse})),c=new r.b(o,(function(e){return e.checkSharingLinkUrlDomain})),u=new r.b(o,(function(e){return e.getLinkProviderType})),s=new r.b(o,(function(e){return e.isOneDriveProRelatedLink})),d=new r.b(o,(function(e){return e.convertToAttachmentDataProviderType})),l=new r.b(o,(function(e){return e.convertToLinkProviderType}))},2082:function(e,t,n){"use strict";var r=n(0),a=n(9),o=n(1115),i=n(1074),c=n(314),u=n(1069);function s(e){switch(e){case i.a.Download:return u.a.Download;case i.a.OpenInNewTab:return u.a.OpenInNewTab;case i.a.Preview:return u.a.Preview;case i.a.ImportCalendarEventAttachment:case i.a.ChangePermissions:case i.a.CopyLink:case i.a.SaveToCloud:case i.a.ViewInProvider:case i.a.ConvertClassicToCloudy:case i.a.ConvertCloudyToClassic:case i.a.MoveAttachmentToInline:case i.a.RefreshLink:case i.a.IgnoreExpiration:return null;default:return Object(c.a)(e)}}function d(e){switch(e){case u.a.Download:return i.a.Download;case u.a.OpenInNewTab:return i.a.OpenInNewTab;case u.a.Preview:return i.a.Preview;case u.a.NoAction:return null;default:return Object(c.a)(e)}}var l=n(1787);var f=n(1036),p=n(295),m=n(1489);function b(e,t,n,a,i,c,p,b,h,g,O){var j=Object(u.d)(t,n,a,g);!function(e,t){var n=Object(m.c)();0===n?e.supportedOpenActions=e.supportedOpenActions.filter((function(e){return e!==u.a.Download})):1===n&&(e.supportedOpenActions=e.supportedOpenActions.filter((function(e){return e!==u.a.Download&&e!==u.a.Preview})));var r=function(e,t,n){void 0===n&&(n=!1);var r=e.filter((function(e){return-1!==t.indexOf(e)}));return n&&(r=r.filter((function(e,t,n){return n.indexOf(e)===t}))),r}(e.supportedOpenActions.map(d).filter((function(e){return!!e})),t);e.supportedOpenActions=r.map(s)}(j,b);var w,I=function(e){return e.__type===f.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE}(a),_=g&&function(e){return e.__type===f.a.attachmentTypes.LINK_ATTACHMENT_TYPE}(a),x=Object(o.d)(a,I||_,h,O),S=I,C=v(I,_,c),y=function(e,t,n){return e.convertClassicToCloudyEnabled&&!t&&!n}(e,I||_,h),A=function(e,t,n,r,a){if(e.convertCloudyToClassicEnabled&&t&&!n&&r){var o=Object(l.a)(a);return(null==o?void 0:o.supportConvertCloudyToClassic)||!1}return!1}(e,I,h,p,i),P=function(e,t,n,r){return 2===e&&!t&&!n&&!r}(n,I,_,h);switch(n){case 2:case 3:case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 12:case 13:w=function(e,t,n,a,o,i,c,u){return Object(r.__assign)(Object(r.__assign)({},e),{isSaveToCloudSupported:t,isOpeningByLinkSupported:n,isOpeningInProviderSupported:a,isViewingInProviderSupported:o,isConvertClassicToCloudySupported:i,isConvertCloudyToClassicSupported:c,isMoveAttachmentToInlineSupported:u,showActionsMenu:!0,supportedMenuActions:[]})}(j,x,I||_,S,C,y,A,P);break;case 1:w=function(e){return Object(r.__assign)(Object(r.__assign)({},e),{isSaveToCloudSupported:!1,isOpeningByLinkSupported:!1,isOpeningInProviderSupported:!1,isViewingInProviderSupported:!1,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!1,supportedMenuActions:[]})}(j);break;default:w=I?function(e,t,n,a){return Object(r.__assign)(Object(r.__assign)({},e),{isSaveToCloudSupported:!1,isOpeningByLinkSupported:!0,isOpeningInProviderSupported:t,isViewingInProviderSupported:n,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:a,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!0,supportedMenuActions:[]})}(j,S,C,A):function(e,t,n,a){return Object(r.__assign)(Object(r.__assign)({},e),{isSaveToCloudSupported:t,isViewingInProviderSupported:n,isOpeningInProviderSupported:!1,isOpeningByLinkSupported:!1,isConvertClassicToCloudySupported:a,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!0,supportedMenuActions:[]})}(j,x,C,y)}return w.supportedMenuActions=b,w}function v(e,t,n){if(e||t)return!1;var r=Object(p.a)(),o=Object(l.b)(r);return!Object(a.f)(n)&&(r||(null==o?void 0:o.supportViewInProvider))}n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return v}))},2083:function(e,t,n){"use strict";var r=n(2140),a=n(966),o=n(2141),i=n(1115);function c(e){var t=Object(i.b)(e,!0),n=Object(a.b)(e.Name);return Object(o.a)(t,e,n)}function u(e){var t=Object(a.b)(e.Name);return c(e)&&t&&(".pdf"===t.toLowerCase()&&Object(r.a)()||Object(a.g)(e.Name))}var s=n(2270),d=n(1939),l=n(108);n.d(t,"e",(function(){return p})),n.d(t,"d",(function(){return m})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return s.a})),n.d(t,"f",(function(){return d.a}));var f=new l.c((function(){return Promise.all([n.e(4),n.e(17),n.e(135)]).then(n.bind(null,15291))})),p=new l.a(f,(function(e){return e.print})),m=new l.a(f,(function(e){return e.download}))},2152:function(e,t,n){"use strict";var r=n(283);t.a=Object(r.action)("setAttachmentShouldShowContextMenu")((function(e,t){e.shouldShowContextMenu=t}))},2154:function(e,t,n){"use strict";var r=n(1405),a=n(0),o=n(1293),i=n(1051);var c=n(2715);function u(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t;return Object(a.__generator)(this,(function(n){switch(n.label){case 0:return e.strategy.previewMethod!==i.a.Wac?[3,2]:[4,Object(c.a)(e.attachmentId,!1)];case 1:9!==(t=n.sent()).Status&&6!==t.Status||(r=e.strategy).previewMethod===i.a.Wac&&(r.previewMethod=i.a.Unsupported,r.supportedOpenActions=r.supportedOpenActions.filter((function(e){return e!==o.a.Preview}))),n.label=2;case 2:return[2]}var r}))}))}var s=n(1840),d=n(1077),l=n(1298),f=n(2059),p=n(991);function m(e,t,n,a,o,i,c,m,b){void 0===c&&(c=null),void 0===b&&(b=!1),Object(f.a)([{attachmentId:e,attachment:t}],n,o);var v=Object(p.a)(e),h=Object(s.a)(e,n,a,1===v.type,d.a.Unknown,!1,c);if(Object(r.a)(h,v,!1,m,i),b){var g=v.model.ProviderType;Object(l.b)(h.isCloudy,g,v.model.Name)||u(h)}return h}n.d(t,"a",(function(){return m}))},2245:function(e,t,n){"use strict";function r(e,t){t&&e&&(e.addCustomData({httpStatusCode:t.status}),function(e,t){t&&e&&e.addCustomData({frontendServer:t.get("x-feserver"),requestId:t.get("request-id"),backendServer:t.get("x-beserver"),backendHttpStatus:t.get("x-backendhttpstatus"),serverVersion:t.get("x-owa-version")})}(e,t.headers))}function a(e){return e&&void 0!==e.fetchErrorType}function o(e,t){e.addCustomProperty("ErrorInformation",t)}function i(e,t){o(e,t?"Empty response from server":"Null response from server")}n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return i}))},2270:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1939),a=n(60);function o(e,t,n,o){var i;if(t||Object(a.g)())Object(r.a)(e);else{var c=document.createElement("a");c.style.display="none",c.href=e,c.download=o||"",n||(n=(null===(i=document.activeElement)||void 0===i?void 0:i.parentElement)||document.body),n.appendChild(c),c.click(),n.removeChild(c)}}},2336:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(966);function a(e){var t="";return(null==e?void 0:e.model)&&(t=Object(r.c)(e.model.Name||"")||e.model.ContentType||""),t}},2391:function(e,t,n){"use strict";var r=n(283);t.a=Object(r.action)("setOngoingAction")((function(e,t){e.ongoingAction=t}))},2432:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(0),a=n(296),o=n(629),i=n(553),c=n(484),u=n(630),s=n(246),d=n(79),l="0xe0b",f=Object(a.a)({PropertyTag:l,PropertyType:"Binary"});function p(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a,o,i,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=null,a=Object(c.a)({BaseShape:"IdOnly",AdditionalProperties:[f]}),[4,m([e],a)];case 1:return o=r.sent(),"Success"===(null===(t=null==o?void 0:o[0])||void 0===t?void 0:t.ResponseClass)&&(i=o[0],u=i.Items[0],n=function(e,t){var n;if(e){var r=e.ExtendedProperty;if(r)for(var a=r.length,o=0;o<a;o++){var i=r[o];if((null===(n=i.ExtendedFieldURI)||void 0===n?void 0:n.PropertyTag)===t)return i}}return null}(u,l)),n?[2,n.Value]:(d.g.info("[getImmutableEntryId] extendedProperty could not be retrieved"),[2,null])}}))}))}function m(e,t){var n=Object(s.a)(),r=e.map((function(e){return Object(i.a)({Id:e})}));return Object(u.a)({Header:n,Body:Object(o.a)({ItemShape:t,ItemIds:r})}).then((function(e){var t,n;return null===(n=null===(t=null==e?void 0:e.Body)||void 0===t?void 0:t.ResponseMessages)||void 0===n?void 0:n.Items})).catch((function(e){return d.g.warn("GetItem:"+e.message),null}))}},2496:function(e,t,n){"use strict";var r=n(1126),a=n(283);t.a=Object(a.action)("deleteAttachment")((function(e){Object(r.a)().attachments.delete(e.Id)}))},2497:function(e,t,n){"use strict";function r(e){return 0!==e.actionMessage}n.d(t,"a",(function(){return r}))},2541:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"FileAttachment:#Exchange"},e)}},2633:function(e,t,n){"use strict";var r=n(0),a=n(1036),o=n(254),i={},c=5e3,u=12;function s(e,t,n,s,l){var f=new o.a("SaveToCloudProgressManager"),p=setInterval((function(){!function(e,t,n,o,i,c,u){Object(r.__awaiter)(this,void 0,void 0,(function(){var s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(s=u[e])?(s.counter++,s.counter>c?(d(e,u),s.datapoint.addCustomData({operationId:e,counter:s.counter}),s.datapoint.endWithError("Timeout"),i&&i(),[2]):[4,a.g.import()]):[2];case 1:return r.sent()(t,n,e,0,(function(e){o&&o(e.NotificationPayloads)})),[2]}}))}))}(n,e,t,s,l,u,i)}),c);i[n]={timer:p,counter:0,datapoint:f}}function d(e,t){void 0===t&&(t=null),t||(t=i);var n=t[e];if(n){clearInterval(n.timer);var r=n.datapoint;r.addCustomData({operationId:e,counter:n.counter}),r.end(),delete t[e]}}var l=n(4),f=Object(l.action)("cancelSaveAttachmentsToCloud",(function(e){return{operationId:e}}));Object(l.orchestrator)(f,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){return d(e.operationId),[2]}))}))}));var p=Object(l.action)("saveAttachmentsToCloud",(function(e,t,n,r,a,o,i,c,u){return{attachmentId:e,itemId:t,notificationHandler:n,serviceCallFailureCallback:r,operationCreatedCallback:a,folderId:o,attachmentIds:i,showProgressBar:c,subscriptionId:u}})),m=n(114);function b(e){return Object(r.__assign)({__type:"SaveAttachmentsToCloudRequest:#Exchange"},e)}var v=n(25);function h(e,t,n,r,a,o,i){var c,u,s=function(e,t,n,r,a,o,i){return b({ewsAttachmentId:e,itemId:t,subscriptionId:n,groupSmtpAddress:a,channelId:r,folderItemId:o,attachmentIds:i})}(e,t,n,r,(null==a?void 0:a.type)===m.a.GroupMailbox?a.mailboxSmtpAddress:null,o,i);return c={requestObject:s},u=null==a?void 0:a.requestOptions,void 0===c.requestObject||c.requestObject.__type||(c.requestObject=b(c.requestObject)),Object(v.a)("SaveAttachmentsToCloud",c,u)}var g=n(1650),O=n(1062);Object(l.orchestrator)(p,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,a,o,i,c,u,l,f;return Object(r.__generator)(this,(function(p){switch(p.label){case 0:return t=!1!==e.showProgressBar,!(n=e.attachmentId||e.itemId)&&e.attachmentIds.length>0&&(n=e.attachmentIds[0]),a=function(r){if(!r||"Reload"===r.EventType)return!1;if(23===r.ResultCode)return!1;var a=e.notificationHandler(r);return t&&a&&(d(n.Id),t=!1),a},o=e.subscriptionId,[4,Object(g.a)(a,o)];case 1:return i=r.__read.apply(void 0,[p.sent(),4]),c=i[0],u=i[1],l=i[2],f=i[3],function(e,t,n,a,o,i,c,u,s){Object(r.__awaiter)(this,void 0,void 0,(function(){var d;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,h(e?e.Id:null,t?t.Id:null,n,i,j(t,e,s),u,s?s.map((function(e){return e.Id})):null)];case 1:return[2,r.sent()];case 2:return d=r.sent(),c(d,1,"ServerError"),O.g.importAndExecute(a,o),[2,null];case 3:return[2]}}))}))}(e.attachmentId,e.itemId,c,u,l,f,e.serviceCallFailureCallback,e.folderId,e.attachmentIds),t&&s(e.attachmentId,e.itemId,n.Id,(function(e){e.forEach((function(e){a(e)}))}),(function(){e.serviceCallFailureCallback("Progress manager timeout. OperationId = "+n,3,"Timeout")})),e.operationCreatedCallback&&e.operationCreatedCallback(n.Id,u,l),[2]}}))}))}));function j(e,t,n){return e?e.mailboxInfo:t?t.mailboxInfo:n[0].mailboxInfo}function w(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return o=function(n){if(!n||"Reload"===n.EventType)return!1;if(23===n.ResultCode)return!1;var r=t(n);return r&&d(e.Id),r},[4,Object(g.a)(o,a)];case 1:return r.sent(),s(e,null,e.Id,(function(e){e.forEach((function(e){o(e)}))}),(function(){n("Progress manager timeout. OperationId = "+e.Id,3,"Timeout")})),[2]}}))}))}n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return w}))},2715:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(0),a=n(254),o=n(2245),i=n(2793),c={},u={},s=[],d=0,l=2;function f(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,c;return Object(r.__generator)(this,(function(u){return i=new a.a("InitializeWacUrl"),n&&i.addCustomProperty("actionSource",n),(c=m(e,t,i))?[2,c]:[2,new Promise((function(a,c){var u={attachmentId:e,isEdit:t,actionSource:n,datapoint:i,resolve:a,reject:c};o?p(u):(s.push(u),function e(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:if(!s.length)return[2];if(d>=l)return[2];t=s.shift(),d++,n.label=1;case 1:return n.trys.push([1,,3,4]),[4,p(t)];case 2:return n.sent(),[3,4];case 3:return d--,e(),[7];case 4:return[2]}}))}))}())}))]}))}))}function p(e){var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,s,d,l,f,p,b,v,h;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(a=e.attachmentId,s=e.isEdit,d=e.actionSource,l=e.datapoint,f=e.resolve,p=e.reject,b=m(a,s,l))return f(b),[2];l.addCustomProperty("ReturnFromCache",!1),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(i.a)(a.Id,s,null,null===(t=a.mailboxInfo)||void 0===t?void 0:t.requestOptions,d)];case 2:return 0===(v=r.sent()).Status&&((s?u:c)[a.Id]={expireTime:(new Date).getTime()+36e5,value:v}),v.WacUrl||l.addCustomProperty("WacUrlIsEmpty",!0),l.addCustomProperty("WacAttachmentResponseStatus",null===(n=v.Status)||void 0===n?void 0:n.toString()),l.end(),f(v),[3,4];case 3:return h=r.sent(),Object(o.a)(h)&&Object(o.c)(l,h.response),Object(o.d)(l,h.toString()),l.endWithError("ServerError"),p(h),[3,4];case 4:return[2]}}))}))}function m(e,t,n){var r=t?u:c,a=r[e.Id];if(a){if(a.expireTime>=(new Date).getTime())return n.addCustomProperty("ReturnFromCache",!0),n.end(),a.value;delete r[e.Id]}return null}},2793:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1646);function a(e,t,n,a,o){if(o){var i="getWacAttachmentInfo"+o;(a=a||{}).headers=a.headers||new Headers,a.headers.set("X-OWA-ActionName",i)}return Object(r.a)({attachmentId:e,isEdit:t,draftId:n,appId:null},a)}},2806:function(e,t,n){"use strict";var r=n(0),a=n(431),o=n(25);function i(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"ImportCalendarEventJsonRequest:#Exchange"},n)),Object(o.a)("ImportCalendarEvent",e,t)}var c=n(1020),u=n(246),s=n(315);function d(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var d,l;return Object(r.__generator)(this,(function(f){switch(f.label){case 0:return o?[4,Object(s.e)(o)]:[3,2];case 1:l=f.sent(),d={headers:l.headers,authNeededOnUnAuthorized:l.authNeededOnUnAuthorized},f.label=2;case 2:return[2,i({Header:Object(u.a)(),Body:(p={Content:e,ImportedItemFolderId:Object(c.a)({BaseFolderId:Object(a.a)({Id:t})}),AttachmentId:n},Object(r.__assign)({__type:"ImportCalendarEventRequest:#Exchange"},p))},Object(r.__assign)({datapoint:{jsonCustomData:function(e){return{status:e.ResponseClass,numberOfEventsImported:e.NumberOfEventsImported}}}},d)).then((function(e){if(null!=e&&null!=e.Body)return e.Body;throw new Error("[importCalendarOperation failed]")}))]}var p}))}))}n.d(t,"a",(function(){return d}))},2937:function(e,t,n){"use strict";var r=n(991),a=n(283);t.a=Object(a.action)("setAttachmentOriginalUrl")((function(e,t){Object(r.a)(e).model.AttachmentOriginalUrl=t}))},3230:function(e,t,n){"use strict";var r=n(108),a=n(1137),o=n(0),i=n(1036),c=n(991),u=n(2083),s=n(1833);function d(e,t,n){return Object(o.__awaiter)(this,void 0,void 0,(function(){var r,a;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return(r=Object(c.a)(e))?Object(i.e)(r.model)?[4,s.e.import()]:[3,2]:[2];case 1:return o.sent()(r.model),[3,3];case 2:(a=r.download.url)&&Object(u.a)(a,t,n),o.label=3;case 3:return[2]}}))}))}n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return p})),n.d(t,"a",(function(){return a.c})),n.d(t,"b",(function(){return d}));var l=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(139)]).then(n.bind(null,15295))})),f=new r.a(l,(function(e){return e.clickAttachment})).importAndExecute,p=new r.a(l,(function(e){return e.previewAttachment}))},3257:function(e,t,n){"use strict";function r(e,t){return-1!==t.strategy.supportedMenuActions.indexOf(e)}n.d(t,"a",(function(){return r}))},3828:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.saveToCloud=0]="saveToCloud",e[e.download=1]="download",e[e.addToCalendar=2]="addToCalendar",e[e.editAndReply=3]="editAndReply",e[e.openNewTabAndSaveToCloud=4]="openNewTabAndSaveToCloud"}(r||(r={}))},3911:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n(108),a=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(139)]).then(n.bind(null,6496))})),o=Object(r.d)(a,(function(e){return e.AttachmentThumbnailView})),i=Object(r.d)(a,(function(e){return e.AttachmentIconView})),c=Object(r.d)(a,(function(e){return e.AttachmentDocInfoView})),u=Object(r.d)(a,(function(e){return e.AttachmentDocView}))},4214:function(e){e.exports=JSON.parse('{"a":"Tkb"}')},4406:function(e,t,n){"use strict";function r(e){switch(e){case"csv":case"ods":case"xls":case"xlsb":case"xlsm":case"xlsx":return"Excel";case"odp":case"pot":case"potm":case"potx":case"pps":case"ppsm":case"ppsx":case"ppt":case"pptm":case"pptx":return"PowerPoint";case"vsd":case"vsdm":case"vsdx":return"Visio";case"doc":case"docm":case"docx":case"dot":case"dotm":case"dotx":case"odt":case"rtf":return"Word";default:return""}}n.d(t,"a",(function(){return r}))},5418:function(e){e.exports=JSON.parse('{"a":"INa"}')},5419:function(e){e.exports=JSON.parse('{"a":"nkb"}')},5953:function(e){e.exports=JSON.parse('{"a":"skb"}')},610:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"FindItemJsonRequest:#Exchange"},e)}},627:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(25),a=n(610);function o(e,t){return void 0===e||e.__type||(e=Object(a.a)(e)),Object(r.a)("FindItem",e,t)}},628:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"FindItemRequest:#Exchange"},e)}},6403:function(e,t,n){"use strict";t.a={OnClick:{name:"AttachmentOnClick",customData:function(e){return[e]}}}},6404:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return l}));var r=n(7988),a=n(1751),o=n(2497),i={},c=null;function u(e,t){i[e.attachmentId.Id]&&(clearTimeout(i[e.attachmentId.Id]),i[e.attachmentId.Id]=null),c=e.attachmentId.Id,Object(r.a)(e,!0),t&&!Object(o.a)(e)&&Object(a.a)(e,!0)}function s(e,t){i[e.attachmentId.Id]&&clearTimeout(i[e.attachmentId.Id]),i[e.attachmentId.Id]=setTimeout((function(){Object(r.a)(e,!1),t&&!Object(o.a)(e)&&Object(a.a)(e,!1),e.attachmentId.Id===c&&(c=null),i[e.attachmentId.Id]=null}),40)}function d(e,t){Object(r.a)(e,!0),t&&!Object(o.a)(e)&&Object(a.a)(e,!0)}function l(e,t){e.attachmentId.Id!==c&&(Object(r.a)(e,!1),t&&!Object(o.a)(e)&&Object(a.a)(e,!1))}},6417:function(e){e.exports=JSON.parse('{"a":"Wkb"}')},6502:function(e,t,n){"use strict";var r=n(42),a=n(579),o=n(78),i=n(1137),c=n(79),u=n(1),s=n(3828),d=n(6404),l=n(314),f=n(9),p=n(5953),m=n(5419),b=n(9343);var v=n(1298),h=n(7989),g=n(114),O=n(76),j=n(295),w=n(3257),I=n(7990);function _(e,t){if(0!==t.ongoingAction||!t.strategy.showActionsMenu)return!0;switch(e){case s.a.addToCalendar:return!1;case s.a.download:return!Object(w.a)(v.a.Download,t)||!Object(h.a)(t);case s.a.saveToCloud:case s.a.openNewTabAndSaveToCloud:return!t.isReadOnly||!function(e,t){var n,r=Object(j.a)()&&(null===(n=e.attachmentId.mailboxInfo)||void 0===n?void 0:n.type)===g.a.GroupMailbox,a=!1;a=t===s.a.openNewTabAndSaveToCloud?Object(O.h)("woven-newTabExperiment")&&Object(I.a)(e.attachmentId):Object(O.h)("woven-saveToCloud2-viewInOneDrive")||Object(O.h)("woven-saveToCloud2-editInOneDrive")||Object(O.h)("woven-saveToCloud2-editInApp")||Object(O.h)("woven-saveToCloud2-editOnline")||Object(O.h)("woven-saveToCloud2-openFolder")||Object(O.h)("woven-newTabExperiment");return a&&Object(w.a)(v.a.SaveToCloud,e)&&Object(v.t)(e)&&!r}(t,e);case s.a.editAndReply:return!t.isReadOnly||!Object(I.a)(t.attachmentId);default:return Object(l.a)(e)}}var x=n(0),S=n(254),C=n(7365),y=n(7991),A=n(1036),P=n(991),T=n(2336),E=n(3230),k=n(2083),D=n(428),R=n(2432),N=n(1833),M=n(577),V=n(22),L="/"+Object(x.__spread)(["mail"],Object(M.a)().split("/").slice(1)).join("/")+"deeplink/saveAndEdit/";var H=n(7366);function W(e,t,n){switch(e){case s.a.addToCalendar:Object(y.a)(t,C.a.SurfaceAction);break;case s.a.download:!function(e,t){var n,r;Object(x.__awaiter)(this,void 0,void 0,(function(){var a,o,i,u,s,d,l,f;return Object(x.__generator)(this,(function(p){switch(p.label){case 0:return(a=Object(P.a)(e.attachmentId))?Object(A.e)(a.model)?[4,N.e.import()]:[3,2]:(c.d("AttachmentSurfaceActionButton.downloadAttachment attachmentModel is null"),[2]);case 1:return p.sent()(a.model),[3,3];case 2:Object(k.a)(a.download.url,e.isCloudy,document.body),p.label=3;case 3:return o=Object(T.a)(a),Object(S.o)("AttachmentDownload",{entryPoint:"SurfaceAction",isCloudy:e.isCloudy,isCompose:!e.isReadOnly},{cosmosOnlyData:JSON.stringify({size:a.model.Size,fileType:o,attachmentId:null===(n=a.model.AttachmentId)||void 0===n?void 0:n.Id})}),Object(O.h)("doc-attachment-sigs")?(i=null==t?void 0:t.Id,s=(u=S.l).importAndExecute,d=["SavedAttachment"],l={},(f=i)?[4,Object(R.a)(i)]:[3,5]):[3,6];case 4:f=p.sent(),p.label=5;case 5:s.apply(u,d.concat([(l.itemId=f,l.customProperties={FileId:null===(r=a.model.AttachmentId)||void 0===r?void 0:r.Id,FileType:o,Destination:"Local",Sender:Object(H.a)(i)},l)])),p.label=6;case 6:return[2]}}))}))}(t,n);break;case s.a.saveToCloud:!function(e,t){var n,r=Object(P.a)(e.attachmentId);if(!r)return void c.d("AttachmentSurfaceActionButton.saveToCloud attachmentModel is null");Object(S.o)("AttachmentSaveToCloud",{entryPoint:"SurfaceAction"},{cosmosOnlyData:JSON.stringify({size:r.model.Size,fileType:Object(T.a)(r),attachmentId:null===(n=r.model.AttachmentId)||void 0===n?void 0:n.Id}),isCore:!0}),Object(v.B)(Object(v.p)(e.attachmentId),.1,(function(t){Object(v.x)(e,t)}),e.attachmentId),Object(v.u)(e,(function(t){Object(v.C)(e.attachmentId,t)}),"SurfaceAction",t,Object(H.a)(null==t?void 0:t.Id))}(t,n);break;case s.a.editAndReply:!function(e,t,n){Object(x.__awaiter)(this,void 0,void 0,(function(){var r,a;return Object(x.__generator)(this,(function(o){switch(o.label){case 0:return[4,E.d.import()];case 1:return r=o.sent(),Object(S.o)("WovenEditAndReplyFromSurface",{},{isCore:!0}),a={viewState:e,previewPaneSelectionSource:i.c.ReadingPane,parentItemId:t,isDraft:!1,isEdit:!0,onBeforePreview:function(){return null},createImageGallery:function(){return null},instrumentationContext:null,targetWindow:window,sxsId:n},r(a),[2]}}))}))}(t,n);break;case s.a.openNewTabAndSaveToCloud:!function(e,t){Object(x.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(x.__generator)(this,(function(a){return n=Object(D.a)(),function(e,t,n){var r=""+L;r+=encodeURIComponent(null==n?void 0:n.Id)+"/"+encodeURIComponent(e)+"/"+encodeURIComponent(t)+"/"+Object(V.a)().search,window.open(r,"_blank")}(e.attachmentId.Id,n,t),r=new S.a("WovenNewTabSaveToCloud",{isCore:!0}),Object(v.B)(4*Object(v.p)(e.attachmentId),.1,(function(t){Object(v.x)(e,t)}),e.attachmentId),Object(v.D)(e,(function(t){Object(v.C)(e.attachmentId,t),t?r.end():r.endWithError("ServerError")}),"PencilExperiment",t,n,Object(H.a)(null==t?void 0:t.Id)),[2]}))}))}(t,n);break;default:Object(l.a)(e)}}var B=n(9344),z=n(308).bind(B);t.a=Object(r.a)((function(e){var t=e.action,n=e.attachmentViewState,r=e.customClassName,v=e.isForImageView,h=e.previewState;if(_(t,n))return null;var g=void 0,O=function(e){switch(e){case i.a.Edit:return B.edit;case i.a.NotSelectedAndSaving:return B.notSelectedAndSaving;case i.a.OtherSaving:return B.attachmentView;case i.a.Selected:return B.selected;case i.a.SelectedAndPending:return B.selectedAndPending;case i.a.SelectedAndSaving:return B.selectedAndSaving;default:return B.default}}(h);if(v){var j={extraRightPadding:F(t,n)};g=z([B.actionButton,B.actionButtonForImageView,r,j])}else g=n.isReadOnly?z([B.actionButton,O,r]):z([B.actionButton,O,B.actionButtonForDocViewInCompose,r]);var w=function(e){switch(e){case s.a.addToCalendar:return"AddEvent";case s.a.download:return"Download";case s.a.saveToCloud:return"CloudUpload";case s.a.openNewTabAndSaveToCloud:return"Edit";case s.a.editAndReply:return"PencilReply";default:return Object(l.a)(e)}}(t),I=function(e){switch(e){case s.a.addToCalendar:return Object(f.b)(p.a);case s.a.download:return Object(f.b)(m.a);case s.a.saveToCloud:return Object(f.b)(b.c);case s.a.openNewTabAndSaveToCloud:return Object(f.b)(b.b);case s.a.editAndReply:return Object(f.b)(b.a);default:return Object(l.a)(e)}}(t);return u.createElement(a.a,{onFocus:function(){return Object(d.b)(e.attachmentViewState,e.isForImageView)},onBlur:function(){e.shouldNotHandleOnBlur||Object(d.a)(e.attachmentViewState,e.isForImageView)},onKeyDown:function(t){t.keyCode!==o.a.enter&&t.keyCode!==o.a.space||(c.g.info("AttachmentSurfaceActionButton.keyDown enter|space"),t.stopPropagation(),W(e.action,e.attachmentViewState,e.parentItemId))},ariaLabel:I,title:I,onClick:function(t){c.g.info("AttachmentSurfaceActionButton.onclick"),t.stopPropagation(),W(e.action,e.attachmentViewState,e.parentItemId)},className:g,iconProps:{iconName:w,styles:{root:B.icon}}})}));function F(e,t){return(e===s.a.saveToCloud||e===s.a.editAndReply||e===s.a.openNewTabAndSaveToCloud)&&!_(s.a.download,t)}},6660:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1720),a=n(980);function o(e){var t=e.AttachmentId.Id||"";if(e.__type===r.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE){var n=e;return{fileType:a.a.Cloud,name:n.Name,size:n.Size,providerId:"",providerType:4,location:n.AttachLongPathName,providerEndpointUrl:"",isFolder:!1,thumbnailUrl:n.AttachmentThumbnailUrl,previewUrl:n.AttachmentPreviewUrl,fileId:t,fileParentId:"",type:n.__type}}return{attachmentItemId:t,name:e.Name,size:e.Size,fileType:a.a.AttachmentItem,type:r.a.attachmentTypes.ITEM_ID_ATTACHMENT_TYPE}}},7365:function(e,t,n){"use strict";t.a={SurfaceAction:"Surface action",ContextMenu:"Context menu"}},7366:function(e,t,n){"use strict";var r=n(963);t.a=function(e){var t,n,a=e&&Object(r.x)(e);return null===(n=null===(t=(null==a?void 0:a.From)||(null==a?void 0:a.Sender))||void 0===t?void 0:t.Mailbox)||void 0===n?void 0:n.EmailAddress}},7412:function(e){e.exports=JSON.parse('{"a":"tkb"}')},7413:function(e){e.exports=JSON.parse('{"a":"Skb"}')},7679:function(e,t,n){"use strict";function r(e,t){var n,r,a=(n=e,null!=(r=new RegExp("^https?\\:\\/\\/([\\w\\.-]+)(?:\\:[0-9]{1,4})?.*$","i").exec(n))&&r.length>1?r[1].toLowerCase():null);return null!=a?a:t}var a=n(7960),o=n(76),i=n(966);function c(e,t){var n=t.model.Name;if(e.isCloudy){var r=t,a=void 0;(a=Object(o.h)("doc-unwrap-safelinks")?r.originalUrl:r.openUrl)||(a=t.model.AttachLongPathName),a&&(n+="\n \n"+a)}return n}function u(e,t){var n,o;if(e.isCloudy){var c=t.model;if(e.isReadOnly)return{text:r(t.openUrl,c.AttachLongPathName||null),title:null};var u=null===(o=null===(n=t.info)||void 0===n?void 0:n.sharingInfo)||void 0===o?void 0:o.expirationDate,s=Object(a.a)(c.PermissionType,c.ProviderType,u,e.isPlaceholderAttachment);return{text:s,title:s}}var d=t.model.Size>0?Object(i.i)(t.model.Size):null;return{text:d,title:d}}n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}))},7960:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(9214),a=n(9),o=n(1870),i=n(76),c=n(7);function u(e,t,n,u){return void 0===n&&(n=null),void 0===u&&(u=!1),null==e||u?null:Object(i.h)("doc-attachment-referenceAttachmentExpiration")&&n&&Object(c.Hb)(n,Object(c.Qb)())?Object(a.c)(Object(a.b)(r.a),n):Object(o.d)(e,t)}},7987:function(e){e.exports=JSON.parse('{"a":"Rkb"}')},7988:function(e,t,n){"use strict";var r=n(283);t.a=Object(r.action)("setShouldShowActionsContainer")((function(e,t){e.shouldShowActionsContainer=t}))},7989:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1036),a=n(991);function o(e){var t=Object(a.a)(e.attachmentId);return!!t&&(!!Object(r.e)(t.model)||t.download.url&&t.info&&t.info.allowDownload)}},7990:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(991),a=n(966),o=n(4406);function i(e){var t=Object(r.a)(e),n=Object(a.c)(t.model.Name||"");return""!==Object(o.a)(n)&&"Visio"!==Object(o.a)(n)}},7991:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return b}));var r=n(5953),a=n(9),o=n(254),i=n(1298),c=n(1894),u=n(1107),s=n(7365),d=n(991),l=n(2336),f=n(76),p=n(3257);function m(e,t){var n=Object(d.a)(e.attachmentId),r=Object(l.a)(n);Object(o.o)("AddToCalendar",[t],{cosmosOnlyData:JSON.stringify({size:n.model.Size,fileType:r})}),n.model.Size>10485760||!e.attachmentId||!e.attachmentId.Id?Object(u.a)(e,0,15):(Object(i.B)(Object(i.j)(n.model.Size),.1,(function(t){Object(i.x)(e,t)}),e.attachmentId),Object(c.a)(e,0))}function b(e){var t=Object(d.a)(e.attachmentId);return Object(p.a)(i.a.ImportCalendarEventAttachment,e)&&t&&13===t.attachmentClass&&Object(f.h)("cal-ics-preview")?{name:Object(a.b)(r.a),key:"AddToCalendar",onClick:function(){m(e,s.a.ContextMenu)}}:null}},9214:function(e){e.exports=JSON.parse('{"a":"yjb"}')},9340:function(e){e.exports=JSON.parse('{"a":"nlb"}')},9342:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"e",(function(){return s}));var r=n(108),a=n(6403);n.d(t,"d",(function(){return a.a}));var o=n(3828);n.d(t,"c",(function(){return o.a}));var i=n(6502);n.d(t,"a",(function(){return i.a}));var c=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(139)]).then(n.bind(null,10595))})),u=Object(r.d)(c,(function(e){return e.AttachmentView})),s=new r.b(c,(function(e){return e.getContextMenus}))},9343:function(e){e.exports=JSON.parse('{"a":"Ykb","b":"Zkb","c":"_kb"}')},9344:function(e,t,n){var r=n(9345),a=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)a.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},9345:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,'._2KRgryadS8K-_TLdBoNKmd{font-size:14px;color:"[theme:neutralSecondary, default:#666666]";height:25px;width:26px}html[dir] ._2KRgryadS8K-_TLdBoNKmd{padding:4px;text-align:center}._2KRgryadS8K-_TLdBoNKmd:focus,._2KRgryadS8K-_TLdBoNKmd:hover,._1eq1P1PoHUzBriyfNWVd1T{color:"[theme:neutralSecondary, default:#666666]"}._1eq1P1PoHUzBriyfNWVd1T{display:block}.HDG8P1QaVRBOeSU0W5zmW{bottom:0;position:absolute;color:"[theme:white, default:#ffffff]"}html[dir=ltr] .HDG8P1QaVRBOeSU0W5zmW{right:26px}html[dir=rtl] .HDG8P1QaVRBOeSU0W5zmW{left:26px}.HDG8P1QaVRBOeSU0W5zmW:focus,.HDG8P1QaVRBOeSU0W5zmW:hover{color:"[theme:white, default:#ffffff]"}html[dir] .HDG8P1QaVRBOeSU0W5zmW:focus,html[dir] .HDG8P1QaVRBOeSU0W5zmW:hover{background:"[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]"}html[dir=ltr] .HDG8P1QaVRBOeSU0W5zmW:focus,html[dir=ltr] .HDG8P1QaVRBOeSU0W5zmW:hover{border-bottom-right-radius:2px}html[dir=rtl] .HDG8P1QaVRBOeSU0W5zmW:focus,html[dir=rtl] .HDG8P1QaVRBOeSU0W5zmW:hover{border-bottom-left-radius:2px}html[dir=ltr] .HDG8P1QaVRBOeSU0W5zmW._2RdXhaKvBvt2MX9AyW7pcR{right:52px}html[dir=rtl] .HDG8P1QaVRBOeSU0W5zmW._2RdXhaKvBvt2MX9AyW7pcR{left:52px}._2ebptdF8eCnt_2-FT7dzaH{font-size:14px}html[dir] ._2ebptdF8eCnt_2-FT7dzaH{margin:0}html[dir] .IPPU7NtLHAzlPwHTIXmXp:focus,html[dir] .IPPU7NtLHAzlPwHTIXmXp:hover{background:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}html[dir] .rPIl3tr-13EegQ4JcXUy_,html[dir] ._3vsJWDG9Ae71RWCd-gnOXq,html[dir] ._17q1sDoo-1SD8o99_vx_Wl,html[dir] ._1H8nRWpPKM9iogJAm6ze6p,html[dir] ._3bO0ii_CywH_7ysZAUsxkB,html[dir] ._1E-xlZkNQ0oWd42XQohXqv{margin:0;background-color:"[theme:themeLight, default:#C7E0F4]"}html[dir] .rPIl3tr-13EegQ4JcXUy_:focus,html[dir] .rPIl3tr-13EegQ4JcXUy_:hover,html[dir] ._3vsJWDG9Ae71RWCd-gnOXq:focus,html[dir] ._3vsJWDG9Ae71RWCd-gnOXq:hover,html[dir] ._17q1sDoo-1SD8o99_vx_Wl:focus,html[dir] ._17q1sDoo-1SD8o99_vx_Wl:hover,html[dir] ._1H8nRWpPKM9iogJAm6ze6p:focus,html[dir] ._1H8nRWpPKM9iogJAm6ze6p:hover,html[dir] ._3bO0ii_CywH_7ysZAUsxkB:focus,html[dir] ._3bO0ii_CywH_7ysZAUsxkB:hover,html[dir] ._1E-xlZkNQ0oWd42XQohXqv:focus,html[dir] ._1E-xlZkNQ0oWd42XQohXqv:hover{background:"[theme:themeTertiary, default:#71AFE5]"}html[dir] .rPIl3tr-13EegQ4JcXUy_{background-color:"[theme:themeLighterAlt, default:#EFF6FC]"}',""]),t.locals={actionButton:"_2KRgryadS8K-_TLdBoNKmd",actionButtonForDocViewInCompose:"_1eq1P1PoHUzBriyfNWVd1T",actionButtonForImageView:"HDG8P1QaVRBOeSU0W5zmW",extraRightPadding:"_2RdXhaKvBvt2MX9AyW7pcR",icon:"_2ebptdF8eCnt_2-FT7dzaH",default:"IPPU7NtLHAzlPwHTIXmXp",edit:"rPIl3tr-13EegQ4JcXUy_",notSelectedAndSaving:"_3vsJWDG9Ae71RWCd-gnOXq",selected:"_17q1sDoo-1SD8o99_vx_Wl",selectedAndPending:"_1H8nRWpPKM9iogJAm6ze6p",selectedAndSaving:"_3bO0ii_CywH_7ysZAUsxkB",thematic:"_1E-xlZkNQ0oWd42XQohXqv"}},9626:function(e){e.exports=JSON.parse('{"k":"Akb","l":"Bkb","m":"Ckb","j":"Dkb","h":"Ekb","i":"Fkb","f":"Gkb","g":"Hkb","o":"Ikb","p":"Jkb","q":"Kkb","b":"Lkb","n":"Mkb","d":"Nkb","c":"Okb","a":"Pkb","e":"Qkb"}')},9627:function(e){e.exports=JSON.parse('{"f":"ukb","b":"vkb","d":"wkb","a":"xkb","c":"ykb","e":"zkb"}')},9628:function(e,t,n){"use strict";function r(e){return e.actionCompletePercent>0&&e.actionCompletePercent<=1}n.d(t,"a",(function(){return r}))},981:function(e,t,n){"use strict";var r={alert:"alert",alertdialog:"alertdialog",application:"application",article:"article",banner:"banner",button:"button",cell:"cell",checkbox:"checkbox",columnheader:"columnheader",combobox:"combobox",complementary:"complementary",contentinfo:"contentinfo",definition:"definition",dialog:"dialog",directory:"directory",document:"document",feed:"feed",figure:"figure",form:"form",grid:"grid",gridcell:"gridcell",group:"group",heading:"heading",img:"img",link:"link",list:"list",listbox:"listbox",listitem:"listitem",log:"log",main:"main",marquee:"marquee",math:"math",menu:"menu",menubar:"menubar",menuitem:"menuitem",menuitemcheckbox:"menuitemcheckbox",menuitemradio:"menuitemradio",navigation:"navigation",note:"note",option:"option",presentation:"presentation",progressbar:"progressbar",radio:"radio",radiogroup:"radiogroup",region:"region",row:"row",rowgroup:"rowgroup",rowheader:"rowheader",scrollbar:"scrollbar",search:"search",searchbox:"searchbox",separator:"separator",slider:"slider",spinbutton:"spinbutton",status:"status",switch:"switch",tab:"tab",table:"table",tablist:"tablist",tabpanel:"tabpanel",term:"term",textbox:"textbox",timer:"timer",toolbar:"toolbar",tooltip:"tooltip",tree:"tree",treegrid:"treegrid",treeitem:"treeitem"},a=0;function o(e){return void 0===e&&(e="id"),""+e+a++}function i(e){return Array.isArray(e)?e.join(" "):e}function c(e){if(!e)return null;for(var t={},n=Object.keys(e),r=0;r<n.length;r++){switch(n[r]){case"role":t.role=e.role;break;case"id":t.id=e.id;break;case"activeDescendant":t["aria-activedescendant"]=e.activeDescendant;break;case"atomic":t["aria-atomic"]=e.atomic;break;case"autocomplete":t["aria-autocomplete"]=e.autocomplete;break;case"busy":t["aria-busy"]=e.busy;break;case"checked":t["aria-checked"]=e.checked;break;case"controls":t["aria-controls"]=i(e.controls);break;case"describedBy":t["aria-describedby"]=i(e.describedBy);break;case"disabled":t["aria-disabled"]=e.disabled;break;case"dropEffect":t["aria-dropeffect"]=i(e.dropEffect);break;case"expanded":t["aria-expanded"]=e.expanded;break;case"flowTo":t["aria-flowto"]=i(e.flowTo);break;case"grabbed":t["aria-grabbed"]=e.grabbed;break;case"hasPopup":t["aria-haspopup"]=e.hasPopup;break;case"hidden":t["aria-hidden"]=e.hidden;break;case"invalid":t["aria-invalid"]=e.invalid;break;case"label":t["aria-label"]=e.label;break;case"labelledBy":t["aria-labelledby"]=i(e.labelledBy);break;case"level":t["aria-level"]=e.level;break;case"live":t["aria-live"]=e.live;break;case"multiline":t["aria-multiline"]=e.multiline;break;case"multiselectable":t["aria-multiselectable"]=e.multiselectable;break;case"orientation":t["aria-orientation"]=e.orientation;break;case"owns":t["aria-owns"]=i(e.owns);break;case"positionInSet":t["aria-posinset"]=e.positionInSet;break;case"pressed":t["aria-pressed"]=e.pressed;break;case"readonly":t["aria-readonly"]=e.readonly;break;case"relevant":t["aria-relevant"]=i(e.relevant);break;case"required":t["aria-required"]=e.required;break;case"selected":t["aria-selected"]=e.selected;break;case"setSize":t["aria-setsize"]=e.setSize;break;case"sort":t["aria-sort"]=e.sort;break;case"valueMax":t["aria-valuemax"]=e.valueMax;break;case"valueMin":t["aria-valuemin"]=e.valueMin;break;case"valueNow":t["aria-valuenow"]=e.valueNow;break;case"valueText":t["aria-valuetext"]=e.valueText}}return t}n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return c}))},991:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1126);function a(e){return Object(r.a)().attachments.get(e.Id)}},9924:function(e,t,n){"use strict";var r=n(7412),a=n(4214),o=n(7413),i=n(7987),c=n(9626),u=n(5418),s=n(9),d=n(314),l=n(76),f=n(966),p=n(79),m=n(9627);function b(e){return Object(l.h)("woven-saveToCloud2-viewInOneDrive")?Object(s.b)(m.f):Object(l.h)("woven-saveToCloud2-editInOneDrive")?Object(s.b)(m.b):Object(l.h)("woven-saveToCloud2-editInApp")||Object(l.h)("woven-newTabExperiment")?function(e){var t=Object(f.b)(e)||"",n=Object(f.f)(t);if(null===n)return p.d("invalid office app for save to cloud experiment string"),Object(s.b)(m.b);switch(n){case f.a.Word:return Object(s.b)(m.d);case f.a.Excel:return Object(s.b)(m.a);case f.a.PowerPoint:return Object(s.b)(m.c);default:return Object(d.a)(n)}}(e):Object(l.h)("woven-saveToCloud2-editOnline")?Object(s.b)(m.e):Object(l.h)("woven-saveToCloud2-openFolder")?Object(s.b)(m.f):Object(s.b)(m.e)}var v=n(7);function h(e){var t,n;return(null===(n=null===(t=null==e?void 0:e.info)||void 0===t?void 0:t.sharingInfo)||void 0===n?void 0:n.expirationDate)&&Object(v.Hb)(e.info.sharingInfo.expirationDate,Object(v.Qb)())}var g=n(1069),O=n(114),j=n(295),w=n(7679);function I(e,t,n,r){return void 0===r&&(r=""),t?Object(s.b)(c.h):n?b(r):Object(s.c)(Object(s.b)(c.i),e?Object(s.b)(i.a):Object(s.b)(u.a))}function _(e,t,n,f){var p;void 0===f&&(f="");var m,b=Object(j.a)(),v=(null===(p=t.id.mailboxInfo)||void 0===p?void 0:p.type)==O.a.GroupMailbox;if(0===e.actionMessage)return function(e,t){var n=Object(w.b)(e,t);return{text:n.text,title:n.title,shouldDisplaySuccessIcon:!1,shouldDisplayFailureIcon:!1,useExpiredAttachmentStyling:Object(l.h)("doc-attachment-referenceAttachmentExpiration")&&h(t)}}(e,t);var _=!1,x=!1;switch(e.actionMessage){case 1:m=function(e,t){if(t)return Object(s.b)(c.k);var n=Object(g.f)();return e?Object(s.c)(Object(s.b)(c.l),Object(s.b)(i.a)):Object(s.c)(Object(s.b)(c.m),n)}(b,v);break;case 5:m=Object(s.b)(c.b);break;case 2:m=I(b,v,n,f);break;case 3:m=I(b,v,n,f),_=!0;break;case 4:case 9:m=function(e,t){return t?Object(s.b)(c.f):Object(s.c)(Object(s.b)(c.g),e?Object(s.b)(i.a):Object(s.b)(u.a))}(b,v),x=!0;break;case 7:m=Object(s.b)(c.n);break;case 6:m=Object(s.b)(c.d);break;case 8:m=function(e,t){if(t)return Object(s.b)(c.o);var n=Object(g.f)();return e?Object(s.c)(Object(s.b)(c.p),n,Object(s.b)(i.a)):Object(s.c)(Object(s.b)(c.q),n)}(b,v);break;case 10:m=Object(s.b)(c.c);break;case 11:m=Object(s.b)(c.a);break;case 12:m=Object(s.b)(c.e),x=!0;break;case 16:m=Object(s.b)(c.c);break;case 14:m=Object(s.b)(o.a),_=!0;break;case 15:m=Object(s.b)(a.a),x=!0;break;case 13:m=Object(s.b)(r.a);break;case 17:m=Object(s.b)(c.n);break;case 18:m=Object(s.b)(c.j);break;default:Object(d.a)(e.actionMessage)}return{text:m,title:m,shouldDisplaySuccessIcon:_,shouldDisplayFailureIcon:x,useExpiredAttachmentStyling:!1}}n.d(t,"a",(function(){return _}))},9973:function(e,t,n){"use strict";var r=n(0),a=n(1036),o=n(79);function i(e,t){return void 0===t&&(t=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,c,u,s,d,l,f,p,m,b;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=[],[4,a.i.import()];case 1:return i=r.sent(),[4,a.l.import()];case 2:return c=r.sent(),t?[4,a.o.import()]:[3,4];case 3:return s=r.sent(),[3,5];case 4:s=null,r.label=5;case 5:u=s,d=t?e.docViewAttachments:e.imageViewAttachments,l=0,r.label=6;case 6:if(!(l<d.length))return[3,12];if(f=d[l],p=i(f.attachmentId),t&&!u(p.model))return[3,11];r.label=7;case 7:return r.trys.push([7,9,,10]),[4,c(f.attachmentId,e.isReadOnly)];case 8:return r.sent(),[3,10];case 9:return m=r.sent(),o.g.warn("Unable to refresh thumbnail image for "+f.attachmentId+". Got error "+m),[3,10];case 10:b={downloadUrl:p.download.url,id:f.attachmentId,previewUrl:p.previewImage.url,thumbnailUrl:p.thumbnailImage.url},n.push(b),r.label=11;case 11:return l++,[3,6];case 12:return[2,n]}}))}))}n.d(t,"a",(function(){return i}))}}]);
//# sourceMappingURL=owa.ConversationAttachment.js.map
self.scriptsLoaded['owa.ConversationAttachment.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.ConversationAttachment.js'] = (new Date()).getTime();