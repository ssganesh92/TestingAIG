self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.GroupList~GroupListTree.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[75],{1009:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(4),o=n(24),u=Object(r.createStore)("groupsStore",{groups:new o.ObservableMap})},1029:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1009);function o(t){var e=Object(r.a)().groups.get(t.toLowerCase());return e?e.groupDetails:null}},1037:function(t,e,n){"use strict";var r;!function(t){t[t.None=0]="None",t[t.Executing=1]="Executing",t[t.Succeed=2]="Succeed",t[t.FailureNotice=3]="FailureNotice",t[t.FailureRetry=4]="FailureRetry"}(r||(r={})),e.a=r},1043:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(4),o=n(1083),u=Object(r.createStore)("unifiedGroupsSettingsStore",{supportedClassifications:[],defaultClassification:"",namingPolicySettings:{},groupsGuidelinesLink:"",orgAllowAddGuests:!1,defaultGroupAccessType:o.a.Private,groupCreationEnabled:!1,isSensitivityLabelsEnabled:!1})},1045:function(t,e,n){"use strict";n(1304),n(1247);var r=n(1305);n.o(r,"getAccessTypeString")&&n.d(e,"getAccessTypeString",(function(){return r.getAccessTypeString})),n.o(r,"getAccessTypeTooltip")&&n.d(e,"getAccessTypeTooltip",(function(){return r.getAccessTypeTooltip})),n.o(r,"getGroupResource")&&n.d(e,"getGroupResource",(function(){return r.getGroupResource})),n.o(r,"getGroupResourceUrl")&&n.d(e,"getGroupResourceUrl",(function(){return r.getGroupResourceUrl})),n.o(r,"getGroupSiteStatus")&&n.d(e,"getGroupSiteStatus",(function(){return r.getGroupSiteStatus})),n.o(r,"getMembersButtonText")&&n.d(e,"getMembersButtonText",(function(){return r.getMembersButtonText})),n.o(r,"setGroupSiteStatus")&&n.d(e,"setGroupSiteStatus",(function(){return r.setGroupSiteStatus})),n.o(r,"updateGroupSiteAndDocumentUrl")&&n.d(e,"updateGroupSiteAndDocumentUrl",(function(){return r.updateGroupSiteAndDocumentUrl}));var o=n(1306);n.o(o,"getAccessTypeString")&&n.d(e,"getAccessTypeString",(function(){return o.getAccessTypeString})),n.o(o,"getAccessTypeTooltip")&&n.d(e,"getAccessTypeTooltip",(function(){return o.getAccessTypeTooltip})),n.o(o,"getGroupResource")&&n.d(e,"getGroupResource",(function(){return o.getGroupResource})),n.o(o,"getGroupResourceUrl")&&n.d(e,"getGroupResourceUrl",(function(){return o.getGroupResourceUrl})),n.o(o,"getGroupSiteStatus")&&n.d(e,"getGroupSiteStatus",(function(){return o.getGroupSiteStatus})),n.o(o,"getMembersButtonText")&&n.d(e,"getMembersButtonText",(function(){return o.getMembersButtonText})),n.o(o,"setGroupSiteStatus")&&n.d(e,"setGroupSiteStatus",(function(){return o.setGroupSiteStatus})),n.o(o,"updateGroupSiteAndDocumentUrl")&&n.d(e,"updateGroupSiteAndDocumentUrl",(function(){return o.updateGroupSiteAndDocumentUrl}));n(1083);var u=n(1009);n.d(e,"getGroupsStore",(function(){return u.a}));var i=n(1043);n.d(e,"getUnifiedGroupsSettingsStore",(function(){return i.a}));var c=n(1029);n.d(e,"getGroupDetails",(function(){return c.a}));var a=n(1307);n.d(e,"isGroupDetailsValid",(function(){return a.a}));var s=n(1106);n.d(e,"getGroupResource",(function(){return s.a})),n.d(e,"getGroupResourceUrl",(function(){return s.b}));var p=n(1308);n.d(e,"getCurrentGroupSmtpAddress",(function(){return p.a}));var d=n(1076);n.d(e,"getGroupSiteStatusStore",(function(){return d.a}));var f=n(1309);n.d(e,"updateGroupSiteAndDocumentUrl",(function(){return f.a}));var l=n(1212);n.d(e,"setGroupSiteStatus",(function(){return l.b}));var g=n(1310);n.d(e,"getGroupSiteStatus",(function(){return g.a}));var b=n(1311);n.d(e,"getGroupMailboxExternalId",(function(){return b.a}));n(1037),n(1204),n(1188),n(1213),n(1202);var S=n(1314);n.d(e,"getAccessTypeString",(function(){return S.a})),n.d(e,"getAccessTypeTooltip",(function(){return S.b})),n.d(e,"getMembersButtonText",(function(){return S.c}))},1076:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(4),o=n(24),u=Object(r.createStore)("getGroupSiteStatusStore",{groupSiteStatus:new o.ObservableMap})},1083:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.Private=0]="Private",t[t.Public=1]="Public"}(r||(r={}))},1098:function(t,e,n){"use strict";var r,o,u,i,c,a,s,p,d,f,l,g,b,S,v;var h;n(9);function m(t,e){e,h=t}function O(){return h}n.d(e,"o",(function(){return r})),n.d(e,"n",(function(){return o})),n.d(e,"c",(function(){return u})),n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return c})),n.d(e,"g",(function(){return a})),n.d(e,"d",(function(){return s})),n.d(e,"f",(function(){return p})),n.d(e,"l",(function(){return d})),n.d(e,"m",(function(){return f})),n.d(e,"q",(function(){return l})),n.d(e,"r",(function(){return g})),n.d(e,"h",(function(){return b})),n.d(e,"j",(function(){return S})),n.d(e,"e",(function(){return v})),n.d(e,"p",(function(){})),n.d(e,"k",(function(){return m})),n.d(e,"i",(function(){return O}))},1106:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return u}));var r=n(1029),o=function(t,e){var n="string"==typeof t?Object(r.a)(t):t;if(!n||!n.GroupResources)return null;var o=n.GroupResources.filter((function(t){return t.Name===e}));return!o||o.length<1?null:o},u=function(t,e){var n=o(t,e);return n&&0!=n.length?n[0].Url:null}},1188:function(t,e,n){"use strict";var r=n(4),o=n(1313),u=Object(r.mutatorAction)("setJoinButtonState",(function(t,e){o.a.groupActionState.set(t.toLowerCase(),e)}));e.a=u},1202:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(1037),o=n(1313);function u(t){t=t.toLowerCase();var e=o.a.groupActionState;return e.has(t)?e.get(t):r.a.None}},1204:function(t,e,n){"use strict";var r=n(4),o=n(1312),u=Object(r.mutatorAction)("setFollowButtonState",(function(t,e){o.a.groupActionState.set(t.toLowerCase(),e)}));e.a=u},1212:function(t,e,n){"use strict";n.d(e,"b",(function(){return u}));var r=n(4),o=n(1076),u=Object(r.mutatorAction)("setGroupSiteStatus",(function(t,e){t=t.toLocaleLowerCase(),Object(o.a)().groupSiteStatus.has(t)&&e==Object(o.a)().groupSiteStatus.get(t)||Object(o.a)().groupSiteStatus.set(t,e)}));e.a=u},1213:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(1037),o=n(1312);function u(t){t=t.toLowerCase();var e=o.a.groupActionState;return e.has(t)?e.get(t):r.a.None}},1247:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(76),o=n(1043),u=n(103);function i(){return(Object(r.h)("grp-shareable-crud")||Object(o.a)().isSensitivityLabelsEnabled)&&!Object(u.u)()}},1304:function(t,e,n){"use strict";var r=n(4),o=n(24);Object(r.createStore)("personaPhotoStore",{personaPhotoUrls:new o.ObservableMap})()},1305:function(t,e){},1306:function(t,e){},1307:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1009);function o(t){var e=Object(r.a)().groups.get(t.toLowerCase());return!!e&&!e.groupDetailsError}},1308:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1267),o=function(){return Object(r.a)().smtpAddress}},1309:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(4),o=n(1029),u=n(1106),i=Object(r.mutatorAction)("updateGroupSiteAndDocumentUrl",(function(t,e,n,r){if(2==e){var i=Object(o.a)(t);Object(u.a)(i,"Site")[0].Url=n,Object(u.a)(i,"Files")[0].Url=r}}))},1310:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1076);function o(t){return t=t.toLocaleLowerCase(),Object(r.a)().groupSiteStatus.has(t)?Object(r.a)().groupSiteStatus.get(t):0}},1311:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1029),o=function(t){var e="string"==typeof t?Object(r.a)(t):t;return e?e.ExternalDirectoryObjectId:null}},1312:function(t,e,n){"use strict";var r=n(4),o=n(24);e.a=Object(r.createStore)("followButtonStore",{groupActionState:new o.ObservableMap})()},1313:function(t,e,n){"use strict";var r=n(4),o=n(24);e.a=Object(r.createStore)("joinButtonStore",{groupActionState:new o.ObservableMap})()},1314:function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return p})),n.d(e,"c",(function(){return d}));var r=n(1598),o=n(1599),u=n(1637),i=n(1600),c=n(1601),a=n(9);function s(t){var e=t.groupDetails?t.groupDetails.AccessType:t.basicInformation?t.basicInformation.AccessType:null;if(e){if(1===e)return Object(a.b)(i.a);if(3===e)return Object(a.b)(c.a)}return""}function p(t){var e=t.groupDetails?t.groupDetails.AccessType:t.basicInformation?t.basicInformation.AccessType:null;if(e){if(1===e)return Object(a.b)(u.b);if(3===e)return Object(a.b)(u.c)}return""}function d(t){var e=0;return t.members?e=t.members.totalCount:t.groupDetails&&(e=t.groupDetails.MemberCount),e?e>1?Object(a.c)(Object(a.b)(o.a),e.toString()):Object(a.c)(Object(a.b)(r.a),e.toString()):Object(a.b)(u.a)}},1598:function(t){t.exports=JSON.parse('{"a":"Lia"}')},1599:function(t){t.exports=JSON.parse('{"a":"Uia"}')},1600:function(t){t.exports=JSON.parse('{"a":"Qia"}')},1601:function(t){t.exports=JSON.parse('{"a":"Mia"}')},1637:function(t){t.exports=JSON.parse('{"b":"Ria","c":"Sia","a":"Tia"}')},3044:function(t,e,n){"use strict";var r=n(1472),o=n(4),u=Object(o.mutatorAction)("toggleIsShowingAllGroups",(function(){Object(r.b)().shouldShowAllGroups=!Object(r.b)().shouldShowAllGroups})),i=n(0),c=n(42),a=n(3639),s=n(9),p=n(3906),d=n(554),f=n(280),Droppable=n(1169),l=n(1045),g=n(1),b=n(1053),S=n(3555),v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onContextMenu=function(t,n){var r=e.props,o=r.onContextMenu,u=r.groupId;if(o){t.stopPropagation(),t.preventDefault();var i=u.toLowerCase(),c=Object(l.getGroupsStore)().groups;if(c.has(i))o(t,c.get(i))}},e.onDrop=function(t){e.props.onListNodeDrop&&e.props.onListNodeDrop(t,e.props.groupId)},e}return Object(i.__extends)(e,t),e.prototype.shouldComponentUpdate=function(t,e){return!Object(f.e)(this.props,t)},e.prototype.render=function(){var t=Object(S.a)(this.props.groupId);return g.createElement(Droppable.b,{dropViewState:t.drop,onDrop:this.onDrop,canDrop:this.props.canDropOnListNode},g.createElement(p.a,{selectGroup:this.props.selectGroup,isSelected:this.props.isSelected,renderRightCharm:this.props.renderRightCharm,renderRightCharmHover:this.props.renderRightCharmHover,chevronProps:null,customIcon:null,displayName:this.props.displayName,groupId:this.props.groupId,isDroppedOver:t.drop.isDragOver,onContextMenu:this.onContextMenu,renderCustomTreeNodeDisplay:null,customData:this.props.customData,showHoverStateOnDroppedOver:t.drop.draggableItemType==b.a.MailListRow||t.drop.draggableItemType==b.a.MultiMailListMessageRows}))},e=Object(i.__decorate)([d.observer],e)}(g.Component),h=n(3275),m=n(981),O=n(254),G=n(1831),C=n(1016),j=Object(l.getGroupsStore)(),A=Object(r.b)(),N=Object(c.a)((function(t){var e,n,o,c=g.useRef(!1),p=function(e){return g.createElement(v,{selectGroup:t.selectGroup,isSelected:t.isSelected,renderRightCharm:t.renderRightCharm,renderRightCharmHover:t.renderRightCharmHover,displayName:e.DisplayName,groupId:e.SmtpAddress,key:e.SmtpAddress,onContextMenu:t.onChildNodeContextMenuOpened,customData:t.customData,onListNodeDrop:t.onListNodeDrop,canDropOnListNode:t.canDropOnListNode})},d=function(e){e.stopPropagation(),t.toggleGroupTreeExpansion()},f=function(e){var n=t.onRootNodeContextMenuOpened;n&&(e.stopPropagation(),e.preventDefault(),n(e))},l=function(e){return!(A.shouldShowAllGroups||!t.canDropOnListNode)&&t.canDropOnListNode(e)},b=function(t){c.current=!0,setTimeout((function(){c.current&&!Object(r.b)().shouldShowAllGroups&&y()}),1e3)},S=function(){c.current=!1},N=function(t){t.stopPropagation(),y()},y=function(){var e=A.myOrgGroups.length;Object(O.o)("GroupList_ToggleShouldShowAllGroups",{isShowMore:!A.shouldShowAllGroups,joinedGroupCount:e>=21?"21+":e}),t.onShowMoreEvent&&t.onShowMoreEvent(),u()},R=A.myOrgGroups,T={role:m.a.tree},M=t.isGroupsTreeCollapsed;return g.createElement("div",Object(i.__assign)({style:t.style,className:t.className},Object(m.b)(T)),function(e){var n={isExpanded:!e,onClick:d};return g.createElement(G.a,{chevronProps:n,depth:0,displayName:Object(s.b)(a.a),isRootNode:!0,key:"Groups_root",onClick:n.onClick,onContextMenu:f,renderRightCharm:t.renderRootNodeRightCharm,renderRightCharmHover:t.renderRootNodeRightCharmHover,setSize:t.setSize,positionInSet:t.positionInSet})}(M),function(t,e){var n=[];if(e)return n;if(A.shouldShowAllGroups){var r=[];t.forEach((function(t){var e=j.groups.get(t);r.push(e)})),r.sort((function(t,e){return t.basicInformation.DisplayName.localeCompare(e.basicInformation.DisplayName)})).forEach((function(t){n.push(p(t.basicInformation))}))}else t.slice(0,h.a).forEach((function(t){var e=j.groups.get(t);n.push(p(e.basicInformation))}));return n}(R,M),A.withContextMenuGroup&&(A.withContextMenuGroup.isRootNode?null===(e=t.renderRootNodeContextMenu)||void 0===e?void 0:e.call(t,A.withContextMenuGroup):null===(n=t.renderChildNodeContextMenu)||void 0===n?void 0:n.call(t,A.withContextMenuGroup)),R.length>h.a&&function(e){if(e)return null;var n=A.shouldShowAllGroups?Object(s.b)(a.b):Object(s.b)(a.c),r=Object(C.a)();return g.createElement(Droppable.b,{dropViewState:r,onDrop:D,canDrop:l,onDragOver:b,onDragLeave:S},g.createElement(G.a,{displayName:n,isCustomActionNode:!0,isRootNode:!1,key:"groupsCollapseExpandNode",onClick:N,onContextMenu:w,onMouseEnter:t.onMouseEnterShowMoreButton}))}(M),null===(o=t.renderGroupListCustomNodes)||void 0===o?void 0:o.call(t))}));function D(){}function w(t){t.stopPropagation(),t.preventDefault()}n.d(e,"c",(function(){return r.a})),n.d(e,"b",(function(){return r.b})),n.d(e,"a",(function(){return N}))},3275:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o}));var r=5,o=100},3555:function(t,e,n){"use strict";var r=n(1472),o=n(1503),u=n(1016),i=n(4),c=Object(i.mutatorAction)("setGroupNodeViewStateMutator",(function(t,e){Object(r.b)().groupNodeViewStates.set(t,e)}));function a(t){return Object(r.b)().groupNodeViewStates.has(t)||c(t,{drag:Object(o.a)(),drop:Object(u.a)(),isDroppingMessage:!1}),Object(r.b)().groupNodeViewStates.get(t)}n.d(e,"a",(function(){return a}))},3639:function(t){t.exports=JSON.parse('{"a":"Nia","b":"Oia","c":"Pia"}')},7239:function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return c}));var r=n(108),o=new r.c((function(){return n.e(318).then(n.bind(null,10366))})),u=new r.b(o,(function(t){return t.addMarkAsReadDiagnostics})),i=new r.b(o,(function(t){return t.addUnreadCountNotificationDiagnostics})),c=new r.b(o,(function(t){return t.addUnreadCountSubscriptionDiagnostics}))},7668:function(t,e,n){"use strict";var r=n(7239),o=n(7851),u=n(1062),i=n(254),c=n(990),a=n(76),s=n(3044),p=n(3275),d=n(4),f=n(1009),l=Object(d.mutatorAction)("UPDATE_GROUP_UNREAD_COUNT",(function(t,e){var n=Object(f.a)().groups.get(t.toLowerCase());n&&(n.unreadMessageCount=e)}));n.d(e,"b",(function(){return S})),n.d(e,"a",(function(){return v})),n.d(e,"c",(function(){return m}));var g={};function b(t){var e=t.id.replace("UnreadCountNotification_","");if(r.b.import().then((function(n){return n(e,t)})),"0"==t.EventType.toString()){var n=g[e];n&&(l(e.toLowerCase(),t.UnreadCount),n.firstNotificationReceived||(n.unreadCountDataPoint.end(),n.unreadCountDataPoint=null,n.firstNotificationReceived=!0))}}function S(){Object(a.h)("grp-unreadCountTop5AndFavorites")?s.c.myOrgGroups.filter((function(t,e){return e<p.a||Object(c.isGroupInFavorites)(t)})).forEach((function(t){h(t)})):v()}function v(){s.c.myOrgGroups.forEach((function(t){h(t)}))}function h(t){(function(t){return!g[t]})(t=t.toLowerCase())&&u.b.import().then((function(e){var n=Object(o.a)({NotificationType:"UnreadCountNotification",ChannelId:e(),MailboxId:t}),c={subscriptionId:O(t),requiresExplicitSubscribe:!0,subscriptionParameters:n};u.f.importAndExecute(c,b);var a={notificationSubscription:c,firstNotificationReceived:!1,unreadCountDataPoint:new i.a("UnreadCountNotification")};g[t]=a,r.c.import().then((function(e){return e(t,c,!1)}))}))}function m(t){t=t.toLowerCase();var e=g[t];if(e){var n=e.notificationSubscription;n&&(u.g.importAndExecute(n,b),delete g[t],r.c.import().then((function(e){return e(t,n,!0)})))}}function O(t){return"UnreadCountNotification_"+t}},7851:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(0);function o(t){return Object(r.__assign)({__type:"SubscriptionParameters:#Exchange"},t)}}}]);
//# sourceMappingURL=owa.GroupList~GroupListTree.js.map
self.scriptsLoaded['owa.GroupList~GroupListTree.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.GroupList~GroupListTree.js'] = (new Date()).getTime();