self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.940.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[940],{15099:function(e,t,n){"use strict";n.r(t);var o=n(108),r=n(3248),a=n(3232),i=Object(o.e)(r.a,"reloadTableOnTriageActionFailClone",(function(e){var t=e.tableView;t&&Object(a.a)(t)})),c=n(0),s=n(2305),u=n(1413),l=n(1724),b=n(1495),d=n(1510),O=n(3198),j=n(964),f=n(1496);function w(e){return Object(c.__assign)({__type:"SeekToConditionPageView:#Exchange"},e)}var y=n(254),h=n(283),g=Object(h.action)("onLoadMoreRowsSucceeded")((function(e,t,n,o){e.isLoading=!1,o(e,t,n),e.currentLoadedIndex=e.rowKeys.length})),I=Object(h.action)("onLoadMoreRowsFailed")((function(e,t){e.isLoading=!1,Object(y.o)("TnS_LoadMoreRowsError",[e.tableQuery.listViewType,t])})),v=n(947),p=n(1112),_=n(2023),F=n(1859);function x(e,t){var n=e.rowKeys.length-1,o=e.tableQuery,r=Object(l.h)(e);(function(e,t,n,o,r,a,i,c,s,u,y,h,g,I){var v=Object(O.a)({FieldURIOrConstant:Object(d.a)({Item:Object(b.a)({Value:t})}),Item:Object(j.a)({FieldURI:"ConversationInstanceKey"})}),p=w({BasePoint:"Beginning",Condition:Object(f.a)({Item:v}),MaxEntriesReturned:n});return Object(l.b)(e,p,o,r,a,i,c,s,Object(l.g)(o),u,y,h,g,I).then((function(e){return e.json().then((function(e){return e.Body}))}))})(Object(v.i)(o),e.rowKeys[n],t,o.viewFilter,Object(s.a)(o),o.focusedViewFilter,o.requestShapeName,Object(p.c)(o).requestOptions,o.categoryName,Object(_.a)(o.inboxClassificationFilter),Object(F.a)(o.inboxClassificationFilter),Object(v.j)(e,!0),r,r).then((function(t){"Success"===t.ResponseClass?g(e,t.Conversations,t.TotalConversationsInView,u.a):I(e,t.ResponseCode)}),(function(t){I(e)}))}var T=n(2237);function m(e,t){var n=e.rowKeys.length-1,o=e.tableQuery;(function(e,t,n,o,r,a,i,c,s,u,y,h){var g=Object(O.a)({FieldURIOrConstant:Object(d.a)({Item:Object(b.a)({Value:t})}),Item:Object(j.a)({FieldURI:"InstanceKey"})}),I=w({BasePoint:"Beginning",Condition:Object(f.a)({Item:g}),MaxEntriesReturned:n});return Object(l.d)(e,I,o,r,a,i,c,s,Object(l.j)(o),u,y,h)})(Object(v.i)(o),e.rowKeys[n],t,o.viewFilter,Object(T.a)(o),o.focusedViewFilter,o.requestShapeName,Object(p.c)(o).requestOptions,o.categoryName,Object(_.a)(o.inboxClassificationFilter),Object(F.a)(o.inboxClassificationFilter),Object(v.j)(e,!0)).then((function(t){"Success"===t.ResponseClass?g(e,t.RootFolder.Items,t.RootFolder.TotalItemsInView,u.b):I(e,t.ResponseCode)}),(function(t){I(e)}))}var C=n(2766),R=50;var L=Object(h.action)("loadMoreInTable")((function(e){return Object(c.__awaiter)(this,void 0,void 0,(function(){var t;return Object(c.__generator)(this,(function(n){if(!e)throw new Error("Selected tableview must not be null if loadMoreRows is being called.");if(e.currentLoadedIndex<e.rowKeys.length){if(e.rowKeys.length-e.currentLoadedIndex>=R)return e.currentLoadedIndex+=R,[2];e.currentLoadedIndex=e.rowKeys.length}return 0!=e.tableQuery.type&&2!=e.tableQuery.type||"spotlight"===e.tableQuery.scenarioType?1===e.tableQuery.type&&("SharedFolders"===(t=e.tableQuery).searchScope.kind?K(e):"PrimaryMailbox"===t.searchScope.kind&&M(e)):function(e){switch(e.isLoading=!0,e.tableQuery.listViewType){case 0:x(e,R);break;case 1:m(e,R)}}(e),[2]}))}))})),K=function(e){return Object(c.__awaiter)(void 0,void 0,void 0,(function(){return Object(c.__generator)(this,(function(t){switch(t.label){case 0:return[4,C.b.import()];case 1:return t.sent()(e.currentLoadedIndex-1,e,"loadMoreInTable",g,I),[2]}}))}))},M=function(e){return Object(c.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(c.__generator)(this,(function(o){switch(o.label){case 0:return t=e.rowKeys.length-1,n=e.tableQuery,t>n.lastIndexFetched?(n.lastIndexFetched=t,[4,C.c.import()]):[3,2];case 1:o.sent()(t,e,"loadMoreInTable",g,I),o.label=2;case 2:return[2]}}))}))};function S(e){setTimeout((function(){var t=v.T.tableViews.get(e);Object(a.a)(t)}),3e3)}n.d(t,"reloadTableOnTriageActionFailOrchestrator",(function(){return i})),n.d(t,"loadMoreInTable",(function(){return L})),n.d(t,"reloadInboxPostBoot",(function(){return S}))},3198:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(0);function r(e){return Object(o.__assign)({__type:"IsEqualTo:#Exchange"},e)}}}]);
//# sourceMappingURL=owa.940.js.map
self.scriptsLoaded['owa.940.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.940.js'] = (new Date()).getTime();