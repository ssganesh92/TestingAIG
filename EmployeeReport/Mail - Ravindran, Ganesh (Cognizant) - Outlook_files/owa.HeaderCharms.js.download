self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.HeaderCharms.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[321],{105:function(e,t,a){"use strict";var r,i,n;a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return n})),function(e){e[e.center=0]="center",e[e.contain=1]="contain",e[e.cover=2]="cover",e[e.none=3]="none",e[e.centerCover=4]="centerCover",e[e.centerContain=5]="centerContain"}(r||(r={})),function(e){e[e.landscape=0]="landscape",e[e.portrait=1]="portrait"}(i||(i={})),function(e){e[e.notLoaded=0]="notLoaded",e[e.loaded=1]="loaded",e[e.error=2]="error",e[e.errorLoaded=3]="errorLoaded"}(n||(n={}))},11439:function(e){e.exports=JSON.parse('{"b":"F2b","a":"G2b"}')},15212:function(e,t,a){"use strict";a.r(t);var r=a(42),i=a(3721),n=a(11439),o=a(3722),s=a(9),c=a(0),l=a(305),u=a(981),d=a(3289),m=a(1),h=a(479),b=a(3490),p=Object(r.a)((function(e,t){var a,r=function(){var t=e.behavior;if(!t)return{isActive:!1,charmOnClick:null,hostedContent:null};var a=t,r=t,o=void 0!==a.isActive?a.isActive:r.charm===Object(d.b)();return{isActive:o,charmOnClick:a.onClick||i,hostedContent:a.content||o&&r.paneComponent&&m.createElement(r.paneComponent,{onDismiss:n})}},i=function(t){Object(d.c)(e.behavior.charm)},n=function(){Object(d.a)(e.behavior.charm)},o=r(),p=e.getBadgeCount,g=e.className,f=e.title,v=e.ariaLabel,C=e.activeClassName,k=e.ariaLabelWithBadgeCount,y=p?p():0,S=h(g,b.charm,o.isActive&&C,o.isActive&&b.charmActive),O={role:u.a.button,expanded:o.isActive,hasPopup:!0,label:y>0&&k?Object(s.c)(k,y):v};return m.createElement("button",Object(c.__assign)({className:S,onClick:o.charmOnClick,title:f,"data-is-focusable":"true",ref:t},Object(u.b)(O)),(a=e.icons).iconName?[m.createElement(l.a,{className:b.suiteCharmIcon,iconName:a.iconName,key:"base"}),m.createElement(l.a,{className:b.suiteHoverCharmIcon,iconName:a.hoverIconName||a.iconName,key:"hover"})]:e.icons.charmContent,o.hostedContent,y>0&&m.createElement("div",{className:b.badgeCounter},y))}),{forwardRef:!0}),g=a(76),f=a(1712),v=a(1773),C=a(5247),k=a(8636);function y(){switch(Object(v.a)().chatProvider){case 3:return Object(C.c)();case 4:return Object(k.a)().unreadCount;default:return 0}}var S=a(1592),O=a(3047),j="https://teams.microsoft.com",w=Object(r.a)((function(e){var t=m.useRef(),a=function(e,a,r,i,n,o,s){return m.createElement(p,{ref:t,key:"skype",icons:{iconName:a,hoverIconName:a},title:r,ariaLabel:r,ariaLabelWithBadgeCount:i,behavior:{isActive:e,content:n,onClick:o,charm:0},getBadgeCount:s})};if(!Object(g.h)("fwk-skypeBusinessV2"))return O.k.isSwcInitialized&&a(O.k.isGlimpseOpen,"SkypeLogo",Object(s.b)(i.a),Object(s.b)(n.a),O.k.isGlimpseOpen&&m.createElement(O.a,{onDismiss:_,target:t.current}),x,N);var r=Object(v.a)();switch(r.chatProvider){case 3:return!Object(g.h)("fwk-skypeSuite")&&3==S.a.signInState&&a(r.isChatCalloutShown,"SkypeForBusinessLogo",Object(s.b)(o.a),Object(s.b)(n.b),r.isChatCalloutShown&&m.createElement(f.a,{onDismiss:I,target:t.current}),E,y);case 4:return!Object(g.h)("fwk-skypeSuite")&&a(r.isChatCalloutShown,"SkypeForBusinessLogo",Object(s.b)(o.a),Object(s.b)(n.b),null,E,y);case 5:return!Object(g.h)("fwk-skypeSuite")&&a(!1,"OfficeChat",Object(s.b)(o.a),Object(s.b)(n.b),void 0,L,N);default:return null}}));function _(){O.i.importAndExecute(!1)}function I(){f.d.importAndExecute(!1)}function N(){return O.h.tryImportForRender()?O.k.unreadConversationCount:null}function E(){f.d.import().then((function(e){return e(!Object(v.a)().isChatCalloutShown)}))}function x(){var e=O.k.isGlimpseOpen;O.i.importAndExecute(!e)}function L(){window.open(j)}a.d(t,"SkypeCharm",(function(){return w}))},248:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return n})),a.d(t,"c",(function(){return o}));var r=a(14),i=Object(r.mergeStyleSets)({root:{display:"inline-block"},placeholder:["ms-Icon-placeHolder",{width:"1em"}],image:["ms-Icon-imageContainer",{overflow:"hidden"}]}),n="ms-Icon",o=function(e){var t=e.className,a=e.iconClassName,r=e.isPlaceholder,n=e.isImage,o=e.styles;return{root:[r&&i.placeholder,i.root,n&&i.image,a,t,o&&o.root,o&&o.imageContainer]}}},282:function(e,t,a){"use strict";function r(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var a=[],r=0,i=e;r<i.length;r++){var n=i[r];if(n)if("string"==typeof n)a.push(n);else if(n.hasOwnProperty("toString")&&"function"==typeof n.toString)a.push(n.toString());else for(var o in n)n[o]&&a.push(o)}return a.join(" ")}a.r(t),a.d(t,"css",(function(){return r}))},305:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var r=a(378),i=a(442),n=a(248),o=Object(r.a)(i.a,n.c,void 0,{scope:"Icon"},!0)},354:function(e,t,a){"use strict";a.d(t,"c",(function(){return u})),a.d(t,"a",(function(){return d})),a.d(t,"b",(function(){return m}));var r=a(0),i=a(1),n=a(248),o=a(245),s=a(106),c=a(282),l=a(14),u=Object(o.c)((function(e){var t=Object(l.getIcon)(e)||{subset:{},code:void 0},a=t.code,r=t.subset;return a?{children:a,iconClassName:r.className,fontFamily:r.fontFace&&r.fontFace.fontFamily}:null}),void 0,!0),d=function(e){var t=e.iconName,a=e.className,o=e.style,l=void 0===o?{}:o,d=u(t)||{},m=d.iconClassName,h=d.children,b=d.fontFamily,p=Object(s.j)(e,s.k),g=e["aria-label"]?{}:{role:"presentation","aria-hidden":!0};return i.createElement("i",Object(r.__assign)({"data-icon-name":t},g,p,{className:Object(c.css)(n.a,n.b.root,m,!t&&n.b.placeholder,a),style:Object(r.__assign)({fontFamily:b},l)}),h)},m=Object(o.c)((function(e,t,a){return d({iconName:e,className:t,"aria-label":a})}))},358:function(e,t,a){"use strict";var r=a(378),i=a(444),n=a(14),o=a(104),s={root:"ms-Image",rootMaximizeFrame:"ms-Image--maximizeFrame",image:"ms-Image-image",imageCenter:"ms-Image-image--center",imageContain:"ms-Image-image--contain",imageCover:"ms-Image-image--cover",imageCenterContain:"ms-Image-image--centerContain",imageCenterCover:"ms-Image-image--centerCover",imageNone:"ms-Image-image--none",imageLandscape:"ms-Image-image--landscape",imagePortrait:"ms-Image-image--portrait"};a.d(t,"a",(function(){return c}));var c=Object(r.a)(i.a,(function(e){var t=e.className,a=e.width,r=e.height,i=e.maximizeFrame,c=e.isLoaded,l=e.shouldFadeIn,u=e.shouldStartVisible,d=e.isLandscape,m=e.isCenter,h=e.isContain,b=e.isCover,p=e.isCenterContain,g=e.isCenterCover,f=e.isNone,v=e.isError,C=e.isNotImageFit,k=e.theme,y=Object(n.getGlobalClassNames)(s,k),S={position:"absolute",left:"50% /* @noflip */",top:"50%",transform:"translate(-50%,-50%)"},O=Object(o.a)(),j=void 0!==O&&void 0===O.navigator.msMaxTouchPoints,w=h&&d||b&&!d?{width:"100%",height:"auto"}:{width:"auto",height:"100%"};return{root:[y.root,k.fonts.medium,{overflow:"hidden"},i&&[y.rootMaximizeFrame,{height:"100%",width:"100%"}],c&&l&&!u&&n.AnimationClassNames.fadeIn400,(m||h||b||p||g)&&{position:"relative"},t],image:[y.image,{display:"block",opacity:0},c&&["is-loaded",{opacity:1}],m&&[y.imageCenter,S],h&&[y.imageContain,j&&{width:"100%",height:"100%",objectFit:"contain"},!j&&w,S],b&&[y.imageCover,j&&{width:"100%",height:"100%",objectFit:"cover"},!j&&w,S],p&&[y.imageCenterContain,d&&{maxWidth:"100%"},!d&&{maxHeight:"100%"},S],g&&[y.imageCenterCover,d&&{maxHeight:"100%"},!d&&{maxWidth:"100%"},S],f&&[y.imageNone,{width:"auto",height:"auto"}],C&&[!!a&&!r&&{height:"auto",width:"100%"},!a&&!!r&&{height:"100%",width:"auto"},!!a&&!!r&&{height:"100%",width:"100%"}],d&&y.imageLandscape,!d&&y.imagePortrait,!c&&"is-notLoaded",l&&"is-fadeIn",v&&"is-error"]}}),void 0,{scope:"Image"},!0)},389:function(e,t,a){"use strict";var r;a.d(t,"a",(function(){return r})),function(e){e[e.default=0]="default",e[e.image=1]="image",e[e.Default=1e5]="Default",e[e.Image=100001]="Image"}(r||(r={}))},442:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var r=a(0),i=a(1),n=a(389),o=a(358),s=a(105),c=a(253),l=a(106),u=a(354),d=Object(c.a)({cacheSize:100}),m=function(e){function t(t){var a=e.call(this,t)||this;return a.onImageLoadingStateChange=function(e){a.props.imageProps&&a.props.imageProps.onLoadingStateChange&&a.props.imageProps.onLoadingStateChange(e),e===s.c.error&&a.setState({imageLoadError:!0})},a.state={imageLoadError:!1},a}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.children,a=e.className,s=e.styles,c=e.iconName,m=e.imageErrorAs,h=e.theme,b="string"==typeof c&&0===c.length,p=!!this.props.imageProps||this.props.iconType===n.a.image||this.props.iconType===n.a.Image,g=Object(u.c)(c)||{},f=g.iconClassName,v=g.children,C=d(s,{theme:h,className:a,iconClassName:f,isImage:p,isPlaceholder:b}),k=p?"span":"i",y=Object(l.j)(this.props,l.k,["aria-label"]),S=this.state.imageLoadError,O=Object(r.__assign)(Object(r.__assign)({},this.props.imageProps),{onLoadingStateChange:this.onImageLoadingStateChange}),j=S&&m||o.a,w=this.props["aria-label"]||this.props.ariaLabel,_=w?{"aria-label":w}:{"aria-hidden":!this.props["aria-labelledby"]&&!O["aria-labelledby"]};return i.createElement(k,Object(r.__assign)({"data-icon-name":c},_,y,{className:C.root}),p?i.createElement(j,Object(r.__assign)({},O)):t||v)},t}(i.Component)},444:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var r=a(0),i=a(1),n=a(253),o=a(106),s=a(105),c=Object(n.a)(),l=function(e){function t(t){var a=e.call(this,t)||this;return a._coverStyle=s.a.portrait,a._imageElement=i.createRef(),a._frameElement=i.createRef(),a._onImageLoaded=function(e){var t=a.props,r=t.src,i=t.onLoad;i&&i(e),a._computeCoverStyle(a.props),r&&a.setState({loadState:s.c.loaded})},a._onImageError=function(e){a.props.onError&&a.props.onError(e),a.setState({loadState:s.c.error})},a.state={loadState:s.c.notLoaded},a}return Object(r.__extends)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.src!==this.props.src?this.setState({loadState:s.c.notLoaded}):this.state.loadState===s.c.loaded&&this._computeCoverStyle(e)},t.prototype.componentDidUpdate=function(e,t){this._checkImageLoaded(),this.props.onLoadingStateChange&&t.loadState!==this.state.loadState&&this.props.onLoadingStateChange(this.state.loadState)},t.prototype.render=function(){var e=Object(o.j)(this.props,o.n,["width","height"]),t=this.props,a=t.src,n=t.alt,l=t.width,u=t.height,d=t.shouldFadeIn,m=t.shouldStartVisible,h=t.className,b=t.imageFit,p=t.role,g=t.maximizeFrame,f=t.styles,v=t.theme,C=this.state.loadState,k=void 0!==this.props.coverStyle?this.props.coverStyle:this._coverStyle,y=c(f,{theme:v,className:h,width:l,height:u,maximizeFrame:g,shouldFadeIn:d,shouldStartVisible:m,isLoaded:C===s.c.loaded||C===s.c.notLoaded&&this.props.shouldStartVisible,isLandscape:k===s.a.landscape,isCenter:b===s.b.center,isCenterContain:b===s.b.centerContain,isCenterCover:b===s.b.centerCover,isContain:b===s.b.contain,isCover:b===s.b.cover,isNone:b===s.b.none,isError:C===s.c.error,isNotImageFit:void 0===b});return i.createElement("div",{className:y.root,style:{width:l,height:u},ref:this._frameElement},i.createElement("img",Object(r.__assign)({},e,{onLoad:this._onImageLoaded,onError:this._onImageError,key:"fabricImage"+this.props.src||"",className:y.image,ref:this._imageElement,src:a,alt:n,role:p})))},t.prototype._checkImageLoaded=function(){var e=this.props.src;this.state.loadState===s.c.notLoaded&&(!!this._imageElement.current&&(e&&this._imageElement.current.naturalWidth>0&&this._imageElement.current.naturalHeight>0||this._imageElement.current.complete&&t._svgRegex.test(e))&&(this._computeCoverStyle(this.props),this.setState({loadState:s.c.loaded})))},t.prototype._computeCoverStyle=function(e){var t=e.imageFit,a=e.width,r=e.height;if((t===s.b.cover||t===s.b.contain||t===s.b.centerContain||t===s.b.centerCover)&&void 0===this.props.coverStyle&&this._imageElement.current&&this._frameElement.current){var i=void 0;i="number"==typeof a&&"number"==typeof r&&t!==s.b.centerContain&&t!==s.b.centerCover?a/r:this._frameElement.current.clientWidth/this._frameElement.current.clientHeight;var n=this._imageElement.current.naturalWidth/this._imageElement.current.naturalHeight;this._coverStyle=n>i?s.a.landscape:s.a.portrait}},t.defaultProps={shouldFadeIn:!0},t._svgRegex=/\.svg$/i,t}(i.Component)},4668:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var r=a(4),i={chats:[],isMoreChatMenuShown:!1,participantCache:new(a(24).ObservableMap)},n=Object(r.createStore)("ucmaStore",i);n()},5247:function(e,t,a){"use strict";a.d(t,"e",(function(){return i})),a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return o})),a.d(t,"d",(function(){return s})),a.d(t,"a",(function(){return c}));var r=a(4668);function i(){return Object(r.a)().chats.filter((function(e){return 1==e.state||2==e.state}))}function n(){return Object(r.a)().chats.filter((function(e){return 0==e.state}))}function o(){return Object(r.a)().chats.filter((function(e){return 0==e.state||s(e)>0})).length}function s(e){return e.lastMessageSequence-e.lastReadMessageSequence}function c(){return Object(r.a)().chats.filter((function(e){return 4==e.state}))}},8636:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var r=a(4),i=Object(r.createStore)("ucwaStore",{unreadCount:0});i()},981:function(e,t,a){"use strict";var r={alert:"alert",alertdialog:"alertdialog",application:"application",article:"article",banner:"banner",button:"button",cell:"cell",checkbox:"checkbox",columnheader:"columnheader",combobox:"combobox",complementary:"complementary",contentinfo:"contentinfo",definition:"definition",dialog:"dialog",directory:"directory",document:"document",feed:"feed",figure:"figure",form:"form",grid:"grid",gridcell:"gridcell",group:"group",heading:"heading",img:"img",link:"link",list:"list",listbox:"listbox",listitem:"listitem",log:"log",main:"main",marquee:"marquee",math:"math",menu:"menu",menubar:"menubar",menuitem:"menuitem",menuitemcheckbox:"menuitemcheckbox",menuitemradio:"menuitemradio",navigation:"navigation",note:"note",option:"option",presentation:"presentation",progressbar:"progressbar",radio:"radio",radiogroup:"radiogroup",region:"region",row:"row",rowgroup:"rowgroup",rowheader:"rowheader",scrollbar:"scrollbar",search:"search",searchbox:"searchbox",separator:"separator",slider:"slider",spinbutton:"spinbutton",status:"status",switch:"switch",tab:"tab",table:"table",tablist:"tablist",tabpanel:"tabpanel",term:"term",textbox:"textbox",timer:"timer",toolbar:"toolbar",tooltip:"tooltip",tree:"tree",treegrid:"treegrid",treeitem:"treeitem"},i=0;function n(e){return void 0===e&&(e="id"),""+e+i++}function o(e){return Array.isArray(e)?e.join(" "):e}function s(e){if(!e)return null;for(var t={},a=Object.keys(e),r=0;r<a.length;r++){switch(a[r]){case"role":t.role=e.role;break;case"id":t.id=e.id;break;case"activeDescendant":t["aria-activedescendant"]=e.activeDescendant;break;case"atomic":t["aria-atomic"]=e.atomic;break;case"autocomplete":t["aria-autocomplete"]=e.autocomplete;break;case"busy":t["aria-busy"]=e.busy;break;case"checked":t["aria-checked"]=e.checked;break;case"controls":t["aria-controls"]=o(e.controls);break;case"describedBy":t["aria-describedby"]=o(e.describedBy);break;case"disabled":t["aria-disabled"]=e.disabled;break;case"dropEffect":t["aria-dropeffect"]=o(e.dropEffect);break;case"expanded":t["aria-expanded"]=e.expanded;break;case"flowTo":t["aria-flowto"]=o(e.flowTo);break;case"grabbed":t["aria-grabbed"]=e.grabbed;break;case"hasPopup":t["aria-haspopup"]=e.hasPopup;break;case"hidden":t["aria-hidden"]=e.hidden;break;case"invalid":t["aria-invalid"]=e.invalid;break;case"label":t["aria-label"]=e.label;break;case"labelledBy":t["aria-labelledby"]=o(e.labelledBy);break;case"level":t["aria-level"]=e.level;break;case"live":t["aria-live"]=e.live;break;case"multiline":t["aria-multiline"]=e.multiline;break;case"multiselectable":t["aria-multiselectable"]=e.multiselectable;break;case"orientation":t["aria-orientation"]=e.orientation;break;case"owns":t["aria-owns"]=o(e.owns);break;case"positionInSet":t["aria-posinset"]=e.positionInSet;break;case"pressed":t["aria-pressed"]=e.pressed;break;case"readonly":t["aria-readonly"]=e.readonly;break;case"relevant":t["aria-relevant"]=o(e.relevant);break;case"required":t["aria-required"]=e.required;break;case"selected":t["aria-selected"]=e.selected;break;case"setSize":t["aria-setsize"]=e.setSize;break;case"sort":t["aria-sort"]=e.sort;break;case"valueMax":t["aria-valuemax"]=e.valueMax;break;case"valueMin":t["aria-valuemin"]=e.valueMin;break;case"valueNow":t["aria-valuenow"]=e.valueNow;break;case"valueText":t["aria-valuetext"]=e.valueText}}return t}a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return n})),a.d(t,"b",(function(){return s}))}}]);
//# sourceMappingURL=owa.HeaderCharms.js.map
self.scriptsLoaded['owa.HeaderCharms.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.HeaderCharms.js'] = (new Date()).getTime();