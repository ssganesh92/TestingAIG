self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.ItemActions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[350,78],{10390:function(e){e.exports=JSON.parse('{"a":"g_c"}')},10391:function(e){e.exports=JSON.parse('{"a":"f_c"}')},1072:function(e,t,n){"use strict";var r;!function(e){e[e.Auto=0]="Auto",e[e.Init=1]="Init",e[e.LeftNavResizeExpand=2]="LeftNavResizeExpand",e[e.ToggleExpand=3]="ToggleExpand",e[e.ToggleCollapse=4]="ToggleCollapse",e[e.WindowResize=5]="WindowResize",e[e.ToggleFolderPane=6]="ToggleFolderPane",e[e.DateRangeTypeChange=7]="DateRangeTypeChange"}(r||(r={}));var o=r,i=n(4),a=Object(i.createStore)("OwaLayout",{browserWidthBucket:null});function c(){var e=a().browserWidthBucket;return e||void 0}var s=Object(i.mutatorAction)("setBrowserWidthBucket",(function(e){a().browserWidthBucket=e})),u=n(2);var d=Object(i.action)("onAvailableWidthBucketChanged",(function(e,t){return{availableWidthBucket:e,source:t}})),l=!1;function m(e){window.addEventListener("resize",f),l=e,b(o.Init)}function f(){b(o.WindowResize)}function b(e){var t,n,r,i=(t=e!=o.Init,n=l,r=Object(u.h)(t),n&&(r>1900?r-=305:r>990&&(r-=165)),r>=1600?1600:r>=1400?1599:r>=1366?1399:r>=1301?1365:r>=1239?1300:r>=1200?1238:r>=1080?1199:r>=1e3?1079:r>=919?999:r>=900?918:r>=866?899:r>=769?865:r>=692?768:r>=686?691:r>=580?685:r>=555?579:r>=542?554:r>=500?541:r>=419?499:418);a().browserWidthBucket!=i&&(s(i),i<=418?p():O(),d(i,e))}function p(){var e;(null===(e=window.document)||void 0===e?void 0:e.body)&&(document.body.style.overflowX="auto")}function O(){var e;(null===(e=window.document)||void 0===e?void 0:e.body)&&(document.body.style.overflow="hidden")}var v=n(49);function h(){return j()}function j(){return Object(v.k)()||Object(v.d)()}n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"f",(function(){return m})),n.d(t,"b",(function(){return p})),n.d(t,"e",(function(){return O})),n.d(t,"d",(function(){return h})),n.d(t,"g",(function(){return j})),n.d(t,"h",(function(){return d}))},1093:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return u}));var r=n(108),o=n(1397);n.d(t,"a",(function(){return o.a}));var i=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(427)]).then(n.bind(null,2801))})),a=Object(r.d)(i,(function(e){return e.NotificationBarHost})),c=new r.a(i,(function(e){return e.showNotification})),s=new r.a(i,(function(e){return e.dismissNotification})),u=new r.b(i,(function(e){return e.clearNotificationBar}))},1285:function(e,t,n){"use strict";var r=n(4),o=Object(r.action)("openTimePanel",(function(e){return{source:e}})),i=Object(r.action)("handleTimePanelClosed",(function(e,t,n,r){return{source:e,sessionDuration:t,lastView:n,clientItemId:r}})),a=Object(r.action)("popView"),c=n(76);function s(){return Object(c.h)("cal-time-panel")}var u=n(556);function d(){return(!Object(u.v)()||!window.opener)&&s()}var l=n(1161);function m(){return d()&&Object(l.c)()}n.d(t,"e",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return a})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return m}))},1331:function(e,t,n){"use strict";var r={};n.r(r),n.d(r,"add",(function(){return u})),n.d(r,"remove",(function(){return d})),n.d(r,"removeAll",(function(){return l})),n.d(r,"getCount",(function(){return m})),n.d(r,"getTombstonedReasons",(function(){return f})),n.d(r,"clearMapForFolder",(function(){return b})),n.d(r,"removeRowsFromTombstone",(function(){return p}));var o=n(0),i=n(4),a=Object(i.createStore)("tombstone",{folderTombstoneMap:{}}),c=(a(),n(254)),s=n(283),u=Object(s.action)("tombstoneOperations.add")((function(e,t,n){var r=a().folderTombstoneMap;t in r||(r[t]={});var o=r[t];e.forEach((function(e){var t=o[e];t?3!=n?t.indexOf(3)>-1||-1==t.indexOf(n)&&t.push(n):o[e]=[3]:o[e]=[n]}))})),d=Object(s.action)("tombstoneOperations.remove")((function(e,t,n){var r=a().folderTombstoneMap;if(t in r){var o=r[t],i=o[e],c=i?i.indexOf(n):-1;if(-1==c)throw new Error("tombstone.remove given reason does not exist when trying to remove entry from it");i.splice(c,1),0==i.length&&delete o[e],0==Object.keys(o).length&&delete r[t]}})),l=Object(s.action)("tombstoneOperations.removeAll")((function(){a().folderTombstoneMap={},Object(c.p)("TnS_RemoveAllFromTombstone")})),m=function(e,t){var n=a().folderTombstoneMap;if(!(e in n))return 0;var r=0,o=n[e];return Object.values(o).forEach((function(e){e==t&&r++})),r},f=function(e,t){var n=a().folderTombstoneMap;if(t in n){var r=n[t][e];if(r)return r}return[]},b=Object(s.action)("tombstoneOperations.clearMapForFolder")((function(e){var t=a().folderTombstoneMap;t[e]&&(Object(c.p)("TnS_ClearFolderMapInTombstone",[Object.keys(t[e]).length]),delete t[e])})),p=Object(s.action)("tombstoneOperations.removeRowsFromTombstone")((function(e,t){var n,r,i=a().folderTombstoneMap;if(t in i){var c=i[t];try{for(var s=Object(o.__values)(e),u=s.next();!u.done;u=s.next()){var d=u.value;d in c&&delete c[d]}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}0==Object.keys(c).length&&delete i[t]}}));t.a=r},13794:function(e){e.exports=JSON.parse('{"f":"B_c","d":"C_c","k":"D_c","j":"E_c","i":"F_c","e":"G_c","h":"H_c","l":"I_c","b":"J_c","c":"K_c","g":"L_c","a":"M_c"}')},13795:function(e,t,n){var r=n(13796),o=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},13796:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,'.tZW9JCrS32YC2HkVN-WyY{display:block!important}.Isabp7l92KgYue--mXACT{width:auto;height:32px}html[dir] .Isabp7l92KgYue--mXACT{border-radius:2px;background:transparent}html[dir] .Isabp7l92KgYue--mXACT:hover{background-color:"[theme:themeLighterAlt, default:#EFF6FC]"}html[dir] .Isabp7l92KgYue--mXACT:active{background-color:"[theme:themeLight, default:#C7E0F4]"}html[dir] .Isabp7l92KgYue--mXACT._3i2_PWR38mmJG6N-oVvSc{background-color:"[theme:themeLighter, default:#DEECF9]"}.Isabp7l92KgYue--mXACT._3i2_PWR38mmJG6N-oVvSc.ms-Button .ms-Button-icon,.Isabp7l92KgYue--mXACT._3i2_PWR38mmJG6N-oVvSc.ms-Button .ms-Button-menuIcon,.Isabp7l92KgYue--mXACT:active.ms-Button .ms-Button-icon,.Isabp7l92KgYue--mXACT:active.ms-Button .ms-Button-menuIcon,.Isabp7l92KgYue--mXACT:hover.ms-Button .ms-Button-icon,.Isabp7l92KgYue--mXACT:hover.ms-Button .ms-Button-menuIcon{color:"[theme:themeDarker, default:#004578]"}html[dir] .bW0ipvHhaLslVzcuqolhK{background-color:"[theme:themeLighterAlt, default:#EFF6FC]"!important}.aX3RmEGx8HrdPL1yktLRm{width:230px}html[dir] .aX3RmEGx8HrdPL1yktLRm{background-color:"[theme:white, default:#ffffff]"}._3EVsmMkXoUVhUDeorDNq-T{max-height:400px;overflow-x:hidden}._3dfPy9ayr523z3j8V0vi53{overflow:hidden}._3nLjv484RsToOL5jRMWQLH{height:44px}html[dir=ltr] ._3nLjv484RsToOL5jRMWQLH{padding-left:12px}html[dir=rtl] ._3nLjv484RsToOL5jRMWQLH{padding-right:12px}html[dir] ._3nLjv484RsToOL5jRMWQLH:hover{background-color:"[theme:neutralLighter, default:#f4f4f4]"}',""]),t.locals={likeCustomButtonLabel:"tZW9JCrS32YC2HkVN-WyY",likeIconButtonCustom:"Isabp7l92KgYue--mXACT",isChecked:"_3i2_PWR38mmJG6N-oVvSc",likeCustomButtonActive:"bW0ipvHhaLslVzcuqolhK",callout:"aX3RmEGx8HrdPL1yktLRm",scrollContainer:"_3EVsmMkXoUVhUDeorDNq-T",personaCollection:"_3dfPy9ayr523z3j8V0vi53",persona:"_3nLjv484RsToOL5jRMWQLH"}},13797:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,'html[dir=ltr] ._2opPWe6KuVFhEI52_XY6Tw{padding-right:2px}html[dir=rtl] ._2opPWe6KuVFhEI52_XY6Tw{padding-left:2px}._3tBxnKAWFWDe41Zarl9mN{width:100%;min-width:0;height:40px;display:inline-block;-webkit-box-ordinal-group:2;-ms-flex-order:1;order:1;position:relative;top:1px}html[dir=ltr] ._3tBxnKAWFWDe41Zarl9mN{left:2px}html[dir=rtl] ._3tBxnKAWFWDe41Zarl9mN{right:2px}._20q0GP-4M43aJdIUNdbHS_{font-size:14px;color:"[theme:themePrimary, default:#0078D4]"}html[dir] ._20q0GP-4M43aJdIUNdbHS_{background:transparent}._3CHzUb8E75dSDcMFHT_8Qx{height:32px}html[dir] ._3CHzUb8E75dSDcMFHT_8Qx{background-color:transparent;padding:4px 0}.eeijf3m13i_oYyGsPmueH{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}._3ODQEP4a8av7UYmYAIFIRW{height:100%;min-width:32px}html[dir] ._3ODQEP4a8av7UYmYAIFIRW{background-color:transparent;margin:0 2px}._2O1OZ_6q64cOi7BcKWHTR7.ms-ContextualMenu-icon,._2i4F3Q0eiaJ5u4aiXx5D3w:not(._20q0GP-4M43aJdIUNdbHS_),._3ODQEP4a8av7UYmYAIFIRW .ms-Button-label{display:none}._1MncjFzxk89g--zyj1v5O5{width:32px;height:32px}html[dir] ._1MncjFzxk89g--zyj1v5O5{border-radius:2px;background:transparent}._1MncjFzxk89g--zyj1v5O5.ms-Button{width:32px;height:32px}html[dir] ._1MncjFzxk89g--zyj1v5O5:hover{background-color:"[theme:themeLighterAlt, default:#EFF6FC]"}html[dir] ._1MncjFzxk89g--zyj1v5O5:active{background-color:"[theme:themeLight, default:#C7E0F4]"}html[dir] ._1MncjFzxk89g--zyj1v5O5._37fr-TjgFabRfitZmzNqlN{background-color:"[theme:themeLighter, default:#DEECF9]"}._1MncjFzxk89g--zyj1v5O5._37fr-TjgFabRfitZmzNqlN.ms-Button .ms-Button-icon,._1MncjFzxk89g--zyj1v5O5._37fr-TjgFabRfitZmzNqlN.ms-Button .ms-Button-menuIcon,._1MncjFzxk89g--zyj1v5O5:active.ms-Button .ms-Button-icon,._1MncjFzxk89g--zyj1v5O5:active.ms-Button .ms-Button-menuIcon,._1MncjFzxk89g--zyj1v5O5:hover.ms-Button .ms-Button-icon,._1MncjFzxk89g--zyj1v5O5:hover.ms-Button .ms-Button-menuIcon{color:"[theme:themeDarker, default:#004578]"}.aZVJsA6Ilr8olDTFGKR6T{color:"[theme:themePrimary, default:#0078D4]"}._3DE4Hx2dldBiXVAxb2jkoh{color:"[theme:neutralTertiary, default:#a6a6a6]"}html[dir] ._3of7CI7D6gm5OF90xXEWK0{background-color:transparent}',""]),t.locals={surfaceActionsCommandBarCharms:"_2opPWe6KuVFhEI52_XY6Tw",surfaceActionsCommandBarContainer:"_3tBxnKAWFWDe41Zarl9mN",surfaceActionsCommandBarOverflowIcon:"_20q0GP-4M43aJdIUNdbHS_",surfaceActionsCommandBar:"_3CHzUb8E75dSDcMFHT_8Qx",surfaceActionsCommandBarPrimarySet:"eeijf3m13i_oYyGsPmueH",surfaceActionsCommandBarButton:"_3ODQEP4a8av7UYmYAIFIRW",commandBarIcon:"_2O1OZ_6q64cOi7BcKWHTR7",commandBarMenuIcon:"_2i4F3Q0eiaJ5u4aiXx5D3w",iconButton:"_1MncjFzxk89g--zyj1v5O5",isChecked:"_37fr-TjgFabRfitZmzNqlN",enabledIconButton:"aZVJsA6Ilr8olDTFGKR6T",disabledIconButton:"_3DE4Hx2dldBiXVAxb2jkoh",disabledReplyActionButton:"_3of7CI7D6gm5OF90xXEWK0"}},1390:function(e,t,n){"use strict";var r=n(1550),o=n(76),i=n(984),a=n(581);function c(){return Object(o.h)("auth-cloudCache")&&(Object(i.b)()||Object(i.c)())&&Object(a.a)()||Object(r.a)()}n.d(t,"a",(function(){return c}))},1397:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.PrimaryActionClicked=0]="PrimaryActionClicked",e[e.SecondaryActionClicked=1]="SecondaryActionClicked",e[e.DismissClicked=2]="DismissClicked",e[e.AutoDismissed=3]="AutoDismissed",e[e.MouseLeaveAfterTimerCompleted=4]="MouseLeaveAfterTimerCompleted",e[e.NotificationBarUnmounted=5]="NotificationBarUnmounted"}(r||(r={}))},14992:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(554),i=n(1684),a=n(687),c=n(100),s=n(967),u=n(898),d=n(236),l=n(428),m=n(1065),f=n(1),b=n(13794),p=n(9),O=n(27),v=100;function h(e){try{if(e.LikeCount&&e.Likers){var t=Object(O.a)().SessionSettings.UserEmailAddress,n=!!e.Likers&&e.Likers.some((function(e){return e.EmailAddress===t}));switch(e.LikeCount){case 1:return n?Object(p.b)(b.f):Object(p.c)(Object(p.b)(b.d),e.Likers[0].Name);case 2:return n?Object(p.c)(Object(p.b)(b.k),e.Likers.filter((function(e){return e.EmailAddress!==t}))[0].Name):Object(p.c)(Object(p.b)(b.j),e.Likers[0].Name,e.Likers[1].Name);case 3:return n?Object(p.c)(Object(p.b)(b.i),e.Likers[0].Name,Object(p.b)(b.e)):Object(p.c)(Object(p.b)(b.h),e.Likers[0].Name,e.Likers[1].Name,Object(p.b)(b.e));default:return n?e.LikeCount>=v?Object(p.c)(Object(p.b)(b.l),v-1):Object(p.c)(Object(p.b)(b.b),e.Likers[0].Name,Object(p.c)(Object(p.b)(b.c),e.LikeCount-2)):e.LikeCount>=v?Object(p.c)(Object(p.b)(b.g),v-1):Object(p.c)(Object(p.b)(b.a),e.Likers[0].Name,e.Likers[1].Name,Object(p.c)(Object(p.b)(b.c),e.LikeCount-2))}}}catch(e){return null}return null}function j(e){return e.LikeCount?e.LikeCount<v?e.LikeCount.toString():v-1+"+":null}var I=n(1216),g=n(13795),k=n(8031),_=n(479),y=function(e){function t(t){var n=e.call(this,t)||this;return n.onDismissCallOut=function(){n.setState(Object(r.__assign)(Object(r.__assign)({},n.state),{isMouseOverButton:!1,isMouseOverLikersList:!1}))},n.onLikeClicked=function(e){var t=e;n.props.surfaceActionItem.onClick(t,n.props.surfaceActionItem),t.stopPropagation()},n.handleMouseOver=function(){n.state.isMouseOverButton||n.setState({isMouseOverButton:!0})},n.handleMouseLeave=function(){n.state.isMouseOverButton&&n.setState({isMouseOverButton:!1})},n.handleLikersListMouseOver=function(){n.state.isMouseOverLikersList||n.setState({isMouseOverLikersList:!0})},n.handleLikersListMouseLeave=function(){n.state.isMouseOverLikersList&&n.setState({isMouseOverLikersList:!1})},n.state={isMouseOverButton:!1,isMouseOverLikersList:!1},n}return Object(r.__extends)(t,e),t.prototype.IsLikersListShown=function(){return this.state.isMouseOverLikersList},t.prototype.render=function(){var e=this.props,t=e.surfaceActionItem,n=e.message,r=n.LikeCount&&n.Likers&&(this.state.isMouseOverButton||this.state.isMouseOverLikersList),o="likeButtonId"+Object(l.a)();return f.createElement(u.a,{content:t.ariaLabel},f.createElement(i.a,{id:o,role:"button",ariaLabel:t.ariaLabel,ariaDescription:h(n),iconProps:t.iconProps,styles:{root:_(k.surfaceActionsCommandBarButton,g.likeIconButtonCustom,r&&g.likeCustomButtonActive),label:n.LikeCount&&g.likeCustomButtonLabel,rootChecked:k.checkedCommandBarButton,rootDisabled:k.disabledReplyActionButton,icon:k.enabledIconButton,iconDisabled:k.disabledIconButton,menuIcon:k.commandBarMenuIcon},onClick:this.onLikeClicked,onMouseEnter:this.handleMouseOver,onMouseOver:this.handleMouseOver,onMouseLeave:this.handleMouseLeave,text:j(n)}),r&&f.createElement(a.a,{className:g.callout,onDismiss:this.onDismissCallOut,target:"#"+o,isBeakVisible:!1,setInitialFocus:!1,directionalHint:Object(d.a)()?c.DirectionalHint.bottomLeftEdge:c.DirectionalHint.bottomRightEdge},f.createElement("div",{className:_(g.scrollContainer,"customScrollBar"),onMouseEnter:this.handleLikersListMouseOver,onMouseOver:this.handleLikersListMouseOver,onMouseLeave:this.handleLikersListMouseLeave},f.createElement("div",{className:g.personaCollection},n.Likers.map((function(e){return f.createElement(C,{key:e.EmailAddress,emailAddress:e.EmailAddress,name:e.Name,mailBoxType:e.MailboxType,disableHover:!0,clientScenario:"Liker"},f.createElement(m.a,{className:g.persona,key:e.EmailAddress,name:e.Name,emailAddress:e.EmailAddress,size:s.c.size32,showPersonaDetails:!0,mailboxType:e.MailboxType}))}))))))},t=Object(r.__decorate)([o.observer],t)}(f.Component);function C(e){var t=Object(I.a)(e);return f.createElement(t,null,f.createElement("div",null,e.children))}var S=n(123),w=Object(S.d)("toggleUndoDarkMode",{name:function(e){return e.undoDarkMode?"ToggleDarkModeOn":"ToggleDarkModeOff"},actionSource:"ReadingPane"})((function(e){e&&(e.undoDarkMode=!e.undoDarkMode)}));function A(e){return function(t){t.stopPropagation(),w(e)}}function M(e,t){var n="RPCSAPinned";return(null==e?void 0:e.renderedInOverflow)&&(n=e.isPinned?"RPCSAOverflow":"RPCSANotPinned"),t||n}var P=n(1636);function B(e,t){return function(n,r){n.stopPropagation(),P.b.import().then((function(n){n(e.Sender.Mailbox,e.ItemId.Id,M(r,t))}))}}var x=n(3969),R=n(1475);function T(e,t){return function(n){n.stopPropagation(),P.e.importAndExecute(e.ItemId.Id,[t],x.a),R.b.importAndExecute()}}var F=n(4625);function D(e,t){return function(n,r){n.stopPropagation(),F.a.import().then((function(n){n(e,M(r,t))}))}}function L(e,t){var n;return e.isConversationItemPart?null===(n=t.ConversationId)||void 0===n?void 0:n.Id:null}var E=n(2520),N=n(10224),z=n(9144),H=n(4631);function K(e,t,n){return function(r){r.stopPropagation();var o=L(e,t);if(o){var i=Object(N.b)(o,e);P.i.importAndExecute([t.ItemId.Id],Object(H.a)(t.ItemId.Id),[n],x.a,t.MailboxInfo,!0).then((function(){Object(z.a)(i,o)}))}else P.i.importAndExecute([t.ItemId.Id],Object(H.a)(t.ItemId.Id),[n],x.a,t.MailboxInfo).then((function(){Object(E.a)()}))}}var U=n(1292),W=n(947);function V(e,t,n){return function(o){o.stopPropagation(),U.h.importAndExecute(Object(r.__assign)(Object(r.__assign)({},e.ItemId),{mailboxInfo:e.MailboxInfo}),x.a,[t],Object(W.X)(Object(W.C)()),{targetWindow:n})}}function J(e){return function(t){t.stopPropagation(),P.q.importAndExecute(e.ItemId.Id,Object(W.C)(),x.a).then((function(){Object(E.a)()})),R.b.importAndExecute()}}var Y=n(7711),X=n(5510);function G(e,t){var n=this;return function(o){o.stopPropagation(),Object(X.a)(t.itemId,null,e.MailboxInfo,(function(){return Object(r.__awaiter)(n,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Y.a.import()];case 1:return[2,e.sent()(Object(W.C)())]}}))}))}))}}var Q=n(5154);function q(e){return function(t){t.stopPropagation(),Object(Q.a)(Object(r.__assign)(Object(r.__assign)({},e.ItemId),{mailboxInfo:e.MailboxInfo}),x.a)}}var Z=n(9136);function $(e,t,n,r){return function(o){Object(Z.a)(!1,t.isConversationItemPart,n,e,r,o)}}function ee(e,t,n,r){return function(o){Object(Z.a)(!0,t.isConversationItemPart,n,e,r,o)}}var te=n(1712);function ne(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o,i,a;return Object(r.__generator)(this,(function(c){switch(c.label){case 0:return[4,U.i.import()];case 1:return[4,c.sent()(t,e)];case 2:return n=r.__read.apply(void 0,[c.sent(),2]),o=n[0],i=n[1],(a=Object(r.__spread)(o,i).map((function(e){return e.SipUri?e.SipUri:"sip:"+e.EmailAddress}))).length>0&&te.e.import().then((function(n){return n(a,t.Subject,e?3:2)})),[2]}}))}))}function re(e){return function(t){ne(!0,e)}}function oe(e){return function(t){ne(!1,e)}}var ie=n(9027);function ae(e){return function(t){t.stopPropagation();var n=Object(W.R)(e)?e:null;Object(ie.a)(e.ItemId.Id,null,!1,x.a,null,null==n?void 0:n.InternetMessageId)}}var ce=n(7940);function se(e,t){return function(n){n.stopPropagation(),ce.b.importAndExecute(e,Object(W.C)(),[t],x.a),R.b.importAndExecute()}}var ue=n(5496);function de(e,t){return function(n,o){n.stopPropagation(),Object(ue.d)(Object(r.__assign)(Object(r.__assign)({},e.ItemId),{mailboxInfo:e.MailboxInfo}),x.a,M(o,t))}}var le=n(283),me=Object(le.action)("toggleAmpPreference")((function(e){e.preferAmp=!e.preferAmp}));function fe(e){return function(t){t.stopPropagation(),me(e.ampViewState)}}function be(e,t){return function(n){n.stopPropagation();var r="Flagged"!=e.Flag.FlagStatus?"Flagged":"NotFlagged";P.K.importAndExecute([e.ItemId.Id],[t],{FlagStatus:r},Object(W.D)(),x.a)}}function pe(e,t){return function(n){n.stopPropagation(),P.r.importAndExecute(e.ItemId.Id,Object(W.C)(),x.a,[t]).then((function(){Object(E.a)()})),R.b.importAndExecute()}}var Oe=n(2184);function ve(e,t){return function(n){n.stopPropagation();var r=e;Oe.c.importAndExecute(e.ItemId.Id,Object(W.C)(),!r.IsRead,[t],x.a)}}var he=n(7942),je=n(9141);function Ie(e,t){return function(n){var r;n.stopPropagation(),he.d.importAndExecute(e.ItemId.Id,Object(je.a)(null===(r=e.ConversationId)||void 0===r?void 0:r.Id),t.isConversationItemPart,!0)}}var ge=n(8240),ke=n(254);function _e(e,t){return function(n,r){n.stopPropagation(),Object(ke.o)("ViewMessageSource",{subActionSource:M(r,t)},{actionSource:x.a}),Object(ge.a)(e)}}function ye(e){var t,n,r=Object(W.R)(e)?e:null;if(null==r)return null;var o=null===(t=r.Sender)||void 0===t?void 0:t.Mailbox;if(o){var i=Ce(o);if(i)return i}var a=null===(n=r.From)||void 0===n?void 0:n.Mailbox;if(a){var c=Ce(a);if(c)return c}return null}function Ce(e){return"GroupMailbox"==e.MailboxType||Object(p.f)(e.EmailAddress)?null:Object(p.f)(e.Name)?e.EmailAddress:e.Name}var Se=n(114);function we(e){var t;return!((null===(t=null==e?void 0:e.MailboxInfo)||void 0===t?void 0:t.type)!==Se.a.GroupMailbox)}var Ae=n(948),Me=n(953);function Pe(e,t){return!we(t)&&(Object(Ae.C)(e,Me.h)||Object(Ae.C)(e,Me.c)||Object(Ae.C)(e,Me.j)||Object(Ae.C)(e,"favorites"))}var Be=n(4933),xe=n(1259);function Re(e){return!Object(xe.a)(e.ParentFolderId.Id,"drafts")&&e.Sender&&e.Sender.Mailbox&&!Object(Be.a)(e.Sender.Mailbox.EmailAddress)&&null!=ye(e)}var Te=n(9635);function Fe(e,t){return Object(Te.a)(e)||!t.TranslationData||!t.TranslationData.userLanguage||t.TranslationData.isShowingTranslation||t.TranslationData.isTranslating}var De=n(24),Le=n(42),Ee=n(2693),Ne=n(233),ze=n(78),He=n(9107),Ke=n(1097),Ue=n(76),We=n(4819),Ve=n(4820),Je=n(4821),Ye=n(4822),Xe=n(4193),Ge=n(3249),Qe=n(2659),qe=n(6417),Ze=n(4050),$e=n(10390),et=n(10391),tt=n(3851),nt=n(4043),rt=n(3741),ot=n(1516),it=n(2248),at=n(3502),ct=n(3251),st=n(4707),ut=n(3254),dt=n(5190),lt=n(2838),mt=n(1416),ft=n(295),bt=n(3586),pt=n(1359),Ot=n(7791),vt=n(8032),ht=n(3112),jt=n(960),It=n(1049),gt=n(8031),kt=n(308).bind(gt),_t=5,yt=function(e){function t(t){var n=e.call(this,t)||this;return n.commandBarHiddenOverflowItems=[],n.commandBarDividerKey=0,n.likeButtonClickCount=0,n.likeUnlikeInProgress=!1,n.forcePinnedSurfaceActions=new Set,n.getHandler=function(e,t,r){return function(o,i){Object(ht.l)(!1,r,i,M(i,n.props.actionSource)),t?(n.updateSelectItemPart(),e(o,i)):o.which==ze.a.enter&&(o.preventDefault(),o.stopPropagation(),n.updateSelectItemPart(),e(o,i))}},n.updateSelectItemPart=function(){var e;n.props.viewState.isConversationItemPart&&Object(st.a)(null===(e=n.props.item.ConversationId)||void 0===e?void 0:e.Id,n.props.viewState,!1)},n.getRef=function(e){n.commandBar=e},n.ItemHeaderToolbarButton=Object(Le.a)((function(e){return f.createElement(i.a,Object(r.__assign)({},e,{menuProps:e.menuProps&&Object(r.__assign)(Object(r.__assign)({},e.menuProps),{directionalHint:c.DirectionalHint.bottomAutoEdge}),onMenuClick:n.updateSelectItemPart,styles:Object(r.__assign)(Object(r.__assign)({},e.styles),{root:kt(gt.surfaceActionsCommandBarButton,gt.iconButton),rootChecked:gt.checkedCommandBarButton,rootDisabled:gt.disabledReplyActionButton,icon:gt.enabledIconButton,iconDisabled:gt.disabledIconButton,menuIcon:gt.commandBarMenuIcon}),role:"button"}))})),n.ItemHeaderToolbarOverflowButton=Object(Le.a)((function(e){var t=n.ItemHeaderToolbarButton;return f.createElement(u.a,{content:Object(p.b)(qe.a)},f.createElement(t,Object(r.__assign)({},e)))})),n.onCommandBarReduceData=function(e){var t=e.primaryItems,o=e.overflowItems,i=e.cacheKey,a=t[0];if(void 0!==a)return n.commandBarHiddenOverflowItems=Object(r.__spread)([a],n.commandBarHiddenOverflowItems),t=t.slice(1),i=n.computeCommandBarCacheKey(t),Object(r.__assign)(Object(r.__assign)({},e),{primaryItems:t,overflowItems:o,cacheKey:i})},n.onCommandBarGrowData=function(e){var t=e.primaryItems,o=e.overflowItems,i=e.cacheKey,a=n.commandBarHiddenOverflowItems[0];if(void 0!==a)return n.commandBarHiddenOverflowItems=n.commandBarHiddenOverflowItems.slice(1),t=Object(r.__spread)([a],t),i=n.computeCommandBarCacheKey(t),Object(r.__assign)(Object(r.__assign)({},e),{primaryItems:t,overflowItems:o,cacheKey:i})},n.onResize=function(){n.commandBar&&n.commandBar.remeasure()},n.onLikeUnLike=function(){return function(e,t){e.stopPropagation(),!n.likeUnlikeInProgress&&t&&(n.likeUnlikeInProgress=!0,n.asyncLikeItem(t))}},n.asyncLikeItem=function(e){return Object(r.__awaiter)(n,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,P.p.import()];case 1:return e=t.sent(),this.likeButtonClickCount++,e(Object(r.__assign)(Object(r.__assign)({},this.props.item.ItemId),{mailboxInfo:this.props.item.MailboxInfo}),this.props.item,Object(W.C)(),this.likeButtonClickCount>=_t,this.props.instrumentationContext),this.likeUnlikeInProgress=!1,[2]}}))}))},n.renderLikeCustomButtonMenuItem=function(e){return f.createElement(y,{surfaceActionItem:e,message:n.props.item})},n.state={addinsInitializedState:0},n}return Object(r.__extends)(t,e),t.prototype.createCommandBarItems=function(){var e=this;this.commandBarHiddenOverflowItems=[];var t=[],n=[],o=Object(ht.i)(),i=this.props.customizedSubsetActionKeys&&this.props.customizedSubsetActionKeys.length>0?o.filter((function(t){return e.props.customizedSubsetActionKeys.indexOf(t.key)>-1})):o,a=Object(r.__read)(Object(ct.a)(this.props.item,this.props.viewState.isConversationItemPart),3),c=a[0],s=a[1],u=a[2],d=Object(lt.a)(this.props.item);return i.forEach((function(o){var i=e.tryCreateStaticActionCommandBarItem(o,d,c,s,u);if(i){var a=o.key;if(e.props.hideSurfaceButton)e.addItemToCommandBarOverflow(a,n,i);else{var l=i,m=Object(ht.o)(a,e.props.item)||e.forcePinnedSurfaceActions.has(a);m&&!Object(ht.j)(a)&&e.forcePinnedSurfaceActions.add(a),m&&(l=Object(r.__assign)({},i),e.addItemToCommandBarSurface(a,t,i)),e.addItemToCommandBarOverflow(a,n,l)}}})),this.tryCreateAddinsCommandBarItems(t,n),{items:this.props.hideSurfaceButton?[]:t,overflowItems:n}},t.prototype.addItemToCommandBarSurface=function(e,t,n){n.isPinned=!0,Object(ht.p)(e)?t.push(n):t.unshift(n)},t.prototype.addItemToCommandBarOverflow=function(e,t,n){n.renderedInOverflow=!0,n.onRender=null,"-"==e?this.tryAddDivider(t,n):t.push(n)},t.prototype.tryAddDivider=function(e,t){var n=e.length;n>0&&e[n-1].displayName!=ht.a&&e.push(t)},t.prototype.tryCreateStaticActionCommandBarItem=function(e,t,n,r,o){if(e.hideInGroup&&we(this.props.item)||e.hideInSxS&&this.props.isItemAttachment)return null;var i,a=e.key,c=Object(ht.g)(a),s=Object(ht.h)(a).iconName,u=null,d=!1,l=null,m=e.key,f=this.props,b=f.item,v=f.viewState,h=f.instrumentationContext,j=f.actionSource,I=b;switch(a){case"LikeUnlike":if(!Object(ft.a)()&&!Object(Ae.C)(I.ParentFolderId.Id,Me.j)){var g=Object(O.a)().SessionSettings.UserEmailAddress,k=!!I.Likers&&I.Likers.some((function(e){return e.EmailAddress===g}));i=this.onLikeUnLike(),k&&(s="LikeSolid",c=Object(p.b)(vt.e)),Object(ht.o)(a,b)&&(l=this.renderLikeCustomButtonMenuItem)}break;case"ToggleAmp":var _=v.ampViewState,y=_.preferAmp,C=_.ampAvailability;Object(rt.a)()&&C==nt.a.AmpValidated&&(c=y?Object(p.b)(et.a):Object(p.b)($e.a),m=y?"ViewAsOriginal":"ViewAsDynamic",i=fe(v),y&&(s="LightningBoltSolid"));break;case"Reply":i=$(h,v,b,this.props.targetWindow),d=n;break;case"ReplyAll":i=ee(h,v,b,this.props.targetWindow),d=r;break;case"Forward":i=V(b,h,this.props.targetWindow),d=o;break;case"ReplyByMeeting":i=ae(b),d=Object(pt.a)(b)||!!b.RightsManagementLicenseData;break;case"Popout":i=G(b,v);break;case"Delete":!this.props.isItemAttachment&&Object(it.b)(9)&&(i=K(v,b,h),d=!!we(b)&&!I.CanDelete);break;case"MarkReadUnread":this.isGroupPopout()||(c=I.IsRead?Object(p.b)(Qe.a):Object(p.b)(Ge.a),m=I.IsRead?"MarkItemUnread":"MarkItemRead",i=ve(b,h),I.IsRead||(s="Read"));break;case"FlagUnflag":if(Object(it.b)(11)){var S=!I.Flag||"Flagged"!=I.Flag.FlagStatus;c=S?Object(p.b)(Ve.a):Object(p.b)(vt.d),m=S?"FlagItem":"UnflagItem",i=be(b,h)}break;case"AssignPolicy":if(Pe(I.ParentFolderId.Id,b)){i=Ct;var w=Object(W.C)(),M=dt.a.tryImportForRender(),P=void 0;M&&(P=M(null==w?void 0:w.id,"RPCSAOverflow",b)),u=P}break;case"AddToSafeSenders":Re(I)&&(i=B(I,j));break;case"MarkJunkNotJunk":Object(it.g)()&&Object(Ae.E)(I.ParentFolderId.Id)&&(c=this.isInJunkFolder?Object(p.b)(vt.b):Object(p.b)(Ye.a),m=this.isInJunkFolder?"MarkItemNotjunk":"MarkItemJunk",i=pe(b,h));break;case"MarkAsPhishing":i=J(b);break;case"Block":Re(I)&&Object(Ae.E)(I.ParentFolderId.Id)&&(c=Object(p.c)(Object(p.b)(We.a),ye(I)),i=T(b,h));break;case"ReportAbuse":Object(Ue.h)("tri-reportAbuse")&&(c=Object(p.b)(Ze.a),i=se(b,h));break;case"CreateRule":Object(at.a)()&&this.itemHasSenderSMTP()&&Object(Ae.E)(I.ParentFolderId.Id)&&(i=D(I,j));break;case"Print":i=q(b),d=!t.PrintAllowed;break;case"Translate":i=Ie(b,v),d=Fe(t,b);break;case"ShowInImmersiveReader":i=de(b,j);break;case"ViewMessageSource":this.isSentItem||(i=_e(b,j));break;case"ToggleDarkMode":var x=v.undoDarkMode;c=x?Object(p.b)(vt.a):Object(p.b)(Je.a),s=x?"ClearNight":"Sunny",m=x?"ToggleDarkModeOn":"ToggleDarkModeOff",i=A(v);break;case"ReplyByIM":i=oe(I),d=!Object(te.b)();break;case"ReplyAllByIM":i=re(I),d=!Object(te.b)();break;case"AddToProjectSpace":var R=Ot.a.tryImportForRender();R&&(i=Ct,u=R(b.ItemId.Id,b,"MailModuleNotificationBarHost"));break;case"-":return{key:(this.commandBarDividerKey++).toString(),displayName:ht.a,itemType:Ne.a.Divider,onClick:null}}return i?{key:a,name:c,iconProps:{iconName:s,className:gt.commandBarIcon},onRender:l,disabled:d,onClick:this.getHandler(i,!0,m),onKeyDown:this.getHandler(i,!1,m),iconOnly:!0,ariaLabel:c,role:"menuitem",subMenuProps:u}:null},t.prototype.tryCreateAddinsCommandBarItems=function(e,t){var n=this;if(2==this.state.addinsInitializedState){var o,i=[],a=[],c=Object(jt.d)(jt.a.SurfaceActions);if(this.props.viewState.isConversationItemPart){var s=Object(ut.b)();o=null==s?void 0:s.itemId}this.props.shouldIncludeFullInfo&&Object(He.a)(Ke.a.MessageRead,this.props.item,o||this.props.item.ItemId.Id,c.readSurfaceAddins,i,a,!0,this.commandBarDividerKey,null,!0),Object(r.__spread)(i,a).forEach((function(e){if(e.onClick){var t=e.onClick;e.onClick=n.getHandler(t,!0,"Addins"),e.onKeyDown=n.getHandler(t,!1,"Addins")}})),e.unshift.apply(e,Object(r.__spread)(i)),t.push.apply(t,Object(r.__spread)(a))}},t.prototype.componentDidMount=function(){mt.a.importAndExecute(this.onResize),this.initailizeAddinsIfNeeded()},t.prototype.componentWillUnmount=function(){mt.c.importAndExecute(this.onResize),this.deInitializeAddins()},t.prototype.componentDidUpdate=function(e){var t,n,r,o=this,i=Promise.resolve();2==this.state.addinsInitializedState&&(null===(t=e.viewState)||void 0===t?void 0:t.itemId)!=(null===(n=this.props.viewState)||void 0===n?void 0:n.itemId)&&(i=this.deInitializeAddins(null===(r=e.viewState)||void 0===r?void 0:r.itemId)),i.then((function(){o.initailizeAddinsIfNeeded()}))},t.prototype.render=function(){var e=!this.props.item.ParentFolderId||!Object(xe.a)(this.props.item.ParentFolderId.Id,"notes");return f.createElement("div",{className:gt.surfaceActionsCommandBarContainer},e&&this.renderCommandBar())},t.prototype.renderCommandBar=function(){if(!this.props.viewState)return null;var e=this.createCommandBarItems();return f.createElement(Ee.a,{componentRef:this.getRef,items:e.items,overflowItems:e.overflowItems,overflowButtonProps:{iconProps:{iconName:"More"},menuIconProps:{iconName:"More",styles:{root:Object(p.f)(this.props.seeMoreStyles)?gt.surfaceActionsCommandBarOverflowIcon:kt(gt.surfaceActionsCommandBarOverflowIcon,this.props.seeMoreStyles)}},ariaLabel:Object(p.b)(Xe.a)},buttonAs:this.ItemHeaderToolbarButton,overflowButtonAs:this.ItemHeaderToolbarOverflowButton,shiftOnReduce:!0,onDataReduced:ht.n,onDataGrown:ht.m,styles:{root:gt.surfaceActionsCommandBar,primarySet:gt.surfaceActionsCommandBarPrimarySet},ariaLabel:Object(p.b)(vt.c),onReduceData:this.onCommandBarReduceData,onGrowData:this.onCommandBarGrowData})},t.prototype.computeCommandBarCacheKey=function(e){return[e.reduce((function(e,t){var n=t.cacheKey;return e+(void 0===n?t.key:n)}),""),"","overflow"].join(" ")},t.prototype.getConversationId=function(){return L(this.props.viewState,this.props.item)},t.prototype.isGroupPopout=function(){return this.props.isDeeplink&&we(this.props.item)},Object.defineProperty(t.prototype,"isInJunkFolder",{get:function(){var e=this.props.item;return Object(xe.a)(e.ParentFolderId.Id,"junkemail")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSentItem",{get:function(){var e=this.props.item;return Object(xe.a)(e.ParentFolderId.Id,"sentitems")},enumerable:!1,configurable:!0}),t.prototype.itemHasSenderSMTP=function(){var e,t=Object(W.R)(this.props.item)?this.props.item:null;return!!(null===(e=null==t?void 0:t.From)||void 0===e?void 0:e.Mailbox)},t.prototype.shouldAddinsPopulate=function(){var e=(!this.props.customizedSubsetActionKeys||0==this.props.customizedSubsetActionKeys.length)&&this.props.shouldIncludeFullInfo;return Object(Ue.h)("rp-addins")&&e&&!Object(ot.a)(this.getConversationId())&&!this.props.isItemAttachment&&Object(It.O)(this.props.item)&&!we(this.props.item)&&!Object(bt.a)(this.props.item)},t.prototype.initailizeAddinsIfNeeded=function(){var e=this;0==this.state.addinsInitializedState&&this.shouldAddinsPopulate()&&(this.setState({addinsInitializedState:1}),this.intializeAddinsTask=window.setTimeout((function(){e.initializeAddins()}),1))},t.prototype.initializeAddins=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t,n=this;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(Ue.h)("rp-addins")?[4,tt.b.import()]:[3,2];case 1:e=r.sent(),t=e(this.props.item,this.props.viewState),It.u.import().then((function(e){e(Object(It.o)(n.props.item.ItemId.Id),t).then((function(){n.setState({addinsInitializedState:2})}))})),r.label=2;case 2:return[2]}}))}))},t.prototype.deInitializeAddins=function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return clearTimeout(this.intializeAddinsTask),0==this.state.addinsInitializedState?[2]:Object(Ue.h)("rp-addins")?[4,It.t.import()]:[3,2];case 1:t.sent()(Object(It.o)(e||this.props.item.ItemId.Id)),this.setState({addinsInitializedState:0}),t.label=2;case 2:return[2]}}))}))},Object(r.__decorate)([De.computed],t.prototype,"isInJunkFolder",null),Object(r.__decorate)([De.computed],t.prototype,"isSentItem",null),t=Object(r.__decorate)([o.observer],t)}(f.Component),Ct=function(e){e.stopPropagation()};function St(e,t){var n;t.isConversationItemPart&&Object(st.a)(null===(n=e.ConversationId)||void 0===n?void 0:n.Id,t,!1)}function wt(e,t,n,r,o,i,a){return function(c,s){Object(ht.l)(!1,n,s,M(s,i),!!a),t?(St(r,o),e(c,s)):c.which==ze.a.enter&&(c.preventDefault(),c.stopPropagation(),St(r,o),e(c,s))}}var At=null;function Mt(){return At||(At={},Object(ht.i)().forEach((function(e){At[e.key]=e}))),At}function Pt(e){return Object(xe.a)(e.ParentFolderId.Id,"junkemail")}var Bt=n(4),xt=Object(Bt.mutatorAction)("incrementLikeButtonCount",(function(e){e.likeUnlikeTracker&&e.likeUnlikeTracker.likeButtonClickCount++})),Rt=Object(Bt.mutatorAction)("updateLikeUnlikeInProgress",(function(e,t){e.likeUnlikeTracker&&(e.likeUnlikeTracker.likeUnlikeInProgress=t)}));var Tt,Ft=function(e,t,n){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var o,i;return Object(r.__generator)(this,(function(a){switch(a.label){case 0:return[4,P.p.import()];case 1:return o=a.sent(),xt(n),o(Object(r.__assign)(Object(r.__assign)({},e.ItemId),{mailboxInfo:e.MailboxInfo}),e,Object(W.C)(),(null===(i=n.likeUnlikeTracker)||void 0===i?void 0:i.likeButtonClickCount)>=5,t),Rt(n,!1),[2]}}))}))},Dt=((Tt={}).Reply=function(e,t){var n=Object(ct.a)(e.item,e.viewState.isConversationItemPart);t.isDisabled=n[0],t.clickHandler=$(e.instrumentationContext,e.viewState,e.item,e.targetWindow)},Tt.ReplyAll=function(e,t){var n=Object(ct.a)(e.item,e.viewState.isConversationItemPart);t.isDisabled=n[1],t.clickHandler=ee(e.instrumentationContext,e.viewState,e.item,e.targetWindow)},Tt.Forward=function(e,t){var n=Object(ct.a)(e.item,e.viewState.isConversationItemPart);t.isDisabled=n[2],t.clickHandler=V(e.item,e.instrumentationContext,e.targetWindow)},Tt.ReplyByMeeting=function(e,t){t.isDisabled=Object(pt.a)(e.item)||!!e.item.RightsManagementLicenseData,t.clickHandler=ae(e.item),t.isNested=!0},Tt.OtherReplyActions=function(e,t){t.clickHandler=Lt,t.subMenuActionKeys=["ReplyByMeeting","ReplyByIM","ReplyAllByIM","LikeUnlike"]},Tt.MessageSafety=function(e,t){t.clickHandler=Lt,t.subMenuActionKeys=["MarkJunkNotJunk","MarkAsPhishing","Block","ReportAbuse"]},Tt.ReplyByIM=function(e,t){t.clickHandler=oe(e.item),t.isDisabled=!Object(te.b)(),t.isNested=!0},Tt.ReplyAllByIM=function(e,t){t.clickHandler=re(e.item),t.isDisabled=!Object(te.b)(),t.isNested=!0},Tt.MarkJunkNotJunk=function(e,t){var n=e.item;Object(it.g)()&&Object(Ae.E)(n.ParentFolderId.Id)&&(t.displayName=Pt(n)?Object(p.b)(vt.b):Object(p.b)(Ye.a),t.datapointName=Pt(n)?"MarkItemNotjunk":"MarkItemJunk",t.clickHandler=pe(e.item,e.instrumentationContext)),t.isNested=!0},Tt.Delete=function(e,t){if(!e.isItemAttachment&&Object(it.b)(9)){var n=e.item;t.clickHandler=K(e.viewState,e.item,e.instrumentationContext),t.isDisabled=we(e.item)&&!n.CanDelete}},Tt.MarkReadUnread=function(e,t){if(!e.isDeeplink||!we(e.item)){var n=e.item;t.displayName=n.IsRead?Object(p.b)(Qe.a):Object(p.b)(Ge.a),t.datapointName=n.IsRead?"MarkItemUnread":"MarkItemRead",n.IsRead||(t.iconName="Read"),t.clickHandler=ve(e.item,e.instrumentationContext)}},Tt.FlagUnflag=function(e,t){if(Object(it.b)(11)){var n=e.item,r=!n.Flag||"Flagged"!=n.Flag.FlagStatus;t.displayName=r?Object(p.b)(Ve.a):Object(p.b)(vt.d),t.datapointName=r?"FlagItem":"UnflagItem",t.clickHandler=be(e.item,e.instrumentationContext)}},Tt.Print=function(e,t){var n=Object(lt.a)(e.item);t.clickHandler=q(e.item),t.isDisabled=!n.PrintAllowed},Tt.View=function(e,t){t.clickHandler=Lt,t.subMenuActionKeys=["Popout","Translate","ShowInImmersiveReader","ViewMessageSource"]},Tt.AdvancedActions=function(e,t){t.clickHandler=Lt,t.subMenuActionKeys=["CreateRule","AssignPolicy"]},Tt.Popout=function(e,t){t.clickHandler=G(e.item,e.viewState),t.isNested=!0},Tt.CreateRule=function(e,t){var n,r=Object(W.R)(e.item)?e.item:null;Object(at.a)()&&(null===(n=null==r?void 0:r.From)||void 0===n?void 0:n.Mailbox)&&Object(Ae.E)(null==r?void 0:r.ParentFolderId.Id)&&(t.clickHandler=D(e.item,e.actionSource)),t.isNested=!0},Tt.AddToSafeSenders=function(e,t){var n=e.item;Re(n)&&(t.clickHandler=B(n,e.actionSource))},Tt.MarkAsPhishing=function(e,t){t.clickHandler=J(e.item),t.isNested=!0},Tt.Block=function(e,t){var n=e.item;Re(n)&&Object(Ae.E)(n.ParentFolderId.Id)&&(t.displayName=Object(p.c)(Object(p.b)(We.a),ye(n)),t.clickHandler=T(e.item,e.instrumentationContext)),t.isNested=!0},Tt.ReportAbuse=function(e,t){Object(Ue.h)("tri-reportAbuse")&&(t.displayName=Object(p.b)(Ze.a),t.clickHandler=se(e.item,e.instrumentationContext)),t.isNested=!0},Tt.Translate=function(e,t){var n=Object(lt.a)(e.item);t.clickHandler=Ie(e.item,e.viewState),t.isDisabled=Fe(n,e.item),t.isNested=!0},Tt.ShowInImmersiveReader=function(e,t){t.clickHandler=de(e.item,e.actionSource),t.isNested=!0},Tt.ViewMessageSource=function(e,t){var n=e.item;Object(xe.a)(n.ParentFolderId.Id,"sentitems")||(t.clickHandler=_e(e.item,e.actionSource)),t.isNested=!0},Tt.AssignPolicy=function(e,t){if(Pe(e.item.ParentFolderId.Id,e.item)){var n=Object(W.C)(),r=dt.a.tryImportForRender(),o=void 0;r&&(o=r(null==n?void 0:n.id,"RPCSAOverflow",e.item)),t.clickHandler=Lt,t.subMenuProps=o}t.isNested=!0},Tt.ToggleDarkMode=function(e,t){var n=e.viewState.undoDarkMode;t.displayName=n?Object(p.b)(vt.a):Object(p.b)(Je.a),t.iconName=n?"ClearNight":"Sunny",t.datapointName=n?"ToggleDarkModeOn":"ToggleDarkModeOff",t.clickHandler=A(e.viewState),t.isPinnedOnly=!0},Tt.Addins=function(e,t){t.clickHandler=Lt},Tt.AddToProjectSpace=function(e,t){var n=Ot.a.tryImportForRender();n&&(t.clickHandler=Lt,t.subMenuProps=n(e.item.ItemId.Id,e.item,"MailModuleNotificationBarHost"))},Tt["-"]=function(e,t){t.clickHandler=Lt},Tt.LikeUnlike=function(e,t){var n,r,o,i=e.item;Object(ft.a)()||Object(Ae.C)(i.ParentFolderId.Id,Me.j)||(t.clickHandler=(n=e.item,r=e.instrumentationContext,o=e.viewState,function(e){var t;e.stopPropagation(),(null===(t=o.likeUnlikeTracker)||void 0===t?void 0:t.likeUnlikeInProgress)||(Rt(o,!0),Ft(n,r,o))}),function(e){var t=Object(O.a)().SessionSettings.UserEmailAddress;return!!e.Likers&&e.Likers.some((function(e){return e.EmailAddress===t}))}(i)&&(t.iconName="LikeSolid",t.displayName=Object(p.b)(vt.e)),Object(ht.o)("LikeUnlike",i)&&(t.customRender=function(e){return f.createElement(y,{surfaceActionItem:e,message:i})})),t.isNested=!0},Tt.ToggleAmp=function(e,t){var n=e.viewState.ampViewState,r=n.preferAmp,o=n.ampAvailability;Object(rt.a)()&&o==nt.a.AmpValidated&&(t.displayName=r?Object(p.b)(et.a):Object(p.b)($e.a),t.datapointName=r?"ViewAsOriginal":"ViewAsDynamic",t.clickHandler=fe(e.viewState),t.isPinnedOnly=!0,r&&(t.iconName="LightningBoltSolid"))},Tt);function Lt(e){e.stopPropagation()}var Et=n(8031);function Nt(e,t){if(!e||e.hideInGroup&&we(t.item)||e.hideInSxS&&t.isItemAttachment)return null;var n,r,o,i=(n=e.key,o=Object(ht.g)(n),{key:n,displayName:o,iconName:null===(r=Object(ht.h)(n))||void 0===r?void 0:r.iconName,customRender:null,isDisabled:!1,clickHandler:null,subMenuActionKeys:null,subMenuProps:null,datapointName:n,isPinnedOnly:!1,isNested:!1});Dt[e.key](t,i);var a=function(e,t){if(!e)return null;var n=Mt(),r=[];return e.forEach((function(e){var o=Nt(n[e],t);o&&r.push(o)})),r.length>0?r:null}(i.subMenuActionKeys,t);return i.subMenuActionKeys&&!a?null:function(e,t,n){if(!e.clickHandler)return null;return{key:e.key,text:e.displayName,iconProps:{iconName:e.iconName,className:Et.commandBarIcon},onRender:e.customRender,disabled:e.isDisabled,onClick:wt(e.clickHandler,!0,e.datapointName,n.item,n.viewState,n.actionSource,e.isNested),onKeyDown:wt(e.clickHandler,!1,e.datapointName,n.item,n.viewState,n.actionSource,e.isNested),iconOnly:!0,ariaLabel:e.displayName,subMenuProps:e.subMenuProps?e.subMenuProps:t?{items:t}:null,isPinnedOnly:e.isPinnedOnly}}(i,a,t)}var zt=["Reply","ReplyAll","Forward","OtherReplyActions","-","Delete","MarkReadUnread","FlagUnflag","AddToProjectSpace","AddToSafeSenders","MessageSafety","-","Print","View","-","Addins","AdvancedActions","ToggleDarkMode","ToggleAmp"];var Ht=Object(Bt.mutatorAction)("initializeLikeUnlikeTracker",(function(e){e.likeUnlikeTracker={likeButtonClickCount:0,likeUnlikeInProgress:!1}})),Kt=n(6373),Ut=n(8031),Wt=n(308).bind(Ut),Vt=function(e){function t(t){var n=e.call(this,t)||this;return n.commandBarHiddenOverflowItems=[],n.commandBarDividerKey=0,n.forcePinnedSurfaceActions=new Set,n.onMenuClickCallback=function(){St(n.props.item,n.props.viewState)},n.getRef=function(e){n.commandBar=e},n.ItemHeaderToolbarButton=Object(Le.a)((function(e){return f.createElement(i.a,Object(r.__assign)({},e,{menuProps:e.menuProps&&Object(r.__assign)(Object(r.__assign)({},e.menuProps),{directionalHint:c.DirectionalHint.bottomAutoEdge}),onMenuClick:n.onMenuClickCallback,styles:Object(r.__assign)(Object(r.__assign)({},e.styles),{root:Wt(Ut.surfaceActionsCommandBarButton,Ut.iconButton),rootChecked:Ut.checkedCommandBarButton,rootDisabled:Ut.disabledReplyActionButton,icon:Ut.enabledIconButton,iconDisabled:Ut.disabledIconButton,menuIcon:Ut.commandBarMenuIcon}),role:"button"}))})),n.ItemHeaderToolbarOverflowButton=Object(Le.a)((function(e){var t=n.ItemHeaderToolbarButton;return f.createElement(u.a,{content:Object(p.b)(qe.a)},f.createElement(t,Object(r.__assign)({},e)))})),n.onCommandBarReduceData=function(e){var t=e.primaryItems,o=e.overflowItems,i=e.cacheKey,a=t[0];if(void 0!==a)return a.isPinnedOnly&&function(e,t){t.forEach((function(t){"View"!==t.key||t.subMenuProps.items.includes(e)||t.subMenuProps.items.push(e)}))}(a,o),n.commandBarHiddenOverflowItems=Object(r.__spread)([a],n.commandBarHiddenOverflowItems),t=t.slice(1),i=n.computeCommandBarCacheKey(t),Object(r.__assign)(Object(r.__assign)({},e),{primaryItems:t,overflowItems:o,cacheKey:i})},n.onCommandBarGrowData=function(e){var t=e.primaryItems,o=e.overflowItems,i=e.cacheKey,a=n.commandBarHiddenOverflowItems[0];if(void 0!==a)return a.isPinnedOnly&&function(e,t){t.forEach((function(t){if("View"===t.key){var n=t.subMenuProps.items.indexOf(e);n>-1&&t.subMenuProps.items.splice(n,1)}}))}(a,o),n.commandBarHiddenOverflowItems=n.commandBarHiddenOverflowItems.slice(1),t=Object(r.__spread)([a],t),i=n.computeCommandBarCacheKey(t),Object(r.__assign)(Object(r.__assign)({},e),{primaryItems:t,overflowItems:o,cacheKey:i})},n.onResize=function(){n.commandBar&&n.commandBar.remeasure()},n.state={addinsInitializedState:0},Ht(n.props.viewState),n}return Object(r.__extends)(t,e),t.prototype.createCommandBarItems=function(){var e,t=this;this.commandBarHiddenOverflowItems=[];var n=[],r=[],o=Mt(),i=[];return((null===(e=this.props.customizedSubsetActionKeys)||void 0===e?void 0:e.length)>0?this.props.customizedSubsetActionKeys:zt).forEach((function(e){o[e]&&i.push(o[e])})),i.forEach((function(e){var o;"Addins"!==e.key?(o=Nt(e,t.props))&&t.addItemToCommandBar(o,r,n):t.tryCreateAddinsCommandBarItems(n,r,e)})),{items:this.props.hideSurfaceButton?[]:n,overflowItems:r}},t.prototype.addItemToCommandBar=function(e,t,n){var o,i,a=this,c=e;this.shouldAddItemToSurface(e)&&(this.addItemToCommandBarSurface(n,e),c=Object(r.__assign)({},e)),null===(i=null===(o=e.subMenuProps)||void 0===o?void 0:o.items)||void 0===i||i.forEach((function(e){a.shouldAddItemToSurface(e)&&a.addItemToCommandBarSurface(n,Object(r.__assign)({},e))})),this.addItemToCommandBarOverflow(t,c)},t.prototype.addItemToCommandBarSurface=function(e,t){var n=t.key;Object(ht.j)(n)||this.forcePinnedSurfaceActions.add(n),t.isPinned=!0,Object(ht.p)(n)?e.push(t):e.unshift(t)},t.prototype.addItemToCommandBarOverflow=function(e,t){var n,r,o,i;if(!t.isPinnedOnly){var a=t.key;t.onRender=null,"AddToProjectSpace"!==a&&(null===(r=null===(n=t.subMenuProps)||void 0===n?void 0:n.items)||void 0===r||r.forEach((function(e){e.onRender=null}))),t.renderedInOverflow=!0,null===(i=null===(o=t.subMenuProps)||void 0===o?void 0:o.items)||void 0===i||i.forEach((function(e){e.renderedInOverflow=!0})),"-"==a?Object(Kt.b)(e,this.commandBarDividerKey++):e.push(t)}},t.prototype.shouldAddItemToSurface=function(e){if(this.props.hideSurfaceButton)return!1;var t=e.key;return Object(ht.o)(t,this.props.item)||this.forcePinnedSurfaceActions.has(t)},t.prototype.componentDidMount=function(){mt.a.importAndExecute(this.onResize),this.initailizeAddinsIfNeeded()},t.prototype.componentWillUnmount=function(){mt.c.importAndExecute(this.onResize),this.deInitializeAddins()},t.prototype.componentDidUpdate=function(e){var t,n,r=this,o=Promise.resolve();2==this.state.addinsInitializedState&&(null===(t=e.viewState)||void 0===t?void 0:t.itemId)!=(null===(n=this.props.viewState)||void 0===n?void 0:n.itemId)&&(o=this.deInitializeAddins(e.viewState.itemId)),o.then((function(){r.initailizeAddinsIfNeeded()}))},t.prototype.render=function(){var e=!this.props.item.ParentFolderId||!Object(xe.a)(this.props.item.ParentFolderId.Id,"notes");return f.createElement("div",{className:Ut.surfaceActionsCommandBarContainer},e&&this.renderCommandBar())},t.prototype.renderCommandBar=function(){if(!this.props.viewState)return null;var e=this.createCommandBarItems();return f.createElement(Ee.a,{componentRef:this.getRef,items:e.items,overflowItems:e.overflowItems,overflowButtonProps:{iconProps:{iconName:"More"},menuIconProps:{iconName:"More",styles:{root:Object(p.f)(this.props.seeMoreStyles)?Ut.surfaceActionsCommandBarOverflowIcon:Wt(Ut.surfaceActionsCommandBarOverflowIcon,this.props.seeMoreStyles)}},ariaLabel:Object(p.b)(Xe.a)},buttonAs:this.ItemHeaderToolbarButton,overflowButtonAs:this.ItemHeaderToolbarOverflowButton,shiftOnReduce:!0,onDataReduced:ht.n,onDataGrown:ht.m,styles:{root:Ut.surfaceActionsCommandBar,primarySet:Ut.surfaceActionsCommandBarPrimarySet},ariaLabel:Object(p.b)(vt.c),onReduceData:this.onCommandBarReduceData,onGrowData:this.onCommandBarGrowData})},t.prototype.computeCommandBarCacheKey=function(e){return[e.reduce((function(e,t){var n=t.cacheKey;return e+(void 0===n?t.key:n)}),""),"","overflow"].join(" ")},t.prototype.tryCreateAddinsCommandBarItems=function(e,t,n){var o=this;if(2==this.state.addinsInitializedState){var i=[],a=[],c=Object(jt.d)(jt.a.SurfaceActions),s=n.key;this.props.shouldIncludeFullInfo&&Object(Kt.a)(Ke.a.MessageRead,this.props.item,this.getFocusedItemId||this.props.item.ItemId.Id,c.readSurfaceAddins,i,a,!0,this.commandBarDividerKey,null,!0),Object(r.__spread)(i,a).forEach((function(e){if(e.onClick){var t=e.onClick;e.onClick=wt(t,!0,s,o.props.item,o.props.viewState,o.props.actionSource,!1),e.onKeyDown=wt(t,!1,s,o.props.item,o.props.viewState,o.props.actionSource,!1)}})),e.unshift.apply(e,Object(r.__spread)(i)),t.push.apply(t,Object(r.__spread)(a))}},t.prototype.shouldAddinsPopulate=function(){var e=(!this.props.customizedSubsetActionKeys||0==this.props.customizedSubsetActionKeys.length)&&this.props.shouldIncludeFullInfo,t=L(this.props.viewState,this.props.item);return Object(Ue.h)("rp-addins")&&e&&!Object(ot.a)(t)&&!this.props.isItemAttachment&&Object(It.O)(this.props.item)&&!we(this.props.item)&&!Object(bt.a)(this.props.item)},t.prototype.initailizeAddinsIfNeeded=function(){var e=this;0==this.state.addinsInitializedState&&this.shouldAddinsPopulate()&&(this.setState({addinsInitializedState:1}),this.intializeAddinsTask=window.setTimeout((function(){e.initializeAddins()}),1))},t.prototype.initializeAddins=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t,n=this;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(Ue.h)("rp-addins")?[4,tt.b.import()]:[3,2];case 1:e=r.sent(),t=e(this.props.item,this.props.viewState),It.u.import().then((function(e){e(Object(It.o)(n.props.item.ItemId.Id),t).then((function(){n.setState({addinsInitializedState:2})}))})),r.label=2;case 2:return[2]}}))}))},t.prototype.deInitializeAddins=function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return clearTimeout(this.intializeAddinsTask),0==this.state.addinsInitializedState?[2]:Object(Ue.h)("rp-addins")?[4,It.t.import()]:[3,2];case 1:t.sent()(Object(It.o)(e||this.props.item.ItemId.Id)),this.setState({addinsInitializedState:0}),t.label=2;case 2:return[2]}}))}))},Object.defineProperty(t.prototype,"getFocusedItemId",{get:function(){if(this.props.viewState.isConversationItemPart){var e=Object(ut.b)();return null==e?void 0:e.itemId}return null},enumerable:!1,configurable:!0}),Object(r.__decorate)([De.computed],t.prototype,"getFocusedItemId",null),t=Object(r.__decorate)([o.observer],t)}(f.Component);n.d(t,"ItemActions",(function(){return yt})),n.d(t,"ItemActionsMenu",(function(){return Vt}))},1514:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(4),o=Object(r.action)("setShowListPane",(function(e){return{showListPane:e}}))},1515:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(4),o=Object(r.action)("setShowReadingPane",(function(e){return{showReadingPane:e}}))},1521:function(e,t,n){"use strict";var r=n(108),o=n(1754),i=n(114),a=n(947),c=n(963),s=n(950),u=n(948),d=n(953);function l(e,t){return e&&!Object(a.s)()&&t&&t.type===i.a.UserMailbox&&!Object(c.o)(e)&&e!=Object(s.a)("recoverableitemsdeletions")&&!Object(u.C)(e,d.j)}n.d(t,"e",(function(){return f})),n.d(t,"a",(function(){return o.a})),n.d(t,"b",(function(){return o.b})),n.d(t,"d",(function(){return o.c})),n.d(t,"c",(function(){return l}));var m=new r.c((function(){return n.e(599).then(n.bind(null,14858))})),f=new r.a(m,(function(e){return e.undo}))},1550:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(76),o=n(103);function i(){return Object(r.h)("mail-oneView")&&Object(o.t)()}},1740:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(4),o=Object(r.action)("onClientReadingPanePositionChange")},1754:function(e,t,n){"use strict";var r,o=n(4),i=Object(o.createStore)("undo",{hasUndoableAction:!1,undoableActionFolderId:null})(),a=n(1331),c=n(283),s=n(123);n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return m}));var u=Object(c.action)("addActionToUndoStack")(Object(c.select)({store:function(){return i}})((function(e,t,n){null!==e&&(r=e,n.store.hasUndoableAction=!0,n.store.undoableActionFolderId=t)}))),d=Object(c.action)("clearLastUndoableAction")(Object(c.select)({store:function(){return i}})((function(e){r=null,e.store.hasUndoableAction=!1,e.store.undoableActionFolderId=null}))),l=Object(c.select)({store:function(){return i}})((function(e){return e.store.hasUndoableAction})),m=Object(s.d)("undo",{name:"TnS_Undo",customData:function(e){return[e]}})((function(e){i.undoableActionFolderId?a.a.clearMapForFolder(i.undoableActionFolderId):a.a.removeAll();null!==r&&(r(),d())}))},2248:function(e,t,n){"use strict";var r=n(0);function o(e){return void 0===e&&(e=null),e?Array.isArray(e[0])?function(){return e.some((function(e){return i(e)}))}:function(){return i(e)}:function(){return!0}}function i(e){return e.every((function(e){return e()}))}var a=n(1108),c=n(973),s=function(e){return function(){var t=Object(a.b)(),n=t&&Object(c.a)(t);return e(n)}},u=n(947),d=function(e){return function(){var t=Object(u.C)();return e.includes(Object(u.l)(t))}};function l(e,t){return!e!=!t}var m=function(e,t){return function(){var n=Object(u.C)(),r=n&&n.tableQuery.folderId,o=r&&Object(c.a)(r),i=e.includes(o);return l(t,i)}},f=n(1109),b=function(e){return function(){var t=Object(u.C)();return Object(f.e)()&&e.includes(Object(u.p)(t.id))}},p=n(314),O=function(e){return function(){var t=Object(u.C)().isInCheckedMode,n=Object(u.F)().expandedConversationViewState.selectedNodeIds.length,r=!t&&n>1;switch(e){case 4:return!r;case 1:return r;case 2:return!t&&1==n;case 3:return!t&&n>1;default:throw Object(p.a)(e)}}},v=function(e){return function(){var t=Object(u.C)();switch(e){case 0:return 0==t.rowKeys.length;case 1:return t.rowKeys.length>0;default:throw Object(p.a)(e)}}},h=function(e){return function(){var t=Object(u.C)().tableQuery.listViewType;switch(e){case 2:return 1===t;case 1:return 0===t;default:throw Object(p.a)(e)}}},j=n(948),I=n(1082),g=n(963),k=n(1513),_=n(103),y=n(953);var C=function(e,t){return function(){var n=Object(u.C)().tableQuery,r=e.some((function(e){return function(e,t){var n=Object(k.a)(),r=Object(_.i)().SessionSettings.IsShadowMailbox;switch(e){case 2:return t.folderId&&Object(g.o)(t.folderId);case 3:return Object(I.e)(t);case 4:return r;case 1:return!r&&n&&Object(j.F)(n);case 5:var o=null==n?void 0:n.treeType;return y.j==o}}(e,n)}));return l(t,r)}},S=function(e,t){return function(){var n=Object(u.C)(),r=e.includes(n.tableQuery.scenarioType);return l(t,r)}},w=n(76),A=function(){return function(){return!Object(w.h)("notes-folder-view")||m(["notes"],!0)()}},M=n(1166),P=function(e){return function(){var t=Object(M.F)();switch(e){case 1:return t&&Object(M.r)();case 2:return Object(M.s)();case 0:return!t;default:throw Object(p.a)(e)}}},B=n(1353),x=function(e,t){return function(){if(1!==Object(u.C)().tableQuery.type)return!0;var n=Object(B.j)().staticSearchScope,r=n&&e.includes(n.kind);return l(t,r)}},R=function(e){return function(){var t,n,o=Object(u.C)(),i=o.selectedRowKeys.size,a=!1,c=Object(u.Q)(o)||Object(u.q)(o);try{for(var s=Object(r.__values)(e),d=s.next();!d.done;d=s.next()){switch(d.value){case 5:a=0==i&&!o.isInVirtualSelectAllMode;break;case 0:a=i>0||c;break;case 1:a=i>0;break;case 2:a=1==i;break;case 3:a=i>1||c;break;case 4:a=i>1}if(a)return!0}}catch(e){t={error:e}}finally{try{d&&!d.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return!1}},T=function(e,t){return function(){var n=Object(u.C)(),r=n.tableQuery,o=n.tableQuery.type,i=!1;if(0==o||2==o){var a=r.sortBy;i=e.some((function(e){var t=e.sortColumn,n=e.sortDirection;return t==a.sortColumn&&n==a.sortDirection}))}else i=!0;return l(t,i)}},F=n(982),D=n(950),L=function(e,t){return function(){if(1!==Object(u.C)().tableQuery.type)return!0;var n=Object(B.j)().staticSearchScope,r=e.map((function(e){return Object(F.E)({folderId:Object(D.a)(e),kind:"PrimaryMailbox"})})).filter((function(e){return Object(F.e)(e,n)})).length>0;return l(t,r)}},E=function(e,t){return function(){var n=Object(u.C)().tableQuery.type,r=e.includes(n);return l(t,r)}},N=n(27);function z(){return!!Object(N.a)().SegmentationSettings.JunkEMail}var H,K=n(4035),U=n(2373),W=n(3502),V=n(3251),J=n(1521),Y=n(295),X=n(1285);function G(){var e,t;return H||(t=[y.g,y.b],(e={})[39]=o([R([2])]),e[27]=o([m(Object(r.__spread)(["notes"],t),!0),O(4),R([2]),L(Object(r.__spread)(["notes"],t),!0)]),e[32]=o([C([3],!0),m(Object(r.__spread)(["drafts","junkemail","notes"],t),!0),h(2),R([2]),L(Object(r.__spread)(["notes"],t),!0)]),e[30]=o([m(Object(r.__spread)(["notes"],t),!0),C([3],!0),R([2]),L(Object(r.__spread)(["notes"],t),!0),h(2),s((function(){return h(2)()&&Q(!1)[0]}))]),e[31]=o([m(Object(r.__spread)(["notes"],t),!0),R([2]),L(Object(r.__spread)(["notes"],t),!0),h(2),s((function(){return h(2)()&&Q(!1)[1]}))]),e[12]=o([m(Object(r.__spread)(["notes"],t),!0),R([2]),L(Object(r.__spread)(["notes"],t),!0),h(2),s((function(){return h(2)()&&Q(!1)[2]}))]),e[37]=o([m(["inbox","scheduled"]),C([3,2,4,5],!0),O(4),R([1]),L([])]),e[24]=o([m(t,!0),L(t,!0),A(),s((function(){return!Object(M.C)()||Object(M.D)()}))]),e[25]=o([m(["notes"]),s((function(){return Object(w.h)("notes-folder-view")&&!Object(M.C)()}))]),e[18]=o([m(Object(r.__spread)(["notes"],t),!0),L(Object(r.__spread)(["notes"],t),!0),s((function(){return Object(u.S)()||R([2])()&&!q()||R([3])()}))]),e[19]=o([m(Object(r.__spread)(["notes"],t),!0),L(Object(r.__spread)(["notes"],t),!0),s((function(){return Object(u.S)()||R([2])()&&q()||R([3])()}))]),e[20]=o([m(t,!0),L(t,!0),s((function(){return Object(w.h)("fwk-meetNowButton")}))]),e[11]=o([m(Object(r.__spread)(["notes"],t),!0),C([3],!0),L(Object(r.__spread)(["notes"],t),!0),s((function(){return(Object(u.S)()||R([2])()&&!Z()||R([4])())&&ie(11)}))]),e[43]=o([m(Object(r.__spread)(["notes"],t),!0),C([3],!0),L(Object(r.__spread)(["notes"],t),!0),s((function(){return(Object(u.S)()||R([2])()&&Z()||R([4])())&&ie(43)}))]),e[5]=o([m(Object(r.__spread)(["notes"],t),!0),O(4),C([3,4],!0),R([1]),L(Object(r.__spread)(["notes"],t),!0),s((function(){return ie(5)}))]),e[28]=o([m(Object(r.__spread)(["drafts","sentitems","clutter","junkemail","deleteditems","scheduled","archive","notes"],t),!0),C([3,2,5],!0),O(4),T([u.c.getSortBySupportingPin()]),x(["ArchiveMailbox","SharedFolders"],!0),L(Object(r.__spread)(["notes"],t),!0),s((function(){return R([4])()||R([2])()&&!$()})),E([1],!0)]),e[44]=o([m(Object(r.__spread)(["drafts","sentitems","clutter","junkemail","deleteditems","archive","notes"],t),!0),C([2,3,5],!0),O(4),T([u.c.getSortBySupportingPin()]),x(["ArchiveMailbox","SharedFolders"],!0),L(Object(r.__spread)(["notes"],t),!0),s((function(){return R([4])()||R([2])()&&$()})),E([1],!0)]),e[48]=o([R([2]),O(4),s((function(){return Object(X.d)()})),C([3],!0),m(Object(r.__spread)(["notes"],t),!0)]),e[9]=o([R([0]),A(),s((function(){return ie(9)}))]),e[2]=o([m(Object(r.__spread)(["archive","deleteditems","drafts","junkemail","notes"],t),!0),C([3,2,5],!0),E([0,1]),R([1]),x(["ArchiveMailbox","SharedFolders"],!0),L(Object(r.__spread)(["notes"],t),!0)]),e[17]=o([m(Object(r.__spread)(["drafts","sentitems","junkemail","clutter","scheduled","notes"],t),!0),C([2,3,4,5],!0),S(["persona","category"],!0),R([1]),x(["ArchiveMailbox","SharedFolders"],!0),L(Object(r.__spread)(["notes"],t),!0),s((function(){return z()}))]),e[51]=o([m(Object(r.__spread)(["drafts","sentitems","clutter","scheduled","notes"],t),!0),C([2,3,4,5],!0),S(["persona","category"],!0),R([1]),L(Object(r.__spread)(["notes"],t),!0)]),e[15]=o([m(["junkemail"]),C([2,3,4,5],!0),R([1]),x(["ArchiveMailbox","SharedFolders"],!0),L(["junkemail"]),s((function(){return z()}))]),e[13]=o([m(Object(r.__spread)(["sentitems","drafts","deleteditems","junkemail","notes"],t),!0),C([2,3,4,5],!0),E([0,1]),O(4),x(["ArchiveMailbox","SharedFolders"],!0),R([1]),L(["notes"])]),e[33]=o([m(["notes"],!0),R([2]),s((function(){return Object(w.h)("tri-reportAbuse")&&(C([3])()&&Object(Y.a)()||C([1])())}))]),e[40]=o([m(["deleteditems"]),C([1]),E([1],!0),O(4),R([1])]),e[4]=o([m(Object(r.__spread)(["drafts","sentitems","clutter","scheduled","notes"],t),!0),C([3,4],!0),O(4),s((function(){return R([2])()&&ee()||R([4])()}))]),e[41]=o([m(Object(r.__spread)(["sentitems","drafts","deleteditems","junkemail","notes"],t),!0),C([2,3,5,4],!0),O(4),E([1],!0),S(["category"],!0),s((function(){return R([2])()&&ee()||R([4])()}))]),e[10]=o([[m(["inbox"],!0),E([0,1]),C([3,5],!0),v(1),R([5]),A(),s((function(e){var n;return 0==(n=Object(u.C)()).tableQuery.type&&"mail"==n.tableQuery.scenarioType&&e&&(t.indexOf(e)>-1||function(e){var t=j.d.folderTable.get(Object(D.a)(e));return null==t||!t.sourceWellKnownFolderType||86!==t.sourceWellKnownFolderType}(e))||ie(9)}))],[b([2,3,4,5]),v(1),R([5]),C([3],!0)],[m(["inbox"],!1),d([1]),v(1),R([5]),C([3],!0)]]),e[16]=o([m(Object(r.__spread)(["notes"],t),!0),v(1),R([5]),L(Object(r.__spread)(["notes"],t),!0)]),e[34]=o([R([1]),m(Object(r.__spread)(["deleteditems"],t)),C([3],!0),O(4),L(Object(r.__spread)(t,["deleteditems"]))]),e[42]=o([m(t,!0),C([2,3,5],!0),E([0]),A(),s((function(){return Object(M.E)()&&(J.d()||v(1)())}))]),e[21]=o([m(Object(r.__spread)(["drafts","notes"],t),!0),C([3],!0),R([1]),L(Object(r.__spread)(["notes"],t),!0),s((function(){return ie(21)}))]),e[7]=o([m(Object(r.__spread)(["drafts","notes"],t),!0),C([3],!0),R([1]),L(Object(r.__spread)(["notes"],t),!0),s((function(){return ie(7)}))]),e[14]=o([m(Object(r.__spread)(["sentitems","drafts","notes"],t),!0),C([2,3,5,4],!0),O(4),x(["ArchiveMailbox","SharedFolders"],!0),R([2]),L(["sentitems","notes","drafts"],!0),s((function(){return Object(W.a)()&&ee()}))]),e[22]=o([m(["inbox"]),d([1]),v(1),O(4),E([1],!0),R([1])]),e[23]=o([m(["inbox"]),d([0]),O(4),v(1),E([1],!0),R([1])]),e[0]=o([m(["inbox"]),d([1]),O(4),v(1),E([1],!0),R([2])]),e[1]=o([m(["inbox"]),d([0]),O(4),v(1),E([1],!0),R([2])]),e[46]=o([C([3],!0)]),e[6]=o([C([3],!0),s((function(){var e=Object(_.i)(),t=e.UserOptions;return Object(M.E)()&&t.ReactOptinSettings&&!t.IsPermanentlyOptedIn&&!t.ReactOptinSettings.MailGraduatedFromBeta&&(void 0===e.PolicySettings.OutlookBetaToggleEnabled||e.PolicySettings.OutlookBetaToggleEnabled)}))]),e[29]=o([O(4),m(Object(r.__spread)(["drafts"],t),!0),R([2]),L(t,!0),A()]),e[36]=o([m(Object(r.__spread)(["drafts","notes"],t),!0),C([3],!0),O(4),R([2]),P(2),L(["notes"],!0),s((function(){return Object(w.h)("gsx-translator-translateMessage")&&Object(K.a)()}))]),e[38]=o([m(Object(r.__spread)(["notes"],t),!0),O(4),R([2]),L(Object(r.__spread)(["notes"],t),!0),s((function(){return Object(w.h)("rp-immersiveReader")}))]),e[26]=o([m(t,!0),O(4),R([2,4]),L(t,!0)]),e[3]=o([m(Object(r.__spread)(["notes"],t),!0),R([1]),L(Object(r.__spread)(["notes"],t),!0),s((function(){if(Object(Y.a)())return!1;var e=Object(u.C)();if(e&&Object(I.e)(e.tableQuery)){var t=I.i.tryImportForRender(),n=t?t(e.tableQuery):[];return n&&n.length>0}return C([4],!0)()}))]),e[47]=o([m(Object(r.__spread)(t,["sentitems","drafts"]),!0),h(2),s((function(){return R([2])()&&ee()}))]),e[50]=o([m(["sentitems","drafts"],!0),R([2]),s((function(){var e=Object(u.C)(),t=Object(r.__spread)(e.selectedRowKeys.keys()),n=u.b.getItemIds(t[0],e);return h(1)()&&1===n.length||h(2)()}))]),e[8]=o([m(Object(r.__spread)(["drafts","sentitems","clutter","junkemail","deleteditems","archive","notes"],t),!0),C([2,3,5],!0),O(4),R([1]),x(["ArchiveMailbox","SharedFolders"],!0),L(Object(r.__spread)(["notes"],t),!0),s((function(){return Object(w.h)("tri-commandBarCustomization")}))]),H=e),H}function Q(e){var t,n=te(),o=Object(r.__read)([!1,!1,!1],3),i=o[0],a=o[1],c=o[2];if(n){var s=u.b.getRowIdString(n,Object(u.C)()),d=g.w.items.get(s);i=(t=Object(r.__read)(Object(V.a)(d,e),3))[0],a=t[1],c=t[2]}return[!i,!a,!c]}function q(){var e=te();return!!e&&0===u.b.getUnreadCount(e,Object(u.C)())}function Z(){var e=te();return!!e&&"Flagged"==u.b.getFlagStatus(e,Object(u.C)())}function $(){var e=te();return!!e&&u.b.getIsPinned(e,Object(u.C)())}function ee(){var e=te();return!!e&&!!u.b.getLastSenderSMTP(e,Object(u.C)())}function te(){var e=Object(r.__spread)(Object(u.C)().selectedRowKeys.keys());return 1==e.length?e[0]:null}function ne(e,t){return Object(g.j)(e,t)}function re(e,t){var n=t||Object(B.h)(Object(u.C)());if(!Object(j.C)(n,"sharedFolderTree"))return!0;var r=Object(_.i)().SessionSettings.UserEmailAddress;try{return oe(e,function(e,t){return Object(g.k)(e,t)}(n,r))}catch(e){throw Object(U.a)(n),new Error("Move-To Error: Permissions for destination folder have not been fetched yet")}}function oe(e,t){if(!t)return!0;switch(e){case 21:case 7:case 9:return"All"===t.DeleteItems;case 11:case 43:case 5:return"All"===t.EditItems}return!1}function ie(e,t){try{return re(e,t)}catch(e){return!0}}var ae=n(3250);function ce(e,t){var n=Object(_.i)().SessionSettings.UserEmailAddress,r=ne(e,n),o=ne(t,n);return oe(21,r)&&oe(21,o)}var se=n(9),ue=n(1093),de=n(4196);function le(e){var t=Object(j.j)(j.d.folderTable.get(e));ue.e.importAndExecute("moveSharedFolderItems","MailModuleNotificationBarHost",Object(se.c)(Object(se.b)(de.a),t))}n.d(t,"e",(function(){return G})),n.d(t,"f",(function(){return ne})),n.d(t,"a",(function(){return oe})),n.d(t,"d",(function(){return ae.a})),n.d(t,"b",(function(){return ie})),n.d(t,"c",(function(){return re})),n.d(t,"h",(function(){return ce})),n.d(t,"i",(function(){return le})),n.d(t,"g",(function(){return z}))},2264:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(103),o=n(76);function i(){if(Object(o.h)("outlookSpaces-enabled")){var e=Object(r.i)().SessionSettings;switch(null==e?void 0:e.WebSessionType){case 0:return!0;case 1:var t=!!(null==e?void 0:e.IsPremiumConsumerMailbox),n=Object(o.h)("outlookSpaces-free-consumer-enabled");return t||n;case 2:return Object(o.h)("outlookSpaces-gmail-enabled")}}return!1}},2373:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("GET_FOLDER_DATA",(function(e){return{folderId:e}}))},2439:function(e,t,n){"use strict";var r=n(0);function o(e,t,n,o,i,a,c,s,u,d){return{folderId:null,type:1,listViewType:i,searchNumber:e,queryString:t,searchScope:n,pillSuggestions:Object(r.__spread)(o.values()),includeAttachments:a,fromDate:c,toDate:s,scenarioType:"mail",lastIndexFetched:0,searchProvider:u,viewFilter:d||"All"}}function i(e){var t=e;return 1==e.type?t.scenarioType:void 0}var a=n(953),c=n(963),s=n(950),u=n(982);function d(e){var t=e;return Object(c.o)(t.folderId)?Object(u.e)(t.searchScope,Object(u.c)({folderId:Object(s.a)(a.b),kind:"ArchiveMailbox"})):Object(u.e)(t.searchScope,Object(u.E)({folderId:Object(s.a)(a.g),kind:"PrimaryMailbox"}))}n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return d}))},2488:function(e){e.exports=JSON.parse('{"a":"n3b"}')},2659:function(e){e.exports=JSON.parse('{"a":"kFa","c":"lFa","e":"mFa","b":"nFa","d":"oFa"}')},2961:function(e){e.exports=JSON.parse('{"a":"BFa"}')},3139:function(e){e.exports=JSON.parse('{"a":"DFa"}')},3249:function(e){e.exports=JSON.parse('{"a":"xsb"}')},3250:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),o=n(1082),i=n(1130),a=n(2439),c=n(947);function s(e){var t=c.T.tableViews.get(c.T.selectedTableViewId);switch(e){case 24:return function(e){var t=e.tableQuery;if(Object(c.M)(t)||Object(a.c)(t))return!0;if(Object(o.e)(t)){var n=o.m.tryImportForRender();return null==n?void 0:n(Object(o.b)(t))}if(i.a.newMessageCreationInProgress)return!0;return!1}(t);case 9:return function(e){var t=e.tableQuery;if(Object(o.e)(t)){var n=o.k.tryImportForRender();if(!(null==n?void 0:n(Object(o.b)(t)))){var i=Object(r.__spread)(e.selectedRowKeys.keys());return 1!==i.length||!c.b.getCanDelete(i[0],e)}}return!1}(t);default:return!1}}},3363:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("SHOW_IN_IMMERSIVE_READER",(function(e,t,n){return{itemId:e,actionSource:t,subActionSource:n}}))},3502:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(27);function o(){return!!Object(r.a)().SegmentationSettings.Rules}},3902:function(e,t,n){"use strict";n.d(t,"k",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"f",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return c})),n.d(t,"i",(function(){return s})),n.d(t,"h",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return l})),n.d(t,"j",(function(){return m})),n.d(t,"g",(function(){return f}));var r="27797656-b5ea-4db3-8043-0230f0b4d6d6",o="translate.buttonDesktop1_1",i="https://ogma.osi.office.net/outlooktranslatorapp/desktop",a="https://ogma.osi.office.net",c="https://ogma.osi.office.net/outlooktranslatorapp/desktop",s="1.0.8.1",u="https://ogma.osi.office.net/outlooktranslatorapp/Images/TranslateIcon64x64.png",d="Translator",l="Help you translate messages in your preferred language across devices",m="Microsoft",f="https://ogma.osi.office.net/outlooktranslatorapp/Images/TranslateIcon128x128.png"},4035:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1090),o=n(3902);function i(){var e=Object(r.a)(),t=e?e.Context:null,n=t?t.Extensions.filter((function(e){return e.Id==o.k})):[];return n.length>0&&n[0].Enabled}},4196:function(e){e.exports=JSON.parse('{"a":"j$b"}')},4625:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(108),o=new r.c((function(){return Promise.all([n.e(5),n.e(8),n.e(18),n.e(86),n.e(342)]).then(n.bind(null,7588))})),i=(new r.a(o,(function(e){return e.openCreateEditRuleSettingsPage})),new r.b(o,(function(e){return e.createRuleFromItem}))),a=new r.b(o,(function(e){return e.createRuleFromRow}))},4937:function(e,t,n){"use strict";var r=n(4),o=Object(r.createStore)("AddinsSurfaceActionsStore",{isAddinObserverLoaded:!1})();t.a=o},5190:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return s}));var r=n(108),o=new r.c((function(){return n.e(516).then(n.bind(null,10594))})),i=new r.b(o,(function(e){return e.onArchiveTagForFolderChanged})),a=new r.b(o,(function(e){return e.onDeleteTagForFolderChanged})),c=new r.b(o,(function(e){return e.getRetentionPolicyMenuItem})),s=new r.b(o,(function(e){return e.getAssignPolicyPropertiesForMailContextMenu}))},5496:function(e,t,n){"use strict";var r=n(0),o=n(5569),i=n(9),a=n(4),c=n(3363),s=function(e){return new Promise((function(t){return setTimeout((function(){t()}),e)}))},u=n(25),d=n(553);function l(e,t,n,r){return i=r,void 0===(o={itemId:e,sessionId:t,version:n}).itemId||o.itemId.__type||(o.itemId=Object(d.a)(o.itemId)),Object(u.a)("ImmersiveReaderProcessText",o,i);var o,i}var m=n(254),f=n(989),b=n(1533),p=(Object(a.orchestrator)(c.a,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,a,c,u,h,j,g,k,_,y,C,S,w;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(t=e.itemId,n=I(),!t||n.isLoading||0!==n.immersiveReaderFrameState)return[2];Object(b.a)(null),(a=new m.a("ShowInImmersiveReader")).addCustomData({sessionId:n.sessionId,subAction:e.subActionSource}),a.addActionSource(e.actionSource),p(!0),O(!0),c=(new Date).getUTCMilliseconds(),u=!0,h=null,j=null,r.label=1;case 1:return r.trys.push([1,7,8,9]),[4,l(Object(d.a)({Id:t.Id}),n.sessionId,"2.0",null===(w=t.mailboxInfo)||void 0===w?void 0:w.requestOptions)];case 2:if(g=r.sent(),a.addCheckmark("ImmersiveReaderProcessText_Done"),g&&g.ReaderModelJson?h=JSON.parse(g.ReaderModelJson):(u=!1,j="Response from service call was null or did not contain a ReaderModelJson"),!u)return[3,6];k=(new Date).getUTCMilliseconds(),_=(k-c).toString(),null,h.launchToPostMessageSentDurationInMs=_,v({messageType:"LinguisticModel",messageValue:h}),y=120,C=0,r.label=3;case 3:return C<y&&1===I().immersiveReaderFrameState?[4,s(500)]:[3,5];case 4:return r.sent(),C++,[3,3];case 5:1===I().immersiveReaderFrameState&&(u=!1,j="Frame never got to Ready state"),r.label=6;case 6:return[3,9];case 7:return S=r.sent(),u=!1,a.addCheckmark("CaughtException"),j=S.toString(),[3,9];case 8:return p(!1),[7];case 9:return u?a.end():(O(!1),a.endWithError("ServerError",new Error(j)),Object(f.b)(Object(i.b)(o.b),Object(i.b)(o.a),!1,{hideCancelButton:!0})),[2]}}))}))})),Object(a.mutatorAction)("toggleImmersiveReaderLoadingState",(function(e){I().isLoading=e}))),O=Object(a.mutatorAction)("toggleImmersiveReaderShowingState",(function(e){I().immersiveReaderFrameState=e?1:0})),v=Object(a.mutatorAction)("setImmersiveReaderApiResponse",(function(e){I().apiResponse=e})),h=n(428),j={sessionId:Object(h.a)(),isLoading:!1,immersiveReaderFrameState:0,apiResponse:null},I=Object(a.createStore)("immersivereader",j),g=I(),k=Object(a.mutatorAction)("setImmersiveReaderFrameReady",(function(){I().immersiveReaderFrameState=2})),_=Object(a.mutatorAction)("closeImmersiveReader",(function(){var e=I();e.immersiveReaderFrameState=0,e.apiResponse=null}));n.d(t,"e",(function(){return g})),n.d(t,"b",(function(){return I})),n.d(t,"c",(function(){return k})),n.d(t,"a",(function(){return _})),n.d(t,"d",(function(){return c.a}))},5510:function(e,t,n){"use strict";n(1139),n(22),n(1140);n(1315),n(1339);var r=n(4),o=Object(r.action)("POPOUT_READING_PANE",(function(e,t,n,r){return{itemId:e,conversationId:t,mailboxInfo:n,data:r}}));n.d(t,"a",(function(){return o}))},5569:function(e){e.exports=JSON.parse('{"b":"yYb","a":"zYb"}')},6212:function(e,t,n){"use strict";var r,o=n(4937),i=n(283),a=Object(i.action)("setAddinObserverLoaded ")((function(){o.a.isAddinObserverLoaded=!0})),c=n(1049);function s(e,t,n){return o.a.isAddinObserverLoaded&&r?r(e,t,n).get():null}n.d(t,"a",(function(){return s})),c.q.import().then((function(e){r=e,a()}))},6373:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return m}));var r=n(0),o=n(6212),i=n(233),a=n(1097),c=n(948),s=n(953),u=n(3112),d=n(1049);function l(e,t){var n=e.length;n>0&&e[n-1].displayName!=u.a&&e.push({key:"addinDivider_"+t,displayName:u.a,itemType:i.a.Divider,onClick:null})}function m(e,t,n,u,m,f,b,p,O,v,h,j){var I;h=h||function(e){if(!e||!e.ParentFolderId)return!1;var t=e.ParentFolderId.Id;return Object(c.C)(t,s.j)}(t);var g=e==a.a.MessageRead?Object(d.o)(n):Object(d.m)(n),k=Object(o.a)(e,h,g);I=k?k.sectionProps.items:[];var _=!0;I.forEach((function(e){Object(d.l)(g,e);var t=e;if(t.iconOnly=!0,O&&(t.className=O),t.disabled=!!j,u.indexOf(e.key)>=0){var n=t;v&&(n=Object(r.__assign)({},t)),null!=n.name&&null!=n.title&&n.name.trim()!=n.title.trim()&&(n.name=n.ariaLabel),n.title="",function(e,t,n){t.isPinned=!0,t.subMenuProps&&t.subMenuProps.items.forEach((function(e){e.isPinned=!0})),n?e.unshift(t):e.push(t)}(m,n,b)}(-1==u.indexOf(e.key)||v)&&(_&&(l(f,p++),_=!1),t.renderedInOverflow=!0,t.subMenuProps&&t.subMenuProps.items.forEach((function(e){e.renderedInOverflow=!0})),(t.itemType!==i.a.Divider||0!==f.length&&f[f.length-1].itemType!==i.a.Divider)&&f.push(t))}))}},6417:function(e){e.exports=JSON.parse('{"a":"Wkb"}')},7289:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1291),o=n(1421),i=n(484);function a(e){var t;return Object(r.a)([e.ItemId.Id],Object(i.a)({BaseShape:"IdOnly"}),"MessageDetails","V2016_06_24",null===(t=e.MailboxInfo)||void 0===t?void 0:t.requestOptions).then((function(e){return function(e){if(Object(o.a)(e[0])){var t=e[0].Items[0];if(null!=t.ExtendedProperty&&t.ExtendedProperty.length>=1)return t.ExtendedProperty[0].Value}return null}(e)}))}},7711:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(108),o=new r.c((function(){return n.e(284).then(n.bind(null,10667))})),i=new r.b(o,(function(e){return e.preparePopoutDataForReadingPane}))},7791:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(108),o=new r.c((function(){return n.e(577).then(n.bind(null,10623))})),i=new r.b(o,(function(e){return e.getSpacesContextMenuItems}))},8031:function(e,t,n){var r=n(13797),o=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},8032:function(e){e.exports=JSON.parse('{"e":"X9c","d":"Y9c","b":"Z9c","a":"_9c","c":"$9c"}')},8240:function(e,t,n){"use strict";var r=n(0),o=n(42),i=n(9183),a=n(2488),c=n(9),s=n(432),u=n(899),d=n(387),l=n(573),m=n(7289),f=n(1291),b=n(1421),p=n(484);function O(e){var t;return Object(f.a)([e.ItemId.Id],Object(p.a)({BaseShape:"IdOnly",IncludeMimeContent:!0}),null,"V2016_06_24",null===(t=e.MailboxInfo)||void 0===t?void 0:t.requestOptions).then((function(e){return function(e){return Object(b.a)(e[0])?e[0].Items[0].MimeContent:null}(e)}))}var v=n(295),h=n(1),j=n(244);n.d(t,"a",(function(){return _}));var I=n(479),g=n(9184),k=Object(o.a)((function(e,t){var n=Object(r.__read)(h.useState(""),2),o=n[0],m=n[1];h.useImperativeHandle(t,(function(){return{setContent:function(e){null!==e&&0!==e.length||(e=Object(c.b)(i.a)),m(e)}}}),[]);var f=function(){e.onClose()};return h.createElement(u.a,{hidden:!1,dialogContentProps:{showCloseButton:!1,title:Object(v.a)()?Object(c.b)(i.c):Object(c.b)(i.b),type:d.a.normal},modalProps:{containerClassName:g.container},onDismiss:f},h.createElement("div",{className:I(g.content,"allowTextSelection"),tabIndex:-1},o),h.createElement(l.a,null,h.createElement(s.a,{onClick:f,className:g.button},Object(c.b)(a.a))))}),{forwardRef:!0});function _(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,o;return Object(r.__generator)(this,(function(r){return(t=document.createElement("div")).id="ViewMessageSourceDialog",document.body.appendChild(t),n=function(){j.unmountComponentAtNode(t),document.body.removeChild(t)},o=h.createRef(),j.render(h.createElement(k,{onClose:n,ref:o}),t),Object(v.a)()?e.MimeContent?o.current.setContent(atob(e.MimeContent.Value)):O(e).then((function(t){e.MimeContent=t,o.current.setContent(atob(e.MimeContent.Value))})):Object(m.a)(e).then((function(e){o.current.setContent(e)})),[2]}))}))}},9107:function(e,t,n){"use strict";n(4937),n(6212);var r=n(6373);n.d(t,"a",(function(){return r.a}))},9183:function(e){e.exports=JSON.parse('{"c":"h_c","b":"i_c","a":"j_c"}')},9184:function(e,t,n){var r=n(9185),o=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},9185:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,'._1pVbbNWoU3A2KPJ5mTx9ss{width:750px!important;max-width:750px!important;height:550px;overflow:hidden}._2o7RMkbYm39CgXru8bzVk{width:690px;height:410px;overflow:auto;word-wrap:break-word;white-space:pre-line}._3c9eatHmfdZHfX00YKzcP4{color:"[theme:white, default:#ffffff]"!important}html[dir] ._3c9eatHmfdZHfX00YKzcP4{background-color:"[theme:themePrimary, default:#0078D4]";border-radius:2px}html[dir] ._3c9eatHmfdZHfX00YKzcP4:hover{background-color:"[theme:themeDark, default:#0D62AA]"}html[dir] ._3c9eatHmfdZHfX00YKzcP4:active{background-color:"[theme:themeDarker, default:#004578]"}',""]),t.locals={container:"_1pVbbNWoU3A2KPJ5mTx9ss",content:"_2o7RMkbYm39CgXru8bzVk",button:"_3c9eatHmfdZHfX00YKzcP4"}},9635:function(e,t,n){"use strict";function r(e){return!(e.CopyAllowed&&e.ForwardAllowed&&e.ReplyAllAllowed&&e.ReplyAllowed&&e.PrintAllowed)}n.d(t,"a",(function(){return r}))},984:function(e,t,n){"use strict";n.d(t,"l",(function(){return s})),n.d(t,"d",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return m})),n.d(t,"c",(function(){return f})),n.d(t,"e",(function(){return b})),n.d(t,"i",(function(){return p})),n.d(t,"h",(function(){return O})),n.d(t,"f",(function(){return v})),n.d(t,"j",(function(){return h})),n.d(t,"k",(function(){return j})),n.d(t,"g",(function(){return I}));var r,o,i=n(3),a=n(59),c=n(27),s=["ar-sa","da-dk","de-at","de-ch","de-de","el-gr","en-ar","en-at","en-au","en-br","en-ca","en-ch","en-cl","en-co","en-de","en-dk","en-fi","en-gb","en-gr","en-hk","en-ie","en-in","en-mx","en-my","en-nl","en-no","en-nz","en-pe","en-pt","en-sa","en-se","en-sg","en-th","en-tr","en-us","en-za","es-ar","es-cl","es-co","es-ec","es-es","es-mx","es-pe","es-us","es-ve","fi-fi","fr-be","fr-ca","fr-ch","fr-fr","it-it","ja-jp","ko-kr","ms-my","nb-no","nl-be","nl-nl","pt-br","pt-pt","sv-se","th-th","tr-tr","zh-cn","zh-hk","zh-sg","zh-tw"],u=["ar-ir","es-cu","ko-kp","ar-sy","en-su","uk-ua"],d={ae:"ar-ae",ar:"es-ar",at:"de-at",au:"en-au",be:"fr-be",br:"pt-br",ca:"en-ca",ch:"de-ch",cl:"es-cl",cn:"zh-cn",co:"es-co",cr:"es-cr",cu:"es-cu",de:"de-de",dk:"da-dk",do:"es-do",ec:"es-ec",eg:"ar-eg",es:"es-es",fi:"fi-fi",fr:"fr-fr",gb:"en-gb",uk:"en-gb",gr:"el-gr",gt:"es-gt",hk:"zh-hk",id:"id-id",ie:"en-ie",in:"en-in",ir:"ar-ir",it:"it-it",jp:"ja-jp",kp:"ko-kp",kr:"ko-kr",mx:"es-mx",my:"ms-my",nl:"nl-nl",no:"nb-no",nz:"en-nz",pe:"es-pe",ph:"fil-ph",pl:"pl-pl",pt:"pt-pt",ru:"ru-ru",sa:"ar-sa",se:"sv-se",sg:"en-sg",su:"en-su",th:"th-th",tr:"tr-tr",tw:"zh-tw",ua:"uk-ua",us:"en-us",ve:"es-ve",vn:"vi-vn",za:"en-za"};function l(){return Object(c.a)().SessionSettings.IsPremiumConsumerMailbox}function m(){return Object(c.a)().IsConsumerChild}function f(){return Object(c.a)().SessionSettings.IsShadowMailbox}function b(){return void 0!==o?o:o=function(){if(Object(i.d)("ormarket"))return Object(i.a)("ormarket");var e=Object(c.a)(),t=e.SessionSettings.UserCulture;if(!e.AdMarket||!/^[a-zA-z\-]*$/.test(e.AdMarket))return t?t.toLowerCase():"en-us";var n=e.AdMarket.toLowerCase();return s.indexOf(n)>-1?n:d[n.split("-")[1]]||n}()}function p(e){return null!=e?e.toUpperCase().split("-"):[]}function O(e){return p(e)[1]||"US"}function v(){return Object(a.a)("ANON")}function h(){return Object(a.a)("MUID")}function j(){return!!Object(a.a)("TOptOut")}function I(){return r||(r=Object(i.a)("anjs")||"https://acdn.adnxs.com/ast/static/0.30.1/ast.js")}}}]);
//# sourceMappingURL=owa.ItemActions.js.map
self.scriptsLoaded['owa.ItemActions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.ItemActions.js'] = (new Date()).getTime();