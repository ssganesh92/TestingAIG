self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.OutlookServiceOptions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[440],{15122:function(e,t,n){"use strict";n.r(t);var o,r=n(0),a=n(147),i=n(988),u=n(428),c=n(287),d=n(76),s=n(79),f=n(4);!function(e){e[e.OptionsNotLoaded=0]="OptionsNotLoaded",e[e.OptionsLoading=1]="OptionsLoading",e[e.OptionsLoaded=2]="OptionsLoaded"}(o||(o={}));var p={loadState:o.OptionsNotLoaded},O=Object(f.createStore)("owsOptionsLoadStateStore",p),l=n(1017);var b=n(1232),m="ows/v1.0/OutlookOptions",w=null,A=Object(f.mutatorAction)("setOptionLoadState",(function(e){O().loadState=e}));function v(){switch(O().loadState){case o.OptionsLoading:return w;case o.OptionsLoaded:return Promise.resolve();case o.OptionsNotLoaded:default:return A(o.OptionsLoading),w=Object(c.b)(m,void 0,void 0,{PreferOption:Object(d.h)("fwk-option-useRestCore")&&"Ows.UseRestCore"}).then((function(e){!function(e){e?(e.options&&e.options.forEach((function(e){null!=e&&(e.feature==i.a.SurfaceActions&&(e=function(e){return e.readSurfaceActions=e.readSurfaceActions?e.readSurfaceActions:[],e.readSurfaceAddins=e.readSurfaceAddins?e.readSurfaceAddins:[],e.composeSurfaceActions=e.composeSurfaceActions?e.composeSurfaceActions:[],e.composeSurfaceAddins=e.composeSurfaceAddins?e.composeSurfaceAddins:[],e}(e)),Object(i.g)(e.feature,e))})),void 0===t&&(t=Object(l.a)()),Object.keys(Object(i.e)().options).forEach((function(e){if(!Object(i.e)().options[e].lastModifiedDateTime&&t[e]){var n=Number(e);Object(i.c)(n,t[e])}})),A(o.OptionsLoaded)):(s.g.info("Error loading options"),Object(b.a)(),A(o.OptionsNotLoaded));var t}(e),w=null}))}}var S="ows/v1.0/OutlookOptions/{0}";function j(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,u,c;return Object(r.__generator)(this,(function(d){switch(d.label){case 0:return n=Object(a.a)(S,i.a[e]),O().loadState===o.OptionsLoaded?[3,2]:[4,v()];case 1:d.sent(),d.label=2;case 2:return O().loadState===o.OptionsLoaded?Object(i.e)().options[e]&&Object(i.e)().options[e].lastModifiedDateTime?t&&0!==Object.keys(t).length?((u=t)["feature@is.Queryable"],u["feature@odata.type"],u.createdDateTime,u.lastModifiedDateTime,c=Object(r.__rest)(u,["feature@is.Queryable","feature@odata.type","createdDateTime","lastModifiedDateTime"]),[2,h(1,n,c)]):(s.g.info("createOrUpdateOptionsForFeature called with no changes to options"),[2,Promise.resolve()]):[2,h(0,n,t)]:[2,Promise.reject(new Error("Options are not loaded. Cannot update options."))]}}))}))}function h(e,t,n){var o={correlationId:Object(u.a)(),options:n};return(1==e?c.c:c.d)(t,o,o.correlationId,void 0,{PreferOption:Object(d.h)("fwk-option-useRestCore")&&"Ows.UseRestCore"}).then((function(e){if(!function(e){if((null==e?void 0:e.options)&&1==e.options.length){var t=e.options[0];return Object(i.g)(t.feature,t),!0}return!1}(e)){var t=new Error("Error processing options response");throw t.networkError=!0,t}}))}function g(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,v()];case 1:return t.sent(),[2,Object(i.d)(e)]}}))}))}var L=Object(f.action)("updateAddInArray",(function(e,t,n){return{addinsArray:e,productId:t,isPushOperation:n}}));Object(f.mutator)(L,(function(e){e.isPushOperation?e.addinsArray.push(e.productId):e.addinsArray.splice(e.addinsArray.indexOf(e.productId),1)}));var E=L;function P(e,t,n){var o=Object(i.d)(i.a.SurfaceActions),r=Object(i.d)(i.a.CalendarSurfaceAddins),a=!!n.readMode&&k(o.readSurfaceAddins,e,t);a=n.composeMode?a||k(o.composeSurfaceAddins,e,t):a;var u=!!n.calendarMode&&k(r.calendarSurfaceAddins,e,t);a&&j(i.a.SurfaceActions,o),u&&j(i.a.CalendarSurfaceAddins,r)}var k=function(e,t,n){var o=!1;return n?-1===e.indexOf(t)&&(E(e,t,!0),o=!0):-1!==e.indexOf(t)&&(E(e,t,!1),o=!0),o};n.d(t,"createOrUpdateOptionsForFeature",(function(){return j})),n.d(t,"loadOptions",(function(){return v})),n.d(t,"getServerOptionsForFeature",(function(){return g})),n.d(t,"updateAddinPinStatus",(function(){return P}))},287:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return d})),n.d(t,"f",(function(){return s}));var o=n(108),r=(n(481),new o.c((function(){return Promise.all([n.e(28),n.e(4),n.e(460)]).then(n.bind(null,901))}))),a=(new o.a(r,(function(e){return e.makeOwsPrimeRequest})).importAndExecute,new o.a(r,(function(e){return e.makePostRequest})).importAndExecute),i=new o.a(r,(function(e){return e.makePatchRequest})).importAndExecute,u=new o.a(r,(function(e){return e.makePutRequest})).importAndExecute,c=new o.a(r,(function(e){return e.makeGetRequest})).importAndExecute,d=new o.a(r,(function(e){return e.makeDeleteRequest})).importAndExecute,s=new o.a(r,(function(e){return e.sendOwsPrimeRequest})).importAndExecute},428:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var o=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function r(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function a(){return r()+r()+"-"+r()+"-"+r()+"-"+r()+"-"+r()+r()+r()}function i(e){return o.test(e)}},481:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return r}));var o="owsserver",r="owsapi"}}]);
//# sourceMappingURL=owa.OutlookServiceOptions.js.map
self.scriptsLoaded['owa.OutlookServiceOptions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.OutlookServiceOptions.js'] = (new Date()).getTime();