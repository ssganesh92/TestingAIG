self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.FilterContextMenu.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[278],{10233:function(e,t,n){var r=n(11950),i=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},10617:function(e,t,n){"use strict";n.r(t);var r=n(42),i=n(11948),o=n(9152),a=n(9),c=n(11949),u=n(7256);function s(e){switch(e){case 1:return Object(a.b)(c.a);case 3:return Object(a.b)(c.b);case 7:return Object(a.b)(c.d);case 5:return Object(a.b)(c.c);case 8:return Object(a.b)(u.a);default:throw new Error("Sort not implemented")}}var l=n(8336),d=n(6640),f=n(6795),b=n(314),m=n(79);function p(e){switch(e){case"All":return Object(a.b)(o.a);case"Unread":return Object(a.b)(d.a);case"Flagged":return Object(a.b)(l.a);case"ToOrCcMe":return Object(a.b)(o.e);case"HasAttachment":return Object(a.b)(f.a);case"Mentioned":return Object(a.b)(o.d);case"TaskActive":case"TaskOverdue":case"TaskCompleted":case"DeprecatedSuggestions":case"DeprecatedSuggestionsRespond":case"DeprecatedSuggestionsDelete":case"DeprecatedNoClutter":case"DeprecatedClutter":case"SystemCategory":case"UserCategory":case"Pinned":case"Focused":case"Locked":case"Hashtag":case"Liked":return m.d("Filter not implemented"),"";default:return Object(b.a)(e)}}var g=n(5573),h=n(947),w=n(1),x=n(233),S=n(550),C=n(100),O=n(7281),k=n(984),y=n(2761),j=n(973),v=n(10233),D=Object(r.a)((function(e){var t=w.useMemo((function(){return h.T.tableViews.get(e.tableViewId)}),[e.tableViewId]),n=function(){var e=Object(h.E)(t),n=e.sortDirection==h.c.ASCENDING_SORT_DIR,r=e.sortColumn,o=h.c.getSupportedSortColumns(t.tableQuery.folderId),u=[],l=[];o.forEach((function(t){var n=r==t;l.push({key:t.toString(),name:s(t),data:{sortOrder:n?e.sortDirection:h.c.getDefaultSortDirectionForSortColumn(t),sortColumn:t},onClick:c,canCheck:!0,isChecked:n})})),u.push({key:"sortBySection",itemType:x.a.Section,sectionProps:{bottomDivider:!0,title:Object(a.b)(i.j),items:l}});var d=function(e){switch(e){case 1:return{ascendingString:Object(a.b)(i.g),descendingString:Object(a.b)(i.f)};case 3:case 8:return{ascendingString:Object(a.b)(i.a),descendingString:Object(a.b)(i.b)};case 7:return{ascendingString:Object(a.b)(i.h),descendingString:Object(a.b)(i.d)};case 5:return{ascendingString:Object(a.b)(i.e),descendingString:Object(a.b)(i.c)};default:throw new Error("Sort not implemented")}}(r),f=d.ascendingString,b=d.descendingString,m=[{key:"ascending",name:f,data:{sortOrder:"Ascending",sortColumn:r},onClick:c,canCheck:!0,isChecked:n},{key:"descending",name:b,data:{sortOrder:"Descending",sortColumn:r},onClick:c,canCheck:!0,isChecked:!n}];return u.push({key:"sortOrderSection",itemType:x.a.Section,sectionProps:{bottomDivider:!0,title:Object(a.b)(i.k),items:m}}),u},r=function(t){return{key:t.toString(),name:p(t),data:t,canCheck:!0,isChecked:e.currentViewFilter==t,onClick:u}},c=function(t,n){e.dismissContextMenu(),g.e.importAndExecute(n.data.sortColumn,n.data.sortOrder,e.tableViewId,e.filterMenuSource)},u=function(t,n){e.dismissContextMenu();var r=n.data;"Important"===r?g.c.importAndExecute(e.filterMenuSource):g.d.importAndExecute(r,e.filterMenuSource)},l=e.dismissContextMenu,d=e.contextMenuTargetElement,f=function(){var c=e.supportedViewFilters.filter((function(e){return!(Object(k.c)()&&("Mentioned"===e||"ToOrCcMe"===e))})).map((function(e){return r(e)}));if(Object(y.a)()&&t.tableQuery.folderId&&"inbox"==Object(j.a)(t.tableQuery.folderId)){var s=y.d.tryImportForRender(),l=(null==s?void 0:s())||0;c.push({key:"importantFilter",name:Object(a.b)(o.b),canCheck:!0,data:"Important",onClick:u,secondaryText:l>0?l.toString():null,itemProps:{styles:{secondaryText:v.secondaryText}}})}if(1!=t.tableQuery.type){c.push({key:"divider",name:"-"});var d=h.T.tableViews.get(e.tableViewId).tableQuery.folderId;c.push({key:"sortBy",name:Object(a.b)(i.i),items:n()});var f=O.a.tryImportForRender();if(f){var b=f(d,e.dismissContextMenu,"filterMenu");b&&(c.push({key:"divider",name:"-"}),c.push(b))}}return c}();return w.createElement(S.a,{shouldFocusOnMount:!0,target:d,directionalHint:C.DirectionalHint.bottomRightEdge,onDismiss:l,items:f})}));var I=n(0),M=n(305),E=n(1475),F=n(283),N=n(4),Q=Object(N.createStore)("mailListFilterView",{filterContextMenuDisplayState:!1}),V=Q(),P=Object(F.action)("showFilterDropDownContextMenu")((function(){Q().filterContextMenuDisplayState=!0})),H=Object(F.action)("hideFilterDropDownContextMenu")((function(){Q().filterContextMenuDisplayState=!1})),A=n(2401);Object(N.mutator)(A.e,(function(e){Q().filterContextMenuDisplayState=!0}));var T=n(981),_=n(479),R=n(10233),K=Object(r.a)((function(e){var t=w.useRef(),n=Object(h.K)(h.T.tableViews.get(e.tableViewId)),r="spotlight"===h.T.tableViews.get(e.tableViewId).tableQuery.scenarioType,i="All"==n&&!r,c=function(t){t.stopPropagation();var n=V.filterContextMenuDisplayState;r?g.b.importAndExecute(e.filterMenuSource):i?n?L():P():g.d.importAndExecute("All",e.filterMenuSource)},u=_(e.containerClassName,e.isInboxWithPivots&&R.filterPivots,V.filterContextMenuDisplayState?R.filterAllOpened:R.filterAll),s={role:T.a.button},l=w.useMemo((function(){return i?Object(a.b)(o.c):r?Object(a.b)(o.b):p(n)}),[e.tableViewId]);return w.createElement("div",Object(I.__assign)({ref:function(e){return t.current=e},className:u,onClick:c,onKeyDown:function(e){13!==e.keyCode&&32!==e.keyCode||(e.preventDefault(),c(e))}},Object(T.b)(s),{tabIndex:0}),w.createElement("div",{className:R.filterContents},l,w.createElement(M.a,{className:R.icon,iconName:i?"ChevronDownMed":"Cancel"})),V.filterContextMenuDisplayState&&w.createElement(D,{currentViewFilter:n,supportedViewFilters:e.supportedViewFilters,dismissContextMenu:L,contextMenuTargetElement:t.current,filterMenuSource:e.filterMenuSource,tableViewId:e.tableViewId}))}));function L(){H(),E.b.importAndExecute()}n.d(t,"MailFilterContextMenu",(function(){return D})),n.d(t,"MailListFilterMenu",(function(){return K}))},11948:function(e){e.exports=JSON.parse('{"i":"Ekd","j":"Fkd","k":"Gkd","a":"Hkd","b":"Ikd","g":"Jkd","f":"Kkd","d":"Lkd","h":"Mkd","c":"Nkd","e":"Okd"}')},11949:function(e){e.exports=JSON.parse('{"a":"Akd","b":"Bkd","d":"Ckd","c":"Dkd"}')},11950:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,'._2HxQ4wKES5wjvIgnjfLcQK,._3HGhEMHDY2i8us0auVPsuI{cursor:pointer;font-size:14px;font-weight:400;color:"[theme:themePrimary, default:#0078D4]";font-weight:600;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-align:baseline;-ms-flex-align:baseline;align-items:baseline;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;height:32px}html[dir] ._2HxQ4wKES5wjvIgnjfLcQK,html[dir] ._3HGhEMHDY2i8us0auVPsuI{padding:0 8px;border-radius:2px;margin-top:5px}html[dir=ltr] ._2HxQ4wKES5wjvIgnjfLcQK,html[dir=ltr] ._3HGhEMHDY2i8us0auVPsuI{margin-left:auto;margin-right:-8px}html[dir=rtl] ._2HxQ4wKES5wjvIgnjfLcQK,html[dir=rtl] ._3HGhEMHDY2i8us0auVPsuI{margin-right:auto;margin-left:-8px}html[dir] ._2HxQ4wKES5wjvIgnjfLcQK:hover,html[dir] ._3HGhEMHDY2i8us0auVPsuI{background-color:"[theme:neutralLighter, default:#f4f4f4]"}html[dir] .SNcGPM0gk8ayZzwzROpZX{margin-bottom:8px}html[dir] ._3lIR1LfENBYPLTyCDNhq5k{margin-top:6px}._2oQ9sQfC-vORW35CueNgmA{font-weight:400;font-size:10px;color:"[theme:themePrimary, default:#0078D4]"}html[dir=ltr] ._2oQ9sQfC-vORW35CueNgmA{padding-left:4px}html[dir=rtl] ._2oQ9sQfC-vORW35CueNgmA{padding-right:4px}.QCFDYNlgEXFDrarlbtyNf{color:"[theme:themePrimary, default:#0078D4]"}html[dir=ltr] .QCFDYNlgEXFDrarlbtyNf{margin-right:3px}html[dir=rtl] .QCFDYNlgEXFDrarlbtyNf{margin-left:3px}',""]),t.locals={filterAll:"_2HxQ4wKES5wjvIgnjfLcQK",filterAllOpened:"_3HGhEMHDY2i8us0auVPsuI",filterPivots:"SNcGPM0gk8ayZzwzROpZX",filterContents:"_3lIR1LfENBYPLTyCDNhq5k",icon:"_2oQ9sQfC-vORW35CueNgmA",secondaryText:"QCFDYNlgEXFDrarlbtyNf"}},1475:function(e,t,n){"use strict";var r=n(108),i={sequentialIndex:"0",nonSequentialIndex:"-1"};n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return i}));var o=new r.c((function(){return n.e(384).then(n.bind(null,15335))})),a=new r.a(o,(function(e){return e.registerComponent})),c=new r.a(o,(function(e){return e.resetFocus})),u=new r.a(o,(function(e){return e.setFocusToSynchronous}))},2698:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1004),i=n(76);function o(){return Object(i.h)("tri-spotlight2")&&!Object(r.a)(2048)}},2761:function(e,t,n){"use strict";n.d(t,"e",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"i",(function(){return d})),n.d(t,"g",(function(){return f})),n.d(t,"f",(function(){return b}));var r=n(108),i=n(2762);n.d(t,"b",(function(){return i.a}));var o=n(2698);n.d(t,"a",(function(){return o.a}));var a=new r.c((function(){return Promise.all([n.e(4),n.e(20),n.e(38),n.e(553)]).then(n.bind(null,5482))})),c=new r.a(a,(function(e){return e.initializeSpotlight})),u=new r.b(a,(function(e){return e.getSpotlightRollupData})),s=new r.b(a,(function(e){return e.getUnacknowledgedSpotlightCount})),l=new r.a(a,(function(e){return e.onSpotlightDismissedFromLV})),d=new r.a(a,(function(e){return e.onSpotlightRollupDismissed})),f=new r.a(a,(function(e){return e.logSpotlightItemClicked})),b=new r.a(a,(function(e){return e.loadSpotlightRowsFromServer}))},2762:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2763);function i(e){var t=e.itemId,n=e.conversationId,i=e.rowKey;return Object(r.a)().spotlightItems.some((function(e){return t&&e.itemId===t||n&&e.conversationId===n||i&&e.rowKey===i}))}},2763:function(e,t,n){"use strict";var r=n(428),i=n(4),o={spotlightItems:[],rollupDismissed:!1,logicalId:Object(r.a)()},a=Object(i.createStore)("spotlightStore",o);t.a=a},5573:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return a})),n.d(t,"f",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return l}));var r=n(108),i=new r.c((function(){return Promise.all([n.e(38),n.e(41),n.e(94),n.e(382)]).then(n.bind(null,10621))})),o=new r.a(i,(function(e){return e.selectFilter})),a=new r.a(i,(function(e){return e.selectSort})),c=new r.a(i,(function(e){return e.togglePauseInbox})),u=new r.a(i,(function(e){return e.clearFilter})),s=new r.a(i,(function(e){return e.loadSpotlightFilter})),l=new r.a(i,(function(e){return e.clearSpotlightFilter}))},6640:function(e){e.exports=JSON.parse('{"a":"c4b"}')},6795:function(e){e.exports=JSON.parse('{"a":"t4b"}')},7256:function(e){e.exports=JSON.parse('{"a":"Y4a"}')},7281:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(108),i=new r.c((function(){return n.e(461).then(n.bind(null,9969))})),o=new r.b(i,(function(e){return e.getPauseInboxContextMenuItem}))},8336:function(e){e.exports=JSON.parse('{"a":"ukd"}')},9152:function(e){e.exports=JSON.parse('{"c":"vkd","a":"wkd","e":"xkd","d":"ykd","b":"zkd"}')}}]);
//# sourceMappingURL=owa.FilterContextMenu.js.map
self.scriptsLoaded['owa.FilterContextMenu.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.FilterContextMenu.js'] = (new Date()).getTime();