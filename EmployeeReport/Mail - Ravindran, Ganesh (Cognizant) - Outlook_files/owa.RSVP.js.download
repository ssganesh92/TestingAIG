self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.RSVP.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[493],{6160:function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(4),a=Object(r.action)("parseGetItemResponseAction",(function(e,t){return{items:e,clientItemIds:t}})),o=Object(r.action)("tryPrefetchMeetingMessage",(function(e,t,n){return{mailboxInfo:e,listViewType:t,shouldDelayPrefetch:n}})),c=Object(r.action)("removeMeetingMessagesFromStore",(function(e){return{itemIds:e}})),s=n(3734),d=n(254),l=n(947),u=n(963),m=n(9035),I=n(484),b=n(964),g=n(40),f=n(79),j=n(1421),O=n(9036),h=[Object(b.a)({FieldURI:"Start"}),Object(b.a)({FieldURI:"End"}),Object(b.a)({FieldURI:"AssociatedCalendarItemId"}),Object(b.a)({FieldURI:"RecurrenceId"}),Object(b.a)({FieldURI:"Recurrence"}),Object(b.a)({FieldURI:"ConflictingMeetings"}),Object(b.a)({FieldURI:"CalendarItemType"}),Object(b.a)({FieldURI:"IsResponseRequested"}),Object(b.a)({FieldURI:"Organizer"}),Object(b.a)({FieldURI:"ItemClass"}),Object(b.a)({FieldURI:"MeetingRequestType"}),Object(b.a)({FieldURI:"ItemParentId"}),Object(b.a)({FieldURI:"Sender"}),Object(b.a)({FieldURI:"ConversationId"}),Object(b.a)({FieldURI:"IsDelegated"}),Object(b.a)({FieldURI:"ReceivedRepresenting"}),Object(b.a)({FieldURI:"ResponseType"})];function R(e,t,n){return Object(i.__awaiter)(this,void 0,void 0,(function(){var r,o,c,s,b,g,R;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:(r=new d.a("LoadMeetingMessage")).addCustomProperty("count",e.length),o=e.map((function(e){return e.Id})),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,Object(u.g)(o,Object(I.a)({BaseShape:"IdOnly",AdditionalProperties:h}),null)];case 2:return c=i.sent(),(s=c.filter((function(e){return Object(j.a)(e)}))).length>0?(b=[],s.forEach((function(e){return b=b.concat(e.Items)})),g=e.filter((function(e){return b.some((function(t){return t.ItemId.Id===e.Id}))})),a(b,g),r.end()):r.endWithError("ServerError"),s.length!==c.length&&f.g.warn("[loadingmeetingmessage] some items failed in: "+o),[3,4];case 3:return R=i.sent(),r.endWithError("ServerError",Error(R)),f.g.warn("[loadingmeetingmessage] all items failed in: "+o),[3,4];case 4:return function(e,t){t.forEach((function(t){if(1===e){var n=u.w.items.get(t.itemId);if(!n)return;Object(m.a)(t.itemId)&&Object(O.a)(Object(m.a)(t.itemId))||(f.g.warn("[loadingmeetingmessage] reverting shouldShowRSVP on item: "+t.itemId),n.shouldShowRSVP=!1)}else{var i=Object(l.G)(t.rowKey,t.tableViewId);if(!i)return;Object(m.a)(t.itemId)&&Object(O.a)(Object(m.a)(t.itemId))||(f.g.warn("[loadingmeetingmessage] reverting shouldShowRSVP on tableConversationRelation for item: "+t.itemId),i.shouldShowRSVP=!1)}}))}(n,t),[2]}}))}))}Object(r.orchestrator)(o,(function(e){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r,a,o,c;return Object(i.__generator)(this,(function(d){return t=e.listViewType,n=e.mailboxInfo,r=e.shouldDelayPrefetch,a=n.mailboxSmtpAddress,o=s.b(a),s.c(a),o&&0!==o.length?(c=o.map((function(e){return{Id:e.itemId,mailboxInfo:n}})),r?Object(g.a)((function(){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){return R(c,o,t),[2]}))}))})):R(c,o,t),[2]):[2]}))}))})),Object(r.mutator)(a,(function(e){for(var t=e.items,n=e.clientItemIds,r=function(e){var r=t[e],a=n[e],o=Object(l.F)().meetingMessageItems.get(a.Id);if(o){Object.keys(o).forEach((function(e){r[e]&&(o[e]=r[e])}))}else{var c=Object(i.__assign)(Object(i.__assign)({},r),{MailboxInfo:a.mailboxInfo,SmartTimeData:null,SmartTaskData:null,SmartTimeExtendedProperty:null,smartPillFeedbackSubmitted:!1});Object(l.F)().meetingMessageItems.set(a.Id,c)}},a=0;a<t.length;a++)r(a)})),Object(r.mutator)(c,(function(e){var t=e.itemIds,n=Object(l.F)();t.forEach((function(e){n.meetingMessageItems.has(e)&&setTimeout((function(){n.meetingMessageItems.delete(e)}),1e3)}))})),n.d(t,"tryPrefetchMeetingMessage",(function(){return o})),n.d(t,"removeMeetingMessagesFromStore",(function(){return c}))}}]);
//# sourceMappingURL=owa.RSVP.js.map
self.scriptsLoaded['owa.RSVP.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.RSVP.js'] = (new Date()).getTime();