self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.WorkloadScenarioSettings.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[616],{1161:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u}));var r,i=n(103);function a(){var e,t,n=s();return o()&&n?r.ToDo:(t=Object(i.i)(),(null===(e=t.SessionSettings)||void 0===e?void 0:e.IsShadowMailbox)||n?r.None:r.LegacyTasks)}function c(){return o()&&s()}function u(){return o()&&s(!0)}function o(){var e,t,n=Object(i.i)(),r=null===(e=n.SessionSettings)||void 0===e?void 0:e.IsExplicitLogon,a=null===(t=n.SessionSettings)||void 0===t?void 0:t.IsShadowMailbox;return!r&&!a}function s(e){var t=Object(i.i)(),n=t.UserOptions,r=t.PolicySettings;return!!((null==n?void 0:n.ReactOptinSettings)&&(n.ReactOptinSettings.TasksGraduatedFromBeta||n.ReactOptinSettings.TasksEnabled&&(e||function(e){var t;return(null===(t=null==e?void 0:e.ReactOptinSettings)||void 0===t?void 0:t.TasksShouldUseSharedToggle)?1!==e.ClientTypeOptInState:1!==e.TasksClientTypeOptInState}(n))&&function(e){if(e&&!1===e.OutlookBetaToggleEnabled)return!1;return!0}(r))&&null!==n.ReactOptinSettings.TasksRedirectUrl)}!function(e){e[e.None=0]="None",e[e.LegacyTasks=1]="LegacyTasks",e[e.ToDo=2]="ToDo"}(r||(r={}))},1285:function(e,t,n){"use strict";var r=n(4),i=Object(r.action)("openTimePanel",(function(e){return{source:e}})),a=Object(r.action)("handleTimePanelClosed",(function(e,t,n,r){return{source:e,sessionDuration:t,lastView:n,clientItemId:r}})),c=Object(r.action)("popView"),u=n(76);function o(){return Object(u.h)("cal-time-panel")}var s=n(556);function d(){return(!Object(s.v)()||!window.opener)&&o()}var l=n(1161);function f(){return d()&&Object(l.c)()}n.d(t,"e",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"f",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return f}))},1444:function(e,t,n){"use strict";var r=n(4),i=Object(r.action)("closeFlexPane",(function(e){return{flexPaneId:e}}));t.a=i},1533:function(e,t,n){"use strict";function r(){return window.O365Shell}var i=n(4),a=Object(i.action)("openFlexPane",(function(e){return{flexPaneId:e}})),c=(Object(i.orchestrator)(a,(function(e){var t=r();t&&t.FlexPane.OpenFlexPaneForProvider(e.flexPaneId)})),n(1444));Object(i.orchestrator)(c.a,(function(e){var t=r();t&&t.FlexPane.CloseFlexPaneForProvider(e.flexPaneId)}));function u(e){var t=r();t&&t.Theme.SetSearchActive(e)}function o(e,t){r().Extensibility.SetCustomHeaderButtonBadgeValue(e,t)}function s(e,t){r().Extensibility.UpdateButtonState(e,t)}n.d(t,"a",(function(){return c.a})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"b",(function(){return r}))},1930:function(e,t,n){"use strict";var r=n(3295),i=n(4),a=Object(i.createStore)("timePanelSettingStore",{panelViewStack:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{stack:e||[]}}(Object(r.a)().initialPanelView)}),c={Conflicts:"Calendar",EventDetails:"Calendar",AttendeeTracking:"Calendar",Calendar:"Calendar",ComposeForm:"Calendar",Tasks:"Tasks",TaskDetails:"Tasks"};function u(e){return e?c[e]:null}var o=n(1161);function s(e){return!("Tasks"===u(e)&&!Object(o.c)())}var d=n(1984),l=n(114),f=Object(i.action)("pushTimePanelView",(function(e){return{newView:e}})),b=Object(i.action)("updateTopTimePanelView",(function(e){return{updatedView:e}})),O=Object(i.action)("popTimePanelView");function v(e){s(e)&&function(e,t){if(0===t.length)return null;t[t.length-1]=e}(e,a().panelViewStack.stack)}Object(i.mutator)(f,(function(e){var t,n=e.newView;s(n)&&(t=n,a().panelViewStack.stack.push(t))})),Object(i.mutator)(b,(function(e){return v(e.updatedView)})),Object(i.mutator)(O,(function(){var e=a().panelViewStack;e.stack.pop()})),Object(i.mutator)(d.i,(function(e){var t=e.settings,n=e.userIdentity;Object(l.e)().userIdentity===n&&t.timePanelSelectedView&&v(t.timePanelSelectedView)}));var m=n(0),p=n(515),w=n(79),j=Object(p.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(p.a)(1e3)}),h=null;function S(){return u(P())}function P(){var e,t=a().panelViewStack;return 0===(e=t.stack).length?null:e[e.length-1]}function T(){return a().panelViewStack.stack.length}function I(){return-1!==a().panelViewStack.stack.indexOf("Conflicts")}function _(){return-1!==a().panelViewStack.stack.indexOf("AttendeeTracking")}function g(){var e=a().panelViewStack;return T()>=2?e.stack[T()-2]:null}Object(i.orchestrator)(b,(function(e){return Object(m.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(m.__generator)(this,(function(r){switch(r.label){case 0:if(t=e.updatedView,"Tasks"!==(i=t)&&"Calendar"!==i||!s(t))return[3,5];r.label=1;case 1:return r.trys.push([1,3,,4]),h&&h.cancel(),[4,(h=j((function(){return Object(d.h)(t)}))).retriableFunc()];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),w.g.warn("viewStackOrchestrator: updateTimePanelSelectedViewService with retry failed: "+n),[3,4];case 4:h=null,r.label=5;case 5:return[2]}var i}))}))})),n.d(t,"i",(function(){return f})),n.d(t,"j",(function(){return b})),n.d(t,"h",(function(){return O})),n.d(t,"b",(function(){return S})),n.d(t,"a",(function(){return P})),n.d(t,"e",(function(){return T})),n.d(t,"g",(function(){return I})),n.d(t,"f",(function(){return _})),n.d(t,"d",(function(){return g})),n.d(t,"c",(function(){return u}))},1984:function(e,t,n){"use strict";var r=n(4),i=n(0),a=n(103),c=Object(r.action)("WORKLOAD_SCENARIO_SETTINGS_LOADED",(function(e,t){return{settings:e,userIdentity:t}})),u=Object(r.action)("LOADING_WORKLOAD_SCENARIO_SETTINGS_FAILED",(function(e){return{userIdentity:e}}));var o="ows/beta/ScenarioSettings",s=["IsTimePanelDatePickerExpanded","TimePanelCalendarIds","IsTimePanelCalendarViewTaskListSelected"];function d(e){switch(e){case 1:return"Mail";case 2:return"Calendar";case 64:return"FilesHub";case 4:return"People";default:throw new Error("getWorkloadScenarioType: The workload type is not supported")}}var l=71;function f(e){return 0!=(e&l)}var b=n(1026);function O(e){if(s.some((function(t){return t===e})))return"Owa";var t=Object(b.b)();return f(t)?d(t):null}var v=n(315),m=n(287);function p(e){var t;return Object(i.__awaiter)(this,void 0,void 0,(function(){var n,r,a,c,u,s,l,p;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return n=["Owa"],f(r=Object(b.b)())&&(a=d(r),n.push(a)),c=function(e){var t=e.join(",");return o+"/?Scenarios="+t}(n),s=m.b,l=[c,void 0,void 0],[4,Object(v.b)(e)];case 1:return[4,s.apply(void 0,l.concat([i.sent(),!0,void 0,"GET_WORKLOAD_SCENARIO_SETTINGS"]))];case 2:return u=i.sent(),p={timePanelSelectedView:null,timePanelCalendarIds:[],timePanelSelectedCalendarView:null,isTimePanelOpen:!1,isTimePanelDatePickerExpanded:!1,isTimePanelCalendarViewTaskListSelected:!0},null===(t=null==u?void 0:u.settings)||void 0===t||t.forEach((function(e){var t,n=O(e.settingName);(t=e).calendarIds&&"TimePanelCalendarIds"===t.settingName&&n===O("TimePanelCalendarIds")?p.timePanelCalendarIds=e.calendarIds:!function(e){return!!e.selectedView&&"TimePanelSelectedView"===e.settingName}(e)||n!==O("TimePanelSelectedView")?!function(e){return!!e.selectedView&&"SelectedCalendarListView"===e.settingName}(e)||n!==O("SelectedCalendarListView")?!function(e){return void 0!==e.isOpen&&"IsTimePanelOpen"===e.settingName}(e)||n!==O("IsTimePanelOpen")?!function(e){return void 0!==e.isExpanded&&"IsTimePanelDatePickerExpanded"===e.settingName}(e)||n!==O("IsTimePanelDatePickerExpanded")?function(e){return void 0!==e.isSelected&&"IsTimePanelCalendarViewTaskListSelected"===e.settingName}(e)&&n===O("IsTimePanelCalendarViewTaskListSelected")&&(p.isTimePanelCalendarViewTaskListSelected=e.isSelected):p.isTimePanelDatePickerExpanded=e.isExpanded:p.isTimePanelOpen=e.isOpen:p.timePanelSelectedCalendarView=e.selectedView:p.timePanelSelectedView=e.selectedView})),[2,p]}}))}))}var w=n(515),j=Object(w.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(w.a)(1e4)}),h={};function S(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e;return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return e=Object(a.g)().map(P),[4,Promise.all(e)];case 1:return t.sent(),[2]}}))}))}function P(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),h[e]?[2]:(h[e]=j((function(){return p(e)})),[4,h[e].retriableFunc()]);case 1:return t=n.sent(),c(t,e),[3,3];case 2:return n.sent(),u(e),[3,3];case 3:return[2]}}))}))}var T=n(646);Object(r.orchestrator)(T.d,(function(e){P(e.userIdentity)}));function I(e,t){return o+"/"+e+"/"+t}function _(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,r;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return(t=O("TimePanelSelectedView"))?(n=I(t,"TimePanelSelectedView"),r={ViewType:e},[4,Object(m.c)(n,r,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}}))}))}function g(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n,r,a,c,u;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return(n=O("TimePanelCalendarIds"))?(r=I(n,"TimePanelCalendarIds"),a={CalendarIds:e},c=m.c,u=[r,a,void 0,void 0],[4,Object(v.b)(t)]):[3,3];case 1:return[4,c.apply(void 0,u.concat([i.sent(),!0,void 0]))];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function k(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,r;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return(t=O("IsTimePanelOpen"))?(n=I(t,"IsTimePanelOpen"),r={IsOpen:e},[4,Object(m.c)(n,r,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}}))}))}function E(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,r;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return(t=O("SelectedCalendarListView"))?(n=I(t,"SelectedCalendarListView"),r={ViewType:e},[4,Object(m.c)(n,r,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}}))}))}function C(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,r;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return(t=O("IsTimePanelDatePickerExpanded"))?(n=I(t,"IsTimePanelDatePickerExpanded"),r={isExpanded:e},[4,Object(m.c)(n,r,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}}))}))}function V(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,r;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return(t=O("IsTimePanelCalendarViewTaskListSelected"))?(n=I(t,"IsTimePanelCalendarViewTaskListSelected"),r={isSelected:e},[4,Object(m.c)(n,r,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}}))}))}n.d(t,"i",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return S})),n.d(t,"h",(function(){return _})),n.d(t,"g",(function(){return g})),n.d(t,"f",(function(){return k})),n.d(t,"e",(function(){return E})),n.d(t,"d",(function(){return C})),n.d(t,"c",(function(){return V}))},287:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"f",(function(){return d}));var r=n(108),i=(n(481),new r.c((function(){return Promise.all([n.e(28),n.e(4),n.e(460)]).then(n.bind(null,901))}))),a=(new r.a(i,(function(e){return e.makeOwsPrimeRequest})).importAndExecute,new r.a(i,(function(e){return e.makePostRequest})).importAndExecute),c=new r.a(i,(function(e){return e.makePatchRequest})).importAndExecute,u=new r.a(i,(function(e){return e.makePutRequest})).importAndExecute,o=new r.a(i,(function(e){return e.makeGetRequest})).importAndExecute,s=new r.a(i,(function(e){return e.makeDeleteRequest})).importAndExecute,d=new r.a(i,(function(e){return e.sendOwsPrimeRequest})).importAndExecute},3289:function(e,t,n){"use strict";var r=n(4),i=Object(r.action)("DEACTIVATE_CHARM",(function(e){return{charm:e}})),a=Object(r.createStore)("headerViewState",{activeCharm:null});Object(r.mutator)(i,(function(e){var t=e.charm,n=a();n.activeCharm===t&&(n.activeCharm=null)}));var c=Object(r.action)("TOGGLE_CHARM",(function(e){return{charm:e}}));function u(){return a().activeCharm}Object(r.mutator)(c,(function(e){var t=e.charm,n=a();n.activeCharm===t?n.activeCharm=null:n.activeCharm=t})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return c}))},3295:function(e,t,n){"use strict";var r=n(0),i={abovePanelHeight:n(3570).b,initialPanelView:"Calendar",areFREsDisabled:!1,isInlineComposeDisabled:!1};function a(e){i=Object(r.__assign)({},e)}function c(){return i}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c}))},3570:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));var r=48,i=65},4003:function(e,t,n){"use strict";var r=n(4),i=n(123),a=Object(r.action)("updateSelectedCalendarView",(function(e){return{updatedView:e}})),c=Object(r.action)("updateIsTaskListSelected",(function(e){return Object(i.c)({name:"updateIsTaskListSelected",customData:{isSelected:e}},{isSelected:e})})),u=Object(r.action)("updateIsDatePickerExpanded",(function(e){return Object(i.c)({name:"updateIsDatePickerExpanded",customData:{isExpanded:e}},{isExpanded:e})})),o=n(103),s=Object(r.createStore)("calendarListSettingsStore",{selectedView:"Agenda",isDatePickerExpanded:Object(o.u)(),isTaskListSelected:!0});function d(){return s().selectedView}function l(){return s().isTaskListSelected}function f(){return s().isDatePickerExpanded}var b=n(1984),O=n(114);function v(e){s().isDatePickerExpanded=e}function m(e){s().isTaskListSelected=e}Object(r.mutator)(u,(function(e){return v(e.isExpanded)})),Object(r.mutator)(b.i,(function(e){var t=e.settings,n=e.userIdentity;Object(O.e)().userIdentity===n&&null!==t.isTimePanelDatePickerExpanded&&void 0!==t.isTimePanelDatePickerExpanded&&v(e.settings.isTimePanelDatePickerExpanded)})),Object(r.mutator)(c,(function(e){return m(e.isSelected)})),Object(r.mutator)(b.i,(function(e){var t=e.settings,n=e.userIdentity;Object(O.e)().userIdentity===n&&null!==t.isTimePanelCalendarViewTaskListSelected&&void 0!==t.isTimePanelCalendarViewTaskListSelected&&m(e.settings.isTimePanelCalendarViewTaskListSelected)}));var p=Object(r.action)("updateSelectedCalendarViewInStore",(function(e){return{updatedView:e}})),w=(Object(r.mutator)(p,(function(e){var t=e.updatedView;s().selectedView=t})),n(0)),j=n(515),h=n(79),S=Object(j.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(j.a)(1e3)}),P=null;Object(r.orchestrator)(u,(function(e){return Object(w.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(w.__generator)(this,(function(r){switch(r.label){case 0:t=e.isExpanded,r.label=1;case 1:return r.trys.push([1,3,,4]),P&&P.cancel(),[4,(P=S((function(){return Object(b.d)(t)}))).retriableFunc()];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),h.g.warn("updateIsDatePickerExpandedOrchestrator: updateIsTimePanelDatePickerExpandedService with retry failed: "+n),[3,4];case 4:return P=null,[2]}}))}))}));var T=Object(j.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(j.a)(1e3)}),I=null;Object(r.orchestrator)(c,(function(e){return Object(w.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(w.__generator)(this,(function(r){switch(r.label){case 0:t=e.isSelected,r.label=1;case 1:return r.trys.push([1,3,,4]),I&&I.cancel(),[4,(I=T((function(){return Object(b.c)(t)}))).retriableFunc()];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),h.g.warn("updateIsTaskListSelectedOrchestrator: updateIsTimePanelCalendarViewTaskListSelectedService with retry failed: "+n),[3,4];case 4:return I=null,[2]}}))}))}));var _=Object(j.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(j.a)(1e3)}),g=null;Object(r.orchestrator)(a,(function(e){return Object(w.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(w.__generator)(this,(function(r){switch(r.label){case 0:t=e.updatedView,p(t),r.label=1;case 1:return r.trys.push([1,3,,4]),g&&g.cancel(),[4,(g=_((function(){return Object(b.e)(t)}))).retriableFunc()];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),h.g.warn("updateSelectedCalendarViewOrchestrator: updateSelectedCalendarView with retry failed: "+n),[3,4];case 4:return g=null,[2]}}))}))}));Object(r.orchestrator)(b.i,(function(e){var t=e.settings,n=e.userIdentity;Object(O.e)().userIdentity===n&&t.timePanelSelectedCalendarView&&p(t.timePanelSelectedCalendarView)}));n.d(t,"f",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return f}))},4749:function(e,t,n){"use strict";var r,i=n(4),a=Object(i.action)("UPDATE_SELECTED_TIME_PANEL_CALENDARIDS_IN_STORE",(function(e,t){return{calendarIds:e,userIdentity:t}})),c=Object(i.action)("SET_TIME_PANEL_CONFIG_LOAD_STATE",(function(e,t){return{loadState:e,userIdentity:t}})),u=Object(i.action)("UPDATE_SELECTED_TIME_PANEL_CALENDARIDS",(function(e,t){return{calendarIds:e,userIdentity:t}})),o=Object(i.action)("ON_SELECTED_TIME_PANEL_CALENDARIDS_UPDATED");!function(e){e[e.Loaded=0]="Loaded",e[e.Failed=1]="Failed"}(r||(r={}));var s=n(76),d=n(1984),l=(Object(i.orchestrator)(d.b,(function(e){Object(s.h)("cal-time-panel-calendarPicker")&&(c(r.Failed,e.userIdentity),o())})),n(24)),f=Object(i.createStore)("timePanelSelectedCalendarIdsStore",{configLoadStates:new l.ObservableMap,calendarIdsMap:new l.ObservableMap}),b=n(1206);function O(){return Object(b.c)(f().calendarIdsMap)}function v(e){return e?function(e){var t=O().get(e);return t?t.length:0}(e):Object(b.d)(O()).length}function m(){return!!Object(s.h)("cal-time-panel-calendarPicker")&&v()>0}var p=n(1581),w=(Object(i.orchestrator)(p.f,(function(){m()||o()})),n(0));function j(){return f().configLoadStates}function h(){if(!Object(s.h)("cal-time-panel-calendarPicker"))return Object(p.b)();var e=j(),t=0===e.size,n=Object(w.__spread)(e.values()).some((function(e){return e===r.Loaded}));return t||n&&m()?O():Object(p.b)()}var S=n(515),P=n(79),T=n(103),I=n(114),_=Object(S.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(S.a)(1e3)}),g={};Object(i.orchestrator)(u,(function(e){return Object(w.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(w.__generator)(this,(function(r){switch(r.label){case 0:return t=e.calendarIds,n=e.userIdentity,Object(I.e)().userIdentity===n&&1===v()&&1===v(n)&&0===t.length?[2]:m()?[3,2]:[4,k()];case 1:r.sent(),r.label=2;case 2:return E(t,n),[2]}}))}))}));function k(){return Object(w.__awaiter)(this,void 0,void 0,(function(){return Object(w.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all(Object(T.g)().map((function(e){var t;E(null!==(t=Object(p.b)().get(e))&&void 0!==t?t:[],e,!0)})))];case 1:return e.sent(),[2]}}))}))}function E(e,t,n){var r;return Object(w.__awaiter)(this,void 0,void 0,(function(){var i,c,u,s;return Object(w.__generator)(this,(function(l){switch(l.label){case 0:i=Object(b.b)(e),c=h().get(t),l.label=1;case 1:return l.trys.push([1,3,4,5]),a(i,t),n||o(),null===(r=g[t])||void 0===r||r.cancel(),u=_((function(){return Object(d.g)(i,t)})),g[t]=u,[4,u.retriableFunc()];case 2:return l.sent(),[3,5];case 3:return s=l.sent(),P.g.warn("updateSelectedCalendarIdsOrchestrator: updateTimePanelCalendarIdsService with retry failed: "+s),a(c,t),n||o(),[3,5];case 4:return delete g[t],[7];case 5:return[2]}}))}))}Object(i.orchestrator)(d.i,(function(e){var t;if(Object(s.h)("cal-time-panel-calendarPicker")){var n=e.settings,i=e.userIdentity;c(r.Loaded,i),(null===(t=n.timePanelCalendarIds)||void 0===t?void 0:t.length)>0&&a(n.timePanelCalendarIds,i),o()}})),Object(i.mutator)(c,(function(e){var t=e.userIdentity,n=e.loadState;f().configLoadStates.set(t,n)})),Object(i.mutator)(a,(function(e){var t=e.calendarIds,n=e.userIdentity;f().calendarIdsMap.set(n,Object(b.b)(t))}));function C(){return Object(b.d)(h())}n.d(t,"e",(function(){return u})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return j})),n.d(t,"c",(function(){return h})),n.d(t,"b",(function(){return C}))},481:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));var r="owsserver",i="owsapi"},515:function(e,t,n){"use strict";function r(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var t=e.maximumAttempts,n=e.timeBetweenRetryInMS;return function(e){var r=0,i=!1,a=function(c,u){i?u(new Error("The function retry was cancelled")):(r++,e().then((function(e){return c(e)})).catch((function(e){t&&r>=t?u(e):setTimeout((function(){return a(c,u)}),n(r))})))};return{retriableFunc:function(){return new Promise((function(e,t){return a(e,t)}))},cancel:function(){return i=!0}}}}function i(e){return function(t){return Math.pow(2,t)*e}}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}))},613:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return c}));var r=n(4),i=Object(r.action)("initializeOwaAccountsStore"),a=Object(r.action)("owaConnectedAccountAdded",(function(e,t){return{userIdentity:e,accountProviderType:t}})),c=Object(r.action)("removeAccount",(function(e){return{userIdentity:e}}))},646:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return o}));var r=n(613);n.d(t,"d",(function(){return r.b}));var i=n(108),a=new i.c((function(){return n.e(659).then(n.bind(null,923))})),c=new i.a(a,(function(e){return e.initializeOwaAccountsStore})),u=new i.b(a,(function(e){return e.initializeOwaConnectedAccount})),o=new i.a(a,(function(e){return e.removeOWAConnectedAccount}))},6512:function(e,t,n){"use strict";n.r(t);var r=n(1984),i=(n(4749),n(1930),n(4003),n(76)),a=n(114),c=n(9873),u=n(1565),o=n(1285),s=n(4),d=null;function l(){Object(o.e)("AutoOpen")}Object(s.orchestrator)(r.i,(function(e){var t=e.settings,n=e.userIdentity;if(Object(a.e)().userIdentity===n&&(d=t.isTimePanelOpen,Object(u.b)())){var r=d&&Object(o.b)()&&Object(i.h)("cal-time-panel-softPin");Object(c.a)("OwaTimePanel",{shouldAutoOpen:r,handleAutoOpen:l})}})),Object(s.orchestrator)(u.c,(function(e){if(null!==d){var t=e.isRendered&&d&&Object(o.b)()&&Object(i.h)("cal-time-panel-softPin");Object(c.a)("OwaTimePanel",{shouldAutoOpen:t,handleAutoOpen:l})}})),n.d(t,"loadWorkloadScenarioSettings",(function(){return r.a}))},9873:function(e,t,n){"use strict";var r=n(0),i=n(4),a=Object(i.action)("updateAutoOpenRegistrationInStore",(function(e,t){return{autoOpenPaneId:e,autoOpenRegistration:t}})),c=n(123),u=Object(i.action)("updateAutoOpenRegistration",(function(e,t){return{autoOpenPaneId:e,autoOpenRegistration:t}})),o=Object(i.action)("flexPaneAutoOpened",(function(e){return Object(c.c)({name:"flexPaneAutoOpened",customData:{autoOpenPaneId:e}},{autoOpenPaneId:e})})),s=["whatsNewPane","OwaTimePanel"],d=n(24),l=Object(i.createStore)("suiteHeaderAutoOpenStore",{autoOpenRegistrationMap:new d.ObservableMap});var f=n(3289),b=n(1533),O=!1;Object(i.orchestrator)(u,(function(e){var t=e.autoOpenPaneId,n=e.autoOpenRegistration;a(t,n),O||function(){var e,t,n=l().autoOpenRegistrationMap;try{for(var i=Object(r.__values)(s),a=i.next();!a.done;a=i.next()){var c=a.value;if(!n.has(c))break;var u=n.get(c),d=u.shouldAutoOpen,v=u.handleAutoOpen;if(d&&!Object(f.b)()){v?v():Object(b.c)(c),o(c),O=!0;break}}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}}()}));Object(i.mutator)(a,(function(e){l().autoOpenRegistrationMap.set(e.autoOpenPaneId,e.autoOpenRegistration)}));n.d(t,"a",(function(){return u}))}}]);
//# sourceMappingURL=owa.WorkloadScenarioSettings.js.map
self.scriptsLoaded['owa.WorkloadScenarioSettings.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.WorkloadScenarioSettings.js'] = (new Date()).getTime();