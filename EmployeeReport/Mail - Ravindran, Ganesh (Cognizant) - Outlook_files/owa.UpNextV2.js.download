self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.UpNextV2.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[602],{1007:function(e,t,n){"use strict";function r(e){var t;if(null===(t=null==e?void 0:e.ItemId)||void 0===t?void 0:t.Id){var n=e.ClientSeriesId;return!!n&&(e.IsRecurring?n==e.InstanceKey:n==e.ItemId.Id)}return!0}var a=n(0),c=n(553),i=n(428);function o(e,t){var n=Object(i.a)();e.forEach((function(e){var r=Object(i.a)();d(e,n,r,t),e.IsRecurring=!0,e.InstanceKey=e.InstanceKey&&!t?e.InstanceKey:n}))}function u(e){var t=Object(i.a)();d(e,t,t,!1)}function d(e,t,n,r){e.ItemId=Object(a.__assign)(Object(a.__assign)({},Object(c.a)({Id:n})),{mailboxInfo:e.ParentFolderId.mailboxInfo}),e.ClientSeriesId&&!r||(e.ClientSeriesId=t),e.EffectiveRights={Read:!0,Modify:!0,Delete:!0,ViewPrivateItems:!0},e.IsOrganizer=!0}n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return u}))},1017:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(295),a=n(988),c=n(76);function i(){var e;return(e={})[a.a.SmartSuggestions]={smartSuggestionsEnabled:!0,browserLocationEnabled:!1},e[a.a.DiverseEmojis]={diverseEmojisSelectedSkinTone:""},e[a.a.SurfaceActions]={readSurfaceActions:["Reply","ReplyAll","Forward"].concat(Object(r.a)()?[]:["LikeUnlike"]),readSurfaceAddins:[],composeSurfaceActions:["AddAttachment","AddInlineImage","AddEmoji","ToggleDictation","ProofingOptions","QuickUse","ToggleRibbon","FluidHeroButton"],composeSurfaceAddins:[]},e[a.a.SkypeNotifications]={skypeMessageNotification:1,skypeCallingNotification:1},e[a.a.Confetti]={confettiEnabled:!0},e[a.a.ComposeAssistance]={composeAssistanceEnabled:!0},e[a.a.GdprAdsPrefs]={feature:a.a.GdprAdsPrefs,consentString:null,allowStorageAndAccess:!1,allowPersonalization:!1,allowAdSelectionDeliveryReporting:!1,allowContentSelectionDeliveryReporting:!1,allowMeasurement:!1},e[a.a.CalendarSurfaceAddins]={calendarSurfaceAddins:[]},e[a.a.ExternalImages]={externalImagesSelectedOption:0},e[a.a.EventCapture]={autoCollectionEnabled:!1},e[a.a.Translation]={translationMode:0,targetLanguage:"",excludedLanguages:[]},e[a.a.CalendarSurfaceOptions]={agendaPaneIsClosed:!1,roamingTimeZoneTeachingMomentDisplayed:!1,bannedRoamingTimeZone:null,lastKnownRoamingTimeZone:null,roamingTimeZoneNotificationsIsDisabled:!1,allDayWellHeight:0,numDaysInDayRange:1,workLifeView:3},e[a.a.AmpDeveloper]={enabled:Object(c.h)("rp-ampDefault"),allowedSender:[]},e[a.a.CalendarHelp]={calendarHelpEnabled:!1},e[a.a.LinkedInViewProfile]={dismissed:!1},e[a.a.Bohemia]={bohemiaEnabled:Object(c.h)("cmp-prague")},e[a.a.GdprAdsV2]={feature:a.a.GdprAdsV2,consentString:null,allowStorageAndAccess:!0,allowPersonalization:!0,allowAdSelectionDeliveryReporting:!0,allowContentSelectionDeliveryReporting:!0,allowMeasurement:!0,disselectedVendorId:[],selectedVendorId:[]},e[a.a.GdprAdsV3]={feature:a.a.GdprAdsV3,encodedTCString:null,allStoreAndAccessDevice:!1,allowDevelopAndImproveProduct:!1,allowPersonalisedAds:!1,allowPersonalisedAdsSelectBasicAd:!1,allowPersonalisedAdsApplyMarketResearch:!1,allowPersonalisedAdsMeasureContentPerformance:!1,allowPersonalisedAdsSelectPersonalisedAds:!1,allowPersonalisedAdsMeasureAdPerf:!1,allowPersonalisedAdsSelectPersonalisedContent:!1,allowPersonalisedAdsCreatePersonalisedContentProfile:!1,allowPersonalisedAdsCreatePersonalisedAdsProfile:!1,allowPreciseGeoDataAndIdentifyDevice:!1,allowPreciseGeoDataAndIdentifyDeviceScanDevice:!1,allowPreciseGeoDataAndIdentifyDeviceGeoData:!1,disselectedVendorId:[],selectedVendorId:[]},e[a.a.Proofing]={feature:a.a.Proofing,spellCheckEnabled:!0,grammarEnabled:!0,writingRefinementsEnabled:!0,proofingLocale:void 0,overriddenOptions:void 0},e[a.a.ActiveProxyAddress]={feature:a.a.ActiveProxyAddress,activeProxyAddresses:[]},e[a.a.OutlookSpaces]={feature:a.a.OutlookSpaces,backgroundColor:"",gestureScheme:"pointer",toolboxCollapsed:!0},e[a.a.SxS]={feature:a.a.SxS,hideReadingPane:!1},e}},10220:function(e,t,n){var r=n(11818),a=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var c=0;c<r.length;c++)a.loadStyles(r[c][1],!1);r.locals&&(e.exports=r.locals)},1041:function(e,t,n){"use strict";var r=n(0),a=n(76),c=255,i=175,o="_____";function u(e){if(!e)return null;var t=e.indexOf(o);-1!=t&&(e=e.substring(0,t));var n=Object(a.h)("cal-mf-joinButton")?i:c;if((e=e.trim()).length<n)return e;var r=e.substr(0,n).trim();return r.length>0?r.concat("..."):null}var d=n(114),s=n(161),l=n(5),f=n(7),b=n(1428),v=n(1429),O=n(1289),p=n(1430);n.d(t,"a",(function(){return _})),n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return h}));var j=Object(b.a)(),I=[[Object(f.nc)("2019-11-03T00:00:00.000-03:00"),Object(f.nc)("2020-02-15T23:59:59.999-03:00")],[Object(f.nc)("2020-11-08T00:00:00.000-03:00"),Object(f.nc)("2021-02-20T23:59:59.999-03:00")],[Object(f.nc)("2021-11-07T00:00:00.000-03:00"),Object(f.nc)("2022-02-20T23:59:59.999-03:00")]];function _(e,t){t=t||Object(d.e)();var n=[],c=!1;if(null==e?void 0:e.ExtendedProperty){var i=e.ExtendedProperty.filter((function(e){var t;return(null===(t=e.ExtendedFieldURI)||void 0===t?void 0:t.PropertyName)===v.a.PropertyName}))[0];if(null==i?void 0:i.Value)try{n=JSON.parse(i.Value)}catch(e){n=[]}e.ExtendedProperty.some((function(e){var t;return(null===(t=e.ExtendedFieldURI)||void 0===t?void 0:t.PropertyName)===p.a.PropertyName&&!!e.Value}))&&(c=!0)}var o=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},j),e),{ItemId:e.ItemId?Object(r.__assign)(Object(r.__assign)({},e.ItemId),{mailboxInfo:t}):e.ItemId,ParentFolderId:e.ParentFolderId?Object(r.__assign)(Object(r.__assign)({},e.ParentFolderId),{mailboxInfo:t}):e.ParentFolderId,Start:m(e.Start),End:m(e.End),StartTimeZoneId:Object(s.b)(e.StartTimeZoneId),EndTimeZoneId:Object(s.b)(e.EndTimeZoneId),LastModifiedTime:m(e.LastModifiedTime),FreeBusyType:e.FreeBusyType,ResponseType:e.ResponseType,AppointmentReplyTime:m(e.AppointmentReplyTime),ExperienceType:e.ExperienceType?e.ExperienceType:"Unspecified",SeriesMasterItemId:e.SeriesMasterItemId?Object(r.__assign)(Object(r.__assign)({},e.SeriesMasterItemId),{mailboxInfo:t}):null,Sensitivity:t.type==d.a.GroupMailbox&&"Private"==e.Sensitivity?"Normal":e.Sensitivity,Preview:u(e.Preview),AppendOnSend:n,IsBookedFreeBlocks:c});if(!e.IsAllDayEvent&&e.SeriesId&&"Occurrence"==e.CalendarItemType&&"tzone://Microsoft/Custom"==e.StartTimeZoneId&&"E. South America Standard Time"==e.EndTimeZoneId&&!Object(a.h)("cal-killSwitch-63446")&&o.Start&&o.End&&I.some((function(e){var t=Object(r.__read)(e,2),n=t[0],a=t[1];return Object(f.Nb)(o.Start,n,a)}))){var l=Object(f.x)(o.End,o.Start);o.Start=Object(f.f)(o.Start,1),o.End=Object(f.h)(o.Start,l),o.StartTimeZoneId=o.EndTimeZoneId,o.__BrazilHack__=1}return o}function m(e){if(e){if(Object(a.h)("cal-assumeTzOffsetFromCalendarItem")){var t=Object(l.a)().timezone,n=!!t;return Object(f.Sb)(t,e,n)}return Object(f.qb)(e)}}function h(e){var t=[];return e.AppendOnSend&&e.AppendOnSend.length>0&&t.push(Object(O.a)({ExtendedFieldURI:v.a,Value:JSON.stringify(e.AppendOnSend)})),e.IsBookedFreeBlocks&&t.push(Object(O.a)({ExtendedFieldURI:p.a,Value:e.IsBookedFreeBlocks.toString()})),Object(r.__assign)(Object(r.__assign)({__type:"CalendarItem:#Exchange"},e),{Start:e.Start&&Object(f.rb)(e.Start),End:e.End&&Object(f.rb)(e.End),LastModifiedTime:e.LastModifiedTime&&Object(f.rb)(e.LastModifiedTime),AppointmentReplyTime:e.AppointmentReplyTime&&Object(f.rb)(e.AppointmentReplyTime),FreeBusyType:e.FreeBusyType,CharmId:e.CharmId,IsDraft:e.IsDraft,IsRoomRequested:e.IsRoomRequested,SkypeTeamsProperties:e.SkypeTeamsProperties&&JSON.stringify(e.SkypeTeamsProperties),ExtendedProperty:t})}},1055:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"d",(function(){return d})),n.d(t,"f",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return f}));var r=n(0),a=n(24),c=n(1104);function i(){return b.get()}function o(e,t){var n=u(e);return n&&n.itemResponseShapeType===t?n:null}function u(e){var t=i()[e];return t||null}function d(e,t,n){var a=Object(c.a)().fullItemsMruMap.get(e);if(a){var i=Object(r.__read)(a.eventInfos.filter((function(e){return e.eventKey===t})),1)[0];if(i&&i.itemResponseShapeType===n)return i}return null}function s(e){var t=u(e);return t?t.loadState:null}function l(e){var t,n=null===(t=u(e))||void 0===t?void 0:t.itemResponseShapeType;return n||"Default"}function f(){return"Default"}var b=Object(a.computed)((function(){var e=Object(c.a)();return Object(r.__spread)(e.fullItemsMruMap.keys()).reduce((function(t,n){return e.fullItemsMruMap.get(n).eventInfos.forEach((function(e){return t[e.eventKey]=e})),t}),{})}))},1060:function(e,t,n){"use strict";var r=/\(([^)]*)\)/gi,a=/\([^)]*\)|[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/gi,c=/\s+/gi;function i(e){var t="";if(!e)return t;var n=(e=(e=(e=(e=e.replace(r,"")).replace(a,"")).replace(c," ")).trim()).split(" ");return n.length>=2?(t+=n[0].charAt(0).toUpperCase(),t+=n[n.length-1].charAt(0).toUpperCase()):0!=n.length&&(t+=n[0].charAt(0).toUpperCase()),t}var o=n(967),u=Object.keys(o.a).length/2;function d(e){if(!e)return null;for(var t=0,n=e.length-1;n>=0;n--){var r=e.charCodeAt(n),a=n%8;t^=(r<<a)+(r>>8-a)}return t%u}function s(e){return{personaId:e,displayName:e,postalAddress:{Type:"Business",LocationSource:"None"},displayAddress:"",initials:i(e),textBoyColor:d(e),selectionSource:"ExplicitTyping",personaType:"Unknown",personaControlId:e}}var l=n(1096),f=n(147);function b(e){var t;if(e){var n=function(e){return e?null!=e.HomeAddressesArray&&e.HomeAddressesArray.length>0?e.HomeAddressesArray[0].Value:null!=e.BusinessAddressesArray&&e.BusinessAddressesArray.length>0?e.BusinessAddressesArray[0].Value:null!=e.OtherAddressesArray&&e.OtherAddressesArray.length>0?e.OtherAddressesArray[0].Value:null:null}(e),r=Object(l.c)(e.DisplayName,n);return"Room"==e.PersonaTypeString&&(n.LocationUri=e.EmailAddress.EmailAddress),{personaId:null===(t=e.PersonaId)||void 0===t?void 0:t.Id,feedbackId:e.FeedbackId,displayName:r,postalAddress:n,emailAddress:e.EmailAddress,displayAddress:Object(l.a)(n),initials:i(r),textBoyColor:d(r),selectionSource:"LocationWell",personaType:Object(f.b)(e.PersonaTypeString)?"Unknown":e.PersonaTypeString,personaControlId:null==e.PersonaId?e.FeedbackId:e.PersonaId.Id,availability:e.Availability,numberOfAvailableTimeSlots:e.NumberOfAvailableTimeSlots,totalNumberOfTimeSlots:e.TotalNumberOfTimeSlots,isPartialAvailability:e.IsPartialAvailability,capacity:e.Capacity,entityType:e.EntityType,audioDeviceName:e.AudioDeviceName,displayDeviceName:e.DisplayDeviceName,videoDeviceName:e.VideoDeviceName,isWheelChairAccessible:e.IsWheelChairAccessible}}return null}var v=n(1075);function O(e){if((null==e?void 0:e.DisplayName)&&e.PostalAddress){var t=Object(l.c)(e.DisplayName,e.PostalAddress),n=Object(v.a)(e.PostalAddress)&&!Object(f.b)(e.PostalAddress.LocationUri)?{EmailAddress:e.PostalAddress.LocationUri}:null;return{personaId:e.Id,displayName:e.DisplayName,postalAddress:e.PostalAddress,emailAddress:n,displayAddress:Object(l.a)(e.PostalAddress),initials:i(t),textBoyColor:d(t),personaType:Object(v.a)(e.PostalAddress)?"Room":"Unknown",personaControlId:e.DisplayName}}return null}var p=n(0),j=n(42),I=n(1),_=n(9),m=n(27),h=n(287),g=n(279),y=290,E=135;function w(e,t,n,r,a,c){a=a||y,c=c||E;var i=Object(m.a)();if((!Object(f.b)(n)||e&&t)&&i.PolicySettings.PlacesEnabled){var o=Object(_.c)("/OWS/beta/Location/locationmap?Latitude={0}&Longitude={1}&Address={2}&Culture={3}&Width={4}&Height={5}",e&&e.toString(),t&&t.toString(),encodeURIComponent(n),i.SessionSettings.UserCulture,a,c);Object(h.b)(o,void 0,!0).then((function(e){Object(g.a)(e.status)?e.json().then((function(e){r("data:image/png;base64,"+e.ib)})):r("")}))}else r("")}var C=n(1404),S=n(79),A=n(316),P=Object(j.a)((function(e){var t,n,r=I.useRef(),a=Object(p.__read)(I.useState(null),2),c=a[0],i=a[1];I.useEffect((function(){var t,n=!0;return(null===(t=e.locationPersona.postalAddress)||void 0===t?void 0:t.Latitude)&&e.locationPersona.postalAddress.Longitude&&!Object(f.b)(e.locationPersona.displayName)&&!c&&"pending"!=r.current&&"failed"!=r.current&&(r.current="pending",w(e.locationPersona.postalAddress.Latitude,e.locationPersona.postalAddress.Longitude,null,(function(e){n&&(i(e),e?r.current="success":(r.current="failed",S.g.warn("getLocationPhoto.downloadLocationPhoto failed")))}),64,64)),function(){return n=!1}}),[null===(t=e.locationPersona.postalAddress)||void 0===t?void 0:t.Latitude,null===(n=e.locationPersona.postalAddress)||void 0===n?void 0:n.Longitude,e.locationPersona.displayName]);var u=e.locationPersona,d=e.className,s=e.size,l=e.showPersonaDetails;if(u){var b={};return Object(f.b)(c)?A(b,{imageInitials:u.initials,initialsColor:u.textBoyColor}):A(b,{imageUrl:c,imageShouldFadeIn:!1}),I.createElement(C.a,Object(p.__assign)({className:d,presence:o.b.none,hidePersonaDetails:!l,size:s,text:u.displayName,secondaryText:u.displayAddress},b))}return null})),x="https://www.bing.com/maps?v=2&rtp=~pos.{0}_{1}_{2}_{3}&FORM=CalLoc",R="https://www.bing.com/maps?v=2&rtp=~adr.{0}_{1}&FORM=CalLoc";function T(e,t,n,r){return e&&t?Object(_.c)(x,e.toString(),t.toString(),n,r):n?Object(_.c)(R,n,r):null}var F=n(1125),N=n(108);function D(e,t){return{Id:t,DisplayName:e,PostalAddress:{LocationSource:"Resource",LocationUri:t,Type:"Business"}}}var M=n(994);function k(e){return{EmailAddress:e.PostalAddress.LocationUri,Name:e.DisplayName}}function L(e){return{Id:e,DisplayName:e,PostalAddress:{Type:"Business",LocationSource:"None"}}}function B(e,t,n,r){return e?{PostalAddress:{LocationUri:n,LocationSource:r,Type:t,Street:e.streetAddress,City:e.addressLocality,State:e.addressRegion,Country:e.addressCountry,PostalCode:e.postalCode,PostOfficeBox:e.postOfficeBoxNumber,Longitude:e.longitude,Latitude:e.latitude}}:null}function G(e){return!Object(F.a)(e.PostalAddress)&&/^((http[s]?:\/\/)|(www\.)?){1}[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,6}\b([-a-zA-Z0-9@:*%_\+.~#?&//=]*)/i.test(e.DisplayName)}function U(e){return function(){var t=/^http*/i.test(e)?e:"//"+e;window.open(t,"_blank")}}function K(e){var t=[];return e&&"string"!=typeof e&&t.push({Id:e.personaId,DisplayName:e.displayName,PostalAddress:e.postalAddress}),t}n(1265);n.d(t,"r",(function(){return V})),n.d(t,"k",(function(){return s})),n.d(t,"j",(function(){return b})),n.d(t,"i",(function(){return O})),n.d(t,"a",(function(){return P})),n.d(t,"l",(function(){return T})),n.d(t,"m",(function(){return w})),n.d(t,"o",(function(){return F.a})),n.d(t,"p",(function(){return v.a})),n.d(t,"e",(function(){return D})),n.d(t,"b",(function(){return M.a})),n.d(t,"c",(function(){return M.b})),n.d(t,"d",(function(){return M.c})),n.d(t,"n",(function(){return k})),n.d(t,"f",(function(){return L})),n.d(t,"g",(function(){return B})),n.d(t,"s",(function(){return U})),n.d(t,"q",(function(){return G})),n.d(t,"h",(function(){return K}));var q=new N.c((function(){return n.e(1181).then(n.bind(null,15363))})),V=new N.b(q,(function(e){return e.createTxpPostalAddressFromLocationPersona}))},10609:function(e,t,n){"use strict";n.r(t);var r="TimePanelUpNextCalendarCacheId",a=n(3041),c=n(4),i=n(4749);Object(c.orchestrator)(i.d,(function(){var e=Object(i.b)();Object(a.j)(e,r)}));function o(){var e=Object(i.b)();Object(a.e)(e,r)}var u=n(0),d=n(9132),s=n(42),l=n(305),f=n(1),b=n(10220),v=Object(s.a)((function(e){return f.createElement("div",{className:b.upNextEventContainer},e.eventCountString&&f.createElement("div",{className:b.conflictingEventsCount},e.eventCountString),f.createElement(l.a,{className:b.eventIconColumn,iconName:"Event"}),f.createElement("div",{className:b.eventDetailsColumn},f.createElement("div",{className:b.eventName},e.eventName),f.createElement("div",{className:b.eventTimeLocationRow},f.createElement("div",{className:b.eventTime},e.timeUntilEvent),e.eventLocation&&f.createElement("div",{className:b.eventLocation},e.eventLocation))))})),O=n(11819),p=n(9),j=n(41),I=n(7),_=n(411),m=n(555),h=59*j.g;function g(e,t){var n=Object(m.i)();if(Object(_.t)(n,e.Start,e.End))return t?Object(p.b)(d.c)+",":Object(p.b)(d.c);var r=Object(I.mc)(e.Start),a=Math.abs(Object(I.Ab)(n)-Object(I.Ab)(r));if(a<=h){var c=Math.ceil(a/j.g);return Object(p.c)(Object(p.b)(O.a),c)}var i=Object(I.Jb)(n,r),o=Object(I.ab)(r);return i?o:Object(p.c)(Object(p.b)(d.f),o)}var y=n(1122);var E=n(1684),w=n(254),C=n(2099),S=n(1285),A=n(556),P=n(2427),x=n(10220),R="UpNext";function T(e,t,n,r,a,c){e.push(f.createElement(v,{key:t,eventCountString:a,eventLocation:r,eventName:n,timeUntilEvent:c}))}var F=Object(s.a)((function(e){var t,n,r=e.upNextEvent,a=r.ItemId,c=e.conflictingEvents.length+1,i=c>1,o=Object(u.__spread)([r],e.conflictingEvents),s=!i&&a,l=f.useCallback((function(){Object(S.b)()?function(e){Object(w.o)("TnS_UpNextClicked"),e?C.f.importAndExecute(R,e):C.h.importAndExecute(R)}(s):function(e){e?Object(P.a)(e,"Mail_UpNext",null,6):window.open(Object(A.e)())}(s)}),[s]),b=f.useCallback((function(){var e=o.length;n=setTimeout((function(){n&&Object(w.o)("TnS_UpNextHover",[e]),n=null}),300)}),[s]),v=f.useCallback((function(){n=null}),[s]);f.useEffect((function(){Object(w.o)("TnS_UpNext",[o.length],{sessionSampleRate:10})}),[s]);for(var O=[],j=c>3,I=j?2:o.length,_=0;_<I;_++){var m=o[_],h=null===(t=m.Location)||void 0===t?void 0:t.DisplayName,F=i&&Object(p.c)(Object(p.b)(d.a),_+1,c),N=g(m,!!h);T(O,m.ItemId.Id,Object(y.c)(m),h,F,N)}if(j){var D=c-I;T(O,"viewAll",Object(p.b)(d.g),null,Object(p.c)(Object(p.b)(d.d),D),g(r,!1))}var M=x.allEventsContainer;2==c?M=x.allEventsContainerTwoEvents:c>2&&(M=x.allEventsContainerThreeOrMoreEvents);var k=i?void 0:Object(y.e)(r),L=i?function(e,t,n){var r=[];r.push(Object(p.c)(Object(p.b)(d.b),t));for(var a=0;a<e.length;a++){var c=e[a];r.push(Object(p.c)(Object(p.b)(d.e),a+1,t)),r.push(Object(y.a)(c))}return n&&r.push(Object(p.b)(d.g)),r.join(" ")}(o.slice(0,I),o.length,j):Object(y.a)(r);return f.createElement(E.a,{ariaLabel:L,className:x.upNextEventButtonContainer,"data-is-focusable":!0,"data-automation-id":"UpNext",onClick:l,role:"menuitem",title:k,styles:e.containerStyle},f.createElement("div",{className:M,onMouseEnter:b,onMouseLeave:v},O))})),N=n(1488);var D=Object(s.a)((function(e){var t="DoesNotExist"!==Object(N.d)(r)?Object(a.c)(r):null;if(!t||!t.upNextEvent)return null;var n=t.conflictingEvents;return f.createElement(F,{upNextEvent:t.upNextEvent,conflictingEvents:n,containerStyle:e.containerStyle})}));function M(){return!!Object(a.b)(r)}n.d(t,"initializeUpNextV2",(function(){return o})),n.d(t,"UpNextV2",(function(){return D})),n.d(t,"isUpNextEventReady",(function(){return M}))},1073:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return i}));var r=n(76),a=n(954);function c(e,t){var n;return void 0===t&&(t=!1),Object(r.h)("cal-cache-update")?t&&!Object(a.I)(e.CalendarItemType)?i(e):null===(n=null==e?void 0:e.ItemId)||void 0===n?void 0:n.Id:t||Object(a.I)(e.CalendarItemType)?e.InstanceKey:e.ItemId.Id}function i(e){var t;return null===(t=e.SeriesMasterItemId)||void 0===t?void 0:t.Id}},1075:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1125);function a(e){return Object(r.a)(e)&&"Resource"===e.LocationSource}},1096:function(e,t,n){"use strict";var r=n(27),a=n(147),c="en-us",i={"am-et":"a_c_pc_pr_ctry","ar-dz":"a_pc_c_pr_ctry","ar-bh":"a_pc_c_pr_ctry","ar-eg":"a_ctry_c_pr_pc","ar-iq":"a_pc_c_pr_ctry","ar-jo":"a_c_pc_pr_ctry","ar-kw":"a_pc_c_pr_ctry","ar-lb":"a_c_pc_pr_ctry","ar-ly":"a_pc_c_pr_ctry","ar-ma":"a_pc_c_pr_ctry","ar-om":"a_c_pr_ctry_pc","ar-qa":"a_pc_c_pr_ctry","ar-sa":"a_c_pc_pr_ctry","ar-sy":"a_pc_c_pr_ctry","ar-tn":"a_pc_c_pr_ctry","ar-ae":"a_pc_c_pr_ctry","ar-ye":"a_pc_c_pr_ctry","eu-es":"a_pc_c_pr_ctry","bn-in":"a_c_pc_pr_ctry","bg-bg":"a_pc_c_pr_ctry","ca-es":"a_pc_c_pr_ctry","zh-cn":"pc_ctry_pr_c_a","zh-sg":"a_c_pc_pr_ctry","zh-hk":"ctry_pc_pr_c_a","zh-mo":"ctry_pr_c_pc_a","zh-tw":"pc_ctry_pr_c_a","hr-hr":"a_pc_c_pr_ctry","cs-cz":"a_pc_c_pr_ctry","da-dk":"a_pc_c_pr_ctry","nl-be":"a_pc_c_pr_ctry","nl-nl":"a_pc_c_pr_ctry","en-au":"a_c_pc_pr_ctry","en-bz":"a_pc_c_pr_ctry","en-ca":"a_c_pc_pr_ctry","en-ie":"a_c_pc_pr_ctry","en-jm":"a_pc_c_pr_ctry","en-nz":"a_c_pc_pr_ctry","en-ph":"a_pc_pr_c_ctry","en-za":"a_c_pc_pr_ctry","en-tt":"a_pc_c_pr_ctry","en-gb":"a_c_pc_pr_ctry","en-us":"a_c_pr_pc_ctry","en-zw":"a_pc_c_pr_ctry","et-ee":"a_pc_c_pr_ctry","fil-ph":"a_pc_pr_c_ctry","fi-fi":"a_pc_c_pr_ctry","fr-be":"a_pc_c_pr_ctry","fr-ca":"a_c_pc_pr_ctry","fr-fr":"a_pc_c_pr_ctry","fr-lu":"a_pc_c_pr_ctry","fr-mc":"a_pc_c_pr_ctry","fr-ch":"a_pc_c_pr_ctry","gl-es":"a_pc_c_pr_ctry","de-at":"a_pc_c_pr_ctry","de-de":"a_pc_c_pr_ctry","de-li":"a_pc_c_pr_ctry","de-lu":"a_pc_c_pr_ctry","de-ch":"a_pc_c_pr_ctry","el-gr":"a_pc_c_pr_ctry","gu-in":"a_c_pc_pr_ctry","he-il":"a_pc_c_pr_ctry","hi-in":"a_c_pc_pr_ctry","hu-hu":"c_a_pc_pr_ctry","is-is":"a_pc_c_pr_ctry","id-id":"a_c_pc_pr_ctry","it-it":"a_pc_c_pr_ctry","it-ch":"a_pc_c_pr_ctry","ja-jp":"pc_pr_c_a_ctry","kn-in":"a_c_pc_pr_ctry","kk-kz":"ctry_pr_c_pc_a","sw-ke":"a_c_pc_pr_ctry","ko-kr":"pc_pr_c_a_ctry","lv-lv":"a_c_pc_pr_ctry","lt-lt":"a_c_pc_pr_ctry","ms-bn":"a_c_pc_pr_ctry","ms-my":"a_pc_c_pr_ctry","ml-in":"a_c_pc_pr_ctry","mr-in":"a_c_pc_pr_ctry","nb-no":"a_pc_c_pr_ctry","or-in":"a_c_pc_pr_ctry","fa-ir":"a_c_pc_pr_ctry","pl-pl":"a_pc_c_pr_ctry","pt-br":"a_pc_c_pr_ctry","pt-pt":"a_pc_c_pr_ctry","ro-ro":"a_pc_c_pr_ctry","ru-ru":"ctry_pc_pr_c_a","sr-cyrl-cs":"a_pc_c_pr_ctry","sk-sk":"a_pc_c_pr_ctry","sl-si":"a_pc_c_pr_ctry","es-ar":"a_pc_c_pr_ctry","es-bo":"a_pc_c_pr_ctry","es-cl":"a_pc_c_pr_ctry","es-co":"a_pc_c_pr_ctry","es-cr":"a_pc_c_pr_ctry","es-do":"a_pc_c_pr_ctry","es-ec":"a_pc_c_pr_ctry","es-sv":"a_c_pc_pr_ctry","es-gt":"a_pc_c_pr_ctry","es-hn":"a_pc_c_pr_ctry","es-mx":"a_pc_c_pr_ctry","es-ni":"a_c_pc_pr_ctry","es-pa":"a_pc_c_pr_ctry","es-py":"a_pc_c_pr_ctry","es-pe":"a_pc_c_pr_ctry","es-pr":"a_c_pc_pr_ctry","es-es":"a_pc_c_pr_ctry","es-us":"a_c_pc_pr_ctry","es-uy":"a_pc_c_pr_ctry","es-ve":"a_pc_c_pr_ctry","sv-fi":"a_pc_c_pr_ctry","sv-se":"a_pc_c_pr_ctry","ta-in":"a_c_pc_pr_ctry","te-in":"a_c_pc_pr_ctry","th-th":"a_c_pc_pr_ctry","tr-tr":"a_pc_pr_c_ctry","uk-ua":"ctry_pc_pr_c_a","ur-pk":"a_c_pc_pr_ctry","cy-gb":"a_c_pc_pr_ctry"};var o=", ";function u(e,t,n,r,c,i){var o=[];Object(a.b)(e)||(o[o.length]=e);var u="";return Object(a.b)(t)||(u=t),Object(a.b)(n)||(u=Object(a.b)(u)?n:u+i+n),Object(a.b)(r)||(u=Object(a.b)(u)?r:u+i+r),Object(a.b)(u)||(o[o.length]=u),Object(a.b)(c)||(o[o.length]=c),o}function d(e,t,n,d,s){var l=function(){var e=Object(r.a)(),t="";(null==e?void 0:e.SessionSettings)&&!Object(a.b)(e.SessionSettings.UserCulture)&&(t=e.SessionSettings.UserCulture.toLowerCase());var n=i[t];return null==n&&(n=i[c]),n}(),f=[],b=o;switch(l){case"a_c_pc_pr_ctry":f=u(e,t,n,d,s,b);break;case"a_c_pr_ctry_pc":f=u(e,t,d,s,n,b);break;case"a_c_pr_pc_ctry":f=u(e,t,d,n,s,b);break;case"a_ctry_c_pr_pc":f=u(e,s,t,d,n,b);break;case"a_pc_c_pr_ctry":f=u(e,n,t,d,s,b);break;case"a_pc_pr_c_ctry":f=u(e,n,d,t,s,b);break;case"c_a_pc_pr_ctry":f=u(t,e,n,d,s,b);break;case"ctry_pc_pr_c_a":f=u(s,n,d,t,e,b);break;case"ctry_pr_c_pc_a":f=u(s,d,t,n,e,b);break;case"pc_ctry_pr_c_a":f=u(n,s,d,t,e,b);break;case"pc_pr_c_a_ctry":f=u(n,d,t,e,s,b)}return f.join(b)}function s(e){return e?d(e.Street,e.City,e.PostalCode,e.State,e.Country):""}function l(e,t){return Object(a.b)(e)?s(t):e}var f=n(9);function b(e,t,n){var r=s(t);return Object(a.b)(e)?r:""==r||n?e:Object(f.c)("{0} ({1})",e,r)}n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return b}))},1102:function(e,t,n){"use strict";var r=n(411),a=n(7);function c(e){return i({start:e.Start,end:e.End})}function i(e){var t=Object(a.Xb)(e.end),n={start:e.start,end:e.end},r=Object(a.Ib)(e.end,t),c=Object(a.Ib)(e.start,t);return r&&!c&&(n.end=Object(a.ec)(n.end,1)),n}function o(e){return function(t){var n=c(t);return 0===Object(r.j)(e,n,!0)}}var u=n(41);function d(e){var t=c(e),n=Object(a.w)(Object(a.Xb)(t.end),Object(a.Xb)(t.start));return Math.ceil(n/u.e)}var s=n(117);function l(e){return e.IsAllDayEvent||Object(a.w)(e.End,e.Start)>=s.a.MillisecondsInOneDay}function f(e){return Object(a.Gb)(e.Start,e.End)?b(e):d(e)>=1}function b(e){return Math.abs(Object(a.s)(e.Start,e.End))>1}n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"g",(function(){return f})),n.d(t,"f",(function(){return b}))},1122:function(e,t,n){"use strict";var r=n(411),a=n(9),c=n(2173),i=n(7),o=n(1102),u=n(2174),d=n(1096);function s(e,t){var n=[];return e.IsDraft&&n.push(Object(a.b)(u.a)),e.Subject?n.push(e.Subject):t||n.push(Object(a.b)(u.b)),n.join(" ")}function l(e){return e.Location?Object(d.d)(e.Location.DisplayName,e.Location.PostalAddress):""}function f(e,t){var n=[];n.push(function(e,t){var n=s(e),u=Object(o.e)(e),d=O(e.Start,e.End,t,e.IsAllDayEvent,u,!0),l=Object(a.b)(c.b);e.IsAllDayEvent&&u&&Object(i.w)(e.End,e.Start)==r.a.MillisecondsInOneDay?l=Object(a.b)(c.g):e.IsAllDayEvent&&u&&(l=Object(a.b)(c.a));return Object(a.c)(l,d,n)}(e,t));var u=l(e);return u&&n.push(Object(a.c)(Object(a.b)(c.c),u)),e.Organizer&&e.IsMeeting&&n.push(Object(a.c)(Object(a.b)(c.d),e.Organizer.Mailbox.Name)),"Occurrence"===e.CalendarItemType&&n.push(Object(a.b)(c.f)),"Private"===e.Sensitivity&&n.push(Object(a.b)(c.e)),n.join(" ")}function b(e,t){var n=[],r=s(e);r&&n.push(r);var a=l(e);a&&n.push(a);var c=Object(o.e)(e),i=O(e.Start,e.End,t,e.IsAllDayEvent,c,!1);return n.push(i),n.join("\n")}function v(e,t){var n=l(e),r=b(e);return n?r+" "+n:r}function O(e,t,n,u,d,s){if(n&&(e=Object(i.Rb)(n,e),t=Object(i.Rb)(n,t)),Object(i.Jb)(e,t))return Object(a.c)(Object(a.b)(c.j),s?Object(i.gb)(e):"",Object(i.ab)(e),Object(i.ab)(t)).replace("  "," ");if(u&&d){if(Object(i.w)(t,e)==r.a.MillisecondsInOneDay)return Object(i.gb)(e);var l=Object(i.gb)(Object(o.a)({start:e,end:t}).end);return Object(a.c)(Object(a.b)(c.h),Object(i.gb)(e),l)}return Object(a.c)(Object(a.b)(c.i),Object(i.gb)(e),Object(i.ab)(e),Object(i.gb)(t),Object(i.ab)(t))}n.d(t,"a",(function(){return f})),n.d(t,"d",(function(){return b})),n.d(t,"e",(function(){return v})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return s}))},1125:function(e,t,n){"use strict";function r(e){return!!e&&(!!e.LocationUri||!(!e.Latitude||!e.Longitude))}n.d(t,"a",(function(){return r}))},1159:function(e,t,n){"use strict";n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return f}));var r="A-Za-zªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠ-ࢴऀ-५ॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛱ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎↃↄⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〆〱-〵〻〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿕ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛥꜗ-ꜟꜢ-ꞈꞋ-ꞭꞰ-ꞷꟷ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭥꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ0-9٠-٩۰-۹߀-߉०-९০-৯੦-੯૦-૯୦-୯௦-௯౦-౯೦-೯൦-൯෦-෯๐-๙໐-໙༠-༩၀-၉႐-႙០-៩᠐-᠙᥆-᥏᧐-᧙᪀-᪉᪐-᪙᭐-᭙᮰-᮹᱀-᱉᱐-᱙꘠-꘩꣐-꣙꤀-꤉꧐-꧙꧰-꧹꩐-꩙꯰-꯹０-９",a=new RegExp("^(["+r+"!#$%&'*+/=?^_`{|}~-](?:["+r+".!#$%&'*+/=?^_`{|}~-]*["+r+"!#$%&'*+/=?^_`{|}~-])?)(?=@)"),c=new RegExp('^("['+r+'.!#$%&\'*+\\/=?^_`{|}~\\-(),:;<>@[\\\\\\]" ]*")(?=@)'),i=new RegExp("^["+r+"-]+(?:\\.["+r+"-]+)*$"),o=/[^\\]"/,u=/^[A-Za-z0-9_-]+:.*$/,d=function(e){var t=e.match(a);if(t)return-1!==t[0].indexOf("..")?null:t[0];var n=e.match(c);if(n){var r=o.exec(n[0]);return r&&r.index!==n[0].length-2?null:n[0]}return null};function s(e){if(!e)return!1;var t=d(e);return!!t&&!!e.substring(t.length+1).match(i)}function l(e){return u.test(e)}function f(e){return s(e)||l(e)}},1160:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(411);function a(e,t){var n=[],a=[];return e.forEach((function(e){var c={start:e.Start,end:e.End};t.some((function(e){return 0===Object(r.j)(e,c,!0)}))?n.push(e):a.push(e)})),{eventsOverlapping:n,eventsNotOverlapping:a}}},117:function(e,t,n){"use strict";var r=n(145),a={MillisecondsInOneDay:864e5,MillisecondsIn1Sec:1e3,MillisecondsIn1Min:6e4,MillisecondsIn30Mins:18e5,MillisecondsIn1Hour:36e5,MinutesInOneDay:1440,MinutesInOneHour:60,SecondsInOneMinute:60,DaysInOneWeek:7,AllDaysOfWeek:[r.b.Sunday,r.b.Monday,r.b.Tuesday,r.b.Wednesday,r.b.Thursday,r.b.Friday,r.b.Saturday]};t.a=a},11818:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,'@-webkit-keyframes _3GYWRGGf7P_GI0nsmyJJEq{0%{-webkit-transform:translateY(0);transform:translateY(0)}33.33%,66.66%{-webkit-transform:translateY(-34px);transform:translateY(-34px)}to{-webkit-transform:translateY(-68px);transform:translateY(-68px)}}@-webkit-keyframes _2qguJkZ4YN-a4-jZornQTp{0%{-webkit-transform:translateY(0);transform:translateY(0)}33.33%,66.66%{-webkit-transform:translateY(-34px);transform:translateY(-34px)}to{-webkit-transform:translateY(-68px);transform:translateY(-68px)}}@keyframes _3GYWRGGf7P_GI0nsmyJJEq{0%{-webkit-transform:translateY(0);transform:translateY(0)}33.33%,66.66%{-webkit-transform:translateY(-34px);transform:translateY(-34px)}to{-webkit-transform:translateY(-68px);transform:translateY(-68px)}}@keyframes _2qguJkZ4YN-a4-jZornQTp{0%{-webkit-transform:translateY(0);transform:translateY(0)}33.33%,66.66%{-webkit-transform:translateY(-34px);transform:translateY(-34px)}to{-webkit-transform:translateY(-68px);transform:translateY(-68px)}}@-webkit-keyframes _1uBAfIo7O7RpspBEYft67J{to{-webkit-transform:translateY(0);transform:translateY(0)}}@-webkit-keyframes gqklPe3BnRAQGJ-1Nd_Xp{to{-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes _1uBAfIo7O7RpspBEYft67J{to{-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes gqklPe3BnRAQGJ-1Nd_Xp{to{-webkit-transform:translateY(0);transform:translateY(0)}}.bquTIlYhtqsZHlrJCQ0ci{font-size:12px;font-weight:400;color:"[theme:themeDark, default:#0D62AA]";cursor:pointer;height:34px;overflow:hidden}html[dir] .bquTIlYhtqsZHlrJCQ0ci{padding:0 8px}._1KWaEy1JwXTPcXePft1XyO,._1Lt2W5uQ7oe52kMFzniHCz,.HpJj1IBE9g7fhlrQQuBva{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column nowrap;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;overflow:hidden;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-ms-flex-item-align:start;align-self:flex-start;height:34px}.HpJj1IBE9g7fhlrQQuBva{height:68px}html[dir] .HpJj1IBE9g7fhlrQQuBva{-webkit-transform:translateY(0);transform:translateY(0);-webkit-transition:-webkit-transform .3s cubic-bezier(.8,0,.2,1);transition:-webkit-transform .3s cubic-bezier(.8,0,.2,1);transition:transform .3s cubic-bezier(.8,0,.2,1);transition:transform .3s cubic-bezier(.8,0,.2,1),-webkit-transform .3s cubic-bezier(.8,0,.2,1)}._1Lt2W5uQ7oe52kMFzniHCz{height:102px;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards;-webkit-animation-play-state:running;animation-play-state:running;-webkit-animation-timing-function:cubic-bezier(.8,0,.2,1);animation-timing-function:cubic-bezier(.8,0,.2,1)}html[dir=ltr] ._1Lt2W5uQ7oe52kMFzniHCz{-webkit-animation-name:gqklPe3BnRAQGJ-1Nd_Xp;animation-name:gqklPe3BnRAQGJ-1Nd_Xp}html[dir=rtl] ._1Lt2W5uQ7oe52kMFzniHCz{-webkit-animation-name:_1uBAfIo7O7RpspBEYft67J;animation-name:_1uBAfIo7O7RpspBEYft67J}html[dir] .bquTIlYhtqsZHlrJCQ0ci:hover .HpJj1IBE9g7fhlrQQuBva{-webkit-transform:translateY(-34px);transform:translateY(-34px);-webkit-transition-delay:.1s;transition-delay:.1s}.bquTIlYhtqsZHlrJCQ0ci:hover ._1Lt2W5uQ7oe52kMFzniHCz{-webkit-animation-duration:3.6s;animation-duration:3.6s}html[dir=ltr] .bquTIlYhtqsZHlrJCQ0ci:hover ._1Lt2W5uQ7oe52kMFzniHCz{-webkit-animation-name:_2qguJkZ4YN-a4-jZornQTp;animation-name:_2qguJkZ4YN-a4-jZornQTp}html[dir=rtl] .bquTIlYhtqsZHlrJCQ0ci:hover ._1Lt2W5uQ7oe52kMFzniHCz{-webkit-animation-name:_3GYWRGGf7P_GI0nsmyJJEq;animation-name:_3GYWRGGf7P_GI0nsmyJJEq}._1hagGpG7AzPUNXP0Svq92n{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;overflow:hidden;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto;-ms-flex-item-align:end;align-self:flex-end;height:34px}.Zxu7pq6NX4jIi550qVOsj{font-size:14px;font-weight:400;-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto;line-height:34px}html[dir=ltr] .Zxu7pq6NX4jIi550qVOsj{padding-right:6px}html[dir=rtl] .Zxu7pq6NX4jIi550qVOsj{padding-left:6px}._3PRzKbmV4xQJvn21aAkCeP{font-size:16px;-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto}html[dir=ltr] ._3PRzKbmV4xQJvn21aAkCeP{padding-right:8px}html[dir=rtl] ._3PRzKbmV4xQJvn21aAkCeP{padding-left:8px}._3wJAY7Lg8iqglCkKc_1xfx,._2KWQkcW6CcNYP-7HUovRXb,._5h5kaMsfWHnnSvF2gbHpv,._3xLd9sljnn8QP_g_E9drtK{overflow:hidden;word-break:break-all}html[dir] ._3wJAY7Lg8iqglCkKc_1xfx,html[dir] ._2KWQkcW6CcNYP-7HUovRXb,html[dir] ._5h5kaMsfWHnnSvF2gbHpv,html[dir] ._3xLd9sljnn8QP_g_E9drtK{text-align:start}.HI72OmTBCYbpLJFgasLYQ{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column nowrap;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;overflow:hidden;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-ms-flex-item-align:start;align-self:flex-start}._5h5kaMsfWHnnSvF2gbHpv{font-weight:600;height:16px}._5h5kaMsfWHnnSvF2gbHpv,._1cph5Ohu1BNS65JDq4b3tl{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;max-width:162px}._1cph5Ohu1BNS65JDq4b3tl{display:-webkit-box;display:-ms-flexbox;display:flex}._3xLd9sljnn8QP_g_E9drtK{-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto;max-width:162px}html[dir=ltr] ._3xLd9sljnn8QP_g_E9drtK{margin-right:4px}html[dir=rtl] ._3xLd9sljnn8QP_g_E9drtK{margin-left:4px}._2KWQkcW6CcNYP-7HUovRXb{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}',""]),t.locals={upNextEventButtonContainer:"bquTIlYhtqsZHlrJCQ0ci",allEventsContainer:"_1KWaEy1JwXTPcXePft1XyO",allEventsContainerThreeOrMoreEvents:"_1Lt2W5uQ7oe52kMFzniHCz",allEventsContainerTwoEvents:"HpJj1IBE9g7fhlrQQuBva",reverseMotion:"gqklPe3BnRAQGJ-1Nd_Xp","reverseMotion-rtl":"_1uBAfIo7O7RpspBEYft67J",motionForThreeOrMore:"_2qguJkZ4YN-a4-jZornQTp","motionForThreeOrMore-rtl":"_3GYWRGGf7P_GI0nsmyJJEq",upNextEventContainer:"_1hagGpG7AzPUNXP0Svq92n",conflictingEventsCount:"Zxu7pq6NX4jIi550qVOsj",eventIconColumn:"_3PRzKbmV4xQJvn21aAkCeP",eventEntities:"_3wJAY7Lg8iqglCkKc_1xfx",eventLocation:"_2KWQkcW6CcNYP-7HUovRXb",eventName:"_5h5kaMsfWHnnSvF2gbHpv",eventTime:"_3xLd9sljnn8QP_g_E9drtK",eventDetailsColumn:"HI72OmTBCYbpLJFgasLYQ",eventTimeLocationRow:"_1cph5Ohu1BNS65JDq4b3tl"}},11819:function(e){e.exports=JSON.parse('{"a":"Acd"}')},1189:function(e,t,n){"use strict";n.d(t,"z",(function(){return r})),n.d(t,"p",(function(){return a})),n.d(t,"B",(function(){return c})),n.d(t,"C",(function(){return i})),n.d(t,"A",(function(){return o})),n.d(t,"m",(function(){return u})),n.d(t,"y",(function(){return d})),n.d(t,"g",(function(){return s})),n.d(t,"q",(function(){return l})),n.d(t,"s",(function(){return f})),n.d(t,"e",(function(){return b})),n.d(t,"D",(function(){return v})),n.d(t,"u",(function(){return O})),n.d(t,"a",(function(){return p})),n.d(t,"w",(function(){return j})),n.d(t,"c",(function(){return I})),n.d(t,"h",(function(){return _})),n.d(t,"f",(function(){return m})),n.d(t,"E",(function(){return h})),n.d(t,"v",(function(){return g})),n.d(t,"b",(function(){return y})),n.d(t,"x",(function(){return E})),n.d(t,"d",(function(){return w})),n.d(t,"r",(function(){return C})),n.d(t,"t",(function(){return S})),n.d(t,"l",(function(){return A})),n.d(t,"i",(function(){return P})),n.d(t,"j",(function(){return x})),n.d(t,"k",(function(){return R})),n.d(t,"o",(function(){return T})),n.d(t,"n",(function(){return F}));var r="Sunday",a="Monday",c="Tuesday",i="Wednesday",o="Thursday",u="Friday",d="Saturday",s=[r,a,c,i,o,u,d],l=["January","February","March","April","May","June","July","August","September","October","November","December"],f="None",b="DailyRecurrence",v="WeeklyRecurrence",O="RelativeMonthlyRecurrence",p="AbsoluteMonthlyRecurrence",j="RelativeYearlyRecurrence",I="AbsoluteYearlyRecurrence",_=["None","First","Second","Third","Fourth","Last"],m="DailyRecurrence:#Exchange",h="WeeklyRecurrence:#Exchange",g="RelativeMonthlyRecurrence:#Exchange",y="AbsoluteMonthlyRecurrence:#Exchange",E="RelativeYearlyRecurrence:#Exchange",w="AbsoluteYearlyRecurrence:#Exchange",C="NoEndRecurrence:#Exchange",S="NumberedRecurrence:#Exchange",A="EndDateRecurrence:#Exchange",P=3,x=25,R=1,T=1,F=99},1195:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return d})),n.d(t,"h",(function(){return s})),n.d(t,"i",(function(){return l}));var r=2,a=4,c=8,i=32,o=64,u=128,d=4294967296,s=8589934592,l=17179869184},1200:function(e,t,n){"use strict";n.d(t,"e",(function(){return"{id}"})),n.d(t,"f",(function(){return"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAEALAAAAAABAAEAAAIBTAA7"})),n.d(t,"a",(function(){return"data-custom"})),n.d(t,"c",(function(){return"originalsrc"})),n.d(t,"b",(function(){return"data-loadstatus"})),n.d(t,"d",(function(){return"pending"}))},1206:function(e,t,n){"use strict";function r(e,t){return!e.some((function(e){return e&&t&&e.calculatedFolderId===t.calculatedFolderId}))}function a(e,t){return e.indexOf(t)<0}function c(e,t){if(void 0===t&&(t=a),!e)return[];var n=[];return e&&e.forEach((function(e){t(n,e)&&n.push(e)})),n}var i=n(24);function o(e,t){if(void 0===t&&(t=a),!e)return e;var n=new i.ObservableMap;return e.forEach((function(e,r){n.set(r,c(e,t))})),n}function u(e,t){if(void 0===t&&(t=a),!e)return[];var n=[];return e.forEach((function(e){e&&e.forEach((function(e){t(n,e)&&n.push(e)}))})),n}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return u}))},1222:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"i",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"h",(function(){return f}));var r=n(1189);function a(e){return e?l(e)?r.e:f(e)?r.D:d(e)?r.u:o(e)?r.a:s(e)?r.w:u(e)?r.c:r.s:r.s}function c(e){return o(e)||d(e)}function i(e){return u(e)||s(e)}function o(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==r.b}function u(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==r.d}function d(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==r.v}function s(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==r.x}function l(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==r.f}function f(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==r.E}},1232:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(4),a=n(1017),c=Object(r.action)("APPLY_DEFAULT_OPTIONS_ON_LOAD_FAIL",(function(e){return void 0===e&&(e=Object(a.a)()),{defaultOptions:e}}))},1265:function(e,t,n){"use strict";function r(e){var t=[];return e&&e.forEach((function(e){t.push({Id:e.personaId,DisplayName:e.displayName,PostalAddress:e.postalAddress})})),t}n.d(t,"a",(function(){return r}))},1284:function(e,t,n){"use strict";var r=n(553),a=n(594),c=n(0),i=n(315),o=n(76),u=n(1041),d=n(1771),s=n(1795),l=n(246),f=n(585),b=n(994),v=n(1060);function O(e,t,n,r,a){return void 0===a&&(a=void 0),Object(c.__awaiter)(this,void 0,void 0,(function(){var O,p,j,I,_,m,h,g,y;return Object(c.__generator)(this,(function(c){switch(c.label){case 0:return O=e.Id,p=e.mailboxInfo,I=null,_=null,[4,Object(i.e)(p)];case 1:(m=c.sent()||{}).datapoint={customData:{itemId:O,fetchingMasterItem:n},jsonCustomData:function(e){var t=e.Body.ResponseMessages.Items[0];return{responseClass:t.ResponseClass,responseCode:t.ResponseCode}}},c.label=2;case 2:return c.trys.push([2,4,5,6]),[4,Object(s.a)({Header:Object(l.a)(),Body:Object(d.a)({EventIds:r,ItemShape:t,IncludeDeclinedMeetings:Object(o.h)("cal-surface-declinedMeetings")})},m)];case 3:return I=c.sent(),"Success"==(j=I.Body.ResponseMessages.Items[0]).ResponseClass?null!=j?null!=(h=j.Items[0])&&(!function(e){e.Locations?e.Locations=e.Locations.filter((function(e){return e})):e.Locations=[],e.Resources&&e.Resources.map((function(t){Object(b.c)(e.Locations,t.Mailbox.EmailAddress)||(e.Locations=e.Locations.filter((function(e){return e.DisplayName!==t.Mailbox.Name||Object(v.o)(e.PostalAddress)})),e.Locations.push(Object(v.e)(t.Mailbox.Name,t.Mailbox.EmailAddress)))}))}(h),a&&(h.ParentFolderId.Id=a),_={calendarEvent:Object(u.a)(h,e.mailboxInfo),error:null,responseCode:j.ResponseCode}):_={calendarEvent:null,error:"[getCalendarEventService] null response.",responseCode:j.ResponseCode}:(g="[getCalendarEventService] request failed. Message: "+j.MessageText+", ResponseCode: "+j.ResponseCode+", ResponseClass: "+j.ResponseClass,_={calendarEvent:null,error:g,responseCode:j.ResponseCode}),[3,6];case 4:return y=c.sent(),_={calendarEvent:null,error:y.message},[3,6];case 5:return Object(o.h)("cal-mf-diagnostics")&&Object(f.a)({action:"GetCalendarEvent",status:(null==j?void 0:j.ResponseClass)||"Error",response:null==I?void 0:I.Body}),[7];case 6:return[2,_]}}))}))}var p=n(25);function j(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(c.__assign)({__type:"GetBirthdayEventJsonRequest:#Exchange"},n)),Object(p.a)("GetBirthdayEvent",e,t)}var I=n(1492);function _(e,t){return Object(c.__awaiter)(this,void 0,void 0,(function(){var n,a,o,u,d;return Object(c.__generator)(this,(function(s){switch(s.label){case 0:return n=e.Id,a=e.mailboxInfo,[4,Object(i.e)(a)];case 1:return(o=s.sent()||{}).datapoint={customData:{itemId:n},jsonCustomData:function(e){var t,n;return{responseClass:null===(t=null==e?void 0:e.Body)||void 0===t?void 0:t.ResponseClass,responseCode:null===(n=null==e?void 0:e.Body)||void 0===n?void 0:n.ResponseCode}}},[4,j({Header:Object(l.a)(),Body:(f={CalendarItemId:Object(r.a)({Id:n})},Object(c.__assign)({__type:"GetBirthdayEventRequest:#Exchange"},f))},o)];case 2:return null!=(u=s.sent()).Body&&"Success"==u.Body.ResponseClass&&null!=(d=u.Body.BirthdayEvent)?[2,{calendarEvent:Object(I.a)(d,t,void 0,e.mailboxInfo),error:null}]:[2,{calendarEvent:null,error:"[getBirthdayEventService] request failed"}]}var f}))}))}var m=n(160);function h(e,t,n,c,i){void 0===c&&(c=0),void 0===i&&(i=void 0);var o=Object(m.o)(t);if(o&&3==o.CalendarFolderType)return _(e,t);var u=3==c||2==c;return O(e,n,u,[u?i?Object(r.a)({Id:i.Id}):Object(a.a)({OccurrenceId:e.Id}):Object(r.a)({Id:e.Id})],Object(m.L)(o)?t:void 0)}function g(e,t,n,c){void 0===c&&(c=!1);var i=Object(m.o)(t);return i&&3==i.CalendarFolderType?_(e,t):O(e,n,c,[c?Object(a.a)({OccurrenceId:e.Id}):Object(r.a)({Id:e.Id})],Object(m.L)(i)?t:void 0)}n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return g}))},1287:function(e,t,n){"use strict";var r=n(41),a=n(1490),c=n(1316),i=n(7),o=n(160);function u(e){var t=Object(o.w)();return e.ParentFolderId&&t&&e.ParentFolderId.Id===t.calculatedFolderId}function d(e){if(!e.ParentFolderId)return!1;var t=Object(o.l)(Object(o.w)()).ParentGroupId,n=Object(o.o)(e.ParentFolderId.Id);return n&&n.ParentGroupId===t}function s(e,t){var n=Object(c.a)(e);if(n!=Object(c.a)(t))return n?-1:1;var r=f(t)-f(e);if(0!=r)return r;if(0!=(r=Object(i.w)(e.Start,t.Start)))return r;if(b(e)&&b(t)){var o=u(e);if(o!=u(t))return o?-1:1;var s=d(e);if(s!=d(t))return s?-1:1}return 0!=(r=Object(a.a)(e,t))?r:0!=(r=Object(i.w)(t.End,e.End))?r:0!=(r=l(e.Subject,t.Subject))?r:0!=(r=l(e.CalendarItemType,t.CalendarItemType))?r:0!=(r=l(e.ParentFolderId.Id,t.ParentFolderId.Id))?r:l(e.ItemId.Id,t.ItemId.Id)}function l(e,t){return(e||"").localeCompare(t||"")}function f(e){var t=Object(i.w)(e.End,e.Start);return Math.max(Math.ceil(t/r.e),1)}function b(e){return"Booking"!=e.__type&&"AnonymousCalendarEvent"!=e.__type}n.d(t,"a",(function(){return s}))},1288:function(e,t,n){"use strict";var r=n(0),a=n(1200),c=n(1429),i=n(1290),o=n(1664),u=n(76),d=n(314);var s=n(1430);function l(e){var t=[c.a];Object(u.h)("cal-time-panel-focusTime")&&t.push(s.a);var n={BaseShape:"IdOnly",MaximumBodySize:0,BodyType:"HTML",FilterHtmlContent:!0,InlineImageCustomDataTemplate:a.e,InlineImageUrlTemplate:a.f,AddBlankTargetToLinks:!0,CssScopeClassName:"cal_"+Math.ceil(65534*Math.random()+1).toString(16),AdditionalProperties:t,ImageProxyCapability:Object(u.h)("cal-bodyImageProxy")&&Object(i.a)()?o.a.OwaAndConnectorsProxy:o.a.None};if(!Object(u.h)("cal-mf-blockExternalContent"))return n;switch(e){case"Default":return Object(r.__assign)(Object(r.__assign)({},n),{BlockContentFromUnknownSenders:!0,BlockExternalImages:!0});case"WithBlockedExternalContent":return n;default:return Object(d.a)(e)}}n.d(t,"a",(function(){return l}))},1289:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"ExtendedPropertyType:#Exchange"},e)}},1290:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(960),a=n(103);function c(){var e=!0;if(Object(a.u)()){var t=Object(r.d)(r.a.ExternalImages);e=null===t.externalImagesSelectedOption||0===t.externalImagesSelectedOption}else{var n=Object(a.i)().PolicySettings;e=void 0===n.ExternalImageProxyEnabled||n.ExternalImageProxyEnabled}return e}},1316:function(e,t,n){"use strict";var r=n(7);t.a=function(e){return e.IsAllDayEvent||Object(r.u)(e.End,e.Start)>0}},1317:function(e){e.exports=JSON.parse('{"a":"Daa"}')},1352:function(e,t,n){"use strict";var r=n(4),a=Object(r.action)("poll",(function(e,t,n){return{requestFunction:e,requestIdentifier:t,interval:n}})),c=Object(r.action)("responseRetrieved",(function(e,t){return{response:e,responseIdentifier:t}})),i=Object(r.action)("cancelPoll",(function(e){return{requestIdentifier:e}})),o={currentRequest:new(n(24).ObservableMap)},u=Object(r.createStore)("requestIdStore",o);Object(r.mutator)(i,(function(e){var t=u().currentRequest.get(e.requestIdentifier);if(t){var n=t.timer;clearTimeout(n),t.timer=null}}));var d=n(0),s=Object(r.mutatorAction)("setCurrentRequestId",(function(e,t){var n=u().currentRequest.get(e);n?n.requestId=t:u().currentRequest.set(e,{requestId:t,timer:null})}));function l(e,t){return u().currentRequest.get(e).requestId===t}function f(e,t){return Object(d.__awaiter)(this,void 0,void 0,(function(){var n,r,a;return Object(d.__generator)(this,(function(c){switch(c.label){case 0:return n=Math.random(),s(t,n),[4,e()];case 1:return r=c.sent(),a={isCurrent:l(t,n)},[2,Object(d.__assign)({response:r},a)]}}))}))}var b=Object(r.mutatorAction)("setPollTimer",(function(e,t){var n=u().currentRequest.get(e);n&&(n.timer=t)}));Object(r.orchestrator)(a,(function(e){var t=e.requestFunction,n=e.requestIdentifier,r=e.interval;i(n);var o=setTimeout((function(){return function(e,t,n){return Object(d.__awaiter)(this,void 0,void 0,(function(){var r;return Object(d.__generator)(this,(function(i){switch(i.label){case 0:return[4,f((function(){return e()}),t)];case 1:return(r=i.sent()).isCurrent&&c(r.response,t),a(e,t,n),[2]}}))}))}(t,n,r)}),r);b(n,o)})),n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}))},1428:function(e,t,n){"use strict";function r(){return{__type:void 0,ItemId:void 0,ParentFolderId:void 0,Subject:void 0,ReminderIsSet:void 0,ReminderMinutesBeforeStart:void 0,LastModifiedTime:void 0,InstanceKey:void 0,Preview:void 0,EffectiveRights:void 0,HasAttachments:void 0,HasBlockedImages:void 0,Attachments:void 0,Sensitivity:void 0,Body:void 0,EntityNamesMap:void 0,TailoredXpEntities:void 0,IsDraft:void 0,Categories:void 0,Start:void 0,End:void 0,IsAllDayEvent:void 0,IsRoomRequested:void 0,AutoRoomBookingStatus:void 0,FreeBusyType:void 0,IsMeeting:void 0,IsCancelled:void 0,IsRecurring:void 0,IsResponseRequested:void 0,CalendarItemType:void 0,ResponseType:void 0,Organizer:void 0,RequiredAttendees:void 0,OptionalAttendees:void 0,Resources:void 0,AppointmentReplyTime:void 0,Recurrence:void 0,Location:void 0,IntendedFreeBusyStatus:void 0,IsOrganizer:void 0,AppointmentReplyName:void 0,IsSeriesCancelled:void 0,CharmId:void 0,Locations:void 0,ClientSeriesId:void 0,UID:void 0,ExperienceType:void 0,DoNotForwardMeeting:void 0,IsOnlineMeeting:void 0,JoinOnlineMeetingUrl:void 0,InboxReminders:void 0,MeetingRequestWasSent:void 0,ExtractionSourceId:void 0,StartTimeZoneId:void 0,EndTimeZoneId:void 0,OnlineMeetingProvider:void 0,OnlineMeetingJoinUrl:void 0,OnlineMeetingConferenceId:void 0,OnlineMeetingTollNumber:void 0,OnlineMeetingTollFreeNumbers:void 0,SeriesMasterItemId:void 0,ExtractionSourceInternetMessageId:void 0,HideAttendees:void 0,PersonId:void 0,InReplyTo:void 0,IsFreeBusyOnly:void 0,MeetingNotesWebUrl:void 0,ConversationId:void 0,SkypeTeamsProperties:void 0,DocLinks:void 0,AppendOnSend:void 0,IsBookedFreeBlocks:void 0,AssociatedTasks:void 0}}n.d(t,"a",(function(){return r}))},1429:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(296),a=Object(r.a)({DistinguishedPropertySetId:"Common",PropertyName:"AppendOnSend",PropertyType:"String"})},1430:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(420),a=Object(r.a)("6ed8da90-450b-101b-98da-00aa003f1305","IsBookedFreeBlocks","Boolean")},1433:function(e){e.exports=JSON.parse('{"a":"Ida"}')},1434:function(e){e.exports=JSON.parse('{"a":"Eaa"}')},1454:function(e,t,n){"use strict";var r=n(1195),a=n(1485),c=n(1149);var i=n(1767);function o(e){return function(e){return!(e<=0)&&(Object(c.a)(e,a.a)==a.a||Object(c.a)(e,r.d)==r.d||Object(c.a)(e,r.e)==r.e||Object(c.a)(e,a.b)==a.b||Object(c.a)(e,r.a)==r.a||Object(c.a)(e,r.b)==r.b||Object(c.a)(e,r.f)==r.f)}(e)||function(e){return Object(c.a)(e,r.g)==r.g||Object(c.a)(e,r.h)==r.h||Object(c.a)(e,r.i)==r.i}(e)||Object(i.a)(e)}n.d(t,"a",(function(){return o}))},1488:function(e,t,n){"use strict";var r=n(4),a=Object(r.action)("updateLoadedDateRange",(function(e,t){return{dateRange:e,scenarioId:t}})),c=Object(r.action)("updateCalendarEventLoadStates",(function(e,t){return{calendarIds:e,scenarioId:t}})),i=Object(r.action)("resetCalendarEventLoadStates",(function(e){return{scenarioId:e}})),o=Object(r.action)("updateLoadState",(function(e,t){return{scenarioId:t,loadState:e}})),u=Object(r.action)("initializeScenario",(function(e){return{scenarioId:e}})),d=Object(r.action)("updateIsInitializingCalendarEventsLoader",(function(e,t){return{scenarioId:t,isInitializingCalendarEventsLoader:e}})),s=n(0),l=n(1566),f=n(983);function b(e){var t=Object(f.o)(e);return Object(s.__assign)(Object(s.__assign)({},t),{getOrderedEvents:function(t,n){return function(e,t,n){var r=Object(f.o)(n).getCalendarEventsForDateRange,a=[];return e.forEach((function(e){a.push.apply(a,Object(s.__spread)(r(e,t)))})),a.sort(l.a)}(t,n,e)}})}var v=n(2127),O=["ConflictsView","TimePanelCalendarCacheId","TimePanelUpNextCalendarCacheId"];var p=n(24),j={scenarios:new p.ObservableMap},I=Object(r.createStore)("EventsLoadedStore",j),_=n(160),m=n(614);function h(e){return Object(_.d)(e)&&!Object(_.c)(e)}function g(e){return Object(_.d)(e)&&Object(_.c)(e)}function y(e){return void 0===e&&(e=function(){return!0}),function(t,n){var r=Object(s.__read)(n,2),a=r[0],c=r[1];return e([a,c])&&t.push(a),t}}function E(e){return function(t){var n=Object(s.__read)(t,2);n[0];return n[1]===e}}function w(e){return R(e).eventsCacheLockId}function C(e,t){return Object(_.d)(t)?h(t)?F(e).get(t):Object(m.d)(t):"Loading"}function S(e){return D(e).map((function(t){return C(e,t)}))}function A(e){return I().scenarios.has(e)?R(e).scenarioLoadState:"DoesNotExist"}function P(e){return R(e).loadedDateRange}function x(e,t){return N(e).reduce(y(E(t)),[])}function R(e){var t=I().scenarios.get(e);if(!t)throw new Error("getScenarioData should not be called until the calendar events loader scenario is initialized");return t}function T(e,t){var n=t||P(e),r=function(e){return D(e).filter(h).map(_.x)}(e),a=w(e),c=r?b(a).getOrderedEvents(r,n):[];return function(e){return!O.some((function(t){return t==e}))&&Object(v.a)()}(e)||(c=c.filter((function(e){return"Decline"!==e.ResponseType}))),c}function F(e){return R(e).calendarEventsLoadState}function N(e){return Object(s.__spread)(F(e).entries())}function D(e){return Object(s.__spread)(F(e).keys())}Object(r.mutator)(a,(function(e){var t=e.scenarioId,n=e.dateRange;R(t).loadedDateRange=n})),Object(r.mutator)(o,(function(e){var t=e.scenarioId,n=e.loadState;R(t).scenarioLoadState=n})),Object(r.mutator)(d,(function(e){var t=e.scenarioId,n=e.isInitializingCalendarEventsLoader;R(t).isInitializingCalendarEventsLoader=n})),Object(r.mutator)(u,(function(e){var t=e.scenarioId;I().scenarios.get(t)||I().scenarios.set(t,{eventsCacheLockId:Object(f.e)().getLockId(),loadedDateRange:null,scenarioLoadState:"Loading",calendarEventsLoadState:new p.ObservableMap({}),isInitializingCalendarEventsLoader:!0})})),Object(r.mutator)(f.u,(function(e){var t=e.calendarId,n=e.loadingState,r=function(e){var t=Object(s.__spread)(I().scenarios.entries()).filter((function(t){var n=Object(s.__read)(t,2);n[0];return n[1].eventsCacheLockId===e}));return t.length>0?{value:!0,scenarioId:t[0][0]}:{value:!1}}(e.lockId);if(r.value){var a=F(r.scenarioId);t&&a.has(t.id)&&a.set(t.id,n)}})),Object(r.mutator)(c,(function(e){var t=e.calendarIds,n=e.scenarioId,r=F(n);t.forEach((function(e){r.has(e)||r.set(e,"NotLoaded")})),D(n).forEach((function(e){t.some((function(t){return t===e}))||r.delete(e)}))})),Object(r.mutator)(i,(function(e){var t=e.scenarioId,n=F(t);D(t).forEach((function(e){n.set(e,"NotLoaded")}))}));var M=Object(r.action)("initializeCalendarEventsLoader",(function(e,t,n){return{calendarIds:e,dateRange:t,scenarioId:n}})),k=Object(r.action)("calendarEventsLoaderInitialized",(function(e){return{scenarioId:e}})),L=Object(r.action)("updateCalendarIds",(function(e,t){return{calendarIds:e,scenarioId:t}})),B=Object(r.action)("onCalendarIdsUpdated",(function(e){return{scenarioId:e}})),G=Object(r.action)("onDateRangeUpdated",(function(e,t){return{dateRange:e,scenarioId:t}})),U=Object(r.action)("loadFullEvent",(function(e,t,n){return{scenarioId:e,id:t,parentFolderId:n}})),K=Object(r.action)("updateDateRange",(function(e,t){return{dateRange:e,scenarioId:t}})),q=Object(r.action)("expandDateRange",(function(e,t){return{numberOfDays:e,scenarioId:t}})),V=n(7);function z(e,t){return null===t||!Object(V.Ib)(e.start,t.start)||!Object(V.Ib)(e.end,t.end)}var W=n(79),H=function(e,t,n){return e&&0!==e.length?function(e,t,n){var r=this;var a=w(n),c=Object(f.p)(a),i=e.map((function(e){return c.fetchCalendarEventsForDateRange(e,t)})),o=i.every((function(e){return null!==e.events})),u=new Promise((function(t){return Object(s.__awaiter)(r,void 0,void 0,(function(){var n;return Object(s.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Promise.all(i.map((function(e){return e.fetchPromise})))];case 1:return r.sent(),e.forEach((function(e){return c.subscribeNotifications(e)})),[3,3];case 2:return n=r.sent(),W.g.warn("loadEvents: Exception occured: "+n.message),[3,3];case 3:return t(),[2]}}))}))}));return{canFetchAllEventsFromLocal:o,fetchPromise:u}}(e,t,n):{canFetchAllEventsFromLocal:!1,fetchPromise:new Promise((function(e){return Object(s.__awaiter)(void 0,void 0,void 0,(function(){return Object(s.__generator)(this,(function(t){return[2,e()]}))}))}))}};function J(e,t,n){return Object(s.__awaiter)(this,void 0,void 0,(function(){var r,a,c,i,u;return Object(s.__generator)(this,(function(d){switch(d.label){case 0:return(r=t.filter(h)).length>0?(a=r.map(_.x),c=H(a,n,e),i=c.canFetchAllEventsFromLocal,u=c.fetchPromise,i||o("Fetching",e),[4,u]):[3,2];case 1:d.sent(),d.label=2;case 2:return[2]}}))}))}var Y=function(e){return Object(s.__awaiter)(void 0,void 0,void 0,(function(){return Object(s.__generator)(this,(function(t){switch(t.label){case 0:return e?[4,Promise.all(e.filter(g).map(m.c).map((function(e){return e.catch(Q)})))]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))};function Q(e){return W.g.warn("Failed to update folderId:\n"+e),Promise.resolve()}function Z(e){i(e),a(null,e)}function X(e,t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n,r,i,u;return Object(s.__generator)(this,(function(d){switch(d.label){case 0:return n=t.calendarIds,r=t.dateRange,c(n,e),i=x(e,"NotLoaded"),Y(i),u=P(e),z(r,u)||0!==i.length?(o("Loading",e),z(r,u)&&Z(e),[4,J(e,n,r)]):[3,2];case 1:d.sent(),a(r,e),o("Loaded",e),B(e),d.label=2;case 2:return[2]}}))}))}Object(r.orchestrator)(M,(function(e){return Object(s.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r;return Object(s.__generator)(this,(function(a){switch(a.label){case 0:if(t=e.scenarioId,n=e.calendarIds,r=e.dateRange,"DoesNotExist"===A(t))u(t);else if(function(e){return R(e).isInitializingCalendarEventsLoader}(t))return[2];return[4,X(t,{calendarIds:n,dateRange:r})];case 1:return a.sent(),k(t),d(!1,t),[2]}}))}))})),Object(r.orchestrator)(L,(function(e){return Object(s.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r,a;return Object(s.__generator)(this,(function(i){switch(i.label){case 0:return t=e.calendarIds,n=e.scenarioId,c(t,n),r=x(n,"NotLoaded"),Y(r),a=P(n),0===r.length?[3,2]:(o("Loading",n),[4,J(n,r,a)]);case 1:i.sent(),o("Loaded",n),B(n),i.label=2;case 2:return[2]}}))}))}));var $=n(1352),ee=(Object(r.orchestrator)(K,(function(e){return Object(s.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r;return Object(s.__generator)(this,(function(c){switch(c.label){case 0:return t=e.dateRange,n=e.scenarioId,r=P(n),z(t,r)?(o("Loading",n),Z(n),[4,Object($.c)((function(){return J(n,D(n),t)}),"UpdateDateRange_"+n)]):[3,2];case 1:c.sent().isCurrent&&(a(t,n),o("Loaded",n),G(t,n)),c.label=2;case 2:return[2]}}))}))})),Object(r.orchestrator)(q,(function(e){return Object(s.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r,c;return Object(s.__generator)(this,(function(i){switch(i.label){case 0:return t=e.scenarioId,n=e.numberOfDays,r=P(t),c={start:r.start,end:Object(V.e)(r.end,n)},o("Loading",t),[4,J(t,D(t),c)];case 1:return i.sent(),a(c,t),o("Loaded",t),[2]}}))}))})),Object(r.orchestrator)(U,(function(e){return Object(s.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r,a;return Object(s.__generator)(this,(function(c){return t=e.scenarioId,n=e.parentFolderId,r=e.id,a=w(t),(0,Object(f.p)(a).fetchFullCalendarEvent)(r,n?n.Id:null,void 0,void 0,{fetchSource:t}),[2]}))}))})),n(520));function te(){var e=this;Object(s.__spread)(I().scenarios.entries()).reduce((function(e,t){var n=Object(s.__read)(t,2),r=n[0],a=(n[1],N(r).reduce(y(E("NotLoaded")),[]));return a&&a.length>0&&e.push({scenarioId:r,calendarIds:a}),e}),[]).forEach((function(t){return Object(s.__awaiter)(e,void 0,void 0,(function(){var e,n,r;return Object(s.__generator)(this,(function(a){switch(a.label){case 0:return e=t.scenarioId,n=t.calendarIds,(r=P(e))?(o("Loading",e),[4,J(e,n,r)]):[3,2];case 1:a.sent(),o("Loaded",e),a.label=2;case 2:return[2]}}))}))}))}Object(r.orchestrator)(ee.b,te),Object(r.orchestrator)(m.a,te);n.d(t,"h",(function(){return M})),n.d(t,"a",(function(){return k})),n.d(t,"l",(function(){return L})),n.d(t,"j",(function(){return B})),n.d(t,"k",(function(){return G})),n.d(t,"i",(function(){return U})),n.d(t,"m",(function(){return K})),n.d(t,"b",(function(){return q})),n.d(t,"e",(function(){return C})),n.d(t,"f",(function(){return S})),n.d(t,"d",(function(){return A})),n.d(t,"g",(function(){return P})),n.d(t,"c",(function(){return T}))},1490:function(e,t,n){"use strict";var r=n(1491);t.a=function(e,t){return Object(r.a)(e.FreeBusyType)-Object(r.a)(t.FreeBusyType)}},1491:function(e,t,n){"use strict";t.a=function(e){switch(e){case"OOF":return 0;case"Busy":return 1;case"Tentative":return 2;case"WorkingElsewhere":return 3;case"Free":return 4;default:return 5}}},1492:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),a=n(7),c=n(1428),i=n(114),o=n(411),u=n(959),d=n(363);function s(e,t,n,d){if(d=d||Object(i.e)(),!n){var s=Object(u.d)(t);s&&s.length>0&&(n=s.sort((function(e,t){var n=Object(o.l)(e),r=Object(o.l)(t);return n>r?-1:n<r?1:0}))[0])}var f=Object(c.a)(),b=function(e,t){var n=Object(a.mc)(e),r=l(n,Object(a.Db)(t.start));return Object(o.s)(t,r)?r:l(n,Object(a.Db)(t.end))}(e.Birthday,n),v=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},f),e),{Subject:e.Name,Start:b,End:Object(a.e)(b,1),IsAllDayEvent:!0,ParentFolderId:{Id:t,mailboxInfo:d},ItemId:{Id:e.Id.Id,mailboxInfo:d},PersonId:e.PersonId,EffectiveRights:{Delete:!0,Modify:!0,Read:!0},FreeBusyType:"Free",ReminderIsSet:e.PopupReminderSettings[0].IsReminderSet,ReminderMinutesBeforeStart:e.PopupReminderSettings[0].ReminderMinutesBeforeStart,InboxReminders:e.EmailReminderSettings});return v||null}function l(e,t){var n=Object(a.yb)(e),r=Object(a.mb)(e),c=Object(d.a)(t,n),i=Math.min(r,c);return Object(a.mc)(t,n,i)}},1566:function(e,t,n){"use strict";var r=n(1287),a=n(1490),c=(n(1491),n(7));var i=function(e,t){return Object(c.Ab)(e.Start)<Object(c.Ab)(t.End)&&Object(c.Ab)(e.End)>Object(c.Ab)(t.Start)},o=function(e,t){return t.filter((function(t){return t!=e&&i(e,t)})).sort(r.a)};function u(e,t){var n,r,a,i,o;e.Start=t.Start,e.ItemId=t.ItemId,e.End=t.End,e.CalendarItemType="ThisAndFollowingInstancesMaster",e.Recurrence.RecurrenceRange.StartDate=(r=(n=t).StartTimeZoneId,a=n.Start,i=Object(c.Rb)(r,a),o=Object(c.Xb)(i),Object(c.vb)(o))}var d=n(1316);function s(e){e.Start=Object(c.Rb)(e.StartTimeZoneId,e.Start),e.End=Object(c.Rb)(e.EndTimeZoneId,e.End)}n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return a.a})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return d.a})),n.d(t,"g",(function(){return s}))},1581:function(e,t,n){"use strict";var r=n(4),a=Object(r.action)("UPDATE_SELECTED_CALENDARS_IN_STORE",(function(e,t){return{calendarIds:e,userIdentity:t}})),c=Object(r.action)("ADD_SELECTED_CALENDAR_IN_STORE",(function(e,t){return{calendarId:e,userIdentity:t}})),i={selectedCalendars:new(n(24).ObservableMap)},o=Object(r.createStore)("selectedCalendarsStore",i),u=n(1206);Object(r.mutator)(a,(function(e){var t=e.calendarIds,n=e.userIdentity;o().selectedCalendars.set(n,Object(u.b)(t))}));var d=n(0);function s(){return Object(u.c)(o().selectedCalendars)}function l(){return Object(u.d)(s())}function f(e){var t=s().get(e);return t||[]}Object(r.mutator)(c,(function(e){var t=e.calendarId,n=e.userIdentity;o().selectedCalendars.set(n,Object(u.b)(Object(d.__spread)(f(n),[t])))}));var b=Object(r.action)("UPDATE_SELECTED_CALENDARS",(function(e,t){return{calendarIds:e,userIdentity:t}})),v=Object(r.action)("ADD_SELECTED_CALENDAR",(function(e,t){return{calendarId:e,userIdentity:t}})),O=(Object(r.action)("INITIALIZE_SELECTED_CALENDARS",(function(e,t){return{calendarIds:e,userIdentity:t}})),Object(r.action)("SELECTED_CALENDARS_UPDATED",(function(e,t){return{calendarIds:e,userIdentity:t}}))),p=n(114),j=n(79),I=n(1757),_="OWA.ViewStateConfiguration";function m(e,t){var n=Object(p.e)(t);e&&I.a.importAndExecute(_,{Type:"String",Value:["SelectedCalendarsDesktop"]},{Type:"StringArray",Value:Object(u.b)(e)},n).catch((function(e){j.g.warn("Could not save new selected calendars list to user configuration")}))}Object(r.orchestrator)(b,(function(e){var t=e.calendarIds,n=e.userIdentity;a(t,n),O(t,n),m(t,n)})),Object(r.orchestrator)(v,(function(e){var t=e.calendarId,n=e.userIdentity;c(t,n);var r=f(n);O(r,n),m(r,n)}));var h=n(103);function g(e){return e?function(e){var t=s().get(e);return t?t.length:0}(e):(t=s(),n=0,t.forEach((function(e,t){e&&(n+=e.length)})),n);var t,n}Object(r.orchestrator)(h.z,(function(e){var t=e.userConfiguration,n=e.userIdentity,r=t.ViewStateConfiguration.SelectedCalendarsDesktop,c=n||Object(p.e)().userIdentity;a(r,c),O(r,c)})),n.d(t,"g",(function(){return b})),n.d(t,"a",(function(){return v})),n.d(t,"f",(function(){return O})),n.d(t,"e",(function(){return f})),n.d(t,"c",(function(){return g})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return l}))},160:function(e,t,n){"use strict";var r=n(214),a=n(0),c=n(4),i=Object(c.action)("initializeCalendarsCacheInStore",(function(e,t,n,r,a,c){return{defaultCalendarEntry:e,calendarEntries:t,calendarFolders:n,calendarGroups:r,folderIdMapping:a,calendarIdToChangeKeyMapping:c}})),o=Object(c.action)("updateChangeKeyByCalendarItemId",(function(e){return{itemId:e}})),u=Object(c.action)("addToCalendarsCache",(function(e,t,n){return{calendarEntry:e,folder:t,mailboxInfo:n}})),d=Object(c.action)("addCalendarGroupToCalendarsCache",(function(e){return{calendarGroup:e}})),s=Object(c.action)("updateCalendarEntry",(function(e,t){return{itemId:e,calendarEntry:t}})),l=Object(c.action)("updateCalendarFolder",(function(e,t){return{calendar:e,calendarFolder:t}})),f=Object(c.action)("removeCalendarFromCalendarsCache",(function(e){return{calendar:e}})),b=Object(c.action)("markCalendarEntryAsValid",(function(e){return{calendarEntry:e}})),v=Object(c.action)("calendarUpdated",(function(e,t){return{calendarId:e,updates:t}})),O=Object(c.action)("groupAssociationChanged",(function(e){return{payload:e}})),p=Object(c.action)("removeCalendarWithIDFromCalendarsCache",(function(e){return{calendarId:e}}));Object(c.mutator)(o,(function(e){var t=e.itemId,n=t.Id,a=t.ChangeKey;Object(r.a)().calendarItemIdToChangeKey.set(n,a)})),Object(c.mutator)(s,(function(e){var t=e.itemId.Id,n=e.calendarEntry,c=Object(r.a)().calendarEntryMapping.get(t),i=(n.ItemId,Object(a.__rest)(n,["ItemId"]));c&&Object.keys(i).forEach((function(e){c[e]=i[e]}))})),Object(c.mutator)(b,(function(e){var t=e.calendarEntry;Object(r.a)().validEntryMapping.set(t.ItemId.Id,!0)}));var j=n(228);function I(e,t){return t+"_"+e}function _(e,t){Object.keys(t).forEach((function(n){return e.set(n,t[n])}))}function m(e,t,n){var a=Object(r.a)();a.calendarItemIdToChangeKey.delete(e),n||(a.calendarEntryMapping.delete(e),a.validEntryMapping.delete(e)),a.calendarFolderMapping.delete(e),t&&a.folderIdToCalendarId.delete(t)}Object(c.mutator)(i,(function(e){var t=e.defaultCalendarEntry;t&&Object(r.a)().defaultCalendars.set(t.id.mailboxInfo.userIdentity,t)})),Object(c.mutator)(i,(function(e){var t=e.calendarEntries;_(Object(r.a)().calendarEntryMapping,t)})),Object(c.mutator)(i,(function(e){var t=e.calendarFolders;_(Object(r.a)().calendarFolderMapping,t)})),Object(c.mutator)(i,(function(e){var t=e.folderIdMapping;_(Object(r.a)().folderIdToCalendarId,t)})),Object(c.mutator)(i,(function(e){var t=e.calendarIdToChangeKeyMapping;_(Object(r.a)().calendarItemIdToChangeKey,t)})),Object(c.mutator)(i,(function(e){var t=e.calendarGroups;_(Object(r.a)().calendarGroupsMapping,t)})),Object(c.mutator)(u,(function(e){var t=e.calendarEntry,n=e.folder,c=e.mailboxInfo,i=Object(r.a)();i.calendarItemIdToChangeKey.set(t.ItemId.Id,t.ItemId.ChangeKey);var o=Object(a.__assign)(Object(a.__assign)({},t),{id:{id:t.ItemId.Id,mailboxInfo:c}});i.calendarEntryMapping.set(t.ItemId.Id,o),i.calendarFolderMapping.set(t.ItemId.Id,n),n.FolderId?i.folderIdToCalendarId.set(n.FolderId.Id,{id:t.ItemId.Id,mailboxInfo:c}):n.DistinguishedFolderId&&i.folderIdToCalendarId.set(n.DistinguishedFolderId,{id:t.ItemId.Id,mailboxInfo:c})})),Object(c.mutator)(d,(function(e){var t=e.calendarGroup,n=Object(r.a)(),a=I(t.id.mailboxInfo.userIdentity,t.GroupId);n.calendarGroupsMapping.set(a,t)})),Object(c.mutator)(f,(function(e){var t=e.calendar;m(t.id.id,t.calculatedFolderId?t.calculatedFolderId:null)})),Object(c.mutator)(p,(function(e){var t=e.calendarId;m(t,Object(j.s)(t),!0)})),Object(c.mutator)(l,(function(e){var t=e.calendar,n=e.calendarFolder,r=Object(j.l)(t);Object.keys(n).forEach((function(e){r[e]=n[e]}))}));n(446);var h=n(489);function g(e){var t=Object(j.p)(e);return t?t.mailboxInfo:null}function y(e){var t=Object(j.l)(e),n=Object(j.h)(e);return t&&n&&!n.IsReadOnly&&t.EffectiveRights&&t.EffectiveRights.CreateContents}var E=n(414),w=n(27);function C(e,t){var n,r=Object(j.h)(e);if(Object(E.d)(r)){var a=r;return!a.IsOwnerEmailAddressInvalid&&a.OwnerEmailAddress==t}return(null===(n=e.id)||void 0===n?void 0:n.mailboxInfo)?t.indexOf(e.id.mailboxInfo.mailboxSmtpAddress)>=0:Object(w.a)().SessionSettings.UserEmailAddress==t}function S(e){return e?e.map(j.f).filter((function(e){return!!e})):null}function A(e){var t=Object(j.h)(e);return!!t&&t.IsGroupMailboxCalendar}function P(e){var t=Object(j.h)(e);return null==t?void 0:t.IsSchoolCalendar}var x=n(103),R=n(76),T=n(240);function F(e){if(e.IsGroupMailboxCalendar){var t=e.OwnerEmailAddress;return Object(R.h)("cal-groupNotifications")?{MailboxId:Object(j.w)(e)&&Object(R.h)("cal-showAddTeamsCalendars")?Object(j.c)(t):t}:null}var n=e.CalendarFolderId;if(n){var r=e.id.mailboxInfo.userIdentity;return Object(x.v)(r)?{FolderId:n.Id}:Object(T.n)(r)?{FolderId:n.Id,MailboxId:r,MailboxType:Object(T.p)(r)?2:3}:null}return null}var N,D,M=n(114);function k(e){return Object(j.o)().filter((function(t){return function(e,t){return!!e&&e.id.mailboxInfo.userIdentity===t}(t,e)})).sort(L)}function L(e,t){var n=B[e.GroupType]-B[t.GroupType];if(0!==n)return n;var r=G[e.id.mailboxInfo.type]-G[t.id.mailboxInfo.type];return 0!==r?r:e.GroupName.localeCompare(t.GroupName)}var B=((N={})[0]=0,N[2]=1,N[1]=2,N[3]=3,N),G=((D={})[M.a.UserMailbox]=0,D[M.a.TeamsMailbox]=1,D[M.a.GroupMailbox]=2,D[M.a.PublicMailbox]=3,D[M.a.SharedMailbox]=4,D);function U(e,t){var n=Object(j.r)(e),r=Object(j.d)().filter((function(r){return function(e,t){return!!e&&e.id.mailboxInfo.userIdentity===t}(r,e)&&K(r,t)&&(c=n,!((a=r)&&c&&a.id.id===c.id.id));var a,c})).sort(q);return n&&K(n,t)&&r.unshift(n),r}function K(e,t){var n=Object(j.h)(e);return!!n&&n.ParentGroupId===t}function q(e,t){return e.displayName.localeCompare(t.displayName)}n.d(t,"E",(function(){return i})),n.d(t,"U",(function(){return o})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"S",(function(){return s})),n.d(t,"T",(function(){return l})),n.d(t,"Q",(function(){return f})),n.d(t,"P",(function(){return b})),n.d(t,"e",(function(){return v})),n.d(t,"D",(function(){return O})),n.d(t,"R",(function(){return p})),n.d(t,"w",(function(){return j.r})),n.d(t,"G",(function(){return j.t})),n.d(t,"k",(function(){return j.g})),n.d(t,"g",(function(){return j.d})),n.d(t,"t",(function(){return j.o})),n.d(t,"u",(function(){return j.p})),n.d(t,"m",(function(){return j.i})),n.d(t,"j",(function(){return j.f})),n.d(t,"p",(function(){return j.l})),n.d(t,"l",(function(){return j.h})),n.d(t,"o",(function(){return j.k})),n.d(t,"q",(function(){return j.m})),n.d(t,"v",(function(){return j.q})),n.d(t,"r",(function(){return j.n})),n.d(t,"x",(function(){return j.s})),n.d(t,"i",(function(){return j.e})),n.d(t,"d",(function(){return j.b})),n.d(t,"I",(function(){return j.u})),n.d(t,"J",(function(){return j.v})),n.d(t,"M",(function(){return j.x})),n.d(t,"c",(function(){return j.a})),n.d(t,"n",(function(){return j.j})),n.d(t,"L",(function(){return j.w})),n.d(t,"O",(function(){return j.y})),n.d(t,"f",(function(){return j.c})),n.d(t,"h",(function(){return h.a})),n.d(t,"y",(function(){return g})),n.d(t,"s",(function(){return I})),n.d(t,"N",(function(){return y})),n.d(t,"F",(function(){return C})),n.d(t,"z",(function(){return S})),n.d(t,"H",(function(){return A})),n.d(t,"K",(function(){return P})),n.d(t,"C",(function(){return F})),n.d(t,"A",(function(){return k})),n.d(t,"B",(function(){return U}))},1651:function(e,t,n){"use strict";n.d(t,"b",(function(){return i}));var r=n(108),a=n(1454);n.d(t,"a",(function(){return a.a}));var c=new r.c((function(){return Promise.all([n.e(80),n.e(457)]).then(n.bind(null,2851))})),i=new r.a(c,(function(e){return e.getTxpObjectFromTxpEntities}))},1664:function(e,t,n){"use strict";var r;!function(e){e.None="None",e.OwaProxy="OwaProxy",e.ConnectorsProxy="ConnectorsProxy",e.Compose="Compose",e.OwaAndConnectorsProxy="OwaAndConnectorsProxy",e.OwaConnectorsProxyAndCompose="OwaConnectorsProxyAndCompose"}(r||(r={})),t.a=r},1729:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(7);function a(e,t){if(null==t?void 0:t.RecurrenceRange){var n=t.RecurrenceRange.EndDate;if(n)return Object(r.Rb)(e,n)}return null}},1757:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(108),a=new r.c((function(){return n.e(603).then(n.bind(null,3473))})),c=new r.a(a,(function(e){return e.updateUserConfigurationService}))},1767:function(e,t,n){"use strict";var r=n(1149);var a=n(1195),c=n(76),i=n(1769);function o(e){return function(e,t,n){return Object(r.a)(e,t)==t&&n}(e,a.c,Object(c.h)(i.a))}n.d(t,"a",(function(){return o}))},1768:function(e,t,n){"use strict";var r=n(287),a=!0,c=!0;function i(e,t){return Object(r.f)(e,"GET",t,{throwServiceError:a})}function o(e,t,n){return Object(r.f)(e,"DELETE",t,{requestObject:n,sendPayloadAsBody:c,throwServiceError:a})}function u(e,t,n,i){return Object(r.f)(e,"POST",t,{requestObject:n,sendPayloadAsBody:c,throwServiceError:a,customHeaders:s(i)})}function d(e,t,n,i){return Object(r.f)(e,"PATCH",t,{requestObject:n,sendPayloadAsBody:c,throwServiceError:a,customHeaders:s(i)})}function s(e){return!0===e?{Prefer:"return=representation"}:!1===e?{Prefer:"return=minimal"}:void 0}n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return d}))},1769:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var r="cal-txp-invoice",a="cal-txp-serviceReservationAdaptive"},1771:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"GetCalendarEventRequest:#Exchange"},e)}},1795:function(e,t,n){"use strict";var r=n(25),a=n(0);function c(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(a.__assign)({__type:"GetCalendarEventJsonRequest:#Exchange"},n)),Object(r.a)("GetCalendarEvent",e,t)}n.d(t,"a",(function(){return c}))},1797:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),a=Object(r.action)("logNotificationUpdateForDiagnostics",(function(e){return{notificationUpdateLog:e}}))},1810:function(e,t,n){"use strict";var r=n(25),a=n(0);function c(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(a.__assign)({__type:"GetCalendarViewJsonRequest:#Exchange"},n)),Object(r.a)("GetCalendarView",e,t)}n.d(t,"a",(function(){return c}))},1816:function(e,t,n){"use strict";n.d(t,"a",(function(){return I}));var r=n(0),a=n(431),c=n(1810),i=n(1846),o=n(1020),u=n(7),d=n(246),s=n(950),l=n(315),f=n(589),b=n(450),v="X-OWA-ExplicitLogonUser",O="X-AnchorMailbox",p=6,j=null;function I(e,t,n,I,_,m){return void 0===n&&(n=Object(s.a)("calendar")),Object(r.__awaiter)(this,void 0,void 0,(function(){var s,h;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return s=null,_?(s={headers:(h={},h[v]=_,h[O]=_,h)},[3,3]):[3,1];case 1:return I?[4,Object(l.e)(I.mailboxInfo)]:[3,3];case 2:s=r.sent(),r.label=3;case 3:return j||(j=Object(f.a)(p)),[2,j.add((function(){var r={Header:Object(d.a)(),Body:Object(i.a)({CalendarId:Object(o.a)({BaseFolderId:Object(a.a)({Id:n})}),RangeStart:Object(u.rb)(e),RangeEnd:Object(u.rb)(t),IncludeDeclinedMeetings:m})};return Object(c.a)(r,s).then((function(e){return Object(b.a)()&&b.c.importAndExecute({request:r.Body,options:s,folderId:n},e.Body),e.Body}),Object(b.a)()&&function(e){return b.e.importAndExecute({request:r.Body,options:s,folderId:n}).then((function(t){if(t)return t;throw e})).catch((function(t){throw e}))})}))]}}))}))}},1846:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"GetCalendarViewRequest:#Exchange"},e)}},1984:function(e,t,n){"use strict";var r=n(4),a=n(0),c=n(103),i=Object(r.action)("WORKLOAD_SCENARIO_SETTINGS_LOADED",(function(e,t){return{settings:e,userIdentity:t}})),o=Object(r.action)("LOADING_WORKLOAD_SCENARIO_SETTINGS_FAILED",(function(e){return{userIdentity:e}}));var u="ows/beta/ScenarioSettings",d=["IsTimePanelDatePickerExpanded","TimePanelCalendarIds","IsTimePanelCalendarViewTaskListSelected"];function s(e){switch(e){case 1:return"Mail";case 2:return"Calendar";case 64:return"FilesHub";case 4:return"People";default:throw new Error("getWorkloadScenarioType: The workload type is not supported")}}var l=71;function f(e){return 0!=(e&l)}var b=n(1026);function v(e){if(d.some((function(t){return t===e})))return"Owa";var t=Object(b.b)();return f(t)?s(t):null}var O=n(315),p=n(287);function j(e){var t;return Object(a.__awaiter)(this,void 0,void 0,(function(){var n,r,c,i,o,d,l,j;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return n=["Owa"],f(r=Object(b.b)())&&(c=s(r),n.push(c)),i=function(e){var t=e.join(",");return u+"/?Scenarios="+t}(n),d=p.b,l=[i,void 0,void 0],[4,Object(O.b)(e)];case 1:return[4,d.apply(void 0,l.concat([a.sent(),!0,void 0,"GET_WORKLOAD_SCENARIO_SETTINGS"]))];case 2:return o=a.sent(),j={timePanelSelectedView:null,timePanelCalendarIds:[],timePanelSelectedCalendarView:null,isTimePanelOpen:!1,isTimePanelDatePickerExpanded:!1,isTimePanelCalendarViewTaskListSelected:!0},null===(t=null==o?void 0:o.settings)||void 0===t||t.forEach((function(e){var t,n=v(e.settingName);(t=e).calendarIds&&"TimePanelCalendarIds"===t.settingName&&n===v("TimePanelCalendarIds")?j.timePanelCalendarIds=e.calendarIds:!function(e){return!!e.selectedView&&"TimePanelSelectedView"===e.settingName}(e)||n!==v("TimePanelSelectedView")?!function(e){return!!e.selectedView&&"SelectedCalendarListView"===e.settingName}(e)||n!==v("SelectedCalendarListView")?!function(e){return void 0!==e.isOpen&&"IsTimePanelOpen"===e.settingName}(e)||n!==v("IsTimePanelOpen")?!function(e){return void 0!==e.isExpanded&&"IsTimePanelDatePickerExpanded"===e.settingName}(e)||n!==v("IsTimePanelDatePickerExpanded")?function(e){return void 0!==e.isSelected&&"IsTimePanelCalendarViewTaskListSelected"===e.settingName}(e)&&n===v("IsTimePanelCalendarViewTaskListSelected")&&(j.isTimePanelCalendarViewTaskListSelected=e.isSelected):j.isTimePanelDatePickerExpanded=e.isExpanded:j.isTimePanelOpen=e.isOpen:j.timePanelSelectedCalendarView=e.selectedView:j.timePanelSelectedView=e.selectedView})),[2,j]}}))}))}var I=n(515),_=Object(I.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(I.a)(1e4)}),m={};function h(){return Object(a.__awaiter)(this,void 0,void 0,(function(){var e;return Object(a.__generator)(this,(function(t){switch(t.label){case 0:return e=Object(c.g)().map(g),[4,Promise.all(e)];case 1:return t.sent(),[2]}}))}))}function g(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t;return Object(a.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),m[e]?[2]:(m[e]=_((function(){return j(e)})),[4,m[e].retriableFunc()]);case 1:return t=n.sent(),i(t,e),[3,3];case 2:return n.sent(),o(e),[3,3];case 3:return[2]}}))}))}var y=n(646);Object(r.orchestrator)(y.d,(function(e){g(e.userIdentity)}));function E(e,t){return u+"/"+e+"/"+t}function w(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n,r;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return(t=v("TimePanelSelectedView"))?(n=E(t,"TimePanelSelectedView"),r={ViewType:e},[4,Object(p.c)(n,r,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))}function C(e,t){return Object(a.__awaiter)(this,void 0,void 0,(function(){var n,r,c,i,o;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return(n=v("TimePanelCalendarIds"))?(r=E(n,"TimePanelCalendarIds"),c={CalendarIds:e},i=p.c,o=[r,c,void 0,void 0],[4,Object(O.b)(t)]):[3,3];case 1:return[4,i.apply(void 0,o.concat([a.sent(),!0,void 0]))];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))}function S(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n,r;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return(t=v("IsTimePanelOpen"))?(n=E(t,"IsTimePanelOpen"),r={IsOpen:e},[4,Object(p.c)(n,r,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))}function A(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n,r;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return(t=v("SelectedCalendarListView"))?(n=E(t,"SelectedCalendarListView"),r={ViewType:e},[4,Object(p.c)(n,r,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))}function P(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n,r;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return(t=v("IsTimePanelDatePickerExpanded"))?(n=E(t,"IsTimePanelDatePickerExpanded"),r={isExpanded:e},[4,Object(p.c)(n,r,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))}function x(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n,r;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return(t=v("IsTimePanelCalendarViewTaskListSelected"))?(n=E(t,"IsTimePanelCalendarViewTaskListSelected"),r={isSelected:e},[4,Object(p.c)(n,r,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))}n.d(t,"i",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return h})),n.d(t,"h",(function(){return w})),n.d(t,"g",(function(){return C})),n.d(t,"f",(function(){return S})),n.d(t,"e",(function(){return A})),n.d(t,"d",(function(){return P})),n.d(t,"c",(function(){return x}))},2099:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"e",(function(){return f})),n.d(t,"c",(function(){return b}));var r=n(1285),a=n(108),c=new a.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(567)]).then(n.bind(null,3461))}));Object(a.f)(r.e,c,(function(e){return e.openTimePanelOrchestrator}));var i=Object(a.d)(c,(function(e){return e.TimePanel})),o=Object(a.d)(c,(function(e){return e.TimePanelHeaderBar})),u=new a.a(c,(function(e){return e.loadTimePanelData})),d=new a.a(c,(function(e){return e.openEventDetailsView})),s=(new a.a(c,(function(e){return e.openAttendeeTrackingView})),new a.a(c,(function(e){return e.closeAttendeeTrackingView})),new a.a(c,(function(e){return e.openTasksView}))),l=new a.a(c,(function(e){return e.openCalendarView})),f=new a.a(c,(function(e){return e.openConflictsView})),b=new a.a(c,(function(e){return e.closeConflictsView}));new a.a(c,(function(e){return e.openEventQuickComposeView}))},2127:function(e,t,n){"use strict";var r=n(0),a=n(4),c=n(123),i=Object(a.action)("toggleShowDeclinedEventsMode",(function(e,t){return Object(c.c)({name:"ToggleShowDeclinedEventsMode",customData:{CurrentDateRangeType:t,ShowDeclinedEventsMode:e}},{isDeclinedEventsMode:e,dateRangeType:t})})),o=i,u=n(27),d=n(322),s=n(1757);Object(a.orchestrator)(i,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(a){return t=e.isDeclinedEventsMode,n=Object(u.a)(),Object(d.a)(Object(r.__assign)(Object(r.__assign)({},n),{ViewStateConfiguration:Object(r.__assign)(Object(r.__assign)({},n.ViewStateConfiguration),{CalendarViewShowDeclinedMeetings:t})})),s.a.importAndExecute("OWA.ViewStateConfiguration",{Type:"String",Value:["CalendarViewShowDeclinedMeetings"]},{Type:"Boolean",Value:[""+t]}),[2]}))}))}));var l=n(103),f=n(76);function b(){return!!Object(f.h)("cal-surface-declinedMeetings")&&Object(l.i)().ViewStateConfiguration.CalendarViewShowDeclinedMeetings}n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return o}))},214:function(e,t,n){"use strict";var r=n(4),a=n(24),c={calendarEntryMapping:new a.ObservableMap,calendarFolderMapping:new a.ObservableMap,calendarItemIdToChangeKey:new a.ObservableMap,folderIdToCalendarId:new a.ObservableMap,validEntryMapping:new a.ObservableMap,calendarGroupsMapping:new a.ObservableMap,defaultCalendars:new a.ObservableMap};t.a=Object(r.createStore)("calendarsCacheStore",c)},2173:function(e){e.exports=JSON.parse('{"c":"Xaa","e":"Yaa","f":"Zaa","d":"_aa","b":"$aa","g":"aba","a":"bba","j":"cba","h":"dba","i":"eba"}')},2174:function(e){e.exports=JSON.parse('{"a":"fba","b":"gba"}')},228:function(e,t,n){"use strict";n.d(t,"r",(function(){return u})),n.d(t,"t",(function(){return d})),n.d(t,"g",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"o",(function(){return f})),n.d(t,"p",(function(){return b})),n.d(t,"i",(function(){return v})),n.d(t,"f",(function(){return O})),n.d(t,"l",(function(){return p})),n.d(t,"h",(function(){return j})),n.d(t,"k",(function(){return I})),n.d(t,"m",(function(){return _})),n.d(t,"q",(function(){return m})),n.d(t,"n",(function(){return h})),n.d(t,"s",(function(){return g})),n.d(t,"e",(function(){return y})),n.d(t,"b",(function(){return E})),n.d(t,"u",(function(){return w})),n.d(t,"v",(function(){return C})),n.d(t,"x",(function(){return S})),n.d(t,"a",(function(){return A})),n.d(t,"j",(function(){return P})),n.d(t,"w",(function(){return x})),n.d(t,"y",(function(){return R})),n.d(t,"c",(function(){return T}));var r=n(0),a=n(214),c=n(489),i=n(114),o=n(446);function u(e){return e||(e=Object(i.e)().userIdentity),Object(a.a)().defaultCalendars.get(e)}function d(e,t){var n=u(t);return n&&e===n.id}function s(){var e=Object(a.a)().calendarEntryMapping;return Object(r.__spread)(e.values())}function l(){return s().map((function(e){return O(e.id.id)})).filter((function(e){return e}))}function f(){var e=Object(a.a)().calendarGroupsMapping;return Object(r.__spread)(e.values())}function b(e){return Object(a.a)().folderIdToCalendarId.get(e)}function v(e){return Object(a.a)().calendarEntryMapping.get(e)}function O(e){var t=v(e);return t?{id:{id:e,mailboxInfo:Object(r.__assign)({},t.id.mailboxInfo)},calculatedFolderId:y(e),displayName:t.CalendarName,colorScheme:null}:null}function p(e){return Object(a.a)().calendarFolderMapping.get(e.id.id)}function j(e){var t;return v(null===(t=null==e?void 0:e.id)||void 0===t?void 0:t.id)}function I(e){var t=b(e);return t?v(t.id):void 0}function _(e){var t=Object(a.a)().calendarFolderMapping,n=b(e);return n?t.get(n.id):void 0}function m(e){return Object(a.a)().calendarItemIdToChangeKey.get(e)}function h(e){return g(e.id.id)}function g(e){var t=Object(a.a)().calendarFolderMapping.get(e);return t&&(t.FolderId||t.DistinguishedFolderId)?t.FolderId?t.FolderId.Id:t.DistinguishedFolderId:y(e)}function y(e){var t=Object(a.a)().calendarEntryMapping.get(e);if(t){var n=Object(c.a)(t);return n?n.Id:null}return null}function E(e){return!!v(e)}function w(e){var t=Object(a.a)(),n=t.folderIdToCalendarId,r=t.calendarEntryMapping,c=n.get(e);if(c){var i=r.get(c.id);return i&&!i.IsGroupMailboxCalendar&&null!=i.CalendarFolderId}return!1}function C(e){if(w(e)){var t=I(e);return null==t?void 0:t.IsReadOnly}return!1}function S(e){var t=Object(a.a)().validEntryMapping;return e&&t.get(e.ItemId.Id)}function A(e){return!w(g(e))&&!S(v(e))}function P(e){var t,n=Object(a.a)(),c=n.folderIdToCalendarId,i=n.calendarEntryMapping,o=c.get(e);o?t=i.get(o.id):t=Object(r.__spread)(i.values()).filter((function(t){return t.OwnerEmailAddress&&t.OwnerEmailAddress.toLowerCase()==e.toLowerCase()}))[0];return t}function x(e){var t,n;return(null===(n=null===(t=null==e?void 0:e.id)||void 0===t?void 0:t.mailboxInfo)||void 0===n?void 0:n.type)==i.a.TeamsMailbox}function R(e,t){return[e,t].join(o.a)}function T(e){return e.split(o.a)[0]}},2427:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),a=n(240),c=n(483),i=n(665);function o(e,t,n,o){var u="read/"+(Object(a.n)(e.mailboxInfo.userIdentity)?"account/"+encodeURIComponent(e.mailboxInfo.userIdentity)+"/":"")+encodeURIComponent(e.Id);Object(c.c)("calendar",u,Object(r.__assign)(Object(r.__assign)({},n),{entrySource:t}),i.a,!1,t)}},281:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(7);function a(e,t,n){return Object(r.Rb)(e,Object(r.Db)(t),Object(r.yb)(t),Object(r.mb)(t),Object(r.sb)(n),Object(r.xb)(n),Object(r.zb)(n),Object(r.wb)(n))}},3041:function(e,t,n){"use strict";var r=n(4),a=Object(r.action)("updateUpNextEvent",(function(e,t){return{id:e,scenarioId:t}})),c={scenarios:new(n(24).ObservableMap)},i=Object(r.createStore)("UpNextStore",c);Object(r.mutator)(a,(function(e){i().scenarios.set(e.scenarioId,e.id)}));var o=n(983),u=n(0),d=n(1488),s=(Object(r.action)("cancelRefreshUpNextPoll",(function(e){return{scenarioId:e}})),Object(r.action)("onUpNextEventUpdated",(function(e,t,n){return{id:e,parentFolderId:t,scenarioId:n}}))),l=Object(r.action)("initializeUpNextEventLoader",(function(e,t){return{calendarIds:e,scenarioId:t}})),f=n(7);function b(){var e=Object(f.lc)(),t=Object(f.e)(e,1);return{start:e,end:Object(f.A)(t)}}var v=n(954),O=n(1007),p=n(1566),j=n(41);function I(e,t){void 0===t&&(t=!1);var n=Object(f.Qb)(),r=Object(u.__spread)(e);return t||r.sort(p.a),function(e,t){if(!e||0===e.length)return null;var n=_(t),r=e.filter((function(r,a){return!!n(r)&&!e.slice(a+1).some((function(e){return Object(f.Hb)(e.End,t)}))}));if(0===r.length)return null;if(1===r.length)return r[0];return r.reduce((function(e,n){if(0===e.length)return[n];var r=m(e[0].Start,t),a=m(n.Start,t);return a<r?[n]:a===r?(e.push(n),e):e}),[]).sort(p.b)[0]}(r,n)}function _(e){return function(t){var n=Object(f.Hb)(t.End,e),r=Object(f.w)(t.End,t.Start)>j.e,a=!Object(O.c)(t),c=Object(v.v)(t);return!n&&!r&&!t.IsAllDayEvent&&!t.IsCancelled&&!t.IsDraft&&"Decline"!==t.ResponseType&&a&&c}}function m(e,t){return Math.abs(Object(f.w)(e,t))}var h=n(1102);function g(e){var t=b();return Object(d.c)(e,t).filter(Object(h.d)(t))}var y=n(555);function E(e,t){var n=Object(y.i)();return t.ItemId.Id!==e.ItemId.Id&&(Object(p.e)(t,e)&&!Object(f.Fb)(t.Start,e.Start)&&_(n)(t))}function w(e){return i().scenarios.get(e)}function C(e){var t=w(e);return t?function(e,t){return g(e).filter((function(e){return e.ItemId.Id===t.Id}))[0]||null}(e,t):null}function S(e){var t=C(e);if(!t)return{upNextEvent:null,conflictingEvents:[]};var n=g(e).filter((function(e){return E(t,e)}));return{upNextEvent:t,conflictingEvents:n}}function A(e){var t=C(e);if(!t)return{upNextEvent:null,eventsWithinUpNextEvent:[]};var n=g(e).filter((function(e){return function(e,t){if(t.ItemId.Id===e.ItemId.Id||!t.IsOnlineMeeting||null===t.OnlineMeetingJoinUrl)return!1;var n=Object(f.Nb)(Object(f.fc)(Object(f.Qb)(),1),t.Start,t.End),r=Object(f.Nb)(Object(f.Qb)(),t.Start,t.End),a=Object(f.w)(t.End,t.Start)>j.e;return(n||r)&&!a&&!t.IsAllDayEvent&&!t.IsCancelled&&!t.IsDraft&&"Decline"!==t.ResponseType&&!Object(O.c)(t)&&Object(v.v)(t)}(t,e)}));return{upNextEvent:t,eventsWithinUpNextEvent:n}}function P(e){return i().scenarios.has(e)}function x(){return Object(u.__spread)(i().scenarios.keys())}function R(e){return Object(u.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(u.__generator)(this,(function(r){return t=function(e){return I(g(e),!0)}(e),n=t?t.ItemId:null,w(e)===n?[2]:(a(n,e),s(n,t?t.ParentFolderId:null,e),[2])}))}))}function T(){x().forEach(R)}Object(r.orchestrator)(o.b,(function(){T()})),Object(r.orchestrator)(o.c,(function(){T()})),Object(r.orchestrator)(o.a,(function(){T()})),Object(r.orchestrator)(l,(function(e){var t=e.calendarIds,n=e.scenarioId,r=b();P(n)||a(null,n),Object(d.h)(t,r,n)}));var F=n(1352);Object(r.orchestrator)(d.a,(function(e){return Object(u.__awaiter)(void 0,void 0,void 0,(function(){var t;return Object(u.__generator)(this,(function(n){switch(n.label){case 0:return P(t=e.scenarioId)?[4,R(t)]:[3,2];case 1:n.sent(),Object(F.b)((function(){return function(e){return Object(u.__awaiter)(this,void 0,void 0,(function(){return Object(u.__generator)(this,(function(t){switch(t.label){case 0:return[4,R(e)];case 1:return t.sent(),[2,null]}}))}))}(t)}),t,1e4),n.label=2;case 2:return[2]}}))}))}));Object(r.orchestrator)(d.k,(function(e){var t=e.scenarioId;P(t)&&R(t)})),Object(r.orchestrator)(y.l,(function(){x().forEach((function(e){return Object(d.m)(b(),e)}))})),Object(r.orchestrator)(d.j,(function(e){var t=e.scenarioId;P(t)&&R(t)}));n.d(t,"h",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"j",(function(){return d.l})),n.d(t,"a",(function(){return C})),n.d(t,"b",(function(){return w})),n.d(t,"c",(function(){return S})),n.d(t,"d",(function(){return A})),n.d(t,"g",(function(){return P})),n.d(t,"f",(function(){return E})),n.d(t,"i",(function(){return T}))},321:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(7),a=n(281);function c(e,t,n,c){var i=Object(a.a)(t,n,c);return Object(r.Fb)(e,i)&&(i=Object(r.Rb)(t,e)),{start:e,end:i}}},348:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(376),a=n(4),c=n(423),i=n(3),o={state:r.a.NotStarted,isPopoutV2:Object(i.a)(c.a)==c.b},u=Object(a.createStore)("popoutChild",o);u()},355:function(e,t,n){"use strict";n.d(t,"g",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"k",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return s})),n.d(t,"n",(function(){return l})),n.d(t,"l",(function(){return f})),n.d(t,"m",(function(){return b})),n.d(t,"a",(function(){return v})),n.d(t,"h",(function(){return O})),n.d(t,"b",(function(){return p})),n.d(t,"e",(function(){return j})),n.d(t,"j",(function(){return I})),n.d(t,"i",(function(){return _})),n.d(t,"o",(function(){return m}));var r=n(117),a=n(145),c=n(7);function i(e,t){return void 0===t&&(t=Object(c.Qb)()),d(Object(c.bc)(t,e),r.a.DaysInOneWeek)}function o(e,t){var n=u(e,t),r=Object(c.B)(e),a=Object(c.e)(Object(c.C)(r,t),1);return d(n,Math.abs(Object(c.s)(n,a)-1))}function u(e,t){var n=Object(c.ac)(e);return Object(c.bc)(n,t)}function d(e,t){return{start:e,end:Object(c.e)(e,t-1)}}function s(e,t,n,r,o){switch(void 0===o&&(o=1),e){case a.a.Day:return d(Object(c.Xb)(t),o);case a.a.Month:var u=Object(c.ac)(t),s=Object(c.B)(t);return d(u,Math.abs(Object(c.s)(u,s)-1));case a.a.Week:return i(n,t);case a.a.WorkWeek:return function(e,t,n){void 0===n&&(n=Object(c.Qb)());for(var r,a,o=i(e,n),u=0;u<=I(o);u++){var d=Object(c.e)(o.start,u);if(!r&&t.includes(Object(c.ob)(d))&&(r=d),d=Object(c.e)(o.end,-u),!a&&t.includes(Object(c.ob)(d))&&(a=d),r&&a)break}return{start:r,end:a}}(n,r,t)}}function l(e,t){var n=o(e,t);return Object(c.t)(n.end,n.start,t)}function f(e,t){var n;return d(n=t==a.a.WorkWeek?Object(c.k)(e.start,1):Object(c.e)(e.end,1),t==a.a.Month?Object(c.pb)(n):Object(c.s)(e.end,e.start)+1)}function b(e,t){var n,r;if(t==a.a.WorkWeek)n=Object(c.k)(e.start,-1),r=Object(c.k)(e.end,-1);else{r=Object(c.e)(e.start,-1);var i=t==a.a.Month?-Object(c.pb)(r):Object(c.s)(e.start,e.end)-1;n=Object(c.e)(e.start,i)}return{start:n,end:r}}function v(e,t){return e&&t&&0==Object(c.p)(e.start,t.start)&&0==Object(c.p)(e.end,t.end)}function O(e,t,n){if(!e||!t)throw new Error("Date ranges cannot be null in call to areDateRangesOverlapping");return n?Object(c.p)(e.start,t.start)<=0?Object(c.p)(e.end,t.start)>=0?0:1:Object(c.p)(t.end,e.start)>=0?0:-1:Object(c.p)(e.start,t.start)<0?Object(c.p)(e.end,t.start)>0?0:1:Object(c.p)(t.end,e.start)>0?0:-1}function p(e,t,n){return!(!e||!t)&&(n?Object(c.p)(e.start,t.start)<=0&&Object(c.p)(e.end,t.end)>=0:Object(c.p)(e.start,t.start)<0&&Object(c.p)(e.end,t.end)>0)}function j(e,t){return e&&t?{start:Object(c.p)(e.start,t.start)<0?e.start:t.start,end:Object(c.p)(e.end,t.end)>0?e.end:t.end}:null}function I(e){return Object(c.s)(e.end,e.start)}function _(e){return Math.floor(Object(c.v)(e.end,e.start)/24)+(Object(c.v)(e.end,e.start)%24>0?1:0)}function m(e,t){return Object(c.s)(e.start,t)<=0&&Object(c.s)(e.end,t)>=0}},376:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.NotStarted=0]="NotStarted",e[e.Loading=1]="Loading",e[e.Ready=2]="Ready"}(r||(r={}))},390:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(7),a=n(281);function c(e,t,n){if(e&&t&&n){var c=Object(r.x)(t,e),i=Object(a.a)(e.tz,n,e);return{start:i,end:Object(r.Rb)(t.tz,Object(r.h)(i,c))}}return null}},391:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(7),a=n(281);function c(e,t,n,c){if(e&&t&&n){var i=Object(a.a)(e.tz,e,n),o=t;if(!Object(r.Hb)(i,t)||c){var u=Object(r.x)(t,e);o=Object(r.Rb)(t.tz,Object(r.h)(i,u))}return{start:i,end:o}}return null}},392:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(321);function a(e,t,n){return e&&t&&n?Object(r.a)(e,t.tz,t,n):null}},393:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(321);function a(e,t,n){return e&&t&&n?Object(r.a)(e,t.tz,n,t):null}},394:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(355),a=n(7);function c(e,t){return e&&null!=t?Object(r.c)(Object(a.Xb)(e),t+1):null}},411:function(e,t,n){"use strict";var r=n(355),a=n(7);function c(e,t,n){return Object(a.Nb)(e,t,n)}var i=n(117);function o(e,t){return function(e){var t=e%i.a.SecondsInOneMinute;return e-t+i.a.SecondsInOneMinute}(Object(a.y)(e,t))}var u=15*i.a.SecondsInOneMinute;function d(e,t){return o(e,t)<=u}var s=n(145),l=function(e,t,n){switch(n){case s.c.FirstFullWeek:return f(e,t,i.a.DaysInOneWeek);case s.c.FirstFourDayWeek:return f(e,t,4);default:return function(e,t){var n=b(e)-1,r=(Object(a.ob)(e)-n%i.a.DaysInOneWeek-t+2*i.a.DaysInOneWeek)%i.a.DaysInOneWeek;return Math.floor((n+r)/i.a.DaysInOneWeek+1)}(e,t)}};function f(e,t,n){var r=b(e)-1,c=Object(a.ob)(e)-r%i.a.DaysInOneWeek,o=b(Object(a.mc)(Object(a.Db)(e)-1,s.d.December,31))-1,u=(t-c+2*i.a.DaysInOneWeek)%i.a.DaysInOneWeek;0!==u&&u>=n&&(u-=i.a.DaysInOneWeek);var d=r-u;return d<0&&(0!==(u=(t-(c-=o%i.a.DaysInOneWeek)+2*i.a.DaysInOneWeek)%i.a.DaysInOneWeek)&&u+1>=n&&(u-=i.a.DaysInOneWeek),d=o-u),Math.floor(d/i.a.DaysInOneWeek+1)}function b(e){for(var t=Object(a.yb)(e),n=Object(a.Db)(e),r=0,c=0;c<t;c++)r+=v(c+1,n);return r+=Object(a.mb)(e)}function v(e,t){return Object(a.pb)(Object(a.mc)(t,e,0))}n(391),n(390),n(392),n(393),n(394);function O(e){for(var t=[],n=0;n<i.a.DaysInOneWeek;n++)e&1<<n&&t.push(n);return t}n.d(t,"h",(function(){return r.g})),n.d(t,"g",(function(){return r.f})),n.d(t,"m",(function(){return r.k})),n.d(t,"d",(function(){return r.c})),n.d(t,"e",(function(){return r.d})),n.d(t,"r",(function(){return r.n})),n.d(t,"n",(function(){return r.l})),n.d(t,"o",(function(){return r.m})),n.d(t,"b",(function(){return r.a})),n.d(t,"j",(function(){return r.h})),n.d(t,"c",(function(){return r.b})),n.d(t,"f",(function(){return r.e})),n.d(t,"l",(function(){return r.j})),n.d(t,"k",(function(){return r.i})),n.d(t,"s",(function(){return r.o})),n.d(t,"t",(function(){return c})),n.d(t,"u",(function(){return d})),n.d(t,"p",(function(){return o})),n.d(t,"q",(function(){return l})),n.d(t,"a",(function(){return i.a})),n.d(t,"i",(function(){return O}))},414:function(e,t,n){"use strict";var r="LinkedCalendarEntry:#Exchange";function a(e){return(null==e?void 0:e.__type)==r}function c(e){return(null==e?void 0:e.__type)==r&&!(null==e?void 0:e.IsGroupMailboxCalendar)}function i(e){return e.CanViewPrivateItems||a(e)}n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return"TeamsCalendarEntry:#Exchange"})),n.d(t,"c",(function(){return i}))},420:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return u}));var r=n(273),a=n(303),c=n(302),i=n(296);function o(e){return Object(r.a)({RequestServerVersion:"Exchange2015",TimeZoneContext:Object(a.a)({TimeZoneDefinition:Object(c.a)({Id:null!=e?e:"Pacific Standard Time"})})})}function u(e,t,n){return Object(i.a)({PropertySetId:e,PropertyName:t,PropertyType:n})}},423:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return c}));var r="popoutv2",a="1",c="_owa_projection_root"},446:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="_CHANNELTEAMSTYPE_"},448:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o}));var r,a=2,c=[window.location.origin];function i(e,t,n){var r={version:a,type:t,serializedData:JSON.stringify(n)};e.postMessage(JSON.stringify(r),"*")}function o(e){if(c.indexOf(e.origin)>=0){var t=void 0;try{t=JSON.parse(e.data)}catch(e){return null}if(t&&a==t.version)return t}return null}!function(e){e[e.Unknown=0]="Unknown",e[e.PopoutReady=1]="PopoutReady",e[e.SetData=2]="SetData",e[e.CloseWindow=3]="CloseWindow"}(r||(r={}))},450:function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return l}));var r=n(108),a=n(3),c=n(76),i=new r.c((function(){return Promise.all([n.e(714),n.e(435)]).then(n.bind(null,919))}),!0),o=new r.a(i,(function(e){return e.tryGetCalendarViewOffline})),u=new r.a(i,(function(e){return e.onGetCalendarViewResponse})),d=new r.a(i,(function(e){return e.tryGetCalendarFoldersOffline})),s=new r.a(i,(function(e){return e.onGetCalendarFoldersResponse}));function l(){return Object(c.h)("fwk-offline-services")&&Object(a.d)("offlineboot",window.location)}},4749:function(e,t,n){"use strict";var r,a=n(4),c=Object(a.action)("UPDATE_SELECTED_TIME_PANEL_CALENDARIDS_IN_STORE",(function(e,t){return{calendarIds:e,userIdentity:t}})),i=Object(a.action)("SET_TIME_PANEL_CONFIG_LOAD_STATE",(function(e,t){return{loadState:e,userIdentity:t}})),o=Object(a.action)("UPDATE_SELECTED_TIME_PANEL_CALENDARIDS",(function(e,t){return{calendarIds:e,userIdentity:t}})),u=Object(a.action)("ON_SELECTED_TIME_PANEL_CALENDARIDS_UPDATED");!function(e){e[e.Loaded=0]="Loaded",e[e.Failed=1]="Failed"}(r||(r={}));var d=n(76),s=n(1984),l=(Object(a.orchestrator)(s.b,(function(e){Object(d.h)("cal-time-panel-calendarPicker")&&(i(r.Failed,e.userIdentity),u())})),n(24)),f=Object(a.createStore)("timePanelSelectedCalendarIdsStore",{configLoadStates:new l.ObservableMap,calendarIdsMap:new l.ObservableMap}),b=n(1206);function v(){return Object(b.c)(f().calendarIdsMap)}function O(e){return e?function(e){var t=v().get(e);return t?t.length:0}(e):Object(b.d)(v()).length}function p(){return!!Object(d.h)("cal-time-panel-calendarPicker")&&O()>0}var j=n(1581),I=(Object(a.orchestrator)(j.f,(function(){p()||u()})),n(0));function _(){return f().configLoadStates}function m(){if(!Object(d.h)("cal-time-panel-calendarPicker"))return Object(j.b)();var e=_(),t=0===e.size,n=Object(I.__spread)(e.values()).some((function(e){return e===r.Loaded}));return t||n&&p()?v():Object(j.b)()}var h=n(515),g=n(79),y=n(103),E=n(114),w=Object(h.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(h.a)(1e3)}),C={};Object(a.orchestrator)(o,(function(e){return Object(I.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(I.__generator)(this,(function(r){switch(r.label){case 0:return t=e.calendarIds,n=e.userIdentity,Object(E.e)().userIdentity===n&&1===O()&&1===O(n)&&0===t.length?[2]:p()?[3,2]:[4,S()];case 1:r.sent(),r.label=2;case 2:return A(t,n),[2]}}))}))}));function S(){return Object(I.__awaiter)(this,void 0,void 0,(function(){return Object(I.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all(Object(y.g)().map((function(e){var t;A(null!==(t=Object(j.b)().get(e))&&void 0!==t?t:[],e,!0)})))];case 1:return e.sent(),[2]}}))}))}function A(e,t,n){var r;return Object(I.__awaiter)(this,void 0,void 0,(function(){var a,i,o,d;return Object(I.__generator)(this,(function(l){switch(l.label){case 0:a=Object(b.b)(e),i=m().get(t),l.label=1;case 1:return l.trys.push([1,3,4,5]),c(a,t),n||u(),null===(r=C[t])||void 0===r||r.cancel(),o=w((function(){return Object(s.g)(a,t)})),C[t]=o,[4,o.retriableFunc()];case 2:return l.sent(),[3,5];case 3:return d=l.sent(),g.g.warn("updateSelectedCalendarIdsOrchestrator: updateTimePanelCalendarIdsService with retry failed: "+d),c(i,t),n||u(),[3,5];case 4:return delete C[t],[7];case 5:return[2]}}))}))}Object(a.orchestrator)(s.i,(function(e){var t;if(Object(d.h)("cal-time-panel-calendarPicker")){var n=e.settings,a=e.userIdentity;i(r.Loaded,a),(null===(t=n.timePanelCalendarIds)||void 0===t?void 0:t.length)>0&&c(n.timePanelCalendarIds,a),u()}})),Object(a.mutator)(i,(function(e){var t=e.userIdentity,n=e.loadState;f().configLoadStates.set(t,n)})),Object(a.mutator)(c,(function(e){var t=e.calendarIds,n=e.userIdentity;f().calendarIdsMap.set(n,Object(b.b)(t))}));function P(){return Object(b.d)(m())}n.d(t,"e",(function(){return o})),n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return _})),n.d(t,"c",(function(){return m})),n.d(t,"b",(function(){return P}))},483:function(e,t,n){"use strict";var r=n(108),a=n(584),c=n(487),i=n(42),o=n(1),u=n(486),d=n(348),s=n(76),l=n(376),f=n(905),b=n(715),v=Object(i.a)((function(e){o.useEffect((function(){Object(s.h)("rp-popoutsDebug")||O()}),[]);return o.createElement("div",{className:b.view},Object(d.a)().state==l.a.Loading?o.createElement("span",null,o.createElement(f.a,null),e.loadingString):o.createElement("button",{onClick:O},"Get Data"))}));function O(){Object(u.a)()}var p=n(114);function j(e,t,n,r){var a="";if(r)a="readimid/",a+=encodeURIComponent(btoa(r));else{if(a=n?"readconv/":"read/",e&&e.type==p.a.GroupMailbox){a+="group/";var c=e.mailboxSmtpAddress.split("@");a+=c[1]+"/"+c[0]+"/"}a+=encodeURIComponent(n||t)}return a}n.d(t,"g",(function(){return _})),n.d(t,"c",(function(){return a.a})),n.d(t,"h",(function(){return c.a})),n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return l.a})),n.d(t,"f",(function(){return d.a})),n.d(t,"d",(function(){return u.b})),n.d(t,"e",(function(){return j}));var I=new r.c((function(){return n.e(474).then(n.bind(null,15071))})),_=new r.b(I,(function(e){return e.bootPopout}))},486:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return l}));var r,a=n(0),c=n(487),i=n(448),o=n(376),u=n(348),d=!1;function s(){Object(c.a)(o.a.Loading),r?r():d=!0}function l(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(t){switch(t.label){case 0:return d?[3,2]:[4,new Promise((function(e){r=function(){e()}}))];case 1:t.sent(),t.label=2;case 2:return[2,Object(u.a)().isPopoutV2?new Promise((function(t,n){var r=function(n){var a=Object(i.b)(n);if(a&&a.type==i.a.SetData){window.removeEventListener("message",r);var c=void 0;try{c=e?e(a.serializedData):JSON.parse(a.serializedData)}catch(e){}t(c)}};window.addEventListener("message",r);try{var a=window.opener;Object(i.c)(a,i.a.PopoutReady,null)}catch(e){t(null)}})):Promise.resolve(null)]}}))}))}},487:function(e,t,n){"use strict";var r=n(348),a=n(4);t.a=Object(a.mutatorAction)("setPopoutChildState",(function(e){Object(r.a)().state=e}))},489:function(e,t,n){"use strict";function r(e){if(void 0!==e.CalendarFolderId)return e.CalendarFolderId;var t=e;return t.IsGeneralScheduleCalendar?{Id:t.OwnerEmailAddress,ChangeKey:""}:t.SharedFolderId?{Id:t.SharedFolderId.Id,ChangeKey:null!=t.SharedFolderId.ChangeKey?t.SharedFolderId.ChangeKey:""}:null}n.d(t,"a",(function(){return r}))},515:function(e,t,n){"use strict";function r(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var t=e.maximumAttempts,n=e.timeBetweenRetryInMS;return function(e){var r=0,a=!1,c=function(i,o){a?o(new Error("The function retry was cancelled")):(r++,e().then((function(e){return i(e)})).catch((function(e){t&&r>=t?o(e):setTimeout((function(){return c(i,o)}),n(r))})))};return{retriableFunc:function(){return new Promise((function(e,t){return c(e,t)}))},cancel:function(){return a=!0}}}}function a(e){return function(t){return Math.pow(2,t)*e}}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},518:function(e,t,n){"use strict";var r=n(0),a=n(7),c=n(650),i=n(651),o=n(652),u=n(653),d=n(654),s=n(656),l=n(246),f=n(585),b=n(76),v=n(315);function O(e,t,n,O,p,j,I){return Object(r.__awaiter)(this,void 0,void 0,(function(){var _,m,h;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return _=Object(l.a)(),p&&(_.TimeZoneContext.TimeZoneDefinition.Id=p),h=null,j?[4,Object(v.e)(j)]:[3,2];case 1:h=r.sent(),r.label=2;case 2:return r.trys.push([2,,4,5]),[4,Object(s.a)({request:{Header:_,Body:Object(u.a)({MailboxDataArray:n.map((function(e){return Object(d.a)({Email:Object(i.a)({Address:e})})})),FreeBusyViewOptions:Object(o.a)({RequestedView:O,TimeWindow:Object(c.a)({StartTime:Object(a.rb)(e),EndTime:Object(a.rb)(t)}),MergedFreeBusyIntervalInMinutes:I})})}},h)];case 3:return m=r.sent(),[3,5];case 4:return Object(b.h)("cal-mf-diagnostics")&&Object(f.a)({action:"GetUserAvailabilityInternal",status:m?m.Body.ResponseCode:"Error",response:null==m?void 0:m.Body}),[7];case 5:return[2,m.Body]}}))}))}var p=n(311),j=n(79),I=n(589),_=Object(I.a)(4),m=function(e){var t={};return e.forEach((function(e){return t[e]={FreeBusyViewType:"None"}})),t};function h(e,t,n,a,c,i,o){return void 0===c&&(c=!0),Object(r.__awaiter)(this,void 0,void 0,(function(){var u,d,s,l,f,b,v;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(0===n.length)return[2];(u=new p.a("FreeBusyAvailabilityRequested")).addCustomData({numAttendees:n.length}),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,_.add((function(){return O(e,t,n,"DetailedMerged",e.tz,i,o)}))];case 2:return d=r.sent(),u.addCustomData({executingRequests:_.getRunningCount(),queuedRequests:_.getQueueLength()}),u.end(),s="Success"===d.ResponseClass&&n.length===d.Responses.length,l={},s?n.forEach((function(e,t){l[e]=d.Responses[t].CalendarView})):l=m(n),c&&(f=s?Object.keys(l).filter((function(e){return"None"==l[e].FreeBusyViewType})):n).length>0&&h(e,t,f,a,!1,i,o),a(l),[3,4];case 3:return b=r.sent(),u.endWithError("ServerError",b),j.g.warn('[getAvailabilityFunction] Received error calling getUserAvailabilityService, Error: "'+b.stack+'"'),c?h(e,t,n,a,!1,i,o):(v=m(n),a(v)),[3,4];case 4:return[2]}}))}))}n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return O}))},520:function(e,t,n){"use strict";var r,a=n(4),c=Object(a.createStore)("cacheLoaderStore",{loadedCalendarAccounts:[]});!function(e){e[e.Outlook=0]="Outlook",e[e.OutlookGroup=1]="OutlookGroup",e[e.TeamsCalendars=2]="TeamsCalendars"}(r||(r={}));var i=n(314),o=n(114);function u(e,t){switch(e){case r.Outlook:case r.OutlookGroup:return(t||Object(o.e)().userIdentity)+e.toString();case r.TeamsCalendars:return e.toString();default:return Object(i.a)(e)}}function d(e,t){var n=u(e,t);return c().loadedCalendarAccounts.some((function(e){return e===n}))}var s=Object(a.action)("addToLoadedCalendarAccounts",(function(e){return{calendarAccountData:e}}));Object(a.mutator)(s,(function(e){c().loadedCalendarAccounts.push(e.calendarAccountData)}));var l=n(646),f=n(79),b=Object(a.action)("calendarCacheInitializedForAccount",(function(e,t){return{calendarEndpointType:e,userId:t}})),v=n(0),O=n(614),p=n(679),j=n(108),I=new j.c((function(){return Promise.all([n.e(19),n.e(26),n.e(564)]).then(n.bind(null,15362))})),_=new j.a(I,(function(e){return e.initializeSelectedTeamsCalendars}));var m=n(515),h=Object(m.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(m.a)(1e4)}),g={};function y(e,t){if(t=t||Object(o.e)().userIdentity,d(e,t))return Promise.resolve();var n=u(e,t),a=g[n];if(a)return a.requestPromise;var c=h((function(){return function(e,t){return Object(v.__awaiter)(this,void 0,void 0,(function(){return Object(v.__generator)(this,(function(n){switch(n.label){case 0:switch(e){case r.Outlook:return[3,1];case r.OutlookGroup:return[3,3];case r.TeamsCalendars:return[3,5]}return[3,7];case 1:return[4,Object(O.f)(t)];case 2:return n.sent(),[3,8];case 3:return[4,Object(p.b)(t)];case 4:return n.sent(),[3,8];case 5:return[4,_.importAndExecute()];case 6:return n.sent(),[3,8];case 7:Object(i.a)(e),n.label=8;case 8:return[2]}}))}))}(e,t)})).retriableFunc();return g[n]={requestPromise:c},c.then((function(){s(n),b(e,t)})).catch((function(e){f.d("initializeCalendarsCacheForAccount: failed to initialize calendar cache",e)}))}var E=n(76);Object(a.orchestrator)(l.d,(function(e){y(r.Outlook,e.userIdentity),Object(E.h)("cal-multiAccounts-groups")&&y(r.OutlookGroup,e.userIdentity)}));var w=n(240);function C(){return Object(v.__awaiter)(this,void 0,void 0,(function(){var e,t,n,a,c,i;return Object(v.__generator)(this,(function(o){switch(o.label){case 0:return e=y(r.Outlook),t=Object(w.i)().map((function(e){return y(r.Outlook,e.userIdentity)})),n=y(r.OutlookGroup),a=y(r.TeamsCalendars),c=Object(v.__spread)([e,n],t,[a]),Object(E.h)("cal-multiAccounts-groups")&&(i=Object(w.i)().map((function(e){return y(r.OutlookGroup,e.userIdentity)})),c=c.concat(i)),[4,Promise.all(c)];case 1:return o.sent(),[2]}}))}))}n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return y})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return C}))},584:function(e,t,n){"use strict";var r=n(0),a=n(49),c=600,i=800,o=8,u=25,d={location:!1,menubar:!1,resizable:!0,scrollbars:!1,status:!1,toolbar:!1},s=-1;function l(e,t){try{t=function(e){var t=u*(1+(s=(s+1)%o)),n={left:window.screenX+t,top:window.screenY+t,height:Math.max(25*Math.pow(window.innerHeight,.5),c),width:Math.max(8*Math.pow(window.innerWidth,2/3),i)};return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},d),n),e)}(t);var n=window.open(e,"_blank",function(e){return Object.getOwnPropertyNames(e).map((function(t){return t+"="+("boolean"==typeof(n=e[t])?n?"1":"0":n?String(n):void 0);var n})).join(",")}(t));return(Object(a.e)()||Object(a.f)())&&n.moveTo(t.left,t.top),n}catch(e){return null}}var f=n(2),b=n(556),v=n(423),O="version";var p=n(123),j=n(483);t.a=Object(p.d)("addPopoutV2",{name:"PopoutAddPopout",customData:function(e,t,n,r,a,c){return[(t||"").split("/")[0],c]}})((function(e,t,n,r,c,i,o){var u=function(e){var t=null,n=void 0,r=null;return e&&(!function(e){return void 0!==e.deeplinkData||!!e.projectionTabId}(e)?n=e:(n=e.deeplinkData,(Object(a.e)()||Object(a.h)()||Object(a.f)())&&(t=e.projectionTabId||null),r=e.projectionTargetWindow)),{deeplinkCallback:void 0===n?function(){return Promise.resolve(null)}:"function"==typeof n?n:function(){return Promise.resolve(n)},projectionTabId:t,projectionTargetWindow:r}}(n),d=u.deeplinkCallback,s=u.projectionTabId,p=u.projectionTargetWindow,I=s?"about:blank":function(e,t,n,r){var a;void 0===r&&(r={});var c=((a={})[O]=Object(f.j)(),a[v.a]=v.b,a);return Object.keys(r).map((function(e){c[e]=r[e]})),Object(b.q)(e,t,n,c)}(e,t,c,o),_=p||l(I,r);_&&j.g.import().then((function(t){return t(e,_,s,d)}))}))},585:function(e,t,n){"use strict";var r=n(587);n.d(t,"a",(function(){return r.a}))},587:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),a=Object(r.action)("logServiceCallForDiagnostics",(function(e){return{serviceCall:e}}))},589:function(e,t,n){"use strict";function r(e){var t=0,n=[];function r(){t-=1,n.length>0&&n.shift()()}return{add:function(a){return new Promise((function(c,i){var o=function(){t+=1,a().then((function(e){r(),c(e)}),(function(e){r(),i(e)}))};t===e?n.push(o):o()}))},getRunningCount:function(){return t},getQueueLength:function(){return n.length}}}n.d(t,"a",(function(){return r}))},594:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"RecurringMasterItemId:#Exchange"},e)}},611:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"GetUserUnifiedGroupsRequest:#Exchange"},e)}},612:function(e,t,n){"use strict";var r=n(25),a=n(0);function c(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(a.__assign)({__type:"GetUserUnifiedGroupsJsonRequest:#Exchange"},n)),Object(r.a)("GetUserUnifiedGroups",e,t)}n.d(t,"a",(function(){return c}))},613:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return i}));var r=n(4),a=Object(r.action)("initializeOwaAccountsStore"),c=Object(r.action)("owaConnectedAccountAdded",(function(e,t){return{userIdentity:e,accountProviderType:t}})),i=Object(r.action)("removeAccount",(function(e){return{userIdentity:e}}))},614:function(e,t,n){"use strict";var r=n(0),a=n(160),c=n(114),i=n(27),o=n(414),u=n(79);function d(e,t,n){var d,s={},l={},f={},b={},v={},O=n?[n]:[Object(i.a)().SessionSettings.LogonEmailAddress],p=Object(c.e)(n);return e.forEach((function(e){v[e.ItemId.Id]=e.ItemId.ChangeKey;var n=Object(r.__assign)(Object(r.__assign)({},e),{id:{id:e.GroupId,mailboxInfo:p}}),c=Object(a.s)(p.userIdentity,e.GroupId);b[c]=n,e.Calendars.forEach((function(e){if(function(e,t){if(7==e.CalendarFolderType)return!1;if(Object(o.d)(e)){var n=e;if(n.IsOwnerEmailAddressInvalid)return u.g.info("[getCalendarsService] Ommitting shared calendar with IsOwnerEmailAddressInvalid flag on, OwnerEmailAddress: {1}: "+n.OwnerEmailAddress),!1;var r=n.IsGeneralScheduleCalendar?n.OwnerEmailAddress:n.SharedFolderId?n.SharedFolderId.Id:null;if(!r)return u.g.info("[getCalendarsService] Ommitting linked calendar with null SharedFolderId, Id: {1}: "+e.ItemId.Id),!1;if(t.includes(r))return u.g.info("[getCalendarsService] Ommitting duplicate shared calendar from Calendar folder list. DuplicateKey: {1}: "+r),!1;if(t.push(r),n.OwnerEmailAddress=n.OwnerEmailAddress.toLowerCase(),n.IsGroupMailboxCalendar)return!1}return!0}(e,O)){var n=e.ItemId.Id,c=Object(a.h)(e).Id,i=Object(r.__assign)(Object(r.__assign)({},e),{id:{id:n,mailboxInfo:p}});if(1==e.CalendarFolderType){var l=t&&t.filter((function(e){return e.FolderId.Id===c}))[0];d={id:{id:n,mailboxInfo:p},calculatedFolderId:c,displayName:l?l.DisplayName:e.CalendarName,colorScheme:null},i.CalendarName=d.displayName}!s[n]&&(s[n]=i),!f[c]&&(f[c]={id:e.ItemId.Id,mailboxInfo:p}),!v[n]&&(v[n]=e.ItemId.ChangeKey)}}))})),t.forEach((function(e){var t=f[e.FolderId.Id];t&&(l[t.id]=e)})),{defaultCalendar:d,calendarEntryMapping:s,calendarFolderMapping:l,folderIdMapping:f,calendarGroupMapping:b,calendarIdToChangeKeyMapping:v}}var s=n(667),l=n(246),f=n(670),b=n(103),v=n(315),O=n(450);function p(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=null,n=null,e&&!Object(b.v)(e)||(t=Object(f.a)()),t?[3,7]:[4,Object(v.e)(Object(c.e)(e))];case 1:n=r.sent(),r.label=2;case 2:return r.trys.push([2,4,,7]),[4,Object(s.a)({Header:Object(l.a)()},n)];case 3:return t=r.sent(),[3,7];case 4:return r.sent(),Object(O.a)()?[4,O.d.importAndExecute(e)]:[3,6];case 5:t=r.sent(),r.label=6;case 6:return[3,7];case 7:return t&&Object(O.a)()?n?[3,9]:[4,Object(v.e)(Object(c.e)(e))]:[3,11];case 8:n=r.sent(),r.label=9;case 9:return[4,O.b.importAndExecute({userIdentity:e,options:n},t)];case 10:r.sent(),r.label=11;case 11:return[2,t]}}))}))}var j=n(297),I=n(673);function _(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,o,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(v.e)({type:c.a.GroupMailbox,userIdentity:n,mailboxSmtpAddress:t,routingKey:null,requestOptions:null})];case 1:return i=r.sent(),o=Object(a.o)(e.Id),u=o&&(o.IsGeneralScheduleCalendar||o.IsGroupMailboxCalendar)?Object(j.a)({Id:"calendar",Mailbox:{EmailAddress:t}}):5==o.CalendarFolderType?o.SharedFolderId:e,[4,Object(I.a)({request:{FolderId:u}},i)];case 2:return[2,r.sent()]}}))}))}var m=n(431),h=n(254),g=n(4),y=Object(g.action)("calendarFolderIdUpdated"),E=Object(g.action)("setCalendarLoadState",(function(e,t){return{calendarId:e,loadState:t}}));function w(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),E(e,"Loading"),[4,C(e)];case 1:return n.sent(),[3,3];case 2:return(t=n.sent()).message&&(t.message.indexOf("ErrorApiQuarantined")>=0||t.message.indexOf("ErrorTooManyObjectsOpened")>=0)?E(e,"Throttled"):E(e,"Failed"),[3,3];case 3:return[2]}}))}))}function C(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,o,u,d,s,l,f,O,p;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(!(t=Object(a.m)(e)))throw new Error("Unable to get calendar entry for calendar "+e);n=Object(a.x)(e),i=Object(a.i)(e),o=Object(a.u)(n),u=o?o.mailboxInfo:Object(c.e)(),d=Object(a.L)(t),O=Object(a.t)().filter((function(e){return e.GroupId==t.ParentGroupId})),f=O?O[0].id.mailboxInfo.userIdentity:Object(c.e)().userIdentity,5==t.CalendarFolderType&&Object(b.i)().SessionSettings.DefaultPublicFolderMailbox?s=Object(b.i)().SessionSettings.DefaultPublicFolderMailbox:(p=function(e,t){return e||(t?t.userIdentity:null)}(t.OwnerEmailAddress,u),s=d?Object(a.f)(p):p),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,_(Object(m.a)({Id:i}),s,f)];case 2:return l=r.sent(),[3,4];case 3:return r.sent(),Object(h.o)("getCalendarFolderConfigurationServiceFailed"),Object(a.P)(t),[2];case 4:if(!l)throw new Error("Unable to get folder for calendar "+e);return(Object(a.P)(t),5==t.CalendarFolderType?function(e,t,n){var r=e.CalendarFolder;if(r){t.CalendarFolderId||(t.CalendarFolderId=e.CalendarFolder.FolderId);var i=r.ReplicaList[0];Object(a.b)(t,r,(o=n,u=i,{type:c.a.UserMailbox,userIdentity:Object(c.e)().userIdentity,mailboxSmtpAddress:u,routingKey:Object(c.c)()+u,requestOptions:Object(v.a)(u,o)}))}var o,u}(l,t,u):function(e,t,n,r,c){var i,o,u=e.CalendarFolder;c&&(null===(i=null==u?void 0:u.FolderId)||void 0===i?void 0:i.Id)&&(u.FolderId.Id=Object(a.O)(u.FolderId.Id,r));(null===(o=null==u?void 0:u.EffectiveRights)||void 0===o?void 0:o.Read)&&(e.MasterList&&(t.RemoteCategories=e.MasterList),(r==t.OwnerEmailAddress||t.ItemId&&r==t.ItemId.Id)&&(Object(a.e)(r,{id:{id:t.ItemId.Id,mailboxInfo:n},calculatedFolderId:u.FolderId.Id}),Object(a.R)(r),Object(a.b)(t,u,n)))}(l,t,u,e,d),y(),[2])}}))}))}var S=n(240);function A(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,c,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,p(e)];case 1:if(null==(t=r.sent())||!t.WasSuccessful)throw i=new Error("[getCalendarFoldersFromServer] Failed to load calendars from server"),t?i.fetchErrorType="ServerFailure":i.networkError=!0,Object(u.d)(i),i;return n=d(t.CalendarGroups,t.CalendarFolders,e),o=t.CalendarGroups.length,c=o<1?{lowerBoundResultSize:null,upperBoundResultSize:0}:o<=3?{lowerBoundResultSize:1,upperBoundResultSize:3}:o<=6?{lowerBoundResultSize:4,upperBoundResultSize:6}:{lowerBoundResultSize:7,upperBoundResultSize:null},Object(h.o)("CalendarGroupsPerAccount",{connectedAccount_1:Object(S.n)(e),calendarGroupCount:t.CalendarGroups.length,calendarGroupCount_2:c.lowerBoundResultSize+" - "+c.upperBoundResultSize}),Object(a.E)(n.defaultCalendar,n.calendarEntryMapping,n.calendarFolderMapping,n.calendarGroupMapping,n.folderIdMapping,n.calendarIdToChangeKeyMapping),[2]}var o}))}))}var P=n(24),x=Object(g.createStore)("OwaCalendarsApiStore",{calendarIdsLoadState:new P.ObservableMap});function R(e){return x().calendarIdsLoadState.get(e)}Object(g.mutator)(E,(function(e){var t=e.calendarId,n=e.loadState;x().calendarIdsLoadState.set(t,n)})),Object(g.mutator)(a.Q,(function(e){var t=e.calendar;x().calendarIdsLoadState.delete(t.id.id)})),n.d(t,"b",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"c",(function(){return w})),n.d(t,"f",(function(){return A})),n.d(t,"a",(function(){return y})),n.d(t,"d",(function(){return R}))},646:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return u}));var r=n(613);n.d(t,"d",(function(){return r.b}));var a=n(108),c=new a.c((function(){return n.e(659).then(n.bind(null,923))})),i=new a.a(c,(function(e){return e.initializeOwaAccountsStore})),o=new a.b(c,(function(e){return e.initializeOwaConnectedAccount})),u=new a.a(c,(function(e){return e.removeOWAConnectedAccount}))},650:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"Duration:#Exchange"},e)}},651:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"EmailAddress:#Exchange"},e)}},652:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"FreeBusyViewOptions:#Exchange"},e)}},653:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"GetUserAvailabilityRequest:#Exchange"},e)}},654:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"MailboxData:#Exchange"},e)}},656:function(e,t,n){"use strict";var r=n(25),a=n(0);function c(e,t){var n;return void 0===e.request||e.request.__type||(e.request=(n=e.request,Object(a.__assign)({__type:"GetUserAvailabilityInternalJsonRequest:#Exchange"},n))),Object(r.a)("GetUserAvailabilityInternal",e,t)}n.d(t,"a",(function(){return c}))},665:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return u}));var r=n(0),a=n(114),c=n(483),i={width:1095,height:640};function o(e,t,n,c){if(e){var i=Object(a.e)();u(Object(r.__assign)({ItemId:Object(r.__assign)({mailboxInfo:i},e)},t),n,!!t,c||0)}}function u(e,t,n,r,a,o){Object(c.c)("calendar","compose",{event:e,composeEntrySource:t,shouldDuplicate:a,eventScope:o,eventHasUpdates:n},i)}},667:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(25);function a(e,t){return Object(r.a)("GetCalendarFolders",e,t)}},670:function(e,t,n){"use strict";var r;function a(e){var t=e.getCalendarFolders;return r=t,e}function c(){var e=r;return r=void 0,e}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c}))},673:function(e,t,n){"use strict";var r=n(25),a=n(0);function c(e,t){var n;return void 0===e.request||e.request.__type||(e.request=(n=e.request,Object(a.__assign)({__type:"GetCalendarFolderConfigurationRequest:#Exchange"},n))),Object(r.a)("GetCalendarFolderConfiguration",e,t)}n.d(t,"a",(function(){return c}))},676:function(e){e.exports=JSON.parse('{"a":"Hlb"}')},679:function(e,t,n){"use strict";var r=n(0),a=n(283),c=n(676),i=n(9),o=n(612),u=n(611),d=n(246),s="Groups",l=n(114),f=n(414),b=n(315),v=n(160);function O(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return 4,(t=[]).push({FilterType:1,SortType:4,SortDirection:"Descending"}),t.push({FilterType:2,SortType:4,SortDirection:"Descending"}),(n=Object(d.a)()).RequestServerVersion="V2018_01_08",[4,Object(b.e)(Object(l.e)(e))];case 1:return a=r.sent(),[4,Object(o.a)({Header:n,Body:Object(u.a)({RequestedGroupsSets:t})},a)];case 2:return[2,r.sent()]}}))}))}var p=Object(a.action)("getGroupCalendarsService")((function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,O(e)];case 1:return null!=(t=n.sent())&&t.Body.GroupsSets&&t.Body.GroupsSets.length>0?[2,j(t.Body.GroupsSets,e)]:[2,null]}}))}))}));function j(e,t){var n=[],r=[],a=Object(v.s)(t,s);if(e.forEach((function(e){e.Groups.forEach((function(e){var c=e.SmtpAddress.toLowerCase(),i={type:l.a.GroupMailbox,userIdentity:t,mailboxSmtpAddress:c,routingKey:Object(l.c)(t)+c,requestOptions:null},o={__type:f.a,CalendarColor:-1,CalendarName:e.DisplayName,OwnerEmailAddress:c,OwnerName:e.DisplayName,IsGroupMailboxCalendar:!0,IsGeneralScheduleCalendar:!0,ItemId:{Id:c},ParentGroupId:a},u={DistinguishedFolderId:c,DisplayName:e.DisplayName};n.push({entry:o,folder:u,mailboxInfo:i});var d={id:{id:c,mailboxInfo:i},calculatedFolderId:c,displayName:e.DisplayName,colorScheme:null};r.push(d)}))})),r.length>0){var o={type:l.a.GroupMailbox,userIdentity:t,mailboxSmtpAddress:t,routingKey:Object(l.b)(),requestOptions:null},u={id:{id:a,mailboxInfo:o},GroupId:a,ItemId:{Id:a},GroupName:Object(i.b)(c.a),GroupType:3};return{groupCalendars:n,calendarGroup:u,calendars:r}}return null}var I=Object(a.action)("getGroupCalendars")((function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,p(e)];case 1:return null!=(t=n.sent())&&null!=t.groupCalendars?(t.groupCalendars.forEach((function(e){Object(v.b)(e.entry,e.folder,e.mailboxInfo)})),Object(v.a)(t.calendarGroup),[2,{group:t.calendarGroup,calendars:t.calendars}]):[2,null]}}))}))})),_=n(76),m=n(254),h=n(103),g=Object(a.action)("initializeGroupCalendars")((function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a,c,i,o,u,d;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:n=new m.a("initializeGroupCalendars"),e||(e=Object(l.e)().userIdentity),a=Object(h.j)(e).GroupsEnabled,c=Object(_.h)("cal-groupsCalendar"),i=Object(v.s)(e,s),o=!Object(v.t)().some((function(t){return t.id.id===i&&t.id.mailboxInfo.userIdentity===e})),u=a&&c&&(t||o),n.addCustomData({issueServiceCall:u,GroupsEnabled:a,featureEnabled:c,refresh:t,initialLoad:o}),r.label=1;case 1:return r.trys.push([1,4,,5]),u?[4,I(e)]:[3,3];case 2:r.sent(),r.label=3;case 3:return n.end(),[3,5];case 4:throw d=r.sent(),n.endWithError("ServerError",Error(d)),d;case 5:return[2]}}))}))})),y=n(4),E=n(79),w=n(494),C=null;Object(y.orchestrator)(v.D,(function(e){var t=e.payload,n=t.id,r=t.EventType,a=t.Group.SmtpAddress;E.g.info(n+": "+r+", "+a),C||(C=Object(w.a)(g.bind(null,Object(l.e)().userIdentity,!0),2e3)),C()})),n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return s}))},715:function(e,t,n){var r=n(716),a=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var c=0;c<r.length;c++)a.loadStyles(r[c][1],!1);r.locals&&(e.exports=r.locals)},716:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,"._3k2DZQclSrOtYR-5XBK9RP{width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}",""]),t.locals={view:"_3k2DZQclSrOtYR-5XBK9RP"}},9132:function(e){e.exports=JSON.parse('{"a":"tcd","d":"ucd","c":"vcd","g":"wcd","f":"xcd","b":"ycd","e":"zcd"}')},954:function(e,t,n){"use strict";var r=n(1651),a=n(160),c=n(1007),i=n(414);function o(e){return!!e.EffectiveRights&&!!e.EffectiveRights.Modify&&!Object(a.J)(e.ParentFolderId.Id)&&!Object(c.c)(e)&&("Private"!==e.Sensitivity||(t=e.ParentFolderId.Id,n=Object(a.o)(t),Object(i.c)(n)));var t,n}var u=function(e){return J(e)&&o(e)&&!e.IsCancelled},d=n(114),s=function(e){var t;return(null===(t=null==e?void 0:e.ParentFolderId)||void 0===t?void 0:t.mailboxInfo)&&e.ParentFolderId.mailboxInfo.type==d.a.GroupMailbox};function l(e,t){if(!e)return!1;var n=!s(e),r=function(t){return t?n?t.filter((function(t){return!e.Organizer||t.Mailbox.EmailAddress!=e.Organizer.Mailbox.EmailAddress})):t:[]},a=r(e.RequiredAttendees).length,c=r(e.OptionalAttendees).length;return t?a+c>0:a+c+r(e.Resources).length>0}function f(e){return!!e&&(e.IsDraft?l(e):e.IsMeeting||l(e))}var b=function(e){return!f(e)&&!e.IsOrganizer&&o(e)&&!e.IsCancelled},v=function(e){return!(!e.IsOrganizer||f(e)&&e.MeetingRequestWasSent||!o(e))},O=n(103),p=n(1041);function j(e){var t=Object(a.o)(e.ParentFolderId.Id),n=Object(p.c)(e);return o(e)&&f(e)&&!!t&&!!n&&!([3,6,7].includes(t.CalendarFolderType)||n.IsMeetingPollEvent)}function I(e){return!!(e.IsOrganizer&&e.IsMeeting&&e.MeetingRequestWasSent&&o(e))}var _=function(e){return v(e)||u(e)||b(e)};function m(e){return!s(e)&&!e.IsOrganizer&&e.IsMeeting&&!e.IsCancelled&&o(e)}function h(e){return 0==Object(O.i)().SessionSettings.WebSessionType&&m(e)&&e.IsResponseRequested&&!e.IsAllDayEvent&&(!e.IsRecurring||E(e))}function g(e){return!e.IsOrganizer&&e.IsCancelled&&o(e)}function y(e){return!Object(r.a)(e.EntityNamesMap)&&e.IsOrganizer&&o(e)}function E(e){return e.IsRecurring&&"RecurringMaster"!==e.CalendarItemType&&"ThisAndFollowingInstancesMaster"!==e.CalendarItemType}function w(e){return"RecurringMaster"===e.CalendarItemType}function C(e){return"ThisAndFollowingInstancesMaster"===e.CalendarItemType}function S(e){return s(e)&&!e.IsCancelled&&!e.DoNotForwardMeeting}function A(e){if(e){var t=Object(a.o)(e.ParentFolderId.Id);if(t)return t.IsSharedWithMe||Object(i.d)(t)}return!1}var P=n(76);function x(e){return s(e)?Object(P.h)("cal-groupNotifications"):!A(e)||Object(P.h)("cal-mf-enableFTDFOnSharedCalendar")}var R=function(e){var t=Object(a.o)(e.ParentFolderId.Id),n=t?t.CalendarFolderType:void 0;return(Object(c.c)(e)||o(e))&&(!n||1==n||3==n||5==n)};function T(e){var t;return!!(null===(t=e.EffectiveRights)||void 0===t?void 0:t.Read)}var F=n(428);function N(e){return e&&T(e)&&D(e.ItemId)}function D(e){return(null==e?void 0:e.Id)&&!Object(F.b)(e.Id)}var M=n(240);function k(e){return e.IsMeeting&&!Object(M.n)(e.ParentFolderId.mailboxInfo.userIdentity)}var L=n(1096);function B(e,t){var n,r;return!(t&&t.length>0)||(e.Subject&&-1!=e.Subject.toLowerCase().indexOf(t.toLowerCase())||(null===(n=e.Location)||void 0===n?void 0:n.DisplayName)&&-1!=Object(L.d)(e.Location.DisplayName,e.Location.PostalAddress).toLowerCase().indexOf(t.toLowerCase())||(null===(r=e.Organizer)||void 0===r?void 0:r.Mailbox)&&-1!=e.Organizer.Mailbox.Name.toLowerCase().indexOf(t.toLowerCase()))}var G=function(e){if(!e)return!1;var t=e.ParentFolderId.mailboxInfo.mailboxSmtpAddress;return U(e.RequiredAttendees,t)||U(e.OptionalAttendees,t)};function U(e,t){return e&&e.some((function(e){return e.Mailbox.EmailAddress.toLowerCase()==t}))}var K=n(1159);function q(e){if(!e)return!1;var t=!1;return e.forEach((function(e){var n;n=e.Mailbox,Object(K.a)(n.EmailAddress)||n.ItemId&&"PrivateDL"==n.MailboxType||(t=!0)})),t}function V(e){if(!e)return!1;var t=Object(a.o)(e.ParentFolderId.Id);return t&&3==t.CalendarFolderType}function z(e){return"Exception"===e}function W(e){return"Occurrence"===e}function H(e){return W(e.CalendarItemType)||z(e.CalendarItemType)}function J(e){return(null==e?void 0:e.IsMeeting)&&!e.IsOrganizer}function Y(e){return(null==e?void 0:e.IsMeeting)&&(null==e?void 0:e.IsOrganizer)}function Q(e){return Object(c.c)(e)&&f(e)}var Z=n(7);function X(e,t){return e&&t&&!Object(c.c)(e)&&Object(Z.Ib)(t.Start,e.Start)&&Object(Z.Ib)(t.End,e.End)&&t.IsAllDayEvent==e.IsAllDayEvent}function $(e){return"RecurringMaster"===e}function ee(e){return!(!e.IsMeeting||!e.IsOrganizer||!e.IsDraft&&e.MeetingRequestWasSent)}n.d(t,"j",(function(){return j})),n.d(t,"c",(function(){return I})),n.d(t,"d",(function(){return _})),n.d(t,"q",(function(){return m})),n.d(t,"n",(function(){return h})),n.d(t,"o",(function(){return g})),n.d(t,"h",(function(){return y})),n.d(t,"J",(function(){return E})),n.d(t,"K",(function(){return w})),n.d(t,"A",(function(){return C})),n.d(t,"b",(function(){return S})),n.d(t,"a",(function(){return x})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return b})),n.d(t,"g",(function(){return v})),n.d(t,"i",(function(){return R})),n.d(t,"k",(function(){return o})),n.d(t,"l",(function(){return N})),n.d(t,"m",(function(){return D})),n.d(t,"p",(function(){return k})),n.d(t,"r",(function(){return B})),n.d(t,"s",(function(){return l})),n.d(t,"t",(function(){return G})),n.d(t,"u",(function(){return q})),n.d(t,"v",(function(){return T})),n.d(t,"w",(function(){return V})),n.d(t,"x",(function(){return f})),n.d(t,"y",(function(){return H})),n.d(t,"z",(function(){return z})),n.d(t,"B",(function(){return J})),n.d(t,"C",(function(){return A})),n.d(t,"D",(function(){return Y})),n.d(t,"E",(function(){return Q})),n.d(t,"F",(function(){return W})),n.d(t,"G",(function(){return s})),n.d(t,"H",(function(){return X})),n.d(t,"I",(function(){return $})),n.d(t,"L",(function(){return ee}))},960:function(e,t,n){"use strict";var r=n(108),a=n(1232),c=n(988),i=n(4),o=[c.a.SurfaceActions];Object(i.orchestrator)(a.a,(function(e){var t=e.defaultOptions;o.forEach((function(e){t[e]&&Object(c.f)(Number(e),t[e])}))}));var u=n(1017);n.d(t,"e",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"f",(function(){return f})),n.d(t,"g",(function(){return b})),n.d(t,"c",(function(){return u.a})),n.d(t,"d",(function(){return c.d})),n.d(t,"b",(function(){return c.b})),n.d(t,"a",(function(){return c.a}));var d=new r.c((function(){return n.e(440).then(n.bind(null,15122))})),s=new r.a(d,(function(e){return e.createOrUpdateOptionsForFeature})),l=new r.a(d,(function(e){return e.updateAddinPinStatus})),f=new r.b(d,(function(e){return e.getServerOptionsForFeature})),b=new r.a(d,(function(e){return e.loadOptions}))},970:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return s}));var r=n(0),a=n(1031),c=n(1104),i=n(1001);function o(e,t){var n=Object(c.a)().calendarFolderEvents.get(e);return n?Object(r.__spread)(n.events.values()).filter(t):[]}function u(e,t){return void 0===t&&(t=null),t?Object(r.__read)(o(t,(function(t){return t.ItemId.Id===e})),1)[0]||null:function(e){for(var t=Object(c.a)(),n=Object(r.__spread)(t.calendarFolderEvents.keys()),a=0;a<n.length;a++){var i=n[a],o=t.calendarFolderEvents.get(i),u=Object(r.__read)(o?Object(r.__spread)(o.events.values()).filter(e):[null],1)[0];if(u)return u}return null}((function(t){return t.ItemId.Id===e}))}function d(e,t){void 0===t&&(t=null);var n=Object(c.a)();return t?n.calendarFolderEvents.get(t).events.get(e)||null:function(e){for(var t=Object(c.a)(),n=Object(r.__spread)(t.calendarFolderEvents.keys()),a=0;a<n.length;a++){var i=n[a],o=d(e,i);if(o)return o}return null}(e)}function s(e,t,n){var o=null,u=(o=e?function(e,t,n){var i=Object(c.a)().calendarFolderEvents.get(e);return i&&Object(r.__read)(Object(a.l)([t],n,i),1)[0]||null}(e,t,n):function(e,t){for(var n=Object(c.a)(),i=Object(r.__spread)(n.calendarFolderEvents.keys()),o=0;o<i.length;o++){var u=i[o],d=n.calendarFolderEvents.get(u),s=Object(r.__read)(d?Object(a.l)([e],t,d):[null],1)[0];if(s)return s}return null}(t,n))?"1":"no";return Object(i.a)({lockId:n,updateMessage:"Got "+u+" item from the cache for given folder and key"}),o}},983:function(e,t,n){"use strict";var r=n(959),a=n(1160),c=n(4),i=Object(c.action)("CALENDAR_EVENTS_FETCHING_FULL_CALENDAR_EVENT_FOR_LOCK",(function(e,t,n,r,a){return{lockId:e,folderId:t,eventKey:n,itemResponseShapeType:r,partialCalendarEvent:a}})),o=Object(c.action)("CALENDAR_EVENTS_FETCHING_FULL_CALENDAR_EVENT_FOR_LOCK_FAILED",(function(e,t,n,r){return{lockId:e,folderId:t,eventKey:n,itemResponseShapeType:r}})),u=Object(c.action)("CALENDAR_EVENTS_FULL_CALENDAR_EVENT_LOADED_FOR_LOCK",(function(e,t,n,r,a,c,i){return{lockId:e,folderId:t,eventKey:n,itemResponseShapeType:r,event:a,eventScope:c,forceOverrideAllPropertiesForEventIfAvailable:i}})),d=Object(c.action)("CALENDAR_EVENTS_FULL_CALENDAR_EVENT_LOADED",(function(e,t,n,r){return{folderId:e,eventKey:t,itemResponseShapeType:n,event:r}})),s=Object(c.action)("CALENDAR_EVENTS_UPDATE_FULL_CALENDAR_EVENT_FROM_SERVER",(function(e){return{partialCalendarEvent:e}})),l=Object(c.action)("CALENDAR_EVENTS_UPDATE_FULL_CALENDAR_EVENT_FROM_PARTIAL_CALENDAR_EVENT",(function(e){return{partialCalendarEvent:e}})),f=Object(c.action)("CALENDAR_EVENT_MERGE_EVENTS_INTO_CACHE",(function(e){return{event:e}})),b=Object(c.action)("CALENDAR_EVENTS_REMOVE_FULL_CALENDAR_EVENT",(function(e,t){return{folderId:e,eventKey:t}})),v=Object(c.action)("CALENDAR_EVENTS_REMOVE_ALL_FULL_CALENDAR_EVENTS_INFO_FOR_CACHE",(function(e){return{folderId:e}})),O=Object(c.action)("ADD_CALENDAR_EVENTS_TO_EVENTS_CACHE",(function(e,t,n){return void 0===n&&(n=!1),{folderId:e,calendarEvents:t,forceReplace:n}})),p=Object(c.action)("ADD_CALENDAR_EVENTS_WITHING_CURRENT_LOCKED_DATE_RANGES",(function(e,t){return{folderId:e,calendarEvents:t}})),j=Object(c.action)("REMOVE_CALENDAR_EVENT_WITH_INSTANCE_KEY_FROM_EVENTS_CACHE",(function(e,t){return{folderId:e,instanceKey:t}})),I=Object(c.action)("INTERNAL_REMOVE_CALENDAR_EVENT_WITH_INSTANCE_KEY_FROM_EVENTS_CACHE",(function(e,t,n){return{folderId:e,instanceKey:t,onEventsRemoved:n}})),_=Object(c.action)("REMOVE_CALENDAR_EVENTS_FROM_EVENTS_CACHE_MATCHING_FILTER",(function(e,t){return{folderId:e,predicate:t}})),m=Object(c.action)("INTERNAL_REMOVE_CALENDAR_EVENTS_FROM_EVENTS_CACHE_MATCHING_FILTER",(function(e,t,n){return{folderId:e,predicate:t,onEventsRemoved:n}})),h=Object(c.action)("CALENDAR_EVENTS_RELEASE_LOCK",(function(e){return{lockId:e}})),g=Object(c.action)("RELEASE_LOCK",(function(e){return{lockId:e}})),y=Object(c.action)("CALENDAR_EVENTS_IN_EVENTS_CACHE_RELOADED",(function(e,t,n){return void 0===n&&(n=!1),{folderId:e,eventsReloaded:t,forceReplace:n}})),E=Object(c.action)("CALENDAR_EVENTS_IN_DATE_RANGE_LOADED_FOR_LOCK",(function(e,t,n,r){return{lockId:e,folderId:t,dateRange:n,calendarEvents:r}})),w=Object(c.action)("INTERNAL_CALENDAR_EVENTS_IN_DATE_RANGE_LOADED_FOR_LOCK",(function(e,t,n,r){return{lockId:e,folderId:t,dateRange:n,calendarEvents:r}})),C=Object(c.action)("INTERNAL_DELETE_EVENTS_CACHE",(function(e){return{folderId:e}})),S=Object(c.action)("CALENDAR_EVENTS_FULL_CALENDAR_EVENT_WAS_USED",(function(e,t){return{lockId:e,eventKey:t}})),A=Object(c.action)("UpdateItem",(function(e,t){return{existingItem:e,updatedItem:t}})),P=n(1317),x=n(1433),R=n(1434),T=n(9),F=n(123),N=Object(c.action)("calendarEventsRemoved",(function(e){return{eventsRemoved:e}})),D=Object(c.action)("calendarEventsAdded",(function(e){return{eventsAdded:e}})),M=Object(c.action)("calendarEventUpdated",(function(e){return{eventUpdated:e}})),k=Object(c.action)("calendarEventsRemovedMatchedFilter",(function(e){return{removePredicate:e}})),L=Object(c.action)("cacheReloaded",(function(e,t){return{previousEvents:e,reloadedEvents:t}})),B=Object(c.action)("deleteEventsCache",(function(e){return{folderId:e}})),G=Object(c.action)("loadingCalendarEvents",(function(e,t,n){return Object(F.c)({name:"CalendarLoadState",customData:{loadingState:n},options:{isVerbose:!0}},{lockId:e,calendarId:t,loadingState:n})})),U=Object(c.action)("instantCalendarEventCreate",(function(e,t,n,r,a,c,i){return void 0===r&&(r=function(){}),void 0===a&&(a=void 0),void 0===c&&(c=Object(T.b)(x.a)),void 0===i&&(i=function(){}),{eventToCreate:e,actionToExecute:t,onEventCreatedSuccess:n,onEventCreatedFailed:r,actionSource:a,errorMessage:c,onEventCreatedLocally:i}})),K=Object(c.action)("instantCalendarEventUpdate",(function(e,t,n,r,a,c,i,o,u){return void 0===c&&(c=function(){}),void 0===i&&(i=void 0),void 0===o&&(o=Object(T.b)(P.a)),void 0===u&&(u=function(){}),{eventId:e,eventChanges:t,eventScope:n,actionToExecute:r,onEventUpdateSuccess:a,onEventUpdateFailed:c,actionSource:i,errorMessage:o,onEventUpdatedLocally:u}})),q=Object(c.action)("instantCalendarEventDelete",(function(e,t,n,r,a,c,i,o,u,d){return void 0===c&&(c=function(){}),void 0===i&&(i=void 0),void 0===o&&(o=Object(T.b)(R.a)),void 0===u&&(u=!1),void 0===d&&(d=function(){return Promise.resolve(!1)}),{eventId:e,eventScope:t,dataPoint:n,actionToExecute:r,onEventDeleteSuccess:a,onEventDeleteFailed:c,actionSource:i,errorMessage:o,responseSent:u,asyncUndoAction:d}})),V=n(0),z=n(411);function W(e){if(0===e.length)return[];var t=[];return e.forEach((function(e){return function(e,t){for(var n=!1,r=0;r<t.length&&!n;r++){var a=t[r];0===Object(z.j)(a,e,!0)&&(t[r]=Object(z.f)(a,e),n=!0)}n||t.push(e)}(e,t)})),t}var H=n(970),J=n(254),Y=n(160),Q=n(954),Z=n(1041),X=n(315),$=n(76),ee=n(7);var te=n(553),ne=n(25);function re(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(V.__assign)({__type:"ExpandCalendarEventJsonRequest:#Exchange"},n)),Object(ne.a)("ExpandCalendarEvent",e,t)}var ae=n(246);function ce(e,t){return Object(V.__awaiter)(this,void 0,void 0,(function(){var n,r,a;return Object(V.__generator)(this,(function(c){switch(c.label){case 0:return n={Header:Object(ae.a)(),Body:(i={EventId:Object(te.a)({Id:e.Id}),WindowStart:Object(ee.rb)(t.start),WindowEnd:Object(ee.rb)(t.end),ReturnMaster:!0,ReturnRegularOccurrences:!0,ReturnExceptions:!0,ReturnCancellations:!0,IncludeDeclinedMeetings:Object($.h)("cal-surface-declinedMeetings")},Object(V.__assign)({__type:"ExpandCalendarEventRequest:#Exchange"},i))},r=re,a=[n],[4,Object(X.e)(e.mailboxInfo)];case 1:return[4,r.apply(void 0,a.concat([c.sent()]))];case 2:return[2,c.sent().Body]}var i}))}))}var ie=n(1797),oe=function(e){Object($.h)("cal-notificationDiagnostics")&&setTimeout((function(){return Object(ie.a)(e)}),0)},ue=n(1007),de=n(1062),se=n(1031);function le(e,t,n){var a=Object(se.k)(n,e,Object(r.f)(t));return(a||[]).filter((function(e){return!Object(Q.I)(e.CalendarItemType)}))}var fe=3,be=1,ve=n(1001),Oe=n(1492);function pe(e,t,n){return function(r){if(!je(r)||r.ParentFolderId.Id!==e)return!1;var a=function(e,t){return function(n){return je(n)&&n.ParentFolderId.Id===e&&n.ItemId.Id===t}}(r.ParentFolderId.Id,r.ItemId.Id);return n?t.some(a):!t.some(a)}}function je(e){var t;return(null===(t=null==e?void 0:e.ItemId)||void 0===t?void 0:t.Id)&&e.ParentFolderId&&e.ParentFolderId.Id}var Ie=n(518);function _e(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(V.__assign)({__type:"GetBirthdayCalendarViewJsonRequest:#Exchange"},n)),Object(ne.a)("GetBirthdayCalendarView",e,t)}function me(e,t,n){return Object(V.__awaiter)(this,void 0,void 0,(function(){var r,a;return Object(V.__generator)(this,(function(c){switch(c.label){case 0:return r=_e,a=[{Header:Object(ae.a)(),Body:(i={StartRange:Object(ee.rb)(e),EndRange:Object(ee.rb)(t)},Object(V.__assign)({__type:"GetBirthdayCalendarViewRequest:#Exchange"},i))}],[4,Object(X.e)(n.mailboxInfo)];case 1:return[4,r.apply(void 0,a.concat([c.sent()]))];case 2:return[2,c.sent().Body]}var i}))}))}var he=n(1816),ge=n(114),ye=n(1768),Ee=n(103);function we(e,t,n,r){return Object(V.__awaiter)(this,void 0,void 0,(function(){var a,c;return Object(V.__generator)(this,(function(i){return a=Object(Ee.i)().UserOptions.TimeZone,c="ows/api/beta/TeamsCalendarEvents/items?id="+encodeURIComponent(n)+"&rangeStart="+encodeURIComponent(Object(ee.rb)(e))+"&rangeEnd="+encodeURIComponent(Object(ee.rb)(t))+"&channelId="+r+"&timeZone="+a,[2,Object(ye.b)("getTeamsCalendarView",c)]}))}))}var Ce=n(79),Se=n(414);function Ae(e,t,n,r){var a;return void 0===r&&(r=0),{fetchPromise:function(e,t,n,r){void 0===r&&(r=0);return Object(V.__awaiter)(this,void 0,void 0,(function(){var a,c,i,o;return Object(V.__generator)(this,(function(u){switch(u.label){case 0:return(a=Object(J.q)())&&a.addCustomData({outOfCacheRange:!0}),c=Object(Y.u)(t),n(c,"Loading"),Object(Y.I)(t)?3!=(i=Object(Y.o)(t)).CalendarFolderType?[3,2]:[4,Re(e,c,t,n,r)]:[3,5];case 1:return[2,u.sent()];case 2:return[4,xe(e,c,t,n,null,r)];case 3:return[2,u.sent()];case 4:return[3,8];case 5:return i=Object(Y.l)({id:c}),Object(Y.M)(i)?(o=Object(Y.p)({id:{id:i.ItemId.Id,mailboxInfo:c.mailboxInfo}}),[4,Pe(t,o,i,e,c,n,r)]):[3,7];case 6:return[2,u.sent()];case 7:return n(c,"Failed"),[2,null];case 8:return[2]}}))}))}(e,t,n,r),enhancedFetchPromise:Object($.h)("cal-mf-noPeekJump")&&t==(null===(a=Object(Y.w)())||void 0===a?void 0:a.calculatedFolderId)?Fn.importAndExecute(e):null}}function Pe(e,t,n,c,i,o,u){return void 0===u&&(u=0),Object(V.__awaiter)(this,void 0,void 0,(function(){var d,s,l;return Object(V.__generator)(this,(function(f){switch(f.label){case 0:if(!(!t&&Object(Se.d)(n)||n.hasOwnProperty("OwnerEmailAddress")&&!n.IsGroupMailboxCalendar&&t&&!t.EffectiveRights||t&&(!t.EffectiveRights||!t.EffectiveRights.Read)&&n.IsGeneralScheduleCalendar))return[3,7];f.label=1;case 1:if(!(u>=0))return[3,6];f.label=2;case 2:return f.trys.push([2,4,,5]),[4,Object(Ie.b)(c.start,c.end,[n.OwnerEmailAddress],"DetailedMerged",null,i.mailboxInfo)];case 3:return"NoError"==(d=f.sent()).ResponseCode?(o(i,"Loaded"),function(e,t){var n=Object(r.a)(e);if(null==n?void 0:n.length){var c=Object(a.a)(n,[t]).eventsOverlapping;_(e,pe(e,c,!0))}}(e,c),function(e){var t=Object(r.f)(e),n=t?Object(V.__spread)(t.events.values()):[];k(pe(e,n,!1))}(e),[2,d.Responses[0].CalendarView.Items.map((function(e){return Object(Z.a)(e,i.mailboxInfo)}))]):(u--,[3,5]);case 4:return s=f.sent(),Ce.g.warn("[loadCalendarEventsInDateRange:loadCalendarEventsUsingFolderId: Exception occured: "+s),s.message&&(s.message.indexOf("ErrorApiQuarantined")>=0||s.message.indexOf("ErrorTooManyObjectsOpened")>=0)?(o(i,"Throttled"),[2,null]):(u--,[3,5]);case 5:return[3,1];case 6:return o(i,"Failed"),[2,null];case 7:return l=t?t.FolderId.Id:n.SharedFolderId.Id,[4,xe(c,i,l,o,n.IsGroupMailboxCalendar?null:n.OwnerEmailAddress,u)];case 8:return[2,f.sent()]}}))}))}function xe(e,t,n,r,a,c){return void 0===c&&(c=0),Object(V.__awaiter)(this,void 0,void 0,(function(){var i,o;return Object(V.__generator)(this,(function(u){switch(u.label){case 0:if(!(c>=0))return[3,8];u.label=1;case 1:return u.trys.push([1,6,,7]),i=void 0,t.mailboxInfo&&t.mailboxInfo.type==ge.a.TeamsMailbox?[4,we(e.start,e.end,Object(Y.f)(n),t.id)]:[3,3];case 2:return(i=u.sent())&&(i=i.Body),[3,5];case 3:return[4,Object(he.a)(e.start,e.end,n,t,a,Object($.h)("cal-surface-declinedMeetings"))];case 4:i=u.sent(),u.label=5;case 5:return"NoError"==i.ResponseCode?(r(t,"Loaded"),[2,i.Items.map((function(e){return t.mailboxInfo&&t.mailboxInfo.type==ge.a.TeamsMailbox&&(e.ParentFolderId.Id=n),Object(Z.a)(e,t.mailboxInfo)}))]):(c--,[3,7]);case 6:return o=u.sent(),Ce.g.warn("[loadCalendarEventsInDateRange:getCalendarView: Exception occured: "+o),o.message&&(o.message.indexOf("ErrorApiQuarantined")>=0||o.message.indexOf("ErrorTooManyObjectsOpened")>=0)?(r(t,"Throttled"),[2,null]):(c--,[3,7]);case 7:return[3,0];case 8:return r(t,"Failed"),[2,null]}}))}))}function Re(e,t,n,r,a){return void 0===a&&(a=0),Object(V.__awaiter)(this,void 0,void 0,(function(){var c,i;return Object(V.__generator)(this,(function(o){switch(o.label){case 0:if(!(a>=0))return[3,5];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,me(e.start,e.end,t)];case 2:return"NoError"==(c=o.sent()).ResponseCode?(r(t,"Loaded"),[2,c.BirthdayEvents.map((function(r){return Object(Oe.a)(r,n,e,t.mailboxInfo)}))]):(a--,[3,4]);case 3:return i=o.sent(),Ce.g.warn("[loadCalendarEventsInDateRange:getBirthdayCalendarView: Exception occured: "+i),i.message&&(i.message.indexOf("ErrorApiQuarantined")>=0||i.message.indexOf("ErrorTooManyObjectsOpened")>=0)?(r(t,"Throttled"),[2,null]):(a--,[3,4]);case 4:return[3,0];case 5:return r(t,"Failed"),[2,null]}}))}))}var Te={};function Fe(e,t){return function(e,t){Ne(e);for(var n=Te[e],r=0;r<n.length;r++)if(Object(z.c)(n[r].dateRange,t,!0))return{index:r,info:n[r]};return{index:-1,info:null}}(e,t).index>=0}function Ne(e){Te[e]||(Te[e]=[])}var De={};function Me(e){De[e]||(De[e]=[])}function ke(e,t){Me(e);for(var n=De[e],r=0;r<n.length;r++)if(Object(z.c)(n[r].dateRange,t,!0))return{index:r,info:n[r]};return{index:-1,info:null}}function Le(e,t,n){var a=Object(r.g)(e,t),c=ke(t,n).info;if(a&&a.lockedDateRange&&Object(z.c)(a.lockedDateRange,n,!0)){var i=Object(Y.u)(t);G(e,i,"Loaded");var o=le(e,t,n);O=Be(o,t,n,c);return{fetchPromise:Promise.resolve(o),enhancedFetchPromise:O,events:o}}var u=function(e,t){var n=Object(r.d)(e),a=Object(r.f)(e);return n.some((function(e){return Object(z.c)(e,t,!0)}))&&a?Object(se.j)(t,a.events).map((function(e){return Object(V.__assign)({},e)})):null}(t,n);if(u){var d=Ge(e,t,n,Promise.resolve(u),"existing"),s=Be(u,t,n,c);return null==d||d.then((function(n){var r=Object(Y.u)(t);G(e,r,"Loaded")})),{fetchPromise:d,enhancedFetchPromise:s,events:u}}if(null==c?void 0:c.requestPromises){var l=c.requestPromises,b=l.fetchPromise,v=l.enhancedFetchPromise;return c.lockIds.push(e),{fetchPromise:Ge(e,t,n,null==b?void 0:b.then((function(e){return e?e.filter((function(e){var t=e.Start,r=e.End;return 0==Object(z.j)(n,{start:t,end:r},!0)})):[]})),"new"),enhancedFetchPromise:null==v?void 0:v.then((function(e){return Ue(n)(e)})),events:null}}!function(e,t,n){Me(t),De[t].push({dateRange:n,requestPromises:null,lockIds:[e]})}(e,t,n);var O,p=function(e,t,n){var r=this,a=Ae(t,e,n,be);return{fetchPromise:Object(V.__awaiter)(r,void 0,void 0,(function(){return Object(V.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,,2,3]),[4,null==a?void 0:a.fetchPromise];case 1:return[2,n.sent()];case 2:return function(e,t){var n=ke(e,t).index;-1!==n&&De[e].splice(n,1)}(e,t),[7];case 3:return[2]}}))})),enhancedFetchPromise:null==a?void 0:a.enhancedFetchPromise}}(t,n,function(e,t){return function(n,r){var a=ke(e,t),c=a.index,i=a.info;-1!==c&&i.lockIds.forEach((function(e){G(e,n,r)}))}}(t,n)),j=null==p?void 0:p.fetchPromise,I=null==p?void 0:p.enhancedFetchPromise;return function(e,t,n){var r=ke(e,t),a=r.index,c=r.info;-1!==a&&(c.requestPromises=n)}(t,n,p),{fetchPromise:Ge(e,t,n,j,"new"),enhancedFetchPromise:O=function(e,t,n){return Object(V.__awaiter)(this,void 0,void 0,(function(){var r;return Object(V.__generator)(this,(function(a){switch(a.label){case 0:return[4,n];case 1:return(r=a.sent())&&(!function(e,t){Ne(e),Te[e].push({dateRange:t})}(e,t),r.forEach((function(e){return f(e)}))),[2,r]}}))}))}(t,n,I),events:null}}function Be(e,t,n,r){var a,c,i=null;if(t===(null===(a=Object(Y.w)())||void 0===a?void 0:a.calculatedFolderId))if(Fe(t,n))i=Promise.resolve(e);else if(null===(c=null==r?void 0:r.requestPromises)||void 0===c?void 0:c.enhancedFetchPromise){i=r.requestPromises.enhancedFetchPromise.then(Ue(n))}else Ce.g.warn("[loadEnhancedEvents] - Failed to load GetCalendarView++ events on an existing lock.");return i}function Ge(e,t,n,r,a){return Object(V.__awaiter)(this,void 0,void 0,(function(){var c,i;return Object(V.__generator)(this,(function(o){switch(o.label){case 0:return[4,r];case 1:return c=o.sent(),i=c?c.length:"no",Object(ve.a)({lockId:e,updateMessage:"Fetched "+i+" "+a+" items for date range: "+n.start+" - "+n.end}),c&&E(e,t,n,c),[2,c]}}))}))}function Ue(e){return function(t){return t?t.filter((function(t){var n=t.Start,r=t.End;return 0==Object(z.j)(e,{start:n,end:r},!0)})):[]}}function Ke(e,t){var n,a;return void 0===t&&(t=!1),Object(V.__awaiter)(this,void 0,void 0,(function(){var c,i,o,u,d,l;return Object(V.__generator)(this,(function(f){switch(f.label){case 0:c=function(e){var t=function(e){return Me(e),De[e].map((function(e){return e.dateRange}))}(e),n=null==t?void 0:t.filter((function(e){return null!==e})),a=Object(r.d)(e);return W(Object(V.__spread)(n,a))}(e),i=c.map((function(t){return Ae(t,e,function(e,t){return function(n,a){"Loading"!==a&&Object(r.c)(e,t).forEach((function(e){G(e,n,a)}))}}(e,t),be)})),o=[],u=0,f.label=1;case 1:return u<i.length?[4,Promise.all([null===(n=i[u])||void 0===n?void 0:n.fetchPromise,null===(a=i[u])||void 0===a?void 0:a.enhancedFetchPromise]).then((function(e){var t=e[0],n=e[1];if(t&&n)for(var r=function(e){var r=t[e].ItemId.Id,a=null===(c=t[e].ParentFolderId)||void 0===c?void 0:c.Id,c=Object(V.__read)(n.filter((function(e){var t;return e.ItemId.Id===r&&(null===(t=e.ParentFolderId)||void 0===t?void 0:t.Id)===a})),1),i=c[0];i&&A(t[e],i),o.push(t[e])},a=0;a<t.length;a++)r(a);else t&&o.push.apply(o,Object(V.__spread)(t))}))]:[3,4];case 2:f.sent(),f.label=3;case 3:return u++,[3,1];case 4:return o.length>0?(o.forEach((function(e){return s(e)})),d=o.reduce((function(e,t){return t&&e.push(t),e}),[]),b=function(e){return e.ItemId.Id},v={},O=[],d.forEach((function(e){var t=b(e);v.hasOwnProperty(t)||(O.push(e),v[t]=!0)})),y(e,l=O,t),[2,l]):[2,null]}var b,v,O}))}))}function qe(e,t,n,r){void 0===r&&(r=!1);var a=e.ParentFolderId.Id,c=!1,i=function(e,t,n){var r,a,c=null;if(n)c=Object(H.b)(t.ItemId.Id,e);else{r=Object(V.__read)(Object(H.a)(e,(function(e){return e.InstanceKey==t.InstanceKey})),1),c=r[0]}if(!c){var i=t.ClientSeriesId;if(i){a=Object(V.__read)(Object(H.a)(e,(function(e){return e.ClientSeriesId==i})),1),c=a[0]}}return c}(a,e,t);i?i.IsRecurring&&!t?r?N([i]):c=!0:(null==e.IsOnlineMeeting&&null!=i.IsOnlineMeeting&&(e.IsOnlineMeeting=i.IsOnlineMeeting),null==e.OnlineMeetingJoinUrl&&null!=i.OnlineMeetingJoinUrl&&(e.OnlineMeetingJoinUrl=i.OnlineMeetingJoinUrl),N([i])):Ce.g.info("[SharedCacheFunctions] addOrModifyItemInCache: Skipping removal of old item from cache as no old item was found"),!i&&n||(c||(O(a,[e]),D([e])),r?s(e):l(e))}function Ve(e,t){return void 0===t&&(t=!1),Object(V.__awaiter)(this,void 0,void 0,(function(){return Object(V.__generator)(this,(function(n){switch(n.label){case 0:return[4,Ke(e,t)];case 1:return n.sent(),[2]}}))}))}var ze=Object(c.action)("CALENDAR_EVENTS_CLEAR_ALL_FULL_CALENDAR_EVENTS",(function(){return{}}));function We(){ze(),Object(r.b)().map((function(e){return Ke(e,!0)}))}var He=n(1352),Je=864e5;var Ye,Qe={RowAdded:"RowAdded",RowModified:"RowModified",RowDeleted:"RowDeleted",Reload:"Reload"},Ze=2e3,Xe={},$e={},et=[],tt=!0,nt=!0;function rt(e,t){if(nt&&(Object(He.b)(We,"RELOAD_CALENDAR_SUBSCRIPTIONS",Je),nt=!1),Xe[e])return Xe[e].locks[t]=!0,void oe({message:"Already subscribed to calendar item notifications for folder",folderId:e});var n=Object(Y.o)(e);if(n){var r=Object(Y.C)(n);if(r){var a=Object($.h)("cal-surface-declinedMeetings");de.b.import().then((function(n){var c,i=Object(V.__assign)(Object(V.__assign)({},r),{ChannelId:n(),NotificationType:"CalendarItemNotification",IncludeDeclinedMeetings:a}),o={subscriptionId:""+i.NotificationType+e+(a?"declinedMeetings":""),requiresExplicitSubscribe:!0,subscriptionParameters:i},u={folderId:e,subscription:o,locks:(c={},c[t]=!0,c)};oe({message:"Subscribing to calendar item notifications for folder with includeDeclinedMeetings = "+a,folderId:e}),de.f.importAndExecute(o,at),Xe[e]=u}))}}else oe({message:"Calendar entry not found to subscribe to notifications for folder",folderId:e})}function at(e){ot(e,!0),function(e){if(et.some((function(e){return ut(e.NotificationPayload)})))oe({message:"A reload notification is in the queue. No additional notifications will be added",notificationPayload:e.NotificationPayload});else if(ut(e.NotificationPayload))oe({message:"A reload notification will be enqueued. All existing notifications will be discarded.",notificationPayload:e.NotificationPayload}),(et=[])[0]=e;else{for(var t=et.length-1;t>=0;t--){var n=et[t].NotificationPayload.Item,r=void 0,a=void 0,c=void 0;if(null!=e.NotificationPayload.Item.InstanceKey?(a=e.NotificationPayload.Item.InstanceKey,r=n.InstanceKey,c="InstanceKey"):(a=e.NotificationPayload.Item.ItemId.Id,r=n.ItemId.Id,c="ItemId"),a===r){oe({message:"Found an existing notification in the queue for the same "+c+". Old notification will be removed.",notificationPayload:e.NotificationPayload}),et[t].InstanceKeyToDelete&&(e.InstanceKeyToDelete=et[t].InstanceKeyToDelete),et.splice(t,1);break}}var i=!1;if(null!=e.NotificationPayload.Item.InstanceKey)if(e.NotificationPayload.EventType==Qe.RowModified&&Object(Q.I)(e.NotificationPayload.Item.CalendarItemType)&&null!=e.NotificationPayload.Item.UID&&($e[e.NotificationPayload.Item.InstanceKey]=e.NotificationPayload.Item.UID),e.NotificationPayload.EventType===Qe.RowAdded||e.NotificationPayload.EventType===Qe.RowModified){for(t=et.length-1;t>=0;t--)if(et[t].NotificationPayload.EventType===Qe.RowDeleted&&et[t].OriginalUID==e.NotificationPayload.Item.UID){oe({message:"Found an existing RowDeleted notification in the queue for the same UID, which will be removed from the queue.",notificationPayload:e.NotificationPayload}),e.InstanceKeyToDelete=et[t].NotificationPayload.Item.InstanceKey,et.splice(t,1);break}}else if(e.NotificationPayload.EventType===Qe.RowDeleted){var o=$e[e.NotificationPayload.Item.InstanceKey];if(delete $e[e.NotificationPayload.Item.InstanceKey],o){e.OriginalUID=o;for(t=et.length-1;t>=0;t--){var u=et[t].NotificationPayload.Item.UID;if((et[t].NotificationPayload.EventType===Qe.RowAdded||et[t].NotificationPayload.EventType===Qe.RowModified)&&u==o){oe({message:"Found an existing RowAdded or RowModified notification in the queue for the same UID, which will be merged with the RowDelete.",notificationPayload:e.NotificationPayload}),et[t].InstanceKeyToDelete=e.NotificationPayload.Item.InstanceKey,i=!0;break}}}}i?oe({message:"RowDeleted notification was merged with a RowAdded notification for the same UID and will not be enqueued",notificationPayload:e.NotificationPayload}):(oe({message:"Notification will be enqueued",notificationPayload:e.NotificationPayload}),et.push(e))}oe({message:"Notification queue length is "+et.length})}({NotificationPayload:e,InstanceKeyToDelete:null,OriginalUID:null}),tt?(Ye&&(oe({message:"Notification processing timer was already started. It will be cancelled and restarted."}),clearTimeout(Ye)),Ye=setTimeout(it,Ze),oe({message:"Timer to drain queue has started"})):oe({message:"The notification was received while notification processing was suspended"})}function ct(e){var t,n;if(ot(e.NotificationPayload,!1),ut(e.NotificationPayload))dt();else{var a=e.NotificationPayload.FolderId,c=null===(t=e.NotificationPayload.Item)||void 0===t?void 0:t.SkypeTeamsProperties;Object($.h)("cal-showAddTeamsCalendars")&&c&&!Object(Y.o)(a)&&(a=function(e,t){var n=JSON.parse(t);if(null==n?void 0:n.cid){var r=n.cid.split("@")[0];e=r?Object(Y.O)(e,r):e}return e}(a,c),(null===(n=e.NotificationPayload.Item)||void 0===n?void 0:n.ParentFolderId)&&(e.NotificationPayload.Item.ParentFolderId.Id=a));var i=Object(r.h)(a),o=Object(r.d)(a),u=Object(r.e)(a),d=Object(Y.o)(a),l=Object(Y.y)(a);d&&3==d.CalendarFolderType?dt(a):i&&(o.length>0||Object.keys(u).length>0)?e.NotificationPayload.EventType==Qe.RowDeleted?function(e,t){var n=t.Item.InstanceKey;j(e,n)}(a,e.NotificationPayload):Object(Q.I)(e.NotificationPayload.Item.CalendarItemType)?function(e,t,n){var r=Object(Z.a)(n.NotificationPayload.Item,t);if(r.UID){vt(e).forEach((function(a){var c=ce(r.ItemId,a);c.then((function(i){i&&"Success"==i.ResponseClass?function(e,t,n,r,a,c,i){if(oe({message:"Action to expand series completed successfully. Retrieved "+(a?a.length:0)+" items for dates: "+n.start.toString()+" - "+n.end.toString()+" ",folderId:r,notificationItem:e}),vt(r).some((function(e){return Object(z.b)(n,e)}))){oe({message:"Updating all cached items for the series and removing nonexistant ones",folderId:r});var o=a?a.map((function(e){return e.UID})):void 0;lt(n,e.ItemId.Id,e.InstanceKey,i,r,(function(e){return!o||!o.includes(e.UID)})),s(c),p(r,a),a.forEach((function(e){s(e)}))}else oe({message:"Range in the cache is different from what we originally requested - reloading cache",folderId:r}),Ve(r,!0)}(r,0,a,e,i.Occurrences.map((function(e){return Object(Z.a)(e,t)})),Object(Z.a)(i.RecurrenceMaster,t),n.InstanceKeyToDelete):st(r,c,a,e,n.InstanceKeyToDelete,i)})).catch((function(t){st(r,c,a,e,n.InstanceKeyToDelete,null,t.message)}))}))}}(a,l,e):function(e,t,n){var r=Object(Z.a)(n.Item,t),a=!1;switch(n.EventType){case Qe.RowAdded:a=!0;break;case Qe.RowModified:a=null==r.InstanceKey||Object(Q.F)(r.CalendarItemType)||Object(Q.z)(r.CalendarItemType)}qe(r,a,!1,!0)}(0,l,e.NotificationPayload):oe({message:i?"Events cache was empty for folder":"Events cache has not been loaded for folder yet",folderId:e.NotificationPayload.FolderId,notificationPayload:e.NotificationPayload})}}function it(){var e=et.length;if(e>=8||et.some((function(e){return ut(e.NotificationPayload)})))dt();else for(var t=0;t<e;t++){ct(et[t])}et=[],$e={},clearTimeout(Ye)}function ot(e,t){var n,r=(null===(n=e.Item)||void 0===n?void 0:n.ItemId)?e.Item.ItemId.Id:"<null>";if(oe({message:(t?"Got calendar notification":"Processing calendar notification")+" for event type "+e.EventType,folderId:e.FolderId,notificationPayload:e}),t){var a=e.Item?e.Item.CalendarItemType:"<null>";Object(J.o)("IncomingNotification",{NotificationType:e.EventType,ItemType:a,ItemId:r},{isCosmosDatapoint:!0})}}function ut(e){return e.EventType==Qe.Reload||e.Reload}function dt(e){var t,n,r=e?[e]:Object.keys(Xe);try{for(var a=Object(V.__values)(r),c=a.next();!c.done;c=a.next()){Ve(c.value,!0)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}}function st(e,t,n,r,a,c,i){if(void 0===i&&(i=null),c&&"ErrorItemNotFound"==c.ResponseCode)oe({message:"Action to expand recurring series failed with item not found because item is not on the server. Removing series.",folderId:r,notificationItem:e}),lt(n,e.ItemId.Id,e.InstanceKey,a,r);else{var o=c?c.ResponseCode+": "+c.MessageText:i;oe({message:"Action to expand recurring series failed for unknown reason, reloading cache",folderId:r,notificationItem:e,errorMessage:o}),Ve(r,!0)}}function lt(e,t,n,r,a,c){var i=function(a){var i,o={start:a.Start,end:a.End},u=0==Object(z.j)(e,o,!0),d=a.InstanceKey==n||r&&a.InstanceKey==r||t&&t===(null===(i=a.SeriesMasterItemId)||void 0===i?void 0:i.Id);return u&&(Object(ue.c)(a)||d&&(!c||c(a)))};_(a,i);var o=Object(H.a)(a,i);N(o)}function ft(){tt&&(clearTimeout(Ye),oe({message:"Processing of notifications will be suspended"}),tt=!1)}function bt(){tt||(tt=!0,oe({message:"Processing of notifications will be resumed"}),Ye=setTimeout(it,Ze))}function vt(e){return W(Object(r.d)(e))}Object(c.orchestrator)(L,(function(e){var t=e.previousEvents,n=e.reloadedEvents;n&&(t&&N(t),D(n))})),Object(c.orchestrator)(_,(function(e){var t=e.folderId,n=e.predicate,r=null;m(t,n,(function(e){r=e})),r&&(r.forEach((function(e){return b(t,e.Key)})),N(r))})),Object(c.orchestrator)(j,(function(e){var t=e.folderId,n=e.instanceKey,r=null;I(t,n,(function(e){r=e})),r&&(r.forEach((function(e){return b(t,e.Key)})),N(r))})),Object(c.orchestrator)(E,(function(e){var t=e.lockId,n=e.folderId,r=e.dateRange,a=e.calendarEvents;w(t,n,r,a),a&&D(a)})),Object(c.orchestrator)(p,(function(e){var t=e.folderId,n=e.calendarEvents,c=Object(r.d)(t),i=Object(a.a)(n,c).eventsOverlapping;i.length>0&&(O(t,i),D(i))})),Object(c.orchestrator)(y,(function(e){var t=e.folderId,n=e.eventsReloaded,a=e.forceReplace,c=Object(r.a)(t);O(t,n,a),L(c,n)})),Object(c.orchestrator)(B,(function(e){var t=e.folderId;!function(e){var t=Xe[e];t?(oe({message:"Unsubscribing from calendar item notifications for folder",folderId:e}),de.g.importAndExecute(t.subscription,at),delete Xe[e]):oe({message:"Could not unsubscribe calendar item notifications for folder due to subscription data not found",folderId:e})}(t),v(t),C(t)}));var Ot=n(1729),pt=n(1222),jt=n(316);function It(e,t){var n=function(e){return Object(pt.d)(e)?_t:Object(pt.h)(e)?mt:Object(pt.e)(e)?ht:(Object(pt.i)(e),null)}(e.Recurrence);if(!n)return[Object(V.__assign)({},e)];var r=W(t),a=[],c=e.Recurrence.RecurrencePattern.Interval;r.forEach((function(t){var r=function(e,t){var n=Object(ee.Xb)(e.Start),r=Object(Ot.a)(n.tz,e.Recurrence),a={start:n,end:r};return function(e,t){e.start=Object(ee.p)(e.start,t.start)>0?e.start:t.start,e.end=null!=e.end&&Object(ee.p)(e.end,t.end)<0?e.end:t.end}(a,t),a}(e,t),i=n(e,r,c);a.push.apply(a,Object(V.__spread)(i))}));var i=Object(ee.x)(e.Start,Object(ee.Xb)(e.Start)),o=Object(ee.x)(e.End,Object(ee.Xb)(e.Start));return function(e,t,n,r){var a=[];return r.forEach((function(r){var c={};jt(c,e),c.Start=Object(ee.h)(r,t),c.End=Object(ee.h)(r,n),c.CalendarItemType="Occurrence",a.push(c)})),a}(e,i,o,a)}function _t(e,t,n){for(var r=[],a=Object(ee.s)(t.end,t.start),c=0;c<=a;c+=n){var i=Object(ee.e)(t.start,c);r.push(i)}return r}function mt(e,t,n){for(var r=[],a=e.Recurrence.RecurrencePattern,c=a.DaysOfWeek.split(" ").map((function(e){return gt(e)})),i=Math.max(gt(a.FirstDayOfWeek),0),o=t.start;Object(ee.p)(o,t.end)<=0;){for(var u=o,d=Object(ee.C)(u,i);Object(ee.p)(u,d)<=0;)c.includes(Object(ee.ob)(u))&&Object(z.s)(t,u)&&r.push(u),u=Object(ee.e)(u,1);o=Object(ee.bc)(Object(ee.e)(o,7*n),i)}return r}function ht(e,t,n){var r=[];if(Object(pt.b)(e.Recurrence))for(var a=(u=e.Recurrence.RecurrencePattern).DayOfMonth,c=t.start;Object(ee.p)(c,t.end)<=0;){for(var i=c,o=Object(ee.B)(i);Object(ee.p)(i,o)<=0;)Object(ee.mb)(i)==a&&Object(z.s)(t,i)&&r.push(i),i=Object(ee.e)(i,1);c=Object(ee.ac)(Object(ee.i)(c,n))}else{var u,d=gt((u=e.Recurrence.RecurrencePattern).DaysOfWeek),s=-1;switch(u.DayOfWeekIndex){case"First":s=1;break;case"Second":s=2;break;case"Third":s=3;break;case"Fourth":s=4}for(c=t.start;Object(ee.p)(c,t.end)<=0;){var l=void 0;l=s>0?yt(d,s,c):Et(d,c),Object(z.s)(t,l)&&r.push(l),c=Object(ee.ac)(Object(ee.i)(c,n))}}return r}function gt(e){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].indexOf(e)}function yt(e,t,n){var r=Object(ee.ac)(n),a=(e-Object(ee.ob)(r)+7)%7+7*(t-1);return Object(ee.e)(r,a)}function Et(e,t){var n=yt(e,5,t);return Object(ee.yb)(n)==Object(ee.yb)(t)?n:yt(e,4,t)}function wt(e,t){if(t){var n=e.ParentFolderId.Id;e.Recurrence?_(n,(function(t){return t.InstanceKey==e.InstanceKey})):_(n,(function(t){return t.ItemId.Id===e.ItemId.Id}))}}Object(c.orchestrator)(U,(function(e){return Object(V.__awaiter)(void 0,void 0,void 0,(function(){var t,n,a,c,i,o,u,d,s,l,f,b;return Object(V.__generator)(this,(function(v){switch(v.label){case 0:t=e.eventToCreate,n=e.actionToExecute,a=e.actionSource,c=e.onEventCreatedFailed,i=e.onEventCreatedSuccess,o=e.errorMessage,u=e.onEventCreatedLocally,O=t,d=Object(r.h)(O.ParentFolderId.Id),function(e,t,n,a){if(t){var c=e.ParentFolderId.Id;if(e.Recurrence){var i=Object(r.d)(c),o=It(e,i);Object(ue.a)(o.concat(e),!1);var u=o.map((function(e){return Object(V.__assign)(Object(V.__assign)({},e),{CalendarItemType:"Occurrence"})}));p(c,u)}else Object(ue.b)(e),p(c,[e])}n(a)}(t,d,u,a),s=function(){return U(t,n,(function(){return c(o,null,a)}),i,a,o)},l=null,v.label=1;case 1:return v.trys.push([1,3,,4]),[4,n(t)];case 2:return l=v.sent(),[3,4];case 3:throw f=v.sent(),wt(t,d),c(f,s,a),f;case 4:if(b=null,!l.isSuccessful)throw wt(t,d),c(o,s,a),o;return b=l.createdItem,function(e,t,n){t.ParentFolderId||(t.ParentFolderId=Object(V.__assign)({},e.ParentFolderId));if(n){if(t.Recurrence)return;var r=t.ParentFolderId.Id;_(r,(function(t){return t.ItemId.Id===e.ItemId.Id})),qe(t,!0,!1)}}(t,b,d),i(b),[2]}var O}))}))}));var Ct=n(316);function St(e,t){var n={Key:e,Start:t.Start,End:t.End};return Ct(t,n),t}var At=n(1055),Pt=n(1104);var xt=n(19),Rt=n(1073),Tt=n(316);function Ft(e){if(e){var t=Object(Pt.a)();t.calendarFolderEvents.get(e)||t.calendarFolderEvents.set(e,Object(se.f)())}}function Nt(e){var t,n;if((n=e).Key&&void 0!==n.Start&&void 0!==n.End){e.Key;e=Object(V.__rest)(e,["Key"])}var r=Object(Rt.a)(e),a=null===(t=e.ParentFolderId)||void 0===t?void 0:t.Id;if(a){var c=Object(H.c)(r,a);c&&Object(se.q)(c,e)}}Object(c.mutator)(h,(function(e){var t=e.lockId,n=Object(Pt.a)();Object(V.__spread)(n.calendarFolderEvents.keys()).forEach((function(e){n.calendarFolderEvents.get(e).locksInfo.get(t)&&Object(se.n)(t,n.calendarFolderEvents.get(e))})),n.fullItemsMruMap.delete(t)})),Object(c.mutator)(d,(function(e){var t=e.folderId,n=e.eventKey,r=e.event,a=Object(H.c)(n,t);a&&Object(se.q)(a,r,!0)})),Object(c.mutator)(l,(function(e){Nt(e.partialCalendarEvent)})),Object(c.mutator)(f,(function(e){Nt(e.event)})),Object(c.mutator)(w,(function(e){var t=e.lockId,n=e.folderId,a=e.dateRange,c=e.calendarEvents;Ft(n);var i=Object(r.f)(n),o=Object(At.a)(),u=c.filter((function(e){return!Object(Q.I)(e.CalendarItemType)})).map((function(e){return St(e.ItemId.Id,e)})).filter((function(e){return!o[e.Key]}));Object(se.b)(a,u,t,i);var d=i.locksInfo.get(t).lockedDateRange,s=Object(ee.s)(d.end,d.start),l=Object(xt.e)()?42:110;if(s>l){var f=function(e,t,n){var r=Object(ee.s)(t.end,t.start);if(r===n)return t;if(r>n)return{start:t.start,end:Object(ee.e)(t.start,n)};var a=n-r,c=Math.abs(Object(ee.s)(t.end,e.end)),i=Math.abs(Object(ee.s)(e.start,t.start)),o=t.start,u=t.end;if(c>0){var d=Math.min(a,c);u=Object(ee.e)(u,d),a-=d}if(a>0&&i>0){var s=Math.min(a,i);o=Object(ee.e)(o,-1*s)}return{start:o,end:u}}(d,a,l);Object(se.h)(f,t,i)}})),Object(c.mutator)(I,(function(e){var t=e.folderId,n=e.instanceKey,a=e.onEventsRemoved;Ft(t);var c=Object(r.f)(t);a(Object(se.o)((function(e){return e.InstanceKey===n}),c))})),Object(c.mutator)(m,(function(e){var t=e.folderId,n=e.predicate,a=e.onEventsRemoved;Ft(t);var c=Object(r.f)(t);a(Object(se.o)(n,c))})),Object(c.mutator)(C,(function(e){var t=e.folderId;Object(Pt.a)().calendarFolderEvents.delete(t)})),Object(c.mutator)(O,(function(e){var t=e.folderId,n=e.calendarEvents,a=e.forceReplace;Ft(t);var c=n.map((function(e){return St(e.ItemId.Id,e)})),i=Object(r.f)(t);a?Object(se.p)(c,i):Object(se.r)(c,i.events)})),Object(c.mutator)(A,(function(e){Tt(e.existingItem,e.updatedItem)}));var Dt=new Map;var Mt=5;function kt(e,t,n,r){Bt(t,n);var a=e.eventKey,c=n.get(t),i=c.eventInfos,o=Object(V.__read)(i.filter((function(e){return e.eventKey===a})),1)[0];o?Gt(c.eventInfos.indexOf(o),e,c):(i.push(e),function(e,t){!function(e,t,n){for(;e.eventInfos.length>t&&0<e.eventInfos.length;)Ut(0,e,n)}(e,e.maxSize||Mt,t)}(c,r));Object(V.__spread)(n.keys()).forEach((function(t){n.get(t).eventInfos.forEach((function(t){e.eventKey===t.eventKey&&(t.itemResponseShapeType=e.itemResponseShapeType)}))}))}function Lt(e,t,n,r){void 0===r&&(r=function(){}),Bt(t,n);var a=n.get(t),c=Object(V.__read)(a.eventInfos.filter((function(t){return t.eventKey===e})),1)[0],i=a.eventInfos.indexOf(c);return-1!==i&&Ut(i,a,r),-1!==i}function Bt(e,t){if(!t.get(e)){var n=function(e){return Dt.get(e)}(e);t.set(e,{eventInfos:[],maxSize:n})}}function Gt(e,t,n){if(-1===e)throw new Error("Item with eventKey "+t.eventKey+" does not exist in the MRU");n.eventInfos.splice(e,1),n.eventInfos.push(t)}function Ut(e,t,n){if(e<0||e>=t.eventInfos.length)throw new Error("Invalid index to remove "+e);var r=t.eventInfos[e];t.eventInfos.splice(e,1),n(r.eventKey)}function Kt(e){if(e){var t=Object(Pt.a)();t.calendarFolderEvents.get(e)||t.calendarFolderEvents.set(e,Object(se.f)())}}function qt(e,t){return function(n){Object(se.i)([n],e,Object(Pt.a)().calendarFolderEvents.get(t))}}Object(c.mutator)(i,(function(e){var t=e.eventKey,n=e.folderId,r=e.lockId,a=e.partialCalendarEvent,c=e.itemResponseShapeType;Kt(n);var i=Object(Pt.a)();if(a){var o=St(t,a);Object(se.a)(o,r,i.calendarFolderEvents.get(n))}kt({eventKey:t,itemResponseShapeType:c,folderId:n,loadState:0},r,i.fullItemsMruMap,qt(r,n))})),Object(c.mutator)(o,(function(e){var t=e.eventKey,n=e.folderId,r=e.lockId,a=e.itemResponseShapeType;Kt(n),kt({eventKey:t,itemResponseShapeType:a,folderId:n,loadState:2},r,Object(Pt.a)().fullItemsMruMap,qt(r,n))})),Object(c.mutator)(u,(function(e){var t=e.lockId,n=e.eventKey,r=e.folderId,a=e.event,c=e.eventScope,i=e.itemResponseShapeType,o=e.forceOverrideAllPropertiesForEventIfAvailable;Kt(r);var u=Object(Pt.a)(),d=St(n,a),s=3===c;Object(se.a)(d,t,u.calendarFolderEvents.get(r),s,o),kt({eventKey:n,itemResponseShapeType:i,folderId:r,loadState:1},t,u.fullItemsMruMap,qt(t,r))})),Object(c.mutator)(b,(function(e){var t=e.folderId,n=e.eventKey,r=Object(Pt.a)();r.calendarFolderEvents.get(t)&&Object(V.__spread)(r.fullItemsMruMap.keys()).forEach((function(e){Lt(n,e,r.fullItemsMruMap)}))})),Object(c.mutator)(v,(function(e){var t=e.folderId,n=Object(Pt.a)(),r=n.calendarFolderEvents.get(t);if(r){var a=Object(V.__spread)(r.locksInfo.entries()).reduce(Object(se.d)(),{}),c=Object.keys(a);Object(V.__spread)(n.fullItemsMruMap.keys()).forEach((function(e){c.forEach((function(t){return Lt(t,e,n.fullItemsMruMap)}))}))}})),Object(c.mutator)(ze,(function(){var e=Object(Pt.a)();Object(V.__spread)(e.fullItemsMruMap.keys()).forEach((function(t){!function(e,t){Bt(e,t),t.get(e).eventInfos=[]}(t,e.fullItemsMruMap)}))})),Object(c.mutator)(S,(function(e){var t=Object(Pt.a)(),n=e.lockId;!function(e,t,n){Bt(t,n);var r=n.get(t),a=r.eventInfos,c=Object(V.__read)(a.filter((function(t){return t.eventKey===e})),1)[0];c&&Gt(r.eventInfos.indexOf(c),c,r)}(e.eventKey,n,t.fullItemsMruMap)}));var Vt=n(594);function zt(e,t){var n;if(3==t){var r=Object(H.b)(e);n=(null==r?void 0:r.SeriesMasterItemId)?Object(te.a)({Id:r.SeriesMasterItemId.Id}):n=Object(Vt.a)({OccurrenceId:e})}else n=Object(te.a)({Id:e});return n}function Wt(e,t){t&&Ve(e.ParentFolderId.Id)}Object(c.orchestrator)(q,(function(e){return Object(V.__awaiter)(void 0,void 0,void 0,(function(){var t,n,a,c,i,o,u,d,s,l,f,b,v,O,p;return Object(V.__generator)(this,(function(j){switch(j.label){case 0:t=e.eventId,n=e.eventScope,a=e.dataPoint,c=e.actionToExecute,i=e.onEventDeleteSuccess,o=e.onEventDeleteFailed,u=e.responseSent,d=e.actionSource,s=e.errorMessage,l=e.asyncUndoAction,f=Object(H.b)(t.Id),b=(I=f)&&Object(r.h)(I.ParentFolderId.Id),function(e,t,n){if(n){var r=e.ParentFolderId.Id;if(3==t||2==t){var a=e.Start;_(r,(function(n){return n.InstanceKey==e.InstanceKey&&(3==t||2==t&&!Object(ee.Hb)(n.Start,a))}))}else _(r,(function(t){return t.ItemId.Id===e.ItemId.Id}))}}(f,n,b),a&&a.markUserPerceivedTime(),v=zt(t.Id,n),null,j.label=1;case 1:return j.trys.push([1,4,,5]),[4,l(f,u,d)];case 2:return j.sent()?(Wt(f,b),[2]):[4,c(v)];case 3:if(!j.sent().isSuccessful)throw new Error(s);return[3,5];case 4:throw O=j.sent(),Wt(f,b),p=function(){return q(t,n,null,c,i,(function(){return o(O,null,d)}),d,s,u)},o(O,p,d),O;case 5:return i(),[2]}var I}))}))}));var Ht=n(1284),Jt=n(1288),Yt=(Object(c.orchestrator)(s,(function(e){return Object(V.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r,a,c,i,o;return Object(V.__generator)(this,(function(u){switch(u.label){case 0:return t=e.partialCalendarEvent,n=Object(Rt.a)(t),r=t.ParentFolderId.Id,null===Object(At.f)(t.ItemId.Id)?[3,2]:(a=Object($.h)("cal-cache-update")?Ht.b:Ht.a,c=Object(At.b)(t.ItemId.Id),i=Object(Jt.a)(c),[4,a(t.ItemId,r,i)]);case 1:(o=u.sent().calendarEvent)&&d(r,n,c,o),u.label=2;case 2:return[2]}}))}))})),n(240));Object(c.orchestrator)(K,(function(e){return Object(V.__awaiter)(void 0,void 0,void 0,(function(){var t,n,a,c,i,o,u,d,s,l,f,b,v,O,j,I;return Object(V.__generator)(this,(function(m){switch(m.label){case 0:t=e.eventId,n=e.eventChanges,a=e.errorMessage,c=e.actionToExecute,i=e.onEventUpdateFailed,o=e.onEventUpdateSuccess,u=e.onEventUpdatedLocally,d=e.actionSource,s=e.eventScope,l=Object(H.b)(t.Id),f=zt(t.Id,e.eventScope),l&&Object(Q.I)(l.CalendarItemType)&&(s=3),(b=function(e,t){if(!e)return!1;var n=e.ParentFolderId.Id;if(!Object(r.h)(n))return!1;var a=t.ParentFolderId;if(a&&a.Id!=n)return!1;return!0}(l,n))&&function(e,t,n,a,c){var i,o,u=e.ParentFolderId.Id;!Object(Q.F)(e.CalendarItemType)||0!=n&&1!=n||(t.CalendarItemType="Exception");var d=Object(V.__assign)(Object(V.__assign)({},e),t);if(3==n||2==n)if(t.Recurrence||t.Start||t.StartTimeZoneId||t.End||t.EndTimeZoneId||2==n){var s=e.Start;if(_(u,(function(t){return(Object(Q.F)(t.CalendarItemType)||Object(Q.z)(t.CalendarItemType))&&t.InstanceKey==e.InstanceKey&&(3==n||2==n&&!Object(ee.Hb)(t.Start,s))})),3===n||2===n){var l=Object(r.d)(u);2===n&&(g=l,y=e.Start,E=[],g.forEach((function(e,t){Object(ee.p)(e.start,y)<=0&&Object(ee.p)(e.end,y)<=0&&E.push(t),Object(ee.p)(e.start,y)<=0&&Object(ee.p)(e.end,y)>0&&(e.start=Object(ee.Xb)(y))})),E.reverse().forEach((function(e){g.splice(e,1)})));var f=d;"Occurrence"!=d.CalendarItemType||d.Recurrence||(f=Object(H.b)(d.SeriesMasterItemId.Id))||(f=d);var b=It(f,l),v=2===n;Object(ue.a)(b.concat(d),v),delete t.Start,delete t.End;var O=b.map((function(e){return Object(V.__assign)(Object(V.__assign)(Object(V.__assign)({},e),t),{CalendarItemType:"Occurrence"})}));p(d.ParentFolderId.Id,O)}}else{var j=Object(H.a)(u,(function(t){return t.InstanceKey==e.InstanceKey&&Object(Q.F)(t.CalendarItemType)}));try{for(var I=Object(V.__values)(j),m=I.next();!m.done;m=I.next()){var h=m.value;A(h,t),M(h)}}catch(e){i={error:e}}finally{try{m&&!m.done&&(o=I.return)&&o.call(I)}finally{if(i)throw i.error}}}var g,y,E;if(!Object(Q.z)(e.CalendarItemType)||3!=n){var w=null==e.InstanceKey||Object(Q.F)(e.CalendarItemType)||Object(Q.z)(e.CalendarItemType);qe(d,w,!0)}a(d,c)}(l,n,s,u,d),v=function(){return K(t,n,s,c,o,(function(){return i(a,null,d)}),d,a)},O=null,m.label=1;case 1:return m.trys.push([1,3,,4]),[4,c(f)];case 2:return O=m.sent(),[3,4];case 3:throw j=m.sent(),b&&Ve(l.ParentFolderId.Id),i(j,v,d),j;case 4:if(!O.isSuccessful)throw b&&Ve(l.ParentFolderId.Id),i(a,v,d),a;return(null===(I=n.ParentFolderId)||void 0===I?void 0:I.mailboxInfo)&&Object(Yt.n)(n.ParentFolderId.mailboxInfo.userIdentity)&&(Ve(n.ParentFolderId.Id,!0),Ve(l.ParentFolderId.Id,!0)),o(),[2]}}))}))}));var Qt=n(161),Zt=(Object(c.orchestrator)(Qt.l,We),n(108));function Xt(e){var t=Object(Y.u)(e),n=t&&Object(Y.p)({id:t});return n?n.CharmId:null}function $t(e){return(null==e?void 0:e.CharmId)||Xt(e.ParentFolderId.Id)}function en(){Object(r.b)().map((function(e){Object(Se.e)(Object(Y.o)(e))&&Ke(e,!0)}))}var tn=3e5;function nn(e){e?Object(He.b)(en,"RELOAD_LINKEDCALENDAR_ENTRIES",tn):Object(He.a)("RELOAD_LINKEDCALENDAR_ENTRIES")}function rn(e,t,n){return{FreeBusyType:"Decline"===n?"Free":"Free"===e&&"Decline"!==t?"Free":"Accept"===n?"Busy":"Tentative",AppointmentReplyTime:Object(ee.Qb)(),ResponseType:n}}var an=n(314),cn=n(1897),on=n(24),un={};function dn(e,t){return e+t}function sn(e,t){var n=dn(e,t);return un[n]||Promise.resolve({calendarEvent:null,error:"Could not find full event promise in existing promises"})}function ln(e,t,n,r,a,c){var i,o,u;void 0===n&&(n=null),void 0===a&&(a={fetchSource:"unknown"});var d=bn(n,r);c||(c=Object(At.b)(t.Id));var s,l=Object(At.e)(t.Id,c);if(l)s=function(e,t,n,r,a,c){var i=a(t);switch(n.loadState){case 1:return{event:i,fullEventPromise:Promise.resolve({calendarEvent:i,error:null}),promiseSource:2};case 0:return{event:i,fullEventPromise:sn(t.Id,c),promiseSource:0};case 2:var o=On(i,t,r,e,c);return Object(V.__assign)({event:i},o);default:return Object(an.a)(n.loadState)}}(n=n||l.folderId,t,l,!1,d,c);else{var f=d(t),b=On(f,t,!1,n||(null===(i=null==f?void 0:f.ParentFolderId)||void 0===i?void 0:i.Id)||null,c);s=Object(V.__assign)({event:f},b)}var v=null;return s&&(n=n||(null===(u=null===(o=s.event)||void 0===o?void 0:o.ParentFolderId)||void 0===u?void 0:u.Id)||null,v={event:s.event,fullEventPromise:pn(s.fullEventPromise,s.promiseSource,s.event,e,n,a,t.Id,!1,c)}),v}function fn(e,t,n,r,a,c){var i,o,u;void 0===n&&(n=null),void 0===a&&(a={fetchSource:"unknown"});var d,s=bn(n,r)(t);n=n||(null===(i=null==s?void 0:s.ParentFolderId)||void 0===i?void 0:i.Id);var l=s&&Object(Rt.b)(s);c||(c=l?Object(At.b)(l):Object(At.c)());var f=null;return(d=function(e,t,n,r,a){var c=r&&Object(At.e)(r,n);if(c&&1===c.loadState){var i=Object(H.c)(r,e);return{event:i,fullEventPromise:Promise.resolve({calendarEvent:i,error:null}),promiseSource:2}}return c&&0===c.loadState?{event:Object(H.c)(r,e)||vn(a),fullEventPromise:sn(r,n),promiseSource:0}:{event:vn(a),fullEventPromise:jn(t,!0,e,n),promiseSource:0}}(n,t,c,l,s))&&(n=n||(null===(u=null===(o=d.event)||void 0===o?void 0:o.ParentFolderId)||void 0===u?void 0:u.Id)||null,f={event:d.event,fullEventPromise:pn(d.fullEventPromise,d.promiseSource,d.event,e,n,a,l,!0,c)}),f}function bn(e,t){return function(n){return Object(H.b)(n.Id,e)||(null==t?void 0:t(n))}}function vn(e){return e&&Object(V.__assign)(Object(V.__assign)({},Object(cn.a)(Object(on.toJS)(e))),{ItemId:Object(V.__assign)({},null==e?void 0:e.SeriesMasterItemId),CalendarItemType:"RecurringMaster"})}function On(e,t,n,r,a){return e&&e.EffectiveRights&&!Object(Q.v)(e)?{fullEventPromise:Promise.resolve({calendarEvent:e,error:null}),promiseSource:1}:{fullEventPromise:jn(t,n,r,a),promiseSource:0}}function pn(e,t,n,r,a,c,d,s,l){return Object(V.__awaiter)(this,void 0,void 0,(function(){var f,b,v,O,p,j,I,_,m,h;return Object(V.__generator)(this,(function(g){switch(g.label){case 0:f=Object(At.d)(r,d,l),b=null,v=null,O=null,g.label=1;case 1:return g.trys.push([1,5,6,7]),Ce.g.info("[fetchFullCalendarEvent] Handling loading full calendar event Key: "+d+", Lock: "+r),!a||f&&1===f.loadState||d&&(Ce.g.info("[fetchFullCalendarEvent] Loading full calendar event Key: "+d+", Lock: "+r),function(e,t,n){var r=dn(e,t);un[r]=n}(d,l,e),i(r,a,d,l,n)),2!=t?[3,2]:(b=n,[3,4]);case 2:return[4,e];case 3:p=g.sent(),b=null==p?void 0:p.calendarEvent,v=null==p?void 0:p.error,O=null==p?void 0:p.responseCode,void 0===d&&(d=Object(Rt.a)(p.calendarEvent)),g.label=4;case 4:if(!b)throw j=new Error("[fetchFullCalendarEventNEW] Action source:"+c.fetchSource+" with error: "+v),O&&(j.responseCode=O,j.fetchErrorType="ServerFailure"),j.diagnosticInfo=JSON.stringify({responseCode:O,eventKey:d}),j;return I=a||b.ParentFolderId.Id,h=f,f=Object(At.d)(r,d,l),!I||f&&1===f.loadState?(Ce.g.info('[fetchFullCalendarEvent] Full calendar event already loaded. EventKey: "'+d+'", Lock: "'+r+'", FolderId: "'+I+'"'),S(r,d)):(Ce.g.info('[fetchFullCalendarEvent] Loaded full calendar event Key: "'+d+'", Lock: "'+r+'", FolderId: "'+I+'"'),Object(J.o)("FullCalendarEventLoaded",Object(V.__assign)({eventKey:d,lockId:r,prevFullItemLoadState:h?h.loadState:null,fullItemLoadState:f?f.loadState:null,isFullItem:void 0!==b.RequiredAttendees,isSameAsExistingEvent:n===b,eventScope:s?3:0,errorMessage:null},c)),u(r,I,d,l,b,s?3:0,0===t)),(_=Object(H.c)(d,a))&&M(_),[2,_];case 5:throw m=g.sent(),h=f,f=Object(At.d)(r,d,l),Object(J.o)("FullCalendarEventLoaded",Object(V.__assign)({eventKey:d,lockId:r,prevFullItemLoadState:h?h.loadState:null,fullItemLoadState:f?f.loadState:null,isFullItem:!1,isSameAsExistingEvent:!1,eventScope:s?3:0,errorMessage:m.toString()},c)),a&&o(r,a,d,l),m;case 6:return function(e,t){var n=dn(e,t);delete un[n]}(d,l),[7];case 7:return[2]}}))}))}function jn(e,t,n,r){var a=this;return Object(V.__awaiter)(a,void 0,void 0,(function(){return Object(V.__generator)(this,(function(a){switch(a.label){case 0:return[4,In(fe,e,t,n,r)];case 1:return[2,a.sent()]}}))}))}function In(e,t,n,r,a){return Object(V.__awaiter)(this,void 0,void 0,(function(){var c,i,o;return Object(V.__generator)(this,(function(u){switch(u.label){case 0:c=0,u.label=1;case 1:if(!(c<e))return[3,6];u.label=2;case 2:return u.trys.push([2,4,,5]),[4,Object(Ht.b)(t,r,Object(Jt.a)(a),n)];case 3:return i=u.sent(),c++,!i.error||c>=e?[2,i]:[3,5];case 4:if(o=u.sent(),Ce.g.warn('[fetchFullCalendarEvent] Received error when trying to load calendar event from server for "'+t.Id+'" with try '+c+": Error "+o.toString()),++c>=e)throw o;return[3,5];case 5:return[3,1];case 6:return[2,{calendarEvent:null,error:"Error: Unable to fetch event"}]}}))}))}var _n={};function mn(e,t){return e+t}function hn(e,t){var n=mn(e,t);return _n[n]||Promise.resolve({calendarEvent:null,error:"Could not find full event promise in existing promises"})}function gn(e,t,n,r,a,c,i){var o,u,d;void 0===n&&(n=null),void 0===r&&(r=function(){return null}),void 0===a&&(a=0),void 0===c&&(c={fetchSource:"unknown"});var s=3===a,l=function(e,t){return function(n){return Object(H.b)(n.Id,e)||(null==t?void 0:t(n))}}(n,r);i||(i=Object(At.b)(t.Id));var f,b=Object(At.e)(t.Id,i);if(b)f=function(e,t,n,r,a,c){var i=c(t),o=3==a;if(i&&o)return yn(e,i,n);if(!i&&o)return{event:i,fullEventPromise:Promise.resolve({calendarEvent:null,error:"Error: Could not find existing calendar event data needed in order to fetch a series master event."}),promiseSource:null};switch(r.loadState){case 1:return{event:i,fullEventPromise:Promise.resolve({calendarEvent:i,error:null}),promiseSource:2};case 0:return{event:i,fullEventPromise:hn(t.Id,n),promiseSource:0};case 2:var u=En(i,t.Id,n,t,a,e);return Object(V.__assign)({event:i},u);default:return Object(an.a)(r.loadState)}}(n=n||b.folderId,t,i,b,a,l);else{var v=l(t);if(v&&s)f=yn(n=n||v.ParentFolderId.Id,v,i);else{if(!v&&s)return null;var O=En(v,t.Id,i,t,a,n||(null===(o=null==v?void 0:v.ParentFolderId)||void 0===o?void 0:o.Id)||null);f=Object(V.__assign)({event:v},O)}}var p=null;if(f){var j=s||f.event&&Object(Q.I)(f.event.CalendarItemType)?f.event.InstanceKey:t.Id;n=n||(null===(d=null===(u=f.event)||void 0===u?void 0:u.ParentFolderId)||void 0===d?void 0:d.Id)||null,p={event:f.event,fullEventPromise:wn(f.fullEventPromise,f.promiseSource,f.event,e,n,c,j,a,i)}}return p}function yn(e,t,n){var r=t.InstanceKey,a=Object(At.e)(r,n);if(a&&1===a.loadState){var c=Object(H.c)(r,e);return{event:c,fullEventPromise:Promise.resolve({calendarEvent:c,error:null}),promiseSource:2}}return a&&0===a.loadState?{event:Object(H.c)(r,e)||t,fullEventPromise:hn(r,n),promiseSource:0}:{event:Object(V.__assign)(Object(V.__assign)({},t),{CalendarItemType:"RecurringMaster"}),fullEventPromise:Cn(r,t.ItemId,3,t.ParentFolderId.Id,t.SeriesMasterItemId,n),promiseSource:0}}function En(e,t,n,r,a,c){return e&&e.EffectiveRights&&!Object(Q.v)(e)?{fullEventPromise:Promise.resolve({calendarEvent:e,error:null}),promiseSource:1}:{fullEventPromise:Cn(t,r,a,c,null==e?void 0:e.SeriesMasterItemId,n),promiseSource:0}}function wn(e,t,n,r,a,c,d,s,l){return Object(V.__awaiter)(this,void 0,void 0,(function(){var f,b,v,O,p,j,I,_,m,h;return Object(V.__generator)(this,(function(g){switch(g.label){case 0:f=Object(At.d)(r,d,l),b=null,v=null,O=null,g.label=1;case 1:return g.trys.push([1,5,6,7]),Ce.g.info("[fetchFullCalendarEvent] Handling loading full calendar event Key: "+d+", Lock: "+r),!a||f&&1===f.loadState||(Ce.g.info("[fetchFullCalendarEvent] Loading full calendar event Key: "+d+", Lock: "+r),function(e,t,n){var r=mn(e,t);_n[r]=n}(d,l,e),i(r,a,d,l,n)),2!=t?[3,2]:(b=n,[3,4]);case 2:return[4,e];case 3:p=g.sent(),b=null==p?void 0:p.calendarEvent,v=null==p?void 0:p.error,O=null==p?void 0:p.responseCode,g.label=4;case 4:if(!b)throw j=new Error("[fetchFullCalendarEvent] Action source:"+c.fetchSource+" with error: "+v),O&&(j.responseCode=O,j.fetchErrorType="ServerFailure"),j.diagnosticInfo=JSON.stringify({responseCode:O,eventKey:d}),j;return I=a||b.ParentFolderId.Id,h=f,f=Object(At.d)(r,d,l),!I||f&&1===f.loadState?(Ce.g.info('[fetchFullCalendarEvent] Full calendar event already loaded. EventKey: "'+d+'", Lock: "'+r+'", FolderId: "'+I+'"'),S(r,d)):(Ce.g.info('[fetchFullCalendarEvent] Loaded full calendar event Key: "'+d+'", Lock: "'+r+'", FolderId: "'+I+'"'),Object(J.o)("FullCalendarEventLoaded",Object(V.__assign)({eventKey:d,lockId:r,prevFullItemLoadState:h?h.loadState:null,fullItemLoadState:f?f.loadState:null,isFullItem:void 0!==b.RequiredAttendees,isSameAsExistingEvent:n===b,eventScope:s,errorMessage:null},c)),u(r,I,d,l,b,s,0===t)),(_=Object(H.c)(d,a))&&M(_),[2,_];case 5:throw m=g.sent(),h=f,f=Object(At.d)(r,d,l),Object(J.o)("FullCalendarEventLoaded",Object(V.__assign)({eventKey:d,lockId:r,prevFullItemLoadState:h?h.loadState:null,fullItemLoadState:f?f.loadState:null,isFullItem:!1,isSameAsExistingEvent:!1,eventScope:s,errorMessage:m.toString()},c)),a&&o(r,a,d,l),m;case 6:return function(e,t){var n=mn(e,t);delete _n[n]}(d,l),[7];case 7:return[2]}}))}))}function Cn(e,t,n,r,a,c){var i=this;return Object(V.__awaiter)(i,void 0,void 0,(function(){return Object(V.__generator)(this,(function(e){switch(e.label){case 0:return[4,Sn(fe,t,n,r,a,c)];case 1:return[2,e.sent()]}}))}))}function Sn(e,t,n,r,a,c){return Object(V.__awaiter)(this,void 0,void 0,(function(){var i,o,u,d;return Object(V.__generator)(this,(function(s){switch(s.label){case 0:i=0,s.label=1;case 1:if(!(i<e))return[3,6];s.label=2;case 2:return s.trys.push([2,4,,5]),o=Object(Jt.a)(c),[4,Object(Ht.a)(t,r,o,n,a)];case 3:return u=s.sent(),i++,!u.error||i>=e?[2,u]:[3,5];case 4:if(d=s.sent(),Ce.g.warn('[fetchFullCalendarEvent] Received error when trying to load calendar event from server for "'+t.Id+'" with try '+i+": Error "+d.toString()),++i>=e)throw d;return[3,5];case 5:return[3,1];case 6:return[2,{calendarEvent:null,error:"Error: Unable to fetch event"}]}}))}))}function An(e){var t=this;if(!e)throw new Error("The lock id should be provided");return{fetchCalendarEventsForDateRange:function(t,n){var r=Le(e,t,n);return{fetchPromise:r.fetchPromise,enhancedFetchPromise:r.enhancedFetchPromise,events:r.events}},subscribeNotifications:function(t){return rt(t,e)},fetchFullCalendarEvent:function(n,r,a,c,i){var o=Object(H.b)(n.Id),u=Pn(e,n,r,a,c,i,(null==o?void 0:o.IsOrganizer)?"WithBlockedExternalContent":null),d=u.event,s=u.fullEventPromise;return s=s.then((function(o){return Object(V.__awaiter)(t,void 0,void 0,(function(){return Object(V.__generator)(this,(function(t){switch(t.label){case 0:return o.IsOrganizer&&o.HasBlockedImages?[4,Pn(e,n,r,a,c,i,"WithBlockedExternalContent").fullEventPromise]:[3,2];case 1:o=t.sent(),t.label=2;case 2:return[2,o]}}))}))})),{event:d,fullEventPromise:s}},fetchFullCalendarEventAndUpdateItemResponseShapeType:function(t,n,r,a,c,i){return Pn(e,t,r,a,c,i,n)},getLockId:function(){return e},release:function(){return g(e)}}}function Pn(e,t,n,r,a,c,i){var o=3===a;return Object($.h)("cal-cache-update")?o?fn(e,t,n,r,c,i):ln(e,t,n,r,c,i):gn(e,t,n,r,a,c,i)}function xn(e){var t=Object(se.g)();return e&&function(e,t){t?Dt.set(e,t):Dt.delete(e)}(t,e.maxMruSize),An(t)}function Rn(e){return{getCalendarEventsForDateRange:function(t,n){return le(e,t,n)},getEnhancedCalendarEventsForDateRange:function(t,n){return function(e,t,n){return Fe(t,n)?le(e,t,n):null}(e,t,n)},getFullCalendarEvent:function(t,n){return Object(H.d)(t,n,e)}}}n.d(t,"t",(function(){return Fn})),n.d(t,"j",(function(){return H.b})),n.d(t,"c",(function(){return N})),n.d(t,"b",(function(){return D})),n.d(t,"a",(function(){return M})),n.d(t,"d",(function(){return k})),n.d(t,"f",(function(){return B})),n.d(t,"u",(function(){return G})),n.d(t,"q",(function(){return U})),n.d(t,"s",(function(){return K})),n.d(t,"r",(function(){return q})),n.d(t,"w",(function(){return bt})),n.d(t,"x",(function(){return ft})),n.d(t,"h",(function(){return Xt})),n.d(t,"k",(function(){return $t})),n.d(t,"n",(function(){return zt})),n.d(t,"m",(function(){return At.f})),n.d(t,"l",(function(){return Rt.a})),n.d(t,"v",(function(){return nn})),n.d(t,"i",(function(){return rn})),n.d(t,"g",(function(){return ce})),n.d(t,"e",(function(){return xn})),n.d(t,"p",(function(){return An})),n.d(t,"o",(function(){return Rn}));var Tn=new Zt.c((function(){return Promise.all([n.e(4),n.e(256)]).then(n.bind(null,15280))})),Fn=new Zt.a(Tn,(function(e){return e.getCalendarEventsFromRest}))},994:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return u}));var r=n(1075);function a(e,t){if(null==e&&null!=t||null!=e&&null==t)return!1;if(null==e&&null==t)return!0;if(0==e.length&&0==t.length)return!0;if(e.length!=t.length)return!1;for(var n=0;n<e.length;){if(!c(e[n],t[n]))return!1;n++}return!0}function c(e,t){return!(!e&&t||e&&!t)&&(e.Id===t.Id||Object(r.a)(e.PostalAddress)&&Object(r.a)(t.PostalAddress)&&e.PostalAddress.LocationUri.toLowerCase()===t.PostalAddress.LocationUri.toLowerCase())}function i(e,t){return e&&Object(r.a)(t.PostalAddress)?o(e,t.PostalAddress.LocationUri):u(e,t.Id)}function o(e,t){return!!(t&&e&&e.some((function(e){return Object(r.a)(e.PostalAddress)&&e.PostalAddress.LocationUri.toLowerCase()===t.toLowerCase()})))}function u(e,t){return e&&e.some((function(e){return e.Id===t}))}}}]);
//# sourceMappingURL=owa.UpNextV2.js.map
self.scriptsLoaded['owa.UpNextV2.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.UpNextV2.js'] = (new Date()).getTime();