self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.TeamsCalendars.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[564],{10656:function(e,r,t){"use strict";t.r(r);var n=t(0),a=t(4),c=t(4144),o=t(6517);var u=Object(a.action)("getTeamsCalendarsService",(function(){return function(){return Object(n.__awaiter)(this,void 0,void 0,(function(){var e;return Object(n.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(o.d)()];case 1:return null!=(e=r.sent())?[2,Object(c.e)(e)]:[2,null]}}))}))}()})),i=t(160);function l(){return Object(n.__awaiter)(this,void 0,void 0,(function(){var e;return Object(n.__generator)(this,(function(r){switch(r.label){case 0:return[4,u()];case 1:return null!=(e=r.sent())&&null!=e.groupCalendars&&(e.groupCalendars.forEach((function(e){Object(i.b)(e.entry,e.folder,e.mailboxInfo)})),Object(i.a)(e.calendarGroup)),[2]}}))}))}t.d(r,"getSelectedTeamsCalendars",(function(){return l}))},15362:function(e,r,t){"use strict";t.r(r);var n=t(0),a=t(8418),c=t(76),o=t(254);function u(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){var e,r,t,u;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:e=new o.a("initializeSelectedTeamsCalendars"),!0,r=Object(c.h)("cal-showAddTeamsCalendars"),t=r&&!0,e.addCustomData({issueServiceCall:t,featureEnabled:r,refresh:!0}),n.label=1;case 1:return n.trys.push([1,4,,5]),t?[4,a.e.importAndExecute()]:[3,3];case 2:n.sent(),n.label=3;case 3:return e.end(),[3,5];case 4:throw u=n.sent(),e.endWithError("ServerError",Error(u)),u;case 5:return[2]}}))}))}t.d(r,"initializeSelectedTeamsCalendars",(function(){return u}))},1768:function(e,r,t){"use strict";var n=t(287),a=!0,c=!0;function o(e,r){return Object(n.f)(e,"GET",r,{throwServiceError:a})}function u(e,r,t){return Object(n.f)(e,"DELETE",r,{requestObject:t,sendPayloadAsBody:c,throwServiceError:a})}function i(e,r,t,o){return Object(n.f)(e,"POST",r,{requestObject:t,sendPayloadAsBody:c,throwServiceError:a,customHeaders:d(o)})}function l(e,r,t,o){return Object(n.f)(e,"PATCH",r,{requestObject:t,sendPayloadAsBody:c,throwServiceError:a,customHeaders:d(o)})}function d(e){return!0===e?{Prefer:"return=representation"}:!1===e?{Prefer:"return=minimal"}:void 0}t.d(r,"b",(function(){return o})),t.d(r,"a",(function(){return u})),t.d(r,"d",(function(){return i})),t.d(r,"c",(function(){return l}))},251:function(e,r,t){"use strict";t.d(r,"i",(function(){return m})),t.d(r,"a",(function(){return g})),t.d(r,"b",(function(){return v})),t.d(r,"j",(function(){return C})),t.d(r,"m",(function(){return p})),t.d(r,"d",(function(){return y})),t.d(r,"c",(function(){return L})),t.d(r,"e",(function(){return S})),t.d(r,"g",(function(){return k})),t.d(r,"f",(function(){return A})),t.d(r,"k",(function(){return w})),t.d(r,"h",(function(){return T})),t.d(r,"n",(function(){return D})),t.d(r,"l",(function(){return I}));var n=t(0),a=t(14),c=t(291),o=t.n(c),u=t(242),i=t(9),l=t(19),d=t(213),s=t(342),f=4.5,h=.3,b={calDarker:-44,calDark:-24,calDarkAlt:-10,calPrimary:0,calSecondary:12,calTertiary:40,calLight:70,calLighter:84,calLighterAlt:96};function m(){if(Object(l.e)()&&Object(l.c)().getDefaultCalendarColor)return Object(l.c)().getDefaultCalendarColor();var e=Object(d.d)();return e&&e.toUpperCase()!==O?e.toUpperCase():j}var g="#DC3B00",v="#DA3B01",O="#0078D7",j=Object(d.d)();function C(){return k(Object(d.i)().neutralLight)}function p(e){return e.calPrimary.toUpperCase()===m().toUpperCase()}function x(){var e;return(e={})[m()]=function(){return Object(i.b)(s.a)},e["#498205"]=function(){return Object(i.b)(s.c)},e["#C50F1F"]=function(){return Object(i.b)(s.h)},e["#003966"]=function(){return Object(i.b)(s.e)},e["#69797E"]=function(){return Object(i.b)(s.b)},e["#038387"]=function(){return Object(i.b)(s.i)},e["#E3008C"]=function(){return Object(i.b)(s.d)},e[v]=function(){return Object(i.b)(s.f)},e["#744DA9"]=function(){return Object(i.b)(s.g)},e}function y(e,r){return o()(e).alpha(r).toString()}function L(e,r){var t=o()(e),n=t.value(),a=Math.max(Math.min(n+r,100),0);return t.value(a).toString()}function S(e,r){var t=o()(e),n=t.saturationv(),a=Math.max(Math.min(n+r,100),0);return t.saturationv(a).toString()}function k(e){var r=o()(e),t={text:"",textAlt:"",accessibleText:{calPrimaryBackground:"",calLighterBackground:"",msColorWhiteBackground:"",msColorNeutralLighterBackground:""},calDarker:_(r,Object(u.c)()?b.calLighterAlt:b.calDarker).hex(),calDark:_(r,Object(u.c)()?b.calLighter:b.calDark).hex(),calDarkAlt:_(r,Object(u.c)()?b.calLight:b.calDarkAlt).hex(),calPrimary:r.hex(),calSecondary:_(r,Object(u.c)()?-b.calSecondary:b.calSecondary).hex(),calTertiary:_(r,Object(u.c)()?-b.calTertiary:b.calTertiary).hex(),calLight:_(r,Object(u.c)()?b.calDarkAlt:b.calLight).hex(),calLighter:_(r,Object(u.c)()?b.calDark:b.calLighter).hex(),calLighterAlt:_(r,Object(u.c)()?b.calDarker:b.calLighterAlt).hex(),colorName:function(){return P(r.hex())}};return t.accessibleText=E(t),t.text=t.accessibleText.calPrimaryBackground,t.textAlt=t.accessibleText.calLighterBackground,t}function A(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];for(var t=o()(e[e.length-1]),n=e.length-2;n>=0;n--){var a=o()(e[n]),c=a.alpha()+t.alpha()*(1-a.alpha());t=o()({r:Math.floor((a.alpha()*a.red()+t.alpha()*(1-a.alpha())*t.red())/c),g:Math.floor((a.alpha()*a.green()+t.alpha()*(1-a.alpha())*t.green())/c),b:Math.floor((a.alpha()*a.blue()+t.alpha()*(1-a.alpha())*t.blue())/c),alpha:c})}return t.toString()}function w(e,r,t,n){void 0===n&&(n=f);var a=o()(e),c=o()(t);if(B(c,a)>=n)return c.hex();var u,i,l=21,d=0;if(Object.keys(r).forEach((function(e){var t=r[e];if(t&&"string"==typeof t){var c=o()(t),s=B(c,a);s>=n&&s<l?(u=c,l=s):s<n&&s>d&&(i=c,d=s)}})),u)return u.hex();var s=o()({r:255,g:255,b:255}),b=s.contrast(a);if(b>=n)return s.hex();b<n&&b>d&&(i=s,d=b);for(var m=o()(r.calPrimary),g=0,v=m.value(),O=0;O<7;O++){var j=(v+g)/2,C=(m=m.value(j)).contrast(a);C<n&&C>d&&(i=m,d=C),C<n+.1?v=j:g=j}var p=m.contrast(a);return p<n&&i&&p<d&&(m=i,p=d),b>=f&&Math.abs(b-p)<h?s.hex():m.hex()}function T(){return Object.keys(x()).map((function(e){return k(e)}))}function D(e){return Object(a.createTheme)({palette:Object(n.__assign)(Object(n.__assign)({},Object(d.h)()),{themePrimary:e.calPrimary,themeLighterAlt:e.calLighterAlt,themeLighter:e.calLighter,themeLight:e.calLight,themeTertiary:e.calTertiary,themeSecondary:e.calSecondary,themeDarkAlt:e.calDarkAlt,themeDark:e.calDark,themeDarker:e.calDarker}),semanticColors:{menuHeader:e.accessibleText.msColorWhiteBackground}})}function I(){var e=Object(d.i)(),r={text:"",textAlt:"",accessibleText:{calPrimaryBackground:"",calLighterBackground:"",msColorWhiteBackground:"",msColorNeutralLighterBackground:""},calDarker:e.themeDarker,calDark:e.themeDark,calDarkAlt:e.themeDarkAlt,calPrimary:e.themePrimary,calSecondary:e.themeSecondary,calTertiary:e.themeTertiary,calLight:e.themeLight,calLighter:e.themeLighter,calLighterAlt:e.themeLighterAlt,colorName:function(){return P(e.themePrimary)}};return r.accessibleText=E(r),r.text=r.accessibleText.calPrimaryBackground,r.textAlt=r.accessibleText.calLighterBackground,r}function E(e){var r=Object(d.i)().white;return{calPrimaryBackground:w(e.calPrimary,e,r,f),calLighterBackground:w(e.calLighter,e,r,f),msColorWhiteBackground:w(Object(d.i)().white,e,r,f),msColorNeutralLighterBackground:w(Object(d.i)().neutralLighter,e,r,f)}}function P(e){var r=x();return r[e]?r[e]():e}function B(e,r){return Math.floor(100*e.contrast(r))/100}function _(e,r){var t=o()(e.rgb());return 0==r?t:t=(t=(t=r<0?t.value(e.value()*(1+r/100)):(t=t.value(e.value()+(100-e.value())*r/100)).saturationv(e.saturationv()*(1-r/100))).saturationv(N(t.saturationv()))).value(N(t.value()))}function N(e){return e<0?0:e>100?100:e}},342:function(e){e.exports=JSON.parse('{"a":"Oaa","c":"Paa","h":"Qaa","e":"Raa","b":"Saa","i":"Taa","d":"Uaa","f":"Vaa","g":"Waa"}')},4144:function(e,r,t){"use strict";var n=t(8419),a=t(9),c=t(160),o="Teams",u=t(114),i=t(414),l=t(4764);function d(e){var r=[],t=[];if(e.forEach((function(e){var n=f(e),a=h(e),c=b(e),o=s(e);r.push({entry:a,folder:c,mailboxInfo:n}),t.push(o)})),t.length>0){var c=Object(u.e)(),i={type:u.a.TeamsMailbox,userIdentity:c.userIdentity,mailboxSmtpAddress:c.mailboxSmtpAddress,routingKey:Object(u.b)(),requestOptions:null},l={id:{id:o,mailboxInfo:i},GroupId:o,ItemId:{Id:o},GroupName:Object(a.b)(n.a),GroupType:3};return{groupCalendars:r,calendarGroup:l}}return null}function s(e){var r={id:{id:Object(l.a)(e.channelId),mailboxInfo:f(e)},calculatedFolderId:e.teamSmtpAddress.toLowerCase(),displayName:e.channelName+" - "+e.teamName,colorScheme:null};return r||null}function f(e){var r=e.teamSmtpAddress.toLowerCase(),t={type:u.a.TeamsMailbox,mailboxSmtpAddress:r,userIdentity:Object(u.e)().userIdentity,routingKey:Object(u.c)()+r,requestOptions:null};return t||null}function h(e){var r=Object(l.a)(e.channelId),t={__type:i.b,CalendarColor:-1,CalendarName:e.channelName+" - "+e.teamName,OwnerEmailAddress:Object(c.O)(e.teamSmtpAddress.toLowerCase(),r),OwnerName:e.channelName,IsGroupMailboxCalendar:!0,IsGeneralScheduleCalendar:!0,ItemId:{Id:r},ParentGroupId:o};return t||null}function b(e){var r={DistinguishedFolderId:Object(c.O)(e.teamSmtpAddress.toLowerCase(),Object(l.a)(e.channelId)),DisplayName:e.channelName};return r||null}t.d(r,"e",(function(){return d})),t.d(r,"b",(function(){return s})),t.d(r,"d",(function(){return f})),t.d(r,"c",(function(){return h})),t.d(r,"a",(function(){return b}))},4764:function(e,r,t){"use strict";var n=t(578);function a(e){var r=Object(n.a)(e);r||(r=Object(n.e)(-1,!1)),Object(n.k)(e,r)}function c(e){return e.split("@")[0]}t.d(r,"b",(function(){return a})),t.d(r,"a",(function(){return c}))},567:function(e,r,t){"use strict";t.d(r,"a",(function(){return c})),t.d(r,"b",(function(){return o}));var n=t(24),a=t(1);function c(e){return{get:e}}function o(e,r){return Object(a.useMemo)((function(){return Object(n.computed)(e)}),r).get()}},578:function(e,r,t){"use strict";var n,a=t(213),c=t(4),o=t(251),u=t(160),i=t(438),l=t(79);var d=[0,5,1,3,8,6,7,2,4],s=d.map((function(e){return{isLocked:!1,count:0}}));function f(){return n||b(),n}function h(){return d.map((function(e){return f()[e]}))}function b(){n=Object(o.h)(),s=d.map((function(e){return{isLocked:!1,count:0}}))}function m(e,r){var t=void 0===e||-1===e?function(){for(var e=Number.MAX_VALUE,r=0,t=0;t<s.length;t++)!s[t].isLocked&&s[t].count<e&&(e=s[t].count,r=t);return r}():d.indexOf(e);v(t),r&&(s[t].isLocked=!0);var n=d[t],a=f();return n<0||n>=a.length?(l.g.warn("[getColorSchemeForCalendarColor] Calculated usedIndex is outsize default color scheme bounds"),a[a.length-1]):a[n]}function g(e){return Object(o.g)(e)}function v(e){if("number"==typeof e)s[e].count++;else{var r=d.indexOf(O(e));s[r].count++}}function O(e){return function(e,r){for(var t=0,n=e.length;t<n;t++){var a=e[t];if(r(a))return{item:a,index:t}}return null}(f(),(function(r){return r.calPrimary.toLowerCase()==e.toLowerCase()})).index}var j=Object(c.action)("COLOR_RESOLVER_SET_CALENDAR_COLORSCHEME",(function(e,r){return{calendarId:e,colorScheme:r}})),C={assignedCalendarColors:new(t(24).ObservableMap)},p=Object(c.createStore)("calendarColorResolverStore",C);function x(e){return p().assignedCalendarColors.get(e)}function y(e){var r=Object(u.u)(e);if(r)return S(r);var t=x(e);return t||(l.g.warn("[getCalendarColorSchemeByFolderId] Failed to retrieve calendarId and to get assignedColor from calendarFolderId"),m(0))}function L(e){if(!e.ParentFolderId)return l.g.warn("[getCalendarEventColorScheme] Calendar item does not have parent folder id"),m(0);var r=null==e?void 0:e.Categories;return function(e,r){var t,n;if(r&&r.length>0){var a=void 0,c=Object(u.o)(e);if(null===(t=c)||void 0===t?void 0:t.RemoteCategories)a=c.RemoteCategories.MasterList;else{var l=Object(u.u)(e);a=Object(i.n)(l?l.mailboxInfo:null)}var d=Object(i.g)(r[0],a);n=Object(o.g)(d.iconColor)}else n=y(e);return n}(e.ParentFolderId.Id,r)}function S(e,r){var t=x(e.id);return t||(t=k(e,r)),t}function k(e,r){var t,n=Object(u.l)({id:e});return x(e.id)&&function(e){var r;r="string"==typeof e?O(e):e;var t=d.indexOf(r);s[t].count=Math.max(s[t].count-1,0),s[t].isLocked=!1}(x(e.id).calPrimary),(null==n?void 0:n.HexColorString)&&""!=n.HexColorString&&f().some((function(e){return e.calPrimary.toLowerCase()==n.HexColorString.toLowerCase()}))?(t=Object(o.g)(n.HexColorString),v(n.HexColorString)):(null==n?void 0:n.HexColorString)&&""!=n.HexColorString&&o.a.toLowerCase()==n.HexColorString.toLowerCase()?(t=Object(o.g)(o.b),v(o.b)):t=m(null==n?void 0:n.CalendarColor,r),j(e.id,t),t}function A(e){return!!x(e.id)}Object(c.orchestrator)(a.o,(function(){b(),p().assignedCalendarColors.forEach((function(e,r){k({id:r})}))})),Object(c.mutator)(j,(function(e){var r=e.calendarId,t=e.colorScheme;p().assignedCalendarColors.set(r,t)})),t.d(r,"c",(function(){return y})),t.d(r,"d",(function(){return L})),t.d(r,"b",(function(){return S})),t.d(r,"j",(function(){return k})),t.d(r,"i",(function(){return A})),t.d(r,"g",(function(){return f})),t.d(r,"f",(function(){return g})),t.d(r,"h",(function(){return h})),t.d(r,"e",(function(){return m})),t.d(r,"k",(function(){return j})),t.d(r,"a",(function(){return x}))},6517:function(e,r,t){"use strict";var n;!function(e){e[e.Loading=0]="Loading",e[e.Added=1]="Added",e[e.Error=2]="Error",e[e.NotSet=3]="NotSet"}(n||(n={}));var a=t(1768),c="ows/api/TeamsChannels";function o(){var e=c+"/findall";return Object(a.b)("getTeamsChannels",e)}function u(e){var r=c+"/add";return Object(a.d)("addTeamsChannel",r,e)}function i(e){var r={channelId:e},t=c+"/DeleteById";return Object(a.d)("deleteTeamsChannel",t,r)}t.d(r,"a",(function(){return n})),t.d(r,"d",(function(){return o})),t.d(r,"b",(function(){return u})),t.d(r,"c",(function(){return i}))},8418:function(e,r,t){"use strict";t.d(r,"e",(function(){return o}));var n=t(108),a=t(4144);t.d(r,"b",(function(){return a.b})),t.d(r,"d",(function(){return a.d})),t.d(r,"c",(function(){return a.c})),t.d(r,"a",(function(){return a.a}));var c=new n.c((function(){return Promise.all([t.e(19),t.e(26),t.e(564)]).then(t.bind(null,10656))})),o=new n.a(c,(function(e){return e.getSelectedTeamsCalendars}))},8419:function(e){e.exports=JSON.parse('{"a":"kob"}')}}]);
//# sourceMappingURL=owa.TeamsCalendars.js.map
self.scriptsLoaded['owa.TeamsCalendars.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.TeamsCalendars.js'] = (new Date()).getTime();