self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailSmartPill.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[405],{10398:function(e){e.exports=JSON.parse('{"a":"q6c","b":"r6c","c":"s6c","d":"t6c"}')},10399:function(e){e.exports=JSON.parse('{"d":"x6c","e":"y6c","c":"z6c","a":"A6c","b":"B6c"}')},1152:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return m}));var r,a=n(1473),o=n(1270),i=n(966),c={};function u(e){return e in c?c[e]:(c[e]={extraSmall:Object(o.a)(e+"_16x16"),small:Object(o.a)(e+"_20x20"),medium:Object(o.a)(e+"_32x32"),large:Object(o.a)(e+"_64x64"),cdn:Object(a.a)(e+"_16x16")},c[e])}var l="generic",s=Object.freeze({".3g2":"video",".3gp":"video",".aac":"audio",".accdb":"accdb",".accdc":"accdb",".accde":"accdb",".accdr":"accdb",".accdt":"accdb",".acs":"accdb",".ai":"vector",".aiff":"audio",".ape":"audio",".apk":"exe",".application":"exe",".app":"exe",".appref-ms":"exe",".appx":"exe",".asf":"video",".aspx":"code",".asx":"video",".avi":"video",".bmp":"photo",".csv":"csv",".dib":"photo",".dgn":"vector",".doc":"docx",".docm":"docx",".docx":"docx",".dot":"dotx",".dotm":"docx",".dotx":"dotx",".email":"email",".emf":"vector",".eml":"email",".eps":"vector",".exe":"exe",".flac":"audio",".flv":"video",".gdraw":"vector",".gif":"photo",".htm":"code",".html":"code",".ical":"calendar",".icalendar":"calendar",".ico":"photo",".ics":"calendar",".indd":"vector",".indt":"vector",".ipa":"exe",".jfif":"photo",".jpe":"photo",".jpeg":"photo",".jpg":"photo",".log":"txt",".lync":l,".m1v":"video",".m4a":"audio",".mdb":"accdb",".mht":"code",".mov":"video",".mp2":"audio",".mp3":"audio",".mp4":"video",".mpa":"audio",".mpe":"video",".mpeg":"video",".mpg":"video",".mpp":"project",".mpt":"mpt",".mpv2":"video",".msg":"email",".msi":"exe",".odp":"pptx",".ods":"xlsx",".odt":"docx",".ogg":"audio",".one":"one",".onepkg":"onetoc",".onetoc":"onetoc",".onetoc2":"onetoc",".oxps":"vector",".pd":"vector",".pdf":"pdf",".plt":"vector",".png":"photo",".pot":"pptx",".potm":"pptx",".potx":"potx",".ppa":"pptx",".ppam":"pptx",".pps":"pptx",".ppsm":"pptx",".ppsx":"ppsx",".ppt":"pptx",".pptm":"pptx",".pptx":"pptx",".pro":"vector",".ps":"vector",".psd":"photo",".pub":"pblsh",".rpmsg":"rpmsg",".rtf":"txt",".sketch":"vector",".srt":"video",".svg":"vector",".svgz":"vector",".swf":"video",".tif":"photo",".tiff":"photo",".txt":"txt",".url":"link",".vcs":"calendar",".vdx":"vsdx",".vob":"video",".vsd":"vsdx",".vsdx":"vsdx",".vsl":"vsdx",".vss":"vsdx",".vssx":"vssx",".vst":"vstx",".vstx":"vstx",".wav":"audio",".wm":"audio",".wma":"audio",".wmd":"video",".wmf":"vector",".wms":"video",".wmv":"video",".wmz":"video",".wps":"docx",".wri":"docx",".xap":"exe",".xcl":"xlsx",".xd":"vector",".xla":"xlsx",".xlam":"xlsx",".xls":"xlsx",".xlsb":"xlsx",".xlsm":"xlsx",".xlsx":"xlsx",".xlt":"xlsx",".xltm":"xlsx",".xltx":"xltx",".xml":"code",".xps":"vector",".xsn":"infopath",".zip":"zip"}),d=Object.freeze({"application/vnd.google-apps.document":"gdoc","application/vnd.google-apps.spreadsheet":"gsheet","application/vnd.google-apps.presentation":"gslide","application/vnd.google-apps.form":"gform","application/onenote":"one","application/pdf":"pdf"});function m(e,t,n){if(void 0===t&&(t=!1),t)return r=r||{extraSmall:null,small:Object(o.a)("folder_20x20"),medium:Object(o.a)("folder_32x32"),large:Object(o.a)("folder_64x64"),cdn:Object(a.a)("folder_16x16")};var c=null,m=Object(i.b)(e);return m&&(c=s[m.toLowerCase()]),!c&&n&&n in d&&(c=d[n]),u(c||l)}},1263:function(e,t,n){"use strict";var r=n(0),a=n(25);function o(e){return Object(r.__assign)({__type:"GetNewAttachmentDataProviderCreationInfoRequest:#Exchange"},e)}function i(e){var t,n,r=o({ProviderType:e});return void 0===(t=r)||t.__type||(t=o(t)),Object(a.a)("GetNewAttachmentDataProviderCreationInfo",t,n)}function c(e){return Object(r.__assign)({__type:"GetAttachmentDataProviderCreatorRequest:#Exchange"},e)}function u(e){var t,n,r=c({ProviderType:e});return void 0===(t=r)||t.__type||(t=c(t)),Object(a.a)("GetAttachmentDataProviderCreator",t,n)}var l=n(2405),s=n(1603);n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return y}));var d="code",m="token",f=3e3,g=3;function p(e){return{state:e}}function b(e){return e.state}function S(e){return e.code}function h(e,t,n,a,o){var c={providerType:e,getAuthUrlInfo:null,getCSRFToken:b,getOAuthCode:S};return function e(t,n,a,o,c,s,d){return Object(r.__awaiter)(this,void 0,void 0,(function(){var m,g;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),m=void 0,7!==t&&9!==t&&8!==t?[3,2]:[4,u(t)];case 1:return g=r.sent(),m=g.AttachmentDataProviderCreator.ProviderAppKey,a=g.AttachmentDataProviderCreator.AuthorizationUri,[3,4];case 2:return[4,i(t)];case 3:g=r.sent(),m=g.ProviderAppKey,r.label=4;case 4:return n.getAuthUrlInfo=Object(l.d)(t,a,o,m,c,s),[3,6];case 5:return r.sent(),d>0&&setTimeout((function(){return e(t,n,a,o,c,s,--d)}),f),[3,6];case 6:return[2]}}))}))}(e,c,t,n,a,o,g),c}var v=null;function O(){if(!v){if(v={},Object(s.a)(3)&&(v[3]=h(3,"https://app.box.com/api/oauth2/authorize",Object(l.c)(3),d,p)),Object(s.a)(2)&&(v[2]=h(2,"https://www.dropbox.com/oauth2/authorize",Object(l.b)(2),d,p)),Object(s.a)(6)){var e=h(6,"https://www.facebook.com/dialog/oauth",Object(l.b)(6),m,(function(e){return{state:e,scope:"user_photos,email"}}));e.getCSRFToken=b,e.getOAuthCode=function(e){return e.access_token},v[6]=e}if(Object(s.a)(5)){var t=h(5,"https://accounts.google.com/o/oauth2/auth",l.a+"/ADPRedirect.aspx",d,(function(e){var t={state:e,provider:5..toString(),url:Object(l.b)()};return{state:JSON.stringify(t),scope:"https://www.googleapis.com/auth/drive",access_type:"offline",prompt:"consent",include_granted_scopes:"true"}}));t.getCSRFToken=function(e){return JSON.parse(e.state).state},v[5]=t}Object(s.a)(1)&&(v[1]=h(1,"https://login.live.com/oauth20_authorize.srf",Object(l.c)(1),d,(function(e){return{state:e,scope:"wl.basic onedrive.readwrite wl.offline_access"}}))),Object(s.a)(7)&&(v[7]=h(7,"",Object(l.c)(7),d,p)),Object(s.a)(8)&&(v[8]=h(8,"",Object(l.c)(8),d,p)),Object(s.a)(9)&&(v[9]=h(9,"",Object(l.c)(9),d,p))}return v}function y(e){var t=O();return e in t?t[e]:null}},1270:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2419),a="fileType-icon";function o(e){return r[function(e){return a+"-"+e}(e)]}},1285:function(e,t,n){"use strict";var r=n(4),a=Object(r.action)("openTimePanel",(function(e){return{source:e}})),o=Object(r.action)("handleTimePanelClosed",(function(e,t,n,r){return{source:e,sessionDuration:t,lastView:n,clientItemId:r}})),i=Object(r.action)("popView"),c=n(76);function u(){return Object(c.h)("cal-time-panel")}var l=n(556);function s(){return(!Object(l.v)()||!window.opener)&&u()}var d=n(1161);function m(){return s()&&Object(d.c)()}n.d(t,"e",(function(){return a})),n.d(t,"a",(function(){return o})),n.d(t,"f",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return m}))},1327:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var r=n(0),a=n(1362),o=function(){return Object(r.__spread)(Object(a.a)().providers.values())},i=function(e){return Object(a.a)().providers.get(e)||null}},1362:function(e,t,n){"use strict";var r=n(4),a=n(24),o=n(1578),i={providers:new a.ObservableMap,loadState:o.a.NotLoaded,removalPending:new a.ObservableMap},c=Object(r.createStore)("fileProviderStore",i);t.a=c},1380:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i}));var r=n(4),a=Object(r.action)("FILE_PROVIDER_ADDED",(function(e){return{providerViewState:e}})),o=Object(r.action)("FILE_PROVIDER_REMOVED",(function(e){return{providerType:e}})),i=Object(r.action)("PROVIDERS_LOADED",(function(e){return{providers:e}}))},13832:function(e){e.exports=JSON.parse('{"b":"u6c","c":"v6c","a":"w6c"}')},13833:function(e,t,n){var r=n(13834),a=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)a.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},13834:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,'._3Jtu3QV20_qLz8g_h0KpQb{position:relative;-webkit-font-smoothing:antialiased;font-size:14px;font-weight:400;color:inherit;width:100%;height:48px;line-height:32px;display:block;cursor:pointer;outline:transparent}html[dir] ._3Jtu3QV20_qLz8g_h0KpQb{background-color:transparent;padding-top:0;padding-bottom:0;border-width:initial;border-style:none;border-color:initial;-o-border-image:initial;border-image:initial}html[dir=ltr] ._3Jtu3QV20_qLz8g_h0KpQb{padding-right:12px;padding-left:12px;text-align:left}html[dir=rtl] ._3Jtu3QV20_qLz8g_h0KpQb{padding-left:12px;padding-right:12px;text-align:right}html[dir] ._3Jtu3QV20_qLz8g_h0KpQb:hover{background-color:"[theme:neutralLighter, default:#f4f4f4]"}html[dir] ._3Jtu3QV20_qLz8g_h0KpQb:active{background-color:"[theme:neutralLight, default:#eaeaea]"}._1v60Zw1heoE7AYHV2rZARo{white-space:nowrap;height:inherit;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;max-width:100%}.Nf0DroQfbZfcaaSjQ53MC{display:inline-block;color:"[theme:themePrimary, default:#0078D4]";height:32px;width:32px;vertical-align:middle;-ms-flex-negative:0;flex-shrink:0;overflow:hidden}html[dir=ltr] .Nf0DroQfbZfcaaSjQ53MC{margin-right:8px}html[dir=rtl] .Nf0DroQfbZfcaaSjQ53MC{margin-left:8px}._1V-pZ1TukzFi3FL2_U4Y5X{max-width:216px;width:100%;height:100%}._3TAbxFid2sTMSQ8v8sIeQH{font-size:14px;color:"[theme:neutralPrimary, default:#333333]";line-height:19px;max-width:100%}._3TAbxFid2sTMSQ8v8sIeQH,._1XRoVhbyaxndQhy7cIo11E{font-weight:400;display:block;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}._1XRoVhbyaxndQhy7cIo11E{font-size:11px;color:"[theme:neutralSecondary, default:#666666]";line-height:15px;width:216px}html[dir] ._1XRoVhbyaxndQhy7cIo11E{padding-top:1px}._1LIdXVeATDTlAL3Wafn6_V{position:absolute;top:20px}html[dir=ltr] ._1LIdXVeATDTlAL3Wafn6_V{left:24px}html[dir=rtl] ._1LIdXVeATDTlAL3Wafn6_V{right:24px}html[dir] ._16x5oaOekVnuCtNTMKxz1I{margin:0}',""]),t.locals={attachmentSuggestionButton:"_3Jtu3QV20_qLz8g_h0KpQb",attachmentSuggestionButtonContent:"_1v60Zw1heoE7AYHV2rZARo",attachmentSuggestionButtonImageContainer:"Nf0DroQfbZfcaaSjQ53MC",attachmentSuggestionButtonTextContainer:"_1V-pZ1TukzFi3FL2_U4Y5X",attachmentSuggestionPrimaryText:"_3TAbxFid2sTMSQ8v8sIeQH",attachmentSuggestionSecondaryText:"_1XRoVhbyaxndQhy7cIo11E",fileIcon:"_1LIdXVeATDTlAL3Wafn6_V",cloudyIcon:"_16x5oaOekVnuCtNTMKxz1I"}},13835:function(e,t,n){var r=n(13836),a=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)a.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},13836:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,'._10Wqk-jLsMonGEHBVbj5cP{position:relative;-webkit-font-smoothing:antialiased;font-size:14px;font-weight:400;color:inherit;width:100%;height:48px;line-height:32px;display:block;cursor:pointer;outline:transparent}html[dir] ._10Wqk-jLsMonGEHBVbj5cP{background-color:transparent;padding-top:0;padding-bottom:0;border-width:initial;border-style:none;border-color:initial;-o-border-image:initial;border-image:initial}html[dir=ltr] ._10Wqk-jLsMonGEHBVbj5cP{padding-right:12px;padding-left:12px;text-align:left}html[dir=rtl] ._10Wqk-jLsMonGEHBVbj5cP{padding-left:12px;padding-right:12px;text-align:right}html[dir] ._10Wqk-jLsMonGEHBVbj5cP:hover{background-color:"[theme:neutralLighter, default:#f4f4f4]"}html[dir] ._10Wqk-jLsMonGEHBVbj5cP:active{background-color:"[theme:neutralLight, default:#eaeaea]"}._3JeDFTJ3xdeMl09fLnBdDf{width:280px}._2BZ4VACg11pKrXUPK6KPZI{font-size:12px;font-weight:400;font-weight:600;color:"[theme:themePrimary, default:#0078D4]";max-width:280px}html[dir=ltr] ._2BZ4VACg11pKrXUPK6KPZI{margin-left:1px}html[dir=rtl] ._2BZ4VACg11pKrXUPK6KPZI{margin-right:1px}._1-XgaiCZX8v0t7SQi_ioKl{font-size:16px;height:16px;line-height:31px;width:16px;color:"[theme:neutralSecondary, default:#666666]"!important}html[dir=ltr] ._1-XgaiCZX8v0t7SQi_ioKl{margin-left:16px;margin-right:12px}html[dir=rtl] ._1-XgaiCZX8v0t7SQi_ioKl{margin-right:16px;margin-left:12px}html[dir] ._2JVEtFeqc7Qfi1U140m4t1{padding-bottom:16px}html[dir] ._2vktARVhhq-4yqVPWNwm4Q{padding-bottom:14px}html[dir] ._3OS-O1SA6lAPPKXCdnExMV{padding-bottom:16px}html[dir] ._1r7Jlygmjk0ZDdxQRHy9ZR{margin-bottom:3px;margin-top:3px}html[dir=ltr] ._1r7Jlygmjk0ZDdxQRHy9ZR{margin-right:10px}html[dir=rtl] ._1r7Jlygmjk0ZDdxQRHy9ZR{margin-left:10px}',""]),t.locals={attachmentSuggestionButton:"_10Wqk-jLsMonGEHBVbj5cP",attachmentSuggestionButtonRoot:"_3JeDFTJ3xdeMl09fLnBdDf",replyWithHeaderForBottomBar:"_2BZ4VACg11pKrXUPK6KPZI",iconRoot:"_1-XgaiCZX8v0t7SQi_ioKl",iconRootComputer:"_2JVEtFeqc7Qfi1U140m4t1",iconRootCloud:"_2vktARVhhq-4yqVPWNwm4Q",iconRootUploadAndShare:"_3OS-O1SA6lAPPKXCdnExMV",loadingSpinner:"_1r7Jlygmjk0ZDdxQRHy9ZR"}},13837:function(e){e.exports=JSON.parse('{"a":"F6c","b":"G6c"}')},13838:function(e,t,n){var r=n(13839),a=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)a.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},13839:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,"._3YAl0KkiE16JbPH0r6SRWf{font-size:12px}",""]),t.locals={menuButton:"_3YAl0KkiE16JbPH0r6SRWf"}},13840:function(e){e.exports=JSON.parse('{"i":"V5c","w":"W5c","q":"X5c","j":"Y5c","k":"Z5c","l":"_5c","m":"$5c","n":"a6c","o":"b6c","p":"c6c","r":"d6c","s":"e6c","t":"f6c","u":"g6c","v":"h6c","a":"i6c","c":"j6c","e":"k6c","f":"l6c","g":"m6c","b":"n6c","d":"o6c","h":"p6c"}')},13841:function(e,t,n){var r=n(13842),a=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)a.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},13842:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,"html[dir] ._1BIi6rH1j5rnLh1OlF1NvI{padding-top:10px}html[dir=ltr] ._1BIi6rH1j5rnLh1OlF1NvI{margin-left:52px}html[dir=rtl] ._1BIi6rH1j5rnLh1OlF1NvI{margin-right:52px}",""]),t.locals={bar:"_1BIi6rH1j5rnLh1OlF1NvI"}},1411:function(e,t,n){"use strict";e.exports=function(e,t){return"string"!=typeof e?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),/["'() \t\n]/.test(e)||t?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e)}},1463:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r,a=n(1152),o=n(1473);function i(e,t,n,i,c){if(n)return r=r||{extraSmall:Object(a.b)("generic").extraSmall,small:Object(a.b)("generic").small,medium:Object(a.b)("blockedfile").medium,large:Object(a.b)("generic").large,cdn:Object(o.a)("generic_16x16")};switch(c){case"IPM.Note":case"IPM.Note.SMIME":case"IPM.Note.SMIME.MultipartSigned":case"IPM.Schedule.Meeting.Request":case"IPM.Schedule.Meeting.Canceled":return Object(a.b)("email");case"IPM.Schedule":case"IPM.Appointment":case"IPM.OLE.CLASS.{00061055-0000-0000-C000-000000000046}":return Object(a.b)("calendar")}return i?Object(a.b)("sharedfolder"):Object(a.a)(e,!1,t)||Object(a.b)("generic")}},1473:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(76),a=1;function o(e){return Object(r.h)("doc-fileIcon-newCdn")?"https://outlook-"+(a++%2+1)+".cdn.office.net/assets/mail/file-icon/png/"+e+".png":"https://r"+(a++%4+1)+".res.outlook.com/owa/prem/images/"+e+".png"}},1478:function(e,t,n){"use strict";var r=n(108),a=n(1805),o=n(1785),i=(n(1362),n(1380)),c=n(1518),u=(n(2385),n(2316),n(1327));var l=n(1762),s=n(1578),d=n(1263);n.d(t,"l",(function(){return f})),n.d(t,"n",(function(){return g})),n.d(t,"k",(function(){return p})),n.d(t,"m",(function(){return b})),n.d(t,"b",(function(){return a.a})),n.d(t,"i",(function(){return o.a})),n.d(t,"d",(function(){return i.a})),n.d(t,"e",(function(){return i.b})),n.d(t,"o",(function(){return i.c})),n.d(t,"a",(function(){return c.b})),n.d(t,"g",(function(){return u.a})),n.d(t,"h",(function(){return u.b})),n.d(t,"j",(function(){return l.a})),n.d(t,"c",(function(){return s.a})),n.d(t,"f",(function(){return d.b}));var m=new r.c((function(){return Promise.all([n.e(1),n.e(696),n.e(4),n.e(17),n.e(271)]).then(n.bind(null,15048))})),f=new r.b(m,(function(e){return e.loadProviders})),g=new r.b(m,(function(e){return e.removeFileProvider})),p=new r.b(m,(function(e){return e.addFileProvider})),b=new r.b(m,(function(e){return e.removeAndAddFileProvider}))},14980:function(e,t,n){"use strict";n.r(t);var r=n(4),a=Object(r.action)("setSmartPillBlockVisibility",(function(e,t){return{viewState:e,smartPillBlockVisible:t}})),o=Object(r.action)("setSmartPillFeedbackSubmitted",(function(e,t){return{item:e,smartPillFeedbackSubmitted:t}})),i=(Object(r.mutator)(a,(function(e){e.viewState.smartPillBlockVisible=e.smartPillBlockVisible})),Object(r.mutator)(o,(function(e){e.item.smartPillFeedbackSubmitted=e.smartPillFeedbackSubmitted})),Object(r.action)("updateItemLanguageAction",(function(e){return{item:e}}))),c=n(79),u=n(6078);function l(e){var t=function(e){var t=e.ExtendedProperty;if(t){var n=t.filter((function(e){return e.ExtendedFieldURI.PropertyName===u.a}));if(n.length>0)return n[0]}return null}(e),n=void 0,r=void 0,a=0,o=void 0;try{if(t){var i=JSON.parse(t.Value)[0],l=i[u.c],s=i[u.d];o=i[u.b],r=Object.keys(s)[0],n=(null==l?void 0:l[u.e])&&l[u.e].toLowerCase(),a=parseInt(Object.values(s)[0])}}catch(e){c.g.info("[getStampedLanguage] Failed to parse property, error: "+e.message)}return{locale:n,language:r,confidenceScore:a,entityId:o}}Object(r.mutator)(i,(function(e){var t=e.item;t.stampedLanguage=l(t)}));var s=n(0),d=n(42),m=n(567),f=n(76),g=n(1285);function p(e){var t=e.featureName;if("SmartReply"===t)return Object(f.h)("mc-smartReply");if("SmartTime"===t)return Object(f.h)("mc-smartReplyWithCustomMeeting");if("SmartDoc"===t)return Object(f.h)("mc-smartReplyWithDoc");if("SmartTodo"===t||"SmartReminder"===t){var n=Object(g.d)();return n||c.g.info("[isPillTypeEnabled] Disable Smart Todo - Time Panel and/or To Do is unavailable."),Object(f.h)("mc-smartTask")&&n}return c.g.info("[isPillTypeEnabled] Unknown pill type: "+t),!1}function b(e){if(e){if("SmartDoc"===e.featureName)return!0;null==e.confidenceScore&&c.g.info("[isConfidenceScoreAcceptable] confidence score is null. Feature: "+e.featureName+" EntityId: "+e.logData.mainPayload.EID);var t=e.confidenceScore;if(t>0){if(Object(f.h)("mc-smartPillConfidenceLevel_LOW"))return!0;if(Object(f.h)("mc-smartPillConfidenceLevel_MID"))switch(e.featureName){case"SmartTime":return t>=70;case"SmartTask":case"SmartTodo":return t>=70;default:return!0}else switch(e.featureName){case"SmartTime":return t>=90;case"SmartTask":case"SmartTodo":return t>=90;default:return!0}}}return!1}function S(){var e=Object(f.h)("mc-smartReplyWithTextPositionThird");return[{aggregation:{SmartReply:2,SmartTime:1},arrangement:e?["SmartTime","SmartReply"]:["SmartReply","SmartTime"]},{aggregation:{SmartTime:1},arrangement:["SmartTime"]},{aggregation:{SmartReply:2,SmartDoc:1},arrangement:e?["SmartDoc","SmartReply"]:["SmartReply","SmartDoc"]},{aggregation:{SmartDoc:1},arrangement:["SmartDoc"]},{aggregation:{SmartReply:3},arrangement:["SmartReply"]},{aggregation:{SmartReply:1,SmartTodo:1,SmartReminder:1},arrangement:e?["SmartTodo","SmartReminder","SmartReply"]:["SmartReply","SmartTodo","SmartReminder"]},{aggregation:{SmartReply:2,SmartTodo:1},arrangement:e?["SmartTodo","SmartReply"]:["SmartReply","SmartTodo"]},{aggregation:{SmartTodo:1,SmartReminder:1},arrangement:["SmartTodo","SmartReminder"]},{aggregation:{SmartTodo:1},arrangement:["SmartTodo"]}]}function h(e){if(e)for(var t=function(e){var t,n,r={};try{for(var a=Object(s.__values)(e),o=a.next();!o.done;o=a.next()){var i=o.value;r[i.featureName]=void 0===r[i.featureName]?1:r[i.featureName]+1}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return r}(e),n=S(),r=0;r<n.length;r++){for(var a=!0,o=n[r],i=0;i<o.arrangement.length;i++){if(o.aggregation[o.arrangement[i]]>(void 0===t[o.arrangement[i]]?0:t[o.arrangement[i]])){a=!1;break}}if(a)return o}return null}var v={selectPills:function(e){return function(e,t){var n=[];return t&&e.length>0&&t.arrangement.forEach((function(r){n.push.apply(n,Object(s.__spread)(function(e,t,n){return e.filter((function(e){return e.featureName===t})).slice(0,n)}(e,r,t.aggregation[r])))})),n}(e,h(e))}};function O(e,t,n,r){var a=[];return e.forEach((function(e){n(e)?a.push(e):(e.logData.mainPayload.renderStory|=r,t.push(e))})),a}var y={arbitratePills:function(e){var t=[],n=[];if(e){var r=O(e,n,p,1),a=O(r,n,b,4);if(a.length>0){var o=v;t.push.apply(t,Object(s.__spread)(o.selectPills(a)));for(var i=function(e){var r=a[e];t.some((function(e){return e===r}))||(r.logData.mainPayload.renderStory|=2,n.push(r))},c=0;c<a.length;c++)i(c)}}return{pillsToShow:t,pillsToHide:n,arbitratorId:"complexArbitrator"}}};var j=Object(r.action)("createMessageWithAttachmentAction",(function(e,t,n){return{item:e,attachment:t,option:n}})),x=n(1077),P=n(1478);function I(e,t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n;return Object(s.__generator)(this,(function(r){switch(r.label){case 0:return n=null,Object(P.j)()!==P.c.NotLoaded?[3,2]:[4,P.l.import()];case 1:return r.sent()((function(r){n=k(Object(P.h)(),e),t(n)})),[3,3];case 2:n=k(Object(P.h)(),e),t(n),r.label=3;case 3:return[2]}}))}))}function k(e,t){var n=function(e){for(var t=0;t<e.length;t++)if(0===e[t].type)return e[t].model.Id;return c.g.warn("createCloudFileFromAttachmentData: Could not get OneDrive Pro provider ID. Attachment will not upload."),""}(e);return{fileType:x.a.CloudSuggestion,name:t.FileName,size:null,providerId:n,providerType:0,location:t.Url,providerEndpointUrl:null,isFolder:!1,fileId:t.Id,fileParentId:null,thumbnailUrl:null,previewUrl:null,type:null}}var w=n(1516),C=n(1292);function T(e,t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n;return Object(s.__generator)(this,(function(r){switch(r.label){case 0:return(n=Object(w.a)(e.ConversationId.Id))?[3,3]:[4,C.p.import()];case 1:return[4,r.sent()({referenceItemOrId:e,isReplyAll:!0,useFullCompose:!1,instrumentationContexts:null,conversationId:e.ConversationId.Id,body:null,smartDocOption:t})];case 2:n=r.sent(),r.label=3;case 3:return[2,n]}}))}))}var D=n(2946),_=n(254);Object(r.orchestrator)(j,(function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t,n,r,a,o=this;return Object(s.__generator)(this,(function(i){switch(i.label){case 0:return t=e.item,n=e.attachment,r=e.option,n?[3,2]:[4,T(t,r)];case 1:return i.sent(),[3,5];case 2:return i.trys.push([2,4,,5]),[4,I(n,(function(e){return Object(s.__awaiter)(o,void 0,void 0,(function(){return Object(s.__generator)(this,(function(n){return function(e,t,n){Object(s.__awaiter)(this,void 0,void 0,(function(){var r;return Object(s.__generator)(this,(function(a){switch(a.label){case 0:return t?[4,T(e,n)]:[3,3];case 1:return r=a.sent(),[4,C.c.import()];case 2:a.sent()([t],r,{isInline:!1,isHiddenInline:!1,shouldShare:!0,isAddedFromSmartDoc:!0},(function(){return function(e,t){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(n){return Object(_.o)("SmartDocAttachmentsAdded",{smartDocExtractionId:e.SmartDocData.EntityId},{isCore:!0,isCosmosDatapoint:!0}),t.smartPillViewState.smartDocOption=D.b.None,[2]}))}))}(e,r)}),null,null,null),a.label=3;case 3:return[2]}}))}))}(t,e,r),[2]}))}))}))];case 3:return i.sent(),[3,5];case 4:return a=i.sent(),c.d("[createMessageWithAttachmentOrchestrator] Error when creating cloud file: "+a.message),[3,5];case 5:return[2]}}))}))}));var E=Object(r.action)("cacheSmartDocDataAction",(function(e,t,n){return{item:e,validPropertyExists:t,entityId:n}})),R=(Object(r.mutator)(E,(function(e){var t={EntityId:void 0},n=e.item,r=e.validPropertyExists,a=e.entityId;r&&(t.EntityId=a),n.SmartDocData=t})),n(1));function A(e){return e.Source.LastModifiedBy?e.Source.LastModifiedBy.DisplayName:e.Source.LastShared.SharedBy.DisplayName}var F=n(699),N=n(2380),B=n(3846),M=Object(r.createStore)("smartDocStatusAndSuggestionStore",{status:0,suggestions:[]}),L=M,V=Object(r.mutatorAction)("SET_SMART_DOC_SUGGESTION_STATUS",(function(e){M().status=e})),H=Object(r.mutatorAction)("SET_SMART_DOC_SUGGESTIONS",(function(e,t){M().suggestions=e,M().status=t})),G="application/json;charset=utf-8",U="/search/api/v1/recommendations";function W(e,t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n,r,a,o,i,u,l,d;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:n=null,r="",V(1),s.label=1;case 1:return s.trys.push([1,7,8,9]),[4,Q()];case 2:return a=s.sent(),o=function(e,t){var n={};n.headers=new Headers,n.headers.set("Authorization","Bearer "+e),n.headers.set("Content-Type",G),n.method="POST";var r=Object(N.b)();r&&n.headers.append("X-AnchorMailbox",r);n.headers.set("X-Client-LocalTime",(new Date).toISOString());var a=[];a.length&&n.headers.set("X-Client-Flights",a.join(","));var o=Object(f.h)("mc-smartReplyWithDoc-SmartAttachments"),i={EntityRequests:[t?{Context:{EntityId:t}}:{}],Scenario:{Name:o?"SmartAttachments":"AttachFile"}};return n.body=JSON.stringify(i),n}(a,e),[4,fetch(U,o)];case 3:return(i=s.sent())&&200==i.status?[4,i.text()]:[3,5];case 4:return u=s.sent(),l=JSON.parse(u),n=function(e){try{return e.EntitySets[0].ResultSets[0].Results.map((function(e,t){return function(e,t){var n,r;try{var a=!!e.Source.LastShared&&!e.Source.WebUrl,o=e.Source.Author?e.Source.Author.DisplayName:"";return{Author:o,CreatedBy:o,DateAccessed:e.Source.LastAccessDateTime||(null===(n=e.Source.UserRelationship)||void 0===n?void 0:n.LastAccessDateTime),DateCreated:null,DateModified:e.Source.LastModifiedDateTime,Endpoint:a?2:"Implicit"===(null===(r=e.SubstrateSearchExtendedProperties)||void 0===r?void 0:r.RelevanceRelationship)?3:1,FileExtension:e.Source.FileExtension,FileName:e.Source.FileName,FileSize:e.Source.FileSize,FileSourceType:e.ContentSource||e.Provenance,Id:a?e.Source.LastShared.AttachmentId:e.Id,ModifiedBy:A(e),Position:t,ReferenceId:e.ReferenceId,SourceTitle:e.Source.SiteTitle||e.Source.LastShared.SharingSubject,Text:e.Source.Title,Title:e.Source.Title,Url:e.Source.Url,TraceId:null}}catch(e){return c.g.info("[convertMRUAttachmentToReplyWithAttachmentSuggestion] Error accessing MRUAttachment properties: "+e.message),null}}(e,t)}))}catch(e){return c.g.info("[fetchMRUSuggestions_getAttachmentsFromResponse] Error: "+e.message),[]}}(l),[3,6];case 5:r=i?i.status+"-"+i.statusText:"No response",s.label=6;case 6:return[3,9];case 7:return d=s.sent(),r=d.message,[3,9];case 8:return r?(c.g.info("getMRUSuggestions: Error "+r),V(3)):H(n,2),Object(B.n)("SmartDocSuggestionRequestSent",{EID:t,isSuccessful:!r,numOfFileSuggestions:null==n?void 0:n.length}),[2,n];case 9:return[2]}}))}))}function Q(){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return Object(s.__generator)(this,(function(r){switch(r.label){case 0:return e=Object(s.__read)(Object(F.getAccessTokenforResourceAsLazy)(window.location.origin),2),t=e[0],n=e[1],t?[3,2]:[4,n];case 1:t=r.sent(),r.label=2;case 2:return[2,t]}}))}))}var z=n(9),J="@EntityId";function q(e,t){var n=!1;if(e){if(t)try{n=function(e,t){var n=!1,r=t[J];if(!r)throw c.g.info("[extractAndCacheSmartDocDataFromProperty] Cannot parse entity ID. Aborting..."),new Error("NoEntityIdOnProperty");return E(e,n=!0,r),n}(e,JSON.parse(t.Value)[0])}catch(e){throw c.g.warn("[parseSmartDocProperty] Malformed property, cannot parse. Error: "+e.message),e.networkError=!0,e}else c.g.info("[parseSmartDocProperty] No property found.");n||E(e,n)}else c.g.info("[parseSmartDocProperty] No item.")}var Z=n(236),K=n(7),X=n(1617),Y=n(13832),$=n(555),ee="...",te=30,ne=n(13833);function re(e){var t,n,r,a=e.item,o=e.suggestion,i=e.smartPillLogData,u=e.onAttachmentClicked,l=e.dismissMenu,s=R.useCallback((function(){i.mainPayload.timeClicked=(new Date).toISOString(),i.mainPayload.subtype="FileSuggestion"+o.Position,Object(B.j)(i,B.a),Object(B.k)(i.mainPayload.EID,i.mainPayload.position,i.mainPayload.loggableText,"SmartDoc",i.mainPayload.language,i.mainPayload.locale,i.cosmosOnlyData),u(a,o,D.b.FileSuggestion),l()}),[a,o,l]);try{t=function(e){var t=null;try{t=[e.FileName,ie(e),ae(e),oe(e)].filter((function(e){return e})).join("\n")}catch(e){c.g.info("[SmartDocMenuItemBuilder] Failed to parse attachment tooltip data, message: "+e.message)}finally{return t}}(o),n=function(e){return 2===e.Endpoint?ie(e):ae(e)}(o),r=function(e){if(e.length<=te)return e;var t=te-ee.length,n=Math.ceil(t/2),r=Math.floor(t/2),a=e.substr(0,n),o=e.substr(e.length-r);return""+a+ee+o}(function(e){var t="."+e.FileExtension;return e.FileName.indexOf(t)>=0?e.FileName.replace(t,""):e.FileName}(o)+ce(o))}catch(e){throw c.g.warn("[SmartDocMenuItemBuilder] Error: "+e.message),e.networkError=!0,e}return R.createElement("button",{className:ne.attachmentSuggestionButton,title:t,name:o.FileName,"aria-label":Object(z.c)(Object(z.b)(Y.b),o.FileName),"aria-posinset":1,"aria-setsize":7,"aria-disabled":"false",role:"menuitem",onClick:s,tabIndex:0},R.createElement("div",{className:ne.attachmentSuggestionButtonContent},R.createElement("div",{className:ne.attachmentSuggestionButtonImageContainer,role:"presentation","aria-hidden":"true"},function(e){var t=e.FileName+ce(e);return R.createElement(X.a,{fileName:t,contentType:null,isBlocked:!1,isFolder:!1,embeddedItemClass:null,cloudyIconStyle:ne.cloudyIcon,fileIconStyle:ne.fileIcon})}(o)),R.createElement("div",null,R.createElement("div",{className:ne.attachmentSuggestionButtonTextContainer},R.createElement("div",{className:ne.attachmentSuggestionPrimaryText},r)),R.createElement("div",{className:ne.attachmentSuggestionSecondaryText},n))))}function ae(e){if(2===e.Endpoint)return null;var t=e.DateAccessed;t||c.d('[SmartDocMenuItemBuilder] Access date is not available for suggestion "'+e.Id+'"');var n=Object(K.Rb)("UTC",t),r=Object(K.N)(n,Object($.i)());return Object(z.c)(Object(z.b)(Y.a),r)}function oe(e){var t=e.DateModified;t||c.d('[SmartDocMenuItemBuilder] Modified date is not available for suggestion "'+e.Id+'"');var n=Object(K.Rb)("UTC",t),r=Object(K.Z)(n);return Object(z.c)(Object(z.b)(Y.c),r)}function ie(e){var t=null,n=document.createElement("a");n.href=e.Url,t=decodeURIComponent(n.hostname);for(var r=Object(Z.a)(),a=decodeURIComponent(n.pathname).split("/"),o=1;o<a.length-1;o++)r?t=a[o]+" < "+t:t+=" > "+a[o];return t}function ce(e){return"."+e.FileExtension}var ue=3;var le=n(314),se=n(432),de=n(10398),me=n(905),fe=n(339),ge=n(5631),pe=n(233),be=n(13835),Se=n(308).bind(be),he=Object(d.a)((function(e){var t=e.store,n=e.item,r=e.logData,a=R.useRef(!1),o=R.useRef(),i=R.useRef([]),u=[];switch(u.push({key:"replyWithHeader",name:Object(z.b)(de.c),title:Object(z.b)(de.c),itemType:pe.a.Header,iconProps:{iconName:null,styles:{root:{margin:"0px",width:"0px"}}},className:be.replyWithHeaderForBottomBar}),t.status){case 0:case 2:var l=t.suggestions;(null==l?void 0:l.length)>0&&(i.current=function(e,t){void 0===t&&(t=ue);var n=[],r=null;if(e)for(var a=0;a<e.length&&n.length<t;a++)(r=e[a])?n.push(r):c.g.info("[extractAttachmentSuggestions] mru suggestion is null");return n}(l),i.current.forEach((function(e,t){u.push(function(e,t,n,r){return{key:"fileSuggestion"+t,className:be.attachmentSuggestionButtonRoot,onRender:function(t,a){return R.createElement(re,{item:n,suggestion:e,smartPillLogData:r,onAttachmentClicked:j,dismissMenu:a})}}}(e,t,n,r))}))),u.push(ve());break;case 1:u.push({key:"spinner",className:be.attachmentSuggestionButtonRoot,onRender:function(){return R.createElement("div",null,R.createElement(me.a,{size:fe.a.medium,className:be.loadingSpinner}))}}),u.push(ve());break;case 3:u.pop();break;default:Object(le.a)(t.status)}u.push(Oe(n,r,Object(z.b)(ge.b),Object(z.b)(ge.b),{iconName:"System",styles:{root:Se(be.iconRoot,be.iconRootComputer)}},D.b.LocalFiles)),u.push(Oe(n,r,Object(z.b)(ge.a),Object(z.b)(ge.a),{iconName:"Cloud",styles:{root:Se(be.iconRoot,be.iconRootCloud)}},D.b.CloudFiles)),u.push(Oe(n,r,Object(z.b)(ge.c),Object(z.b)(ge.d),{iconName:"CloudUpload",styles:{root:Se(be.iconRoot,be.iconRootUploadAndShare)}},D.b.UploadAndShare));var s=function(e){if(e){var t={data:[r.mainPayload]};e.addCustomData([JSON.stringify(t)]),e.addCosmosOnlyData(r.cosmosOnlyData),e.end()}},d={items:u,onMenuOpened:function(){a.current=!0,e.logData.mainPayload.timeClicked=(new Date).toISOString(),e.logData.mainPayload.numOfFileSuggestions=i.current.length,Object(B.j)(e.logData,B.d),1===t.status&&(o.current=new _.a(B.c,{isCore:!0,isCosmosDatapoint:!0}))},onMenuDismissed:function(){a.current=!1,e.logData.mainPayload.timeClicked=(new Date).toISOString(),e.logData.mainPayload.numOfFileSuggestions=i.current.length,Object(B.j)(e.logData,B.b),1===t.status&&(e.logData.mainPayload.isSuccessful=!1,s(o.current),delete e.logData.mainPayload.isSuccessful),o.current=null}};R.useEffect((function(){!a.current||2!==t.status&&3!==t.status||(e.logData.mainPayload.timeClicked=(new Date).toISOString(),e.logData.mainPayload.numOfFileSuggestions=i.current.length,e.logData.mainPayload.isSuccessful=2===t.status,s(o.current),delete e.logData.mainPayload.isSuccessful)}));var m=Object(f.h)("mc-smartReplyWithDoc-ShareAFile")?Object(z.b)(de.b):Object(z.b)(de.a);return R.createElement(se.a,{ariaDescription:m,title:Object(f.h)("mc-smartPillsTooltipV2")?Object(z.b)(de.d):m,iconProps:{iconName:"Attach"},key:e.position,split:!1,styles:e.menuItemStyle,text:m,menuProps:d})}));function ve(){return{key:"replyWithSeparator",iconProps:{iconName:null,styles:{root:{margin:"0px",width:"0px"}}},className:be.replyWithSeparator,itemType:pe.a.Divider}}function Oe(e,t,n,r,a,o){var i=D.b[o];return{key:i,name:n,ariaLabel:r,title:r,iconProps:a,onClick:function(){t.mainPayload.timeClicked=(new Date).toISOString(),t.mainPayload.subtype=i,Object(B.j)(t,B.a),j(e,null,o)}}}var ye=n(3532),je="EntityExtraction/SendContentRequestV21.0",xe="Attach a file",Pe="Share a file";function Ie(e){var t;return Object(s.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(s.__generator)(this,(function(a){switch(a.label){case 0:return e.SmartDocData&&!e.SmartDocData.EntityId?[2,[]]:e.SmartDocData?[3,3]:[4,ye.c.import()];case 1:return[4,a.sent()(e.ItemId.Id,D.a.SmartDoc)];case 2:(n=a.sent())&&(r=function(e,t){var n=e.ExtendedProperty;if(n)for(var r=n.length,a=0;a<r;a++){var o=n[a];if(o.ExtendedFieldURI.PropertyName===t)return o}return null}(n,je),q(n,r)),a.label=3;case 3:return(null===(t=e.SmartDocData)||void 0===t?void 0:t.EntityId)?[2,[ke(e)]]:[2,[]]}}))}))}function ke(e){var t,n=Object(f.h)("mc-smartReplyWithDoc-ShareAFile")?Pe:xe,r=Object(B.i)("SmartDoc",n);return r.mainPayload.EID=e.SmartDocData.EntityId,W(Object(f.h)("mc-smartReplyWithDoc-ContextualMRU")?null===(t=e.ItemId)||void 0===t?void 0:t.Id:null,e.SmartDocData.EntityId),{onRender:function(t,n){return R.createElement(he,{store:L(),item:e,logData:r,position:t,menuItemStyle:n})},ariaLabel:Object(z.b)(de.a),featureName:"SmartDoc",index:0,logData:r,onClick:null}}var we=Object(r.action)("cacheSmartReplyDataAction",(function(e,t,n,r,a){return{item:e,validPropertyExists:t,smartReplies:n,loggableSmartReplies:r,smartReplyExtractionID:a}})),Ce=n(24),Te=(Object(r.mutator)(we,(function(e){var t={SmartReplies:null,LoggableSmartReplies:null,ExtractionID:null,SuggestionAppropriatenessMap:null,FeedbackSubmitted:!1},n=e.item,r=e.validPropertyExists,a=e.smartReplies,o=e.loggableSmartReplies,i=e.smartReplyExtractionID;if(r){t={SmartReplies:a,LoggableSmartReplies:o,ExtractionID:i,SuggestionAppropriatenessMap:new Ce.ObservableMap,FeedbackSubmitted:!1};for(var c=0;c<a.length;c++){var u=String(c);t.SuggestionAppropriatenessMap.set(u,"")}}n.SmartReplyData=t})),Object(r.action)("updateSIGSDataOnClickAction",(function(e,t,n){return{composeViewState:e,timeClicked:t,clickIndex:n}}))),De=(Object(r.mutator)(Te,(function(e){var t=e.composeViewState,n=e.timeClicked,r=e.clickIndex;t&&(t.smartPillViewState.smartReplyComposeSIGSData={isSmartSuggestionsClicked:!0,suggestionsClickedTime:n,clickIndex:r})})),"EntityExtraction/SmartReplyForEmail"),_e=n(13837),Ee=n(2441),Re=n(13838);function Ae(e,t,n){return t.suggestions.slice(1).map((function(t){return{key:t,name:t,ariaLabel:t,title:Object(f.h)("mc-smartPillsTooltipV2")?Object(z.b)(_e.b):t,itemProps:{styles:{root:Re.menuButton}},onClick:function(){var r=(new Date).toISOString();n.mainPayload.timeClicked=r,n.mainPayload.subtype=t,Object(B.j)(n,B.f),Object(B.k)(n.mainPayload.EID,n.mainPayload.position,n.mainPayload.loggableText,"SmartReply",n.mainPayload.language,n.mainPayload.locale,n.cosmosOnlyData,t),Ee.j.importAndExecute(e.ItemId.Id,e.ConversationId.Id,t,1)}}}))}var Fe="2018-06-20T00:00:00.0000000Z",Ne="@extractionTimeUtc",Be="@EntityId",Me=3,Le="SmartReplyForEmail",Ve="SmartReplyForEmail_Group";function He(e,t){var n=!1;if(e){if(t)try{var r=JSON.parse(t.Value)[0],a=r[Ne];if(!a){c.g.warn("[getSmartRepliesForItem_parseSmartReplyProperty] Time stamp not found on property, aborting smart reply parsing.");var o=new Error("NoTimeStamp");throw o.networkError=!0,o}Date.parse(a)>=Date.parse(Fe)&&(n=function(e,t){for(var n=t[Be],r=[],a=[],o=!1,i=t.entities.length,u=0;u<i;u++){var l=Ge(t.entities[u]),s=l.smartReply,d=l.loggableSmartReply;r.push(s),a.push(d)}if(!n||r.length!=Me){c.g.info("[getSmartRepliesForItem_extractAndCacheSmartRepliesFromProperty] Unexpected number of smart replies on item. Expected "+Me+" but found "+r.length);var m=new Error("NumberOfSmartRepliesIs"+r.length);throw m.networkError=!0,m}we(e,o=!0,r,a,n);return o}(e,r))}catch(e){throw c.g.warn("[getSmartRepliesForItem_parseSmartReplyProperty] Malformed property, cannot parse. Error: "+e.message),e.networkError=!0,e}else c.g.info("[getSmartRepliesForItem_parseSmartReplyProperty] No property found.");n||we(e,n)}else c.g.info("[getSmartRepliesForItem_parseSmartReplyProperty] No item.")}function Ge(e){var t=null,n=null;switch(e["@type"]){case Le:t={type:0,suggestions:e.value},n=e.valueRaw||e.value;break;case Ve:t={type:1,suggestions:e.values},n=JSON.stringify(e.values);break;default:c.g.warn("[getSmartRepliesForItem_parseSmartReplyProperty] Unexpected entity type. Expected "+Le+" or "+Ve+" but found "+e["@type"])}return{smartReply:t,loggableSmartReply:n}}function Ue(e){var t;return Object(s.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(s.__generator)(this,(function(a){switch(a.label){case 0:return e?e.SmartReplyData?[3,3]:[4,ye.c.import()]:[3,4];case 1:return[4,a.sent()(e.ItemId.Id,D.a.SmartReply)];case 2:(n=a.sent())&&(r=function(e,t){var n=e.ExtendedProperty;if(n)for(var r=n.length,a=0;a<r;a++){var o=n[a];if(o.ExtendedFieldURI.PropertyName===t)return o}return null}(n,De),He(n,r)),a.label=3;case 3:return(null===(t=e.SmartReplyData)||void 0===t?void 0:t.ExtractionID)?[2,e.SmartReplyData.SmartReplies.map((function(t,n){return function(e,t,n,r,a){var o=this,i=Object(B.i)("SmartReply",n);i.mainPayload.EID=r,i.mainPayload.confidenceScore=a+1;var c=null,u=null;if(0==t.type)c=t.suggestions;else if(1==t.type)switch(t.suggestions.length){case 0:c="";break;case 1:c=t.suggestions[0];break;default:c=t.suggestions[0],u={items:Ae(e,t,i)}}return{ariaLabel:Object(z.c)(Object(z.b)(_e.a),c),featureName:"SmartReply",icon:Object(f.h)("mc-smartPillsDesignV2")?{iconName:"Edit"}:null,onClick:function(t){return Object(s.__awaiter)(o,void 0,void 0,(function(){var n;return Object(s.__generator)(this,(function(r){switch(r.label){case 0:return[4,Ee.j.importAndExecute(e.ItemId.Id,e.ConversationId.Id,c,1)];case 1:return n=r.sent(),Te(n,t.logData.mainPayload.timeClicked,t.logData.mainPayload.position),[2]}}))}))},logData:i,index:a,text:c,toolTip:Object(f.h)("mc-smartPillsTooltipV2")?Object(z.b)(_e.b):c,confidenceScore:i.mainPayload.confidenceScore,menuProps:u}}(e,t,e.SmartReplyData.LoggableSmartReplies[n],e.SmartReplyData.ExtractionID,n)}))]:[3,5];case 4:c.g.info("[getSmartRepliesForItem] No item, cannot produce smart replies."),a.label=5;case 5:return[2,[]]}}))}))}var We=Object(r.action)("cacheSmartTimeExtendedPropertyAction",(function(e,t,n){return{item:e,validPropertyExists:t,smartTimesExtendedProp:n}})),Qe=(Object(r.mutator)(We,(function(e){var t={beginingOfTimeRange:null,endOfTimeRange:null,duration:null,entityId:null,hasIntent:!1,confidenceScore:0,rawConfidenceScores:null},n=e.item,r=e.validPropertyExists,a=e.smartTimesExtendedProp;r&&a&&(t={beginingOfTimeRange:a.beginingOfTimeRange,endOfTimeRange:a.endOfTimeRange,duration:a.duration,entityId:a.entityId,hasIntent:!0,confidenceScore:a.confidenceScore,rawConfidenceScores:a.rawConfidenceScores}),n.SmartTimeExtendedProperty=t})),n(10399));var ze="EntityExtraction/Events1.0",Je="EntityExtraction/CalendarRelated1.0";var qe=n(597);var Ze="@EntityId",Ke="confidence",Xe="SenderSchedulerConfidence",Ye="RecipientSchedulerConfidence",$e="UnclearSchedulerConfidence",et="AvailabilityConfidence",tt="times";function nt(e,t){if(t){var n=null,r=!1;try{var a=JSON.parse(t.Value),o=-1/0,i=null;a.forEach((function(e){var t,n=(t=e,Object(f.h)("mc-smartReplyWithMeeting-MeetingScheduler")?Math.max(t[Ye]?t[Ye]:0,t[$e]?t[$e]:0,t[et]?t[et]:0):t[Ke]?+t[Ke]:0);n>o&&(o=n,i=e)}));var u=i[Ze],l=i[tt][0],s={confidence:i[Ke],AvailabilityConfidence:i[et],RecipientSchedulerConfidence:i[Ye],SenderSchedulerConfidence:i[Xe],UnclearSchedulerConfidence:i[$e]};n={beginingOfTimeRange:l.beginingOfTimeRange,endOfTimeRange:l.endOfTimeRange,duration:l.duration,entityId:u,hasIntent:!0,confidenceScore:o,rawConfidenceScores:s},r=!0}catch(e){throw c.g.warn("[getSmartTimeForItem_parseSmartTimeProperty] Malformed property, cannot parse. Error: "+e.message),e.networkError=!0,e}finally{We(e,r,n)}}else c.g.info("[getSmartTimeForItem_parseSmartTimeProperty] No smart time extended property found.")}var rt=n(1685),at=n(283),ot=n(1193),it=n(1695),ct=Object(at.action)("setCalendarInlineComposeViewState")((function(e,t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n,r,a,o;return Object(s.__generator)(this,(function(i){switch(i.label){case 0:return n=e,[4,C.i.import()];case 1:return[4,i.sent()(n,!0)];case 2:return r=s.__read.apply(void 0,[i.sent(),2]),a=r[0],o=r[1],Object(ot.a)(e.ConversationId.Id).calendarInlineComposeViewState=Object(s.__assign)(Object(s.__assign)({},Object(it.a)()),{referenceItemId:e.ItemId.Id,subject:e.Subject,location:null,smartTimeSuggestion:t,toRecipients:a,ccRecipients:o}),[2]}}))}))})),ut=n(960);function lt(){var e=Object(f.h)("mc-smartReplyWithMeeting-Cortana"),t=Object(ut.d)(ut.a.CalendarHelp).calendarHelpEnabled;return e&&t}var st=n(6298);function dt(e){var t;return Object(s.__awaiter)(this,void 0,void 0,(function(){var n,r,a,o,i,u,l,d,m,g,p,b,S;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:return n=[],e?e.SmartTimeExtendedProperty?[3,3]:[4,ye.c.import()]:[3,7];case 1:return[4,s.sent()(e.ItemId.Id,D.a.SmartTime)];case 2:(r=s.sent())&&(a=function(e){var t=null,n=Object(f.h)("mc-smartReplyWithMeeting-MeetingScheduler")?Je:ze;if(e){var r=e.ExtendedProperty;r&&r.some((function(e){return e.ExtendedFieldURI.PropertyName==n&&(t=e,!0)}))}return t}(r),nt(r,a)),s.label=3;case 3:return(o=e.SmartTimeExtendedProperty)?(i=o.entityId,u=100*o.confidenceScore,l=o.rawConfidenceScores,d=null,m=null,Object(f.h)("mc-smartReplyWithMeeting-SuggestedTimeToCAS")&&(d=function(e){var t=null;if(null==e?void 0:e.SmartTimeExtendedProperty)try{var n=Object(K.mc)(e.SmartTimeExtendedProperty.beginingOfTimeRange);if(Object($.e)(n)){var r=e.SmartTimeExtendedProperty.duration,a=Number(r);a<=0&&(a=Object(qe.a)()),t={startTime:n,endTime:Object(K.h)(n,a)}}}catch(e){throw c.g.warn("[getSmartTimeSuggestion] Unable to parse suggested time. Error: "+e.message),e.networkError=!0,e}return t}(e))?[4,ct(e,d)]:[3,5]):[3,6];case 4:s.sent(),m=Object(ot.a)(null===(t=e.ConversationId)||void 0===t?void 0:t.Id).calendarInlineComposeViewState,s.label=5;case 5:g=e,p=lt(),b=function(e,t,n,r,a,o){var i=Object(B.i)("SmartTime",Object(z.b)(Qe.d)),c=null!=a,u=r.ToRecipients?r.ToRecipients.length:0,l=r.CcRecipients?r.CcRecipients.length:0;i.mainPayload.EID=e,i.mainPayload.confidenceScore=t,i.mainPayload.rawConfidenceScores=n,i.mainPayload.hasSuggestedTime=c,i.mainPayload.NumToRecipient=u,i.mainPayload.NumCCRecipient=l,i.mainPayload.isCalendarHelpEnabled=o,i.cosmosOnlyData=r.InternetMessageId,c&&(i.mainPayload.suggestedStartTime=a.startTime,i.mainPayload.suggestedEndTime=a.endTime);return i}(i,u,l,g,d,p),S=null,p&&(S={items:ft(e,m,i,g,b)}),n.push(function(e,t,n,r,a,o,i){return{ariaLabel:Object(z.b)(Qe.d),featureName:"SmartTime",onClick:n,index:e,logData:r,text:t,toolTip:Object(f.h)("mc-smartPillsTooltipV2")?Object(z.b)(Qe.e):t,icon:o,confidenceScore:a,menuProps:i}}(n.length,Object(z.b)(Qe.d),(function(){return mt(e,m,i,g,{SuggestionsClickedTime:(new Date).toISOString()})}),b,u,{iconName:"DateTime2"},S)),s.label=6;case 6:return[3,8];case 7:c.g.info("[getSmartTimesForItem] No item, cannot produce smart times."),s.label=8;case 8:return[2,n]}}))}))}function mt(e,t,n,r,a){window.addEventListener("message",gt),rt.q.importAndExecute(e.ItemId.Id,t,!1,null,n,r.InternetMessageId,!1,a)}function ft(e,t,n,r,a){var o=[];return o.push({key:"OutlookMeeting",text:Object(z.b)(Qe.c),onClick:function(){var o=(new Date).toISOString();a.mainPayload.timeClicked=o,a.mainPayload.subtype="OutlookMeeting",Object(B.j)(a,B.g),mt(e,t,n,r,{SuggestionsClickedTime:o})}}),o.push({key:"CortanaMeeting",text:Object(z.b)(Qe.a),onClick:function(){a.mainPayload.timeClicked=(new Date).toISOString(),a.mainPayload.subtype="CortanaMeeting",Object(B.j)(a,B.g),function(e){Ee.j.importAndExecute(e.ItemId.Id,e.ConversationId.Id,Object(z.b)(Qe.b),2)}(e)}}),o}var gt=function(e){if((null==e?void 0:e.data)&&"string"==typeof e.data){var t=JSON.parse(e.data);t&&"calDraftItem"===t.source&&st.a.importAndExecute({featureName:"SmartTime"})}};var pt=n(9643),bt=n(2099),St=n(3625);function ht(e,t,n,r){var a=Object(B.i)("SmartTodo",n);return a.mainPayload.confidenceScore=e.confidenceScore,a.mainPayload.EID=e.entityId,{ariaLabel:Object(z.b)(pt.a),featureName:"SmartTodo",icon:{iconName:"ToDoLogoOutline"},onClick:function(){!function(e,t,n){if(Object(g.d)())bt.g.importAndExecute("SmartTask"),e&&t&&St.c.importAndExecute(e,t,n)}(e.description,t,e.entityId)},logData:a,index:r,text:n,toolTip:Object(f.h)("mc-smartPillsTooltipV2")?Object(z.b)(pt.c):n,confidenceScore:e.confidenceScore}}var vt=Object(r.action)("cacheSmartTaskData",(function(e,t,n){return{item:e,validPropertyExists:t,smartTasks:n}})),Ot="@EntityId",yt="@sourceConfidenceScore";function jt(e,t){var n=!1;if(e){if(t)try{n=function(e,t){var n=JSON.parse(t.Value),r=!1;if(!t)return c.g.info("[getSmartTaskForItem_parseSmartTaskProperty] No smart task extended property found."),r;var a=[];if(n&&n.length>0)for(var o=n.length,i=0;i<o;i++){var u=n[i];a.push({entityId:u[Ot],description:u.description,confidenceScore:100*Number(u[yt])})}a.length>0?vt(e,r=!0,a):c.g.info("[getSmartTasksForItem_extractAndCacheSmartTaskFromProperty] There are zero smart tasks for this item");return r}(e,t)}catch(e){throw c.g.warn("[getSmartTasksForItem_parseSmartTaskProperty] Malformed property, cannot parse. Error: "+e.message),e.networkError=!0,e}else c.g.info("[getSmartTasksForItem_parseSmartTaskProperty] No property found.");n||vt(e,!1)}else c.g.info("[getSmartTasksForItem_parseSmartTaskProperty] No item found.")}var xt,Pt="EntityExtraction/RequestForAction1.0";function It(e,t){var n;return Object(s.__awaiter)(this,void 0,void 0,(function(){var r,a;return Object(s.__generator)(this,(function(o){switch(o.label){case 0:return e?e.SmartTaskData?[3,3]:[4,ye.c.import()]:[3,4];case 1:return[4,o.sent()(e.ItemId.Id,D.a.SmartTask)];case 2:(r=o.sent())&&(a=function(e){var t=null;if(e){var n=e.ExtendedProperty;n&&n.some((function(e){return e.ExtendedFieldURI.PropertyName==Pt&&(t=e,!0)}))}return t}(r),jt(r,a)),o.label=3;case 3:return(null===(n=e.SmartTaskData)||void 0===n?void 0:n.SmartTasks)?[2,e.SmartTaskData.SmartTasks.map((function(n,r){return t==xt.Todo&&e.ItemId?ht(n,e.ItemId.Id,Object(z.b)(pt.a),r):function(e,t,n,r,a){var o=Object(B.i)("SmartReminder",r);return o.mainPayload.confidenceScore=e.confidenceScore,o.mainPayload.EID=e.entityId,{ariaLabel:Object(z.b)(pt.b),featureName:"SmartReminder",icon:{iconName:"AddEvent"},onClick:function(){rt.q.importAndExecute(t,null,!1,null,e.entityId,n,!0)},logData:o,index:a,text:r,toolTip:r,confidenceScore:e.confidenceScore}}(n,e.ItemId.Id,e.InternetMessageId,Object(z.b)(pt.b),r)}))]:[3,5];case 4:c.g.info("[getSmartTodosOrRemindersForItem] No item, cannot produce smart tasks."),o.label=5;case 5:return[2,[]]}}))}))}!function(e){e[e.Todo=0]="Todo",e[e.Reminder=1]="Reminder"}(xt||(xt={}));Object(r.mutator)(vt,(function(e){var t={SmartTasks:null},n=e.item;if(e.validPropertyExists){var r=e.smartTasks;t.SmartTasks=r}n.SmartTaskData=t}));function kt(e){var t=[];return t.push(function(e){var t=this;return{buildPills:function(){return Object(s.__awaiter)(t,void 0,void 0,(function(){return Object(s.__generator)(this,(function(t){return[2,dt(e)]}))}))},getName:function(){return"SmartTime"}}}(e)),t.push(function(e){var t=this;return{buildPills:function(){return Object(s.__awaiter)(t,void 0,void 0,(function(){return Object(s.__generator)(this,(function(t){return[2,Ie(e)]}))}))},getName:function(){return"SmartDoc"}}}(e)),t.push(function(e){var t=this;return{buildPills:function(){return Object(s.__awaiter)(t,void 0,void 0,(function(){return Object(s.__generator)(this,(function(t){return[2,Ue(e)]}))}))},getName:function(){return"SmartReply"}}}(e)),t.push(function(e){var t=this;return{buildPills:function(){return Object(s.__awaiter)(t,void 0,void 0,(function(){return Object(s.__generator)(this,(function(t){return[2,It(e,xt.Todo)]}))}))},getName:function(){return"SmartTodo"}}}(e)),Object(f.h)("mc-smartTaskWithReminder")&&t.push(function(e){var t=this;return{buildPills:function(){return Object(s.__awaiter)(t,void 0,void 0,(function(){return Object(s.__generator)(this,(function(t){return[2,It(e,xt.Reminder)]}))}))},getName:function(){return"SmartReminder"}}}(e)),t}function wt(e){var t=this;return{updateLogData:function(n){return Object(s.__awaiter)(t,void 0,void 0,(function(){var t,r,a,o,i;return Object(s.__generator)(this,(function(c){return e&&(t=null===(o=e.stampedLanguage)||void 0===o?void 0:o.language,r=null===(i=e.stampedLanguage)||void 0===i?void 0:i.locale,a=e.InternetMessageId,n.forEach((function(e){e.logData.mainPayload.language=t,e.logData.mainPayload.locale=r,e.logData.cosmosOnlyData=a}))),[2]}))}))},getName:function(){return"ItemLevelDataUpdater"}}}function Ct(e){var t=this;return{preRun:function(){return Object(s.__awaiter)(t,void 0,void 0,(function(){var t;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:return[4,ye.c.import()];case 1:return[4,n.sent()(e.ItemId.Id,D.a.LanguageAndLocale)];case 2:return(t=n.sent())&&!t.stampedLanguage&&i(t),[2]}}))}))},getName:function(){return"LanguagePreRunner"}}}var Tt=n(13840),Dt={SmartPillFeedbackGenericOption1:"Not relevant",SmartPillFeedbackGenericOption2:"Too similar",SmartPillFeedbackGenericOption3:"Meaning isn't clear",SmartPillFeedbackGenericOption4:"Doesn't sound like me",SmartPillFeedbackGenericOption5:"Offensive or rude",SmartPillFeedbackGenericOption6:"Not in the correct language",SmartPillFeedbackGenericOption7:"Other",SmartPillFeedbackMeetingOption1:"The meeting is already on my calendar",SmartPillFeedbackMeetingOption2:"A meeting suggestion isn't relevant",SmartPillFeedbackMeetingOption3:"I'm not the person who should schedule the meeting",SmartPillFeedbackMeetingOption4:"I want to schedule the meeting later",SmartPillFeedbackMeetingOption5:"I don't want help scheduling a meeting",SmartPillFeedbackFileOption1:'"Share a file" suggestion isn\'t relevant',SmartPillFeedbackFileOption2:"I'm not the one who needs to share a file",SmartPillFeedbackFileOption3:"Didn't find the file I was looking for",SmartPillFeedbackFileOption4:"Didn't get any file suggestions",SmartPillFeedbackFileOption5:"Want to share a file later"};function _t(e,t){var n;t.UniqueBody?n=t.UniqueBody.Value:t.NormalizedBody&&(n=t.NormalizedBody.Value);var r={subtitle:void 0,dSATOptions:void 0,donationJson:{messageBody:n}},a=e.some((function(e){return"SmartTime"===e.featureName})),o=e.some((function(e){return"SmartDoc"===e.featureName})),i=e.some((function(e){return"SmartReply"===e.featureName})),u=Object(f.h)("mc-smartReplyWithDoc-ShareAFile");return a&&o&&c.g.warn("[SmartPillFeedbackData] feedback options not defined for Smart Time + Smart Doc"),i?(r.subtitle=Object(z.b)(Tt.q),r.dSATOptions=a?[{logString:Dt.SmartPillFeedbackGenericOption1,uiString:Object(z.b)(Tt.j)},{logString:Dt.SmartPillFeedbackGenericOption4,uiString:Object(z.b)(Tt.m)},{logString:Dt.SmartPillFeedbackGenericOption5,uiString:Object(z.b)(Tt.n)},{logString:Dt.SmartPillFeedbackMeetingOption3,uiString:Object(z.b)(Tt.t)},{logString:Dt.SmartPillFeedbackMeetingOption5,uiString:Object(z.b)(Tt.v)},{logString:Dt.SmartPillFeedbackGenericOption7,uiString:Object(z.b)(Tt.p)}]:o?[{logString:Dt.SmartPillFeedbackGenericOption1,uiString:Object(z.b)(Tt.j)},{logString:Dt.SmartPillFeedbackGenericOption5,uiString:Object(z.b)(Tt.n)},{logString:Dt.SmartPillFeedbackFileOption2,uiString:u?Object(z.b)(Tt.d):Object(z.b)(Tt.c)},{logString:Dt.SmartPillFeedbackFileOption3,uiString:Object(z.b)(Tt.e)},{logString:Dt.SmartPillFeedbackFileOption5,uiString:u?Object(z.b)(Tt.h):Object(z.b)(Tt.g)},{logString:Dt.SmartPillFeedbackGenericOption7,uiString:Object(z.b)(Tt.p)}]:[{logString:Dt.SmartPillFeedbackGenericOption1,uiString:Object(z.b)(Tt.j)},{logString:Dt.SmartPillFeedbackGenericOption2,uiString:Object(z.b)(Tt.k)},{logString:Dt.SmartPillFeedbackGenericOption3,uiString:Object(z.b)(Tt.l)},{logString:Dt.SmartPillFeedbackGenericOption4,uiString:Object(z.b)(Tt.m)},{logString:Dt.SmartPillFeedbackGenericOption5,uiString:Object(z.b)(Tt.n)},{logString:Dt.SmartPillFeedbackGenericOption6,uiString:Object(z.b)(Tt.o)},{logString:Dt.SmartPillFeedbackGenericOption7,uiString:Object(z.b)(Tt.p)}]):a?(r.subtitle=Object(z.b)(Tt.w),r.dSATOptions=[{logString:Dt.SmartPillFeedbackMeetingOption1,uiString:Object(z.b)(Tt.r)},{logString:Dt.SmartPillFeedbackMeetingOption2,uiString:Object(z.b)(Tt.s)},{logString:Dt.SmartPillFeedbackMeetingOption3,uiString:Object(z.b)(Tt.t)},{logString:Dt.SmartPillFeedbackMeetingOption4,uiString:Object(z.b)(Tt.u)},{logString:Dt.SmartPillFeedbackMeetingOption5,uiString:Object(z.b)(Tt.v)},{logString:Dt.SmartPillFeedbackGenericOption7,uiString:Object(z.b)(Tt.p)}]):o?(r.subtitle=Object(z.b)(Tt.i),r.dSATOptions=[{logString:Dt.SmartPillFeedbackFileOption1,uiString:u?Object(z.b)(Tt.b):Object(z.b)(Tt.a)},{logString:Dt.SmartPillFeedbackFileOption2,uiString:u?Object(z.b)(Tt.d):Object(z.b)(Tt.c)},{logString:Dt.SmartPillFeedbackFileOption3,uiString:Object(z.b)(Tt.e)},{logString:Dt.SmartPillFeedbackFileOption4,uiString:Object(z.b)(Tt.f)},{logString:Dt.SmartPillFeedbackFileOption5,uiString:u?Object(z.b)(Tt.h):Object(z.b)(Tt.g)},{logString:Dt.SmartPillFeedbackGenericOption7,uiString:Object(z.b)(Tt.p)}]):r.subtitle=Object(z.b)(Tt.q),r}var Et=n(5388);var Rt=n(8026),At=n(9608),Ft=n(13841),Nt=Object(d.a)((function(e){var t,n=this;R.useEffect((function(){return g(),function(){r.current=null,o.current=null,l.current=null,u.current=null,a(e.viewState,!1)}}),[]),R.useEffect((function(){d.current||(d.current=Object(Rt.b)(e.item))}));var r=R.useRef(kt(e.item)),o=R.useRef(y),i=R.useRef(function(e){return[wt(e)]}(e.item)),u=R.useRef(function(e){return[Ct(e)]}(e.item)),l=R.useRef(),d=R.useRef(!1),f=Object(m.a)((function(){var t,n=e.item;return!(null===(t=null==n?void 0:n.ItemId)||void 0===t||!t.Id)&&null!=Object(w.a)(n.ItemId.Id,1)})),g=function(){return Object(s.__awaiter)(n,void 0,void 0,(function(){var t;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:return c.g.info("[MailSmartPillBlock] Running smart pill builders"),t=l,[4,Object(B.h)(r.current,o.current,u.current,i.current,3e3)];case 1:return t.current=n.sent(),function(e,t){var n=t?t.pillsToShow.filter((function(e){return"SmartReply"===e.featureName})):[],r=n.length>0?n[0].logData.mainPayload.EID:"",a=t&&t.pillsToShow.length>0?"True":"False",o="True"===a?t.pillsToShow.map((function(e){return e.featureName})).toString():"",i="True"===a?t.pillsToShow.map((function(e){return e.text})).join("$"):"";Object(_.o)("SmartSuggestionsSIGSDataInitialized",[JSON.stringify(t)],{isCore:!0,isCosmosDatapoint:!0}),Object(Et.a)(e.ItemId.Id,a,o,i,r)}(e.item,l.current),l.current&&l.current.pillsToShow.length>0&&(a(e.viewState,!0),Object(_.o)("SmartSuggestionsRenderedNew",[JSON.stringify(l.current)],{isCore:!0,isCosmosDatapoint:!0})),[2]}}))}))},p=e.item,b=e.viewState.smartPillBlockVisible,S=!!p.RightsManagementLicenseData,h=(null===(t=p.adaptiveCardDetails)||void 0===t?void 0:t.length)>0&&"3f0a4969-053e-44be-9931-ca62d0c32bde"!==p.adaptiveCardDetails[0].connectorSenderGuid;if(S||!b||!l.current||0==l.current.pillsToShow.length&&0==l.current.pillsToHide.length||f.get()||h)return null;var v=l.current.pillsToShow.length>0;return R.createElement("div",{className:v?Ft.bar:void 0},R.createElement(At.a,{arbitratedPills:l.current,enableFeedbackForm:!p.smartPillFeedbackSubmitted,feedbackData:_t(l.current.pillsToShow,p)}))}));n.d(t,"MailSmartPillBlock",(function(){return Nt}))},1518:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return i}));var r,a=n(0);!function(e){e[e.Groups=1e4]="Groups"}(r||(r={}));var o=Object.freeze([1,3,2,6,5,7,8,9]),i=Object.freeze(Object(a.__spread)(o,[0,4,10]))},1559:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var r={};function a(e,t){r[e]=t}function o(e){return e in r?r[e]:null}function i(e){r[e]=null}},1578:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Loaded=0]="Loaded",e[e.Loading=1]="Loading",e[e.NotLoaded=2]="NotLoaded"}(r||(r={}))},1603:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(27),a=n(295),o=n(314),i=n(76);function c(e){var t=Object(r.a)();switch(e){case 5:return t.AttachmentPolicy.GoogleDriveAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(i.h)("doc-fileProvider-gdrive");case 4:case 0:return!0;case 3:return t.AttachmentPolicy.BoxAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(i.h)("doc-fileProvider-box");case 2:return t.AttachmentPolicy.DropboxAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(i.h)("doc-fileProvider-dropbox");case 6:return t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(i.h)("doc-fileProvider-facebook");case 1:return!!Object(a.a)()||t.AttachmentPolicy.OnedriveAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled;case 10:return Object(i.h)("doc-filePicker-mailMessageAttachment");case 7:case 8:case 9:return t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(i.h)("doc-fileProvider-wopiClient");default:return Object(o.a)(e)}}},1617:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(108),a=n(1152);n.d(t,"e",(function(){return a.a})),n.d(t,"b",(function(){return a.b}));var o=n(1463);n.d(t,"d",(function(){return o.a}));var i=n(1270);n.d(t,"c",(function(){return i.a}));var c=new r.c((function(){return n.e(267).then(n.bind(null,2904))})),u=Object(r.d)(c,(function(e){return e.CloudIconWithOverlay}))},1685:function(e,t,n){"use strict";var r=n(108),a=n(2519),o=n(1889),i=n(1694),c=n(1911),u=n(2136),l=n(2137),s=n(2268),d=n(2303),m=n(2410),f=n(1088),g=n(76),p=n(965);function b(e,t){return!!e&&(1!==t&&!!p.a.conversations.get(e))}function S(e,t){return 2!=t&&(Object(g.h)("rp-persistedReadingPaneTabs")?f.a.loadedItemReadingPaneViewStates.has(e):f.a.itemReadingPaneViewState&&f.a.itemReadingPaneViewState.itemId==e)}var h=n(1995),v=n(1996),O=n(1858),y=n(1193);n.d(t,"k",(function(){return x})),n.d(t,"o",(function(){return P})),n.d(t,"l",(function(){return I})),n.d(t,"p",(function(){return k})),n.d(t,"r",(function(){return w})),n.d(t,"m",(function(){return C})),n.d(t,"n",(function(){return T})),n.d(t,"h",(function(){return D})),n.d(t,"i",(function(){return _})),n.d(t,"j",(function(){return E})),n.d(t,"g",(function(){return R})),n.d(t,"q",(function(){return A})),n.d(t,"d",(function(){return b})),n.d(t,"e",(function(){return S})),n.d(t,"f",(function(){return h.a})),n.d(t,"a",(function(){return v.a})),n.d(t,"s",(function(){return f.a})),n.d(t,"c",(function(){return O.a})),n.d(t,"b",(function(){return y.a}));var j=new r.c((function(){return Promise.all([n.e(7),n.e(10),n.e(19),n.e(18),n.e(498)]).then(n.bind(null,14995))})),x=new r.a(j,(function(e){return e.loadConversationReadingPane})),P=(new r.a(j,(function(e){return e.reloadReadingPane})),new r.a(j,(function(e){return e.moveReadingPaneToTab}))),I=new r.a(j,(function(e){return e.loadConversationReadingPaneForSingleMailItemSelected})),k=new r.a(j,(function(e){return e.print})),w=new r.a(j,(function(e){return e.setItemIdToScrollTo})),C=new r.a(j,(function(e){return e.loadItemReadingPane})),T=new r.a(j,(function(e){return e.loadItemReadingPaneForSingleMailItemSelected})),D=new r.a(j,(function(e){return e.expandCollapseAllItemParts}));Object(r.f)(i.a,j,(function(e){return e.deleteItemsStoreUpdateOrchestrator})),Object(r.f)(u.a,j,(function(e){return e.markConversationsAsReadStoreUpdateOrchestrator})),Object(r.f)(l.a,j,(function(e){return e.markItemsAsReadStoreUpdateOrchestrator})),Object(r.f)(c.a,j,(function(e){return e.markAllAsReadOrchestrator})),Object(r.f)(a.a,j,(function(e){return e.applyConversationFlagStateStoreUpdateOrchestrator})),Object(r.f)(o.a,j,(function(e){return e.deleteConversationStoreUpdateOrchestrator})),Object(r.f)(m.a,j,(function(e){return e.conversationReadyToLoadOrchestrator})),Object(r.f)(m.b,j,(function(e){return e.updateItemMandatoryPropertiesOrchestrator})),Object(r.f)(s.a,j,(function(e){return e.updateInternetMessageIdOrchestrator})),Object(r.f)(d.a,j,(function(e){return e.initializeExtendedCardForItemReadingPaneOrchestrator}));var _=new r.b(j,(function(e){return e.getLastestNonDraftItemId})),E=new r.b(j,(function(e){return e.isUnsupportedItem})),R=new r.a(j,(function(e){return e.clearReadingPaneStore})),A=new r.a(j,(function(e){return e.replyByMeeting}))},1762:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1362);function a(){return Object(r.a)().loadState}},1785:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(2487),a=n(2315),o=n(2426),i=n(9),c=n(314);function u(e,t){if(void 0===t&&(t=!1),t)return"";switch(e){case 0:return Object(i.b)(o.b);case 1:return Object(i.b)(o.a);case 2:case 9:return Object(i.b)(r.b);case 3:case 7:return Object(i.b)(r.a);case 5:return Object(i.b)(r.e);case 6:return Object(i.b)(r.d);case 4:return Object(i.b)(r.f);case 10:return Object(i.b)(a.b);case 8:return Object(i.b)(r.c);default:return Object(c.a)(e)}}},1805:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.Images=1]="Images"}(r||(r={})),t.a=r},2099:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return s})),n.d(t,"h",(function(){return d})),n.d(t,"e",(function(){return m})),n.d(t,"c",(function(){return f}));var r=n(1285),a=n(108),o=new a.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(567)]).then(n.bind(null,3461))}));Object(a.f)(r.e,o,(function(e){return e.openTimePanelOrchestrator}));var i=Object(a.d)(o,(function(e){return e.TimePanel})),c=Object(a.d)(o,(function(e){return e.TimePanelHeaderBar})),u=new a.a(o,(function(e){return e.loadTimePanelData})),l=new a.a(o,(function(e){return e.openEventDetailsView})),s=(new a.a(o,(function(e){return e.openAttendeeTrackingView})),new a.a(o,(function(e){return e.closeAttendeeTrackingView})),new a.a(o,(function(e){return e.openTasksView}))),d=new a.a(o,(function(e){return e.openCalendarView})),m=new a.a(o,(function(e){return e.openConflictsView})),f=new a.a(o,(function(e){return e.closeConflictsView}));new a.a(o,(function(e){return e.openEventQuickComposeView}))},2277:function(e,t,n){"use strict";var r=n(108),a=n(1559);n.d(t,"a",(function(){return a.a})),n.d(t,"d",(function(){return a.c}));var o=n(1263);n.d(t,"b",(function(){return o.b}));var i=n(1603);n.d(t,"c",(function(){return i.a}));var c=new r.c((function(){return n.e(269).then(n.bind(null,3692))})),u=new r.a(c,(function(e){return e.addFileProviderAfterAuthFinished}));"undefined"!=typeof window&&void 0!==window.Owa&&(window.Owa.lazyAddFileProviderAfterAuthFinished=u);new r.b(c,(function(e){return e.getAddableFileProviderInfo})),new r.b(c,(function(e){return e.addFileProvider})),new r.b(c,(function(e){return e.createAddableFileProviderInfo})),new r.b(c,(function(e){return e.getAuthRedirectPageUrl}))},2315:function(e){e.exports=JSON.parse('{"a":"Dca","b":"Eca"}')},2316:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2277);function a(e){return Object(r.c)(e)}},2380:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u}));var r=n(59),a=n(22),o=n(103),i=n(76);function c(){var e=Object(r.a)("targetServer"),t="DefaultAnchorMailbox"+(e?"_"+e.toLocaleLowerCase():"");return Object(r.a)(t)}function u(){var e,t,n=(e="",(t=Object(a.a)().pathname.split("/").filter((function(e){return e.length}))).length>=2&&t[1].match(/.+@.+/)&&(e=t[1]),e);if(Object(i.h)("fwk-puidBasedRouting")&&0===n.length){var r=Object(o.i)();if(null==r?void 0:r.SessionSettings){var u=r.SessionSettings.ExternalDirectoryTenantGuid,l=r.SessionSettings.UserPuid;l&&u&&(n="PUID:"+l+"@"+u)}}return 0===n.length&&(n=c()),n}},2385:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));var r=n(1518),a="file provider is not addable";function o(e){return r.a.indexOf(e)>-1}},2405:function(e,t,n){"use strict";var r=n(556),a=n(2);function o(e,t,n){if(!e||!t||!n)throw new Error("Key and Value parameters should not be null");return e.indexOf("?")>0?e+"&"+t+"="+n:e+"?"+t+"="+n}n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return l}));var i=Object(a.G)()?"https://exchangelabs.live-int.com/owa":"https://outlook.office.com/owa";function c(e){var t=e?encodeURIComponent("?provider="+e):"",n=e&&6===e?"AddFacebookFileProvider.html":"AddFileProvider.html";return Object(r.m)()+"/mail/"+n+t}function u(e){var t=Object(r.m)()+"/mail/AddFileProvider.html",n=encodeURIComponent("provider="+e+"&url="+t);return i+"/ADPRedirect.aspx?"+n}function l(e,t,n,r,a,i){return function(){var e=function(){for(var e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),t=e.length-1,n=[],r=0;r<16;r++)n.push(e[Math.round(Math.random()*t)]);return"owa_csrf_token_"+n.join("")}(),c=o(t,"client_id",r);if(c=o(c,"redirect_uri",n),c=o(c,"response_type",a),i){var u=i(e);c=Object.keys(u).reduce((function(e,t){return o(e,t,u[t])}),c)}return{authUrl:c,redirectUrl:n,csrfToken:e}}}},2426:function(e){e.exports=JSON.parse('{"b":"Bca","a":"Cca"}')},2487:function(e){e.exports=JSON.parse('{"b":"vca","a":"wca","e":"xca","d":"yca","f":"zca","c":"Aca"}')},2668:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return c}));var r=n(4),a=Object(r.action)("PRE_LOAD_TODO_PANEL_DATA",(function(e,t){return{loadPanelDataConfig:e,preLoadTasks:t}})),o=Object(r.action)("initializeQuickAdd",(function(e,t,n){return{subject:e,linkedEmailEwsId:t,extractionId:n}})),i=Object(r.action)("switchListAndCreateTasks",(function(e,t){return{todos:e,listId:t}})),c=Object(r.action)("clickTaskItem",(function(e){return{taskId:e}}))},2946:function(e,t,n){"use strict";var r,a,o=n(108),i=n(5388),c=n(4),u=n(963);Object(c.mutator)(i.a,(function(e){var t=e.itemId,n=e.isSmartSuggestionsRendered,r=e.suggestionTypesRendered,a=e.suggestionsRendered,o=e.extractionId,i=Object(u.i)().items.get(t);(null==i?void 0:i.SIGSData)&&(i.SIGSData.SmartPillData={IsSmartSuggestionsRendered:n,SuggestionTypesRendered:r,SuggestionsRendered:a,ExtractionId:o})}));function l(e){return{smartReplyComposeSIGSData:{isSmartSuggestionsClicked:!1,suggestionsClickedTime:null,clickIndex:-1},smartDocOption:e||r.None}}!function(e){e[e.None=0]="None",e[e.FileSuggestion=1]="FileSuggestion",e[e.LocalFiles=2]="LocalFiles",e[e.CloudFiles=3]="CloudFiles",e[e.UploadAndShare=4]="UploadAndShare"}(r||(r={})),function(e){e.LanguageAndLocale="SmartPill_LanguageAndLocale",e.SmartDoc="SmartPill_SmartDoc",e.SmartReply="SmartPill_SmartReply",e.SmartTask="SmartPill_SmartTask",e.SmartTime="SmartPill_SmartTime"}(a||(a={})),n.d(t,"d",(function(){return d})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return l}));var s=new o.c((function(){return n.e(549).then(n.bind(null,14919))})),d=new o.a(s,(function(e){return e.logToSIGSOnMessageSent}))},310:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(4),a={shouldEventsEndEarly:void 0,endShortEventsBy:void 0,endLongEventsBy:void 0,enableOnlineMeetingsByDefault:void 0,isOnlineMeetingsByDefaultSynced:void 0},o=Object(r.createStore)("CalendarCloudSettings",a)},3625:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"e",(function(){return l}));var r=n(108),a=n(2668);n.d(t,"b",(function(){return a.a}));var o=new r.c((function(){return Promise.all([n.e(6),n.e(21),n.e(727),n.e(4),n.e(574)]).then(n.bind(null,6489))})),i=Object(r.d)(o,(function(e){return e.TaskListView})),c=new r.a(o,(function(e){return e.loadTaskPanelData})),u=new r.a(o,(function(e){return e.initializeQuickAdd})),l=new r.a(o,(function(e){return e.switchListAndCreateTasks}))},3846:function(e,t,n){"use strict";var r=n(0),a=2500,o=n(254),i=n(324);function c(e,t,n){var r=new i.a(e,t,{isCore:!0,isCosmosDatapoint:!0});n&&r.addCosmosOnlyData(n),o.k.importAndExecute(r)}function u(e,t,n,i,u){return Object(r.__awaiter)(this,void 0,void 0,(function(){var l,s,d,m,f,g,p,b,S,h;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return l={},s=u||a,n?[4,Promise.all(n.map((function(e){return e.preRun().catch((function(t){l[e.getName()]=new Error(t)}))})))]:[3,2];case 1:r.sent(),r.label=2;case 2:return(d=new o.a("SmartPillPerformance",{sessionSampleRate:10})).addCustomProperty("preDefinedTimeout",s),[4,Promise.all(e.map((function(e){return Promise.race([e.buildPills(),(t=s,new Promise((function(e,n){setTimeout((function(){var e=new Error("timeout");e.networkError=!0,n(e)}),t)})))]).catch((function(t){return l[e.getName()]=new Error(t),[]}));var t}))).then((function(e){return d.end(),e}))];case 3:return m=r.sent(),f=[].concat.apply([],m),g=f.length,i?[4,Promise.all(i.map((function(e){return e.updateLogData(f).catch((function(t){l[e.getName()]=new Error(t)}))})))]:[3,5];case 4:r.sent(),r.label=5;case 5:p={pillsToShow:[],pillsToHide:[],arbitratorId:""};try{p=t.arbitratePills(f)}catch(e){l.arbitrator=new Error(e)}return(b=Object.keys(l)).length>0&&(S=[],h=[],b.forEach((function(e){var t=l[e];t.hasOwnProperty("networkError")?S.push(e+"_"+t.message):h.push(e+"_"+t.message)})),c("SmartPillError",[S.toString(),h.toString(),g])),[2,p]}}))}))}function l(e,t,n){return{mainPayload:{renderStory:0,loggableText:t,type:e,timeClicked:null,position:-1},cosmosOnlyData:n}}function s(e){e.mainPayload.timeClicked=null,delete e.mainPayload.subtype,delete e.mainPayload.numOfFileSuggestions,delete e.mainPayload.isSuccessful}function d(e,t,n){var r=void 0;e.concat(t).forEach((function(e){!r&&e.logData.cosmosOnlyData&&(r=e.logData.cosmosOnlyData)}));var a={data:e.map((function(e){return e.logData.mainPayload}))},o={data:t.map((function(e){return e.logData.mainPayload}))};c("SmartPillsRendered",[e.length,t.length,JSON.stringify(a),JSON.stringify(o),n],r)}function m(e,t,n,r,a,o,i){c("SmartReply_Rendered",[e,!1,t.join("$"),!1,n.toString(),r.toString(),a,o],i)}function f(e,t){var n={data:[e.mainPayload]};c(t,[JSON.stringify(n)],e.cosmosOnlyData)}function g(e,t,n,r,a,o,i,u){c("SmartReply_Clicked",[e,t,n,!1,r,a,o,u],i)}n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return l})),n.d(t,"o",(function(){return s})),n.d(t,"l",(function(){return d})),n.d(t,"m",(function(){return m})),n.d(t,"j",(function(){return f})),n.d(t,"k",(function(){return g})),n.d(t,"n",(function(){return c})),n.d(t,"d",(function(){return"SmartPillClicked"})),n.d(t,"e",(function(){return"SmartPillMenuOpened"})),n.d(t,"g",(function(){return"SmartTimeMenuClicked"})),n.d(t,"a",(function(){return"SmartDocMenuClicked"})),n.d(t,"b",(function(){return"SmartDocMenuClosed"})),n.d(t,"c",(function(){return"SmartDocSpinnerDisposed"})),n.d(t,"f",(function(){return"SmartReplyMenuClicked"}))},385:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u}));var r=n(0),a=n(14),o=n(331),i=function(){return{position:"absolute",width:1,right:31,top:8,bottom:8}};function c(e){var t,n,o,c,u,l=e.semanticColors,s=e.palette,d=l.buttonBackground,m=l.buttonBackgroundPressed,f=l.buttonBackgroundHovered,g=l.buttonText,p=l.buttonTextHovered,b=l.buttonTextChecked,S=l.buttonTextCheckedHovered;return{root:{backgroundColor:d,color:g},rootHovered:{backgroundColor:f,color:p,selectors:(t={},t[a.HighContrastSelector]={borderColor:"Highlight",color:"Highlight"},t)},rootPressed:{backgroundColor:m,color:b},rootExpanded:{backgroundColor:m,color:b},rootChecked:{backgroundColor:m,color:b},rootCheckedHovered:{backgroundColor:m,color:S},rootDisabled:{selectors:(n={},n[a.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},n)},splitButtonContainer:{selectors:(o={},o[a.HighContrastSelector]={border:"none"},o)},splitButtonMenuButton:{color:s.white,backgroundColor:"transparent",selectors:{":hover":{backgroundColor:s.neutralLight,selectors:(c={},c[a.HighContrastSelector]={color:"Highlight"},c)}}},splitButtonMenuButtonDisabled:{backgroundColor:l.buttonBackgroundDisabled,selectors:{":hover":{backgroundColor:l.buttonBackgroundDisabled}}},splitButtonDivider:Object(r.__assign)(Object(r.__assign)({},i()),{backgroundColor:s.neutralTertiaryAlt,selectors:(u={},u[a.HighContrastSelector]={backgroundColor:"WindowText"},u)}),splitButtonDividerDisabled:{backgroundColor:e.palette.neutralTertiaryAlt},splitButtonMenuButtonChecked:{backgroundColor:s.neutralQuaternaryAlt,selectors:{":hover":{backgroundColor:s.neutralQuaternaryAlt}}},splitButtonMenuButtonExpanded:{backgroundColor:s.neutralQuaternaryAlt,selectors:{":hover":{backgroundColor:s.neutralQuaternaryAlt}}},splitButtonMenuIcon:{color:l.buttonText},splitButtonMenuIconDisabled:{color:l.buttonTextDisabled}}}function u(e){var t,n,c,u,l,s,d,m,f,g=e.palette,p=e.semanticColors;return{root:{backgroundColor:p.primaryButtonBackground,border:"1px solid "+p.primaryButtonBackground,color:p.primaryButtonText,selectors:(t={},t[a.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",borderColor:"WindowText",MsHighContrastAdjust:"none"},t["."+o.a+" &:focus"]={selectors:{":after":{border:"none",outlineColor:g.white}}},t)},rootHovered:{backgroundColor:p.primaryButtonBackgroundHovered,border:"1px solid "+p.primaryButtonBackgroundHovered,color:p.primaryButtonTextHovered,selectors:(n={},n[a.HighContrastSelector]={color:"Window",backgroundColor:"Highlight",borderColor:"Highlight"},n)},rootPressed:{backgroundColor:p.primaryButtonBackgroundPressed,border:"1px solid "+p.primaryButtonBackgroundPressed,color:p.primaryButtonTextPressed,selectors:(c={},c[a.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",borderColor:"WindowText",MsHighContrastAdjust:"none"},c)},rootExpanded:{backgroundColor:p.primaryButtonBackgroundPressed,color:p.primaryButtonTextPressed},rootChecked:{backgroundColor:p.primaryButtonBackgroundPressed,color:p.primaryButtonTextPressed},rootCheckedHovered:{backgroundColor:p.primaryButtonBackgroundPressed,color:p.primaryButtonTextPressed},rootDisabled:{selectors:(u={},u[a.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},u)},splitButtonContainer:{selectors:(l={},l[a.HighContrastSelector]={border:"none"},l)},splitButtonDivider:Object(r.__assign)(Object(r.__assign)({},i()),{backgroundColor:g.white,selectors:(s={},s[a.HighContrastSelector]={backgroundColor:"Window"},s)}),splitButtonMenuButton:{backgroundColor:p.primaryButtonBackground,color:p.primaryButtonText,selectors:(d={},d[a.HighContrastSelector]={backgroundColor:"WindowText"},d[":hover"]={backgroundColor:p.primaryButtonBackgroundHovered,selectors:(m={},m[a.HighContrastSelector]={color:"Highlight"},m)},d)},splitButtonMenuButtonDisabled:{backgroundColor:p.primaryButtonBackgroundDisabled,selectors:{":hover":{backgroundColor:p.primaryButtonBackgroundDisabled}}},splitButtonMenuButtonChecked:{backgroundColor:p.primaryButtonBackgroundPressed,selectors:{":hover":{backgroundColor:p.primaryButtonBackgroundPressed}}},splitButtonMenuButtonExpanded:{backgroundColor:p.primaryButtonBackgroundPressed,selectors:{":hover":{backgroundColor:p.primaryButtonBackgroundPressed}}},splitButtonMenuIcon:{color:p.primaryButtonText},splitButtonMenuIconDisabled:{color:g.neutralTertiary,selectors:(f={},f[a.HighContrastSelector]={color:"GrayText"},f)}}}},396:function(e,t,n){"use strict";var r=n(108),a=n(491),o=n(310);function i(){return Object(o.a)().endShortEventsBy}function c(){return Object(o.a)().endLongEventsBy}var u=n(492),l=n(615),s=n(76),d=5;function m(){if(!Object(s.h)("cal-mf-shouldEventsEndEarlySetting"))return 0;var e=i();return null!=e?e:d}var f=10;function g(){if(!Object(s.h)("cal-mf-shouldEventsEndEarlySetting"))return 0;var e=c();return null!=e?e:f}var p=n(616);n.d(t,"j",(function(){return S})),n.d(t,"i",(function(){return h})),n.d(t,"h",(function(){return a.a})),n.d(t,"g",(function(){return i})),n.d(t,"f",(function(){return c})),n.d(t,"e",(function(){return u.a})),n.d(t,"d",(function(){return l.a})),n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return g})),n.d(t,"c",(function(){return p.a}));var b=new r.c((function(){return n.e(171).then(n.bind(null,15041))})),S=new r.a(b,(function(e){return e.saveCalendarCloudSettings})),h=new r.a(b,(function(e){return e.initCalendarCloudSettings}))},432:function(e,t,n){"use strict";var r=n(0),a=n(1),o=n(344),i=n(427),c=n(421),u=n(14),l=n(245),s=n(345),d=n(384),m=n(385),f=Object(l.c)((function(e,t,n){var r=Object(s.a)(e),a=Object(d.a)(e),o={root:{minWidth:"80px",height:"32px"},label:{fontWeight:u.FontWeights.semibold}};return Object(u.concatStyleSets)(r,o,n?Object(m.a)(e):Object(m.b)(e),a,t)}));n.d(t,"a",(function(){return g}));var g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.primary,n=void 0!==t&&t,c=e.styles,u=e.theme;return a.createElement(o.a,Object(r.__assign)({},this.props,{variantClassName:n?"ms-Button--primary":"ms-Button--default",styles:f(u,c,n),onRenderDescription:i.b}))},t=Object(r.__decorate)([Object(c.a)("DefaultButton",["theme","styles"],!0)],t)}(a.Component)},491:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(310);function a(){return Object(r.a)().shouldEventsEndEarly}},492:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(647),a=n(310),o=n(662);function i(){return Object(o.a)()&&Object(r.f)(),Object(a.a)().enableOnlineMeetingsByDefault}},5388:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("initializeSIGSDataAction",(function(e,t,n,r,a){return{itemId:e,isSmartSuggestionsRendered:t,suggestionTypesRendered:n,suggestionsRendered:r,extractionId:a}}))},5631:function(e){e.exports=JSON.parse('{"b":"P6a","a":"Q6a","c":"R6a","d":"S6a"}')},597:function(e,t,n){"use strict";var r=n(396);function a(e){return Object(r.d)()?e<60?Object(r.b)():Object(r.a)():0}var o=n(103);function i(){var e=Object(o.b)(),t=a(e);return Math.max(e-t,0)}var c=n(7);function u(e,t){var n=a(Object(c.x)(t,e));return n?Object(c.fc)(t,n):t}var l=n(76);function s(e,t,n,r){if(!Object(l.h)("cal-mf-shouldEventsEndEarlySetting"))return r;var o=Object(c.x)(t,e),i=Object(c.x)(r,n);if(o!==i&&!Object(c.Ib)(t,r)){var u=a(i),s=u?Object(c.fc)(r,u):r;if(Object(c.Hb)(n,s))return s}return r}n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return s}))},6078:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l})),n.d(t,"f",(function(){return s})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return f})),n.d(t,"j",(function(){return g})),n.d(t,"g",(function(){return p}));var r=n(296),a=n(76),o="Language",i="Locale",c="LanguageScores",u="@EntityId",l="EntityExtraction/ExtractLanguage1.0",s=Object(r.a)({PropertyName:l,DistinguishedPropertySetId:"Common",PropertyType:"String"}),d=Object(r.a)({PropertyName:"EntityExtraction/SmartReplyForEmail",DistinguishedPropertySetId:"Common",PropertyType:"String"}),m=Object(a.h)("mc-smartReplyWithMeeting-MeetingScheduler")?"EntityExtraction/CalendarRelated1.0":"EntityExtraction/Events1.0",f=Object(r.a)({PropertyName:m,DistinguishedPropertySetId:"Common",PropertyType:"String"}),g=Object(r.a)({PropertyName:"EntityExtraction/RequestForAction1.0",DistinguishedPropertySetId:"Common",PropertyType:"String"}),p=Object(r.a)({PropertyName:"EntityExtraction/SendContentRequestV21.0",DistinguishedPropertySetId:"Common",PropertyType:"String"})},615:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(491),a=n(76),o=!1;function i(){if(!Object(a.h)("cal-mf-shouldEventsEndEarlySetting"))return!1;var e=Object(r.a)();return null!=e?e:o}},616:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(492),a=n(76),o=!1;function i(){if(!Object(a.h)("cal-mf-enableDefaultOnlineMeetingSetting"))return!1;var e=Object(r.a)();return null!=e?e:o}},647:function(e,t,n){"use strict";n.d(t,"e",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"g",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"d",(function(){return s}));var r=n(4),a=Object(r.action)("setShouldEventsEndEarly",(function(e){return{shouldEventsEndEarly:e}})),o=Object(r.action)("setEndShortEventsBy",(function(e){return{endShortEventsBy:e}})),i=Object(r.action)("setEndLongEventsBy",(function(e){return{endLongEventsBy:e}})),c=Object(r.action)("updateCalendarCloudSettings",(function(e){return{calendarCloudSettings:e}})),u=Object(r.action)("setEnableOnlineMeetingsByDefault",(function(e){return{enableOnlineMeetingsByDefault:e}})),l=Object(r.action)("syncOnlineMeetingsCloudSettingWithMailboxConfig"),s=Object(r.action)("setIsOnlineMeetingsByDefaultSynced",(function(e){return{isOnlineMeetingsByDefaultSynced:e}}))},662:function(e,t,n){"use strict";var r=n(310);var a=n(76),o=n(103);function i(){return Object(a.h)("cal-mf-onlineMeetingSyncOCSWithMailboxConfig")&&!Object(r.a)().isOnlineMeetingsByDefaultSynced&&!Object(r.a)().enableOnlineMeetingsByDefault&&Object(o.d)()}n.d(t,"a",(function(){return i}))},8026:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l}));var r=n(0),a=n(254),o=n(963),i=n(79),c=4e3;function u(e){var t,n;if(e.SIGSData&&e.SIGSData.SmartPillData){var r=e.SIGSData.SmartPillData,o=r.IsSmartSuggestionsRendered,u=r.SuggestionTypesRendered,l=r.SuggestionsRendered,s=r.ExtractionId,d=e.InternetMessageId,m=(null===(t=e.UniqueBody)||void 0===t?void 0:t.Value)||(null===(n=e.NormalizedBody)||void 0===n?void 0:n.Value);if(m&&(m=m.substring(0,c)),"True"===o){var f={InternetMessageId:d,MessageBody:m,SuggestionTypesRendered:u,SuggestionsRendered:l,ExtractionId:s};return Object(a.o)("SmartSuggestionsRendered",[JSON.stringify(e.SIGSData.SmartPillData)],{isCore:!0,isCosmosDatapoint:!0}),a.l.importAndExecute("SmartSuggestionsRendered",{compliance:"CustomerContent",customProperties:f}),!0}}else i.g.warn("SIGSData object not initialized on item.");return!1}function l(e,t,n){var u,l,s;try{if(e){var d=Object(o.i)().items.get(e);if(null===(u=null==d?void 0:d.SIGSData)||void 0===u?void 0:u.SmartPillData){var m=d.InternetMessageId,f=(null===(l=d.NormalizedBody)||void 0===l?void 0:l.Value)||(null===(s=d.UniqueBody)||void 0===s?void 0:s.Value);f&&(f=f.substring(0,c));var g=t.substring(0,c);Object(a.o)("SmartSuggestionsClicked",[JSON.stringify(d.SIGSData.SmartPillData)],{isCore:!0,isCosmosDatapoint:!0}),a.l.importAndExecute("SmartSuggestionsClicked",{compliance:"CustomerContent",customProperties:Object(r.__assign)(Object(r.__assign)({InternetMessageId:m,MessageBody:f},d.SIGSData.SmartPillData),{IsSmartSuggestionsClicked:n&&n.isSmartSuggestionsClicked?"True":"False",SuggestionsClickedTime:null==n?void 0:n.suggestionsClickedTime,ClickIndex:n&&n.clickIndex.toString(),ReplyBody:g})})}}}catch(e){i.d("[logToSIGSOnMessageSent] Error: "+e.message)}}},9608:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(108),a=new r.c((function(){return n.e(550).then(n.bind(null,10648))})),o=(Object(r.d)(a,(function(e){return e.SmartPill})),Object(r.d)(a,(function(e){return e.SmartPillBlock})))},9643:function(e){e.exports=JSON.parse('{"a":"C6c","b":"D6c","c":"E6c"}')}}]);
//# sourceMappingURL=owa.MailSmartPill.js.map
self.scriptsLoaded['owa.MailSmartPill.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailSmartPill.js'] = (new Date()).getTime();