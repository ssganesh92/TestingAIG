self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.SurfaceActionsOption.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[556],{1017:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var r=t(295),i=t(988),o=t(76);function a(){var e;return(e={})[i.a.SmartSuggestions]={smartSuggestionsEnabled:!0,browserLocationEnabled:!1},e[i.a.DiverseEmojis]={diverseEmojisSelectedSkinTone:""},e[i.a.SurfaceActions]={readSurfaceActions:["Reply","ReplyAll","Forward"].concat(Object(r.a)()?[]:["LikeUnlike"]),readSurfaceAddins:[],composeSurfaceActions:["AddAttachment","AddInlineImage","AddEmoji","ToggleDictation","ProofingOptions","QuickUse","ToggleRibbon","FluidHeroButton"],composeSurfaceAddins:[]},e[i.a.SkypeNotifications]={skypeMessageNotification:1,skypeCallingNotification:1},e[i.a.Confetti]={confettiEnabled:!0},e[i.a.ComposeAssistance]={composeAssistanceEnabled:!0},e[i.a.GdprAdsPrefs]={feature:i.a.GdprAdsPrefs,consentString:null,allowStorageAndAccess:!1,allowPersonalization:!1,allowAdSelectionDeliveryReporting:!1,allowContentSelectionDeliveryReporting:!1,allowMeasurement:!1},e[i.a.CalendarSurfaceAddins]={calendarSurfaceAddins:[]},e[i.a.ExternalImages]={externalImagesSelectedOption:0},e[i.a.EventCapture]={autoCollectionEnabled:!1},e[i.a.Translation]={translationMode:0,targetLanguage:"",excludedLanguages:[]},e[i.a.CalendarSurfaceOptions]={agendaPaneIsClosed:!1,roamingTimeZoneTeachingMomentDisplayed:!1,bannedRoamingTimeZone:null,lastKnownRoamingTimeZone:null,roamingTimeZoneNotificationsIsDisabled:!1,allDayWellHeight:0,numDaysInDayRange:1,workLifeView:3},e[i.a.AmpDeveloper]={enabled:Object(o.h)("rp-ampDefault"),allowedSender:[]},e[i.a.CalendarHelp]={calendarHelpEnabled:!1},e[i.a.LinkedInViewProfile]={dismissed:!1},e[i.a.Bohemia]={bohemiaEnabled:Object(o.h)("cmp-prague")},e[i.a.GdprAdsV2]={feature:i.a.GdprAdsV2,consentString:null,allowStorageAndAccess:!0,allowPersonalization:!0,allowAdSelectionDeliveryReporting:!0,allowContentSelectionDeliveryReporting:!0,allowMeasurement:!0,disselectedVendorId:[],selectedVendorId:[]},e[i.a.GdprAdsV3]={feature:i.a.GdprAdsV3,encodedTCString:null,allStoreAndAccessDevice:!1,allowDevelopAndImproveProduct:!1,allowPersonalisedAds:!1,allowPersonalisedAdsSelectBasicAd:!1,allowPersonalisedAdsApplyMarketResearch:!1,allowPersonalisedAdsMeasureContentPerformance:!1,allowPersonalisedAdsSelectPersonalisedAds:!1,allowPersonalisedAdsMeasureAdPerf:!1,allowPersonalisedAdsSelectPersonalisedContent:!1,allowPersonalisedAdsCreatePersonalisedContentProfile:!1,allowPersonalisedAdsCreatePersonalisedAdsProfile:!1,allowPreciseGeoDataAndIdentifyDevice:!1,allowPreciseGeoDataAndIdentifyDeviceScanDevice:!1,allowPreciseGeoDataAndIdentifyDeviceGeoData:!1,disselectedVendorId:[],selectedVendorId:[]},e[i.a.Proofing]={feature:i.a.Proofing,spellCheckEnabled:!0,grammarEnabled:!0,writingRefinementsEnabled:!0,proofingLocale:void 0,overriddenOptions:void 0},e[i.a.ActiveProxyAddress]={feature:i.a.ActiveProxyAddress,activeProxyAddresses:[]},e[i.a.OutlookSpaces]={feature:i.a.OutlookSpaces,backgroundColor:"",gestureScheme:"pointer",toolboxCollapsed:!0},e[i.a.SxS]={feature:i.a.SxS,hideReadingPane:!1},e}},10626:function(e,n,t){"use strict";t.r(n);var r=t(0),i=t(3933),o=t(4),a=t(956),c=t(3366),u=t(960),s=t(7947),d=t(7949);Object(o.orchestrator)(i.a,(function(e){return function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(t){return n=Object(a.c)(Object(c.a)().readSurfaceActions,Object(u.d)(u.a.SurfaceActions).readSurfaceActions).slice(),Object(s.a)("readSurfaceActions",n,"ToggleDarkMode",e),Object(d.a)(),[2]}))}))}(e.isDarkModeEnabled)}));var l=t(3365),f=Object(o.action)("initializeHoverSurfaceAction");Object(o.mutator)(f,(function(e){var n=Object(l.a)();Object(c.a)().hoverSurfaceActions=n}));var b=t(27),O=t(7948);Object(o.mutator)(O.a,(function(e){var n=Object(l.b)(e.hoverActionKeys);Object(b.a)().ViewStateConfiguration.MailTriageOnHoverActions=n,Object(c.a)().hoverSurfaceActions=e.hoverActionKeys}));var p=t(1004),S=t(295),A=t(3112);function g(){f(),u.g.importAndExecute().then((function(){if(!Object(S.a)()&&!Object(p.a)(16)&&!Object(A.j)("LikeUnlike")){var e=Object(a.c)(Object(c.a)().readSurfaceActions,Object(u.d)(u.a.SurfaceActions).readSurfaceActions).slice();Object(s.a)("readSurfaceActions",e,"LikeUnlike",!0),Object(d.a)(),Object(p.b)(!0,16);var n=Object(b.a)().ViewStateConfiguration;Object(a.l)([{propertyName:"ListViewBitFlags",propertyType:"Integer32",propertyValue:""+n.ListViewBitFlags}],"OWA.ViewStateConfiguration")}}))}t.d(n,"pinLikeSurfaceAction",(function(){return g}))},1232:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(4),i=t(1017),o=Object(r.action)("APPLY_DEFAULT_OPTIONS_ON_LOAD_FAIL",(function(e){return void 0===e&&(e=Object(i.a)()),{defaultOptions:e}}))},1537:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(4),i=Object(r.action)("HIDE_FULL_OPTION",(function(e,n){return{showQuickOptions:e,subcategory:n}}))},1545:function(e,n,t){"use strict";var r=t(108),i=t(1654);function o(){return Object(i.a)().isFluidEnabled}t.d(n,"c",(function(){return c})),t.d(n,"b",(function(){return u})),t.d(n,"a",(function(){return o}));var a=new r.c((function(){return Promise.all([t.e(4),t.e(282)]).then(t.bind(null,15150))})),c=new r.a(a,(function(e){return e.updateTenantConfigForFluid})),u=new r.a(a,(function(e){return e.setIsFluidEnabled}))},1654:function(e,n,t){"use strict";var r=t(4),i=Object(r.createStore)("fluidTenantConfigStore",{isFluidEnabled:!1});n.a=i},2264:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(103),i=t(76);function o(){if(Object(i.h)("outlookSpaces-enabled")){var e=Object(r.i)().SessionSettings;switch(null==e?void 0:e.WebSessionType){case 0:return!0;case 1:var n=!!(null==e?void 0:e.IsPremiumConsumerMailbox),t=Object(i.h)("outlookSpaces-free-consumer-enabled");return n||t;case 2:return Object(i.h)("outlookSpaces-gmail-enabled")}}return!1}},2700:function(e){e.exports=JSON.parse('{"a":"jFa"}')},3917:function(e){e.exports=JSON.parse('{"a":"sFa"}')},3933:function(e,n,t){"use strict";var r=t(4);n.a=Object(r.action)("TOGGLE_DARK_MODE_THEME",(function(e){return{isDarkModeEnabled:e}}))},7288:function(e,n,t){"use strict";t.d(n,"a",(function(){return s})),t.d(n,"b",(function(){return d}));var r=t(0),i=t(7948),o=t(318),a=t(317),c=t(285),u=t(3365),s=4;function d(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(t){for(e=e.filter((function(e){return"None"!=e})).slice(0,s);e.length<s;)e.unshift("None");return n=Object(u.b)(e),Object(i.a)(e),Object(o.a)("OWA.ViewStateConfiguration",[Object(a.a)({DictionaryKey:Object(c.a)({Type:"String",Value:["MailTriageOnHoverActions"]}),DictionaryValue:Object(c.a)({Type:"StringArray",Value:n})})]),[2]}))}))}},7947:function(e,n,t){"use strict";var r=t(0),i=t(3366),o=t(283),a=t(7288),c=t(989);n.a=Object(o.select)({optionState:function(){return Object(i.a)()}})(Object(o.action)("selectSurfaceActionsOption")((function(e,n,t,i,o){var u=o.optionState;if(i){if("hoverSurfaceActions"==e&&!function(e){if(e.filter((function(e){return"None"!=e})).length>=a.a)return!1;return!0}(n))return void function(){Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Object(c.b)("Too many actions selected","A maximum of four quick actions are supported at this time.",!1,{hideCancelButton:!0})];case 1:return e.sent(),[2]}}))}))}();-1==n.indexOf(t)&&n.push(t)}else{var s=n.indexOf(t);s>=0&&n.splice(s,1)}u[e]=n})))},7948:function(e,n,t){"use strict";var r=t(4),i=Object(r.action)("saveHoverSurfaceAction",(function(e){return{hoverActionKeys:e}}));n.a=i},7949:function(e,n,t){"use strict";var r=t(0),i=t(7288),o=t(3366),a=t(283),c=t(956),u=t(254),s=t(960);function d(e){return e>=23?23:e}n.a=Object(a.select)({optionState:function(){return Object(o.a)()},userOptions:function(){return Object(s.d)(s.a.SurfaceActions)}})(Object(a.action)("saveSurfaceActionsOption")((function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,t;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=e.optionState,(t=e.userOptions).readSurfaceActions=Object(c.c)(n.readSurfaceActions,t.readSurfaceActions),t.readSurfaceAddins=Object(c.c)(n.readSurfaceAddins,t.readSurfaceAddins),t.composeSurfaceActions=Object(c.c)(n.composeSurfaceActions,t.composeSurfaceActions),t.composeSurfaceAddins=Object(c.c)(n.composeSurfaceAddins,t.composeSurfaceAddins),n.hoverSurfaceActions=Object(c.c)(n.hoverSurfaceActions,[]),o=t.readSurfaceActions.length,a=t.readSurfaceAddins.length,l=t.composeSurfaceActions.length,f=t.composeSurfaceAddins.length,b=n.hoverSurfaceActions.length,Object(u.o)("CSACountUserSaveSettings",[d(o),d(a),d(l),d(f),d(b)]),[4,Object(i.b)(n.hoverSurfaceActions)];case 1:return r.sent(),[4,s.e.importAndExecute(s.a.SurfaceActions,t)];case 2:return r.sent(),[2]}var o,a,l,f,b}))}))})))},956:function(e,n,t){"use strict";var r=t(108),i=t(317),o=t(285),a=t(318);function c(e,n){return void 0===n&&(n="OWA.UserOptions"),Object(a.a)(n,e.map((function(e){return Object(i.a)({DictionaryKey:Object(o.a)({Type:"String",Value:[e.propertyName]}),DictionaryValue:Object(o.a)({Type:e.propertyType,Value:Array.isArray(e.propertyValue)?e.propertyValue:[e.propertyValue]})})})))}var u=t(0);function s(e){return Object(u.__assign)({__type:"SetMailboxMessageConfigurationRequest:#Exchange"},e)}var d=t(25);var l=t(246);function f(e){return void 0===(n=s({Header:Object(l.a)(),Options:(r=e,Object(u.__assign)({__type:"MailboxMessageConfigurationOptions:#Exchange"},r))}))||n.__type||(n=s(n)),Object(d.a)("SetMailboxMessageConfiguration",n,t);var n,t,r}function b(e,n){return null===e?n:e}var O=t(4),p=t(103),S=t(316),A=Object(O.mutatorAction)("updateSessionSettings",(function(e){S(Object(p.i)().SessionSettings,e)})),g=t(316),v=Object(O.mutatorAction)("updateUserOptions",(function(e){g(Object(p.i)().UserOptions,e)}));function j(e){var n=h(e);return!!n&&n.reduce((function(e,n){return e||n.fullOptionFormSettings.isDirty()}),!1)}function m(e){var n=h(e);return n&&n.reduce((function(e,n){return e&&!!n.fullOptionFormSettings.hideSaveDiscard&&n.fullOptionFormSettings.hideSaveDiscard()}),!0)}function w(e){var n=h(e);return!n||n.filter((function(e){return e.fullOptionFormSettings.isDirty()})).reduce((function(e,n){return e&&!!n.fullOptionFormSettings.disableSave&&n.fullOptionFormSettings.disableSave()}),!0)}function y(e,n,t,i,o){var a=new r.b(n,t),c=i&&o?new r.b(i,o):null;return Object(u.__assign)(Object(u.__assign)({},e),{tryImportFullOptionFormSettingsSync:function(){return a.tryImportForRender()},tryImportQuickOptionSettingsSync:c?function(){return c.tryImportForRender()}:void 0})}function h(e){var n=e.options.map((function(e){return function(e){return"fullOptionFormSettings"in e}(e)?e:Object(u.__assign)(Object(u.__assign)({},e),{fullOptionFormSettings:e.tryImportFullOptionFormSettingsSync()})}));return n.some((function(e){return!e.fullOptionFormSettings}))?null:n}var _=t(1537);t.d(n,"g",(function(){return D})),t.d(n,"a",(function(){return C})),t.d(n,"l",(function(){return c})),t.d(n,"h",(function(){return f})),t.d(n,"c",(function(){return b})),t.d(n,"k",(function(){return A})),t.d(n,"m",(function(){return v})),t.d(n,"f",(function(){return j})),t.d(n,"e",(function(){return m})),t.d(n,"i",(function(){return w})),t.d(n,"b",(function(){return y})),t.d(n,"j",(function(){return h})),t.d(n,"d",(function(){return _.a}));var P=new r.c((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(3),t.e(439)]).then(t.bind(null,15281))})),D=new r.a(P,(function(e){return e.confirmOptionNavigation})),C=Object(r.d)(P,(function(e){return e.OptionsEditor}))},960:function(e,n,t){"use strict";var r=t(108),i=t(1232),o=t(988),a=t(4),c=[o.a.SurfaceActions];Object(a.orchestrator)(i.a,(function(e){var n=e.defaultOptions;c.forEach((function(e){n[e]&&Object(o.f)(Number(e),n[e])}))}));var u=t(1017);t.d(n,"e",(function(){return d})),t.d(n,"h",(function(){return l})),t.d(n,"f",(function(){return f})),t.d(n,"g",(function(){return b})),t.d(n,"c",(function(){return u.a})),t.d(n,"d",(function(){return o.d})),t.d(n,"b",(function(){return o.b})),t.d(n,"a",(function(){return o.a}));var s=new r.c((function(){return t.e(440).then(t.bind(null,15122))})),d=new r.a(s,(function(e){return e.createOrUpdateOptionsForFeature})),l=new r.a(s,(function(e){return e.updateAddinPinStatus})),f=new r.b(s,(function(e){return e.getServerOptionsForFeature})),b=new r.a(s,(function(e){return e.loadOptions}))}}]);
//# sourceMappingURL=owa.SurfaceActionsOption.js.map
self.scriptsLoaded['owa.SurfaceActionsOption.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.SurfaceActionsOption.js'] = (new Date()).getTime();