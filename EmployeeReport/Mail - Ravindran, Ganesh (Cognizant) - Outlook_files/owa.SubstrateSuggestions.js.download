self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.SubstrateSuggestions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[554],{1294:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(76);function i(){return Object(r.h)("rp-peopleSuggestionsTrie")&&Object(r.h)("rp-peopleSuggestionsCacheFirst")||Object(r.h)("rp-cacheFirstPeopleTrieSize300")||Object(r.h)("rp-cacheFirstPeopleTrieSize500")||Object(r.h)("rp-cacheFirstPeopleTrieSize700")||Object(r.h)("rp-peopleTrieOnTimeoutLow")||Object(r.h)("rp-peopleTrieOnTimeoutMed")||Object(r.h)("rp-peopleTrieOnTimeoutHigh")}},15351:function(e,t,n){"use strict";n.r(t);var r=n(4238),i=n(283),c=n(114),o=Object(i.action)("execute3SPrimeCall")((function(){Object(r.a)(Object(c.e)().userIdentity,null,!1)}));n.d(t,"execute3SPrimeCall",(function(){return o}))},279:function(e,t,n){"use strict";var r=n(560);n.d(t,"a",(function(){return r.a}))},4062:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1294),i=["Id","ADObjectId","DisplayName","EmailAddresses","PeopleSubtype","PeopleType","PDLItemId","PersonaId","ImAddress","JobTitle"],c=i.concat(["FeatureData","GivenName","Alias"]),o=i.concat(["FeatureData"]);function u(e){return Object(r.a)()?0==e?c:o:i}},4238:function(e,t,n){"use strict";n.d(t,"a",(function(){return S})),n.d(t,"b",(function(){return P}));var r=n(0),i=n(240),c=n(419),o=n(76),u=n(428),a=n(279),s=n(287),p=n(295),l=n(4062),h=n(79),f=n(1294),d="/search/api/v1/init?",b="/search/api/v1/suggestions?",j="owa.react.compose",O=["PandaServingCompose","PandaServingComposeZeroQuery"],v="AppendFreshContactsToTopN",g="ContextAwareServing",y="20",_="5";function S(e,t,n,i,c,o,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var p,l,f,d,O;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return p=a||j,null!=t?[3,1]:[2,T(p)];case 1:return[4,m(t,n,o)];case 2:return l=r.sent(),f=function(e,t,n){return{AppName:"OWA",Scenario:{Name:n},Cvid:t||Object(u.a)(),EntityRequests:[e]}}(l,null==c?void 0:c.conversationId,p),d=s.d,O=[b+P(p,t),f,i,!1],[4,F(e,null==c?void 0:c.clientSessionId)];case 3:return[2,d.apply(void 0,O.concat([r.sent(),!0,!0,!1])).then((function(e){return e})).catch((function(e){return h.g.info(e),null}))]}}))}))}function T(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=s.b,n=[d+P(e),void 0,!0],[4,F(null)];case 1:return[2,t.apply(void 0,n.concat([r.sent(),!0,!1])).then((function(e){return Object(a.a)(e.status)?e.json():null})).catch((function(e){return e.networkError=!0,h.d(e),null}))]}}))}))}function m(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i;return Object(r.__generator)(this,(function(r){return i={Query:{QueryString:e},EntityType:"People",Provenances:w(t),Size:t?y:_},n&&n.length>0&&(i.Context=function(e){var t={};e&&(t.RecipientsTo=e.toString());return t}(n)),i.Fields=Object(l.a)(1),[2,i]}))}))}function w(e){var t=["Mailbox"];return e&&!Object(p.a)()&&t.push("Directory"),t}function P(e,t){var n={scenario:e},i=[],c=Object(f.a)();return(c||Object(o.h)("rp-cacheFirstPeopleTrieSize500cf"))&&(i.push.apply(i,Object(r.__spread)(O)),c&&Object(o.h)("rp-EnableFreshContactsForZeroQuery")&&i.push(v)),Object(o.h)("rp-contextualZeroQuery")&&""==t&&i.push(g),i.length>0&&(n.setflight=i.join(",")),Object.keys(n).map((function(e){return e+"="+n[e]})).join("&")}function F(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){return n={},t&&(n["client-session-id"]=t),e&&Object(i.n)(e)?[2,Object(c.a)(e).then((function(e){return Object.keys(e).forEach((function(t){return n[t]=e[t]})),n}))]:[2,n]}))}))}},560:function(e,t,n){"use strict";function r(e){return e>=200&&e<300}n.d(t,"a",(function(){return r}))}}]);
//# sourceMappingURL=owa.SubstrateSuggestions.js.map
self.scriptsLoaded['owa.SubstrateSuggestions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.SubstrateSuggestions.js'] = (new Date()).getTime();